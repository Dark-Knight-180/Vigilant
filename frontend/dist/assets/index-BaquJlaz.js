var cM=t=>{throw TypeError(t)};var qw=(t,e,r)=>e.has(t)||cM("Cannot "+r);var rt=(t,e,r)=>(qw(t,e,"read from private field"),r?r.call(t):e.get(t)),Er=(t,e,r)=>e.has(t)?cM("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(t):e.set(t,r),Jt=(t,e,r,n)=>(qw(t,e,"write to private field"),n?n.call(t,r):e.set(t,r),r),os=(t,e,r)=>(qw(t,e,"access private method"),r);var gv=(t,e,r,n)=>({set _(s){Jt(t,e,s,r)},get _(){return rt(t,e,n)}});function N3(t,e){for(var r=0;r<e.length;r++){const n=e[r];if(typeof n!="string"&&!Array.isArray(n)){for(const s in n)if(s!=="default"&&!(s in t)){const c=Object.getOwnPropertyDescriptor(n,s);c&&Object.defineProperty(t,s,c.get?c:{enumerable:!0,get:()=>n[s]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))n(s);new MutationObserver(s=>{for(const c of s)if(c.type==="childList")for(const l of c.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&n(l)}).observe(document,{childList:!0,subtree:!0});function r(s){const c={};return s.integrity&&(c.integrity=s.integrity),s.referrerPolicy&&(c.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?c.credentials="include":s.crossOrigin==="anonymous"?c.credentials="omit":c.credentials="same-origin",c}function n(s){if(s.ep)return;s.ep=!0;const c=r(s);fetch(s.href,c)}})();var Po=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function JE(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function G8(t){if(t.__esModule)return t;var e=t.default;if(typeof e=="function"){var r=function n(){return this instanceof n?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};r.prototype=e.prototype}else r={};return Object.defineProperty(r,"__esModule",{value:!0}),Object.keys(t).forEach(function(n){var s=Object.getOwnPropertyDescriptor(t,n);Object.defineProperty(r,n,s.get?s:{enumerable:!0,get:function(){return t[n]}})}),r}var j3={exports:{}},jb={},F3={exports:{}},vr={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var O0=Symbol.for("react.element"),W8=Symbol.for("react.portal"),q8=Symbol.for("react.fragment"),H8=Symbol.for("react.strict_mode"),Z8=Symbol.for("react.profiler"),K8=Symbol.for("react.provider"),X8=Symbol.for("react.context"),Y8=Symbol.for("react.forward_ref"),Q8=Symbol.for("react.suspense"),J8=Symbol.for("react.memo"),eV=Symbol.for("react.lazy"),uM=Symbol.iterator;function tV(t){return t===null||typeof t!="object"?null:(t=uM&&t[uM]||t["@@iterator"],typeof t=="function"?t:null)}var B3={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},$3=Object.assign,V3={};function dm(t,e,r){this.props=t,this.context=e,this.refs=V3,this.updater=r||B3}dm.prototype.isReactComponent={};dm.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};dm.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function U3(){}U3.prototype=dm.prototype;function eC(t,e,r){this.props=t,this.context=e,this.refs=V3,this.updater=r||B3}var tC=eC.prototype=new U3;tC.constructor=eC;$3(tC,dm.prototype);tC.isPureReactComponent=!0;var hM=Array.isArray,G3=Object.prototype.hasOwnProperty,rC={current:null},W3={key:!0,ref:!0,__self:!0,__source:!0};function q3(t,e,r){var n,s={},c=null,l=null;if(e!=null)for(n in e.ref!==void 0&&(l=e.ref),e.key!==void 0&&(c=""+e.key),e)G3.call(e,n)&&!W3.hasOwnProperty(n)&&(s[n]=e[n]);var a=arguments.length-2;if(a===1)s.children=r;else if(1<a){for(var m=Array(a),y=0;y<a;y++)m[y]=arguments[y+2];s.children=m}if(t&&t.defaultProps)for(n in a=t.defaultProps,a)s[n]===void 0&&(s[n]=a[n]);return{$$typeof:O0,type:t,key:c,ref:l,props:s,_owner:rC.current}}function rV(t,e){return{$$typeof:O0,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function nC(t){return typeof t=="object"&&t!==null&&t.$$typeof===O0}function nV(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(r){return e[r]})}var dM=/\/+/g;function Hw(t,e){return typeof t=="object"&&t!==null&&t.key!=null?nV(""+t.key):e.toString(36)}function sx(t,e,r,n,s){var c=typeof t;(c==="undefined"||c==="boolean")&&(t=null);var l=!1;if(t===null)l=!0;else switch(c){case"string":case"number":l=!0;break;case"object":switch(t.$$typeof){case O0:case W8:l=!0}}if(l)return l=t,s=s(l),t=n===""?"."+Hw(l,0):n,hM(s)?(r="",t!=null&&(r=t.replace(dM,"$&/")+"/"),sx(s,e,r,"",function(y){return y})):s!=null&&(nC(s)&&(s=rV(s,r+(!s.key||l&&l.key===s.key?"":(""+s.key).replace(dM,"$&/")+"/")+t)),e.push(s)),1;if(l=0,n=n===""?".":n+":",hM(t))for(var a=0;a<t.length;a++){c=t[a];var m=n+Hw(c,a);l+=sx(c,e,r,m,s)}else if(m=tV(t),typeof m=="function")for(t=m.call(t),a=0;!(c=t.next()).done;)c=c.value,m=n+Hw(c,a++),l+=sx(c,e,r,m,s);else if(c==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return l}function yv(t,e,r){if(t==null)return t;var n=[],s=0;return sx(t,n,"","",function(c){return e.call(r,c,s++)}),n}function iV(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(r){(t._status===0||t._status===-1)&&(t._status=1,t._result=r)},function(r){(t._status===0||t._status===-1)&&(t._status=2,t._result=r)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var Is={current:null},ox={transition:null},sV={ReactCurrentDispatcher:Is,ReactCurrentBatchConfig:ox,ReactCurrentOwner:rC};function H3(){throw Error("act(...) is not supported in production builds of React.")}vr.Children={map:yv,forEach:function(t,e,r){yv(t,function(){e.apply(this,arguments)},r)},count:function(t){var e=0;return yv(t,function(){e++}),e},toArray:function(t){return yv(t,function(e){return e})||[]},only:function(t){if(!nC(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};vr.Component=dm;vr.Fragment=q8;vr.Profiler=Z8;vr.PureComponent=eC;vr.StrictMode=H8;vr.Suspense=Q8;vr.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=sV;vr.act=H3;vr.cloneElement=function(t,e,r){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var n=$3({},t.props),s=t.key,c=t.ref,l=t._owner;if(e!=null){if(e.ref!==void 0&&(c=e.ref,l=rC.current),e.key!==void 0&&(s=""+e.key),t.type&&t.type.defaultProps)var a=t.type.defaultProps;for(m in e)G3.call(e,m)&&!W3.hasOwnProperty(m)&&(n[m]=e[m]===void 0&&a!==void 0?a[m]:e[m])}var m=arguments.length-2;if(m===1)n.children=r;else if(1<m){a=Array(m);for(var y=0;y<m;y++)a[y]=arguments[y+2];n.children=a}return{$$typeof:O0,type:t.type,key:s,ref:c,props:n,_owner:l}};vr.createContext=function(t){return t={$$typeof:X8,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:K8,_context:t},t.Consumer=t};vr.createElement=q3;vr.createFactory=function(t){var e=q3.bind(null,t);return e.type=t,e};vr.createRef=function(){return{current:null}};vr.forwardRef=function(t){return{$$typeof:Y8,render:t}};vr.isValidElement=nC;vr.lazy=function(t){return{$$typeof:eV,_payload:{_status:-1,_result:t},_init:iV}};vr.memo=function(t,e){return{$$typeof:J8,type:t,compare:e===void 0?null:e}};vr.startTransition=function(t){var e=ox.transition;ox.transition={};try{t()}finally{ox.transition=e}};vr.unstable_act=H3;vr.useCallback=function(t,e){return Is.current.useCallback(t,e)};vr.useContext=function(t){return Is.current.useContext(t)};vr.useDebugValue=function(){};vr.useDeferredValue=function(t){return Is.current.useDeferredValue(t)};vr.useEffect=function(t,e){return Is.current.useEffect(t,e)};vr.useId=function(){return Is.current.useId()};vr.useImperativeHandle=function(t,e,r){return Is.current.useImperativeHandle(t,e,r)};vr.useInsertionEffect=function(t,e){return Is.current.useInsertionEffect(t,e)};vr.useLayoutEffect=function(t,e){return Is.current.useLayoutEffect(t,e)};vr.useMemo=function(t,e){return Is.current.useMemo(t,e)};vr.useReducer=function(t,e,r){return Is.current.useReducer(t,e,r)};vr.useRef=function(t){return Is.current.useRef(t)};vr.useState=function(t){return Is.current.useState(t)};vr.useSyncExternalStore=function(t,e,r){return Is.current.useSyncExternalStore(t,e,r)};vr.useTransition=function(){return Is.current.useTransition()};vr.version="18.3.1";F3.exports=vr;var X=F3.exports;const bt=JE(X),iC=N3({__proto__:null,default:bt},[X]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var oV=X,aV=Symbol.for("react.element"),lV=Symbol.for("react.fragment"),cV=Object.prototype.hasOwnProperty,uV=oV.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,hV={key:!0,ref:!0,__self:!0,__source:!0};function Z3(t,e,r){var n,s={},c=null,l=null;r!==void 0&&(c=""+r),e.key!==void 0&&(c=""+e.key),e.ref!==void 0&&(l=e.ref);for(n in e)cV.call(e,n)&&!hV.hasOwnProperty(n)&&(s[n]=e[n]);if(t&&t.defaultProps)for(n in e=t.defaultProps,e)s[n]===void 0&&(s[n]=e[n]);return{$$typeof:aV,type:t,key:c,ref:l,props:s,_owner:uV.current}}jb.Fragment=lV;jb.jsx=Z3;jb.jsxs=Z3;j3.exports=jb;var B=j3.exports,K3={exports:{}},Io={},X3={exports:{}},Y3={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(fe,ve){var Re=fe.length;fe.push(ve);e:for(;0<Re;){var $e=Re-1>>>1,Xe=fe[$e];if(0<s(Xe,ve))fe[$e]=ve,fe[Re]=Xe,Re=$e;else break e}}function r(fe){return fe.length===0?null:fe[0]}function n(fe){if(fe.length===0)return null;var ve=fe[0],Re=fe.pop();if(Re!==ve){fe[0]=Re;e:for(var $e=0,Xe=fe.length,st=Xe>>>1;$e<st;){var at=2*($e+1)-1,_t=fe[at],Ct=at+1,Pt=fe[Ct];if(0>s(_t,Re))Ct<Xe&&0>s(Pt,_t)?(fe[$e]=Pt,fe[Ct]=Re,$e=Ct):(fe[$e]=_t,fe[at]=Re,$e=at);else if(Ct<Xe&&0>s(Pt,Re))fe[$e]=Pt,fe[Ct]=Re,$e=Ct;else break e}}return ve}function s(fe,ve){var Re=fe.sortIndex-ve.sortIndex;return Re!==0?Re:fe.id-ve.id}if(typeof performance=="object"&&typeof performance.now=="function"){var c=performance;t.unstable_now=function(){return c.now()}}else{var l=Date,a=l.now();t.unstable_now=function(){return l.now()-a}}var m=[],y=[],v=1,T=null,P=3,A=!1,O=!1,I=!1,L=typeof setTimeout=="function"?setTimeout:null,R=typeof clearTimeout=="function"?clearTimeout:null,z=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function j(fe){for(var ve=r(y);ve!==null;){if(ve.callback===null)n(y);else if(ve.startTime<=fe)n(y),ve.sortIndex=ve.expirationTime,e(m,ve);else break;ve=r(y)}}function W(fe){if(I=!1,j(fe),!O)if(r(m)!==null)O=!0,xe(Z);else{var ve=r(y);ve!==null&&Se(W,ve.startTime-fe)}}function Z(fe,ve){O=!1,I&&(I=!1,R(V),V=-1),A=!0;var Re=P;try{for(j(ve),T=r(m);T!==null&&(!(T.expirationTime>ve)||fe&&!ce());){var $e=T.callback;if(typeof $e=="function"){T.callback=null,P=T.priorityLevel;var Xe=$e(T.expirationTime<=ve);ve=t.unstable_now(),typeof Xe=="function"?T.callback=Xe:T===r(m)&&n(m),j(ve)}else n(m);T=r(m)}if(T!==null)var st=!0;else{var at=r(y);at!==null&&Se(W,at.startTime-ve),st=!1}return st}finally{T=null,P=Re,A=!1}}var te=!1,ie=null,V=-1,q=5,Q=-1;function ce(){return!(t.unstable_now()-Q<q)}function se(){if(ie!==null){var fe=t.unstable_now();Q=fe;var ve=!0;try{ve=ie(!0,fe)}finally{ve?ue():(te=!1,ie=null)}}else te=!1}var ue;if(typeof z=="function")ue=function(){z(se)};else if(typeof MessageChannel<"u"){var he=new MessageChannel,ye=he.port2;he.port1.onmessage=se,ue=function(){ye.postMessage(null)}}else ue=function(){L(se,0)};function xe(fe){ie=fe,te||(te=!0,ue())}function Se(fe,ve){V=L(function(){fe(t.unstable_now())},ve)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(fe){fe.callback=null},t.unstable_continueExecution=function(){O||A||(O=!0,xe(Z))},t.unstable_forceFrameRate=function(fe){0>fe||125<fe?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):q=0<fe?Math.floor(1e3/fe):5},t.unstable_getCurrentPriorityLevel=function(){return P},t.unstable_getFirstCallbackNode=function(){return r(m)},t.unstable_next=function(fe){switch(P){case 1:case 2:case 3:var ve=3;break;default:ve=P}var Re=P;P=ve;try{return fe()}finally{P=Re}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(fe,ve){switch(fe){case 1:case 2:case 3:case 4:case 5:break;default:fe=3}var Re=P;P=fe;try{return ve()}finally{P=Re}},t.unstable_scheduleCallback=function(fe,ve,Re){var $e=t.unstable_now();switch(typeof Re=="object"&&Re!==null?(Re=Re.delay,Re=typeof Re=="number"&&0<Re?$e+Re:$e):Re=$e,fe){case 1:var Xe=-1;break;case 2:Xe=250;break;case 5:Xe=1073741823;break;case 4:Xe=1e4;break;default:Xe=5e3}return Xe=Re+Xe,fe={id:v++,callback:ve,priorityLevel:fe,startTime:Re,expirationTime:Xe,sortIndex:-1},Re>$e?(fe.sortIndex=Re,e(y,fe),r(m)===null&&fe===r(y)&&(I?(R(V),V=-1):I=!0,Se(W,Re-$e))):(fe.sortIndex=Xe,e(m,fe),O||A||(O=!0,xe(Z))),fe},t.unstable_shouldYield=ce,t.unstable_wrapCallback=function(fe){var ve=P;return function(){var Re=P;P=ve;try{return fe.apply(this,arguments)}finally{P=Re}}}})(Y3);X3.exports=Y3;var dV=X3.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var fV=X,Ao=dV;function gt(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,r=1;r<arguments.length;r++)e+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var Q3=new Set,By={};function Ad(t,e){Hp(t,e),Hp(t+"Capture",e)}function Hp(t,e){for(By[t]=e,t=0;t<e.length;t++)Q3.add(e[t])}var Ql=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),SS=Object.prototype.hasOwnProperty,pV=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,fM={},pM={};function mV(t){return SS.call(pM,t)?!0:SS.call(fM,t)?!1:pV.test(t)?pM[t]=!0:(fM[t]=!0,!1)}function gV(t,e,r,n){if(r!==null&&r.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return n?!1:r!==null?!r.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function yV(t,e,r,n){if(e===null||typeof e>"u"||gV(t,e,r,n))return!0;if(n)return!1;if(r!==null)switch(r.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function Rs(t,e,r,n,s,c,l){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=n,this.attributeNamespace=s,this.mustUseProperty=r,this.propertyName=t,this.type=e,this.sanitizeURL=c,this.removeEmptyString=l}var ts={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){ts[t]=new Rs(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];ts[e]=new Rs(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){ts[t]=new Rs(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){ts[t]=new Rs(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){ts[t]=new Rs(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){ts[t]=new Rs(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){ts[t]=new Rs(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){ts[t]=new Rs(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){ts[t]=new Rs(t,5,!1,t.toLowerCase(),null,!1,!1)});var sC=/[\-:]([a-z])/g;function oC(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(sC,oC);ts[e]=new Rs(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(sC,oC);ts[e]=new Rs(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(sC,oC);ts[e]=new Rs(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){ts[t]=new Rs(t,1,!1,t.toLowerCase(),null,!1,!1)});ts.xlinkHref=new Rs("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){ts[t]=new Rs(t,1,!1,t.toLowerCase(),null,!0,!0)});function aC(t,e,r,n){var s=ts.hasOwnProperty(e)?ts[e]:null;(s!==null?s.type!==0:n||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(yV(e,r,s,n)&&(r=null),n||s===null?mV(e)&&(r===null?t.removeAttribute(e):t.setAttribute(e,""+r)):s.mustUseProperty?t[s.propertyName]=r===null?s.type===3?!1:"":r:(e=s.attributeName,n=s.attributeNamespace,r===null?t.removeAttribute(e):(s=s.type,r=s===3||s===4&&r===!0?"":""+r,n?t.setAttributeNS(n,e,r):t.setAttribute(e,r))))}var dc=fV.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,_v=Symbol.for("react.element"),np=Symbol.for("react.portal"),ip=Symbol.for("react.fragment"),lC=Symbol.for("react.strict_mode"),TS=Symbol.for("react.profiler"),J3=Symbol.for("react.provider"),eO=Symbol.for("react.context"),cC=Symbol.for("react.forward_ref"),ES=Symbol.for("react.suspense"),CS=Symbol.for("react.suspense_list"),uC=Symbol.for("react.memo"),Qc=Symbol.for("react.lazy"),tO=Symbol.for("react.offscreen"),mM=Symbol.iterator;function zg(t){return t===null||typeof t!="object"?null:(t=mM&&t[mM]||t["@@iterator"],typeof t=="function"?t:null)}var zn=Object.assign,Zw;function ey(t){if(Zw===void 0)try{throw Error()}catch(r){var e=r.stack.trim().match(/\n( *(at )?)/);Zw=e&&e[1]||""}return`
`+Zw+t}var Kw=!1;function Xw(t,e){if(!t||Kw)return"";Kw=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(y){var n=y}Reflect.construct(t,[],e)}else{try{e.call()}catch(y){n=y}t.call(e.prototype)}else{try{throw Error()}catch(y){n=y}t()}}catch(y){if(y&&n&&typeof y.stack=="string"){for(var s=y.stack.split(`
`),c=n.stack.split(`
`),l=s.length-1,a=c.length-1;1<=l&&0<=a&&s[l]!==c[a];)a--;for(;1<=l&&0<=a;l--,a--)if(s[l]!==c[a]){if(l!==1||a!==1)do if(l--,a--,0>a||s[l]!==c[a]){var m=`
`+s[l].replace(" at new "," at ");return t.displayName&&m.includes("<anonymous>")&&(m=m.replace("<anonymous>",t.displayName)),m}while(1<=l&&0<=a);break}}}finally{Kw=!1,Error.prepareStackTrace=r}return(t=t?t.displayName||t.name:"")?ey(t):""}function _V(t){switch(t.tag){case 5:return ey(t.type);case 16:return ey("Lazy");case 13:return ey("Suspense");case 19:return ey("SuspenseList");case 0:case 2:case 15:return t=Xw(t.type,!1),t;case 11:return t=Xw(t.type.render,!1),t;case 1:return t=Xw(t.type,!0),t;default:return""}}function PS(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case ip:return"Fragment";case np:return"Portal";case TS:return"Profiler";case lC:return"StrictMode";case ES:return"Suspense";case CS:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case eO:return(t.displayName||"Context")+".Consumer";case J3:return(t._context.displayName||"Context")+".Provider";case cC:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case uC:return e=t.displayName||null,e!==null?e:PS(t.type)||"Memo";case Qc:e=t._payload,t=t._init;try{return PS(t(e))}catch{}}return null}function vV(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return PS(e);case 8:return e===lC?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function Cu(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function rO(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function xV(t){var e=rO(t)?"checked":"value",r=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),n=""+t[e];if(!t.hasOwnProperty(e)&&typeof r<"u"&&typeof r.get=="function"&&typeof r.set=="function"){var s=r.get,c=r.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return s.call(this)},set:function(l){n=""+l,c.call(this,l)}}),Object.defineProperty(t,e,{enumerable:r.enumerable}),{getValue:function(){return n},setValue:function(l){n=""+l},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function vv(t){t._valueTracker||(t._valueTracker=xV(t))}function nO(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var r=e.getValue(),n="";return t&&(n=rO(t)?t.checked?"true":"false":t.value),t=n,t!==r?(e.setValue(t),!0):!1}function Ox(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function AS(t,e){var r=e.checked;return zn({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:r??t._wrapperState.initialChecked})}function gM(t,e){var r=e.defaultValue==null?"":e.defaultValue,n=e.checked!=null?e.checked:e.defaultChecked;r=Cu(e.value!=null?e.value:r),t._wrapperState={initialChecked:n,initialValue:r,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function iO(t,e){e=e.checked,e!=null&&aC(t,"checked",e,!1)}function kS(t,e){iO(t,e);var r=Cu(e.value),n=e.type;if(r!=null)n==="number"?(r===0&&t.value===""||t.value!=r)&&(t.value=""+r):t.value!==""+r&&(t.value=""+r);else if(n==="submit"||n==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?MS(t,e.type,r):e.hasOwnProperty("defaultValue")&&MS(t,e.type,Cu(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function yM(t,e,r){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var n=e.type;if(!(n!=="submit"&&n!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,r||e===t.value||(t.value=e),t.defaultValue=e}r=t.name,r!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,r!==""&&(t.name=r)}function MS(t,e,r){(e!=="number"||Ox(t.ownerDocument)!==t)&&(r==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+r&&(t.defaultValue=""+r))}var ty=Array.isArray;function wp(t,e,r,n){if(t=t.options,e){e={};for(var s=0;s<r.length;s++)e["$"+r[s]]=!0;for(r=0;r<t.length;r++)s=e.hasOwnProperty("$"+t[r].value),t[r].selected!==s&&(t[r].selected=s),s&&n&&(t[r].defaultSelected=!0)}else{for(r=""+Cu(r),e=null,s=0;s<t.length;s++){if(t[s].value===r){t[s].selected=!0,n&&(t[s].defaultSelected=!0);return}e!==null||t[s].disabled||(e=t[s])}e!==null&&(e.selected=!0)}}function IS(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(gt(91));return zn({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function _M(t,e){var r=e.value;if(r==null){if(r=e.children,e=e.defaultValue,r!=null){if(e!=null)throw Error(gt(92));if(ty(r)){if(1<r.length)throw Error(gt(93));r=r[0]}e=r}e==null&&(e=""),r=e}t._wrapperState={initialValue:Cu(r)}}function sO(t,e){var r=Cu(e.value),n=Cu(e.defaultValue);r!=null&&(r=""+r,r!==t.value&&(t.value=r),e.defaultValue==null&&t.defaultValue!==r&&(t.defaultValue=r)),n!=null&&(t.defaultValue=""+n)}function vM(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function oO(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function RS(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?oO(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var xv,aO=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,r,n,s){MSApp.execUnsafeLocalFunction(function(){return t(e,r,n,s)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(xv=xv||document.createElement("div"),xv.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=xv.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function $y(t,e){if(e){var r=t.firstChild;if(r&&r===t.lastChild&&r.nodeType===3){r.nodeValue=e;return}}t.textContent=e}var py={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},bV=["Webkit","ms","Moz","O"];Object.keys(py).forEach(function(t){bV.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),py[e]=py[t]})});function lO(t,e,r){return e==null||typeof e=="boolean"||e===""?"":r||typeof e!="number"||e===0||py.hasOwnProperty(t)&&py[t]?(""+e).trim():e+"px"}function cO(t,e){t=t.style;for(var r in e)if(e.hasOwnProperty(r)){var n=r.indexOf("--")===0,s=lO(r,e[r],n);r==="float"&&(r="cssFloat"),n?t.setProperty(r,s):t[r]=s}}var wV=zn({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function DS(t,e){if(e){if(wV[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(gt(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(gt(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(gt(61))}if(e.style!=null&&typeof e.style!="object")throw Error(gt(62))}}function LS(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var OS=null;function hC(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var zS=null,Sp=null,Tp=null;function xM(t){if(t=j0(t)){if(typeof zS!="function")throw Error(gt(280));var e=t.stateNode;e&&(e=Ub(e),zS(t.stateNode,t.type,e))}}function uO(t){Sp?Tp?Tp.push(t):Tp=[t]:Sp=t}function hO(){if(Sp){var t=Sp,e=Tp;if(Tp=Sp=null,xM(t),e)for(t=0;t<e.length;t++)xM(e[t])}}function dO(t,e){return t(e)}function fO(){}var Yw=!1;function pO(t,e,r){if(Yw)return t(e,r);Yw=!0;try{return dO(t,e,r)}finally{Yw=!1,(Sp!==null||Tp!==null)&&(fO(),hO())}}function Vy(t,e){var r=t.stateNode;if(r===null)return null;var n=Ub(r);if(n===null)return null;r=n[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(n=!n.disabled)||(t=t.type,n=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!n;break e;default:t=!1}if(t)return null;if(r&&typeof r!="function")throw Error(gt(231,e,typeof r));return r}var NS=!1;if(Ql)try{var Ng={};Object.defineProperty(Ng,"passive",{get:function(){NS=!0}}),window.addEventListener("test",Ng,Ng),window.removeEventListener("test",Ng,Ng)}catch{NS=!1}function SV(t,e,r,n,s,c,l,a,m){var y=Array.prototype.slice.call(arguments,3);try{e.apply(r,y)}catch(v){this.onError(v)}}var my=!1,zx=null,Nx=!1,jS=null,TV={onError:function(t){my=!0,zx=t}};function EV(t,e,r,n,s,c,l,a,m){my=!1,zx=null,SV.apply(TV,arguments)}function CV(t,e,r,n,s,c,l,a,m){if(EV.apply(this,arguments),my){if(my){var y=zx;my=!1,zx=null}else throw Error(gt(198));Nx||(Nx=!0,jS=y)}}function kd(t){var e=t,r=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(r=e.return),t=e.return;while(t)}return e.tag===3?r:null}function mO(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function bM(t){if(kd(t)!==t)throw Error(gt(188))}function PV(t){var e=t.alternate;if(!e){if(e=kd(t),e===null)throw Error(gt(188));return e!==t?null:t}for(var r=t,n=e;;){var s=r.return;if(s===null)break;var c=s.alternate;if(c===null){if(n=s.return,n!==null){r=n;continue}break}if(s.child===c.child){for(c=s.child;c;){if(c===r)return bM(s),t;if(c===n)return bM(s),e;c=c.sibling}throw Error(gt(188))}if(r.return!==n.return)r=s,n=c;else{for(var l=!1,a=s.child;a;){if(a===r){l=!0,r=s,n=c;break}if(a===n){l=!0,n=s,r=c;break}a=a.sibling}if(!l){for(a=c.child;a;){if(a===r){l=!0,r=c,n=s;break}if(a===n){l=!0,n=c,r=s;break}a=a.sibling}if(!l)throw Error(gt(189))}}if(r.alternate!==n)throw Error(gt(190))}if(r.tag!==3)throw Error(gt(188));return r.stateNode.current===r?t:e}function gO(t){return t=PV(t),t!==null?yO(t):null}function yO(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=yO(t);if(e!==null)return e;t=t.sibling}return null}var _O=Ao.unstable_scheduleCallback,wM=Ao.unstable_cancelCallback,AV=Ao.unstable_shouldYield,kV=Ao.unstable_requestPaint,ei=Ao.unstable_now,MV=Ao.unstable_getCurrentPriorityLevel,dC=Ao.unstable_ImmediatePriority,vO=Ao.unstable_UserBlockingPriority,jx=Ao.unstable_NormalPriority,IV=Ao.unstable_LowPriority,xO=Ao.unstable_IdlePriority,Fb=null,hl=null;function RV(t){if(hl&&typeof hl.onCommitFiberRoot=="function")try{hl.onCommitFiberRoot(Fb,t,void 0,(t.current.flags&128)===128)}catch{}}var Ta=Math.clz32?Math.clz32:OV,DV=Math.log,LV=Math.LN2;function OV(t){return t>>>=0,t===0?32:31-(DV(t)/LV|0)|0}var bv=64,wv=4194304;function ry(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function Fx(t,e){var r=t.pendingLanes;if(r===0)return 0;var n=0,s=t.suspendedLanes,c=t.pingedLanes,l=r&268435455;if(l!==0){var a=l&~s;a!==0?n=ry(a):(c&=l,c!==0&&(n=ry(c)))}else l=r&~s,l!==0?n=ry(l):c!==0&&(n=ry(c));if(n===0)return 0;if(e!==0&&e!==n&&!(e&s)&&(s=n&-n,c=e&-e,s>=c||s===16&&(c&4194240)!==0))return e;if(n&4&&(n|=r&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=n;0<e;)r=31-Ta(e),s=1<<r,n|=t[r],e&=~s;return n}function zV(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function NV(t,e){for(var r=t.suspendedLanes,n=t.pingedLanes,s=t.expirationTimes,c=t.pendingLanes;0<c;){var l=31-Ta(c),a=1<<l,m=s[l];m===-1?(!(a&r)||a&n)&&(s[l]=zV(a,e)):m<=e&&(t.expiredLanes|=a),c&=~a}}function FS(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function bO(){var t=bv;return bv<<=1,!(bv&4194240)&&(bv=64),t}function Qw(t){for(var e=[],r=0;31>r;r++)e.push(t);return e}function z0(t,e,r){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-Ta(e),t[e]=r}function jV(t,e){var r=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var n=t.eventTimes;for(t=t.expirationTimes;0<r;){var s=31-Ta(r),c=1<<s;e[s]=0,n[s]=-1,t[s]=-1,r&=~c}}function fC(t,e){var r=t.entangledLanes|=e;for(t=t.entanglements;r;){var n=31-Ta(r),s=1<<n;s&e|t[n]&e&&(t[n]|=e),r&=~s}}var Wr=0;function wO(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var SO,pC,TO,EO,CO,BS=!1,Sv=[],mu=null,gu=null,yu=null,Uy=new Map,Gy=new Map,eu=[],FV="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function SM(t,e){switch(t){case"focusin":case"focusout":mu=null;break;case"dragenter":case"dragleave":gu=null;break;case"mouseover":case"mouseout":yu=null;break;case"pointerover":case"pointerout":Uy.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":Gy.delete(e.pointerId)}}function jg(t,e,r,n,s,c){return t===null||t.nativeEvent!==c?(t={blockedOn:e,domEventName:r,eventSystemFlags:n,nativeEvent:c,targetContainers:[s]},e!==null&&(e=j0(e),e!==null&&pC(e)),t):(t.eventSystemFlags|=n,e=t.targetContainers,s!==null&&e.indexOf(s)===-1&&e.push(s),t)}function BV(t,e,r,n,s){switch(e){case"focusin":return mu=jg(mu,t,e,r,n,s),!0;case"dragenter":return gu=jg(gu,t,e,r,n,s),!0;case"mouseover":return yu=jg(yu,t,e,r,n,s),!0;case"pointerover":var c=s.pointerId;return Uy.set(c,jg(Uy.get(c)||null,t,e,r,n,s)),!0;case"gotpointercapture":return c=s.pointerId,Gy.set(c,jg(Gy.get(c)||null,t,e,r,n,s)),!0}return!1}function PO(t){var e=Hh(t.target);if(e!==null){var r=kd(e);if(r!==null){if(e=r.tag,e===13){if(e=mO(r),e!==null){t.blockedOn=e,CO(t.priority,function(){TO(r)});return}}else if(e===3&&r.stateNode.current.memoizedState.isDehydrated){t.blockedOn=r.tag===3?r.stateNode.containerInfo:null;return}}}t.blockedOn=null}function ax(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var r=$S(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(r===null){r=t.nativeEvent;var n=new r.constructor(r.type,r);OS=n,r.target.dispatchEvent(n),OS=null}else return e=j0(r),e!==null&&pC(e),t.blockedOn=r,!1;e.shift()}return!0}function TM(t,e,r){ax(t)&&r.delete(e)}function $V(){BS=!1,mu!==null&&ax(mu)&&(mu=null),gu!==null&&ax(gu)&&(gu=null),yu!==null&&ax(yu)&&(yu=null),Uy.forEach(TM),Gy.forEach(TM)}function Fg(t,e){t.blockedOn===e&&(t.blockedOn=null,BS||(BS=!0,Ao.unstable_scheduleCallback(Ao.unstable_NormalPriority,$V)))}function Wy(t){function e(s){return Fg(s,t)}if(0<Sv.length){Fg(Sv[0],t);for(var r=1;r<Sv.length;r++){var n=Sv[r];n.blockedOn===t&&(n.blockedOn=null)}}for(mu!==null&&Fg(mu,t),gu!==null&&Fg(gu,t),yu!==null&&Fg(yu,t),Uy.forEach(e),Gy.forEach(e),r=0;r<eu.length;r++)n=eu[r],n.blockedOn===t&&(n.blockedOn=null);for(;0<eu.length&&(r=eu[0],r.blockedOn===null);)PO(r),r.blockedOn===null&&eu.shift()}var Ep=dc.ReactCurrentBatchConfig,Bx=!0;function VV(t,e,r,n){var s=Wr,c=Ep.transition;Ep.transition=null;try{Wr=1,mC(t,e,r,n)}finally{Wr=s,Ep.transition=c}}function UV(t,e,r,n){var s=Wr,c=Ep.transition;Ep.transition=null;try{Wr=4,mC(t,e,r,n)}finally{Wr=s,Ep.transition=c}}function mC(t,e,r,n){if(Bx){var s=$S(t,e,r,n);if(s===null)l2(t,e,n,$x,r),SM(t,n);else if(BV(s,t,e,r,n))n.stopPropagation();else if(SM(t,n),e&4&&-1<FV.indexOf(t)){for(;s!==null;){var c=j0(s);if(c!==null&&SO(c),c=$S(t,e,r,n),c===null&&l2(t,e,n,$x,r),c===s)break;s=c}s!==null&&n.stopPropagation()}else l2(t,e,n,null,r)}}var $x=null;function $S(t,e,r,n){if($x=null,t=hC(n),t=Hh(t),t!==null)if(e=kd(t),e===null)t=null;else if(r=e.tag,r===13){if(t=mO(e),t!==null)return t;t=null}else if(r===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return $x=t,null}function AO(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(MV()){case dC:return 1;case vO:return 4;case jx:case IV:return 16;case xO:return 536870912;default:return 16}default:return 16}}var cu=null,gC=null,lx=null;function kO(){if(lx)return lx;var t,e=gC,r=e.length,n,s="value"in cu?cu.value:cu.textContent,c=s.length;for(t=0;t<r&&e[t]===s[t];t++);var l=r-t;for(n=1;n<=l&&e[r-n]===s[c-n];n++);return lx=s.slice(t,1<n?1-n:void 0)}function cx(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function Tv(){return!0}function EM(){return!1}function Ro(t){function e(r,n,s,c,l){this._reactName=r,this._targetInst=s,this.type=n,this.nativeEvent=c,this.target=l,this.currentTarget=null;for(var a in t)t.hasOwnProperty(a)&&(r=t[a],this[a]=r?r(c):c[a]);return this.isDefaultPrevented=(c.defaultPrevented!=null?c.defaultPrevented:c.returnValue===!1)?Tv:EM,this.isPropagationStopped=EM,this}return zn(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var r=this.nativeEvent;r&&(r.preventDefault?r.preventDefault():typeof r.returnValue!="unknown"&&(r.returnValue=!1),this.isDefaultPrevented=Tv)},stopPropagation:function(){var r=this.nativeEvent;r&&(r.stopPropagation?r.stopPropagation():typeof r.cancelBubble!="unknown"&&(r.cancelBubble=!0),this.isPropagationStopped=Tv)},persist:function(){},isPersistent:Tv}),e}var fm={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},yC=Ro(fm),N0=zn({},fm,{view:0,detail:0}),GV=Ro(N0),Jw,e2,Bg,Bb=zn({},N0,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:_C,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==Bg&&(Bg&&t.type==="mousemove"?(Jw=t.screenX-Bg.screenX,e2=t.screenY-Bg.screenY):e2=Jw=0,Bg=t),Jw)},movementY:function(t){return"movementY"in t?t.movementY:e2}}),CM=Ro(Bb),WV=zn({},Bb,{dataTransfer:0}),qV=Ro(WV),HV=zn({},N0,{relatedTarget:0}),t2=Ro(HV),ZV=zn({},fm,{animationName:0,elapsedTime:0,pseudoElement:0}),KV=Ro(ZV),XV=zn({},fm,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),YV=Ro(XV),QV=zn({},fm,{data:0}),PM=Ro(QV),JV={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},eU={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},tU={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function rU(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=tU[t])?!!e[t]:!1}function _C(){return rU}var nU=zn({},N0,{key:function(t){if(t.key){var e=JV[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=cx(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?eU[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:_C,charCode:function(t){return t.type==="keypress"?cx(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?cx(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),iU=Ro(nU),sU=zn({},Bb,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),AM=Ro(sU),oU=zn({},N0,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:_C}),aU=Ro(oU),lU=zn({},fm,{propertyName:0,elapsedTime:0,pseudoElement:0}),cU=Ro(lU),uU=zn({},Bb,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),hU=Ro(uU),dU=[9,13,27,32],vC=Ql&&"CompositionEvent"in window,gy=null;Ql&&"documentMode"in document&&(gy=document.documentMode);var fU=Ql&&"TextEvent"in window&&!gy,MO=Ql&&(!vC||gy&&8<gy&&11>=gy),kM=" ",MM=!1;function IO(t,e){switch(t){case"keyup":return dU.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function RO(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var sp=!1;function pU(t,e){switch(t){case"compositionend":return RO(e);case"keypress":return e.which!==32?null:(MM=!0,kM);case"textInput":return t=e.data,t===kM&&MM?null:t;default:return null}}function mU(t,e){if(sp)return t==="compositionend"||!vC&&IO(t,e)?(t=kO(),lx=gC=cu=null,sp=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return MO&&e.locale!=="ko"?null:e.data;default:return null}}var gU={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function IM(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!gU[t.type]:e==="textarea"}function DO(t,e,r,n){uO(n),e=Vx(e,"onChange"),0<e.length&&(r=new yC("onChange","change",null,r,n),t.push({event:r,listeners:e}))}var yy=null,qy=null;function yU(t){GO(t,0)}function $b(t){var e=lp(t);if(nO(e))return t}function _U(t,e){if(t==="change")return e}var LO=!1;if(Ql){var r2;if(Ql){var n2="oninput"in document;if(!n2){var RM=document.createElement("div");RM.setAttribute("oninput","return;"),n2=typeof RM.oninput=="function"}r2=n2}else r2=!1;LO=r2&&(!document.documentMode||9<document.documentMode)}function DM(){yy&&(yy.detachEvent("onpropertychange",OO),qy=yy=null)}function OO(t){if(t.propertyName==="value"&&$b(qy)){var e=[];DO(e,qy,t,hC(t)),pO(yU,e)}}function vU(t,e,r){t==="focusin"?(DM(),yy=e,qy=r,yy.attachEvent("onpropertychange",OO)):t==="focusout"&&DM()}function xU(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return $b(qy)}function bU(t,e){if(t==="click")return $b(e)}function wU(t,e){if(t==="input"||t==="change")return $b(e)}function SU(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var Aa=typeof Object.is=="function"?Object.is:SU;function Hy(t,e){if(Aa(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var r=Object.keys(t),n=Object.keys(e);if(r.length!==n.length)return!1;for(n=0;n<r.length;n++){var s=r[n];if(!SS.call(e,s)||!Aa(t[s],e[s]))return!1}return!0}function LM(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function OM(t,e){var r=LM(t);t=0;for(var n;r;){if(r.nodeType===3){if(n=t+r.textContent.length,t<=e&&n>=e)return{node:r,offset:e-t};t=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=LM(r)}}function zO(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?zO(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function NO(){for(var t=window,e=Ox();e instanceof t.HTMLIFrameElement;){try{var r=typeof e.contentWindow.location.href=="string"}catch{r=!1}if(r)t=e.contentWindow;else break;e=Ox(t.document)}return e}function xC(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function TU(t){var e=NO(),r=t.focusedElem,n=t.selectionRange;if(e!==r&&r&&r.ownerDocument&&zO(r.ownerDocument.documentElement,r)){if(n!==null&&xC(r)){if(e=n.start,t=n.end,t===void 0&&(t=e),"selectionStart"in r)r.selectionStart=e,r.selectionEnd=Math.min(t,r.value.length);else if(t=(e=r.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var s=r.textContent.length,c=Math.min(n.start,s);n=n.end===void 0?c:Math.min(n.end,s),!t.extend&&c>n&&(s=n,n=c,c=s),s=OM(r,c);var l=OM(r,n);s&&l&&(t.rangeCount!==1||t.anchorNode!==s.node||t.anchorOffset!==s.offset||t.focusNode!==l.node||t.focusOffset!==l.offset)&&(e=e.createRange(),e.setStart(s.node,s.offset),t.removeAllRanges(),c>n?(t.addRange(e),t.extend(l.node,l.offset)):(e.setEnd(l.node,l.offset),t.addRange(e)))}}for(e=[],t=r;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof r.focus=="function"&&r.focus(),r=0;r<e.length;r++)t=e[r],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var EU=Ql&&"documentMode"in document&&11>=document.documentMode,op=null,VS=null,_y=null,US=!1;function zM(t,e,r){var n=r.window===r?r.document:r.nodeType===9?r:r.ownerDocument;US||op==null||op!==Ox(n)||(n=op,"selectionStart"in n&&xC(n)?n={start:n.selectionStart,end:n.selectionEnd}:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection(),n={anchorNode:n.anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset}),_y&&Hy(_y,n)||(_y=n,n=Vx(VS,"onSelect"),0<n.length&&(e=new yC("onSelect","select",null,e,r),t.push({event:e,listeners:n}),e.target=op)))}function Ev(t,e){var r={};return r[t.toLowerCase()]=e.toLowerCase(),r["Webkit"+t]="webkit"+e,r["Moz"+t]="moz"+e,r}var ap={animationend:Ev("Animation","AnimationEnd"),animationiteration:Ev("Animation","AnimationIteration"),animationstart:Ev("Animation","AnimationStart"),transitionend:Ev("Transition","TransitionEnd")},i2={},jO={};Ql&&(jO=document.createElement("div").style,"AnimationEvent"in window||(delete ap.animationend.animation,delete ap.animationiteration.animation,delete ap.animationstart.animation),"TransitionEvent"in window||delete ap.transitionend.transition);function Vb(t){if(i2[t])return i2[t];if(!ap[t])return t;var e=ap[t],r;for(r in e)if(e.hasOwnProperty(r)&&r in jO)return i2[t]=e[r];return t}var FO=Vb("animationend"),BO=Vb("animationiteration"),$O=Vb("animationstart"),VO=Vb("transitionend"),UO=new Map,NM="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function zu(t,e){UO.set(t,e),Ad(e,[t])}for(var s2=0;s2<NM.length;s2++){var o2=NM[s2],CU=o2.toLowerCase(),PU=o2[0].toUpperCase()+o2.slice(1);zu(CU,"on"+PU)}zu(FO,"onAnimationEnd");zu(BO,"onAnimationIteration");zu($O,"onAnimationStart");zu("dblclick","onDoubleClick");zu("focusin","onFocus");zu("focusout","onBlur");zu(VO,"onTransitionEnd");Hp("onMouseEnter",["mouseout","mouseover"]);Hp("onMouseLeave",["mouseout","mouseover"]);Hp("onPointerEnter",["pointerout","pointerover"]);Hp("onPointerLeave",["pointerout","pointerover"]);Ad("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Ad("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Ad("onBeforeInput",["compositionend","keypress","textInput","paste"]);Ad("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Ad("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Ad("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var ny="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),AU=new Set("cancel close invalid load scroll toggle".split(" ").concat(ny));function jM(t,e,r){var n=t.type||"unknown-event";t.currentTarget=r,CV(n,e,void 0,t),t.currentTarget=null}function GO(t,e){e=(e&4)!==0;for(var r=0;r<t.length;r++){var n=t[r],s=n.event;n=n.listeners;e:{var c=void 0;if(e)for(var l=n.length-1;0<=l;l--){var a=n[l],m=a.instance,y=a.currentTarget;if(a=a.listener,m!==c&&s.isPropagationStopped())break e;jM(s,a,y),c=m}else for(l=0;l<n.length;l++){if(a=n[l],m=a.instance,y=a.currentTarget,a=a.listener,m!==c&&s.isPropagationStopped())break e;jM(s,a,y),c=m}}}if(Nx)throw t=jS,Nx=!1,jS=null,t}function fn(t,e){var r=e[ZS];r===void 0&&(r=e[ZS]=new Set);var n=t+"__bubble";r.has(n)||(WO(e,t,2,!1),r.add(n))}function a2(t,e,r){var n=0;e&&(n|=4),WO(r,t,n,e)}var Cv="_reactListening"+Math.random().toString(36).slice(2);function Zy(t){if(!t[Cv]){t[Cv]=!0,Q3.forEach(function(r){r!=="selectionchange"&&(AU.has(r)||a2(r,!1,t),a2(r,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[Cv]||(e[Cv]=!0,a2("selectionchange",!1,e))}}function WO(t,e,r,n){switch(AO(e)){case 1:var s=VV;break;case 4:s=UV;break;default:s=mC}r=s.bind(null,e,r,t),s=void 0,!NS||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(s=!0),n?s!==void 0?t.addEventListener(e,r,{capture:!0,passive:s}):t.addEventListener(e,r,!0):s!==void 0?t.addEventListener(e,r,{passive:s}):t.addEventListener(e,r,!1)}function l2(t,e,r,n,s){var c=n;if(!(e&1)&&!(e&2)&&n!==null)e:for(;;){if(n===null)return;var l=n.tag;if(l===3||l===4){var a=n.stateNode.containerInfo;if(a===s||a.nodeType===8&&a.parentNode===s)break;if(l===4)for(l=n.return;l!==null;){var m=l.tag;if((m===3||m===4)&&(m=l.stateNode.containerInfo,m===s||m.nodeType===8&&m.parentNode===s))return;l=l.return}for(;a!==null;){if(l=Hh(a),l===null)return;if(m=l.tag,m===5||m===6){n=c=l;continue e}a=a.parentNode}}n=n.return}pO(function(){var y=c,v=hC(r),T=[];e:{var P=UO.get(t);if(P!==void 0){var A=yC,O=t;switch(t){case"keypress":if(cx(r)===0)break e;case"keydown":case"keyup":A=iU;break;case"focusin":O="focus",A=t2;break;case"focusout":O="blur",A=t2;break;case"beforeblur":case"afterblur":A=t2;break;case"click":if(r.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":A=CM;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":A=qV;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":A=aU;break;case FO:case BO:case $O:A=KV;break;case VO:A=cU;break;case"scroll":A=GV;break;case"wheel":A=hU;break;case"copy":case"cut":case"paste":A=YV;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":A=AM}var I=(e&4)!==0,L=!I&&t==="scroll",R=I?P!==null?P+"Capture":null:P;I=[];for(var z=y,j;z!==null;){j=z;var W=j.stateNode;if(j.tag===5&&W!==null&&(j=W,R!==null&&(W=Vy(z,R),W!=null&&I.push(Ky(z,W,j)))),L)break;z=z.return}0<I.length&&(P=new A(P,O,null,r,v),T.push({event:P,listeners:I}))}}if(!(e&7)){e:{if(P=t==="mouseover"||t==="pointerover",A=t==="mouseout"||t==="pointerout",P&&r!==OS&&(O=r.relatedTarget||r.fromElement)&&(Hh(O)||O[Jl]))break e;if((A||P)&&(P=v.window===v?v:(P=v.ownerDocument)?P.defaultView||P.parentWindow:window,A?(O=r.relatedTarget||r.toElement,A=y,O=O?Hh(O):null,O!==null&&(L=kd(O),O!==L||O.tag!==5&&O.tag!==6)&&(O=null)):(A=null,O=y),A!==O)){if(I=CM,W="onMouseLeave",R="onMouseEnter",z="mouse",(t==="pointerout"||t==="pointerover")&&(I=AM,W="onPointerLeave",R="onPointerEnter",z="pointer"),L=A==null?P:lp(A),j=O==null?P:lp(O),P=new I(W,z+"leave",A,r,v),P.target=L,P.relatedTarget=j,W=null,Hh(v)===y&&(I=new I(R,z+"enter",O,r,v),I.target=j,I.relatedTarget=L,W=I),L=W,A&&O)t:{for(I=A,R=O,z=0,j=I;j;j=$f(j))z++;for(j=0,W=R;W;W=$f(W))j++;for(;0<z-j;)I=$f(I),z--;for(;0<j-z;)R=$f(R),j--;for(;z--;){if(I===R||R!==null&&I===R.alternate)break t;I=$f(I),R=$f(R)}I=null}else I=null;A!==null&&FM(T,P,A,I,!1),O!==null&&L!==null&&FM(T,L,O,I,!0)}}e:{if(P=y?lp(y):window,A=P.nodeName&&P.nodeName.toLowerCase(),A==="select"||A==="input"&&P.type==="file")var Z=_U;else if(IM(P))if(LO)Z=wU;else{Z=xU;var te=vU}else(A=P.nodeName)&&A.toLowerCase()==="input"&&(P.type==="checkbox"||P.type==="radio")&&(Z=bU);if(Z&&(Z=Z(t,y))){DO(T,Z,r,v);break e}te&&te(t,P,y),t==="focusout"&&(te=P._wrapperState)&&te.controlled&&P.type==="number"&&MS(P,"number",P.value)}switch(te=y?lp(y):window,t){case"focusin":(IM(te)||te.contentEditable==="true")&&(op=te,VS=y,_y=null);break;case"focusout":_y=VS=op=null;break;case"mousedown":US=!0;break;case"contextmenu":case"mouseup":case"dragend":US=!1,zM(T,r,v);break;case"selectionchange":if(EU)break;case"keydown":case"keyup":zM(T,r,v)}var ie;if(vC)e:{switch(t){case"compositionstart":var V="onCompositionStart";break e;case"compositionend":V="onCompositionEnd";break e;case"compositionupdate":V="onCompositionUpdate";break e}V=void 0}else sp?IO(t,r)&&(V="onCompositionEnd"):t==="keydown"&&r.keyCode===229&&(V="onCompositionStart");V&&(MO&&r.locale!=="ko"&&(sp||V!=="onCompositionStart"?V==="onCompositionEnd"&&sp&&(ie=kO()):(cu=v,gC="value"in cu?cu.value:cu.textContent,sp=!0)),te=Vx(y,V),0<te.length&&(V=new PM(V,t,null,r,v),T.push({event:V,listeners:te}),ie?V.data=ie:(ie=RO(r),ie!==null&&(V.data=ie)))),(ie=fU?pU(t,r):mU(t,r))&&(y=Vx(y,"onBeforeInput"),0<y.length&&(v=new PM("onBeforeInput","beforeinput",null,r,v),T.push({event:v,listeners:y}),v.data=ie))}GO(T,e)})}function Ky(t,e,r){return{instance:t,listener:e,currentTarget:r}}function Vx(t,e){for(var r=e+"Capture",n=[];t!==null;){var s=t,c=s.stateNode;s.tag===5&&c!==null&&(s=c,c=Vy(t,r),c!=null&&n.unshift(Ky(t,c,s)),c=Vy(t,e),c!=null&&n.push(Ky(t,c,s))),t=t.return}return n}function $f(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function FM(t,e,r,n,s){for(var c=e._reactName,l=[];r!==null&&r!==n;){var a=r,m=a.alternate,y=a.stateNode;if(m!==null&&m===n)break;a.tag===5&&y!==null&&(a=y,s?(m=Vy(r,c),m!=null&&l.unshift(Ky(r,m,a))):s||(m=Vy(r,c),m!=null&&l.push(Ky(r,m,a)))),r=r.return}l.length!==0&&t.push({event:e,listeners:l})}var kU=/\r\n?/g,MU=/\u0000|\uFFFD/g;function BM(t){return(typeof t=="string"?t:""+t).replace(kU,`
`).replace(MU,"")}function Pv(t,e,r){if(e=BM(e),BM(t)!==e&&r)throw Error(gt(425))}function Ux(){}var GS=null,WS=null;function qS(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var HS=typeof setTimeout=="function"?setTimeout:void 0,IU=typeof clearTimeout=="function"?clearTimeout:void 0,$M=typeof Promise=="function"?Promise:void 0,RU=typeof queueMicrotask=="function"?queueMicrotask:typeof $M<"u"?function(t){return $M.resolve(null).then(t).catch(DU)}:HS;function DU(t){setTimeout(function(){throw t})}function c2(t,e){var r=e,n=0;do{var s=r.nextSibling;if(t.removeChild(r),s&&s.nodeType===8)if(r=s.data,r==="/$"){if(n===0){t.removeChild(s),Wy(e);return}n--}else r!=="$"&&r!=="$?"&&r!=="$!"||n++;r=s}while(r);Wy(e)}function _u(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function VM(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var r=t.data;if(r==="$"||r==="$!"||r==="$?"){if(e===0)return t;e--}else r==="/$"&&e++}t=t.previousSibling}return null}var pm=Math.random().toString(36).slice(2),nl="__reactFiber$"+pm,Xy="__reactProps$"+pm,Jl="__reactContainer$"+pm,ZS="__reactEvents$"+pm,LU="__reactListeners$"+pm,OU="__reactHandles$"+pm;function Hh(t){var e=t[nl];if(e)return e;for(var r=t.parentNode;r;){if(e=r[Jl]||r[nl]){if(r=e.alternate,e.child!==null||r!==null&&r.child!==null)for(t=VM(t);t!==null;){if(r=t[nl])return r;t=VM(t)}return e}t=r,r=t.parentNode}return null}function j0(t){return t=t[nl]||t[Jl],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function lp(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(gt(33))}function Ub(t){return t[Xy]||null}var KS=[],cp=-1;function Nu(t){return{current:t}}function pn(t){0>cp||(t.current=KS[cp],KS[cp]=null,cp--)}function ln(t,e){cp++,KS[cp]=t.current,t.current=e}var Pu={},ps=Nu(Pu),Zs=Nu(!1),_d=Pu;function Zp(t,e){var r=t.type.contextTypes;if(!r)return Pu;var n=t.stateNode;if(n&&n.__reactInternalMemoizedUnmaskedChildContext===e)return n.__reactInternalMemoizedMaskedChildContext;var s={},c;for(c in r)s[c]=e[c];return n&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=s),s}function Ks(t){return t=t.childContextTypes,t!=null}function Gx(){pn(Zs),pn(ps)}function UM(t,e,r){if(ps.current!==Pu)throw Error(gt(168));ln(ps,e),ln(Zs,r)}function qO(t,e,r){var n=t.stateNode;if(e=e.childContextTypes,typeof n.getChildContext!="function")return r;n=n.getChildContext();for(var s in n)if(!(s in e))throw Error(gt(108,vV(t)||"Unknown",s));return zn({},r,n)}function Wx(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||Pu,_d=ps.current,ln(ps,t),ln(Zs,Zs.current),!0}function GM(t,e,r){var n=t.stateNode;if(!n)throw Error(gt(169));r?(t=qO(t,e,_d),n.__reactInternalMemoizedMergedChildContext=t,pn(Zs),pn(ps),ln(ps,t)):pn(Zs),ln(Zs,r)}var ql=null,Gb=!1,u2=!1;function HO(t){ql===null?ql=[t]:ql.push(t)}function zU(t){Gb=!0,HO(t)}function ju(){if(!u2&&ql!==null){u2=!0;var t=0,e=Wr;try{var r=ql;for(Wr=1;t<r.length;t++){var n=r[t];do n=n(!0);while(n!==null)}ql=null,Gb=!1}catch(s){throw ql!==null&&(ql=ql.slice(t+1)),_O(dC,ju),s}finally{Wr=e,u2=!1}}return null}var up=[],hp=0,qx=null,Hx=0,Wo=[],qo=0,vd=null,Kl=1,Xl="";function Nh(t,e){up[hp++]=Hx,up[hp++]=qx,qx=t,Hx=e}function ZO(t,e,r){Wo[qo++]=Kl,Wo[qo++]=Xl,Wo[qo++]=vd,vd=t;var n=Kl;t=Xl;var s=32-Ta(n)-1;n&=~(1<<s),r+=1;var c=32-Ta(e)+s;if(30<c){var l=s-s%5;c=(n&(1<<l)-1).toString(32),n>>=l,s-=l,Kl=1<<32-Ta(e)+s|r<<s|n,Xl=c+t}else Kl=1<<c|r<<s|n,Xl=t}function bC(t){t.return!==null&&(Nh(t,1),ZO(t,1,0))}function wC(t){for(;t===qx;)qx=up[--hp],up[hp]=null,Hx=up[--hp],up[hp]=null;for(;t===vd;)vd=Wo[--qo],Wo[qo]=null,Xl=Wo[--qo],Wo[qo]=null,Kl=Wo[--qo],Wo[qo]=null}var To=null,wo=null,xn=!1,wa=null;function KO(t,e){var r=Ho(5,null,null,0);r.elementType="DELETED",r.stateNode=e,r.return=t,e=t.deletions,e===null?(t.deletions=[r],t.flags|=16):e.push(r)}function WM(t,e){switch(t.tag){case 5:var r=t.type;return e=e.nodeType!==1||r.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,To=t,wo=_u(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,To=t,wo=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(r=vd!==null?{id:Kl,overflow:Xl}:null,t.memoizedState={dehydrated:e,treeContext:r,retryLane:1073741824},r=Ho(18,null,null,0),r.stateNode=e,r.return=t,t.child=r,To=t,wo=null,!0):!1;default:return!1}}function XS(t){return(t.mode&1)!==0&&(t.flags&128)===0}function YS(t){if(xn){var e=wo;if(e){var r=e;if(!WM(t,e)){if(XS(t))throw Error(gt(418));e=_u(r.nextSibling);var n=To;e&&WM(t,e)?KO(n,r):(t.flags=t.flags&-4097|2,xn=!1,To=t)}}else{if(XS(t))throw Error(gt(418));t.flags=t.flags&-4097|2,xn=!1,To=t}}}function qM(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;To=t}function Av(t){if(t!==To)return!1;if(!xn)return qM(t),xn=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!qS(t.type,t.memoizedProps)),e&&(e=wo)){if(XS(t))throw XO(),Error(gt(418));for(;e;)KO(t,e),e=_u(e.nextSibling)}if(qM(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(gt(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var r=t.data;if(r==="/$"){if(e===0){wo=_u(t.nextSibling);break e}e--}else r!=="$"&&r!=="$!"&&r!=="$?"||e++}t=t.nextSibling}wo=null}}else wo=To?_u(t.stateNode.nextSibling):null;return!0}function XO(){for(var t=wo;t;)t=_u(t.nextSibling)}function Kp(){wo=To=null,xn=!1}function SC(t){wa===null?wa=[t]:wa.push(t)}var NU=dc.ReactCurrentBatchConfig;function $g(t,e,r){if(t=r.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(r._owner){if(r=r._owner,r){if(r.tag!==1)throw Error(gt(309));var n=r.stateNode}if(!n)throw Error(gt(147,t));var s=n,c=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===c?e.ref:(e=function(l){var a=s.refs;l===null?delete a[c]:a[c]=l},e._stringRef=c,e)}if(typeof t!="string")throw Error(gt(284));if(!r._owner)throw Error(gt(290,t))}return t}function kv(t,e){throw t=Object.prototype.toString.call(e),Error(gt(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function HM(t){var e=t._init;return e(t._payload)}function YO(t){function e(R,z){if(t){var j=R.deletions;j===null?(R.deletions=[z],R.flags|=16):j.push(z)}}function r(R,z){if(!t)return null;for(;z!==null;)e(R,z),z=z.sibling;return null}function n(R,z){for(R=new Map;z!==null;)z.key!==null?R.set(z.key,z):R.set(z.index,z),z=z.sibling;return R}function s(R,z){return R=wu(R,z),R.index=0,R.sibling=null,R}function c(R,z,j){return R.index=j,t?(j=R.alternate,j!==null?(j=j.index,j<z?(R.flags|=2,z):j):(R.flags|=2,z)):(R.flags|=1048576,z)}function l(R){return t&&R.alternate===null&&(R.flags|=2),R}function a(R,z,j,W){return z===null||z.tag!==6?(z=y2(j,R.mode,W),z.return=R,z):(z=s(z,j),z.return=R,z)}function m(R,z,j,W){var Z=j.type;return Z===ip?v(R,z,j.props.children,W,j.key):z!==null&&(z.elementType===Z||typeof Z=="object"&&Z!==null&&Z.$$typeof===Qc&&HM(Z)===z.type)?(W=s(z,j.props),W.ref=$g(R,z,j),W.return=R,W):(W=gx(j.type,j.key,j.props,null,R.mode,W),W.ref=$g(R,z,j),W.return=R,W)}function y(R,z,j,W){return z===null||z.tag!==4||z.stateNode.containerInfo!==j.containerInfo||z.stateNode.implementation!==j.implementation?(z=_2(j,R.mode,W),z.return=R,z):(z=s(z,j.children||[]),z.return=R,z)}function v(R,z,j,W,Z){return z===null||z.tag!==7?(z=ud(j,R.mode,W,Z),z.return=R,z):(z=s(z,j),z.return=R,z)}function T(R,z,j){if(typeof z=="string"&&z!==""||typeof z=="number")return z=y2(""+z,R.mode,j),z.return=R,z;if(typeof z=="object"&&z!==null){switch(z.$$typeof){case _v:return j=gx(z.type,z.key,z.props,null,R.mode,j),j.ref=$g(R,null,z),j.return=R,j;case np:return z=_2(z,R.mode,j),z.return=R,z;case Qc:var W=z._init;return T(R,W(z._payload),j)}if(ty(z)||zg(z))return z=ud(z,R.mode,j,null),z.return=R,z;kv(R,z)}return null}function P(R,z,j,W){var Z=z!==null?z.key:null;if(typeof j=="string"&&j!==""||typeof j=="number")return Z!==null?null:a(R,z,""+j,W);if(typeof j=="object"&&j!==null){switch(j.$$typeof){case _v:return j.key===Z?m(R,z,j,W):null;case np:return j.key===Z?y(R,z,j,W):null;case Qc:return Z=j._init,P(R,z,Z(j._payload),W)}if(ty(j)||zg(j))return Z!==null?null:v(R,z,j,W,null);kv(R,j)}return null}function A(R,z,j,W,Z){if(typeof W=="string"&&W!==""||typeof W=="number")return R=R.get(j)||null,a(z,R,""+W,Z);if(typeof W=="object"&&W!==null){switch(W.$$typeof){case _v:return R=R.get(W.key===null?j:W.key)||null,m(z,R,W,Z);case np:return R=R.get(W.key===null?j:W.key)||null,y(z,R,W,Z);case Qc:var te=W._init;return A(R,z,j,te(W._payload),Z)}if(ty(W)||zg(W))return R=R.get(j)||null,v(z,R,W,Z,null);kv(z,W)}return null}function O(R,z,j,W){for(var Z=null,te=null,ie=z,V=z=0,q=null;ie!==null&&V<j.length;V++){ie.index>V?(q=ie,ie=null):q=ie.sibling;var Q=P(R,ie,j[V],W);if(Q===null){ie===null&&(ie=q);break}t&&ie&&Q.alternate===null&&e(R,ie),z=c(Q,z,V),te===null?Z=Q:te.sibling=Q,te=Q,ie=q}if(V===j.length)return r(R,ie),xn&&Nh(R,V),Z;if(ie===null){for(;V<j.length;V++)ie=T(R,j[V],W),ie!==null&&(z=c(ie,z,V),te===null?Z=ie:te.sibling=ie,te=ie);return xn&&Nh(R,V),Z}for(ie=n(R,ie);V<j.length;V++)q=A(ie,R,V,j[V],W),q!==null&&(t&&q.alternate!==null&&ie.delete(q.key===null?V:q.key),z=c(q,z,V),te===null?Z=q:te.sibling=q,te=q);return t&&ie.forEach(function(ce){return e(R,ce)}),xn&&Nh(R,V),Z}function I(R,z,j,W){var Z=zg(j);if(typeof Z!="function")throw Error(gt(150));if(j=Z.call(j),j==null)throw Error(gt(151));for(var te=Z=null,ie=z,V=z=0,q=null,Q=j.next();ie!==null&&!Q.done;V++,Q=j.next()){ie.index>V?(q=ie,ie=null):q=ie.sibling;var ce=P(R,ie,Q.value,W);if(ce===null){ie===null&&(ie=q);break}t&&ie&&ce.alternate===null&&e(R,ie),z=c(ce,z,V),te===null?Z=ce:te.sibling=ce,te=ce,ie=q}if(Q.done)return r(R,ie),xn&&Nh(R,V),Z;if(ie===null){for(;!Q.done;V++,Q=j.next())Q=T(R,Q.value,W),Q!==null&&(z=c(Q,z,V),te===null?Z=Q:te.sibling=Q,te=Q);return xn&&Nh(R,V),Z}for(ie=n(R,ie);!Q.done;V++,Q=j.next())Q=A(ie,R,V,Q.value,W),Q!==null&&(t&&Q.alternate!==null&&ie.delete(Q.key===null?V:Q.key),z=c(Q,z,V),te===null?Z=Q:te.sibling=Q,te=Q);return t&&ie.forEach(function(se){return e(R,se)}),xn&&Nh(R,V),Z}function L(R,z,j,W){if(typeof j=="object"&&j!==null&&j.type===ip&&j.key===null&&(j=j.props.children),typeof j=="object"&&j!==null){switch(j.$$typeof){case _v:e:{for(var Z=j.key,te=z;te!==null;){if(te.key===Z){if(Z=j.type,Z===ip){if(te.tag===7){r(R,te.sibling),z=s(te,j.props.children),z.return=R,R=z;break e}}else if(te.elementType===Z||typeof Z=="object"&&Z!==null&&Z.$$typeof===Qc&&HM(Z)===te.type){r(R,te.sibling),z=s(te,j.props),z.ref=$g(R,te,j),z.return=R,R=z;break e}r(R,te);break}else e(R,te);te=te.sibling}j.type===ip?(z=ud(j.props.children,R.mode,W,j.key),z.return=R,R=z):(W=gx(j.type,j.key,j.props,null,R.mode,W),W.ref=$g(R,z,j),W.return=R,R=W)}return l(R);case np:e:{for(te=j.key;z!==null;){if(z.key===te)if(z.tag===4&&z.stateNode.containerInfo===j.containerInfo&&z.stateNode.implementation===j.implementation){r(R,z.sibling),z=s(z,j.children||[]),z.return=R,R=z;break e}else{r(R,z);break}else e(R,z);z=z.sibling}z=_2(j,R.mode,W),z.return=R,R=z}return l(R);case Qc:return te=j._init,L(R,z,te(j._payload),W)}if(ty(j))return O(R,z,j,W);if(zg(j))return I(R,z,j,W);kv(R,j)}return typeof j=="string"&&j!==""||typeof j=="number"?(j=""+j,z!==null&&z.tag===6?(r(R,z.sibling),z=s(z,j),z.return=R,R=z):(r(R,z),z=y2(j,R.mode,W),z.return=R,R=z),l(R)):r(R,z)}return L}var Xp=YO(!0),QO=YO(!1),Zx=Nu(null),Kx=null,dp=null,TC=null;function EC(){TC=dp=Kx=null}function CC(t){var e=Zx.current;pn(Zx),t._currentValue=e}function QS(t,e,r){for(;t!==null;){var n=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,n!==null&&(n.childLanes|=e)):n!==null&&(n.childLanes&e)!==e&&(n.childLanes|=e),t===r)break;t=t.return}}function Cp(t,e){Kx=t,TC=dp=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(qs=!0),t.firstContext=null)}function ea(t){var e=t._currentValue;if(TC!==t)if(t={context:t,memoizedValue:e,next:null},dp===null){if(Kx===null)throw Error(gt(308));dp=t,Kx.dependencies={lanes:0,firstContext:t}}else dp=dp.next=t;return e}var Zh=null;function PC(t){Zh===null?Zh=[t]:Zh.push(t)}function JO(t,e,r,n){var s=e.interleaved;return s===null?(r.next=r,PC(e)):(r.next=s.next,s.next=r),e.interleaved=r,ec(t,n)}function ec(t,e){t.lanes|=e;var r=t.alternate;for(r!==null&&(r.lanes|=e),r=t,t=t.return;t!==null;)t.childLanes|=e,r=t.alternate,r!==null&&(r.childLanes|=e),r=t,t=t.return;return r.tag===3?r.stateNode:null}var Jc=!1;function AC(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function ez(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function Yl(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function vu(t,e,r){var n=t.updateQueue;if(n===null)return null;if(n=n.shared,Dr&2){var s=n.pending;return s===null?e.next=e:(e.next=s.next,s.next=e),n.pending=e,ec(t,r)}return s=n.interleaved,s===null?(e.next=e,PC(n)):(e.next=s.next,s.next=e),n.interleaved=e,ec(t,r)}function ux(t,e,r){if(e=e.updateQueue,e!==null&&(e=e.shared,(r&4194240)!==0)){var n=e.lanes;n&=t.pendingLanes,r|=n,e.lanes=r,fC(t,r)}}function ZM(t,e){var r=t.updateQueue,n=t.alternate;if(n!==null&&(n=n.updateQueue,r===n)){var s=null,c=null;if(r=r.firstBaseUpdate,r!==null){do{var l={eventTime:r.eventTime,lane:r.lane,tag:r.tag,payload:r.payload,callback:r.callback,next:null};c===null?s=c=l:c=c.next=l,r=r.next}while(r!==null);c===null?s=c=e:c=c.next=e}else s=c=e;r={baseState:n.baseState,firstBaseUpdate:s,lastBaseUpdate:c,shared:n.shared,effects:n.effects},t.updateQueue=r;return}t=r.lastBaseUpdate,t===null?r.firstBaseUpdate=e:t.next=e,r.lastBaseUpdate=e}function Xx(t,e,r,n){var s=t.updateQueue;Jc=!1;var c=s.firstBaseUpdate,l=s.lastBaseUpdate,a=s.shared.pending;if(a!==null){s.shared.pending=null;var m=a,y=m.next;m.next=null,l===null?c=y:l.next=y,l=m;var v=t.alternate;v!==null&&(v=v.updateQueue,a=v.lastBaseUpdate,a!==l&&(a===null?v.firstBaseUpdate=y:a.next=y,v.lastBaseUpdate=m))}if(c!==null){var T=s.baseState;l=0,v=y=m=null,a=c;do{var P=a.lane,A=a.eventTime;if((n&P)===P){v!==null&&(v=v.next={eventTime:A,lane:0,tag:a.tag,payload:a.payload,callback:a.callback,next:null});e:{var O=t,I=a;switch(P=e,A=r,I.tag){case 1:if(O=I.payload,typeof O=="function"){T=O.call(A,T,P);break e}T=O;break e;case 3:O.flags=O.flags&-65537|128;case 0:if(O=I.payload,P=typeof O=="function"?O.call(A,T,P):O,P==null)break e;T=zn({},T,P);break e;case 2:Jc=!0}}a.callback!==null&&a.lane!==0&&(t.flags|=64,P=s.effects,P===null?s.effects=[a]:P.push(a))}else A={eventTime:A,lane:P,tag:a.tag,payload:a.payload,callback:a.callback,next:null},v===null?(y=v=A,m=T):v=v.next=A,l|=P;if(a=a.next,a===null){if(a=s.shared.pending,a===null)break;P=a,a=P.next,P.next=null,s.lastBaseUpdate=P,s.shared.pending=null}}while(!0);if(v===null&&(m=T),s.baseState=m,s.firstBaseUpdate=y,s.lastBaseUpdate=v,e=s.shared.interleaved,e!==null){s=e;do l|=s.lane,s=s.next;while(s!==e)}else c===null&&(s.shared.lanes=0);bd|=l,t.lanes=l,t.memoizedState=T}}function KM(t,e,r){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var n=t[e],s=n.callback;if(s!==null){if(n.callback=null,n=r,typeof s!="function")throw Error(gt(191,s));s.call(n)}}}var F0={},dl=Nu(F0),Yy=Nu(F0),Qy=Nu(F0);function Kh(t){if(t===F0)throw Error(gt(174));return t}function kC(t,e){switch(ln(Qy,e),ln(Yy,t),ln(dl,F0),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:RS(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=RS(e,t)}pn(dl),ln(dl,e)}function Yp(){pn(dl),pn(Yy),pn(Qy)}function tz(t){Kh(Qy.current);var e=Kh(dl.current),r=RS(e,t.type);e!==r&&(ln(Yy,t),ln(dl,r))}function MC(t){Yy.current===t&&(pn(dl),pn(Yy))}var Mn=Nu(0);function Yx(t){for(var e=t;e!==null;){if(e.tag===13){var r=e.memoizedState;if(r!==null&&(r=r.dehydrated,r===null||r.data==="$?"||r.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var h2=[];function IC(){for(var t=0;t<h2.length;t++)h2[t]._workInProgressVersionPrimary=null;h2.length=0}var hx=dc.ReactCurrentDispatcher,d2=dc.ReactCurrentBatchConfig,xd=0,On=null,Mi=null,Ni=null,Qx=!1,vy=!1,Jy=0,jU=0;function as(){throw Error(gt(321))}function RC(t,e){if(e===null)return!1;for(var r=0;r<e.length&&r<t.length;r++)if(!Aa(t[r],e[r]))return!1;return!0}function DC(t,e,r,n,s,c){if(xd=c,On=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,hx.current=t===null||t.memoizedState===null?VU:UU,t=r(n,s),vy){c=0;do{if(vy=!1,Jy=0,25<=c)throw Error(gt(301));c+=1,Ni=Mi=null,e.updateQueue=null,hx.current=GU,t=r(n,s)}while(vy)}if(hx.current=Jx,e=Mi!==null&&Mi.next!==null,xd=0,Ni=Mi=On=null,Qx=!1,e)throw Error(gt(300));return t}function LC(){var t=Jy!==0;return Jy=0,t}function Ka(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Ni===null?On.memoizedState=Ni=t:Ni=Ni.next=t,Ni}function ta(){if(Mi===null){var t=On.alternate;t=t!==null?t.memoizedState:null}else t=Mi.next;var e=Ni===null?On.memoizedState:Ni.next;if(e!==null)Ni=e,Mi=t;else{if(t===null)throw Error(gt(310));Mi=t,t={memoizedState:Mi.memoizedState,baseState:Mi.baseState,baseQueue:Mi.baseQueue,queue:Mi.queue,next:null},Ni===null?On.memoizedState=Ni=t:Ni=Ni.next=t}return Ni}function e0(t,e){return typeof e=="function"?e(t):e}function f2(t){var e=ta(),r=e.queue;if(r===null)throw Error(gt(311));r.lastRenderedReducer=t;var n=Mi,s=n.baseQueue,c=r.pending;if(c!==null){if(s!==null){var l=s.next;s.next=c.next,c.next=l}n.baseQueue=s=c,r.pending=null}if(s!==null){c=s.next,n=n.baseState;var a=l=null,m=null,y=c;do{var v=y.lane;if((xd&v)===v)m!==null&&(m=m.next={lane:0,action:y.action,hasEagerState:y.hasEagerState,eagerState:y.eagerState,next:null}),n=y.hasEagerState?y.eagerState:t(n,y.action);else{var T={lane:v,action:y.action,hasEagerState:y.hasEagerState,eagerState:y.eagerState,next:null};m===null?(a=m=T,l=n):m=m.next=T,On.lanes|=v,bd|=v}y=y.next}while(y!==null&&y!==c);m===null?l=n:m.next=a,Aa(n,e.memoizedState)||(qs=!0),e.memoizedState=n,e.baseState=l,e.baseQueue=m,r.lastRenderedState=n}if(t=r.interleaved,t!==null){s=t;do c=s.lane,On.lanes|=c,bd|=c,s=s.next;while(s!==t)}else s===null&&(r.lanes=0);return[e.memoizedState,r.dispatch]}function p2(t){var e=ta(),r=e.queue;if(r===null)throw Error(gt(311));r.lastRenderedReducer=t;var n=r.dispatch,s=r.pending,c=e.memoizedState;if(s!==null){r.pending=null;var l=s=s.next;do c=t(c,l.action),l=l.next;while(l!==s);Aa(c,e.memoizedState)||(qs=!0),e.memoizedState=c,e.baseQueue===null&&(e.baseState=c),r.lastRenderedState=c}return[c,n]}function rz(){}function nz(t,e){var r=On,n=ta(),s=e(),c=!Aa(n.memoizedState,s);if(c&&(n.memoizedState=s,qs=!0),n=n.queue,OC(oz.bind(null,r,n,t),[t]),n.getSnapshot!==e||c||Ni!==null&&Ni.memoizedState.tag&1){if(r.flags|=2048,t0(9,sz.bind(null,r,n,s,e),void 0,null),ji===null)throw Error(gt(349));xd&30||iz(r,e,s)}return s}function iz(t,e,r){t.flags|=16384,t={getSnapshot:e,value:r},e=On.updateQueue,e===null?(e={lastEffect:null,stores:null},On.updateQueue=e,e.stores=[t]):(r=e.stores,r===null?e.stores=[t]:r.push(t))}function sz(t,e,r,n){e.value=r,e.getSnapshot=n,az(e)&&lz(t)}function oz(t,e,r){return r(function(){az(e)&&lz(t)})}function az(t){var e=t.getSnapshot;t=t.value;try{var r=e();return!Aa(t,r)}catch{return!0}}function lz(t){var e=ec(t,1);e!==null&&Ea(e,t,1,-1)}function XM(t){var e=Ka();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e0,lastRenderedState:t},e.queue=t,t=t.dispatch=$U.bind(null,On,t),[e.memoizedState,t]}function t0(t,e,r,n){return t={tag:t,create:e,destroy:r,deps:n,next:null},e=On.updateQueue,e===null?(e={lastEffect:null,stores:null},On.updateQueue=e,e.lastEffect=t.next=t):(r=e.lastEffect,r===null?e.lastEffect=t.next=t:(n=r.next,r.next=t,t.next=n,e.lastEffect=t)),t}function cz(){return ta().memoizedState}function dx(t,e,r,n){var s=Ka();On.flags|=t,s.memoizedState=t0(1|e,r,void 0,n===void 0?null:n)}function Wb(t,e,r,n){var s=ta();n=n===void 0?null:n;var c=void 0;if(Mi!==null){var l=Mi.memoizedState;if(c=l.destroy,n!==null&&RC(n,l.deps)){s.memoizedState=t0(e,r,c,n);return}}On.flags|=t,s.memoizedState=t0(1|e,r,c,n)}function YM(t,e){return dx(8390656,8,t,e)}function OC(t,e){return Wb(2048,8,t,e)}function uz(t,e){return Wb(4,2,t,e)}function hz(t,e){return Wb(4,4,t,e)}function dz(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function fz(t,e,r){return r=r!=null?r.concat([t]):null,Wb(4,4,dz.bind(null,e,t),r)}function zC(){}function pz(t,e){var r=ta();e=e===void 0?null:e;var n=r.memoizedState;return n!==null&&e!==null&&RC(e,n[1])?n[0]:(r.memoizedState=[t,e],t)}function mz(t,e){var r=ta();e=e===void 0?null:e;var n=r.memoizedState;return n!==null&&e!==null&&RC(e,n[1])?n[0]:(t=t(),r.memoizedState=[t,e],t)}function gz(t,e,r){return xd&21?(Aa(r,e)||(r=bO(),On.lanes|=r,bd|=r,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,qs=!0),t.memoizedState=r)}function FU(t,e){var r=Wr;Wr=r!==0&&4>r?r:4,t(!0);var n=d2.transition;d2.transition={};try{t(!1),e()}finally{Wr=r,d2.transition=n}}function yz(){return ta().memoizedState}function BU(t,e,r){var n=bu(t);if(r={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null},_z(t))vz(e,r);else if(r=JO(t,e,r,n),r!==null){var s=Ms();Ea(r,t,n,s),xz(r,e,n)}}function $U(t,e,r){var n=bu(t),s={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null};if(_z(t))vz(e,s);else{var c=t.alternate;if(t.lanes===0&&(c===null||c.lanes===0)&&(c=e.lastRenderedReducer,c!==null))try{var l=e.lastRenderedState,a=c(l,r);if(s.hasEagerState=!0,s.eagerState=a,Aa(a,l)){var m=e.interleaved;m===null?(s.next=s,PC(e)):(s.next=m.next,m.next=s),e.interleaved=s;return}}catch{}finally{}r=JO(t,e,s,n),r!==null&&(s=Ms(),Ea(r,t,n,s),xz(r,e,n))}}function _z(t){var e=t.alternate;return t===On||e!==null&&e===On}function vz(t,e){vy=Qx=!0;var r=t.pending;r===null?e.next=e:(e.next=r.next,r.next=e),t.pending=e}function xz(t,e,r){if(r&4194240){var n=e.lanes;n&=t.pendingLanes,r|=n,e.lanes=r,fC(t,r)}}var Jx={readContext:ea,useCallback:as,useContext:as,useEffect:as,useImperativeHandle:as,useInsertionEffect:as,useLayoutEffect:as,useMemo:as,useReducer:as,useRef:as,useState:as,useDebugValue:as,useDeferredValue:as,useTransition:as,useMutableSource:as,useSyncExternalStore:as,useId:as,unstable_isNewReconciler:!1},VU={readContext:ea,useCallback:function(t,e){return Ka().memoizedState=[t,e===void 0?null:e],t},useContext:ea,useEffect:YM,useImperativeHandle:function(t,e,r){return r=r!=null?r.concat([t]):null,dx(4194308,4,dz.bind(null,e,t),r)},useLayoutEffect:function(t,e){return dx(4194308,4,t,e)},useInsertionEffect:function(t,e){return dx(4,2,t,e)},useMemo:function(t,e){var r=Ka();return e=e===void 0?null:e,t=t(),r.memoizedState=[t,e],t},useReducer:function(t,e,r){var n=Ka();return e=r!==void 0?r(e):e,n.memoizedState=n.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},n.queue=t,t=t.dispatch=BU.bind(null,On,t),[n.memoizedState,t]},useRef:function(t){var e=Ka();return t={current:t},e.memoizedState=t},useState:XM,useDebugValue:zC,useDeferredValue:function(t){return Ka().memoizedState=t},useTransition:function(){var t=XM(!1),e=t[0];return t=FU.bind(null,t[1]),Ka().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,r){var n=On,s=Ka();if(xn){if(r===void 0)throw Error(gt(407));r=r()}else{if(r=e(),ji===null)throw Error(gt(349));xd&30||iz(n,e,r)}s.memoizedState=r;var c={value:r,getSnapshot:e};return s.queue=c,YM(oz.bind(null,n,c,t),[t]),n.flags|=2048,t0(9,sz.bind(null,n,c,r,e),void 0,null),r},useId:function(){var t=Ka(),e=ji.identifierPrefix;if(xn){var r=Xl,n=Kl;r=(n&~(1<<32-Ta(n)-1)).toString(32)+r,e=":"+e+"R"+r,r=Jy++,0<r&&(e+="H"+r.toString(32)),e+=":"}else r=jU++,e=":"+e+"r"+r.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},UU={readContext:ea,useCallback:pz,useContext:ea,useEffect:OC,useImperativeHandle:fz,useInsertionEffect:uz,useLayoutEffect:hz,useMemo:mz,useReducer:f2,useRef:cz,useState:function(){return f2(e0)},useDebugValue:zC,useDeferredValue:function(t){var e=ta();return gz(e,Mi.memoizedState,t)},useTransition:function(){var t=f2(e0)[0],e=ta().memoizedState;return[t,e]},useMutableSource:rz,useSyncExternalStore:nz,useId:yz,unstable_isNewReconciler:!1},GU={readContext:ea,useCallback:pz,useContext:ea,useEffect:OC,useImperativeHandle:fz,useInsertionEffect:uz,useLayoutEffect:hz,useMemo:mz,useReducer:p2,useRef:cz,useState:function(){return p2(e0)},useDebugValue:zC,useDeferredValue:function(t){var e=ta();return Mi===null?e.memoizedState=t:gz(e,Mi.memoizedState,t)},useTransition:function(){var t=p2(e0)[0],e=ta().memoizedState;return[t,e]},useMutableSource:rz,useSyncExternalStore:nz,useId:yz,unstable_isNewReconciler:!1};function ga(t,e){if(t&&t.defaultProps){e=zn({},e),t=t.defaultProps;for(var r in t)e[r]===void 0&&(e[r]=t[r]);return e}return e}function JS(t,e,r,n){e=t.memoizedState,r=r(n,e),r=r==null?e:zn({},e,r),t.memoizedState=r,t.lanes===0&&(t.updateQueue.baseState=r)}var qb={isMounted:function(t){return(t=t._reactInternals)?kd(t)===t:!1},enqueueSetState:function(t,e,r){t=t._reactInternals;var n=Ms(),s=bu(t),c=Yl(n,s);c.payload=e,r!=null&&(c.callback=r),e=vu(t,c,s),e!==null&&(Ea(e,t,s,n),ux(e,t,s))},enqueueReplaceState:function(t,e,r){t=t._reactInternals;var n=Ms(),s=bu(t),c=Yl(n,s);c.tag=1,c.payload=e,r!=null&&(c.callback=r),e=vu(t,c,s),e!==null&&(Ea(e,t,s,n),ux(e,t,s))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var r=Ms(),n=bu(t),s=Yl(r,n);s.tag=2,e!=null&&(s.callback=e),e=vu(t,s,n),e!==null&&(Ea(e,t,n,r),ux(e,t,n))}};function QM(t,e,r,n,s,c,l){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(n,c,l):e.prototype&&e.prototype.isPureReactComponent?!Hy(r,n)||!Hy(s,c):!0}function bz(t,e,r){var n=!1,s=Pu,c=e.contextType;return typeof c=="object"&&c!==null?c=ea(c):(s=Ks(e)?_d:ps.current,n=e.contextTypes,c=(n=n!=null)?Zp(t,s):Pu),e=new e(r,c),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=qb,t.stateNode=e,e._reactInternals=t,n&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=s,t.__reactInternalMemoizedMaskedChildContext=c),e}function JM(t,e,r,n){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(r,n),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(r,n),e.state!==t&&qb.enqueueReplaceState(e,e.state,null)}function eT(t,e,r,n){var s=t.stateNode;s.props=r,s.state=t.memoizedState,s.refs={},AC(t);var c=e.contextType;typeof c=="object"&&c!==null?s.context=ea(c):(c=Ks(e)?_d:ps.current,s.context=Zp(t,c)),s.state=t.memoizedState,c=e.getDerivedStateFromProps,typeof c=="function"&&(JS(t,e,c,r),s.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof s.getSnapshotBeforeUpdate=="function"||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(e=s.state,typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount(),e!==s.state&&qb.enqueueReplaceState(s,s.state,null),Xx(t,r,s,n),s.state=t.memoizedState),typeof s.componentDidMount=="function"&&(t.flags|=4194308)}function Qp(t,e){try{var r="",n=e;do r+=_V(n),n=n.return;while(n);var s=r}catch(c){s=`
Error generating stack: `+c.message+`
`+c.stack}return{value:t,source:e,stack:s,digest:null}}function m2(t,e,r){return{value:t,source:null,stack:r??null,digest:e??null}}function tT(t,e){try{console.error(e.value)}catch(r){setTimeout(function(){throw r})}}var WU=typeof WeakMap=="function"?WeakMap:Map;function wz(t,e,r){r=Yl(-1,r),r.tag=3,r.payload={element:null};var n=e.value;return r.callback=function(){tb||(tb=!0,hT=n),tT(t,e)},r}function Sz(t,e,r){r=Yl(-1,r),r.tag=3;var n=t.type.getDerivedStateFromError;if(typeof n=="function"){var s=e.value;r.payload=function(){return n(s)},r.callback=function(){tT(t,e)}}var c=t.stateNode;return c!==null&&typeof c.componentDidCatch=="function"&&(r.callback=function(){tT(t,e),typeof n!="function"&&(xu===null?xu=new Set([this]):xu.add(this));var l=e.stack;this.componentDidCatch(e.value,{componentStack:l!==null?l:""})}),r}function eI(t,e,r){var n=t.pingCache;if(n===null){n=t.pingCache=new WU;var s=new Set;n.set(e,s)}else s=n.get(e),s===void 0&&(s=new Set,n.set(e,s));s.has(r)||(s.add(r),t=s7.bind(null,t,e,r),e.then(t,t))}function tI(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function rI(t,e,r,n,s){return t.mode&1?(t.flags|=65536,t.lanes=s,t):(t===e?t.flags|=65536:(t.flags|=128,r.flags|=131072,r.flags&=-52805,r.tag===1&&(r.alternate===null?r.tag=17:(e=Yl(-1,1),e.tag=2,vu(r,e,1))),r.lanes|=1),t)}var qU=dc.ReactCurrentOwner,qs=!1;function Cs(t,e,r,n){e.child=t===null?QO(e,null,r,n):Xp(e,t.child,r,n)}function nI(t,e,r,n,s){r=r.render;var c=e.ref;return Cp(e,s),n=DC(t,e,r,n,c,s),r=LC(),t!==null&&!qs?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~s,tc(t,e,s)):(xn&&r&&bC(e),e.flags|=1,Cs(t,e,n,s),e.child)}function iI(t,e,r,n,s){if(t===null){var c=r.type;return typeof c=="function"&&!GC(c)&&c.defaultProps===void 0&&r.compare===null&&r.defaultProps===void 0?(e.tag=15,e.type=c,Tz(t,e,c,n,s)):(t=gx(r.type,null,n,e,e.mode,s),t.ref=e.ref,t.return=e,e.child=t)}if(c=t.child,!(t.lanes&s)){var l=c.memoizedProps;if(r=r.compare,r=r!==null?r:Hy,r(l,n)&&t.ref===e.ref)return tc(t,e,s)}return e.flags|=1,t=wu(c,n),t.ref=e.ref,t.return=e,e.child=t}function Tz(t,e,r,n,s){if(t!==null){var c=t.memoizedProps;if(Hy(c,n)&&t.ref===e.ref)if(qs=!1,e.pendingProps=n=c,(t.lanes&s)!==0)t.flags&131072&&(qs=!0);else return e.lanes=t.lanes,tc(t,e,s)}return rT(t,e,r,n,s)}function Ez(t,e,r){var n=e.pendingProps,s=n.children,c=t!==null?t.memoizedState:null;if(n.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},ln(pp,yo),yo|=r;else{if(!(r&1073741824))return t=c!==null?c.baseLanes|r:r,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,ln(pp,yo),yo|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},n=c!==null?c.baseLanes:r,ln(pp,yo),yo|=n}else c!==null?(n=c.baseLanes|r,e.memoizedState=null):n=r,ln(pp,yo),yo|=n;return Cs(t,e,s,r),e.child}function Cz(t,e){var r=e.ref;(t===null&&r!==null||t!==null&&t.ref!==r)&&(e.flags|=512,e.flags|=2097152)}function rT(t,e,r,n,s){var c=Ks(r)?_d:ps.current;return c=Zp(e,c),Cp(e,s),r=DC(t,e,r,n,c,s),n=LC(),t!==null&&!qs?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~s,tc(t,e,s)):(xn&&n&&bC(e),e.flags|=1,Cs(t,e,r,s),e.child)}function sI(t,e,r,n,s){if(Ks(r)){var c=!0;Wx(e)}else c=!1;if(Cp(e,s),e.stateNode===null)fx(t,e),bz(e,r,n),eT(e,r,n,s),n=!0;else if(t===null){var l=e.stateNode,a=e.memoizedProps;l.props=a;var m=l.context,y=r.contextType;typeof y=="object"&&y!==null?y=ea(y):(y=Ks(r)?_d:ps.current,y=Zp(e,y));var v=r.getDerivedStateFromProps,T=typeof v=="function"||typeof l.getSnapshotBeforeUpdate=="function";T||typeof l.UNSAFE_componentWillReceiveProps!="function"&&typeof l.componentWillReceiveProps!="function"||(a!==n||m!==y)&&JM(e,l,n,y),Jc=!1;var P=e.memoizedState;l.state=P,Xx(e,n,l,s),m=e.memoizedState,a!==n||P!==m||Zs.current||Jc?(typeof v=="function"&&(JS(e,r,v,n),m=e.memoizedState),(a=Jc||QM(e,r,a,n,P,m,y))?(T||typeof l.UNSAFE_componentWillMount!="function"&&typeof l.componentWillMount!="function"||(typeof l.componentWillMount=="function"&&l.componentWillMount(),typeof l.UNSAFE_componentWillMount=="function"&&l.UNSAFE_componentWillMount()),typeof l.componentDidMount=="function"&&(e.flags|=4194308)):(typeof l.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=n,e.memoizedState=m),l.props=n,l.state=m,l.context=y,n=a):(typeof l.componentDidMount=="function"&&(e.flags|=4194308),n=!1)}else{l=e.stateNode,ez(t,e),a=e.memoizedProps,y=e.type===e.elementType?a:ga(e.type,a),l.props=y,T=e.pendingProps,P=l.context,m=r.contextType,typeof m=="object"&&m!==null?m=ea(m):(m=Ks(r)?_d:ps.current,m=Zp(e,m));var A=r.getDerivedStateFromProps;(v=typeof A=="function"||typeof l.getSnapshotBeforeUpdate=="function")||typeof l.UNSAFE_componentWillReceiveProps!="function"&&typeof l.componentWillReceiveProps!="function"||(a!==T||P!==m)&&JM(e,l,n,m),Jc=!1,P=e.memoizedState,l.state=P,Xx(e,n,l,s);var O=e.memoizedState;a!==T||P!==O||Zs.current||Jc?(typeof A=="function"&&(JS(e,r,A,n),O=e.memoizedState),(y=Jc||QM(e,r,y,n,P,O,m)||!1)?(v||typeof l.UNSAFE_componentWillUpdate!="function"&&typeof l.componentWillUpdate!="function"||(typeof l.componentWillUpdate=="function"&&l.componentWillUpdate(n,O,m),typeof l.UNSAFE_componentWillUpdate=="function"&&l.UNSAFE_componentWillUpdate(n,O,m)),typeof l.componentDidUpdate=="function"&&(e.flags|=4),typeof l.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof l.componentDidUpdate!="function"||a===t.memoizedProps&&P===t.memoizedState||(e.flags|=4),typeof l.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&P===t.memoizedState||(e.flags|=1024),e.memoizedProps=n,e.memoizedState=O),l.props=n,l.state=O,l.context=m,n=y):(typeof l.componentDidUpdate!="function"||a===t.memoizedProps&&P===t.memoizedState||(e.flags|=4),typeof l.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&P===t.memoizedState||(e.flags|=1024),n=!1)}return nT(t,e,r,n,c,s)}function nT(t,e,r,n,s,c){Cz(t,e);var l=(e.flags&128)!==0;if(!n&&!l)return s&&GM(e,r,!1),tc(t,e,c);n=e.stateNode,qU.current=e;var a=l&&typeof r.getDerivedStateFromError!="function"?null:n.render();return e.flags|=1,t!==null&&l?(e.child=Xp(e,t.child,null,c),e.child=Xp(e,null,a,c)):Cs(t,e,a,c),e.memoizedState=n.state,s&&GM(e,r,!0),e.child}function Pz(t){var e=t.stateNode;e.pendingContext?UM(t,e.pendingContext,e.pendingContext!==e.context):e.context&&UM(t,e.context,!1),kC(t,e.containerInfo)}function oI(t,e,r,n,s){return Kp(),SC(s),e.flags|=256,Cs(t,e,r,n),e.child}var iT={dehydrated:null,treeContext:null,retryLane:0};function sT(t){return{baseLanes:t,cachePool:null,transitions:null}}function Az(t,e,r){var n=e.pendingProps,s=Mn.current,c=!1,l=(e.flags&128)!==0,a;if((a=l)||(a=t!==null&&t.memoizedState===null?!1:(s&2)!==0),a?(c=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(s|=1),ln(Mn,s&1),t===null)return YS(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(l=n.children,t=n.fallback,c?(n=e.mode,c=e.child,l={mode:"hidden",children:l},!(n&1)&&c!==null?(c.childLanes=0,c.pendingProps=l):c=Kb(l,n,0,null),t=ud(t,n,r,null),c.return=e,t.return=e,c.sibling=t,e.child=c,e.child.memoizedState=sT(r),e.memoizedState=iT,t):NC(e,l));if(s=t.memoizedState,s!==null&&(a=s.dehydrated,a!==null))return HU(t,e,l,n,a,s,r);if(c){c=n.fallback,l=e.mode,s=t.child,a=s.sibling;var m={mode:"hidden",children:n.children};return!(l&1)&&e.child!==s?(n=e.child,n.childLanes=0,n.pendingProps=m,e.deletions=null):(n=wu(s,m),n.subtreeFlags=s.subtreeFlags&14680064),a!==null?c=wu(a,c):(c=ud(c,l,r,null),c.flags|=2),c.return=e,n.return=e,n.sibling=c,e.child=n,n=c,c=e.child,l=t.child.memoizedState,l=l===null?sT(r):{baseLanes:l.baseLanes|r,cachePool:null,transitions:l.transitions},c.memoizedState=l,c.childLanes=t.childLanes&~r,e.memoizedState=iT,n}return c=t.child,t=c.sibling,n=wu(c,{mode:"visible",children:n.children}),!(e.mode&1)&&(n.lanes=r),n.return=e,n.sibling=null,t!==null&&(r=e.deletions,r===null?(e.deletions=[t],e.flags|=16):r.push(t)),e.child=n,e.memoizedState=null,n}function NC(t,e){return e=Kb({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function Mv(t,e,r,n){return n!==null&&SC(n),Xp(e,t.child,null,r),t=NC(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function HU(t,e,r,n,s,c,l){if(r)return e.flags&256?(e.flags&=-257,n=m2(Error(gt(422))),Mv(t,e,l,n)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(c=n.fallback,s=e.mode,n=Kb({mode:"visible",children:n.children},s,0,null),c=ud(c,s,l,null),c.flags|=2,n.return=e,c.return=e,n.sibling=c,e.child=n,e.mode&1&&Xp(e,t.child,null,l),e.child.memoizedState=sT(l),e.memoizedState=iT,c);if(!(e.mode&1))return Mv(t,e,l,null);if(s.data==="$!"){if(n=s.nextSibling&&s.nextSibling.dataset,n)var a=n.dgst;return n=a,c=Error(gt(419)),n=m2(c,n,void 0),Mv(t,e,l,n)}if(a=(l&t.childLanes)!==0,qs||a){if(n=ji,n!==null){switch(l&-l){case 4:s=2;break;case 16:s=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:s=32;break;case 536870912:s=268435456;break;default:s=0}s=s&(n.suspendedLanes|l)?0:s,s!==0&&s!==c.retryLane&&(c.retryLane=s,ec(t,s),Ea(n,t,s,-1))}return UC(),n=m2(Error(gt(421))),Mv(t,e,l,n)}return s.data==="$?"?(e.flags|=128,e.child=t.child,e=o7.bind(null,t),s._reactRetry=e,null):(t=c.treeContext,wo=_u(s.nextSibling),To=e,xn=!0,wa=null,t!==null&&(Wo[qo++]=Kl,Wo[qo++]=Xl,Wo[qo++]=vd,Kl=t.id,Xl=t.overflow,vd=e),e=NC(e,n.children),e.flags|=4096,e)}function aI(t,e,r){t.lanes|=e;var n=t.alternate;n!==null&&(n.lanes|=e),QS(t.return,e,r)}function g2(t,e,r,n,s){var c=t.memoizedState;c===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:n,tail:r,tailMode:s}:(c.isBackwards=e,c.rendering=null,c.renderingStartTime=0,c.last=n,c.tail=r,c.tailMode=s)}function kz(t,e,r){var n=e.pendingProps,s=n.revealOrder,c=n.tail;if(Cs(t,e,n.children,r),n=Mn.current,n&2)n=n&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&aI(t,r,e);else if(t.tag===19)aI(t,r,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}n&=1}if(ln(Mn,n),!(e.mode&1))e.memoizedState=null;else switch(s){case"forwards":for(r=e.child,s=null;r!==null;)t=r.alternate,t!==null&&Yx(t)===null&&(s=r),r=r.sibling;r=s,r===null?(s=e.child,e.child=null):(s=r.sibling,r.sibling=null),g2(e,!1,s,r,c);break;case"backwards":for(r=null,s=e.child,e.child=null;s!==null;){if(t=s.alternate,t!==null&&Yx(t)===null){e.child=s;break}t=s.sibling,s.sibling=r,r=s,s=t}g2(e,!0,r,null,c);break;case"together":g2(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function fx(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function tc(t,e,r){if(t!==null&&(e.dependencies=t.dependencies),bd|=e.lanes,!(r&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(gt(153));if(e.child!==null){for(t=e.child,r=wu(t,t.pendingProps),e.child=r,r.return=e;t.sibling!==null;)t=t.sibling,r=r.sibling=wu(t,t.pendingProps),r.return=e;r.sibling=null}return e.child}function ZU(t,e,r){switch(e.tag){case 3:Pz(e),Kp();break;case 5:tz(e);break;case 1:Ks(e.type)&&Wx(e);break;case 4:kC(e,e.stateNode.containerInfo);break;case 10:var n=e.type._context,s=e.memoizedProps.value;ln(Zx,n._currentValue),n._currentValue=s;break;case 13:if(n=e.memoizedState,n!==null)return n.dehydrated!==null?(ln(Mn,Mn.current&1),e.flags|=128,null):r&e.child.childLanes?Az(t,e,r):(ln(Mn,Mn.current&1),t=tc(t,e,r),t!==null?t.sibling:null);ln(Mn,Mn.current&1);break;case 19:if(n=(r&e.childLanes)!==0,t.flags&128){if(n)return kz(t,e,r);e.flags|=128}if(s=e.memoizedState,s!==null&&(s.rendering=null,s.tail=null,s.lastEffect=null),ln(Mn,Mn.current),n)break;return null;case 22:case 23:return e.lanes=0,Ez(t,e,r)}return tc(t,e,r)}var Mz,oT,Iz,Rz;Mz=function(t,e){for(var r=e.child;r!==null;){if(r.tag===5||r.tag===6)t.appendChild(r.stateNode);else if(r.tag!==4&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===e)break;for(;r.sibling===null;){if(r.return===null||r.return===e)return;r=r.return}r.sibling.return=r.return,r=r.sibling}};oT=function(){};Iz=function(t,e,r,n){var s=t.memoizedProps;if(s!==n){t=e.stateNode,Kh(dl.current);var c=null;switch(r){case"input":s=AS(t,s),n=AS(t,n),c=[];break;case"select":s=zn({},s,{value:void 0}),n=zn({},n,{value:void 0}),c=[];break;case"textarea":s=IS(t,s),n=IS(t,n),c=[];break;default:typeof s.onClick!="function"&&typeof n.onClick=="function"&&(t.onclick=Ux)}DS(r,n);var l;r=null;for(y in s)if(!n.hasOwnProperty(y)&&s.hasOwnProperty(y)&&s[y]!=null)if(y==="style"){var a=s[y];for(l in a)a.hasOwnProperty(l)&&(r||(r={}),r[l]="")}else y!=="dangerouslySetInnerHTML"&&y!=="children"&&y!=="suppressContentEditableWarning"&&y!=="suppressHydrationWarning"&&y!=="autoFocus"&&(By.hasOwnProperty(y)?c||(c=[]):(c=c||[]).push(y,null));for(y in n){var m=n[y];if(a=s!=null?s[y]:void 0,n.hasOwnProperty(y)&&m!==a&&(m!=null||a!=null))if(y==="style")if(a){for(l in a)!a.hasOwnProperty(l)||m&&m.hasOwnProperty(l)||(r||(r={}),r[l]="");for(l in m)m.hasOwnProperty(l)&&a[l]!==m[l]&&(r||(r={}),r[l]=m[l])}else r||(c||(c=[]),c.push(y,r)),r=m;else y==="dangerouslySetInnerHTML"?(m=m?m.__html:void 0,a=a?a.__html:void 0,m!=null&&a!==m&&(c=c||[]).push(y,m)):y==="children"?typeof m!="string"&&typeof m!="number"||(c=c||[]).push(y,""+m):y!=="suppressContentEditableWarning"&&y!=="suppressHydrationWarning"&&(By.hasOwnProperty(y)?(m!=null&&y==="onScroll"&&fn("scroll",t),c||a===m||(c=[])):(c=c||[]).push(y,m))}r&&(c=c||[]).push("style",r);var y=c;(e.updateQueue=y)&&(e.flags|=4)}};Rz=function(t,e,r,n){r!==n&&(e.flags|=4)};function Vg(t,e){if(!xn)switch(t.tailMode){case"hidden":e=t.tail;for(var r=null;e!==null;)e.alternate!==null&&(r=e),e=e.sibling;r===null?t.tail=null:r.sibling=null;break;case"collapsed":r=t.tail;for(var n=null;r!==null;)r.alternate!==null&&(n=r),r=r.sibling;n===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:n.sibling=null}}function ls(t){var e=t.alternate!==null&&t.alternate.child===t.child,r=0,n=0;if(e)for(var s=t.child;s!==null;)r|=s.lanes|s.childLanes,n|=s.subtreeFlags&14680064,n|=s.flags&14680064,s.return=t,s=s.sibling;else for(s=t.child;s!==null;)r|=s.lanes|s.childLanes,n|=s.subtreeFlags,n|=s.flags,s.return=t,s=s.sibling;return t.subtreeFlags|=n,t.childLanes=r,e}function KU(t,e,r){var n=e.pendingProps;switch(wC(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return ls(e),null;case 1:return Ks(e.type)&&Gx(),ls(e),null;case 3:return n=e.stateNode,Yp(),pn(Zs),pn(ps),IC(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),(t===null||t.child===null)&&(Av(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,wa!==null&&(pT(wa),wa=null))),oT(t,e),ls(e),null;case 5:MC(e);var s=Kh(Qy.current);if(r=e.type,t!==null&&e.stateNode!=null)Iz(t,e,r,n,s),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!n){if(e.stateNode===null)throw Error(gt(166));return ls(e),null}if(t=Kh(dl.current),Av(e)){n=e.stateNode,r=e.type;var c=e.memoizedProps;switch(n[nl]=e,n[Xy]=c,t=(e.mode&1)!==0,r){case"dialog":fn("cancel",n),fn("close",n);break;case"iframe":case"object":case"embed":fn("load",n);break;case"video":case"audio":for(s=0;s<ny.length;s++)fn(ny[s],n);break;case"source":fn("error",n);break;case"img":case"image":case"link":fn("error",n),fn("load",n);break;case"details":fn("toggle",n);break;case"input":gM(n,c),fn("invalid",n);break;case"select":n._wrapperState={wasMultiple:!!c.multiple},fn("invalid",n);break;case"textarea":_M(n,c),fn("invalid",n)}DS(r,c),s=null;for(var l in c)if(c.hasOwnProperty(l)){var a=c[l];l==="children"?typeof a=="string"?n.textContent!==a&&(c.suppressHydrationWarning!==!0&&Pv(n.textContent,a,t),s=["children",a]):typeof a=="number"&&n.textContent!==""+a&&(c.suppressHydrationWarning!==!0&&Pv(n.textContent,a,t),s=["children",""+a]):By.hasOwnProperty(l)&&a!=null&&l==="onScroll"&&fn("scroll",n)}switch(r){case"input":vv(n),yM(n,c,!0);break;case"textarea":vv(n),vM(n);break;case"select":case"option":break;default:typeof c.onClick=="function"&&(n.onclick=Ux)}n=s,e.updateQueue=n,n!==null&&(e.flags|=4)}else{l=s.nodeType===9?s:s.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=oO(r)),t==="http://www.w3.org/1999/xhtml"?r==="script"?(t=l.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof n.is=="string"?t=l.createElement(r,{is:n.is}):(t=l.createElement(r),r==="select"&&(l=t,n.multiple?l.multiple=!0:n.size&&(l.size=n.size))):t=l.createElementNS(t,r),t[nl]=e,t[Xy]=n,Mz(t,e,!1,!1),e.stateNode=t;e:{switch(l=LS(r,n),r){case"dialog":fn("cancel",t),fn("close",t),s=n;break;case"iframe":case"object":case"embed":fn("load",t),s=n;break;case"video":case"audio":for(s=0;s<ny.length;s++)fn(ny[s],t);s=n;break;case"source":fn("error",t),s=n;break;case"img":case"image":case"link":fn("error",t),fn("load",t),s=n;break;case"details":fn("toggle",t),s=n;break;case"input":gM(t,n),s=AS(t,n),fn("invalid",t);break;case"option":s=n;break;case"select":t._wrapperState={wasMultiple:!!n.multiple},s=zn({},n,{value:void 0}),fn("invalid",t);break;case"textarea":_M(t,n),s=IS(t,n),fn("invalid",t);break;default:s=n}DS(r,s),a=s;for(c in a)if(a.hasOwnProperty(c)){var m=a[c];c==="style"?cO(t,m):c==="dangerouslySetInnerHTML"?(m=m?m.__html:void 0,m!=null&&aO(t,m)):c==="children"?typeof m=="string"?(r!=="textarea"||m!=="")&&$y(t,m):typeof m=="number"&&$y(t,""+m):c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&c!=="autoFocus"&&(By.hasOwnProperty(c)?m!=null&&c==="onScroll"&&fn("scroll",t):m!=null&&aC(t,c,m,l))}switch(r){case"input":vv(t),yM(t,n,!1);break;case"textarea":vv(t),vM(t);break;case"option":n.value!=null&&t.setAttribute("value",""+Cu(n.value));break;case"select":t.multiple=!!n.multiple,c=n.value,c!=null?wp(t,!!n.multiple,c,!1):n.defaultValue!=null&&wp(t,!!n.multiple,n.defaultValue,!0);break;default:typeof s.onClick=="function"&&(t.onclick=Ux)}switch(r){case"button":case"input":case"select":case"textarea":n=!!n.autoFocus;break e;case"img":n=!0;break e;default:n=!1}}n&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return ls(e),null;case 6:if(t&&e.stateNode!=null)Rz(t,e,t.memoizedProps,n);else{if(typeof n!="string"&&e.stateNode===null)throw Error(gt(166));if(r=Kh(Qy.current),Kh(dl.current),Av(e)){if(n=e.stateNode,r=e.memoizedProps,n[nl]=e,(c=n.nodeValue!==r)&&(t=To,t!==null))switch(t.tag){case 3:Pv(n.nodeValue,r,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&Pv(n.nodeValue,r,(t.mode&1)!==0)}c&&(e.flags|=4)}else n=(r.nodeType===9?r:r.ownerDocument).createTextNode(n),n[nl]=e,e.stateNode=n}return ls(e),null;case 13:if(pn(Mn),n=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(xn&&wo!==null&&e.mode&1&&!(e.flags&128))XO(),Kp(),e.flags|=98560,c=!1;else if(c=Av(e),n!==null&&n.dehydrated!==null){if(t===null){if(!c)throw Error(gt(318));if(c=e.memoizedState,c=c!==null?c.dehydrated:null,!c)throw Error(gt(317));c[nl]=e}else Kp(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;ls(e),c=!1}else wa!==null&&(pT(wa),wa=null),c=!0;if(!c)return e.flags&65536?e:null}return e.flags&128?(e.lanes=r,e):(n=n!==null,n!==(t!==null&&t.memoizedState!==null)&&n&&(e.child.flags|=8192,e.mode&1&&(t===null||Mn.current&1?Ii===0&&(Ii=3):UC())),e.updateQueue!==null&&(e.flags|=4),ls(e),null);case 4:return Yp(),oT(t,e),t===null&&Zy(e.stateNode.containerInfo),ls(e),null;case 10:return CC(e.type._context),ls(e),null;case 17:return Ks(e.type)&&Gx(),ls(e),null;case 19:if(pn(Mn),c=e.memoizedState,c===null)return ls(e),null;if(n=(e.flags&128)!==0,l=c.rendering,l===null)if(n)Vg(c,!1);else{if(Ii!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(l=Yx(t),l!==null){for(e.flags|=128,Vg(c,!1),n=l.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),e.subtreeFlags=0,n=r,r=e.child;r!==null;)c=r,t=n,c.flags&=14680066,l=c.alternate,l===null?(c.childLanes=0,c.lanes=t,c.child=null,c.subtreeFlags=0,c.memoizedProps=null,c.memoizedState=null,c.updateQueue=null,c.dependencies=null,c.stateNode=null):(c.childLanes=l.childLanes,c.lanes=l.lanes,c.child=l.child,c.subtreeFlags=0,c.deletions=null,c.memoizedProps=l.memoizedProps,c.memoizedState=l.memoizedState,c.updateQueue=l.updateQueue,c.type=l.type,t=l.dependencies,c.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),r=r.sibling;return ln(Mn,Mn.current&1|2),e.child}t=t.sibling}c.tail!==null&&ei()>Jp&&(e.flags|=128,n=!0,Vg(c,!1),e.lanes=4194304)}else{if(!n)if(t=Yx(l),t!==null){if(e.flags|=128,n=!0,r=t.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),Vg(c,!0),c.tail===null&&c.tailMode==="hidden"&&!l.alternate&&!xn)return ls(e),null}else 2*ei()-c.renderingStartTime>Jp&&r!==1073741824&&(e.flags|=128,n=!0,Vg(c,!1),e.lanes=4194304);c.isBackwards?(l.sibling=e.child,e.child=l):(r=c.last,r!==null?r.sibling=l:e.child=l,c.last=l)}return c.tail!==null?(e=c.tail,c.rendering=e,c.tail=e.sibling,c.renderingStartTime=ei(),e.sibling=null,r=Mn.current,ln(Mn,n?r&1|2:r&1),e):(ls(e),null);case 22:case 23:return VC(),n=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==n&&(e.flags|=8192),n&&e.mode&1?yo&1073741824&&(ls(e),e.subtreeFlags&6&&(e.flags|=8192)):ls(e),null;case 24:return null;case 25:return null}throw Error(gt(156,e.tag))}function XU(t,e){switch(wC(e),e.tag){case 1:return Ks(e.type)&&Gx(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return Yp(),pn(Zs),pn(ps),IC(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return MC(e),null;case 13:if(pn(Mn),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(gt(340));Kp()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return pn(Mn),null;case 4:return Yp(),null;case 10:return CC(e.type._context),null;case 22:case 23:return VC(),null;case 24:return null;default:return null}}var Iv=!1,cs=!1,YU=typeof WeakSet=="function"?WeakSet:Set,zt=null;function fp(t,e){var r=t.ref;if(r!==null)if(typeof r=="function")try{r(null)}catch(n){Vn(t,e,n)}else r.current=null}function aT(t,e,r){try{r()}catch(n){Vn(t,e,n)}}var lI=!1;function QU(t,e){if(GS=Bx,t=NO(),xC(t)){if("selectionStart"in t)var r={start:t.selectionStart,end:t.selectionEnd};else e:{r=(r=t.ownerDocument)&&r.defaultView||window;var n=r.getSelection&&r.getSelection();if(n&&n.rangeCount!==0){r=n.anchorNode;var s=n.anchorOffset,c=n.focusNode;n=n.focusOffset;try{r.nodeType,c.nodeType}catch{r=null;break e}var l=0,a=-1,m=-1,y=0,v=0,T=t,P=null;t:for(;;){for(var A;T!==r||s!==0&&T.nodeType!==3||(a=l+s),T!==c||n!==0&&T.nodeType!==3||(m=l+n),T.nodeType===3&&(l+=T.nodeValue.length),(A=T.firstChild)!==null;)P=T,T=A;for(;;){if(T===t)break t;if(P===r&&++y===s&&(a=l),P===c&&++v===n&&(m=l),(A=T.nextSibling)!==null)break;T=P,P=T.parentNode}T=A}r=a===-1||m===-1?null:{start:a,end:m}}else r=null}r=r||{start:0,end:0}}else r=null;for(WS={focusedElem:t,selectionRange:r},Bx=!1,zt=e;zt!==null;)if(e=zt,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,zt=t;else for(;zt!==null;){e=zt;try{var O=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(O!==null){var I=O.memoizedProps,L=O.memoizedState,R=e.stateNode,z=R.getSnapshotBeforeUpdate(e.elementType===e.type?I:ga(e.type,I),L);R.__reactInternalSnapshotBeforeUpdate=z}break;case 3:var j=e.stateNode.containerInfo;j.nodeType===1?j.textContent="":j.nodeType===9&&j.documentElement&&j.removeChild(j.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(gt(163))}}catch(W){Vn(e,e.return,W)}if(t=e.sibling,t!==null){t.return=e.return,zt=t;break}zt=e.return}return O=lI,lI=!1,O}function xy(t,e,r){var n=e.updateQueue;if(n=n!==null?n.lastEffect:null,n!==null){var s=n=n.next;do{if((s.tag&t)===t){var c=s.destroy;s.destroy=void 0,c!==void 0&&aT(e,r,c)}s=s.next}while(s!==n)}}function Hb(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var r=e=e.next;do{if((r.tag&t)===t){var n=r.create;r.destroy=n()}r=r.next}while(r!==e)}}function lT(t){var e=t.ref;if(e!==null){var r=t.stateNode;switch(t.tag){case 5:t=r;break;default:t=r}typeof e=="function"?e(t):e.current=t}}function Dz(t){var e=t.alternate;e!==null&&(t.alternate=null,Dz(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[nl],delete e[Xy],delete e[ZS],delete e[LU],delete e[OU])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function Lz(t){return t.tag===5||t.tag===3||t.tag===4}function cI(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||Lz(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function cT(t,e,r){var n=t.tag;if(n===5||n===6)t=t.stateNode,e?r.nodeType===8?r.parentNode.insertBefore(t,e):r.insertBefore(t,e):(r.nodeType===8?(e=r.parentNode,e.insertBefore(t,r)):(e=r,e.appendChild(t)),r=r._reactRootContainer,r!=null||e.onclick!==null||(e.onclick=Ux));else if(n!==4&&(t=t.child,t!==null))for(cT(t,e,r),t=t.sibling;t!==null;)cT(t,e,r),t=t.sibling}function uT(t,e,r){var n=t.tag;if(n===5||n===6)t=t.stateNode,e?r.insertBefore(t,e):r.appendChild(t);else if(n!==4&&(t=t.child,t!==null))for(uT(t,e,r),t=t.sibling;t!==null;)uT(t,e,r),t=t.sibling}var Xi=null,xa=!1;function Uc(t,e,r){for(r=r.child;r!==null;)Oz(t,e,r),r=r.sibling}function Oz(t,e,r){if(hl&&typeof hl.onCommitFiberUnmount=="function")try{hl.onCommitFiberUnmount(Fb,r)}catch{}switch(r.tag){case 5:cs||fp(r,e);case 6:var n=Xi,s=xa;Xi=null,Uc(t,e,r),Xi=n,xa=s,Xi!==null&&(xa?(t=Xi,r=r.stateNode,t.nodeType===8?t.parentNode.removeChild(r):t.removeChild(r)):Xi.removeChild(r.stateNode));break;case 18:Xi!==null&&(xa?(t=Xi,r=r.stateNode,t.nodeType===8?c2(t.parentNode,r):t.nodeType===1&&c2(t,r),Wy(t)):c2(Xi,r.stateNode));break;case 4:n=Xi,s=xa,Xi=r.stateNode.containerInfo,xa=!0,Uc(t,e,r),Xi=n,xa=s;break;case 0:case 11:case 14:case 15:if(!cs&&(n=r.updateQueue,n!==null&&(n=n.lastEffect,n!==null))){s=n=n.next;do{var c=s,l=c.destroy;c=c.tag,l!==void 0&&(c&2||c&4)&&aT(r,e,l),s=s.next}while(s!==n)}Uc(t,e,r);break;case 1:if(!cs&&(fp(r,e),n=r.stateNode,typeof n.componentWillUnmount=="function"))try{n.props=r.memoizedProps,n.state=r.memoizedState,n.componentWillUnmount()}catch(a){Vn(r,e,a)}Uc(t,e,r);break;case 21:Uc(t,e,r);break;case 22:r.mode&1?(cs=(n=cs)||r.memoizedState!==null,Uc(t,e,r),cs=n):Uc(t,e,r);break;default:Uc(t,e,r)}}function uI(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var r=t.stateNode;r===null&&(r=t.stateNode=new YU),e.forEach(function(n){var s=a7.bind(null,t,n);r.has(n)||(r.add(n),n.then(s,s))})}}function ha(t,e){var r=e.deletions;if(r!==null)for(var n=0;n<r.length;n++){var s=r[n];try{var c=t,l=e,a=l;e:for(;a!==null;){switch(a.tag){case 5:Xi=a.stateNode,xa=!1;break e;case 3:Xi=a.stateNode.containerInfo,xa=!0;break e;case 4:Xi=a.stateNode.containerInfo,xa=!0;break e}a=a.return}if(Xi===null)throw Error(gt(160));Oz(c,l,s),Xi=null,xa=!1;var m=s.alternate;m!==null&&(m.return=null),s.return=null}catch(y){Vn(s,e,y)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)zz(e,t),e=e.sibling}function zz(t,e){var r=t.alternate,n=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(ha(e,t),Ha(t),n&4){try{xy(3,t,t.return),Hb(3,t)}catch(I){Vn(t,t.return,I)}try{xy(5,t,t.return)}catch(I){Vn(t,t.return,I)}}break;case 1:ha(e,t),Ha(t),n&512&&r!==null&&fp(r,r.return);break;case 5:if(ha(e,t),Ha(t),n&512&&r!==null&&fp(r,r.return),t.flags&32){var s=t.stateNode;try{$y(s,"")}catch(I){Vn(t,t.return,I)}}if(n&4&&(s=t.stateNode,s!=null)){var c=t.memoizedProps,l=r!==null?r.memoizedProps:c,a=t.type,m=t.updateQueue;if(t.updateQueue=null,m!==null)try{a==="input"&&c.type==="radio"&&c.name!=null&&iO(s,c),LS(a,l);var y=LS(a,c);for(l=0;l<m.length;l+=2){var v=m[l],T=m[l+1];v==="style"?cO(s,T):v==="dangerouslySetInnerHTML"?aO(s,T):v==="children"?$y(s,T):aC(s,v,T,y)}switch(a){case"input":kS(s,c);break;case"textarea":sO(s,c);break;case"select":var P=s._wrapperState.wasMultiple;s._wrapperState.wasMultiple=!!c.multiple;var A=c.value;A!=null?wp(s,!!c.multiple,A,!1):P!==!!c.multiple&&(c.defaultValue!=null?wp(s,!!c.multiple,c.defaultValue,!0):wp(s,!!c.multiple,c.multiple?[]:"",!1))}s[Xy]=c}catch(I){Vn(t,t.return,I)}}break;case 6:if(ha(e,t),Ha(t),n&4){if(t.stateNode===null)throw Error(gt(162));s=t.stateNode,c=t.memoizedProps;try{s.nodeValue=c}catch(I){Vn(t,t.return,I)}}break;case 3:if(ha(e,t),Ha(t),n&4&&r!==null&&r.memoizedState.isDehydrated)try{Wy(e.containerInfo)}catch(I){Vn(t,t.return,I)}break;case 4:ha(e,t),Ha(t);break;case 13:ha(e,t),Ha(t),s=t.child,s.flags&8192&&(c=s.memoizedState!==null,s.stateNode.isHidden=c,!c||s.alternate!==null&&s.alternate.memoizedState!==null||(BC=ei())),n&4&&uI(t);break;case 22:if(v=r!==null&&r.memoizedState!==null,t.mode&1?(cs=(y=cs)||v,ha(e,t),cs=y):ha(e,t),Ha(t),n&8192){if(y=t.memoizedState!==null,(t.stateNode.isHidden=y)&&!v&&t.mode&1)for(zt=t,v=t.child;v!==null;){for(T=zt=v;zt!==null;){switch(P=zt,A=P.child,P.tag){case 0:case 11:case 14:case 15:xy(4,P,P.return);break;case 1:fp(P,P.return);var O=P.stateNode;if(typeof O.componentWillUnmount=="function"){n=P,r=P.return;try{e=n,O.props=e.memoizedProps,O.state=e.memoizedState,O.componentWillUnmount()}catch(I){Vn(n,r,I)}}break;case 5:fp(P,P.return);break;case 22:if(P.memoizedState!==null){dI(T);continue}}A!==null?(A.return=P,zt=A):dI(T)}v=v.sibling}e:for(v=null,T=t;;){if(T.tag===5){if(v===null){v=T;try{s=T.stateNode,y?(c=s.style,typeof c.setProperty=="function"?c.setProperty("display","none","important"):c.display="none"):(a=T.stateNode,m=T.memoizedProps.style,l=m!=null&&m.hasOwnProperty("display")?m.display:null,a.style.display=lO("display",l))}catch(I){Vn(t,t.return,I)}}}else if(T.tag===6){if(v===null)try{T.stateNode.nodeValue=y?"":T.memoizedProps}catch(I){Vn(t,t.return,I)}}else if((T.tag!==22&&T.tag!==23||T.memoizedState===null||T===t)&&T.child!==null){T.child.return=T,T=T.child;continue}if(T===t)break e;for(;T.sibling===null;){if(T.return===null||T.return===t)break e;v===T&&(v=null),T=T.return}v===T&&(v=null),T.sibling.return=T.return,T=T.sibling}}break;case 19:ha(e,t),Ha(t),n&4&&uI(t);break;case 21:break;default:ha(e,t),Ha(t)}}function Ha(t){var e=t.flags;if(e&2){try{e:{for(var r=t.return;r!==null;){if(Lz(r)){var n=r;break e}r=r.return}throw Error(gt(160))}switch(n.tag){case 5:var s=n.stateNode;n.flags&32&&($y(s,""),n.flags&=-33);var c=cI(t);uT(t,c,s);break;case 3:case 4:var l=n.stateNode.containerInfo,a=cI(t);cT(t,a,l);break;default:throw Error(gt(161))}}catch(m){Vn(t,t.return,m)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function JU(t,e,r){zt=t,Nz(t)}function Nz(t,e,r){for(var n=(t.mode&1)!==0;zt!==null;){var s=zt,c=s.child;if(s.tag===22&&n){var l=s.memoizedState!==null||Iv;if(!l){var a=s.alternate,m=a!==null&&a.memoizedState!==null||cs;a=Iv;var y=cs;if(Iv=l,(cs=m)&&!y)for(zt=s;zt!==null;)l=zt,m=l.child,l.tag===22&&l.memoizedState!==null?fI(s):m!==null?(m.return=l,zt=m):fI(s);for(;c!==null;)zt=c,Nz(c),c=c.sibling;zt=s,Iv=a,cs=y}hI(t)}else s.subtreeFlags&8772&&c!==null?(c.return=s,zt=c):hI(t)}}function hI(t){for(;zt!==null;){var e=zt;if(e.flags&8772){var r=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:cs||Hb(5,e);break;case 1:var n=e.stateNode;if(e.flags&4&&!cs)if(r===null)n.componentDidMount();else{var s=e.elementType===e.type?r.memoizedProps:ga(e.type,r.memoizedProps);n.componentDidUpdate(s,r.memoizedState,n.__reactInternalSnapshotBeforeUpdate)}var c=e.updateQueue;c!==null&&KM(e,c,n);break;case 3:var l=e.updateQueue;if(l!==null){if(r=null,e.child!==null)switch(e.child.tag){case 5:r=e.child.stateNode;break;case 1:r=e.child.stateNode}KM(e,l,r)}break;case 5:var a=e.stateNode;if(r===null&&e.flags&4){r=a;var m=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":m.autoFocus&&r.focus();break;case"img":m.src&&(r.src=m.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var y=e.alternate;if(y!==null){var v=y.memoizedState;if(v!==null){var T=v.dehydrated;T!==null&&Wy(T)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(gt(163))}cs||e.flags&512&&lT(e)}catch(P){Vn(e,e.return,P)}}if(e===t){zt=null;break}if(r=e.sibling,r!==null){r.return=e.return,zt=r;break}zt=e.return}}function dI(t){for(;zt!==null;){var e=zt;if(e===t){zt=null;break}var r=e.sibling;if(r!==null){r.return=e.return,zt=r;break}zt=e.return}}function fI(t){for(;zt!==null;){var e=zt;try{switch(e.tag){case 0:case 11:case 15:var r=e.return;try{Hb(4,e)}catch(m){Vn(e,r,m)}break;case 1:var n=e.stateNode;if(typeof n.componentDidMount=="function"){var s=e.return;try{n.componentDidMount()}catch(m){Vn(e,s,m)}}var c=e.return;try{lT(e)}catch(m){Vn(e,c,m)}break;case 5:var l=e.return;try{lT(e)}catch(m){Vn(e,l,m)}}}catch(m){Vn(e,e.return,m)}if(e===t){zt=null;break}var a=e.sibling;if(a!==null){a.return=e.return,zt=a;break}zt=e.return}}var e7=Math.ceil,eb=dc.ReactCurrentDispatcher,jC=dc.ReactCurrentOwner,Qo=dc.ReactCurrentBatchConfig,Dr=0,ji=null,_i=null,Ji=0,yo=0,pp=Nu(0),Ii=0,r0=null,bd=0,Zb=0,FC=0,by=null,Gs=null,BC=0,Jp=1/0,Ul=null,tb=!1,hT=null,xu=null,Rv=!1,uu=null,rb=0,wy=0,dT=null,px=-1,mx=0;function Ms(){return Dr&6?ei():px!==-1?px:px=ei()}function bu(t){return t.mode&1?Dr&2&&Ji!==0?Ji&-Ji:NU.transition!==null?(mx===0&&(mx=bO()),mx):(t=Wr,t!==0||(t=window.event,t=t===void 0?16:AO(t.type)),t):1}function Ea(t,e,r,n){if(50<wy)throw wy=0,dT=null,Error(gt(185));z0(t,r,n),(!(Dr&2)||t!==ji)&&(t===ji&&(!(Dr&2)&&(Zb|=r),Ii===4&&tu(t,Ji)),Xs(t,n),r===1&&Dr===0&&!(e.mode&1)&&(Jp=ei()+500,Gb&&ju()))}function Xs(t,e){var r=t.callbackNode;NV(t,e);var n=Fx(t,t===ji?Ji:0);if(n===0)r!==null&&wM(r),t.callbackNode=null,t.callbackPriority=0;else if(e=n&-n,t.callbackPriority!==e){if(r!=null&&wM(r),e===1)t.tag===0?zU(pI.bind(null,t)):HO(pI.bind(null,t)),RU(function(){!(Dr&6)&&ju()}),r=null;else{switch(wO(n)){case 1:r=dC;break;case 4:r=vO;break;case 16:r=jx;break;case 536870912:r=xO;break;default:r=jx}r=Wz(r,jz.bind(null,t))}t.callbackPriority=e,t.callbackNode=r}}function jz(t,e){if(px=-1,mx=0,Dr&6)throw Error(gt(327));var r=t.callbackNode;if(Pp()&&t.callbackNode!==r)return null;var n=Fx(t,t===ji?Ji:0);if(n===0)return null;if(n&30||n&t.expiredLanes||e)e=nb(t,n);else{e=n;var s=Dr;Dr|=2;var c=Bz();(ji!==t||Ji!==e)&&(Ul=null,Jp=ei()+500,cd(t,e));do try{n7();break}catch(a){Fz(t,a)}while(!0);EC(),eb.current=c,Dr=s,_i!==null?e=0:(ji=null,Ji=0,e=Ii)}if(e!==0){if(e===2&&(s=FS(t),s!==0&&(n=s,e=fT(t,s))),e===1)throw r=r0,cd(t,0),tu(t,n),Xs(t,ei()),r;if(e===6)tu(t,n);else{if(s=t.current.alternate,!(n&30)&&!t7(s)&&(e=nb(t,n),e===2&&(c=FS(t),c!==0&&(n=c,e=fT(t,c))),e===1))throw r=r0,cd(t,0),tu(t,n),Xs(t,ei()),r;switch(t.finishedWork=s,t.finishedLanes=n,e){case 0:case 1:throw Error(gt(345));case 2:jh(t,Gs,Ul);break;case 3:if(tu(t,n),(n&130023424)===n&&(e=BC+500-ei(),10<e)){if(Fx(t,0)!==0)break;if(s=t.suspendedLanes,(s&n)!==n){Ms(),t.pingedLanes|=t.suspendedLanes&s;break}t.timeoutHandle=HS(jh.bind(null,t,Gs,Ul),e);break}jh(t,Gs,Ul);break;case 4:if(tu(t,n),(n&4194240)===n)break;for(e=t.eventTimes,s=-1;0<n;){var l=31-Ta(n);c=1<<l,l=e[l],l>s&&(s=l),n&=~c}if(n=s,n=ei()-n,n=(120>n?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*e7(n/1960))-n,10<n){t.timeoutHandle=HS(jh.bind(null,t,Gs,Ul),n);break}jh(t,Gs,Ul);break;case 5:jh(t,Gs,Ul);break;default:throw Error(gt(329))}}}return Xs(t,ei()),t.callbackNode===r?jz.bind(null,t):null}function fT(t,e){var r=by;return t.current.memoizedState.isDehydrated&&(cd(t,e).flags|=256),t=nb(t,e),t!==2&&(e=Gs,Gs=r,e!==null&&pT(e)),t}function pT(t){Gs===null?Gs=t:Gs.push.apply(Gs,t)}function t7(t){for(var e=t;;){if(e.flags&16384){var r=e.updateQueue;if(r!==null&&(r=r.stores,r!==null))for(var n=0;n<r.length;n++){var s=r[n],c=s.getSnapshot;s=s.value;try{if(!Aa(c(),s))return!1}catch{return!1}}}if(r=e.child,e.subtreeFlags&16384&&r!==null)r.return=e,e=r;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function tu(t,e){for(e&=~FC,e&=~Zb,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var r=31-Ta(e),n=1<<r;t[r]=-1,e&=~n}}function pI(t){if(Dr&6)throw Error(gt(327));Pp();var e=Fx(t,0);if(!(e&1))return Xs(t,ei()),null;var r=nb(t,e);if(t.tag!==0&&r===2){var n=FS(t);n!==0&&(e=n,r=fT(t,n))}if(r===1)throw r=r0,cd(t,0),tu(t,e),Xs(t,ei()),r;if(r===6)throw Error(gt(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,jh(t,Gs,Ul),Xs(t,ei()),null}function $C(t,e){var r=Dr;Dr|=1;try{return t(e)}finally{Dr=r,Dr===0&&(Jp=ei()+500,Gb&&ju())}}function wd(t){uu!==null&&uu.tag===0&&!(Dr&6)&&Pp();var e=Dr;Dr|=1;var r=Qo.transition,n=Wr;try{if(Qo.transition=null,Wr=1,t)return t()}finally{Wr=n,Qo.transition=r,Dr=e,!(Dr&6)&&ju()}}function VC(){yo=pp.current,pn(pp)}function cd(t,e){t.finishedWork=null,t.finishedLanes=0;var r=t.timeoutHandle;if(r!==-1&&(t.timeoutHandle=-1,IU(r)),_i!==null)for(r=_i.return;r!==null;){var n=r;switch(wC(n),n.tag){case 1:n=n.type.childContextTypes,n!=null&&Gx();break;case 3:Yp(),pn(Zs),pn(ps),IC();break;case 5:MC(n);break;case 4:Yp();break;case 13:pn(Mn);break;case 19:pn(Mn);break;case 10:CC(n.type._context);break;case 22:case 23:VC()}r=r.return}if(ji=t,_i=t=wu(t.current,null),Ji=yo=e,Ii=0,r0=null,FC=Zb=bd=0,Gs=by=null,Zh!==null){for(e=0;e<Zh.length;e++)if(r=Zh[e],n=r.interleaved,n!==null){r.interleaved=null;var s=n.next,c=r.pending;if(c!==null){var l=c.next;c.next=s,n.next=l}r.pending=n}Zh=null}return t}function Fz(t,e){do{var r=_i;try{if(EC(),hx.current=Jx,Qx){for(var n=On.memoizedState;n!==null;){var s=n.queue;s!==null&&(s.pending=null),n=n.next}Qx=!1}if(xd=0,Ni=Mi=On=null,vy=!1,Jy=0,jC.current=null,r===null||r.return===null){Ii=1,r0=e,_i=null;break}e:{var c=t,l=r.return,a=r,m=e;if(e=Ji,a.flags|=32768,m!==null&&typeof m=="object"&&typeof m.then=="function"){var y=m,v=a,T=v.tag;if(!(v.mode&1)&&(T===0||T===11||T===15)){var P=v.alternate;P?(v.updateQueue=P.updateQueue,v.memoizedState=P.memoizedState,v.lanes=P.lanes):(v.updateQueue=null,v.memoizedState=null)}var A=tI(l);if(A!==null){A.flags&=-257,rI(A,l,a,c,e),A.mode&1&&eI(c,y,e),e=A,m=y;var O=e.updateQueue;if(O===null){var I=new Set;I.add(m),e.updateQueue=I}else O.add(m);break e}else{if(!(e&1)){eI(c,y,e),UC();break e}m=Error(gt(426))}}else if(xn&&a.mode&1){var L=tI(l);if(L!==null){!(L.flags&65536)&&(L.flags|=256),rI(L,l,a,c,e),SC(Qp(m,a));break e}}c=m=Qp(m,a),Ii!==4&&(Ii=2),by===null?by=[c]:by.push(c),c=l;do{switch(c.tag){case 3:c.flags|=65536,e&=-e,c.lanes|=e;var R=wz(c,m,e);ZM(c,R);break e;case 1:a=m;var z=c.type,j=c.stateNode;if(!(c.flags&128)&&(typeof z.getDerivedStateFromError=="function"||j!==null&&typeof j.componentDidCatch=="function"&&(xu===null||!xu.has(j)))){c.flags|=65536,e&=-e,c.lanes|=e;var W=Sz(c,a,e);ZM(c,W);break e}}c=c.return}while(c!==null)}Vz(r)}catch(Z){e=Z,_i===r&&r!==null&&(_i=r=r.return);continue}break}while(!0)}function Bz(){var t=eb.current;return eb.current=Jx,t===null?Jx:t}function UC(){(Ii===0||Ii===3||Ii===2)&&(Ii=4),ji===null||!(bd&268435455)&&!(Zb&268435455)||tu(ji,Ji)}function nb(t,e){var r=Dr;Dr|=2;var n=Bz();(ji!==t||Ji!==e)&&(Ul=null,cd(t,e));do try{r7();break}catch(s){Fz(t,s)}while(!0);if(EC(),Dr=r,eb.current=n,_i!==null)throw Error(gt(261));return ji=null,Ji=0,Ii}function r7(){for(;_i!==null;)$z(_i)}function n7(){for(;_i!==null&&!AV();)$z(_i)}function $z(t){var e=Gz(t.alternate,t,yo);t.memoizedProps=t.pendingProps,e===null?Vz(t):_i=e,jC.current=null}function Vz(t){var e=t;do{var r=e.alternate;if(t=e.return,e.flags&32768){if(r=XU(r,e),r!==null){r.flags&=32767,_i=r;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{Ii=6,_i=null;return}}else if(r=KU(r,e,yo),r!==null){_i=r;return}if(e=e.sibling,e!==null){_i=e;return}_i=e=t}while(e!==null);Ii===0&&(Ii=5)}function jh(t,e,r){var n=Wr,s=Qo.transition;try{Qo.transition=null,Wr=1,i7(t,e,r,n)}finally{Qo.transition=s,Wr=n}return null}function i7(t,e,r,n){do Pp();while(uu!==null);if(Dr&6)throw Error(gt(327));r=t.finishedWork;var s=t.finishedLanes;if(r===null)return null;if(t.finishedWork=null,t.finishedLanes=0,r===t.current)throw Error(gt(177));t.callbackNode=null,t.callbackPriority=0;var c=r.lanes|r.childLanes;if(jV(t,c),t===ji&&(_i=ji=null,Ji=0),!(r.subtreeFlags&2064)&&!(r.flags&2064)||Rv||(Rv=!0,Wz(jx,function(){return Pp(),null})),c=(r.flags&15990)!==0,r.subtreeFlags&15990||c){c=Qo.transition,Qo.transition=null;var l=Wr;Wr=1;var a=Dr;Dr|=4,jC.current=null,QU(t,r),zz(r,t),TU(WS),Bx=!!GS,WS=GS=null,t.current=r,JU(r),kV(),Dr=a,Wr=l,Qo.transition=c}else t.current=r;if(Rv&&(Rv=!1,uu=t,rb=s),c=t.pendingLanes,c===0&&(xu=null),RV(r.stateNode),Xs(t,ei()),e!==null)for(n=t.onRecoverableError,r=0;r<e.length;r++)s=e[r],n(s.value,{componentStack:s.stack,digest:s.digest});if(tb)throw tb=!1,t=hT,hT=null,t;return rb&1&&t.tag!==0&&Pp(),c=t.pendingLanes,c&1?t===dT?wy++:(wy=0,dT=t):wy=0,ju(),null}function Pp(){if(uu!==null){var t=wO(rb),e=Qo.transition,r=Wr;try{if(Qo.transition=null,Wr=16>t?16:t,uu===null)var n=!1;else{if(t=uu,uu=null,rb=0,Dr&6)throw Error(gt(331));var s=Dr;for(Dr|=4,zt=t.current;zt!==null;){var c=zt,l=c.child;if(zt.flags&16){var a=c.deletions;if(a!==null){for(var m=0;m<a.length;m++){var y=a[m];for(zt=y;zt!==null;){var v=zt;switch(v.tag){case 0:case 11:case 15:xy(8,v,c)}var T=v.child;if(T!==null)T.return=v,zt=T;else for(;zt!==null;){v=zt;var P=v.sibling,A=v.return;if(Dz(v),v===y){zt=null;break}if(P!==null){P.return=A,zt=P;break}zt=A}}}var O=c.alternate;if(O!==null){var I=O.child;if(I!==null){O.child=null;do{var L=I.sibling;I.sibling=null,I=L}while(I!==null)}}zt=c}}if(c.subtreeFlags&2064&&l!==null)l.return=c,zt=l;else e:for(;zt!==null;){if(c=zt,c.flags&2048)switch(c.tag){case 0:case 11:case 15:xy(9,c,c.return)}var R=c.sibling;if(R!==null){R.return=c.return,zt=R;break e}zt=c.return}}var z=t.current;for(zt=z;zt!==null;){l=zt;var j=l.child;if(l.subtreeFlags&2064&&j!==null)j.return=l,zt=j;else e:for(l=z;zt!==null;){if(a=zt,a.flags&2048)try{switch(a.tag){case 0:case 11:case 15:Hb(9,a)}}catch(Z){Vn(a,a.return,Z)}if(a===l){zt=null;break e}var W=a.sibling;if(W!==null){W.return=a.return,zt=W;break e}zt=a.return}}if(Dr=s,ju(),hl&&typeof hl.onPostCommitFiberRoot=="function")try{hl.onPostCommitFiberRoot(Fb,t)}catch{}n=!0}return n}finally{Wr=r,Qo.transition=e}}return!1}function mI(t,e,r){e=Qp(r,e),e=wz(t,e,1),t=vu(t,e,1),e=Ms(),t!==null&&(z0(t,1,e),Xs(t,e))}function Vn(t,e,r){if(t.tag===3)mI(t,t,r);else for(;e!==null;){if(e.tag===3){mI(e,t,r);break}else if(e.tag===1){var n=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof n.componentDidCatch=="function"&&(xu===null||!xu.has(n))){t=Qp(r,t),t=Sz(e,t,1),e=vu(e,t,1),t=Ms(),e!==null&&(z0(e,1,t),Xs(e,t));break}}e=e.return}}function s7(t,e,r){var n=t.pingCache;n!==null&&n.delete(e),e=Ms(),t.pingedLanes|=t.suspendedLanes&r,ji===t&&(Ji&r)===r&&(Ii===4||Ii===3&&(Ji&130023424)===Ji&&500>ei()-BC?cd(t,0):FC|=r),Xs(t,e)}function Uz(t,e){e===0&&(t.mode&1?(e=wv,wv<<=1,!(wv&130023424)&&(wv=4194304)):e=1);var r=Ms();t=ec(t,e),t!==null&&(z0(t,e,r),Xs(t,r))}function o7(t){var e=t.memoizedState,r=0;e!==null&&(r=e.retryLane),Uz(t,r)}function a7(t,e){var r=0;switch(t.tag){case 13:var n=t.stateNode,s=t.memoizedState;s!==null&&(r=s.retryLane);break;case 19:n=t.stateNode;break;default:throw Error(gt(314))}n!==null&&n.delete(e),Uz(t,r)}var Gz;Gz=function(t,e,r){if(t!==null)if(t.memoizedProps!==e.pendingProps||Zs.current)qs=!0;else{if(!(t.lanes&r)&&!(e.flags&128))return qs=!1,ZU(t,e,r);qs=!!(t.flags&131072)}else qs=!1,xn&&e.flags&1048576&&ZO(e,Hx,e.index);switch(e.lanes=0,e.tag){case 2:var n=e.type;fx(t,e),t=e.pendingProps;var s=Zp(e,ps.current);Cp(e,r),s=DC(null,e,n,t,s,r);var c=LC();return e.flags|=1,typeof s=="object"&&s!==null&&typeof s.render=="function"&&s.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,Ks(n)?(c=!0,Wx(e)):c=!1,e.memoizedState=s.state!==null&&s.state!==void 0?s.state:null,AC(e),s.updater=qb,e.stateNode=s,s._reactInternals=e,eT(e,n,t,r),e=nT(null,e,n,!0,c,r)):(e.tag=0,xn&&c&&bC(e),Cs(null,e,s,r),e=e.child),e;case 16:n=e.elementType;e:{switch(fx(t,e),t=e.pendingProps,s=n._init,n=s(n._payload),e.type=n,s=e.tag=c7(n),t=ga(n,t),s){case 0:e=rT(null,e,n,t,r);break e;case 1:e=sI(null,e,n,t,r);break e;case 11:e=nI(null,e,n,t,r);break e;case 14:e=iI(null,e,n,ga(n.type,t),r);break e}throw Error(gt(306,n,""))}return e;case 0:return n=e.type,s=e.pendingProps,s=e.elementType===n?s:ga(n,s),rT(t,e,n,s,r);case 1:return n=e.type,s=e.pendingProps,s=e.elementType===n?s:ga(n,s),sI(t,e,n,s,r);case 3:e:{if(Pz(e),t===null)throw Error(gt(387));n=e.pendingProps,c=e.memoizedState,s=c.element,ez(t,e),Xx(e,n,null,r);var l=e.memoizedState;if(n=l.element,c.isDehydrated)if(c={element:n,isDehydrated:!1,cache:l.cache,pendingSuspenseBoundaries:l.pendingSuspenseBoundaries,transitions:l.transitions},e.updateQueue.baseState=c,e.memoizedState=c,e.flags&256){s=Qp(Error(gt(423)),e),e=oI(t,e,n,r,s);break e}else if(n!==s){s=Qp(Error(gt(424)),e),e=oI(t,e,n,r,s);break e}else for(wo=_u(e.stateNode.containerInfo.firstChild),To=e,xn=!0,wa=null,r=QO(e,null,n,r),e.child=r;r;)r.flags=r.flags&-3|4096,r=r.sibling;else{if(Kp(),n===s){e=tc(t,e,r);break e}Cs(t,e,n,r)}e=e.child}return e;case 5:return tz(e),t===null&&YS(e),n=e.type,s=e.pendingProps,c=t!==null?t.memoizedProps:null,l=s.children,qS(n,s)?l=null:c!==null&&qS(n,c)&&(e.flags|=32),Cz(t,e),Cs(t,e,l,r),e.child;case 6:return t===null&&YS(e),null;case 13:return Az(t,e,r);case 4:return kC(e,e.stateNode.containerInfo),n=e.pendingProps,t===null?e.child=Xp(e,null,n,r):Cs(t,e,n,r),e.child;case 11:return n=e.type,s=e.pendingProps,s=e.elementType===n?s:ga(n,s),nI(t,e,n,s,r);case 7:return Cs(t,e,e.pendingProps,r),e.child;case 8:return Cs(t,e,e.pendingProps.children,r),e.child;case 12:return Cs(t,e,e.pendingProps.children,r),e.child;case 10:e:{if(n=e.type._context,s=e.pendingProps,c=e.memoizedProps,l=s.value,ln(Zx,n._currentValue),n._currentValue=l,c!==null)if(Aa(c.value,l)){if(c.children===s.children&&!Zs.current){e=tc(t,e,r);break e}}else for(c=e.child,c!==null&&(c.return=e);c!==null;){var a=c.dependencies;if(a!==null){l=c.child;for(var m=a.firstContext;m!==null;){if(m.context===n){if(c.tag===1){m=Yl(-1,r&-r),m.tag=2;var y=c.updateQueue;if(y!==null){y=y.shared;var v=y.pending;v===null?m.next=m:(m.next=v.next,v.next=m),y.pending=m}}c.lanes|=r,m=c.alternate,m!==null&&(m.lanes|=r),QS(c.return,r,e),a.lanes|=r;break}m=m.next}}else if(c.tag===10)l=c.type===e.type?null:c.child;else if(c.tag===18){if(l=c.return,l===null)throw Error(gt(341));l.lanes|=r,a=l.alternate,a!==null&&(a.lanes|=r),QS(l,r,e),l=c.sibling}else l=c.child;if(l!==null)l.return=c;else for(l=c;l!==null;){if(l===e){l=null;break}if(c=l.sibling,c!==null){c.return=l.return,l=c;break}l=l.return}c=l}Cs(t,e,s.children,r),e=e.child}return e;case 9:return s=e.type,n=e.pendingProps.children,Cp(e,r),s=ea(s),n=n(s),e.flags|=1,Cs(t,e,n,r),e.child;case 14:return n=e.type,s=ga(n,e.pendingProps),s=ga(n.type,s),iI(t,e,n,s,r);case 15:return Tz(t,e,e.type,e.pendingProps,r);case 17:return n=e.type,s=e.pendingProps,s=e.elementType===n?s:ga(n,s),fx(t,e),e.tag=1,Ks(n)?(t=!0,Wx(e)):t=!1,Cp(e,r),bz(e,n,s),eT(e,n,s,r),nT(null,e,n,!0,t,r);case 19:return kz(t,e,r);case 22:return Ez(t,e,r)}throw Error(gt(156,e.tag))};function Wz(t,e){return _O(t,e)}function l7(t,e,r,n){this.tag=t,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Ho(t,e,r,n){return new l7(t,e,r,n)}function GC(t){return t=t.prototype,!(!t||!t.isReactComponent)}function c7(t){if(typeof t=="function")return GC(t)?1:0;if(t!=null){if(t=t.$$typeof,t===cC)return 11;if(t===uC)return 14}return 2}function wu(t,e){var r=t.alternate;return r===null?(r=Ho(t.tag,e,t.key,t.mode),r.elementType=t.elementType,r.type=t.type,r.stateNode=t.stateNode,r.alternate=t,t.alternate=r):(r.pendingProps=e,r.type=t.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=t.flags&14680064,r.childLanes=t.childLanes,r.lanes=t.lanes,r.child=t.child,r.memoizedProps=t.memoizedProps,r.memoizedState=t.memoizedState,r.updateQueue=t.updateQueue,e=t.dependencies,r.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},r.sibling=t.sibling,r.index=t.index,r.ref=t.ref,r}function gx(t,e,r,n,s,c){var l=2;if(n=t,typeof t=="function")GC(t)&&(l=1);else if(typeof t=="string")l=5;else e:switch(t){case ip:return ud(r.children,s,c,e);case lC:l=8,s|=8;break;case TS:return t=Ho(12,r,e,s|2),t.elementType=TS,t.lanes=c,t;case ES:return t=Ho(13,r,e,s),t.elementType=ES,t.lanes=c,t;case CS:return t=Ho(19,r,e,s),t.elementType=CS,t.lanes=c,t;case tO:return Kb(r,s,c,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case J3:l=10;break e;case eO:l=9;break e;case cC:l=11;break e;case uC:l=14;break e;case Qc:l=16,n=null;break e}throw Error(gt(130,t==null?t:typeof t,""))}return e=Ho(l,r,e,s),e.elementType=t,e.type=n,e.lanes=c,e}function ud(t,e,r,n){return t=Ho(7,t,n,e),t.lanes=r,t}function Kb(t,e,r,n){return t=Ho(22,t,n,e),t.elementType=tO,t.lanes=r,t.stateNode={isHidden:!1},t}function y2(t,e,r){return t=Ho(6,t,null,e),t.lanes=r,t}function _2(t,e,r){return e=Ho(4,t.children!==null?t.children:[],t.key,e),e.lanes=r,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function u7(t,e,r,n,s){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Qw(0),this.expirationTimes=Qw(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Qw(0),this.identifierPrefix=n,this.onRecoverableError=s,this.mutableSourceEagerHydrationData=null}function WC(t,e,r,n,s,c,l,a,m){return t=new u7(t,e,r,a,m),e===1?(e=1,c===!0&&(e|=8)):e=0,c=Ho(3,null,null,e),t.current=c,c.stateNode=t,c.memoizedState={element:n,isDehydrated:r,cache:null,transitions:null,pendingSuspenseBoundaries:null},AC(c),t}function h7(t,e,r){var n=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:np,key:n==null?null:""+n,children:t,containerInfo:e,implementation:r}}function qz(t){if(!t)return Pu;t=t._reactInternals;e:{if(kd(t)!==t||t.tag!==1)throw Error(gt(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(Ks(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(gt(171))}if(t.tag===1){var r=t.type;if(Ks(r))return qO(t,r,e)}return e}function Hz(t,e,r,n,s,c,l,a,m){return t=WC(r,n,!0,t,s,c,l,a,m),t.context=qz(null),r=t.current,n=Ms(),s=bu(r),c=Yl(n,s),c.callback=e??null,vu(r,c,s),t.current.lanes=s,z0(t,s,n),Xs(t,n),t}function Xb(t,e,r,n){var s=e.current,c=Ms(),l=bu(s);return r=qz(r),e.context===null?e.context=r:e.pendingContext=r,e=Yl(c,l),e.payload={element:t},n=n===void 0?null:n,n!==null&&(e.callback=n),t=vu(s,e,l),t!==null&&(Ea(t,s,l,c),ux(t,s,l)),l}function ib(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function gI(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var r=t.retryLane;t.retryLane=r!==0&&r<e?r:e}}function qC(t,e){gI(t,e),(t=t.alternate)&&gI(t,e)}function d7(){return null}var Zz=typeof reportError=="function"?reportError:function(t){console.error(t)};function HC(t){this._internalRoot=t}Yb.prototype.render=HC.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(gt(409));Xb(t,e,null,null)};Yb.prototype.unmount=HC.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;wd(function(){Xb(null,t,null,null)}),e[Jl]=null}};function Yb(t){this._internalRoot=t}Yb.prototype.unstable_scheduleHydration=function(t){if(t){var e=EO();t={blockedOn:null,target:t,priority:e};for(var r=0;r<eu.length&&e!==0&&e<eu[r].priority;r++);eu.splice(r,0,t),r===0&&PO(t)}};function ZC(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function Qb(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function yI(){}function f7(t,e,r,n,s){if(s){if(typeof n=="function"){var c=n;n=function(){var y=ib(l);c.call(y)}}var l=Hz(e,n,t,0,null,!1,!1,"",yI);return t._reactRootContainer=l,t[Jl]=l.current,Zy(t.nodeType===8?t.parentNode:t),wd(),l}for(;s=t.lastChild;)t.removeChild(s);if(typeof n=="function"){var a=n;n=function(){var y=ib(m);a.call(y)}}var m=WC(t,0,!1,null,null,!1,!1,"",yI);return t._reactRootContainer=m,t[Jl]=m.current,Zy(t.nodeType===8?t.parentNode:t),wd(function(){Xb(e,m,r,n)}),m}function Jb(t,e,r,n,s){var c=r._reactRootContainer;if(c){var l=c;if(typeof s=="function"){var a=s;s=function(){var m=ib(l);a.call(m)}}Xb(e,l,t,s)}else l=f7(r,e,t,s,n);return ib(l)}SO=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var r=ry(e.pendingLanes);r!==0&&(fC(e,r|1),Xs(e,ei()),!(Dr&6)&&(Jp=ei()+500,ju()))}break;case 13:wd(function(){var n=ec(t,1);if(n!==null){var s=Ms();Ea(n,t,1,s)}}),qC(t,1)}};pC=function(t){if(t.tag===13){var e=ec(t,134217728);if(e!==null){var r=Ms();Ea(e,t,134217728,r)}qC(t,134217728)}};TO=function(t){if(t.tag===13){var e=bu(t),r=ec(t,e);if(r!==null){var n=Ms();Ea(r,t,e,n)}qC(t,e)}};EO=function(){return Wr};CO=function(t,e){var r=Wr;try{return Wr=t,e()}finally{Wr=r}};zS=function(t,e,r){switch(e){case"input":if(kS(t,r),e=r.name,r.type==="radio"&&e!=null){for(r=t;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<r.length;e++){var n=r[e];if(n!==t&&n.form===t.form){var s=Ub(n);if(!s)throw Error(gt(90));nO(n),kS(n,s)}}}break;case"textarea":sO(t,r);break;case"select":e=r.value,e!=null&&wp(t,!!r.multiple,e,!1)}};dO=$C;fO=wd;var p7={usingClientEntryPoint:!1,Events:[j0,lp,Ub,uO,hO,$C]},Ug={findFiberByHostInstance:Hh,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},m7={bundleType:Ug.bundleType,version:Ug.version,rendererPackageName:Ug.rendererPackageName,rendererConfig:Ug.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:dc.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=gO(t),t===null?null:t.stateNode},findFiberByHostInstance:Ug.findFiberByHostInstance||d7,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Dv=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Dv.isDisabled&&Dv.supportsFiber)try{Fb=Dv.inject(m7),hl=Dv}catch{}}Io.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=p7;Io.createPortal=function(t,e){var r=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!ZC(e))throw Error(gt(200));return h7(t,e,null,r)};Io.createRoot=function(t,e){if(!ZC(t))throw Error(gt(299));var r=!1,n="",s=Zz;return e!=null&&(e.unstable_strictMode===!0&&(r=!0),e.identifierPrefix!==void 0&&(n=e.identifierPrefix),e.onRecoverableError!==void 0&&(s=e.onRecoverableError)),e=WC(t,1,!1,null,null,r,!1,n,s),t[Jl]=e.current,Zy(t.nodeType===8?t.parentNode:t),new HC(e)};Io.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(gt(188)):(t=Object.keys(t).join(","),Error(gt(268,t)));return t=gO(e),t=t===null?null:t.stateNode,t};Io.flushSync=function(t){return wd(t)};Io.hydrate=function(t,e,r){if(!Qb(e))throw Error(gt(200));return Jb(null,t,e,!0,r)};Io.hydrateRoot=function(t,e,r){if(!ZC(t))throw Error(gt(405));var n=r!=null&&r.hydratedSources||null,s=!1,c="",l=Zz;if(r!=null&&(r.unstable_strictMode===!0&&(s=!0),r.identifierPrefix!==void 0&&(c=r.identifierPrefix),r.onRecoverableError!==void 0&&(l=r.onRecoverableError)),e=Hz(e,null,t,1,r??null,s,!1,c,l),t[Jl]=e.current,Zy(t),n)for(t=0;t<n.length;t++)r=n[t],s=r._getVersion,s=s(r._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[r,s]:e.mutableSourceEagerHydrationData.push(r,s);return new Yb(e)};Io.render=function(t,e,r){if(!Qb(e))throw Error(gt(200));return Jb(null,t,e,!1,r)};Io.unmountComponentAtNode=function(t){if(!Qb(t))throw Error(gt(40));return t._reactRootContainer?(wd(function(){Jb(null,null,t,!1,function(){t._reactRootContainer=null,t[Jl]=null})}),!0):!1};Io.unstable_batchedUpdates=$C;Io.unstable_renderSubtreeIntoContainer=function(t,e,r,n){if(!Qb(r))throw Error(gt(200));if(t==null||t._reactInternals===void 0)throw Error(gt(38));return Jb(t,e,r,!1,n)};Io.version="18.3.1-next-f1338f8080-20240426";function Kz(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(Kz)}catch(t){console.error(t)}}Kz(),K3.exports=Io;var B0=K3.exports;const Xz=JE(B0);var Yz,_I=B0;Yz=_I.createRoot,_I.hydrateRoot;/**
 * @remix-run/router v1.23.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function n0(){return n0=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},n0.apply(this,arguments)}var hu;(function(t){t.Pop="POP",t.Push="PUSH",t.Replace="REPLACE"})(hu||(hu={}));const vI="popstate";function g7(t){t===void 0&&(t={});function e(n,s){let{pathname:c,search:l,hash:a}=n.location;return mT("",{pathname:c,search:l,hash:a},s.state&&s.state.usr||null,s.state&&s.state.key||"default")}function r(n,s){return typeof s=="string"?s:sb(s)}return _7(e,r,null,t)}function vi(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function Qz(t,e){if(!t){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function y7(){return Math.random().toString(36).substr(2,8)}function xI(t,e){return{usr:t.state,key:t.key,idx:e}}function mT(t,e,r,n){return r===void 0&&(r=null),n0({pathname:typeof t=="string"?t:t.pathname,search:"",hash:""},typeof e=="string"?mm(e):e,{state:r,key:e&&e.key||n||y7()})}function sb(t){let{pathname:e="/",search:r="",hash:n=""}=t;return r&&r!=="?"&&(e+=r.charAt(0)==="?"?r:"?"+r),n&&n!=="#"&&(e+=n.charAt(0)==="#"?n:"#"+n),e}function mm(t){let e={};if(t){let r=t.indexOf("#");r>=0&&(e.hash=t.substr(r),t=t.substr(0,r));let n=t.indexOf("?");n>=0&&(e.search=t.substr(n),t=t.substr(0,n)),t&&(e.pathname=t)}return e}function _7(t,e,r,n){n===void 0&&(n={});let{window:s=document.defaultView,v5Compat:c=!1}=n,l=s.history,a=hu.Pop,m=null,y=v();y==null&&(y=0,l.replaceState(n0({},l.state,{idx:y}),""));function v(){return(l.state||{idx:null}).idx}function T(){a=hu.Pop;let L=v(),R=L==null?null:L-y;y=L,m&&m({action:a,location:I.location,delta:R})}function P(L,R){a=hu.Push;let z=mT(I.location,L,R);y=v()+1;let j=xI(z,y),W=I.createHref(z);try{l.pushState(j,"",W)}catch(Z){if(Z instanceof DOMException&&Z.name==="DataCloneError")throw Z;s.location.assign(W)}c&&m&&m({action:a,location:I.location,delta:1})}function A(L,R){a=hu.Replace;let z=mT(I.location,L,R);y=v();let j=xI(z,y),W=I.createHref(z);l.replaceState(j,"",W),c&&m&&m({action:a,location:I.location,delta:0})}function O(L){let R=s.location.origin!=="null"?s.location.origin:s.location.href,z=typeof L=="string"?L:sb(L);return z=z.replace(/ $/,"%20"),vi(R,"No window.location.(origin|href) available to create URL for href: "+z),new URL(z,R)}let I={get action(){return a},get location(){return t(s,l)},listen(L){if(m)throw new Error("A history only accepts one active listener");return s.addEventListener(vI,T),m=L,()=>{s.removeEventListener(vI,T),m=null}},createHref(L){return e(s,L)},createURL:O,encodeLocation(L){let R=O(L);return{pathname:R.pathname,search:R.search,hash:R.hash}},push:P,replace:A,go(L){return l.go(L)}};return I}var bI;(function(t){t.data="data",t.deferred="deferred",t.redirect="redirect",t.error="error"})(bI||(bI={}));function v7(t,e,r){return r===void 0&&(r="/"),x7(t,e,r)}function x7(t,e,r,n){let s=typeof e=="string"?mm(e):e,c=KC(s.pathname||"/",r);if(c==null)return null;let l=Jz(t);b7(l);let a=null;for(let m=0;a==null&&m<l.length;++m){let y=D7(c);a=M7(l[m],y)}return a}function Jz(t,e,r,n){e===void 0&&(e=[]),r===void 0&&(r=[]),n===void 0&&(n="");let s=(c,l,a)=>{let m={relativePath:a===void 0?c.path||"":a,caseSensitive:c.caseSensitive===!0,childrenIndex:l,route:c};m.relativePath.startsWith("/")&&(vi(m.relativePath.startsWith(n),'Absolute route path "'+m.relativePath+'" nested under path '+('"'+n+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),m.relativePath=m.relativePath.slice(n.length));let y=Su([n,m.relativePath]),v=r.concat(m);c.children&&c.children.length>0&&(vi(c.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+y+'".')),Jz(c.children,e,v,y)),!(c.path==null&&!c.index)&&e.push({path:y,score:A7(y,c.index),routesMeta:v})};return t.forEach((c,l)=>{var a;if(c.path===""||!((a=c.path)!=null&&a.includes("?")))s(c,l);else for(let m of e5(c.path))s(c,l,m)}),e}function e5(t){let e=t.split("/");if(e.length===0)return[];let[r,...n]=e,s=r.endsWith("?"),c=r.replace(/\?$/,"");if(n.length===0)return s?[c,""]:[c];let l=e5(n.join("/")),a=[];return a.push(...l.map(m=>m===""?c:[c,m].join("/"))),s&&a.push(...l),a.map(m=>t.startsWith("/")&&m===""?"/":m)}function b7(t){t.sort((e,r)=>e.score!==r.score?r.score-e.score:k7(e.routesMeta.map(n=>n.childrenIndex),r.routesMeta.map(n=>n.childrenIndex)))}const w7=/^:[\w-]+$/,S7=3,T7=2,E7=1,C7=10,P7=-2,wI=t=>t==="*";function A7(t,e){let r=t.split("/"),n=r.length;return r.some(wI)&&(n+=P7),e&&(n+=T7),r.filter(s=>!wI(s)).reduce((s,c)=>s+(w7.test(c)?S7:c===""?E7:C7),n)}function k7(t,e){return t.length===e.length&&t.slice(0,-1).every((n,s)=>n===e[s])?t[t.length-1]-e[e.length-1]:0}function M7(t,e,r){let{routesMeta:n}=t,s={},c="/",l=[];for(let a=0;a<n.length;++a){let m=n[a],y=a===n.length-1,v=c==="/"?e:e.slice(c.length)||"/",T=I7({path:m.relativePath,caseSensitive:m.caseSensitive,end:y},v),P=m.route;if(!T)return null;Object.assign(s,T.params),l.push({params:s,pathname:Su([c,T.pathname]),pathnameBase:N7(Su([c,T.pathnameBase])),route:P}),T.pathnameBase!=="/"&&(c=Su([c,T.pathnameBase]))}return l}function I7(t,e){typeof t=="string"&&(t={path:t,caseSensitive:!1,end:!0});let[r,n]=R7(t.path,t.caseSensitive,t.end),s=e.match(r);if(!s)return null;let c=s[0],l=c.replace(/(.)\/+$/,"$1"),a=s.slice(1);return{params:n.reduce((y,v,T)=>{let{paramName:P,isOptional:A}=v;if(P==="*"){let I=a[T]||"";l=c.slice(0,c.length-I.length).replace(/(.)\/+$/,"$1")}const O=a[T];return A&&!O?y[P]=void 0:y[P]=(O||"").replace(/%2F/g,"/"),y},{}),pathname:c,pathnameBase:l,pattern:t}}function R7(t,e,r){e===void 0&&(e=!1),r===void 0&&(r=!0),Qz(t==="*"||!t.endsWith("*")||t.endsWith("/*"),'Route path "'+t+'" will be treated as if it were '+('"'+t.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+t.replace(/\*$/,"/*")+'".'));let n=[],s="^"+t.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(l,a,m)=>(n.push({paramName:a,isOptional:m!=null}),m?"/?([^\\/]+)?":"/([^\\/]+)"));return t.endsWith("*")?(n.push({paramName:"*"}),s+=t==="*"||t==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):r?s+="\\/*$":t!==""&&t!=="/"&&(s+="(?:(?=\\/|$))"),[new RegExp(s,e?void 0:"i"),n]}function D7(t){try{return t.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return Qz(!1,'The URL path "'+t+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+e+").")),t}}function KC(t,e){if(e==="/")return t;if(!t.toLowerCase().startsWith(e.toLowerCase()))return null;let r=e.endsWith("/")?e.length-1:e.length,n=t.charAt(r);return n&&n!=="/"?null:t.slice(r)||"/"}function L7(t,e){e===void 0&&(e="/");let{pathname:r,search:n="",hash:s=""}=typeof t=="string"?mm(t):t;return{pathname:r?r.startsWith("/")?r:O7(r,e):e,search:j7(n),hash:F7(s)}}function O7(t,e){let r=e.replace(/\/+$/,"").split("/");return t.split("/").forEach(s=>{s===".."?r.length>1&&r.pop():s!=="."&&r.push(s)}),r.length>1?r.join("/"):"/"}function v2(t,e,r,n){return"Cannot include a '"+t+"' character in a manually specified "+("`to."+e+"` field ["+JSON.stringify(n)+"].  Please separate it out to the ")+("`to."+r+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function z7(t){return t.filter((e,r)=>r===0||e.route.path&&e.route.path.length>0)}function t5(t,e){let r=z7(t);return e?r.map((n,s)=>s===r.length-1?n.pathname:n.pathnameBase):r.map(n=>n.pathnameBase)}function r5(t,e,r,n){n===void 0&&(n=!1);let s;typeof t=="string"?s=mm(t):(s=n0({},t),vi(!s.pathname||!s.pathname.includes("?"),v2("?","pathname","search",s)),vi(!s.pathname||!s.pathname.includes("#"),v2("#","pathname","hash",s)),vi(!s.search||!s.search.includes("#"),v2("#","search","hash",s)));let c=t===""||s.pathname==="",l=c?"/":s.pathname,a;if(l==null)a=r;else{let T=e.length-1;if(!n&&l.startsWith("..")){let P=l.split("/");for(;P[0]==="..";)P.shift(),T-=1;s.pathname=P.join("/")}a=T>=0?e[T]:"/"}let m=L7(s,a),y=l&&l!=="/"&&l.endsWith("/"),v=(c||l===".")&&r.endsWith("/");return!m.pathname.endsWith("/")&&(y||v)&&(m.pathname+="/"),m}const Su=t=>t.join("/").replace(/\/\/+/g,"/"),N7=t=>t.replace(/\/+$/,"").replace(/^\/*/,"/"),j7=t=>!t||t==="?"?"":t.startsWith("?")?t:"?"+t,F7=t=>!t||t==="#"?"":t.startsWith("#")?t:"#"+t;function B7(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.internal=="boolean"&&"data"in t}const n5=["post","put","patch","delete"];new Set(n5);const $7=["get",...n5];new Set($7);/**
 * React Router v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function i0(){return i0=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},i0.apply(this,arguments)}const XC=X.createContext(null),V7=X.createContext(null),Md=X.createContext(null),e1=X.createContext(null),Id=X.createContext({outlet:null,matches:[],isDataRoute:!1}),i5=X.createContext(null);function U7(t,e){let{relative:r}=e===void 0?{}:e;$0()||vi(!1);let{basename:n,navigator:s}=X.useContext(Md),{hash:c,pathname:l,search:a}=a5(t,{relative:r}),m=l;return n!=="/"&&(m=l==="/"?n:Su([n,l])),s.createHref({pathname:m,search:a,hash:c})}function $0(){return X.useContext(e1)!=null}function gm(){return $0()||vi(!1),X.useContext(e1).location}function s5(t){X.useContext(Md).static||X.useLayoutEffect(t)}function o5(){let{isDataRoute:t}=X.useContext(Id);return t?r9():G7()}function G7(){$0()||vi(!1);let t=X.useContext(XC),{basename:e,future:r,navigator:n}=X.useContext(Md),{matches:s}=X.useContext(Id),{pathname:c}=gm(),l=JSON.stringify(t5(s,r.v7_relativeSplatPath)),a=X.useRef(!1);return s5(()=>{a.current=!0}),X.useCallback(function(y,v){if(v===void 0&&(v={}),!a.current)return;if(typeof y=="number"){n.go(y);return}let T=r5(y,JSON.parse(l),c,v.relative==="path");t==null&&e!=="/"&&(T.pathname=T.pathname==="/"?e:Su([e,T.pathname])),(v.replace?n.replace:n.push)(T,v.state,v)},[e,n,l,c,t])}function a5(t,e){let{relative:r}=e===void 0?{}:e,{future:n}=X.useContext(Md),{matches:s}=X.useContext(Id),{pathname:c}=gm(),l=JSON.stringify(t5(s,n.v7_relativeSplatPath));return X.useMemo(()=>r5(t,JSON.parse(l),c,r==="path"),[t,l,c,r])}function W7(t,e){return q7(t,e)}function q7(t,e,r,n){$0()||vi(!1);let{navigator:s}=X.useContext(Md),{matches:c}=X.useContext(Id),l=c[c.length-1],a=l?l.params:{};l&&l.pathname;let m=l?l.pathnameBase:"/";l&&l.route;let y=gm(),v;if(e){var T;let L=typeof e=="string"?mm(e):e;m==="/"||(T=L.pathname)!=null&&T.startsWith(m)||vi(!1),v=L}else v=y;let P=v.pathname||"/",A=P;if(m!=="/"){let L=m.replace(/^\//,"").split("/");A="/"+P.replace(/^\//,"").split("/").slice(L.length).join("/")}let O=v7(t,{pathname:A}),I=Y7(O&&O.map(L=>Object.assign({},L,{params:Object.assign({},a,L.params),pathname:Su([m,s.encodeLocation?s.encodeLocation(L.pathname).pathname:L.pathname]),pathnameBase:L.pathnameBase==="/"?m:Su([m,s.encodeLocation?s.encodeLocation(L.pathnameBase).pathname:L.pathnameBase])})),c,r,n);return e&&I?X.createElement(e1.Provider,{value:{location:i0({pathname:"/",search:"",hash:"",state:null,key:"default"},v),navigationType:hu.Pop}},I):I}function H7(){let t=t9(),e=B7(t)?t.status+" "+t.statusText:t instanceof Error?t.message:JSON.stringify(t),r=t instanceof Error?t.stack:null,s={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return X.createElement(X.Fragment,null,X.createElement("h2",null,"Unexpected Application Error!"),X.createElement("h3",{style:{fontStyle:"italic"}},e),r?X.createElement("pre",{style:s},r):null,null)}const Z7=X.createElement(H7,null);class K7 extends X.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,r){return r.location!==e.location||r.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:r.error,location:r.location,revalidation:e.revalidation||r.revalidation}}componentDidCatch(e,r){console.error("React Router caught the following error during render",e,r)}render(){return this.state.error!==void 0?X.createElement(Id.Provider,{value:this.props.routeContext},X.createElement(i5.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function X7(t){let{routeContext:e,match:r,children:n}=t,s=X.useContext(XC);return s&&s.static&&s.staticContext&&(r.route.errorElement||r.route.ErrorBoundary)&&(s.staticContext._deepestRenderedBoundaryId=r.route.id),X.createElement(Id.Provider,{value:e},n)}function Y7(t,e,r,n){var s;if(e===void 0&&(e=[]),r===void 0&&(r=null),n===void 0&&(n=null),t==null){var c;if(!r)return null;if(r.errors)t=r.matches;else if((c=n)!=null&&c.v7_partialHydration&&e.length===0&&!r.initialized&&r.matches.length>0)t=r.matches;else return null}let l=t,a=(s=r)==null?void 0:s.errors;if(a!=null){let v=l.findIndex(T=>T.route.id&&(a==null?void 0:a[T.route.id])!==void 0);v>=0||vi(!1),l=l.slice(0,Math.min(l.length,v+1))}let m=!1,y=-1;if(r&&n&&n.v7_partialHydration)for(let v=0;v<l.length;v++){let T=l[v];if((T.route.HydrateFallback||T.route.hydrateFallbackElement)&&(y=v),T.route.id){let{loaderData:P,errors:A}=r,O=T.route.loader&&P[T.route.id]===void 0&&(!A||A[T.route.id]===void 0);if(T.route.lazy||O){m=!0,y>=0?l=l.slice(0,y+1):l=[l[0]];break}}}return l.reduceRight((v,T,P)=>{let A,O=!1,I=null,L=null;r&&(A=a&&T.route.id?a[T.route.id]:void 0,I=T.route.errorElement||Z7,m&&(y<0&&P===0?(n9("route-fallback"),O=!0,L=null):y===P&&(O=!0,L=T.route.hydrateFallbackElement||null)));let R=e.concat(l.slice(0,P+1)),z=()=>{let j;return A?j=I:O?j=L:T.route.Component?j=X.createElement(T.route.Component,null):T.route.element?j=T.route.element:j=v,X.createElement(X7,{match:T,routeContext:{outlet:v,matches:R,isDataRoute:r!=null},children:j})};return r&&(T.route.ErrorBoundary||T.route.errorElement||P===0)?X.createElement(K7,{location:r.location,revalidation:r.revalidation,component:I,error:A,children:z(),routeContext:{outlet:null,matches:R,isDataRoute:!0}}):z()},null)}var l5=function(t){return t.UseBlocker="useBlocker",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t}(l5||{}),c5=function(t){return t.UseBlocker="useBlocker",t.UseLoaderData="useLoaderData",t.UseActionData="useActionData",t.UseRouteError="useRouteError",t.UseNavigation="useNavigation",t.UseRouteLoaderData="useRouteLoaderData",t.UseMatches="useMatches",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t.UseRouteId="useRouteId",t}(c5||{});function Q7(t){let e=X.useContext(XC);return e||vi(!1),e}function J7(t){let e=X.useContext(V7);return e||vi(!1),e}function e9(t){let e=X.useContext(Id);return e||vi(!1),e}function u5(t){let e=e9(),r=e.matches[e.matches.length-1];return r.route.id||vi(!1),r.route.id}function t9(){var t;let e=X.useContext(i5),r=J7(),n=u5();return e!==void 0?e:(t=r.errors)==null?void 0:t[n]}function r9(){let{router:t}=Q7(l5.UseNavigateStable),e=u5(c5.UseNavigateStable),r=X.useRef(!1);return s5(()=>{r.current=!0}),X.useCallback(function(s,c){c===void 0&&(c={}),r.current&&(typeof s=="number"?t.navigate(s):t.navigate(s,i0({fromRouteId:e},c)))},[t,e])}const SI={};function n9(t,e,r){SI[t]||(SI[t]=!0)}function i9(t,e){t==null||t.v7_startTransition,t==null||t.v7_relativeSplatPath}function Fh(t){vi(!1)}function s9(t){let{basename:e="/",children:r=null,location:n,navigationType:s=hu.Pop,navigator:c,static:l=!1,future:a}=t;$0()&&vi(!1);let m=e.replace(/^\/*/,"/"),y=X.useMemo(()=>({basename:m,navigator:c,static:l,future:i0({v7_relativeSplatPath:!1},a)}),[m,a,c,l]);typeof n=="string"&&(n=mm(n));let{pathname:v="/",search:T="",hash:P="",state:A=null,key:O="default"}=n,I=X.useMemo(()=>{let L=KC(v,m);return L==null?null:{location:{pathname:L,search:T,hash:P,state:A,key:O},navigationType:s}},[m,v,T,P,A,O,s]);return I==null?null:X.createElement(Md.Provider,{value:y},X.createElement(e1.Provider,{children:r,value:I}))}function o9(t){let{children:e,location:r}=t;return W7(gT(e),r)}new Promise(()=>{});function gT(t,e){e===void 0&&(e=[]);let r=[];return X.Children.forEach(t,(n,s)=>{if(!X.isValidElement(n))return;let c=[...e,s];if(n.type===X.Fragment){r.push.apply(r,gT(n.props.children,c));return}n.type!==Fh&&vi(!1),!n.props.index||!n.props.children||vi(!1);let l={id:n.props.id||c.join("-"),caseSensitive:n.props.caseSensitive,element:n.props.element,Component:n.props.Component,index:n.props.index,path:n.props.path,loader:n.props.loader,action:n.props.action,errorElement:n.props.errorElement,ErrorBoundary:n.props.ErrorBoundary,hasErrorBoundary:n.props.ErrorBoundary!=null||n.props.errorElement!=null,shouldRevalidate:n.props.shouldRevalidate,handle:n.props.handle,lazy:n.props.lazy};n.props.children&&(l.children=gT(n.props.children,c)),r.push(l)}),r}/**
 * React Router DOM v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function yT(){return yT=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},yT.apply(this,arguments)}function a9(t,e){if(t==null)return{};var r={},n=Object.keys(t),s,c;for(c=0;c<n.length;c++)s=n[c],!(e.indexOf(s)>=0)&&(r[s]=t[s]);return r}function l9(t){return!!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)}function c9(t,e){return t.button===0&&(!e||e==="_self")&&!l9(t)}const u9=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],h9="6";try{window.__reactRouterVersion=h9}catch{}const d9="startTransition",TI=iC[d9];function f9(t){let{basename:e,children:r,future:n,window:s}=t,c=X.useRef();c.current==null&&(c.current=g7({window:s,v5Compat:!0}));let l=c.current,[a,m]=X.useState({action:l.action,location:l.location}),{v7_startTransition:y}=n||{},v=X.useCallback(T=>{y&&TI?TI(()=>m(T)):m(T)},[m,y]);return X.useLayoutEffect(()=>l.listen(v),[l,v]),X.useEffect(()=>i9(n),[n]),X.createElement(s9,{basename:e,children:r,location:a.location,navigationType:a.action,navigator:l,future:n})}const p9=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",m9=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,_T=X.forwardRef(function(e,r){let{onClick:n,relative:s,reloadDocument:c,replace:l,state:a,target:m,to:y,preventScrollReset:v,viewTransition:T}=e,P=a9(e,u9),{basename:A}=X.useContext(Md),O,I=!1;if(typeof y=="string"&&m9.test(y)&&(O=y,p9))try{let j=new URL(window.location.href),W=y.startsWith("//")?new URL(j.protocol+y):new URL(y),Z=KC(W.pathname,A);W.origin===j.origin&&Z!=null?y=Z+W.search+W.hash:I=!0}catch{}let L=U7(y,{relative:s}),R=g9(y,{replace:l,state:a,target:m,preventScrollReset:v,relative:s,viewTransition:T});function z(j){n&&n(j),j.defaultPrevented||R(j)}return X.createElement("a",yT({},P,{href:O||L,onClick:I||c?n:z,ref:r,target:m}))});var EI;(function(t){t.UseScrollRestoration="useScrollRestoration",t.UseSubmit="useSubmit",t.UseSubmitFetcher="useSubmitFetcher",t.UseFetcher="useFetcher",t.useViewTransitionState="useViewTransitionState"})(EI||(EI={}));var CI;(function(t){t.UseFetcher="useFetcher",t.UseFetchers="useFetchers",t.UseScrollRestoration="useScrollRestoration"})(CI||(CI={}));function g9(t,e){let{target:r,replace:n,state:s,preventScrollReset:c,relative:l,viewTransition:a}=e===void 0?{}:e,m=o5(),y=gm(),v=a5(t,{relative:l});return X.useCallback(T=>{if(c9(T,r)){T.preventDefault();let P=n!==void 0?n:sb(y)===sb(v);m(t,{replace:P,state:s,preventScrollReset:c,relative:l,viewTransition:a})}},[y,m,v,n,s,r,t,c,l,a])}const h5=X.createContext({});function y9(t){const e=X.useRef(null);return e.current===null&&(e.current=t()),e.current}const YC=typeof window<"u",_9=YC?X.useLayoutEffect:X.useEffect,QC=X.createContext(null);function JC(t,e){t.indexOf(e)===-1&&t.push(e)}function eP(t,e){const r=t.indexOf(e);r>-1&&t.splice(r,1)}const rc=(t,e,r)=>r>e?e:r<t?t:r;let tP=()=>{};const nc={},d5=t=>/^-?(?:\d+(?:\.\d+)?|\.\d+)$/u.test(t);function f5(t){return typeof t=="object"&&t!==null}const p5=t=>/^0[^.\s]+$/u.test(t);function rP(t){let e;return()=>(e===void 0&&(e=t()),e)}const Jo=t=>t,v9=(t,e)=>r=>e(t(r)),V0=(...t)=>t.reduce(v9),s0=(t,e,r)=>{const n=e-t;return n===0?1:(r-t)/n};class nP{constructor(){this.subscriptions=[]}add(e){return JC(this.subscriptions,e),()=>eP(this.subscriptions,e)}notify(e,r,n){const s=this.subscriptions.length;if(s)if(s===1)this.subscriptions[0](e,r,n);else for(let c=0;c<s;c++){const l=this.subscriptions[c];l&&l(e,r,n)}}getSize(){return this.subscriptions.length}clear(){this.subscriptions.length=0}}const fl=t=>t*1e3,Zo=t=>t/1e3;function m5(t,e){return e?t*(1e3/e):0}const g5=(t,e,r)=>(((1-3*r+3*e)*t+(3*r-6*e))*t+3*e)*t,x9=1e-7,b9=12;function w9(t,e,r,n,s){let c,l,a=0;do l=e+(r-e)/2,c=g5(l,n,s)-t,c>0?r=l:e=l;while(Math.abs(c)>x9&&++a<b9);return l}function U0(t,e,r,n){if(t===e&&r===n)return Jo;const s=c=>w9(c,0,1,t,r);return c=>c===0||c===1?c:g5(s(c),e,n)}const y5=t=>e=>e<=.5?t(2*e)/2:(2-t(2*(1-e)))/2,_5=t=>e=>1-t(1-e),v5=U0(.33,1.53,.69,.99),iP=_5(v5),x5=y5(iP),b5=t=>(t*=2)<1?.5*iP(t):.5*(2-Math.pow(2,-10*(t-1))),sP=t=>1-Math.sin(Math.acos(t)),w5=_5(sP),S5=y5(sP),S9=U0(.42,0,1,1),T9=U0(0,0,.58,1),T5=U0(.42,0,.58,1),E9=t=>Array.isArray(t)&&typeof t[0]!="number",E5=t=>Array.isArray(t)&&typeof t[0]=="number",C9={linear:Jo,easeIn:S9,easeInOut:T5,easeOut:T9,circIn:sP,circInOut:S5,circOut:w5,backIn:iP,backInOut:x5,backOut:v5,anticipate:b5},P9=t=>typeof t=="string",PI=t=>{if(E5(t)){tP(t.length===4);const[e,r,n,s]=t;return U0(e,r,n,s)}else if(P9(t))return C9[t];return t},Lv=["setup","read","resolveKeyframes","preUpdate","update","preRender","render","postRender"];function A9(t,e){let r=new Set,n=new Set,s=!1,c=!1;const l=new WeakSet;let a={delta:0,timestamp:0,isProcessing:!1};function m(v){l.has(v)&&(y.schedule(v),t()),v(a)}const y={schedule:(v,T=!1,P=!1)=>{const O=P&&s?r:n;return T&&l.add(v),O.has(v)||O.add(v),v},cancel:v=>{n.delete(v),l.delete(v)},process:v=>{if(a=v,s){c=!0;return}s=!0,[r,n]=[n,r],r.forEach(m),r.clear(),s=!1,c&&(c=!1,y.process(v))}};return y}const k9=40;function C5(t,e){let r=!1,n=!0;const s={delta:0,timestamp:0,isProcessing:!1},c=()=>r=!0,l=Lv.reduce((j,W)=>(j[W]=A9(c),j),{}),{setup:a,read:m,resolveKeyframes:y,preUpdate:v,update:T,preRender:P,render:A,postRender:O}=l,I=()=>{const j=nc.useManualTiming?s.timestamp:performance.now();r=!1,nc.useManualTiming||(s.delta=n?1e3/60:Math.max(Math.min(j-s.timestamp,k9),1)),s.timestamp=j,s.isProcessing=!0,a.process(s),m.process(s),y.process(s),v.process(s),T.process(s),P.process(s),A.process(s),O.process(s),s.isProcessing=!1,r&&e&&(n=!1,t(I))},L=()=>{r=!0,n=!0,s.isProcessing||t(I)};return{schedule:Lv.reduce((j,W)=>{const Z=l[W];return j[W]=(te,ie=!1,V=!1)=>(r||L(),Z.schedule(te,ie,V)),j},{}),cancel:j=>{for(let W=0;W<Lv.length;W++)l[Lv[W]].cancel(j)},state:s,steps:l}}const{schedule:wn,cancel:Au,state:Yi,steps:x2}=C5(typeof requestAnimationFrame<"u"?requestAnimationFrame:Jo,!0);let yx;function M9(){yx=void 0}const Hs={now:()=>(yx===void 0&&Hs.set(Yi.isProcessing||nc.useManualTiming?Yi.timestamp:performance.now()),yx),set:t=>{yx=t,queueMicrotask(M9)}},P5=t=>e=>typeof e=="string"&&e.startsWith(t),oP=P5("--"),I9=P5("var(--"),aP=t=>I9(t)?R9.test(t.split("/*")[0].trim()):!1,R9=/var\(--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)$/iu,ym={test:t=>typeof t=="number",parse:parseFloat,transform:t=>t},o0={...ym,transform:t=>rc(0,1,t)},Ov={...ym,default:1},Sy=t=>Math.round(t*1e5)/1e5,lP=/-?(?:\d+(?:\.\d+)?|\.\d+)/gu;function D9(t){return t==null}const L9=/^(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))$/iu,cP=(t,e)=>r=>!!(typeof r=="string"&&L9.test(r)&&r.startsWith(t)||e&&!D9(r)&&Object.prototype.hasOwnProperty.call(r,e)),A5=(t,e,r)=>n=>{if(typeof n!="string")return n;const[s,c,l,a]=n.match(lP);return{[t]:parseFloat(s),[e]:parseFloat(c),[r]:parseFloat(l),alpha:a!==void 0?parseFloat(a):1}},O9=t=>rc(0,255,t),b2={...ym,transform:t=>Math.round(O9(t))},Xh={test:cP("rgb","red"),parse:A5("red","green","blue"),transform:({red:t,green:e,blue:r,alpha:n=1})=>"rgba("+b2.transform(t)+", "+b2.transform(e)+", "+b2.transform(r)+", "+Sy(o0.transform(n))+")"};function z9(t){let e="",r="",n="",s="";return t.length>5?(e=t.substring(1,3),r=t.substring(3,5),n=t.substring(5,7),s=t.substring(7,9)):(e=t.substring(1,2),r=t.substring(2,3),n=t.substring(3,4),s=t.substring(4,5),e+=e,r+=r,n+=n,s+=s),{red:parseInt(e,16),green:parseInt(r,16),blue:parseInt(n,16),alpha:s?parseInt(s,16)/255:1}}const vT={test:cP("#"),parse:z9,transform:Xh.transform},G0=t=>({test:e=>typeof e=="string"&&e.endsWith(t)&&e.split(" ").length===1,parse:parseFloat,transform:e=>`${e}${t}`}),Zc=G0("deg"),pl=G0("%"),Xt=G0("px"),N9=G0("vh"),j9=G0("vw"),AI={...pl,parse:t=>pl.parse(t)/100,transform:t=>pl.transform(t*100)},mp={test:cP("hsl","hue"),parse:A5("hue","saturation","lightness"),transform:({hue:t,saturation:e,lightness:r,alpha:n=1})=>"hsla("+Math.round(t)+", "+pl.transform(Sy(e))+", "+pl.transform(Sy(r))+", "+Sy(o0.transform(n))+")"},mi={test:t=>Xh.test(t)||vT.test(t)||mp.test(t),parse:t=>Xh.test(t)?Xh.parse(t):mp.test(t)?mp.parse(t):vT.parse(t),transform:t=>typeof t=="string"?t:t.hasOwnProperty("red")?Xh.transform(t):mp.transform(t),getAnimatableNone:t=>{const e=mi.parse(t);return e.alpha=0,mi.transform(e)}},F9=/(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))/giu;function B9(t){var e,r;return isNaN(t)&&typeof t=="string"&&(((e=t.match(lP))==null?void 0:e.length)||0)+(((r=t.match(F9))==null?void 0:r.length)||0)>0}const k5="number",M5="color",$9="var",V9="var(",kI="${}",U9=/var\s*\(\s*--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)|#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\)|-?(?:\d+(?:\.\d+)?|\.\d+)/giu;function a0(t){const e=t.toString(),r=[],n={color:[],number:[],var:[]},s=[];let c=0;const a=e.replace(U9,m=>(mi.test(m)?(n.color.push(c),s.push(M5),r.push(mi.parse(m))):m.startsWith(V9)?(n.var.push(c),s.push($9),r.push(m)):(n.number.push(c),s.push(k5),r.push(parseFloat(m))),++c,kI)).split(kI);return{values:r,split:a,indexes:n,types:s}}function I5(t){return a0(t).values}function R5(t){const{split:e,types:r}=a0(t),n=e.length;return s=>{let c="";for(let l=0;l<n;l++)if(c+=e[l],s[l]!==void 0){const a=r[l];a===k5?c+=Sy(s[l]):a===M5?c+=mi.transform(s[l]):c+=s[l]}return c}}const G9=t=>typeof t=="number"?0:mi.test(t)?mi.getAnimatableNone(t):t;function W9(t){const e=I5(t);return R5(t)(e.map(G9))}const ku={test:B9,parse:I5,createTransformer:R5,getAnimatableNone:W9};function w2(t,e,r){return r<0&&(r+=1),r>1&&(r-=1),r<1/6?t+(e-t)*6*r:r<1/2?e:r<2/3?t+(e-t)*(2/3-r)*6:t}function q9({hue:t,saturation:e,lightness:r,alpha:n}){t/=360,e/=100,r/=100;let s=0,c=0,l=0;if(!e)s=c=l=r;else{const a=r<.5?r*(1+e):r+e-r*e,m=2*r-a;s=w2(m,a,t+1/3),c=w2(m,a,t),l=w2(m,a,t-1/3)}return{red:Math.round(s*255),green:Math.round(c*255),blue:Math.round(l*255),alpha:n}}function ob(t,e){return r=>r>0?e:t}const Rn=(t,e,r)=>t+(e-t)*r,S2=(t,e,r)=>{const n=t*t,s=r*(e*e-n)+n;return s<0?0:Math.sqrt(s)},H9=[vT,Xh,mp],Z9=t=>H9.find(e=>e.test(t));function MI(t){const e=Z9(t);if(!e)return!1;let r=e.parse(t);return e===mp&&(r=q9(r)),r}const II=(t,e)=>{const r=MI(t),n=MI(e);if(!r||!n)return ob(t,e);const s={...r};return c=>(s.red=S2(r.red,n.red,c),s.green=S2(r.green,n.green,c),s.blue=S2(r.blue,n.blue,c),s.alpha=Rn(r.alpha,n.alpha,c),Xh.transform(s))},xT=new Set(["none","hidden"]);function K9(t,e){return xT.has(t)?r=>r<=0?t:e:r=>r>=1?e:t}function X9(t,e){return r=>Rn(t,e,r)}function uP(t){return typeof t=="number"?X9:typeof t=="string"?aP(t)?ob:mi.test(t)?II:J9:Array.isArray(t)?D5:typeof t=="object"?mi.test(t)?II:Y9:ob}function D5(t,e){const r=[...t],n=r.length,s=t.map((c,l)=>uP(c)(c,e[l]));return c=>{for(let l=0;l<n;l++)r[l]=s[l](c);return r}}function Y9(t,e){const r={...t,...e},n={};for(const s in r)t[s]!==void 0&&e[s]!==void 0&&(n[s]=uP(t[s])(t[s],e[s]));return s=>{for(const c in n)r[c]=n[c](s);return r}}function Q9(t,e){const r=[],n={color:0,var:0,number:0};for(let s=0;s<e.values.length;s++){const c=e.types[s],l=t.indexes[c][n[c]],a=t.values[l]??0;r[s]=a,n[c]++}return r}const J9=(t,e)=>{const r=ku.createTransformer(e),n=a0(t),s=a0(e);return n.indexes.var.length===s.indexes.var.length&&n.indexes.color.length===s.indexes.color.length&&n.indexes.number.length>=s.indexes.number.length?xT.has(t)&&!s.values.length||xT.has(e)&&!n.values.length?K9(t,e):V0(D5(Q9(n,s),s.values),r):ob(t,e)};function L5(t,e,r){return typeof t=="number"&&typeof e=="number"&&typeof r=="number"?Rn(t,e,r):uP(t)(t,e)}const eG=t=>{const e=({timestamp:r})=>t(r);return{start:(r=!0)=>wn.update(e,r),stop:()=>Au(e),now:()=>Yi.isProcessing?Yi.timestamp:Hs.now()}},O5=(t,e,r=10)=>{let n="";const s=Math.max(Math.round(e/r),2);for(let c=0;c<s;c++)n+=Math.round(t(c/(s-1))*1e4)/1e4+", ";return`linear(${n.substring(0,n.length-2)})`},ab=2e4;function hP(t){let e=0;const r=50;let n=t.next(e);for(;!n.done&&e<ab;)e+=r,n=t.next(e);return e>=ab?1/0:e}function tG(t,e=100,r){const n=r({...t,keyframes:[0,e]}),s=Math.min(hP(n),ab);return{type:"keyframes",ease:c=>n.next(s*c).value/e,duration:Zo(s)}}const rG=5;function z5(t,e,r){const n=Math.max(e-rG,0);return m5(r-t(n),e-n)}const Bn={stiffness:100,damping:10,mass:1,velocity:0,duration:800,bounce:.3,visualDuration:.3,restSpeed:{granular:.01,default:2},restDelta:{granular:.005,default:.5},minDuration:.01,maxDuration:10,minDamping:.05,maxDamping:1},T2=.001;function nG({duration:t=Bn.duration,bounce:e=Bn.bounce,velocity:r=Bn.velocity,mass:n=Bn.mass}){let s,c,l=1-e;l=rc(Bn.minDamping,Bn.maxDamping,l),t=rc(Bn.minDuration,Bn.maxDuration,Zo(t)),l<1?(s=y=>{const v=y*l,T=v*t,P=v-r,A=bT(y,l),O=Math.exp(-T);return T2-P/A*O},c=y=>{const T=y*l*t,P=T*r+r,A=Math.pow(l,2)*Math.pow(y,2)*t,O=Math.exp(-T),I=bT(Math.pow(y,2),l);return(-s(y)+T2>0?-1:1)*((P-A)*O)/I}):(s=y=>{const v=Math.exp(-y*t),T=(y-r)*t+1;return-T2+v*T},c=y=>{const v=Math.exp(-y*t),T=(r-y)*(t*t);return v*T});const a=5/t,m=sG(s,c,a);if(t=fl(t),isNaN(m))return{stiffness:Bn.stiffness,damping:Bn.damping,duration:t};{const y=Math.pow(m,2)*n;return{stiffness:y,damping:l*2*Math.sqrt(n*y),duration:t}}}const iG=12;function sG(t,e,r){let n=r;for(let s=1;s<iG;s++)n=n-t(n)/e(n);return n}function bT(t,e){return t*Math.sqrt(1-e*e)}const oG=["duration","bounce"],aG=["stiffness","damping","mass"];function RI(t,e){return e.some(r=>t[r]!==void 0)}function lG(t){let e={velocity:Bn.velocity,stiffness:Bn.stiffness,damping:Bn.damping,mass:Bn.mass,isResolvedFromDuration:!1,...t};if(!RI(t,aG)&&RI(t,oG))if(t.visualDuration){const r=t.visualDuration,n=2*Math.PI/(r*1.2),s=n*n,c=2*rc(.05,1,1-(t.bounce||0))*Math.sqrt(s);e={...e,mass:Bn.mass,stiffness:s,damping:c}}else{const r=nG(t);e={...e,...r,mass:Bn.mass},e.isResolvedFromDuration=!0}return e}function lb(t=Bn.visualDuration,e=Bn.bounce){const r=typeof t!="object"?{visualDuration:t,keyframes:[0,1],bounce:e}:t;let{restSpeed:n,restDelta:s}=r;const c=r.keyframes[0],l=r.keyframes[r.keyframes.length-1],a={done:!1,value:c},{stiffness:m,damping:y,mass:v,duration:T,velocity:P,isResolvedFromDuration:A}=lG({...r,velocity:-Zo(r.velocity||0)}),O=P||0,I=y/(2*Math.sqrt(m*v)),L=l-c,R=Zo(Math.sqrt(m/v)),z=Math.abs(L)<5;n||(n=z?Bn.restSpeed.granular:Bn.restSpeed.default),s||(s=z?Bn.restDelta.granular:Bn.restDelta.default);let j;if(I<1){const Z=bT(R,I);j=te=>{const ie=Math.exp(-I*R*te);return l-ie*((O+I*R*L)/Z*Math.sin(Z*te)+L*Math.cos(Z*te))}}else if(I===1)j=Z=>l-Math.exp(-R*Z)*(L+(O+R*L)*Z);else{const Z=R*Math.sqrt(I*I-1);j=te=>{const ie=Math.exp(-I*R*te),V=Math.min(Z*te,300);return l-ie*((O+I*R*L)*Math.sinh(V)+Z*L*Math.cosh(V))/Z}}const W={calculatedDuration:A&&T||null,next:Z=>{const te=j(Z);if(A)a.done=Z>=T;else{let ie=Z===0?O:0;I<1&&(ie=Z===0?fl(O):z5(j,Z,te));const V=Math.abs(ie)<=n,q=Math.abs(l-te)<=s;a.done=V&&q}return a.value=a.done?l:te,a},toString:()=>{const Z=Math.min(hP(W),ab),te=O5(ie=>W.next(Z*ie).value,Z,30);return Z+"ms "+te},toTransition:()=>{}};return W}lb.applyToOptions=t=>{const e=tG(t,100,lb);return t.ease=e.ease,t.duration=fl(e.duration),t.type="keyframes",t};function wT({keyframes:t,velocity:e=0,power:r=.8,timeConstant:n=325,bounceDamping:s=10,bounceStiffness:c=500,modifyTarget:l,min:a,max:m,restDelta:y=.5,restSpeed:v}){const T=t[0],P={done:!1,value:T},A=V=>a!==void 0&&V<a||m!==void 0&&V>m,O=V=>a===void 0?m:m===void 0||Math.abs(a-V)<Math.abs(m-V)?a:m;let I=r*e;const L=T+I,R=l===void 0?L:l(L);R!==L&&(I=R-T);const z=V=>-I*Math.exp(-V/n),j=V=>R+z(V),W=V=>{const q=z(V),Q=j(V);P.done=Math.abs(q)<=y,P.value=P.done?R:Q};let Z,te;const ie=V=>{A(P.value)&&(Z=V,te=lb({keyframes:[P.value,O(P.value)],velocity:z5(j,V,P.value),damping:s,stiffness:c,restDelta:y,restSpeed:v}))};return ie(0),{calculatedDuration:null,next:V=>{let q=!1;return!te&&Z===void 0&&(q=!0,W(V),ie(V)),Z!==void 0&&V>=Z?te.next(V-Z):(!q&&W(V),P)}}}function cG(t,e,r){const n=[],s=r||nc.mix||L5,c=t.length-1;for(let l=0;l<c;l++){let a=s(t[l],t[l+1]);if(e){const m=Array.isArray(e)?e[l]||Jo:e;a=V0(m,a)}n.push(a)}return n}function uG(t,e,{clamp:r=!0,ease:n,mixer:s}={}){const c=t.length;if(tP(c===e.length),c===1)return()=>e[0];if(c===2&&e[0]===e[1])return()=>e[1];const l=t[0]===t[1];t[0]>t[c-1]&&(t=[...t].reverse(),e=[...e].reverse());const a=cG(e,n,s),m=a.length,y=v=>{if(l&&v<t[0])return e[0];let T=0;if(m>1)for(;T<t.length-2&&!(v<t[T+1]);T++);const P=s0(t[T],t[T+1],v);return a[T](P)};return r?v=>y(rc(t[0],t[c-1],v)):y}function hG(t,e){const r=t[t.length-1];for(let n=1;n<=e;n++){const s=s0(0,e,n);t.push(Rn(r,1,s))}}function dG(t){const e=[0];return hG(e,t.length-1),e}function fG(t,e){return t.map(r=>r*e)}function pG(t,e){return t.map(()=>e||T5).splice(0,t.length-1)}function Ty({duration:t=300,keyframes:e,times:r,ease:n="easeInOut"}){const s=E9(n)?n.map(PI):PI(n),c={done:!1,value:e[0]},l=fG(r&&r.length===e.length?r:dG(e),t),a=uG(l,e,{ease:Array.isArray(s)?s:pG(e,s)});return{calculatedDuration:t,next:m=>(c.value=a(m),c.done=m>=t,c)}}const mG=t=>t!==null;function dP(t,{repeat:e,repeatType:r="loop"},n,s=1){const c=t.filter(mG),a=s<0||e&&r!=="loop"&&e%2===1?0:c.length-1;return!a||n===void 0?c[a]:n}const gG={decay:wT,inertia:wT,tween:Ty,keyframes:Ty,spring:lb};function N5(t){typeof t.type=="string"&&(t.type=gG[t.type])}class fP{constructor(){this.updateFinished()}get finished(){return this._finished}updateFinished(){this._finished=new Promise(e=>{this.resolve=e})}notifyFinished(){this.resolve()}then(e,r){return this.finished.then(e,r)}}const yG=t=>t/100;class pP extends fP{constructor(e){super(),this.state="idle",this.startTime=null,this.isStopped=!1,this.currentTime=0,this.holdTime=null,this.playbackSpeed=1,this.stop=()=>{var n,s;const{motionValue:r}=this.options;r&&r.updatedAt!==Hs.now()&&this.tick(Hs.now()),this.isStopped=!0,this.state!=="idle"&&(this.teardown(),(s=(n=this.options).onStop)==null||s.call(n))},this.options=e,this.initAnimation(),this.play(),e.autoplay===!1&&this.pause()}initAnimation(){const{options:e}=this;N5(e);const{type:r=Ty,repeat:n=0,repeatDelay:s=0,repeatType:c,velocity:l=0}=e;let{keyframes:a}=e;const m=r||Ty;m!==Ty&&typeof a[0]!="number"&&(this.mixKeyframes=V0(yG,L5(a[0],a[1])),a=[0,100]);const y=m({...e,keyframes:a});c==="mirror"&&(this.mirroredGenerator=m({...e,keyframes:[...a].reverse(),velocity:-l})),y.calculatedDuration===null&&(y.calculatedDuration=hP(y));const{calculatedDuration:v}=y;this.calculatedDuration=v,this.resolvedDuration=v+s,this.totalDuration=this.resolvedDuration*(n+1)-s,this.generator=y}updateTime(e){const r=Math.round(e-this.startTime)*this.playbackSpeed;this.holdTime!==null?this.currentTime=this.holdTime:this.currentTime=r}tick(e,r=!1){const{generator:n,totalDuration:s,mixKeyframes:c,mirroredGenerator:l,resolvedDuration:a,calculatedDuration:m}=this;if(this.startTime===null)return n.next(0);const{delay:y=0,keyframes:v,repeat:T,repeatType:P,repeatDelay:A,type:O,onUpdate:I,finalKeyframe:L}=this.options;this.speed>0?this.startTime=Math.min(this.startTime,e):this.speed<0&&(this.startTime=Math.min(e-s/this.speed,this.startTime)),r?this.currentTime=e:this.updateTime(e);const R=this.currentTime-y*(this.playbackSpeed>=0?1:-1),z=this.playbackSpeed>=0?R<0:R>s;this.currentTime=Math.max(R,0),this.state==="finished"&&this.holdTime===null&&(this.currentTime=s);let j=this.currentTime,W=n;if(T){const V=Math.min(this.currentTime,s)/a;let q=Math.floor(V),Q=V%1;!Q&&V>=1&&(Q=1),Q===1&&q--,q=Math.min(q,T+1),!!(q%2)&&(P==="reverse"?(Q=1-Q,A&&(Q-=A/a)):P==="mirror"&&(W=l)),j=rc(0,1,Q)*a}const Z=z?{done:!1,value:v[0]}:W.next(j);c&&(Z.value=c(Z.value));let{done:te}=Z;!z&&m!==null&&(te=this.playbackSpeed>=0?this.currentTime>=s:this.currentTime<=0);const ie=this.holdTime===null&&(this.state==="finished"||this.state==="running"&&te);return ie&&O!==wT&&(Z.value=dP(v,this.options,L,this.speed)),I&&I(Z.value),ie&&this.finish(),Z}then(e,r){return this.finished.then(e,r)}get duration(){return Zo(this.calculatedDuration)}get iterationDuration(){const{delay:e=0}=this.options||{};return this.duration+Zo(e)}get time(){return Zo(this.currentTime)}set time(e){var r;e=fl(e),this.currentTime=e,this.startTime===null||this.holdTime!==null||this.playbackSpeed===0?this.holdTime=e:this.driver&&(this.startTime=this.driver.now()-e/this.playbackSpeed),(r=this.driver)==null||r.start(!1)}get speed(){return this.playbackSpeed}set speed(e){this.updateTime(Hs.now());const r=this.playbackSpeed!==e;this.playbackSpeed=e,r&&(this.time=Zo(this.currentTime))}play(){var s,c;if(this.isStopped)return;const{driver:e=eG,startTime:r}=this.options;this.driver||(this.driver=e(l=>this.tick(l))),(c=(s=this.options).onPlay)==null||c.call(s);const n=this.driver.now();this.state==="finished"?(this.updateFinished(),this.startTime=n):this.holdTime!==null?this.startTime=n-this.holdTime:this.startTime||(this.startTime=r??n),this.state==="finished"&&this.speed<0&&(this.startTime+=this.calculatedDuration),this.holdTime=null,this.state="running",this.driver.start()}pause(){this.state="paused",this.updateTime(Hs.now()),this.holdTime=this.currentTime}complete(){this.state!=="running"&&this.play(),this.state="finished",this.holdTime=null}finish(){var e,r;this.notifyFinished(),this.teardown(),this.state="finished",(r=(e=this.options).onComplete)==null||r.call(e)}cancel(){var e,r;this.holdTime=null,this.startTime=0,this.tick(0),this.teardown(),(r=(e=this.options).onCancel)==null||r.call(e)}teardown(){this.state="idle",this.stopDriver(),this.startTime=this.holdTime=null}stopDriver(){this.driver&&(this.driver.stop(),this.driver=void 0)}sample(e){return this.startTime=0,this.tick(e,!0)}attachTimeline(e){var r;return this.options.allowFlatten&&(this.options.type="keyframes",this.options.ease="linear",this.initAnimation()),(r=this.driver)==null||r.stop(),e.observe(this)}}function _G(t){for(let e=1;e<t.length;e++)t[e]??(t[e]=t[e-1])}const Yh=t=>t*180/Math.PI,ST=t=>{const e=Yh(Math.atan2(t[1],t[0]));return TT(e)},vG={x:4,y:5,translateX:4,translateY:5,scaleX:0,scaleY:3,scale:t=>(Math.abs(t[0])+Math.abs(t[3]))/2,rotate:ST,rotateZ:ST,skewX:t=>Yh(Math.atan(t[1])),skewY:t=>Yh(Math.atan(t[2])),skew:t=>(Math.abs(t[1])+Math.abs(t[2]))/2},TT=t=>(t=t%360,t<0&&(t+=360),t),DI=ST,LI=t=>Math.sqrt(t[0]*t[0]+t[1]*t[1]),OI=t=>Math.sqrt(t[4]*t[4]+t[5]*t[5]),xG={x:12,y:13,z:14,translateX:12,translateY:13,translateZ:14,scaleX:LI,scaleY:OI,scale:t=>(LI(t)+OI(t))/2,rotateX:t=>TT(Yh(Math.atan2(t[6],t[5]))),rotateY:t=>TT(Yh(Math.atan2(-t[2],t[0]))),rotateZ:DI,rotate:DI,skewX:t=>Yh(Math.atan(t[4])),skewY:t=>Yh(Math.atan(t[1])),skew:t=>(Math.abs(t[1])+Math.abs(t[4]))/2};function ET(t){return t.includes("scale")?1:0}function CT(t,e){if(!t||t==="none")return ET(e);const r=t.match(/^matrix3d\(([-\d.e\s,]+)\)$/u);let n,s;if(r)n=xG,s=r;else{const a=t.match(/^matrix\(([-\d.e\s,]+)\)$/u);n=vG,s=a}if(!s)return ET(e);const c=n[e],l=s[1].split(",").map(wG);return typeof c=="function"?c(l):l[c]}const bG=(t,e)=>{const{transform:r="none"}=getComputedStyle(t);return CT(r,e)};function wG(t){return parseFloat(t.trim())}const _m=["transformPerspective","x","y","z","translateX","translateY","translateZ","scale","scaleX","scaleY","rotate","rotateX","rotateY","rotateZ","skew","skewX","skewY"],vm=new Set(_m),zI=t=>t===ym||t===Xt,SG=new Set(["x","y","z"]),TG=_m.filter(t=>!SG.has(t));function EG(t){const e=[];return TG.forEach(r=>{const n=t.getValue(r);n!==void 0&&(e.push([r,n.get()]),n.set(r.startsWith("scale")?1:0))}),e}const hd={width:({x:t},{paddingLeft:e="0",paddingRight:r="0"})=>t.max-t.min-parseFloat(e)-parseFloat(r),height:({y:t},{paddingTop:e="0",paddingBottom:r="0"})=>t.max-t.min-parseFloat(e)-parseFloat(r),top:(t,{top:e})=>parseFloat(e),left:(t,{left:e})=>parseFloat(e),bottom:({y:t},{top:e})=>parseFloat(e)+(t.max-t.min),right:({x:t},{left:e})=>parseFloat(e)+(t.max-t.min),x:(t,{transform:e})=>CT(e,"x"),y:(t,{transform:e})=>CT(e,"y")};hd.translateX=hd.x;hd.translateY=hd.y;const dd=new Set;let PT=!1,AT=!1,kT=!1;function j5(){if(AT){const t=Array.from(dd).filter(n=>n.needsMeasurement),e=new Set(t.map(n=>n.element)),r=new Map;e.forEach(n=>{const s=EG(n);s.length&&(r.set(n,s),n.render())}),t.forEach(n=>n.measureInitialState()),e.forEach(n=>{n.render();const s=r.get(n);s&&s.forEach(([c,l])=>{var a;(a=n.getValue(c))==null||a.set(l)})}),t.forEach(n=>n.measureEndState()),t.forEach(n=>{n.suspendedScrollY!==void 0&&window.scrollTo(0,n.suspendedScrollY)})}AT=!1,PT=!1,dd.forEach(t=>t.complete(kT)),dd.clear()}function F5(){dd.forEach(t=>{t.readKeyframes(),t.needsMeasurement&&(AT=!0)})}function CG(){kT=!0,F5(),j5(),kT=!1}class mP{constructor(e,r,n,s,c,l=!1){this.state="pending",this.isAsync=!1,this.needsMeasurement=!1,this.unresolvedKeyframes=[...e],this.onComplete=r,this.name=n,this.motionValue=s,this.element=c,this.isAsync=l}scheduleResolve(){this.state="scheduled",this.isAsync?(dd.add(this),PT||(PT=!0,wn.read(F5),wn.resolveKeyframes(j5))):(this.readKeyframes(),this.complete())}readKeyframes(){const{unresolvedKeyframes:e,name:r,element:n,motionValue:s}=this;if(e[0]===null){const c=s==null?void 0:s.get(),l=e[e.length-1];if(c!==void 0)e[0]=c;else if(n&&r){const a=n.readValue(r,l);a!=null&&(e[0]=a)}e[0]===void 0&&(e[0]=l),s&&c===void 0&&s.set(e[0])}_G(e)}setFinalKeyframe(){}measureInitialState(){}renderEndStyles(){}measureEndState(){}complete(e=!1){this.state="complete",this.onComplete(this.unresolvedKeyframes,this.finalKeyframe,e),dd.delete(this)}cancel(){this.state==="scheduled"&&(dd.delete(this),this.state="pending")}resume(){this.state==="pending"&&this.scheduleResolve()}}const PG=t=>t.startsWith("--");function AG(t,e,r){PG(e)?t.style.setProperty(e,r):t.style[e]=r}const kG=rP(()=>window.ScrollTimeline!==void 0),MG={};function IG(t,e){const r=rP(t);return()=>MG[e]??r()}const B5=IG(()=>{try{document.createElement("div").animate({opacity:0},{easing:"linear(0, 1)"})}catch{return!1}return!0},"linearEasing"),iy=([t,e,r,n])=>`cubic-bezier(${t}, ${e}, ${r}, ${n})`,NI={linear:"linear",ease:"ease",easeIn:"ease-in",easeOut:"ease-out",easeInOut:"ease-in-out",circIn:iy([0,.65,.55,1]),circOut:iy([.55,0,1,.45]),backIn:iy([.31,.01,.66,-.59]),backOut:iy([.33,1.53,.69,.99])};function $5(t,e){if(t)return typeof t=="function"?B5()?O5(t,e):"ease-out":E5(t)?iy(t):Array.isArray(t)?t.map(r=>$5(r,e)||NI.easeOut):NI[t]}function RG(t,e,r,{delay:n=0,duration:s=300,repeat:c=0,repeatType:l="loop",ease:a="easeOut",times:m}={},y=void 0){const v={[e]:r};m&&(v.offset=m);const T=$5(a,s);Array.isArray(T)&&(v.easing=T);const P={delay:n,duration:s,easing:Array.isArray(T)?"linear":T,fill:"both",iterations:c+1,direction:l==="reverse"?"alternate":"normal"};return y&&(P.pseudoElement=y),t.animate(v,P)}function V5(t){return typeof t=="function"&&"applyToOptions"in t}function DG({type:t,...e}){return V5(t)&&B5()?t.applyToOptions(e):(e.duration??(e.duration=300),e.ease??(e.ease="easeOut"),e)}class LG extends fP{constructor(e){if(super(),this.finishedTime=null,this.isStopped=!1,!e)return;const{element:r,name:n,keyframes:s,pseudoElement:c,allowFlatten:l=!1,finalKeyframe:a,onComplete:m}=e;this.isPseudoElement=!!c,this.allowFlatten=l,this.options=e,tP(typeof e.type!="string");const y=DG(e);this.animation=RG(r,n,s,y,c),y.autoplay===!1&&this.animation.pause(),this.animation.onfinish=()=>{if(this.finishedTime=this.time,!c){const v=dP(s,this.options,a,this.speed);this.updateMotionValue?this.updateMotionValue(v):AG(r,n,v),this.animation.cancel()}m==null||m(),this.notifyFinished()}}play(){this.isStopped||(this.animation.play(),this.state==="finished"&&this.updateFinished())}pause(){this.animation.pause()}complete(){var e,r;(r=(e=this.animation).finish)==null||r.call(e)}cancel(){try{this.animation.cancel()}catch{}}stop(){if(this.isStopped)return;this.isStopped=!0;const{state:e}=this;e==="idle"||e==="finished"||(this.updateMotionValue?this.updateMotionValue():this.commitStyles(),this.isPseudoElement||this.cancel())}commitStyles(){var e,r;this.isPseudoElement||(r=(e=this.animation).commitStyles)==null||r.call(e)}get duration(){var r,n;const e=((n=(r=this.animation.effect)==null?void 0:r.getComputedTiming)==null?void 0:n.call(r).duration)||0;return Zo(Number(e))}get iterationDuration(){const{delay:e=0}=this.options||{};return this.duration+Zo(e)}get time(){return Zo(Number(this.animation.currentTime)||0)}set time(e){this.finishedTime=null,this.animation.currentTime=fl(e)}get speed(){return this.animation.playbackRate}set speed(e){e<0&&(this.finishedTime=null),this.animation.playbackRate=e}get state(){return this.finishedTime!==null?"finished":this.animation.playState}get startTime(){return Number(this.animation.startTime)}set startTime(e){this.animation.startTime=e}attachTimeline({timeline:e,observe:r}){var n;return this.allowFlatten&&((n=this.animation.effect)==null||n.updateTiming({easing:"linear"})),this.animation.onfinish=null,e&&kG()?(this.animation.timeline=e,Jo):r(this)}}const U5={anticipate:b5,backInOut:x5,circInOut:S5};function OG(t){return t in U5}function zG(t){typeof t.ease=="string"&&OG(t.ease)&&(t.ease=U5[t.ease])}const jI=10;class NG extends LG{constructor(e){zG(e),N5(e),super(e),e.startTime&&(this.startTime=e.startTime),this.options=e}updateMotionValue(e){const{motionValue:r,onUpdate:n,onComplete:s,element:c,...l}=this.options;if(!r)return;if(e!==void 0){r.set(e);return}const a=new pP({...l,autoplay:!1}),m=fl(this.finishedTime??this.time);r.setWithVelocity(a.sample(m-jI).value,a.sample(m).value,jI),a.stop()}}const FI=(t,e)=>e==="zIndex"?!1:!!(typeof t=="number"||Array.isArray(t)||typeof t=="string"&&(ku.test(t)||t==="0")&&!t.startsWith("url("));function jG(t){const e=t[0];if(t.length===1)return!0;for(let r=0;r<t.length;r++)if(t[r]!==e)return!0}function FG(t,e,r,n){const s=t[0];if(s===null)return!1;if(e==="display"||e==="visibility")return!0;const c=t[t.length-1],l=FI(s,e),a=FI(c,e);return!l||!a?!1:jG(t)||(r==="spring"||V5(r))&&n}function MT(t){t.duration=0,t.type="keyframes"}const BG=new Set(["opacity","clipPath","filter","transform"]),$G=rP(()=>Object.hasOwnProperty.call(Element.prototype,"animate"));function VG(t){var v;const{motionValue:e,name:r,repeatDelay:n,repeatType:s,damping:c,type:l}=t;if(!(((v=e==null?void 0:e.owner)==null?void 0:v.current)instanceof HTMLElement))return!1;const{onUpdate:m,transformTemplate:y}=e.owner.getProps();return $G()&&r&&BG.has(r)&&(r!=="transform"||!y)&&!m&&!n&&s!=="mirror"&&c!==0&&l!=="inertia"}const UG=40;class GG extends fP{constructor({autoplay:e=!0,delay:r=0,type:n="keyframes",repeat:s=0,repeatDelay:c=0,repeatType:l="loop",keyframes:a,name:m,motionValue:y,element:v,...T}){var O;super(),this.stop=()=>{var I,L;this._animation&&(this._animation.stop(),(I=this.stopTimeline)==null||I.call(this)),(L=this.keyframeResolver)==null||L.cancel()},this.createdAt=Hs.now();const P={autoplay:e,delay:r,type:n,repeat:s,repeatDelay:c,repeatType:l,name:m,motionValue:y,element:v,...T},A=(v==null?void 0:v.KeyframeResolver)||mP;this.keyframeResolver=new A(a,(I,L,R)=>this.onKeyframesResolved(I,L,P,!R),m,y,v),(O=this.keyframeResolver)==null||O.scheduleResolve()}onKeyframesResolved(e,r,n,s){this.keyframeResolver=void 0;const{name:c,type:l,velocity:a,delay:m,isHandoff:y,onUpdate:v}=n;this.resolvedAt=Hs.now(),FG(e,c,l,a)||((nc.instantAnimations||!m)&&(v==null||v(dP(e,n,r))),e[0]=e[e.length-1],MT(n),n.repeat=0);const P={startTime:s?this.resolvedAt?this.resolvedAt-this.createdAt>UG?this.resolvedAt:this.createdAt:this.createdAt:void 0,finalKeyframe:r,...n,keyframes:e},A=!y&&VG(P)?new NG({...P,element:P.motionValue.owner.current}):new pP(P);A.finished.then(()=>this.notifyFinished()).catch(Jo),this.pendingTimeline&&(this.stopTimeline=A.attachTimeline(this.pendingTimeline),this.pendingTimeline=void 0),this._animation=A}get finished(){return this._animation?this.animation.finished:this._finished}then(e,r){return this.finished.finally(e).then(()=>{})}get animation(){var e;return this._animation||((e=this.keyframeResolver)==null||e.resume(),CG()),this._animation}get duration(){return this.animation.duration}get iterationDuration(){return this.animation.iterationDuration}get time(){return this.animation.time}set time(e){this.animation.time=e}get speed(){return this.animation.speed}get state(){return this.animation.state}set speed(e){this.animation.speed=e}get startTime(){return this.animation.startTime}attachTimeline(e){return this._animation?this.stopTimeline=this.animation.attachTimeline(e):this.pendingTimeline=e,()=>this.stop()}play(){this.animation.play()}pause(){this.animation.pause()}complete(){this.animation.complete()}cancel(){var e;this._animation&&this.animation.cancel(),(e=this.keyframeResolver)==null||e.cancel()}}const WG=/^var\(--(?:([\w-]+)|([\w-]+), ?([a-zA-Z\d ()%#.,-]+))\)/u;function qG(t){const e=WG.exec(t);if(!e)return[,];const[,r,n,s]=e;return[`--${r??n}`,s]}function G5(t,e,r=1){const[n,s]=qG(t);if(!n)return;const c=window.getComputedStyle(e).getPropertyValue(n);if(c){const l=c.trim();return d5(l)?parseFloat(l):l}return aP(s)?G5(s,e,r+1):s}function gP(t,e){return(t==null?void 0:t[e])??(t==null?void 0:t.default)??t}const W5=new Set(["width","height","top","left","right","bottom",..._m]),HG={test:t=>t==="auto",parse:t=>t},q5=t=>e=>e.test(t),H5=[ym,Xt,pl,Zc,j9,N9,HG],BI=t=>H5.find(q5(t));function ZG(t){return typeof t=="number"?t===0:t!==null?t==="none"||t==="0"||p5(t):!0}const KG=new Set(["brightness","contrast","saturate","opacity"]);function XG(t){const[e,r]=t.slice(0,-1).split("(");if(e==="drop-shadow")return t;const[n]=r.match(lP)||[];if(!n)return t;const s=r.replace(n,"");let c=KG.has(e)?1:0;return n!==r&&(c*=100),e+"("+c+s+")"}const YG=/\b([a-z-]*)\(.*?\)/gu,IT={...ku,getAnimatableNone:t=>{const e=t.match(YG);return e?e.map(XG).join(" "):t}},$I={...ym,transform:Math.round},QG={rotate:Zc,rotateX:Zc,rotateY:Zc,rotateZ:Zc,scale:Ov,scaleX:Ov,scaleY:Ov,scaleZ:Ov,skew:Zc,skewX:Zc,skewY:Zc,distance:Xt,translateX:Xt,translateY:Xt,translateZ:Xt,x:Xt,y:Xt,z:Xt,perspective:Xt,transformPerspective:Xt,opacity:o0,originX:AI,originY:AI,originZ:Xt},yP={borderWidth:Xt,borderTopWidth:Xt,borderRightWidth:Xt,borderBottomWidth:Xt,borderLeftWidth:Xt,borderRadius:Xt,radius:Xt,borderTopLeftRadius:Xt,borderTopRightRadius:Xt,borderBottomRightRadius:Xt,borderBottomLeftRadius:Xt,width:Xt,maxWidth:Xt,height:Xt,maxHeight:Xt,top:Xt,right:Xt,bottom:Xt,left:Xt,padding:Xt,paddingTop:Xt,paddingRight:Xt,paddingBottom:Xt,paddingLeft:Xt,margin:Xt,marginTop:Xt,marginRight:Xt,marginBottom:Xt,marginLeft:Xt,backgroundPositionX:Xt,backgroundPositionY:Xt,...QG,zIndex:$I,fillOpacity:o0,strokeOpacity:o0,numOctaves:$I},JG={...yP,color:mi,backgroundColor:mi,outlineColor:mi,fill:mi,stroke:mi,borderColor:mi,borderTopColor:mi,borderRightColor:mi,borderBottomColor:mi,borderLeftColor:mi,filter:IT,WebkitFilter:IT},Z5=t=>JG[t];function K5(t,e){let r=Z5(t);return r!==IT&&(r=ku),r.getAnimatableNone?r.getAnimatableNone(e):void 0}const eW=new Set(["auto","none","0"]);function tW(t,e,r){let n=0,s;for(;n<t.length&&!s;){const c=t[n];typeof c=="string"&&!eW.has(c)&&a0(c).values.length&&(s=t[n]),n++}if(s&&r)for(const c of e)t[c]=K5(r,s)}class rW extends mP{constructor(e,r,n,s,c){super(e,r,n,s,c,!0)}readKeyframes(){const{unresolvedKeyframes:e,element:r,name:n}=this;if(!r||!r.current)return;super.readKeyframes();for(let m=0;m<e.length;m++){let y=e[m];if(typeof y=="string"&&(y=y.trim(),aP(y))){const v=G5(y,r.current);v!==void 0&&(e[m]=v),m===e.length-1&&(this.finalKeyframe=y)}}if(this.resolveNoneKeyframes(),!W5.has(n)||e.length!==2)return;const[s,c]=e,l=BI(s),a=BI(c);if(l!==a)if(zI(l)&&zI(a))for(let m=0;m<e.length;m++){const y=e[m];typeof y=="string"&&(e[m]=parseFloat(y))}else hd[n]&&(this.needsMeasurement=!0)}resolveNoneKeyframes(){const{unresolvedKeyframes:e,name:r}=this,n=[];for(let s=0;s<e.length;s++)(e[s]===null||ZG(e[s]))&&n.push(s);n.length&&tW(e,n,r)}measureInitialState(){const{element:e,unresolvedKeyframes:r,name:n}=this;if(!e||!e.current)return;n==="height"&&(this.suspendedScrollY=window.pageYOffset),this.measuredOrigin=hd[n](e.measureViewportBox(),window.getComputedStyle(e.current)),r[0]=this.measuredOrigin;const s=r[r.length-1];s!==void 0&&e.getValue(n,s).jump(s,!1)}measureEndState(){var a;const{element:e,name:r,unresolvedKeyframes:n}=this;if(!e||!e.current)return;const s=e.getValue(r);s&&s.jump(this.measuredOrigin,!1);const c=n.length-1,l=n[c];n[c]=hd[r](e.measureViewportBox(),window.getComputedStyle(e.current)),l!==null&&this.finalKeyframe===void 0&&(this.finalKeyframe=l),(a=this.removedTransforms)!=null&&a.length&&this.removedTransforms.forEach(([m,y])=>{e.getValue(m).set(y)}),this.resolveNoneKeyframes()}}function X5(t,e,r){if(t instanceof EventTarget)return[t];if(typeof t=="string"){const s=document.querySelectorAll(t);return s?Array.from(s):[]}return Array.from(t)}const Y5=(t,e)=>e&&typeof t=="number"?e.transform(t):t;function nW(t){return f5(t)&&"offsetHeight"in t}const VI=30,iW=t=>!isNaN(parseFloat(t));class sW{constructor(e,r={}){this.canTrackVelocity=null,this.events={},this.updateAndNotify=n=>{var c;const s=Hs.now();if(this.updatedAt!==s&&this.setPrevFrameValue(),this.prev=this.current,this.setCurrent(n),this.current!==this.prev&&((c=this.events.change)==null||c.notify(this.current),this.dependents))for(const l of this.dependents)l.dirty()},this.hasAnimated=!1,this.setCurrent(e),this.owner=r.owner}setCurrent(e){this.current=e,this.updatedAt=Hs.now(),this.canTrackVelocity===null&&e!==void 0&&(this.canTrackVelocity=iW(this.current))}setPrevFrameValue(e=this.current){this.prevFrameValue=e,this.prevUpdatedAt=this.updatedAt}onChange(e){return this.on("change",e)}on(e,r){this.events[e]||(this.events[e]=new nP);const n=this.events[e].add(r);return e==="change"?()=>{n(),wn.read(()=>{this.events.change.getSize()||this.stop()})}:n}clearListeners(){for(const e in this.events)this.events[e].clear()}attach(e,r){this.passiveEffect=e,this.stopPassiveEffect=r}set(e){this.passiveEffect?this.passiveEffect(e,this.updateAndNotify):this.updateAndNotify(e)}setWithVelocity(e,r,n){this.set(r),this.prev=void 0,this.prevFrameValue=e,this.prevUpdatedAt=this.updatedAt-n}jump(e,r=!0){this.updateAndNotify(e),this.prev=e,this.prevUpdatedAt=this.prevFrameValue=void 0,r&&this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}dirty(){var e;(e=this.events.change)==null||e.notify(this.current)}addDependent(e){this.dependents||(this.dependents=new Set),this.dependents.add(e)}removeDependent(e){this.dependents&&this.dependents.delete(e)}get(){return this.current}getPrevious(){return this.prev}getVelocity(){const e=Hs.now();if(!this.canTrackVelocity||this.prevFrameValue===void 0||e-this.updatedAt>VI)return 0;const r=Math.min(this.updatedAt-this.prevUpdatedAt,VI);return m5(parseFloat(this.current)-parseFloat(this.prevFrameValue),r)}start(e){return this.stop(),new Promise(r=>{this.hasAnimated=!0,this.animation=e(r),this.events.animationStart&&this.events.animationStart.notify()}).then(()=>{this.events.animationComplete&&this.events.animationComplete.notify(),this.clearAnimation()})}stop(){this.animation&&(this.animation.stop(),this.events.animationCancel&&this.events.animationCancel.notify()),this.clearAnimation()}isAnimating(){return!!this.animation}clearAnimation(){delete this.animation}destroy(){var e,r;(e=this.dependents)==null||e.clear(),(r=this.events.destroy)==null||r.notify(),this.clearListeners(),this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}}function em(t,e){return new sW(t,e)}const{schedule:_P}=C5(queueMicrotask,!1),ma={x:!1,y:!1};function Q5(){return ma.x||ma.y}function oW(t){return t==="x"||t==="y"?ma[t]?null:(ma[t]=!0,()=>{ma[t]=!1}):ma.x||ma.y?null:(ma.x=ma.y=!0,()=>{ma.x=ma.y=!1})}function J5(t,e){const r=X5(t),n=new AbortController,s={passive:!0,...e,signal:n.signal};return[r,s,()=>n.abort()]}function UI(t){return!(t.pointerType==="touch"||Q5())}function aW(t,e,r={}){const[n,s,c]=J5(t,r),l=a=>{if(!UI(a))return;const{target:m}=a,y=e(m,a);if(typeof y!="function"||!m)return;const v=T=>{UI(T)&&(y(T),m.removeEventListener("pointerleave",v))};m.addEventListener("pointerleave",v,s)};return n.forEach(a=>{a.addEventListener("pointerenter",l,s)}),c}const e4=(t,e)=>e?t===e?!0:e4(t,e.parentElement):!1,vP=t=>t.pointerType==="mouse"?typeof t.button!="number"||t.button<=0:t.isPrimary!==!1,lW=new Set(["BUTTON","INPUT","SELECT","TEXTAREA","A"]);function cW(t){return lW.has(t.tagName)||t.tabIndex!==-1}const _x=new WeakSet;function GI(t){return e=>{e.key==="Enter"&&t(e)}}function E2(t,e){t.dispatchEvent(new PointerEvent("pointer"+e,{isPrimary:!0,bubbles:!0}))}const uW=(t,e)=>{const r=t.currentTarget;if(!r)return;const n=GI(()=>{if(_x.has(r))return;E2(r,"down");const s=GI(()=>{E2(r,"up")}),c=()=>E2(r,"cancel");r.addEventListener("keyup",s,e),r.addEventListener("blur",c,e)});r.addEventListener("keydown",n,e),r.addEventListener("blur",()=>r.removeEventListener("keydown",n),e)};function WI(t){return vP(t)&&!Q5()}function hW(t,e,r={}){const[n,s,c]=J5(t,r),l=a=>{const m=a.currentTarget;if(!WI(a))return;_x.add(m);const y=e(m,a),v=(A,O)=>{window.removeEventListener("pointerup",T),window.removeEventListener("pointercancel",P),_x.has(m)&&_x.delete(m),WI(A)&&typeof y=="function"&&y(A,{success:O})},T=A=>{v(A,m===window||m===document||r.useGlobalTarget||e4(m,A.target))},P=A=>{v(A,!1)};window.addEventListener("pointerup",T,s),window.addEventListener("pointercancel",P,s)};return n.forEach(a=>{(r.useGlobalTarget?window:a).addEventListener("pointerdown",l,s),nW(a)&&(a.addEventListener("focus",y=>uW(y,s)),!cW(a)&&!a.hasAttribute("tabindex")&&(a.tabIndex=0))}),c}function t4(t){return f5(t)&&"ownerSVGElement"in t}function dW(t){return t4(t)&&t.tagName==="svg"}const ds=t=>!!(t&&t.getVelocity),fW=[...H5,mi,ku],pW=t=>fW.find(q5(t)),r4=X.createContext({transformPagePoint:t=>t,isStatic:!1,reducedMotion:"never"});function mW(t=!0){const e=X.useContext(QC);if(e===null)return[!0,null];const{isPresent:r,onExitComplete:n,register:s}=e,c=X.useId();X.useEffect(()=>{if(t)return s(c)},[t]);const l=X.useCallback(()=>t&&n&&n(c),[c,n,t]);return!r&&n?[!1,l]:[!0]}const n4=X.createContext({strict:!1}),qI={animation:["animate","variants","whileHover","whileTap","exit","whileInView","whileFocus","whileDrag"],exit:["exit"],drag:["drag","dragControls"],focus:["whileFocus"],hover:["whileHover","onHoverStart","onHoverEnd"],tap:["whileTap","onTap","onTapStart","onTapCancel"],pan:["onPan","onPanStart","onPanSessionStart","onPanEnd"],inView:["whileInView","onViewportEnter","onViewportLeave"],layout:["layout","layoutId"]},tm={};for(const t in qI)tm[t]={isEnabled:e=>qI[t].some(r=>!!e[r])};function gW(t){for(const e in t)tm[e]={...tm[e],...t[e]}}const yW=new Set(["animate","exit","variants","initial","style","values","variants","transition","transformTemplate","custom","inherit","onBeforeLayoutMeasure","onAnimationStart","onAnimationComplete","onUpdate","onDragStart","onDrag","onDragEnd","onMeasureDragConstraints","onDirectionLock","onDragTransitionEnd","_dragX","_dragY","onHoverStart","onHoverEnd","onViewportEnter","onViewportLeave","globalTapTarget","ignoreStrict","viewport"]);function cb(t){return t.startsWith("while")||t.startsWith("drag")&&t!=="draggable"||t.startsWith("layout")||t.startsWith("onTap")||t.startsWith("onPan")||t.startsWith("onLayout")||yW.has(t)}let i4=t=>!cb(t);function _W(t){typeof t=="function"&&(i4=e=>e.startsWith("on")?!cb(e):t(e))}try{_W(require("@emotion/is-prop-valid").default)}catch{}function vW(t,e,r){const n={};for(const s in t)s==="values"&&typeof t.values=="object"||(i4(s)||r===!0&&cb(s)||!e&&!cb(s)||t.draggable&&s.startsWith("onDrag"))&&(n[s]=t[s]);return n}const t1=X.createContext({});function r1(t){return t!==null&&typeof t=="object"&&typeof t.start=="function"}function l0(t){return typeof t=="string"||Array.isArray(t)}const xP=["animate","whileInView","whileFocus","whileHover","whileTap","whileDrag","exit"],bP=["initial",...xP];function n1(t){return r1(t.animate)||bP.some(e=>l0(t[e]))}function s4(t){return!!(n1(t)||t.variants)}function xW(t,e){if(n1(t)){const{initial:r,animate:n}=t;return{initial:r===!1||l0(r)?r:void 0,animate:l0(n)?n:void 0}}return t.inherit!==!1?e:{}}function bW(t){const{initial:e,animate:r}=xW(t,X.useContext(t1));return X.useMemo(()=>({initial:e,animate:r}),[HI(e),HI(r)])}function HI(t){return Array.isArray(t)?t.join(" "):t}const c0={};function wW(t){for(const e in t)c0[e]=t[e],oP(e)&&(c0[e].isCSSVariable=!0)}function o4(t,{layout:e,layoutId:r}){return vm.has(t)||t.startsWith("origin")||(e||r!==void 0)&&(!!c0[t]||t==="opacity")}const SW={x:"translateX",y:"translateY",z:"translateZ",transformPerspective:"perspective"},TW=_m.length;function EW(t,e,r){let n="",s=!0;for(let c=0;c<TW;c++){const l=_m[c],a=t[l];if(a===void 0)continue;let m=!0;if(typeof a=="number"?m=a===(l.startsWith("scale")?1:0):m=parseFloat(a)===0,!m||r){const y=Y5(a,yP[l]);if(!m){s=!1;const v=SW[l]||l;n+=`${v}(${y}) `}r&&(e[l]=y)}}return n=n.trim(),r?n=r(e,s?"":n):s&&(n="none"),n}function wP(t,e,r){const{style:n,vars:s,transformOrigin:c}=t;let l=!1,a=!1;for(const m in e){const y=e[m];if(vm.has(m)){l=!0;continue}else if(oP(m)){s[m]=y;continue}else{const v=Y5(y,yP[m]);m.startsWith("origin")?(a=!0,c[m]=v):n[m]=v}}if(e.transform||(l||r?n.transform=EW(e,t.transform,r):n.transform&&(n.transform="none")),a){const{originX:m="50%",originY:y="50%",originZ:v=0}=c;n.transformOrigin=`${m} ${y} ${v}`}}const SP=()=>({style:{},transform:{},transformOrigin:{},vars:{}});function a4(t,e,r){for(const n in e)!ds(e[n])&&!o4(n,r)&&(t[n]=e[n])}function CW({transformTemplate:t},e){return X.useMemo(()=>{const r=SP();return wP(r,e,t),Object.assign({},r.vars,r.style)},[e])}function PW(t,e){const r=t.style||{},n={};return a4(n,r,t),Object.assign(n,CW(t,e)),n}function AW(t,e){const r={},n=PW(t,e);return t.drag&&t.dragListener!==!1&&(r.draggable=!1,n.userSelect=n.WebkitUserSelect=n.WebkitTouchCallout="none",n.touchAction=t.drag===!0?"none":`pan-${t.drag==="x"?"y":"x"}`),t.tabIndex===void 0&&(t.onTap||t.onTapStart||t.whileTap)&&(r.tabIndex=0),r.style=n,r}const kW={offset:"stroke-dashoffset",array:"stroke-dasharray"},MW={offset:"strokeDashoffset",array:"strokeDasharray"};function IW(t,e,r=1,n=0,s=!0){t.pathLength=1;const c=s?kW:MW;t[c.offset]=Xt.transform(-n);const l=Xt.transform(e),a=Xt.transform(r);t[c.array]=`${l} ${a}`}function l4(t,{attrX:e,attrY:r,attrScale:n,pathLength:s,pathSpacing:c=1,pathOffset:l=0,...a},m,y,v){if(wP(t,a,y),m){t.style.viewBox&&(t.attrs.viewBox=t.style.viewBox);return}t.attrs=t.style,t.style={};const{attrs:T,style:P}=t;T.transform&&(P.transform=T.transform,delete T.transform),(P.transform||T.transformOrigin)&&(P.transformOrigin=T.transformOrigin??"50% 50%",delete T.transformOrigin),P.transform&&(P.transformBox=(v==null?void 0:v.transformBox)??"fill-box",delete T.transformBox),e!==void 0&&(T.x=e),r!==void 0&&(T.y=r),n!==void 0&&(T.scale=n),s!==void 0&&IW(T,s,c,l,!1)}const c4=()=>({...SP(),attrs:{}}),u4=t=>typeof t=="string"&&t.toLowerCase()==="svg";function RW(t,e,r,n){const s=X.useMemo(()=>{const c=c4();return l4(c,e,u4(n),t.transformTemplate,t.style),{...c.attrs,style:{...c.style}}},[e]);if(t.style){const c={};a4(c,t.style,t),s.style={...c,...s.style}}return s}const DW=["animate","circle","defs","desc","ellipse","g","image","line","filter","marker","mask","metadata","path","pattern","polygon","polyline","rect","stop","switch","symbol","svg","text","tspan","use","view"];function TP(t){return typeof t!="string"||t.includes("-")?!1:!!(DW.indexOf(t)>-1||/[A-Z]/u.test(t))}function LW(t,e,r,{latestValues:n},s,c=!1){const a=(TP(t)?RW:AW)(e,n,s,t),m=vW(e,typeof t=="string",c),y=t!==X.Fragment?{...m,...a,ref:r}:{},{children:v}=e,T=X.useMemo(()=>ds(v)?v.get():v,[v]);return X.createElement(t,{...y,children:T})}function ZI(t){const e=[{},{}];return t==null||t.values.forEach((r,n)=>{e[0][n]=r.get(),e[1][n]=r.getVelocity()}),e}function EP(t,e,r,n){if(typeof e=="function"){const[s,c]=ZI(n);e=e(r!==void 0?r:t.custom,s,c)}if(typeof e=="string"&&(e=t.variants&&t.variants[e]),typeof e=="function"){const[s,c]=ZI(n);e=e(r!==void 0?r:t.custom,s,c)}return e}function vx(t){return ds(t)?t.get():t}function OW({scrapeMotionValuesFromProps:t,createRenderState:e},r,n,s){return{latestValues:zW(r,n,s,t),renderState:e()}}function zW(t,e,r,n){const s={},c=n(t,{});for(const P in c)s[P]=vx(c[P]);let{initial:l,animate:a}=t;const m=n1(t),y=s4(t);e&&y&&!m&&t.inherit!==!1&&(l===void 0&&(l=e.initial),a===void 0&&(a=e.animate));let v=r?r.initial===!1:!1;v=v||l===!1;const T=v?a:l;if(T&&typeof T!="boolean"&&!r1(T)){const P=Array.isArray(T)?T:[T];for(let A=0;A<P.length;A++){const O=EP(t,P[A]);if(O){const{transitionEnd:I,transition:L,...R}=O;for(const z in R){let j=R[z];if(Array.isArray(j)){const W=v?j.length-1:0;j=j[W]}j!==null&&(s[z]=j)}for(const z in I)s[z]=I[z]}}}return s}const h4=t=>(e,r)=>{const n=X.useContext(t1),s=X.useContext(QC),c=()=>OW(t,e,n,s);return r?c():y9(c)};function CP(t,e,r){var c;const{style:n}=t,s={};for(const l in n)(ds(n[l])||e.style&&ds(e.style[l])||o4(l,t)||((c=r==null?void 0:r.getValue(l))==null?void 0:c.liveStyle)!==void 0)&&(s[l]=n[l]);return s}const NW=h4({scrapeMotionValuesFromProps:CP,createRenderState:SP});function d4(t,e,r){const n=CP(t,e,r);for(const s in t)if(ds(t[s])||ds(e[s])){const c=_m.indexOf(s)!==-1?"attr"+s.charAt(0).toUpperCase()+s.substring(1):s;n[c]=t[s]}return n}const jW=h4({scrapeMotionValuesFromProps:d4,createRenderState:c4}),FW=Symbol.for("motionComponentSymbol");function gp(t){return t&&typeof t=="object"&&Object.prototype.hasOwnProperty.call(t,"current")}function BW(t,e,r){return X.useCallback(n=>{n&&t.onMount&&t.onMount(n),e&&(n?e.mount(n):e.unmount()),r&&(typeof r=="function"?r(n):gp(r)&&(r.current=n))},[e])}const PP=t=>t.replace(/([a-z])([A-Z])/gu,"$1-$2").toLowerCase(),$W="framerAppearId",f4="data-"+PP($W),p4=X.createContext({});function VW(t,e,r,n,s){var I,L;const{visualElement:c}=X.useContext(t1),l=X.useContext(n4),a=X.useContext(QC),m=X.useContext(r4).reducedMotion,y=X.useRef(null);n=n||l.renderer,!y.current&&n&&(y.current=n(t,{visualState:e,parent:c,props:r,presenceContext:a,blockInitialAnimation:a?a.initial===!1:!1,reducedMotionConfig:m}));const v=y.current,T=X.useContext(p4);v&&!v.projection&&s&&(v.type==="html"||v.type==="svg")&&UW(y.current,r,s,T);const P=X.useRef(!1);X.useInsertionEffect(()=>{v&&P.current&&v.update(r,a)});const A=r[f4],O=X.useRef(!!A&&!((I=window.MotionHandoffIsComplete)!=null&&I.call(window,A))&&((L=window.MotionHasOptimisedAnimation)==null?void 0:L.call(window,A)));return _9(()=>{v&&(P.current=!0,window.MotionIsMounted=!0,v.updateFeatures(),v.scheduleRenderMicrotask(),O.current&&v.animationState&&v.animationState.animateChanges())}),X.useEffect(()=>{v&&(!O.current&&v.animationState&&v.animationState.animateChanges(),O.current&&(queueMicrotask(()=>{var R;(R=window.MotionHandoffMarkAsComplete)==null||R.call(window,A)}),O.current=!1),v.enteringChildren=void 0)}),v}function UW(t,e,r,n){const{layoutId:s,layout:c,drag:l,dragConstraints:a,layoutScroll:m,layoutRoot:y,layoutCrossfade:v}=e;t.projection=new r(t.latestValues,e["data-framer-portal-id"]?void 0:m4(t.parent)),t.projection.setOptions({layoutId:s,layout:c,alwaysMeasureLayout:!!l||a&&gp(a),visualElement:t,animationType:typeof c=="string"?c:"both",initialPromotionConfig:n,crossfade:v,layoutScroll:m,layoutRoot:y})}function m4(t){if(t)return t.options.allowProjection!==!1?t.projection:m4(t.parent)}function C2(t,{forwardMotionProps:e=!1}={},r,n){r&&gW(r);const s=TP(t)?jW:NW;function c(a,m){let y;const v={...X.useContext(r4),...a,layoutId:GW(a)},{isStatic:T}=v,P=bW(a),A=s(a,T);if(!T&&YC){WW();const O=qW(v);y=O.MeasureLayout,P.visualElement=VW(t,A,v,n,O.ProjectionNode)}return B.jsxs(t1.Provider,{value:P,children:[y&&P.visualElement?B.jsx(y,{visualElement:P.visualElement,...v}):null,LW(t,a,BW(A,P.visualElement,m),A,T,e)]})}c.displayName=`motion.${typeof t=="string"?t:`create(${t.displayName??t.name??""})`}`;const l=X.forwardRef(c);return l[FW]=t,l}function GW({layoutId:t}){const e=X.useContext(h5).id;return e&&t!==void 0?e+"-"+t:t}function WW(t,e){X.useContext(n4).strict}function qW(t){const{drag:e,layout:r}=tm;if(!e&&!r)return{};const n={...e,...r};return{MeasureLayout:e!=null&&e.isEnabled(t)||r!=null&&r.isEnabled(t)?n.MeasureLayout:void 0,ProjectionNode:n.ProjectionNode}}function HW(t,e){if(typeof Proxy>"u")return C2;const r=new Map,n=(c,l)=>C2(c,l,t,e),s=(c,l)=>n(c,l);return new Proxy(s,{get:(c,l)=>l==="create"?n:(r.has(l)||r.set(l,C2(l,void 0,t,e)),r.get(l))})}function g4({top:t,left:e,right:r,bottom:n}){return{x:{min:e,max:r},y:{min:t,max:n}}}function ZW({x:t,y:e}){return{top:e.min,right:t.max,bottom:e.max,left:t.min}}function KW(t,e){if(!e)return t;const r=e({x:t.left,y:t.top}),n=e({x:t.right,y:t.bottom});return{top:r.y,left:r.x,bottom:n.y,right:n.x}}function P2(t){return t===void 0||t===1}function RT({scale:t,scaleX:e,scaleY:r}){return!P2(t)||!P2(e)||!P2(r)}function Bh(t){return RT(t)||y4(t)||t.z||t.rotate||t.rotateX||t.rotateY||t.skewX||t.skewY}function y4(t){return KI(t.x)||KI(t.y)}function KI(t){return t&&t!=="0%"}function ub(t,e,r){const n=t-r,s=e*n;return r+s}function XI(t,e,r,n,s){return s!==void 0&&(t=ub(t,s,n)),ub(t,r,n)+e}function DT(t,e=0,r=1,n,s){t.min=XI(t.min,e,r,n,s),t.max=XI(t.max,e,r,n,s)}function _4(t,{x:e,y:r}){DT(t.x,e.translate,e.scale,e.originPoint),DT(t.y,r.translate,r.scale,r.originPoint)}const YI=.999999999999,QI=1.0000000000001;function XW(t,e,r,n=!1){const s=r.length;if(!s)return;e.x=e.y=1;let c,l;for(let a=0;a<s;a++){c=r[a],l=c.projectionDelta;const{visualElement:m}=c.options;m&&m.props.style&&m.props.style.display==="contents"||(n&&c.options.layoutScroll&&c.scroll&&c!==c.root&&_p(t,{x:-c.scroll.offset.x,y:-c.scroll.offset.y}),l&&(e.x*=l.x.scale,e.y*=l.y.scale,_4(t,l)),n&&Bh(c.latestValues)&&_p(t,c.latestValues))}e.x<QI&&e.x>YI&&(e.x=1),e.y<QI&&e.y>YI&&(e.y=1)}function yp(t,e){t.min=t.min+e,t.max=t.max+e}function JI(t,e,r,n,s=.5){const c=Rn(t.min,t.max,s);DT(t,e,r,c,n)}function _p(t,e){JI(t.x,e.x,e.scaleX,e.scale,e.originX),JI(t.y,e.y,e.scaleY,e.scale,e.originY)}function v4(t,e){return g4(KW(t.getBoundingClientRect(),e))}function YW(t,e,r){const n=v4(t,r),{scroll:s}=e;return s&&(yp(n.x,s.offset.x),yp(n.y,s.offset.y)),n}const eR=()=>({translate:0,scale:1,origin:0,originPoint:0}),vp=()=>({x:eR(),y:eR()}),tR=()=>({min:0,max:0}),Qn=()=>({x:tR(),y:tR()}),LT={current:null},x4={current:!1};function QW(){if(x4.current=!0,!!YC)if(window.matchMedia){const t=window.matchMedia("(prefers-reduced-motion)"),e=()=>LT.current=t.matches;t.addEventListener("change",e),e()}else LT.current=!1}const JW=new WeakMap;function eq(t,e,r){for(const n in e){const s=e[n],c=r[n];if(ds(s))t.addValue(n,s);else if(ds(c))t.addValue(n,em(s,{owner:t}));else if(c!==s)if(t.hasValue(n)){const l=t.getValue(n);l.liveStyle===!0?l.jump(s):l.hasAnimated||l.set(s)}else{const l=t.getStaticValue(n);t.addValue(n,em(l!==void 0?l:s,{owner:t}))}}for(const n in r)e[n]===void 0&&t.removeValue(n);return e}const rR=["AnimationStart","AnimationComplete","Update","BeforeLayoutMeasure","LayoutMeasure","LayoutAnimationStart","LayoutAnimationComplete"];class tq{scrapeMotionValuesFromProps(e,r,n){return{}}constructor({parent:e,props:r,presenceContext:n,reducedMotionConfig:s,blockInitialAnimation:c,visualState:l},a={}){this.current=null,this.children=new Set,this.isVariantNode=!1,this.isControllingVariants=!1,this.shouldReduceMotion=null,this.values=new Map,this.KeyframeResolver=mP,this.features={},this.valueSubscriptions=new Map,this.prevMotionValues={},this.events={},this.propEventSubscriptions={},this.notifyUpdate=()=>this.notify("Update",this.latestValues),this.render=()=>{this.current&&(this.triggerBuild(),this.renderInstance(this.current,this.renderState,this.props.style,this.projection))},this.renderScheduledAt=0,this.scheduleRender=()=>{const P=Hs.now();this.renderScheduledAt<P&&(this.renderScheduledAt=P,wn.render(this.render,!1,!0))};const{latestValues:m,renderState:y}=l;this.latestValues=m,this.baseTarget={...m},this.initialValues=r.initial?{...m}:{},this.renderState=y,this.parent=e,this.props=r,this.presenceContext=n,this.depth=e?e.depth+1:0,this.reducedMotionConfig=s,this.options=a,this.blockInitialAnimation=!!c,this.isControllingVariants=n1(r),this.isVariantNode=s4(r),this.isVariantNode&&(this.variantChildren=new Set),this.manuallyAnimateOnMount=!!(e&&e.current);const{willChange:v,...T}=this.scrapeMotionValuesFromProps(r,{},this);for(const P in T){const A=T[P];m[P]!==void 0&&ds(A)&&A.set(m[P])}}mount(e){var r;this.current=e,JW.set(e,this),this.projection&&!this.projection.instance&&this.projection.mount(e),this.parent&&this.isVariantNode&&!this.isControllingVariants&&(this.removeFromVariantTree=this.parent.addVariantChild(this)),this.values.forEach((n,s)=>this.bindToMotionValue(s,n)),x4.current||QW(),this.shouldReduceMotion=this.reducedMotionConfig==="never"?!1:this.reducedMotionConfig==="always"?!0:LT.current,(r=this.parent)==null||r.addChild(this),this.update(this.props,this.presenceContext)}unmount(){var e;this.projection&&this.projection.unmount(),Au(this.notifyUpdate),Au(this.render),this.valueSubscriptions.forEach(r=>r()),this.valueSubscriptions.clear(),this.removeFromVariantTree&&this.removeFromVariantTree(),(e=this.parent)==null||e.removeChild(this);for(const r in this.events)this.events[r].clear();for(const r in this.features){const n=this.features[r];n&&(n.unmount(),n.isMounted=!1)}this.current=null}addChild(e){this.children.add(e),this.enteringChildren??(this.enteringChildren=new Set),this.enteringChildren.add(e)}removeChild(e){this.children.delete(e),this.enteringChildren&&this.enteringChildren.delete(e)}bindToMotionValue(e,r){this.valueSubscriptions.has(e)&&this.valueSubscriptions.get(e)();const n=vm.has(e);n&&this.onBindTransform&&this.onBindTransform();const s=r.on("change",l=>{this.latestValues[e]=l,this.props.onUpdate&&wn.preRender(this.notifyUpdate),n&&this.projection&&(this.projection.isTransformDirty=!0),this.scheduleRender()});let c;window.MotionCheckAppearSync&&(c=window.MotionCheckAppearSync(this,e,r)),this.valueSubscriptions.set(e,()=>{s(),c&&c(),r.owner&&r.stop()})}sortNodePosition(e){return!this.current||!this.sortInstanceNodePosition||this.type!==e.type?0:this.sortInstanceNodePosition(this.current,e.current)}updateFeatures(){let e="animation";for(e in tm){const r=tm[e];if(!r)continue;const{isEnabled:n,Feature:s}=r;if(!this.features[e]&&s&&n(this.props)&&(this.features[e]=new s(this)),this.features[e]){const c=this.features[e];c.isMounted?c.update():(c.mount(),c.isMounted=!0)}}}triggerBuild(){this.build(this.renderState,this.latestValues,this.props)}measureViewportBox(){return this.current?this.measureInstanceViewportBox(this.current,this.props):Qn()}getStaticValue(e){return this.latestValues[e]}setStaticValue(e,r){this.latestValues[e]=r}update(e,r){(e.transformTemplate||this.props.transformTemplate)&&this.scheduleRender(),this.prevProps=this.props,this.props=e,this.prevPresenceContext=this.presenceContext,this.presenceContext=r;for(let n=0;n<rR.length;n++){const s=rR[n];this.propEventSubscriptions[s]&&(this.propEventSubscriptions[s](),delete this.propEventSubscriptions[s]);const c="on"+s,l=e[c];l&&(this.propEventSubscriptions[s]=this.on(s,l))}this.prevMotionValues=eq(this,this.scrapeMotionValuesFromProps(e,this.prevProps,this),this.prevMotionValues),this.handleChildMotionValue&&this.handleChildMotionValue()}getProps(){return this.props}getVariant(e){return this.props.variants?this.props.variants[e]:void 0}getDefaultTransition(){return this.props.transition}getTransformPagePoint(){return this.props.transformPagePoint}getClosestVariantNode(){return this.isVariantNode?this:this.parent?this.parent.getClosestVariantNode():void 0}addVariantChild(e){const r=this.getClosestVariantNode();if(r)return r.variantChildren&&r.variantChildren.add(e),()=>r.variantChildren.delete(e)}addValue(e,r){const n=this.values.get(e);r!==n&&(n&&this.removeValue(e),this.bindToMotionValue(e,r),this.values.set(e,r),this.latestValues[e]=r.get())}removeValue(e){this.values.delete(e);const r=this.valueSubscriptions.get(e);r&&(r(),this.valueSubscriptions.delete(e)),delete this.latestValues[e],this.removeValueFromRenderState(e,this.renderState)}hasValue(e){return this.values.has(e)}getValue(e,r){if(this.props.values&&this.props.values[e])return this.props.values[e];let n=this.values.get(e);return n===void 0&&r!==void 0&&(n=em(r===null?void 0:r,{owner:this}),this.addValue(e,n)),n}readValue(e,r){let n=this.latestValues[e]!==void 0||!this.current?this.latestValues[e]:this.getBaseTargetFromProps(this.props,e)??this.readValueFromInstance(this.current,e,this.options);return n!=null&&(typeof n=="string"&&(d5(n)||p5(n))?n=parseFloat(n):!pW(n)&&ku.test(r)&&(n=K5(e,r)),this.setBaseTarget(e,ds(n)?n.get():n)),ds(n)?n.get():n}setBaseTarget(e,r){this.baseTarget[e]=r}getBaseTarget(e){var c;const{initial:r}=this.props;let n;if(typeof r=="string"||typeof r=="object"){const l=EP(this.props,r,(c=this.presenceContext)==null?void 0:c.custom);l&&(n=l[e])}if(r&&n!==void 0)return n;const s=this.getBaseTargetFromProps(this.props,e);return s!==void 0&&!ds(s)?s:this.initialValues[e]!==void 0&&n===void 0?void 0:this.baseTarget[e]}on(e,r){return this.events[e]||(this.events[e]=new nP),this.events[e].add(r)}notify(e,...r){this.events[e]&&this.events[e].notify(...r)}scheduleRenderMicrotask(){_P.render(this.render)}}class b4 extends tq{constructor(){super(...arguments),this.KeyframeResolver=rW}sortInstanceNodePosition(e,r){return e.compareDocumentPosition(r)&2?1:-1}getBaseTargetFromProps(e,r){return e.style?e.style[r]:void 0}removeValueFromRenderState(e,{vars:r,style:n}){delete r[e],delete n[e]}handleChildMotionValue(){this.childSubscription&&(this.childSubscription(),delete this.childSubscription);const{children:e}=this.props;ds(e)&&(this.childSubscription=e.on("change",r=>{this.current&&(this.current.textContent=`${r}`)}))}}function w4(t,{style:e,vars:r},n,s){const c=t.style;let l;for(l in e)c[l]=e[l];s==null||s.applyProjectionStyles(c,n);for(l in r)c.setProperty(l,r[l])}function rq(t){return window.getComputedStyle(t)}class nq extends b4{constructor(){super(...arguments),this.type="html",this.renderInstance=w4}readValueFromInstance(e,r){var n;if(vm.has(r))return(n=this.projection)!=null&&n.isProjecting?ET(r):bG(e,r);{const s=rq(e),c=(oP(r)?s.getPropertyValue(r):s[r])||0;return typeof c=="string"?c.trim():c}}measureInstanceViewportBox(e,{transformPagePoint:r}){return v4(e,r)}build(e,r,n){wP(e,r,n.transformTemplate)}scrapeMotionValuesFromProps(e,r,n){return CP(e,r,n)}}const S4=new Set(["baseFrequency","diffuseConstant","kernelMatrix","kernelUnitLength","keySplines","keyTimes","limitingConeAngle","markerHeight","markerWidth","numOctaves","targetX","targetY","surfaceScale","specularConstant","specularExponent","stdDeviation","tableValues","viewBox","gradientTransform","pathLength","startOffset","textLength","lengthAdjust"]);function iq(t,e,r,n){w4(t,e,void 0,n);for(const s in e.attrs)t.setAttribute(S4.has(s)?s:PP(s),e.attrs[s])}class sq extends b4{constructor(){super(...arguments),this.type="svg",this.isSVGTag=!1,this.measureInstanceViewportBox=Qn}getBaseTargetFromProps(e,r){return e[r]}readValueFromInstance(e,r){if(vm.has(r)){const n=Z5(r);return n&&n.default||0}return r=S4.has(r)?r:PP(r),e.getAttribute(r)}scrapeMotionValuesFromProps(e,r,n){return d4(e,r,n)}build(e,r,n){l4(e,r,this.isSVGTag,n.transformTemplate,n.style)}renderInstance(e,r,n,s){iq(e,r,n,s)}mount(e){this.isSVGTag=u4(e.tagName),super.mount(e)}}const oq=(t,e)=>TP(t)?new sq(e):new nq(e,{allowProjection:t!==X.Fragment});function Ap(t,e,r){const n=t.getProps();return EP(n,e,r!==void 0?r:n.custom,t)}const OT=t=>Array.isArray(t);function aq(t,e,r){t.hasValue(e)?t.getValue(e).set(r):t.addValue(e,em(r))}function lq(t){return OT(t)?t[t.length-1]||0:t}function cq(t,e){const r=Ap(t,e);let{transitionEnd:n={},transition:s={},...c}=r||{};c={...c,...n};for(const l in c){const a=lq(c[l]);aq(t,l,a)}}function uq(t){return!!(ds(t)&&t.add)}function zT(t,e){const r=t.getValue("willChange");if(uq(r))return r.add(e);if(!r&&nc.WillChange){const n=new nc.WillChange("auto");t.addValue("willChange",n),n.add(e)}}function T4(t){return t.props[f4]}const hq=t=>t!==null;function dq(t,{repeat:e,repeatType:r="loop"},n){const s=t.filter(hq),c=e&&r!=="loop"&&e%2===1?0:s.length-1;return s[c]}const fq={type:"spring",stiffness:500,damping:25,restSpeed:10},pq=t=>({type:"spring",stiffness:550,damping:t===0?2*Math.sqrt(550):30,restSpeed:10}),mq={type:"keyframes",duration:.8},gq={type:"keyframes",ease:[.25,.1,.35,1],duration:.3},yq=(t,{keyframes:e})=>e.length>2?mq:vm.has(t)?t.startsWith("scale")?pq(e[1]):fq:gq;function _q({when:t,delay:e,delayChildren:r,staggerChildren:n,staggerDirection:s,repeat:c,repeatType:l,repeatDelay:a,from:m,elapsed:y,...v}){return!!Object.keys(v).length}const AP=(t,e,r,n={},s,c)=>l=>{const a=gP(n,t)||{},m=a.delay||n.delay||0;let{elapsed:y=0}=n;y=y-fl(m);const v={keyframes:Array.isArray(r)?r:[null,r],ease:"easeOut",velocity:e.getVelocity(),...a,delay:-y,onUpdate:P=>{e.set(P),a.onUpdate&&a.onUpdate(P)},onComplete:()=>{l(),a.onComplete&&a.onComplete()},name:t,motionValue:e,element:c?void 0:s};_q(a)||Object.assign(v,yq(t,v)),v.duration&&(v.duration=fl(v.duration)),v.repeatDelay&&(v.repeatDelay=fl(v.repeatDelay)),v.from!==void 0&&(v.keyframes[0]=v.from);let T=!1;if((v.type===!1||v.duration===0&&!v.repeatDelay)&&(MT(v),v.delay===0&&(T=!0)),(nc.instantAnimations||nc.skipAnimations)&&(T=!0,MT(v),v.delay=0),v.allowFlatten=!a.type&&!a.ease,T&&!c&&e.get()!==void 0){const P=dq(v.keyframes,a);if(P!==void 0){wn.update(()=>{v.onUpdate(P),v.onComplete()});return}}return a.isSync?new pP(v):new GG(v)};function vq({protectedKeys:t,needsAnimating:e},r){const n=t.hasOwnProperty(r)&&e[r]!==!0;return e[r]=!1,n}function E4(t,e,{delay:r=0,transitionOverride:n,type:s}={}){let{transition:c=t.getDefaultTransition(),transitionEnd:l,...a}=e;n&&(c=n);const m=[],y=s&&t.animationState&&t.animationState.getState()[s];for(const v in a){const T=t.getValue(v,t.latestValues[v]??null),P=a[v];if(P===void 0||y&&vq(y,v))continue;const A={delay:r,...gP(c||{},v)},O=T.get();if(O!==void 0&&!T.isAnimating&&!Array.isArray(P)&&P===O&&!A.velocity)continue;let I=!1;if(window.MotionHandoffAnimation){const R=T4(t);if(R){const z=window.MotionHandoffAnimation(R,v,wn);z!==null&&(A.startTime=z,I=!0)}}zT(t,v),T.start(AP(v,T,P,t.shouldReduceMotion&&W5.has(v)?{type:!1}:A,t,I));const L=T.animation;L&&m.push(L)}return l&&Promise.all(m).then(()=>{wn.update(()=>{l&&cq(t,l)})}),m}function C4(t,e,r,n=0,s=1){const c=Array.from(t).sort((y,v)=>y.sortNodePosition(v)).indexOf(e),l=t.size,a=(l-1)*n;return typeof r=="function"?r(c,l):s===1?c*n:a-c*n}function NT(t,e,r={}){var m;const n=Ap(t,e,r.type==="exit"?(m=t.presenceContext)==null?void 0:m.custom:void 0);let{transition:s=t.getDefaultTransition()||{}}=n||{};r.transitionOverride&&(s=r.transitionOverride);const c=n?()=>Promise.all(E4(t,n,r)):()=>Promise.resolve(),l=t.variantChildren&&t.variantChildren.size?(y=0)=>{const{delayChildren:v=0,staggerChildren:T,staggerDirection:P}=s;return xq(t,e,y,v,T,P,r)}:()=>Promise.resolve(),{when:a}=s;if(a){const[y,v]=a==="beforeChildren"?[c,l]:[l,c];return y().then(()=>v())}else return Promise.all([c(),l(r.delay)])}function xq(t,e,r=0,n=0,s=0,c=1,l){const a=[];for(const m of t.variantChildren)m.notify("AnimationStart",e),a.push(NT(m,e,{...l,delay:r+(typeof n=="function"?0:n)+C4(t.variantChildren,m,n,s,c)}).then(()=>m.notify("AnimationComplete",e)));return Promise.all(a)}function bq(t,e,r={}){t.notify("AnimationStart",e);let n;if(Array.isArray(e)){const s=e.map(c=>NT(t,c,r));n=Promise.all(s)}else if(typeof e=="string")n=NT(t,e,r);else{const s=typeof e=="function"?Ap(t,e,r.custom):e;n=Promise.all(E4(t,s,r))}return n.then(()=>{t.notify("AnimationComplete",e)})}function P4(t,e){if(!Array.isArray(e))return!1;const r=e.length;if(r!==t.length)return!1;for(let n=0;n<r;n++)if(e[n]!==t[n])return!1;return!0}const wq=bP.length;function A4(t){if(!t)return;if(!t.isControllingVariants){const r=t.parent?A4(t.parent)||{}:{};return t.props.initial!==void 0&&(r.initial=t.props.initial),r}const e={};for(let r=0;r<wq;r++){const n=bP[r],s=t.props[n];(l0(s)||s===!1)&&(e[n]=s)}return e}const Sq=[...xP].reverse(),Tq=xP.length;function Eq(t){return e=>Promise.all(e.map(({animation:r,options:n})=>bq(t,r,n)))}function Cq(t){let e=Eq(t),r=nR(),n=!0;const s=m=>(y,v)=>{var P;const T=Ap(t,v,m==="exit"?(P=t.presenceContext)==null?void 0:P.custom:void 0);if(T){const{transition:A,transitionEnd:O,...I}=T;y={...y,...I,...O}}return y};function c(m){e=m(t)}function l(m){const{props:y}=t,v=A4(t.parent)||{},T=[],P=new Set;let A={},O=1/0;for(let L=0;L<Tq;L++){const R=Sq[L],z=r[R],j=y[R]!==void 0?y[R]:v[R],W=l0(j),Z=R===m?z.isActive:null;Z===!1&&(O=L);let te=j===v[R]&&j!==y[R]&&W;if(te&&n&&t.manuallyAnimateOnMount&&(te=!1),z.protectedKeys={...A},!z.isActive&&Z===null||!j&&!z.prevProp||r1(j)||typeof j=="boolean")continue;const ie=Pq(z.prevProp,j);let V=ie||R===m&&z.isActive&&!te&&W||L>O&&W,q=!1;const Q=Array.isArray(j)?j:[j];let ce=Q.reduce(s(R),{});Z===!1&&(ce={});const{prevResolvedValues:se={}}=z,ue={...se,...ce},he=Se=>{V=!0,P.has(Se)&&(q=!0,P.delete(Se)),z.needsAnimating[Se]=!0;const fe=t.getValue(Se);fe&&(fe.liveStyle=!1)};for(const Se in ue){const fe=ce[Se],ve=se[Se];if(A.hasOwnProperty(Se))continue;let Re=!1;OT(fe)&&OT(ve)?Re=!P4(fe,ve):Re=fe!==ve,Re?fe!=null?he(Se):P.add(Se):fe!==void 0&&P.has(Se)?he(Se):z.protectedKeys[Se]=!0}z.prevProp=j,z.prevResolvedValues=ce,z.isActive&&(A={...A,...ce}),n&&t.blockInitialAnimation&&(V=!1);const ye=te&&ie;V&&(!ye||q)&&T.push(...Q.map(Se=>{const fe={type:R};if(typeof Se=="string"&&n&&!ye&&t.manuallyAnimateOnMount&&t.parent){const{parent:ve}=t,Re=Ap(ve,Se);if(ve.enteringChildren&&Re){const{delayChildren:$e}=Re.transition||{};fe.delay=C4(ve.enteringChildren,t,$e)}}return{animation:Se,options:fe}}))}if(P.size){const L={};if(typeof y.initial!="boolean"){const R=Ap(t,Array.isArray(y.initial)?y.initial[0]:y.initial);R&&R.transition&&(L.transition=R.transition)}P.forEach(R=>{const z=t.getBaseTarget(R),j=t.getValue(R);j&&(j.liveStyle=!0),L[R]=z??null}),T.push({animation:L})}let I=!!T.length;return n&&(y.initial===!1||y.initial===y.animate)&&!t.manuallyAnimateOnMount&&(I=!1),n=!1,I?e(T):Promise.resolve()}function a(m,y){var T;if(r[m].isActive===y)return Promise.resolve();(T=t.variantChildren)==null||T.forEach(P=>{var A;return(A=P.animationState)==null?void 0:A.setActive(m,y)}),r[m].isActive=y;const v=l(m);for(const P in r)r[P].protectedKeys={};return v}return{animateChanges:l,setActive:a,setAnimateFunction:c,getState:()=>r,reset:()=>{r=nR()}}}function Pq(t,e){return typeof e=="string"?e!==t:Array.isArray(e)?!P4(e,t):!1}function Ih(t=!1){return{isActive:t,protectedKeys:{},needsAnimating:{},prevResolvedValues:{}}}function nR(){return{animate:Ih(!0),whileInView:Ih(),whileHover:Ih(),whileTap:Ih(),whileDrag:Ih(),whileFocus:Ih(),exit:Ih()}}class Fu{constructor(e){this.isMounted=!1,this.node=e}update(){}}class Aq extends Fu{constructor(e){super(e),e.animationState||(e.animationState=Cq(e))}updateAnimationControlsSubscription(){const{animate:e}=this.node.getProps();r1(e)&&(this.unmountControls=e.subscribe(this.node))}mount(){this.updateAnimationControlsSubscription()}update(){const{animate:e}=this.node.getProps(),{animate:r}=this.node.prevProps||{};e!==r&&this.updateAnimationControlsSubscription()}unmount(){var e;this.node.animationState.reset(),(e=this.unmountControls)==null||e.call(this)}}let kq=0;class Mq extends Fu{constructor(){super(...arguments),this.id=kq++}update(){if(!this.node.presenceContext)return;const{isPresent:e,onExitComplete:r}=this.node.presenceContext,{isPresent:n}=this.node.prevPresenceContext||{};if(!this.node.animationState||e===n)return;const s=this.node.animationState.setActive("exit",!e);r&&!e&&s.then(()=>{r(this.id)})}mount(){const{register:e,onExitComplete:r}=this.node.presenceContext||{};r&&r(this.id),e&&(this.unmount=e(this.id))}unmount(){}}const Iq={animation:{Feature:Aq},exit:{Feature:Mq}};function u0(t,e,r,n={passive:!0}){return t.addEventListener(e,r,n),()=>t.removeEventListener(e,r)}function W0(t){return{point:{x:t.pageX,y:t.pageY}}}const Rq=t=>e=>vP(e)&&t(e,W0(e));function Ey(t,e,r,n){return u0(t,e,Rq(r),n)}const k4=1e-4,Dq=1-k4,Lq=1+k4,M4=.01,Oq=0-M4,zq=0+M4;function ks(t){return t.max-t.min}function Nq(t,e,r){return Math.abs(t-e)<=r}function iR(t,e,r,n=.5){t.origin=n,t.originPoint=Rn(e.min,e.max,t.origin),t.scale=ks(r)/ks(e),t.translate=Rn(r.min,r.max,t.origin)-t.originPoint,(t.scale>=Dq&&t.scale<=Lq||isNaN(t.scale))&&(t.scale=1),(t.translate>=Oq&&t.translate<=zq||isNaN(t.translate))&&(t.translate=0)}function Cy(t,e,r,n){iR(t.x,e.x,r.x,n?n.originX:void 0),iR(t.y,e.y,r.y,n?n.originY:void 0)}function sR(t,e,r){t.min=r.min+e.min,t.max=t.min+ks(e)}function jq(t,e,r){sR(t.x,e.x,r.x),sR(t.y,e.y,r.y)}function oR(t,e,r){t.min=e.min-r.min,t.max=t.min+ks(e)}function Py(t,e,r){oR(t.x,e.x,r.x),oR(t.y,e.y,r.y)}function Vo(t){return[t("x"),t("y")]}const I4=({current:t})=>t?t.ownerDocument.defaultView:null,aR=(t,e)=>Math.abs(t-e);function Fq(t,e){const r=aR(t.x,e.x),n=aR(t.y,e.y);return Math.sqrt(r**2+n**2)}class R4{constructor(e,r,{transformPagePoint:n,contextWindow:s=window,dragSnapToOrigin:c=!1,distanceThreshold:l=3}={}){if(this.startEvent=null,this.lastMoveEvent=null,this.lastMoveEventInfo=null,this.handlers={},this.contextWindow=window,this.updatePoint=()=>{if(!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const P=k2(this.lastMoveEventInfo,this.history),A=this.startEvent!==null,O=Fq(P.offset,{x:0,y:0})>=this.distanceThreshold;if(!A&&!O)return;const{point:I}=P,{timestamp:L}=Yi;this.history.push({...I,timestamp:L});const{onStart:R,onMove:z}=this.handlers;A||(R&&R(this.lastMoveEvent,P),this.startEvent=this.lastMoveEvent),z&&z(this.lastMoveEvent,P)},this.handlePointerMove=(P,A)=>{this.lastMoveEvent=P,this.lastMoveEventInfo=A2(A,this.transformPagePoint),wn.update(this.updatePoint,!0)},this.handlePointerUp=(P,A)=>{this.end();const{onEnd:O,onSessionEnd:I,resumeAnimation:L}=this.handlers;if(this.dragSnapToOrigin&&L&&L(),!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const R=k2(P.type==="pointercancel"?this.lastMoveEventInfo:A2(A,this.transformPagePoint),this.history);this.startEvent&&O&&O(P,R),I&&I(P,R)},!vP(e))return;this.dragSnapToOrigin=c,this.handlers=r,this.transformPagePoint=n,this.distanceThreshold=l,this.contextWindow=s||window;const a=W0(e),m=A2(a,this.transformPagePoint),{point:y}=m,{timestamp:v}=Yi;this.history=[{...y,timestamp:v}];const{onSessionStart:T}=r;T&&T(e,k2(m,this.history)),this.removeListeners=V0(Ey(this.contextWindow,"pointermove",this.handlePointerMove),Ey(this.contextWindow,"pointerup",this.handlePointerUp),Ey(this.contextWindow,"pointercancel",this.handlePointerUp))}updateHandlers(e){this.handlers=e}end(){this.removeListeners&&this.removeListeners(),Au(this.updatePoint)}}function A2(t,e){return e?{point:e(t.point)}:t}function lR(t,e){return{x:t.x-e.x,y:t.y-e.y}}function k2({point:t},e){return{point:t,delta:lR(t,D4(e)),offset:lR(t,Bq(e)),velocity:$q(e,.1)}}function Bq(t){return t[0]}function D4(t){return t[t.length-1]}function $q(t,e){if(t.length<2)return{x:0,y:0};let r=t.length-1,n=null;const s=D4(t);for(;r>=0&&(n=t[r],!(s.timestamp-n.timestamp>fl(e)));)r--;if(!n)return{x:0,y:0};const c=Zo(s.timestamp-n.timestamp);if(c===0)return{x:0,y:0};const l={x:(s.x-n.x)/c,y:(s.y-n.y)/c};return l.x===1/0&&(l.x=0),l.y===1/0&&(l.y=0),l}function Vq(t,{min:e,max:r},n){return e!==void 0&&t<e?t=n?Rn(e,t,n.min):Math.max(t,e):r!==void 0&&t>r&&(t=n?Rn(r,t,n.max):Math.min(t,r)),t}function cR(t,e,r){return{min:e!==void 0?t.min+e:void 0,max:r!==void 0?t.max+r-(t.max-t.min):void 0}}function Uq(t,{top:e,left:r,bottom:n,right:s}){return{x:cR(t.x,r,s),y:cR(t.y,e,n)}}function uR(t,e){let r=e.min-t.min,n=e.max-t.max;return e.max-e.min<t.max-t.min&&([r,n]=[n,r]),{min:r,max:n}}function Gq(t,e){return{x:uR(t.x,e.x),y:uR(t.y,e.y)}}function Wq(t,e){let r=.5;const n=ks(t),s=ks(e);return s>n?r=s0(e.min,e.max-n,t.min):n>s&&(r=s0(t.min,t.max-s,e.min)),rc(0,1,r)}function qq(t,e){const r={};return e.min!==void 0&&(r.min=e.min-t.min),e.max!==void 0&&(r.max=e.max-t.min),r}const jT=.35;function Hq(t=jT){return t===!1?t=0:t===!0&&(t=jT),{x:hR(t,"left","right"),y:hR(t,"top","bottom")}}function hR(t,e,r){return{min:dR(t,e),max:dR(t,r)}}function dR(t,e){return typeof t=="number"?t:t[e]||0}const Zq=new WeakMap;class Kq{constructor(e){this.openDragLock=null,this.isDragging=!1,this.currentDirection=null,this.originPoint={x:0,y:0},this.constraints=!1,this.hasMutatedConstraints=!1,this.elastic=Qn(),this.latestPointerEvent=null,this.latestPanInfo=null,this.visualElement=e}start(e,{snapToCursor:r=!1,distanceThreshold:n}={}){const{presenceContext:s}=this.visualElement;if(s&&s.isPresent===!1)return;const c=T=>{const{dragSnapToOrigin:P}=this.getProps();P?this.pauseAnimation():this.stopAnimation(),r&&this.snapToCursor(W0(T).point)},l=(T,P)=>{const{drag:A,dragPropagation:O,onDragStart:I}=this.getProps();if(A&&!O&&(this.openDragLock&&this.openDragLock(),this.openDragLock=oW(A),!this.openDragLock))return;this.latestPointerEvent=T,this.latestPanInfo=P,this.isDragging=!0,this.currentDirection=null,this.resolveConstraints(),this.visualElement.projection&&(this.visualElement.projection.isAnimationBlocked=!0,this.visualElement.projection.target=void 0),Vo(R=>{let z=this.getAxisMotionValue(R).get()||0;if(pl.test(z)){const{projection:j}=this.visualElement;if(j&&j.layout){const W=j.layout.layoutBox[R];W&&(z=ks(W)*(parseFloat(z)/100))}}this.originPoint[R]=z}),I&&wn.postRender(()=>I(T,P)),zT(this.visualElement,"transform");const{animationState:L}=this.visualElement;L&&L.setActive("whileDrag",!0)},a=(T,P)=>{this.latestPointerEvent=T,this.latestPanInfo=P;const{dragPropagation:A,dragDirectionLock:O,onDirectionLock:I,onDrag:L}=this.getProps();if(!A&&!this.openDragLock)return;const{offset:R}=P;if(O&&this.currentDirection===null){this.currentDirection=Xq(R),this.currentDirection!==null&&I&&I(this.currentDirection);return}this.updateAxis("x",P.point,R),this.updateAxis("y",P.point,R),this.visualElement.render(),L&&L(T,P)},m=(T,P)=>{this.latestPointerEvent=T,this.latestPanInfo=P,this.stop(T,P),this.latestPointerEvent=null,this.latestPanInfo=null},y=()=>Vo(T=>{var P;return this.getAnimationState(T)==="paused"&&((P=this.getAxisMotionValue(T).animation)==null?void 0:P.play())}),{dragSnapToOrigin:v}=this.getProps();this.panSession=new R4(e,{onSessionStart:c,onStart:l,onMove:a,onSessionEnd:m,resumeAnimation:y},{transformPagePoint:this.visualElement.getTransformPagePoint(),dragSnapToOrigin:v,distanceThreshold:n,contextWindow:I4(this.visualElement)})}stop(e,r){const n=e||this.latestPointerEvent,s=r||this.latestPanInfo,c=this.isDragging;if(this.cancel(),!c||!s||!n)return;const{velocity:l}=s;this.startAnimation(l);const{onDragEnd:a}=this.getProps();a&&wn.postRender(()=>a(n,s))}cancel(){this.isDragging=!1;const{projection:e,animationState:r}=this.visualElement;e&&(e.isAnimationBlocked=!1),this.panSession&&this.panSession.end(),this.panSession=void 0;const{dragPropagation:n}=this.getProps();!n&&this.openDragLock&&(this.openDragLock(),this.openDragLock=null),r&&r.setActive("whileDrag",!1)}updateAxis(e,r,n){const{drag:s}=this.getProps();if(!n||!zv(e,s,this.currentDirection))return;const c=this.getAxisMotionValue(e);let l=this.originPoint[e]+n[e];this.constraints&&this.constraints[e]&&(l=Vq(l,this.constraints[e],this.elastic[e])),c.set(l)}resolveConstraints(){var c;const{dragConstraints:e,dragElastic:r}=this.getProps(),n=this.visualElement.projection&&!this.visualElement.projection.layout?this.visualElement.projection.measure(!1):(c=this.visualElement.projection)==null?void 0:c.layout,s=this.constraints;e&&gp(e)?this.constraints||(this.constraints=this.resolveRefConstraints()):e&&n?this.constraints=Uq(n.layoutBox,e):this.constraints=!1,this.elastic=Hq(r),s!==this.constraints&&n&&this.constraints&&!this.hasMutatedConstraints&&Vo(l=>{this.constraints!==!1&&this.getAxisMotionValue(l)&&(this.constraints[l]=qq(n.layoutBox[l],this.constraints[l]))})}resolveRefConstraints(){const{dragConstraints:e,onMeasureDragConstraints:r}=this.getProps();if(!e||!gp(e))return!1;const n=e.current,{projection:s}=this.visualElement;if(!s||!s.layout)return!1;const c=YW(n,s.root,this.visualElement.getTransformPagePoint());let l=Gq(s.layout.layoutBox,c);if(r){const a=r(ZW(l));this.hasMutatedConstraints=!!a,a&&(l=g4(a))}return l}startAnimation(e){const{drag:r,dragMomentum:n,dragElastic:s,dragTransition:c,dragSnapToOrigin:l,onDragTransitionEnd:a}=this.getProps(),m=this.constraints||{},y=Vo(v=>{if(!zv(v,r,this.currentDirection))return;let T=m&&m[v]||{};l&&(T={min:0,max:0});const P=s?200:1e6,A=s?40:1e7,O={type:"inertia",velocity:n?e[v]:0,bounceStiffness:P,bounceDamping:A,timeConstant:750,restDelta:1,restSpeed:10,...c,...T};return this.startAxisValueAnimation(v,O)});return Promise.all(y).then(a)}startAxisValueAnimation(e,r){const n=this.getAxisMotionValue(e);return zT(this.visualElement,e),n.start(AP(e,n,0,r,this.visualElement,!1))}stopAnimation(){Vo(e=>this.getAxisMotionValue(e).stop())}pauseAnimation(){Vo(e=>{var r;return(r=this.getAxisMotionValue(e).animation)==null?void 0:r.pause()})}getAnimationState(e){var r;return(r=this.getAxisMotionValue(e).animation)==null?void 0:r.state}getAxisMotionValue(e){const r=`_drag${e.toUpperCase()}`,n=this.visualElement.getProps(),s=n[r];return s||this.visualElement.getValue(e,(n.initial?n.initial[e]:void 0)||0)}snapToCursor(e){Vo(r=>{const{drag:n}=this.getProps();if(!zv(r,n,this.currentDirection))return;const{projection:s}=this.visualElement,c=this.getAxisMotionValue(r);if(s&&s.layout){const{min:l,max:a}=s.layout.layoutBox[r];c.set(e[r]-Rn(l,a,.5))}})}scalePositionWithinConstraints(){if(!this.visualElement.current)return;const{drag:e,dragConstraints:r}=this.getProps(),{projection:n}=this.visualElement;if(!gp(r)||!n||!this.constraints)return;this.stopAnimation();const s={x:0,y:0};Vo(l=>{const a=this.getAxisMotionValue(l);if(a&&this.constraints!==!1){const m=a.get();s[l]=Wq({min:m,max:m},this.constraints[l])}});const{transformTemplate:c}=this.visualElement.getProps();this.visualElement.current.style.transform=c?c({},""):"none",n.root&&n.root.updateScroll(),n.updateLayout(),this.resolveConstraints(),Vo(l=>{if(!zv(l,e,null))return;const a=this.getAxisMotionValue(l),{min:m,max:y}=this.constraints[l];a.set(Rn(m,y,s[l]))})}addListeners(){if(!this.visualElement.current)return;Zq.set(this.visualElement,this);const e=this.visualElement.current,r=Ey(e,"pointerdown",m=>{const{drag:y,dragListener:v=!0}=this.getProps();y&&v&&this.start(m)}),n=()=>{const{dragConstraints:m}=this.getProps();gp(m)&&m.current&&(this.constraints=this.resolveRefConstraints())},{projection:s}=this.visualElement,c=s.addEventListener("measure",n);s&&!s.layout&&(s.root&&s.root.updateScroll(),s.updateLayout()),wn.read(n);const l=u0(window,"resize",()=>this.scalePositionWithinConstraints()),a=s.addEventListener("didUpdate",({delta:m,hasLayoutChanged:y})=>{this.isDragging&&y&&(Vo(v=>{const T=this.getAxisMotionValue(v);T&&(this.originPoint[v]+=m[v].translate,T.set(T.get()+m[v].translate))}),this.visualElement.render())});return()=>{l(),r(),c(),a&&a()}}getProps(){const e=this.visualElement.getProps(),{drag:r=!1,dragDirectionLock:n=!1,dragPropagation:s=!1,dragConstraints:c=!1,dragElastic:l=jT,dragMomentum:a=!0}=e;return{...e,drag:r,dragDirectionLock:n,dragPropagation:s,dragConstraints:c,dragElastic:l,dragMomentum:a}}}function zv(t,e,r){return(e===!0||e===t)&&(r===null||r===t)}function Xq(t,e=10){let r=null;return Math.abs(t.y)>e?r="y":Math.abs(t.x)>e&&(r="x"),r}class Yq extends Fu{constructor(e){super(e),this.removeGroupControls=Jo,this.removeListeners=Jo,this.controls=new Kq(e)}mount(){const{dragControls:e}=this.node.getProps();e&&(this.removeGroupControls=e.subscribe(this.controls)),this.removeListeners=this.controls.addListeners()||Jo}unmount(){this.removeGroupControls(),this.removeListeners()}}const fR=t=>(e,r)=>{t&&wn.postRender(()=>t(e,r))};class Qq extends Fu{constructor(){super(...arguments),this.removePointerDownListener=Jo}onPointerDown(e){this.session=new R4(e,this.createPanHandlers(),{transformPagePoint:this.node.getTransformPagePoint(),contextWindow:I4(this.node)})}createPanHandlers(){const{onPanSessionStart:e,onPanStart:r,onPan:n,onPanEnd:s}=this.node.getProps();return{onSessionStart:fR(e),onStart:fR(r),onMove:n,onEnd:(c,l)=>{delete this.session,s&&wn.postRender(()=>s(c,l))}}}mount(){this.removePointerDownListener=Ey(this.node.current,"pointerdown",e=>this.onPointerDown(e))}update(){this.session&&this.session.updateHandlers(this.createPanHandlers())}unmount(){this.removePointerDownListener(),this.session&&this.session.end()}}const xx={hasAnimatedSinceResize:!0,hasEverUpdated:!1};function pR(t,e){return e.max===e.min?0:t/(e.max-e.min)*100}const Gg={correct:(t,e)=>{if(!e.target)return t;if(typeof t=="string")if(Xt.test(t))t=parseFloat(t);else return t;const r=pR(t,e.target.x),n=pR(t,e.target.y);return`${r}% ${n}%`}},Jq={correct:(t,{treeScale:e,projectionDelta:r})=>{const n=t,s=ku.parse(t);if(s.length>5)return n;const c=ku.createTransformer(t),l=typeof s[0]!="number"?1:0,a=r.x.scale*e.x,m=r.y.scale*e.y;s[0+l]/=a,s[1+l]/=m;const y=Rn(a,m,.5);return typeof s[2+l]=="number"&&(s[2+l]/=y),typeof s[3+l]=="number"&&(s[3+l]/=y),c(s)}};let M2=!1;class eH extends X.Component{componentDidMount(){const{visualElement:e,layoutGroup:r,switchLayoutGroup:n,layoutId:s}=this.props,{projection:c}=e;wW(tH),c&&(r.group&&r.group.add(c),n&&n.register&&s&&n.register(c),M2&&c.root.didUpdate(),c.addEventListener("animationComplete",()=>{this.safeToRemove()}),c.setOptions({...c.options,onExitComplete:()=>this.safeToRemove()})),xx.hasEverUpdated=!0}getSnapshotBeforeUpdate(e){const{layoutDependency:r,visualElement:n,drag:s,isPresent:c}=this.props,{projection:l}=n;return l&&(l.isPresent=c,M2=!0,s||e.layoutDependency!==r||r===void 0||e.isPresent!==c?l.willUpdate():this.safeToRemove(),e.isPresent!==c&&(c?l.promote():l.relegate()||wn.postRender(()=>{const a=l.getStack();(!a||!a.members.length)&&this.safeToRemove()}))),null}componentDidUpdate(){const{projection:e}=this.props.visualElement;e&&(e.root.didUpdate(),_P.postRender(()=>{!e.currentAnimation&&e.isLead()&&this.safeToRemove()}))}componentWillUnmount(){const{visualElement:e,layoutGroup:r,switchLayoutGroup:n}=this.props,{projection:s}=e;M2=!0,s&&(s.scheduleCheckAfterUnmount(),r&&r.group&&r.group.remove(s),n&&n.deregister&&n.deregister(s))}safeToRemove(){const{safeToRemove:e}=this.props;e&&e()}render(){return null}}function L4(t){const[e,r]=mW(),n=X.useContext(h5);return B.jsx(eH,{...t,layoutGroup:n,switchLayoutGroup:X.useContext(p4),isPresent:e,safeToRemove:r})}const tH={borderRadius:{...Gg,applyTo:["borderTopLeftRadius","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius"]},borderTopLeftRadius:Gg,borderTopRightRadius:Gg,borderBottomLeftRadius:Gg,borderBottomRightRadius:Gg,boxShadow:Jq};function rH(t,e,r){const n=ds(t)?t:em(t);return n.start(AP("",n,e,r)),n.animation}const nH=(t,e)=>t.depth-e.depth;class iH{constructor(){this.children=[],this.isDirty=!1}add(e){JC(this.children,e),this.isDirty=!0}remove(e){eP(this.children,e),this.isDirty=!0}forEach(e){this.isDirty&&this.children.sort(nH),this.isDirty=!1,this.children.forEach(e)}}function sH(t,e){const r=Hs.now(),n=({timestamp:s})=>{const c=s-r;c>=e&&(Au(n),t(c-e))};return wn.setup(n,!0),()=>Au(n)}const O4=["TopLeft","TopRight","BottomLeft","BottomRight"],oH=O4.length,mR=t=>typeof t=="string"?parseFloat(t):t,gR=t=>typeof t=="number"||Xt.test(t);function aH(t,e,r,n,s,c){s?(t.opacity=Rn(0,r.opacity??1,lH(n)),t.opacityExit=Rn(e.opacity??1,0,cH(n))):c&&(t.opacity=Rn(e.opacity??1,r.opacity??1,n));for(let l=0;l<oH;l++){const a=`border${O4[l]}Radius`;let m=yR(e,a),y=yR(r,a);if(m===void 0&&y===void 0)continue;m||(m=0),y||(y=0),m===0||y===0||gR(m)===gR(y)?(t[a]=Math.max(Rn(mR(m),mR(y),n),0),(pl.test(y)||pl.test(m))&&(t[a]+="%")):t[a]=y}(e.rotate||r.rotate)&&(t.rotate=Rn(e.rotate||0,r.rotate||0,n))}function yR(t,e){return t[e]!==void 0?t[e]:t.borderRadius}const lH=z4(0,.5,w5),cH=z4(.5,.95,Jo);function z4(t,e,r){return n=>n<t?0:n>e?1:r(s0(t,e,n))}function _R(t,e){t.min=e.min,t.max=e.max}function No(t,e){_R(t.x,e.x),_R(t.y,e.y)}function vR(t,e){t.translate=e.translate,t.scale=e.scale,t.originPoint=e.originPoint,t.origin=e.origin}function xR(t,e,r,n,s){return t-=e,t=ub(t,1/r,n),s!==void 0&&(t=ub(t,1/s,n)),t}function uH(t,e=0,r=1,n=.5,s,c=t,l=t){if(pl.test(e)&&(e=parseFloat(e),e=Rn(l.min,l.max,e/100)-l.min),typeof e!="number")return;let a=Rn(c.min,c.max,n);t===c&&(a-=e),t.min=xR(t.min,e,r,a,s),t.max=xR(t.max,e,r,a,s)}function bR(t,e,[r,n,s],c,l){uH(t,e[r],e[n],e[s],e.scale,c,l)}const hH=["x","scaleX","originX"],dH=["y","scaleY","originY"];function wR(t,e,r,n){bR(t.x,e,hH,r?r.x:void 0,n?n.x:void 0),bR(t.y,e,dH,r?r.y:void 0,n?n.y:void 0)}function SR(t){return t.translate===0&&t.scale===1}function N4(t){return SR(t.x)&&SR(t.y)}function TR(t,e){return t.min===e.min&&t.max===e.max}function fH(t,e){return TR(t.x,e.x)&&TR(t.y,e.y)}function ER(t,e){return Math.round(t.min)===Math.round(e.min)&&Math.round(t.max)===Math.round(e.max)}function j4(t,e){return ER(t.x,e.x)&&ER(t.y,e.y)}function CR(t){return ks(t.x)/ks(t.y)}function PR(t,e){return t.translate===e.translate&&t.scale===e.scale&&t.originPoint===e.originPoint}class pH{constructor(){this.members=[]}add(e){JC(this.members,e),e.scheduleRender()}remove(e){if(eP(this.members,e),e===this.prevLead&&(this.prevLead=void 0),e===this.lead){const r=this.members[this.members.length-1];r&&this.promote(r)}}relegate(e){const r=this.members.findIndex(s=>e===s);if(r===0)return!1;let n;for(let s=r;s>=0;s--){const c=this.members[s];if(c.isPresent!==!1){n=c;break}}return n?(this.promote(n),!0):!1}promote(e,r){const n=this.lead;if(e!==n&&(this.prevLead=n,this.lead=e,e.show(),n)){n.instance&&n.scheduleRender(),e.scheduleRender(),e.resumeFrom=n,r&&(e.resumeFrom.preserveOpacity=!0),n.snapshot&&(e.snapshot=n.snapshot,e.snapshot.latestValues=n.animationValues||n.latestValues),e.root&&e.root.isUpdating&&(e.isLayoutDirty=!0);const{crossfade:s}=e.options;s===!1&&n.hide()}}exitAnimationComplete(){this.members.forEach(e=>{const{options:r,resumingFrom:n}=e;r.onExitComplete&&r.onExitComplete(),n&&n.options.onExitComplete&&n.options.onExitComplete()})}scheduleRender(){this.members.forEach(e=>{e.instance&&e.scheduleRender(!1)})}removeLeadSnapshot(){this.lead&&this.lead.snapshot&&(this.lead.snapshot=void 0)}}function mH(t,e,r){let n="";const s=t.x.translate/e.x,c=t.y.translate/e.y,l=(r==null?void 0:r.z)||0;if((s||c||l)&&(n=`translate3d(${s}px, ${c}px, ${l}px) `),(e.x!==1||e.y!==1)&&(n+=`scale(${1/e.x}, ${1/e.y}) `),r){const{transformPerspective:y,rotate:v,rotateX:T,rotateY:P,skewX:A,skewY:O}=r;y&&(n=`perspective(${y}px) ${n}`),v&&(n+=`rotate(${v}deg) `),T&&(n+=`rotateX(${T}deg) `),P&&(n+=`rotateY(${P}deg) `),A&&(n+=`skewX(${A}deg) `),O&&(n+=`skewY(${O}deg) `)}const a=t.x.scale*e.x,m=t.y.scale*e.y;return(a!==1||m!==1)&&(n+=`scale(${a}, ${m})`),n||"none"}const I2=["","X","Y","Z"],gH=1e3;let yH=0;function R2(t,e,r,n){const{latestValues:s}=e;s[t]&&(r[t]=s[t],e.setStaticValue(t,0),n&&(n[t]=0))}function F4(t){if(t.hasCheckedOptimisedAppear=!0,t.root===t)return;const{visualElement:e}=t.options;if(!e)return;const r=T4(e);if(window.MotionHasOptimisedAnimation(r,"transform")){const{layout:s,layoutId:c}=t.options;window.MotionCancelOptimisedAnimation(r,"transform",wn,!(s||c))}const{parent:n}=t;n&&!n.hasCheckedOptimisedAppear&&F4(n)}function B4({attachResizeListener:t,defaultParent:e,measureScroll:r,checkIsScrollRoot:n,resetTransform:s}){return class{constructor(l={},a=e==null?void 0:e()){this.id=yH++,this.animationId=0,this.animationCommitId=0,this.children=new Set,this.options={},this.isTreeAnimating=!1,this.isAnimationBlocked=!1,this.isLayoutDirty=!1,this.isProjectionDirty=!1,this.isSharedProjectionDirty=!1,this.isTransformDirty=!1,this.updateManuallyBlocked=!1,this.updateBlockedByResize=!1,this.isUpdating=!1,this.isSVG=!1,this.needsReset=!1,this.shouldResetTransform=!1,this.hasCheckedOptimisedAppear=!1,this.treeScale={x:1,y:1},this.eventHandlers=new Map,this.hasTreeAnimated=!1,this.updateScheduled=!1,this.scheduleUpdate=()=>this.update(),this.projectionUpdateScheduled=!1,this.checkUpdateFailed=()=>{this.isUpdating&&(this.isUpdating=!1,this.clearAllSnapshots())},this.updateProjection=()=>{this.projectionUpdateScheduled=!1,this.nodes.forEach(xH),this.nodes.forEach(TH),this.nodes.forEach(EH),this.nodes.forEach(bH)},this.resolvedRelativeTargetAt=0,this.hasProjected=!1,this.isVisible=!0,this.animationProgress=0,this.sharedNodes=new Map,this.latestValues=l,this.root=a?a.root||a:this,this.path=a?[...a.path,a]:[],this.parent=a,this.depth=a?a.depth+1:0;for(let m=0;m<this.path.length;m++)this.path[m].shouldResetTransform=!0;this.root===this&&(this.nodes=new iH)}addEventListener(l,a){return this.eventHandlers.has(l)||this.eventHandlers.set(l,new nP),this.eventHandlers.get(l).add(a)}notifyListeners(l,...a){const m=this.eventHandlers.get(l);m&&m.notify(...a)}hasListeners(l){return this.eventHandlers.has(l)}mount(l){if(this.instance)return;this.isSVG=t4(l)&&!dW(l),this.instance=l;const{layoutId:a,layout:m,visualElement:y}=this.options;if(y&&!y.current&&y.mount(l),this.root.nodes.add(this),this.parent&&this.parent.children.add(this),this.root.hasTreeAnimated&&(m||a)&&(this.isLayoutDirty=!0),t){let v,T=0;const P=()=>this.root.updateBlockedByResize=!1;wn.read(()=>{T=window.innerWidth}),t(l,()=>{const A=window.innerWidth;A!==T&&(T=A,this.root.updateBlockedByResize=!0,v&&v(),v=sH(P,250),xx.hasAnimatedSinceResize&&(xx.hasAnimatedSinceResize=!1,this.nodes.forEach(MR)))})}a&&this.root.registerSharedNode(a,this),this.options.animate!==!1&&y&&(a||m)&&this.addEventListener("didUpdate",({delta:v,hasLayoutChanged:T,hasRelativeLayoutChanged:P,layout:A})=>{if(this.isTreeAnimationBlocked()){this.target=void 0,this.relativeTarget=void 0;return}const O=this.options.transition||y.getDefaultTransition()||MH,{onLayoutAnimationStart:I,onLayoutAnimationComplete:L}=y.getProps(),R=!this.targetLayout||!j4(this.targetLayout,A),z=!T&&P;if(this.options.layoutRoot||this.resumeFrom||z||T&&(R||!this.currentAnimation)){this.resumeFrom&&(this.resumingFrom=this.resumeFrom,this.resumingFrom.resumingFrom=void 0);const j={...gP(O,"layout"),onPlay:I,onComplete:L};(y.shouldReduceMotion||this.options.layoutRoot)&&(j.delay=0,j.type=!1),this.startAnimation(j),this.setAnimationOrigin(v,z)}else T||MR(this),this.isLead()&&this.options.onExitComplete&&this.options.onExitComplete();this.targetLayout=A})}unmount(){this.options.layoutId&&this.willUpdate(),this.root.nodes.remove(this);const l=this.getStack();l&&l.remove(this),this.parent&&this.parent.children.delete(this),this.instance=void 0,this.eventHandlers.clear(),Au(this.updateProjection)}blockUpdate(){this.updateManuallyBlocked=!0}unblockUpdate(){this.updateManuallyBlocked=!1}isUpdateBlocked(){return this.updateManuallyBlocked||this.updateBlockedByResize}isTreeAnimationBlocked(){return this.isAnimationBlocked||this.parent&&this.parent.isTreeAnimationBlocked()||!1}startUpdate(){this.isUpdateBlocked()||(this.isUpdating=!0,this.nodes&&this.nodes.forEach(CH),this.animationId++)}getTransformTemplate(){const{visualElement:l}=this.options;return l&&l.getProps().transformTemplate}willUpdate(l=!0){if(this.root.hasTreeAnimated=!0,this.root.isUpdateBlocked()){this.options.onExitComplete&&this.options.onExitComplete();return}if(window.MotionCancelOptimisedAnimation&&!this.hasCheckedOptimisedAppear&&F4(this),!this.root.isUpdating&&this.root.startUpdate(),this.isLayoutDirty)return;this.isLayoutDirty=!0;for(let v=0;v<this.path.length;v++){const T=this.path[v];T.shouldResetTransform=!0,T.updateScroll("snapshot"),T.options.layoutRoot&&T.willUpdate(!1)}const{layoutId:a,layout:m}=this.options;if(a===void 0&&!m)return;const y=this.getTransformTemplate();this.prevTransformTemplateValue=y?y(this.latestValues,""):void 0,this.updateSnapshot(),l&&this.notifyListeners("willUpdate")}update(){if(this.updateScheduled=!1,this.isUpdateBlocked()){this.unblockUpdate(),this.clearAllSnapshots(),this.nodes.forEach(AR);return}if(this.animationId<=this.animationCommitId){this.nodes.forEach(kR);return}this.animationCommitId=this.animationId,this.isUpdating?(this.isUpdating=!1,this.nodes.forEach(SH),this.nodes.forEach(_H),this.nodes.forEach(vH)):this.nodes.forEach(kR),this.clearAllSnapshots();const a=Hs.now();Yi.delta=rc(0,1e3/60,a-Yi.timestamp),Yi.timestamp=a,Yi.isProcessing=!0,x2.update.process(Yi),x2.preRender.process(Yi),x2.render.process(Yi),Yi.isProcessing=!1}didUpdate(){this.updateScheduled||(this.updateScheduled=!0,_P.read(this.scheduleUpdate))}clearAllSnapshots(){this.nodes.forEach(wH),this.sharedNodes.forEach(PH)}scheduleUpdateProjection(){this.projectionUpdateScheduled||(this.projectionUpdateScheduled=!0,wn.preRender(this.updateProjection,!1,!0))}scheduleCheckAfterUnmount(){wn.postRender(()=>{this.isLayoutDirty?this.root.didUpdate():this.root.checkUpdateFailed()})}updateSnapshot(){this.snapshot||!this.instance||(this.snapshot=this.measure(),this.snapshot&&!ks(this.snapshot.measuredBox.x)&&!ks(this.snapshot.measuredBox.y)&&(this.snapshot=void 0))}updateLayout(){if(!this.instance||(this.updateScroll(),!(this.options.alwaysMeasureLayout&&this.isLead())&&!this.isLayoutDirty))return;if(this.resumeFrom&&!this.resumeFrom.instance)for(let m=0;m<this.path.length;m++)this.path[m].updateScroll();const l=this.layout;this.layout=this.measure(!1),this.layoutCorrected=Qn(),this.isLayoutDirty=!1,this.projectionDelta=void 0,this.notifyListeners("measure",this.layout.layoutBox);const{visualElement:a}=this.options;a&&a.notify("LayoutMeasure",this.layout.layoutBox,l?l.layoutBox:void 0)}updateScroll(l="measure"){let a=!!(this.options.layoutScroll&&this.instance);if(this.scroll&&this.scroll.animationId===this.root.animationId&&this.scroll.phase===l&&(a=!1),a&&this.instance){const m=n(this.instance);this.scroll={animationId:this.root.animationId,phase:l,isRoot:m,offset:r(this.instance),wasRoot:this.scroll?this.scroll.isRoot:m}}}resetTransform(){if(!s)return;const l=this.isLayoutDirty||this.shouldResetTransform||this.options.alwaysMeasureLayout,a=this.projectionDelta&&!N4(this.projectionDelta),m=this.getTransformTemplate(),y=m?m(this.latestValues,""):void 0,v=y!==this.prevTransformTemplateValue;l&&this.instance&&(a||Bh(this.latestValues)||v)&&(s(this.instance,y),this.shouldResetTransform=!1,this.scheduleRender())}measure(l=!0){const a=this.measurePageBox();let m=this.removeElementScroll(a);return l&&(m=this.removeTransform(m)),IH(m),{animationId:this.root.animationId,measuredBox:a,layoutBox:m,latestValues:{},source:this.id}}measurePageBox(){var y;const{visualElement:l}=this.options;if(!l)return Qn();const a=l.measureViewportBox();if(!(((y=this.scroll)==null?void 0:y.wasRoot)||this.path.some(RH))){const{scroll:v}=this.root;v&&(yp(a.x,v.offset.x),yp(a.y,v.offset.y))}return a}removeElementScroll(l){var m;const a=Qn();if(No(a,l),(m=this.scroll)!=null&&m.wasRoot)return a;for(let y=0;y<this.path.length;y++){const v=this.path[y],{scroll:T,options:P}=v;v!==this.root&&T&&P.layoutScroll&&(T.wasRoot&&No(a,l),yp(a.x,T.offset.x),yp(a.y,T.offset.y))}return a}applyTransform(l,a=!1){const m=Qn();No(m,l);for(let y=0;y<this.path.length;y++){const v=this.path[y];!a&&v.options.layoutScroll&&v.scroll&&v!==v.root&&_p(m,{x:-v.scroll.offset.x,y:-v.scroll.offset.y}),Bh(v.latestValues)&&_p(m,v.latestValues)}return Bh(this.latestValues)&&_p(m,this.latestValues),m}removeTransform(l){const a=Qn();No(a,l);for(let m=0;m<this.path.length;m++){const y=this.path[m];if(!y.instance||!Bh(y.latestValues))continue;RT(y.latestValues)&&y.updateSnapshot();const v=Qn(),T=y.measurePageBox();No(v,T),wR(a,y.latestValues,y.snapshot?y.snapshot.layoutBox:void 0,v)}return Bh(this.latestValues)&&wR(a,this.latestValues),a}setTargetDelta(l){this.targetDelta=l,this.root.scheduleUpdateProjection(),this.isProjectionDirty=!0}setOptions(l){this.options={...this.options,...l,crossfade:l.crossfade!==void 0?l.crossfade:!0}}clearMeasurements(){this.scroll=void 0,this.layout=void 0,this.snapshot=void 0,this.prevTransformTemplateValue=void 0,this.targetDelta=void 0,this.target=void 0,this.isLayoutDirty=!1}forceRelativeParentToResolveTarget(){this.relativeParent&&this.relativeParent.resolvedRelativeTargetAt!==Yi.timestamp&&this.relativeParent.resolveTargetDelta(!0)}resolveTargetDelta(l=!1){var P;const a=this.getLead();this.isProjectionDirty||(this.isProjectionDirty=a.isProjectionDirty),this.isTransformDirty||(this.isTransformDirty=a.isTransformDirty),this.isSharedProjectionDirty||(this.isSharedProjectionDirty=a.isSharedProjectionDirty);const m=!!this.resumingFrom||this!==a;if(!(l||m&&this.isSharedProjectionDirty||this.isProjectionDirty||(P=this.parent)!=null&&P.isProjectionDirty||this.attemptToResolveRelativeTarget||this.root.updateBlockedByResize))return;const{layout:v,layoutId:T}=this.options;if(!(!this.layout||!(v||T))){if(this.resolvedRelativeTargetAt=Yi.timestamp,!this.targetDelta&&!this.relativeTarget){const A=this.getClosestProjectingParent();A&&A.layout&&this.animationProgress!==1?(this.relativeParent=A,this.forceRelativeParentToResolveTarget(),this.relativeTarget=Qn(),this.relativeTargetOrigin=Qn(),Py(this.relativeTargetOrigin,this.layout.layoutBox,A.layout.layoutBox),No(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}if(!(!this.relativeTarget&&!this.targetDelta)&&(this.target||(this.target=Qn(),this.targetWithTransforms=Qn()),this.relativeTarget&&this.relativeTargetOrigin&&this.relativeParent&&this.relativeParent.target?(this.forceRelativeParentToResolveTarget(),jq(this.target,this.relativeTarget,this.relativeParent.target)):this.targetDelta?(this.resumingFrom?this.target=this.applyTransform(this.layout.layoutBox):No(this.target,this.layout.layoutBox),_4(this.target,this.targetDelta)):No(this.target,this.layout.layoutBox),this.attemptToResolveRelativeTarget)){this.attemptToResolveRelativeTarget=!1;const A=this.getClosestProjectingParent();A&&!!A.resumingFrom==!!this.resumingFrom&&!A.options.layoutScroll&&A.target&&this.animationProgress!==1?(this.relativeParent=A,this.forceRelativeParentToResolveTarget(),this.relativeTarget=Qn(),this.relativeTargetOrigin=Qn(),Py(this.relativeTargetOrigin,this.target,A.target),No(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}}}getClosestProjectingParent(){if(!(!this.parent||RT(this.parent.latestValues)||y4(this.parent.latestValues)))return this.parent.isProjecting()?this.parent:this.parent.getClosestProjectingParent()}isProjecting(){return!!((this.relativeTarget||this.targetDelta||this.options.layoutRoot)&&this.layout)}calcProjection(){var O;const l=this.getLead(),a=!!this.resumingFrom||this!==l;let m=!0;if((this.isProjectionDirty||(O=this.parent)!=null&&O.isProjectionDirty)&&(m=!1),a&&(this.isSharedProjectionDirty||this.isTransformDirty)&&(m=!1),this.resolvedRelativeTargetAt===Yi.timestamp&&(m=!1),m)return;const{layout:y,layoutId:v}=this.options;if(this.isTreeAnimating=!!(this.parent&&this.parent.isTreeAnimating||this.currentAnimation||this.pendingAnimation),this.isTreeAnimating||(this.targetDelta=this.relativeTarget=void 0),!this.layout||!(y||v))return;No(this.layoutCorrected,this.layout.layoutBox);const T=this.treeScale.x,P=this.treeScale.y;XW(this.layoutCorrected,this.treeScale,this.path,a),l.layout&&!l.target&&(this.treeScale.x!==1||this.treeScale.y!==1)&&(l.target=l.layout.layoutBox,l.targetWithTransforms=Qn());const{target:A}=l;if(!A){this.prevProjectionDelta&&(this.createProjectionDeltas(),this.scheduleRender());return}!this.projectionDelta||!this.prevProjectionDelta?this.createProjectionDeltas():(vR(this.prevProjectionDelta.x,this.projectionDelta.x),vR(this.prevProjectionDelta.y,this.projectionDelta.y)),Cy(this.projectionDelta,this.layoutCorrected,A,this.latestValues),(this.treeScale.x!==T||this.treeScale.y!==P||!PR(this.projectionDelta.x,this.prevProjectionDelta.x)||!PR(this.projectionDelta.y,this.prevProjectionDelta.y))&&(this.hasProjected=!0,this.scheduleRender(),this.notifyListeners("projectionUpdate",A))}hide(){this.isVisible=!1}show(){this.isVisible=!0}scheduleRender(l=!0){var a;if((a=this.options.visualElement)==null||a.scheduleRender(),l){const m=this.getStack();m&&m.scheduleRender()}this.resumingFrom&&!this.resumingFrom.instance&&(this.resumingFrom=void 0)}createProjectionDeltas(){this.prevProjectionDelta=vp(),this.projectionDelta=vp(),this.projectionDeltaWithTransform=vp()}setAnimationOrigin(l,a=!1){const m=this.snapshot,y=m?m.latestValues:{},v={...this.latestValues},T=vp();(!this.relativeParent||!this.relativeParent.options.layoutRoot)&&(this.relativeTarget=this.relativeTargetOrigin=void 0),this.attemptToResolveRelativeTarget=!a;const P=Qn(),A=m?m.source:void 0,O=this.layout?this.layout.source:void 0,I=A!==O,L=this.getStack(),R=!L||L.members.length<=1,z=!!(I&&!R&&this.options.crossfade===!0&&!this.path.some(kH));this.animationProgress=0;let j;this.mixTargetDelta=W=>{const Z=W/1e3;IR(T.x,l.x,Z),IR(T.y,l.y,Z),this.setTargetDelta(T),this.relativeTarget&&this.relativeTargetOrigin&&this.layout&&this.relativeParent&&this.relativeParent.layout&&(Py(P,this.layout.layoutBox,this.relativeParent.layout.layoutBox),AH(this.relativeTarget,this.relativeTargetOrigin,P,Z),j&&fH(this.relativeTarget,j)&&(this.isProjectionDirty=!1),j||(j=Qn()),No(j,this.relativeTarget)),I&&(this.animationValues=v,aH(v,y,this.latestValues,Z,z,R)),this.root.scheduleUpdateProjection(),this.scheduleRender(),this.animationProgress=Z},this.mixTargetDelta(this.options.layoutRoot?1e3:0)}startAnimation(l){var a,m,y;this.notifyListeners("animationStart"),(a=this.currentAnimation)==null||a.stop(),(y=(m=this.resumingFrom)==null?void 0:m.currentAnimation)==null||y.stop(),this.pendingAnimation&&(Au(this.pendingAnimation),this.pendingAnimation=void 0),this.pendingAnimation=wn.update(()=>{xx.hasAnimatedSinceResize=!0,this.motionValue||(this.motionValue=em(0)),this.currentAnimation=rH(this.motionValue,[0,1e3],{...l,velocity:0,isSync:!0,onUpdate:v=>{this.mixTargetDelta(v),l.onUpdate&&l.onUpdate(v)},onStop:()=>{},onComplete:()=>{l.onComplete&&l.onComplete(),this.completeAnimation()}}),this.resumingFrom&&(this.resumingFrom.currentAnimation=this.currentAnimation),this.pendingAnimation=void 0})}completeAnimation(){this.resumingFrom&&(this.resumingFrom.currentAnimation=void 0,this.resumingFrom.preserveOpacity=void 0);const l=this.getStack();l&&l.exitAnimationComplete(),this.resumingFrom=this.currentAnimation=this.animationValues=void 0,this.notifyListeners("animationComplete")}finishAnimation(){this.currentAnimation&&(this.mixTargetDelta&&this.mixTargetDelta(gH),this.currentAnimation.stop()),this.completeAnimation()}applyTransformsToTarget(){const l=this.getLead();let{targetWithTransforms:a,target:m,layout:y,latestValues:v}=l;if(!(!a||!m||!y)){if(this!==l&&this.layout&&y&&$4(this.options.animationType,this.layout.layoutBox,y.layoutBox)){m=this.target||Qn();const T=ks(this.layout.layoutBox.x);m.x.min=l.target.x.min,m.x.max=m.x.min+T;const P=ks(this.layout.layoutBox.y);m.y.min=l.target.y.min,m.y.max=m.y.min+P}No(a,m),_p(a,v),Cy(this.projectionDeltaWithTransform,this.layoutCorrected,a,v)}}registerSharedNode(l,a){this.sharedNodes.has(l)||this.sharedNodes.set(l,new pH),this.sharedNodes.get(l).add(a);const y=a.options.initialPromotionConfig;a.promote({transition:y?y.transition:void 0,preserveFollowOpacity:y&&y.shouldPreserveFollowOpacity?y.shouldPreserveFollowOpacity(a):void 0})}isLead(){const l=this.getStack();return l?l.lead===this:!0}getLead(){var a;const{layoutId:l}=this.options;return l?((a=this.getStack())==null?void 0:a.lead)||this:this}getPrevLead(){var a;const{layoutId:l}=this.options;return l?(a=this.getStack())==null?void 0:a.prevLead:void 0}getStack(){const{layoutId:l}=this.options;if(l)return this.root.sharedNodes.get(l)}promote({needsReset:l,transition:a,preserveFollowOpacity:m}={}){const y=this.getStack();y&&y.promote(this,m),l&&(this.projectionDelta=void 0,this.needsReset=!0),a&&this.setOptions({transition:a})}relegate(){const l=this.getStack();return l?l.relegate(this):!1}resetSkewAndRotation(){const{visualElement:l}=this.options;if(!l)return;let a=!1;const{latestValues:m}=l;if((m.z||m.rotate||m.rotateX||m.rotateY||m.rotateZ||m.skewX||m.skewY)&&(a=!0),!a)return;const y={};m.z&&R2("z",l,y,this.animationValues);for(let v=0;v<I2.length;v++)R2(`rotate${I2[v]}`,l,y,this.animationValues),R2(`skew${I2[v]}`,l,y,this.animationValues);l.render();for(const v in y)l.setStaticValue(v,y[v]),this.animationValues&&(this.animationValues[v]=y[v]);l.scheduleRender()}applyProjectionStyles(l,a){if(!this.instance||this.isSVG)return;if(!this.isVisible){l.visibility="hidden";return}const m=this.getTransformTemplate();if(this.needsReset){this.needsReset=!1,l.visibility="",l.opacity="",l.pointerEvents=vx(a==null?void 0:a.pointerEvents)||"",l.transform=m?m(this.latestValues,""):"none";return}const y=this.getLead();if(!this.projectionDelta||!this.layout||!y.target){this.options.layoutId&&(l.opacity=this.latestValues.opacity!==void 0?this.latestValues.opacity:1,l.pointerEvents=vx(a==null?void 0:a.pointerEvents)||""),this.hasProjected&&!Bh(this.latestValues)&&(l.transform=m?m({},""):"none",this.hasProjected=!1);return}l.visibility="";const v=y.animationValues||y.latestValues;this.applyTransformsToTarget();let T=mH(this.projectionDeltaWithTransform,this.treeScale,v);m&&(T=m(v,T)),l.transform=T;const{x:P,y:A}=this.projectionDelta;l.transformOrigin=`${P.origin*100}% ${A.origin*100}% 0`,y.animationValues?l.opacity=y===this?v.opacity??this.latestValues.opacity??1:this.preserveOpacity?this.latestValues.opacity:v.opacityExit:l.opacity=y===this?v.opacity!==void 0?v.opacity:"":v.opacityExit!==void 0?v.opacityExit:0;for(const O in c0){if(v[O]===void 0)continue;const{correct:I,applyTo:L,isCSSVariable:R}=c0[O],z=T==="none"?v[O]:I(v[O],y);if(L){const j=L.length;for(let W=0;W<j;W++)l[L[W]]=z}else R?this.options.visualElement.renderState.vars[O]=z:l[O]=z}this.options.layoutId&&(l.pointerEvents=y===this?vx(a==null?void 0:a.pointerEvents)||"":"none")}clearSnapshot(){this.resumeFrom=this.snapshot=void 0}resetTree(){this.root.nodes.forEach(l=>{var a;return(a=l.currentAnimation)==null?void 0:a.stop()}),this.root.nodes.forEach(AR),this.root.sharedNodes.clear()}}}function _H(t){t.updateLayout()}function vH(t){var r;const e=((r=t.resumeFrom)==null?void 0:r.snapshot)||t.snapshot;if(t.isLead()&&t.layout&&e&&t.hasListeners("didUpdate")){const{layoutBox:n,measuredBox:s}=t.layout,{animationType:c}=t.options,l=e.source!==t.layout.source;c==="size"?Vo(T=>{const P=l?e.measuredBox[T]:e.layoutBox[T],A=ks(P);P.min=n[T].min,P.max=P.min+A}):$4(c,e.layoutBox,n)&&Vo(T=>{const P=l?e.measuredBox[T]:e.layoutBox[T],A=ks(n[T]);P.max=P.min+A,t.relativeTarget&&!t.currentAnimation&&(t.isProjectionDirty=!0,t.relativeTarget[T].max=t.relativeTarget[T].min+A)});const a=vp();Cy(a,n,e.layoutBox);const m=vp();l?Cy(m,t.applyTransform(s,!0),e.measuredBox):Cy(m,n,e.layoutBox);const y=!N4(a);let v=!1;if(!t.resumeFrom){const T=t.getClosestProjectingParent();if(T&&!T.resumeFrom){const{snapshot:P,layout:A}=T;if(P&&A){const O=Qn();Py(O,e.layoutBox,P.layoutBox);const I=Qn();Py(I,n,A.layoutBox),j4(O,I)||(v=!0),T.options.layoutRoot&&(t.relativeTarget=I,t.relativeTargetOrigin=O,t.relativeParent=T)}}}t.notifyListeners("didUpdate",{layout:n,snapshot:e,delta:m,layoutDelta:a,hasLayoutChanged:y,hasRelativeLayoutChanged:v})}else if(t.isLead()){const{onExitComplete:n}=t.options;n&&n()}t.options.transition=void 0}function xH(t){t.parent&&(t.isProjecting()||(t.isProjectionDirty=t.parent.isProjectionDirty),t.isSharedProjectionDirty||(t.isSharedProjectionDirty=!!(t.isProjectionDirty||t.parent.isProjectionDirty||t.parent.isSharedProjectionDirty)),t.isTransformDirty||(t.isTransformDirty=t.parent.isTransformDirty))}function bH(t){t.isProjectionDirty=t.isSharedProjectionDirty=t.isTransformDirty=!1}function wH(t){t.clearSnapshot()}function AR(t){t.clearMeasurements()}function kR(t){t.isLayoutDirty=!1}function SH(t){const{visualElement:e}=t.options;e&&e.getProps().onBeforeLayoutMeasure&&e.notify("BeforeLayoutMeasure"),t.resetTransform()}function MR(t){t.finishAnimation(),t.targetDelta=t.relativeTarget=t.target=void 0,t.isProjectionDirty=!0}function TH(t){t.resolveTargetDelta()}function EH(t){t.calcProjection()}function CH(t){t.resetSkewAndRotation()}function PH(t){t.removeLeadSnapshot()}function IR(t,e,r){t.translate=Rn(e.translate,0,r),t.scale=Rn(e.scale,1,r),t.origin=e.origin,t.originPoint=e.originPoint}function RR(t,e,r,n){t.min=Rn(e.min,r.min,n),t.max=Rn(e.max,r.max,n)}function AH(t,e,r,n){RR(t.x,e.x,r.x,n),RR(t.y,e.y,r.y,n)}function kH(t){return t.animationValues&&t.animationValues.opacityExit!==void 0}const MH={duration:.45,ease:[.4,0,.1,1]},DR=t=>typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().includes(t),LR=DR("applewebkit/")&&!DR("chrome/")?Math.round:Jo;function OR(t){t.min=LR(t.min),t.max=LR(t.max)}function IH(t){OR(t.x),OR(t.y)}function $4(t,e,r){return t==="position"||t==="preserve-aspect"&&!Nq(CR(e),CR(r),.2)}function RH(t){var e;return t!==t.root&&((e=t.scroll)==null?void 0:e.wasRoot)}const DH=B4({attachResizeListener:(t,e)=>u0(t,"resize",e),measureScroll:()=>({x:document.documentElement.scrollLeft||document.body.scrollLeft,y:document.documentElement.scrollTop||document.body.scrollTop}),checkIsScrollRoot:()=>!0}),D2={current:void 0},V4=B4({measureScroll:t=>({x:t.scrollLeft,y:t.scrollTop}),defaultParent:()=>{if(!D2.current){const t=new DH({});t.mount(window),t.setOptions({layoutScroll:!0}),D2.current=t}return D2.current},resetTransform:(t,e)=>{t.style.transform=e!==void 0?e:"none"},checkIsScrollRoot:t=>window.getComputedStyle(t).position==="fixed"}),LH={pan:{Feature:Qq},drag:{Feature:Yq,ProjectionNode:V4,MeasureLayout:L4}};function zR(t,e,r){const{props:n}=t;t.animationState&&n.whileHover&&t.animationState.setActive("whileHover",r==="Start");const s="onHover"+r,c=n[s];c&&wn.postRender(()=>c(e,W0(e)))}class OH extends Fu{mount(){const{current:e}=this.node;e&&(this.unmount=aW(e,(r,n)=>(zR(this.node,n,"Start"),s=>zR(this.node,s,"End"))))}unmount(){}}class zH extends Fu{constructor(){super(...arguments),this.isActive=!1}onFocus(){let e=!1;try{e=this.node.current.matches(":focus-visible")}catch{e=!0}!e||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!0),this.isActive=!0)}onBlur(){!this.isActive||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!1),this.isActive=!1)}mount(){this.unmount=V0(u0(this.node.current,"focus",()=>this.onFocus()),u0(this.node.current,"blur",()=>this.onBlur()))}unmount(){}}function NR(t,e,r){const{props:n}=t;if(t.current instanceof HTMLButtonElement&&t.current.disabled)return;t.animationState&&n.whileTap&&t.animationState.setActive("whileTap",r==="Start");const s="onTap"+(r==="End"?"":r),c=n[s];c&&wn.postRender(()=>c(e,W0(e)))}class NH extends Fu{mount(){const{current:e}=this.node;e&&(this.unmount=hW(e,(r,n)=>(NR(this.node,n,"Start"),(s,{success:c})=>NR(this.node,s,c?"End":"Cancel")),{useGlobalTarget:this.node.props.globalTapTarget}))}unmount(){}}const FT=new WeakMap,L2=new WeakMap,jH=t=>{const e=FT.get(t.target);e&&e(t)},FH=t=>{t.forEach(jH)};function BH({root:t,...e}){const r=t||document;L2.has(r)||L2.set(r,{});const n=L2.get(r),s=JSON.stringify(e);return n[s]||(n[s]=new IntersectionObserver(FH,{root:t,...e})),n[s]}function $H(t,e,r){const n=BH(e);return FT.set(t,r),n.observe(t),()=>{FT.delete(t),n.unobserve(t)}}const VH={some:0,all:1};class UH extends Fu{constructor(){super(...arguments),this.hasEnteredView=!1,this.isInView=!1}startObserver(){this.unmount();const{viewport:e={}}=this.node.getProps(),{root:r,margin:n,amount:s="some",once:c}=e,l={root:r?r.current:void 0,rootMargin:n,threshold:typeof s=="number"?s:VH[s]},a=m=>{const{isIntersecting:y}=m;if(this.isInView===y||(this.isInView=y,c&&!y&&this.hasEnteredView))return;y&&(this.hasEnteredView=!0),this.node.animationState&&this.node.animationState.setActive("whileInView",y);const{onViewportEnter:v,onViewportLeave:T}=this.node.getProps(),P=y?v:T;P&&P(m)};return $H(this.node.current,l,a)}mount(){this.startObserver()}update(){if(typeof IntersectionObserver>"u")return;const{props:e,prevProps:r}=this.node;["amount","margin","root"].some(GH(e,r))&&this.startObserver()}unmount(){}}function GH({viewport:t={}},{viewport:e={}}={}){return r=>t[r]!==e[r]}const WH={inView:{Feature:UH},tap:{Feature:NH},focus:{Feature:zH},hover:{Feature:OH}},qH={layout:{ProjectionNode:V4,MeasureLayout:L4}},HH={...Iq,...WH,...LH,...qH},nr=HW(HH,oq),ZH={some:0,all:1};function KH(t,e,{root:r,margin:n,amount:s="some"}={}){const c=X5(t),l=new WeakMap,a=y=>{y.forEach(v=>{const T=l.get(v.target);if(v.isIntersecting!==!!T)if(v.isIntersecting){const P=e(v.target,v);typeof P=="function"?l.set(v.target,P):m.unobserve(v.target)}else typeof T=="function"&&(T(v),l.delete(v.target))})},m=new IntersectionObserver(a,{root:r,rootMargin:n,threshold:typeof s=="number"?s:ZH[s]});return c.forEach(y=>m.observe(y)),()=>m.disconnect()}function Qh(t,{root:e,margin:r,amount:n,once:s=!1,initial:c=!1}={}){const[l,a]=X.useState(c);return X.useEffect(()=>{if(!t.current||s&&l)return;const m=()=>(a(!0),s?void 0:()=>a(!1)),y={root:e&&e.current||void 0,margin:r,amount:n};return KH(t.current,m,y)},[e,t,r,s,n]),l}/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const XH=t=>t.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),U4=(...t)=>t.filter((e,r,n)=>!!e&&e.trim()!==""&&n.indexOf(e)===r).join(" ").trim();/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var YH={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const QH=X.forwardRef(({color:t="currentColor",size:e=24,strokeWidth:r=2,absoluteStrokeWidth:n,className:s="",children:c,iconNode:l,...a},m)=>X.createElement("svg",{ref:m,...YH,width:e,height:e,stroke:t,strokeWidth:n?Number(r)*24/Number(e):r,className:U4("lucide",s),...a},[...l.map(([y,v])=>X.createElement(y,v)),...Array.isArray(c)?c:[c]]));/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const en=(t,e)=>{const r=X.forwardRef(({className:n,...s},c)=>X.createElement(QH,{ref:c,iconNode:e,className:U4(`lucide-${XH(t)}`,n),...s}));return r.displayName=`${t}`,r};/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const JH=en("AlarmClock",[["circle",{cx:"12",cy:"13",r:"8",key:"3y4lt7"}],["path",{d:"M12 9v4l2 2",key:"1c63tq"}],["path",{d:"M5 3 2 6",key:"18tl5t"}],["path",{d:"m22 6-3-3",key:"1opdir"}],["path",{d:"M6.38 18.7 4 21",key:"17xu3x"}],["path",{d:"M17.64 18.67 20 21",key:"kv2oe2"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const eZ=en("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tZ=en("ArrowRight",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const BT=en("Bell",[["path",{d:"M6 8a6 6 0 0 1 12 0c0 7 3 9 3 9H3s3-2 3-9",key:"1qo2s2"}],["path",{d:"M10.3 21a1.94 1.94 0 0 0 3.4 0",key:"qgo35s"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Nv=en("Camera",[["path",{d:"M14.5 4h-5L7 7H4a2 2 0 0 0-2 2v9a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-3l-2.5-3z",key:"1tc9qg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rZ=en("ChartLine",[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"m19 9-5 5-4-4-3 3",key:"2osh9i"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jR=en("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const FR=en("CircleCheck",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const G4=en("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nZ=en("CloudSun",[["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"m4.93 4.93 1.41 1.41",key:"149t6j"}],["path",{d:"M20 12h2",key:"1q8mjw"}],["path",{d:"m19.07 4.93-1.41 1.41",key:"1shlcs"}],["path",{d:"M15.947 12.65a4 4 0 0 0-5.925-4.128",key:"dpwdj0"}],["path",{d:"M13 22H7a5 5 0 1 1 4.9-6H13a3 3 0 0 1 0 6Z",key:"s09mg5"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const iZ=en("Droplet",[["path",{d:"M12 22a7 7 0 0 0 7-7c0-2-1-3.9-3-5.5s-3.5-4-4-6.5c-.5 2.5-2 4.9-4 6.5C6 11.1 5 13 5 15a7 7 0 0 0 7 7z",key:"c7niix"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $T=en("Eye",[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sZ=en("House",[["path",{d:"M15 21v-8a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v8",key:"5wwlr5"}],["path",{d:"M3 10a2 2 0 0 1 .709-1.528l7-5.999a2 2 0 0 1 2.582 0l7 5.999A2 2 0 0 1 21 10v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"1d0kgt"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oZ=en("Info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const aZ=en("LayoutDashboard",[["rect",{width:"7",height:"9",x:"3",y:"3",rx:"1",key:"10lvy0"}],["rect",{width:"7",height:"5",x:"14",y:"3",rx:"1",key:"16une8"}],["rect",{width:"7",height:"9",x:"14",y:"12",rx:"1",key:"1hutg5"}],["rect",{width:"7",height:"5",x:"3",y:"16",rx:"1",key:"ldoo1y"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const BR=en("LoaderCircle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lZ=en("Map",[["path",{d:"M14.106 5.553a2 2 0 0 0 1.788 0l3.659-1.83A1 1 0 0 1 21 4.619v12.764a1 1 0 0 1-.553.894l-4.553 2.277a2 2 0 0 1-1.788 0l-4.212-2.106a2 2 0 0 0-1.788 0l-3.659 1.83A1 1 0 0 1 3 19.381V6.618a1 1 0 0 1 .553-.894l4.553-2.277a2 2 0 0 1 1.788 0z",key:"169xi5"}],["path",{d:"M15 5.764v15",key:"1pn4in"}],["path",{d:"M9 3.236v15",key:"1uimfh"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const W4=en("ScanLine",[["path",{d:"M3 7V5a2 2 0 0 1 2-2h2",key:"aa7l1z"}],["path",{d:"M17 3h2a2 2 0 0 1 2 2v2",key:"4qcy5o"}],["path",{d:"M21 17v2a2 2 0 0 1-2 2h-2",key:"6vwrx8"}],["path",{d:"M7 21H5a2 2 0 0 1-2-2v-2",key:"ioqczr"}],["path",{d:"M7 12h10",key:"b7w52i"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const VT=en("Shield",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cZ=en("Sprout",[["path",{d:"M7 20h10",key:"e6iznv"}],["path",{d:"M10 20c5.5-2.5.8-6.4 3-10",key:"161w41"}],["path",{d:"M9.5 9.4c1.1.8 1.8 2.2 2.3 3.7-2 .4-3.5.4-4.8-.3-1.2-.6-2.3-1.9-3-4.2 2.8-.5 4.4 0 5.5.8z",key:"9gtqwd"}],["path",{d:"M14.1 6a7 7 0 0 0-1.1 4c1.9-.1 3.3-.6 4.3-1.4 1-1 1.6-2.3 1.7-4.6-2.7.1-4 1-4.9 2z",key:"bkxnd2"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const uZ=en("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Uh=en("TriangleAlert",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hZ=en("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dZ=en("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fZ=en("Video",[["path",{d:"m16 13 5.223 3.482a.5.5 0 0 0 .777-.416V7.87a.5.5 0 0 0-.752-.432L16 10.5",key:"ftymec"}],["rect",{x:"2",y:"6",width:"14",height:"12",rx:"2",key:"158x01"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gh=en("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const UT=en("Zap",[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]]);function q4(t){var e,r,n="";if(typeof t=="string"||typeof t=="number")n+=t;else if(typeof t=="object")if(Array.isArray(t)){var s=t.length;for(e=0;e<s;e++)t[e]&&(r=q4(t[e]))&&(n&&(n+=" "),n+=r)}else for(r in t)t[r]&&(n&&(n+=" "),n+=r);return n}function H4(){for(var t,e,r=0,n="",s=arguments.length;r<s;r++)(t=arguments[r])&&(e=q4(t))&&(n&&(n+=" "),n+=e);return n}const kP="-",pZ=t=>{const e=gZ(t),{conflictingClassGroups:r,conflictingClassGroupModifiers:n}=t;return{getClassGroupId:l=>{const a=l.split(kP);return a[0]===""&&a.length!==1&&a.shift(),Z4(a,e)||mZ(l)},getConflictingClassGroupIds:(l,a)=>{const m=r[l]||[];return a&&n[l]?[...m,...n[l]]:m}}},Z4=(t,e)=>{var l;if(t.length===0)return e.classGroupId;const r=t[0],n=e.nextPart.get(r),s=n?Z4(t.slice(1),n):void 0;if(s)return s;if(e.validators.length===0)return;const c=t.join(kP);return(l=e.validators.find(({validator:a})=>a(c)))==null?void 0:l.classGroupId},$R=/^\[(.+)\]$/,mZ=t=>{if($R.test(t)){const e=$R.exec(t)[1],r=e==null?void 0:e.substring(0,e.indexOf(":"));if(r)return"arbitrary.."+r}},gZ=t=>{const{theme:e,prefix:r}=t,n={nextPart:new Map,validators:[]};return _Z(Object.entries(t.classGroups),r).forEach(([c,l])=>{GT(l,n,c,e)}),n},GT=(t,e,r,n)=>{t.forEach(s=>{if(typeof s=="string"){const c=s===""?e:VR(e,s);c.classGroupId=r;return}if(typeof s=="function"){if(yZ(s)){GT(s(n),e,r,n);return}e.validators.push({validator:s,classGroupId:r});return}Object.entries(s).forEach(([c,l])=>{GT(l,VR(e,c),r,n)})})},VR=(t,e)=>{let r=t;return e.split(kP).forEach(n=>{r.nextPart.has(n)||r.nextPart.set(n,{nextPart:new Map,validators:[]}),r=r.nextPart.get(n)}),r},yZ=t=>t.isThemeGetter,_Z=(t,e)=>e?t.map(([r,n])=>{const s=n.map(c=>typeof c=="string"?e+c:typeof c=="object"?Object.fromEntries(Object.entries(c).map(([l,a])=>[e+l,a])):c);return[r,s]}):t,vZ=t=>{if(t<1)return{get:()=>{},set:()=>{}};let e=0,r=new Map,n=new Map;const s=(c,l)=>{r.set(c,l),e++,e>t&&(e=0,n=r,r=new Map)};return{get(c){let l=r.get(c);if(l!==void 0)return l;if((l=n.get(c))!==void 0)return s(c,l),l},set(c,l){r.has(c)?r.set(c,l):s(c,l)}}},K4="!",xZ=t=>{const{separator:e,experimentalParseClassName:r}=t,n=e.length===1,s=e[0],c=e.length,l=a=>{const m=[];let y=0,v=0,T;for(let L=0;L<a.length;L++){let R=a[L];if(y===0){if(R===s&&(n||a.slice(L,L+c)===e)){m.push(a.slice(v,L)),v=L+c;continue}if(R==="/"){T=L;continue}}R==="["?y++:R==="]"&&y--}const P=m.length===0?a:a.substring(v),A=P.startsWith(K4),O=A?P.substring(1):P,I=T&&T>v?T-v:void 0;return{modifiers:m,hasImportantModifier:A,baseClassName:O,maybePostfixModifierPosition:I}};return r?a=>r({className:a,parseClassName:l}):l},bZ=t=>{if(t.length<=1)return t;const e=[];let r=[];return t.forEach(n=>{n[0]==="["?(e.push(...r.sort(),n),r=[]):r.push(n)}),e.push(...r.sort()),e},wZ=t=>({cache:vZ(t.cacheSize),parseClassName:xZ(t),...pZ(t)}),SZ=/\s+/,TZ=(t,e)=>{const{parseClassName:r,getClassGroupId:n,getConflictingClassGroupIds:s}=e,c=[],l=t.trim().split(SZ);let a="";for(let m=l.length-1;m>=0;m-=1){const y=l[m],{modifiers:v,hasImportantModifier:T,baseClassName:P,maybePostfixModifierPosition:A}=r(y);let O=!!A,I=n(O?P.substring(0,A):P);if(!I){if(!O){a=y+(a.length>0?" "+a:a);continue}if(I=n(P),!I){a=y+(a.length>0?" "+a:a);continue}O=!1}const L=bZ(v).join(":"),R=T?L+K4:L,z=R+I;if(c.includes(z))continue;c.push(z);const j=s(I,O);for(let W=0;W<j.length;++W){const Z=j[W];c.push(R+Z)}a=y+(a.length>0?" "+a:a)}return a};function EZ(){let t=0,e,r,n="";for(;t<arguments.length;)(e=arguments[t++])&&(r=X4(e))&&(n&&(n+=" "),n+=r);return n}const X4=t=>{if(typeof t=="string")return t;let e,r="";for(let n=0;n<t.length;n++)t[n]&&(e=X4(t[n]))&&(r&&(r+=" "),r+=e);return r};function CZ(t,...e){let r,n,s,c=l;function l(m){const y=e.reduce((v,T)=>T(v),t());return r=wZ(y),n=r.cache.get,s=r.cache.set,c=a,a(m)}function a(m){const y=n(m);if(y)return y;const v=TZ(m,r);return s(m,v),v}return function(){return c(EZ.apply(null,arguments))}}const dn=t=>{const e=r=>r[t]||[];return e.isThemeGetter=!0,e},Y4=/^\[(?:([a-z-]+):)?(.+)\]$/i,PZ=/^\d+\/\d+$/,AZ=new Set(["px","full","screen"]),kZ=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,MZ=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,IZ=/^(rgba?|hsla?|hwb|(ok)?(lab|lch))\(.+\)$/,RZ=/^(inset_)?-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/,DZ=/^(url|image|image-set|cross-fade|element|(repeating-)?(linear|radial|conic)-gradient)\(.+\)$/,Bl=t=>kp(t)||AZ.has(t)||PZ.test(t),Gc=t=>xm(t,"length",$Z),kp=t=>!!t&&!Number.isNaN(Number(t)),O2=t=>xm(t,"number",kp),Wg=t=>!!t&&Number.isInteger(Number(t)),LZ=t=>t.endsWith("%")&&kp(t.slice(0,-1)),pr=t=>Y4.test(t),Wc=t=>kZ.test(t),OZ=new Set(["length","size","percentage"]),zZ=t=>xm(t,OZ,Q4),NZ=t=>xm(t,"position",Q4),jZ=new Set(["image","url"]),FZ=t=>xm(t,jZ,UZ),BZ=t=>xm(t,"",VZ),qg=()=>!0,xm=(t,e,r)=>{const n=Y4.exec(t);return n?n[1]?typeof e=="string"?n[1]===e:e.has(n[1]):r(n[2]):!1},$Z=t=>MZ.test(t)&&!IZ.test(t),Q4=()=>!1,VZ=t=>RZ.test(t),UZ=t=>DZ.test(t),GZ=()=>{const t=dn("colors"),e=dn("spacing"),r=dn("blur"),n=dn("brightness"),s=dn("borderColor"),c=dn("borderRadius"),l=dn("borderSpacing"),a=dn("borderWidth"),m=dn("contrast"),y=dn("grayscale"),v=dn("hueRotate"),T=dn("invert"),P=dn("gap"),A=dn("gradientColorStops"),O=dn("gradientColorStopPositions"),I=dn("inset"),L=dn("margin"),R=dn("opacity"),z=dn("padding"),j=dn("saturate"),W=dn("scale"),Z=dn("sepia"),te=dn("skew"),ie=dn("space"),V=dn("translate"),q=()=>["auto","contain","none"],Q=()=>["auto","hidden","clip","visible","scroll"],ce=()=>["auto",pr,e],se=()=>[pr,e],ue=()=>["",Bl,Gc],he=()=>["auto",kp,pr],ye=()=>["bottom","center","left","left-bottom","left-top","right","right-bottom","right-top","top"],xe=()=>["solid","dashed","dotted","double","none"],Se=()=>["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"],fe=()=>["start","end","center","between","around","evenly","stretch"],ve=()=>["","0",pr],Re=()=>["auto","avoid","all","avoid-page","page","left","right","column"],$e=()=>[kp,pr];return{cacheSize:500,separator:":",theme:{colors:[qg],spacing:[Bl,Gc],blur:["none","",Wc,pr],brightness:$e(),borderColor:[t],borderRadius:["none","","full",Wc,pr],borderSpacing:se(),borderWidth:ue(),contrast:$e(),grayscale:ve(),hueRotate:$e(),invert:ve(),gap:se(),gradientColorStops:[t],gradientColorStopPositions:[LZ,Gc],inset:ce(),margin:ce(),opacity:$e(),padding:se(),saturate:$e(),scale:$e(),sepia:ve(),skew:$e(),space:se(),translate:se()},classGroups:{aspect:[{aspect:["auto","square","video",pr]}],container:["container"],columns:[{columns:[Wc]}],"break-after":[{"break-after":Re()}],"break-before":[{"break-before":Re()}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],float:[{float:["right","left","none","start","end"]}],clear:[{clear:["left","right","both","none","start","end"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:[...ye(),pr]}],overflow:[{overflow:Q()}],"overflow-x":[{"overflow-x":Q()}],"overflow-y":[{"overflow-y":Q()}],overscroll:[{overscroll:q()}],"overscroll-x":[{"overscroll-x":q()}],"overscroll-y":[{"overscroll-y":q()}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:[I]}],"inset-x":[{"inset-x":[I]}],"inset-y":[{"inset-y":[I]}],start:[{start:[I]}],end:[{end:[I]}],top:[{top:[I]}],right:[{right:[I]}],bottom:[{bottom:[I]}],left:[{left:[I]}],visibility:["visible","invisible","collapse"],z:[{z:["auto",Wg,pr]}],basis:[{basis:ce()}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["wrap","wrap-reverse","nowrap"]}],flex:[{flex:["1","auto","initial","none",pr]}],grow:[{grow:ve()}],shrink:[{shrink:ve()}],order:[{order:["first","last","none",Wg,pr]}],"grid-cols":[{"grid-cols":[qg]}],"col-start-end":[{col:["auto",{span:["full",Wg,pr]},pr]}],"col-start":[{"col-start":he()}],"col-end":[{"col-end":he()}],"grid-rows":[{"grid-rows":[qg]}],"row-start-end":[{row:["auto",{span:[Wg,pr]},pr]}],"row-start":[{"row-start":he()}],"row-end":[{"row-end":he()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":["auto","min","max","fr",pr]}],"auto-rows":[{"auto-rows":["auto","min","max","fr",pr]}],gap:[{gap:[P]}],"gap-x":[{"gap-x":[P]}],"gap-y":[{"gap-y":[P]}],"justify-content":[{justify:["normal",...fe()]}],"justify-items":[{"justify-items":["start","end","center","stretch"]}],"justify-self":[{"justify-self":["auto","start","end","center","stretch"]}],"align-content":[{content:["normal",...fe(),"baseline"]}],"align-items":[{items:["start","end","center","baseline","stretch"]}],"align-self":[{self:["auto","start","end","center","stretch","baseline"]}],"place-content":[{"place-content":[...fe(),"baseline"]}],"place-items":[{"place-items":["start","end","center","baseline","stretch"]}],"place-self":[{"place-self":["auto","start","end","center","stretch"]}],p:[{p:[z]}],px:[{px:[z]}],py:[{py:[z]}],ps:[{ps:[z]}],pe:[{pe:[z]}],pt:[{pt:[z]}],pr:[{pr:[z]}],pb:[{pb:[z]}],pl:[{pl:[z]}],m:[{m:[L]}],mx:[{mx:[L]}],my:[{my:[L]}],ms:[{ms:[L]}],me:[{me:[L]}],mt:[{mt:[L]}],mr:[{mr:[L]}],mb:[{mb:[L]}],ml:[{ml:[L]}],"space-x":[{"space-x":[ie]}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":[ie]}],"space-y-reverse":["space-y-reverse"],w:[{w:["auto","min","max","fit","svw","lvw","dvw",pr,e]}],"min-w":[{"min-w":[pr,e,"min","max","fit"]}],"max-w":[{"max-w":[pr,e,"none","full","min","max","fit","prose",{screen:[Wc]},Wc]}],h:[{h:[pr,e,"auto","min","max","fit","svh","lvh","dvh"]}],"min-h":[{"min-h":[pr,e,"min","max","fit","svh","lvh","dvh"]}],"max-h":[{"max-h":[pr,e,"min","max","fit","svh","lvh","dvh"]}],size:[{size:[pr,e,"auto","min","max","fit"]}],"font-size":[{text:["base",Wc,Gc]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:["thin","extralight","light","normal","medium","semibold","bold","extrabold","black",O2]}],"font-family":[{font:[qg]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractions"],tracking:[{tracking:["tighter","tight","normal","wide","wider","widest",pr]}],"line-clamp":[{"line-clamp":["none",kp,O2]}],leading:[{leading:["none","tight","snug","normal","relaxed","loose",Bl,pr]}],"list-image":[{"list-image":["none",pr]}],"list-style-type":[{list:["none","disc","decimal",pr]}],"list-style-position":[{list:["inside","outside"]}],"placeholder-color":[{placeholder:[t]}],"placeholder-opacity":[{"placeholder-opacity":[R]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"text-color":[{text:[t]}],"text-opacity":[{"text-opacity":[R]}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[...xe(),"wavy"]}],"text-decoration-thickness":[{decoration:["auto","from-font",Bl,Gc]}],"underline-offset":[{"underline-offset":["auto",Bl,pr]}],"text-decoration-color":[{decoration:[t]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],"text-wrap":[{text:["wrap","nowrap","balance","pretty"]}],indent:[{indent:se()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",pr]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",pr]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-opacity":[{"bg-opacity":[R]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:[...ye(),NZ]}],"bg-repeat":[{bg:["no-repeat",{repeat:["","x","y","round","space"]}]}],"bg-size":[{bg:["auto","cover","contain",zZ]}],"bg-image":[{bg:["none",{"gradient-to":["t","tr","r","br","b","bl","l","tl"]},FZ]}],"bg-color":[{bg:[t]}],"gradient-from-pos":[{from:[O]}],"gradient-via-pos":[{via:[O]}],"gradient-to-pos":[{to:[O]}],"gradient-from":[{from:[A]}],"gradient-via":[{via:[A]}],"gradient-to":[{to:[A]}],rounded:[{rounded:[c]}],"rounded-s":[{"rounded-s":[c]}],"rounded-e":[{"rounded-e":[c]}],"rounded-t":[{"rounded-t":[c]}],"rounded-r":[{"rounded-r":[c]}],"rounded-b":[{"rounded-b":[c]}],"rounded-l":[{"rounded-l":[c]}],"rounded-ss":[{"rounded-ss":[c]}],"rounded-se":[{"rounded-se":[c]}],"rounded-ee":[{"rounded-ee":[c]}],"rounded-es":[{"rounded-es":[c]}],"rounded-tl":[{"rounded-tl":[c]}],"rounded-tr":[{"rounded-tr":[c]}],"rounded-br":[{"rounded-br":[c]}],"rounded-bl":[{"rounded-bl":[c]}],"border-w":[{border:[a]}],"border-w-x":[{"border-x":[a]}],"border-w-y":[{"border-y":[a]}],"border-w-s":[{"border-s":[a]}],"border-w-e":[{"border-e":[a]}],"border-w-t":[{"border-t":[a]}],"border-w-r":[{"border-r":[a]}],"border-w-b":[{"border-b":[a]}],"border-w-l":[{"border-l":[a]}],"border-opacity":[{"border-opacity":[R]}],"border-style":[{border:[...xe(),"hidden"]}],"divide-x":[{"divide-x":[a]}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":[a]}],"divide-y-reverse":["divide-y-reverse"],"divide-opacity":[{"divide-opacity":[R]}],"divide-style":[{divide:xe()}],"border-color":[{border:[s]}],"border-color-x":[{"border-x":[s]}],"border-color-y":[{"border-y":[s]}],"border-color-s":[{"border-s":[s]}],"border-color-e":[{"border-e":[s]}],"border-color-t":[{"border-t":[s]}],"border-color-r":[{"border-r":[s]}],"border-color-b":[{"border-b":[s]}],"border-color-l":[{"border-l":[s]}],"divide-color":[{divide:[s]}],"outline-style":[{outline:["",...xe()]}],"outline-offset":[{"outline-offset":[Bl,pr]}],"outline-w":[{outline:[Bl,Gc]}],"outline-color":[{outline:[t]}],"ring-w":[{ring:ue()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:[t]}],"ring-opacity":[{"ring-opacity":[R]}],"ring-offset-w":[{"ring-offset":[Bl,Gc]}],"ring-offset-color":[{"ring-offset":[t]}],shadow:[{shadow:["","inner","none",Wc,BZ]}],"shadow-color":[{shadow:[qg]}],opacity:[{opacity:[R]}],"mix-blend":[{"mix-blend":[...Se(),"plus-lighter","plus-darker"]}],"bg-blend":[{"bg-blend":Se()}],filter:[{filter:["","none"]}],blur:[{blur:[r]}],brightness:[{brightness:[n]}],contrast:[{contrast:[m]}],"drop-shadow":[{"drop-shadow":["","none",Wc,pr]}],grayscale:[{grayscale:[y]}],"hue-rotate":[{"hue-rotate":[v]}],invert:[{invert:[T]}],saturate:[{saturate:[j]}],sepia:[{sepia:[Z]}],"backdrop-filter":[{"backdrop-filter":["","none"]}],"backdrop-blur":[{"backdrop-blur":[r]}],"backdrop-brightness":[{"backdrop-brightness":[n]}],"backdrop-contrast":[{"backdrop-contrast":[m]}],"backdrop-grayscale":[{"backdrop-grayscale":[y]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[v]}],"backdrop-invert":[{"backdrop-invert":[T]}],"backdrop-opacity":[{"backdrop-opacity":[R]}],"backdrop-saturate":[{"backdrop-saturate":[j]}],"backdrop-sepia":[{"backdrop-sepia":[Z]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":[l]}],"border-spacing-x":[{"border-spacing-x":[l]}],"border-spacing-y":[{"border-spacing-y":[l]}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["none","all","","colors","opacity","shadow","transform",pr]}],duration:[{duration:$e()}],ease:[{ease:["linear","in","out","in-out",pr]}],delay:[{delay:$e()}],animate:[{animate:["none","spin","ping","pulse","bounce",pr]}],transform:[{transform:["","gpu","none"]}],scale:[{scale:[W]}],"scale-x":[{"scale-x":[W]}],"scale-y":[{"scale-y":[W]}],rotate:[{rotate:[Wg,pr]}],"translate-x":[{"translate-x":[V]}],"translate-y":[{"translate-y":[V]}],"skew-x":[{"skew-x":[te]}],"skew-y":[{"skew-y":[te]}],"transform-origin":[{origin:["center","top","top-right","right","bottom-right","bottom","bottom-left","left","top-left",pr]}],accent:[{accent:["auto",t]}],appearance:[{appearance:["none","auto"]}],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",pr]}],"caret-color":[{caret:[t]}],"pointer-events":[{"pointer-events":["none","auto"]}],resize:[{resize:["none","y","x",""]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":se()}],"scroll-mx":[{"scroll-mx":se()}],"scroll-my":[{"scroll-my":se()}],"scroll-ms":[{"scroll-ms":se()}],"scroll-me":[{"scroll-me":se()}],"scroll-mt":[{"scroll-mt":se()}],"scroll-mr":[{"scroll-mr":se()}],"scroll-mb":[{"scroll-mb":se()}],"scroll-ml":[{"scroll-ml":se()}],"scroll-p":[{"scroll-p":se()}],"scroll-px":[{"scroll-px":se()}],"scroll-py":[{"scroll-py":se()}],"scroll-ps":[{"scroll-ps":se()}],"scroll-pe":[{"scroll-pe":se()}],"scroll-pt":[{"scroll-pt":se()}],"scroll-pr":[{"scroll-pr":se()}],"scroll-pb":[{"scroll-pb":se()}],"scroll-pl":[{"scroll-pl":se()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","manipulation"]}],"touch-x":[{"touch-pan":["x","left","right"]}],"touch-y":[{"touch-pan":["y","up","down"]}],"touch-pz":["touch-pinch-zoom"],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",pr]}],fill:[{fill:[t,"none"]}],"stroke-w":[{stroke:[Bl,Gc,O2]}],stroke:[{stroke:[t,"none"]}],sr:["sr-only","not-sr-only"],"forced-color-adjust":[{"forced-color-adjust":["auto","none"]}]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],size:["w","h"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],"line-clamp":["display","overflow"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-s","border-color-e","border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"],touch:["touch-x","touch-y","touch-pz"],"touch-x":["touch"],"touch-y":["touch"],"touch-pz":["touch"]},conflictingClassGroupModifiers:{"font-size":["leading"]}}},WZ=CZ(GZ);function Lr(...t){return WZ(H4(t))}const qZ="modulepreload",HZ=function(t){return"/"+t},UR={},q0=function(e,r,n){let s=Promise.resolve();if(r&&r.length>0){document.getElementsByTagName("link");const l=document.querySelector("meta[property=csp-nonce]"),a=(l==null?void 0:l.nonce)||(l==null?void 0:l.getAttribute("nonce"));s=Promise.allSettled(r.map(m=>{if(m=HZ(m),m in UR)return;UR[m]=!0;const y=m.endsWith(".css"),v=y?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${m}"]${v}`))return;const T=document.createElement("link");if(T.rel=y?"stylesheet":qZ,y||(T.as="script"),T.crossOrigin="",T.href=m,a&&T.setAttribute("nonce",a),document.head.appendChild(T),y)return new Promise((P,A)=>{T.addEventListener("load",P),T.addEventListener("error",()=>A(new Error(`Unable to preload CSS for ${m}`)))})}))}function c(l){const a=new Event("vite:preloadError",{cancelable:!0});if(a.payload=l,window.dispatchEvent(a),!a.defaultPrevented)throw l}return s.then(l=>{for(const a of l||[])a.status==="rejected"&&c(a.reason);return e().catch(c)})},ZZ=t=>{let e;return t?e=t:typeof fetch>"u"?e=(...r)=>q0(async()=>{const{default:n}=await Promise.resolve().then(()=>bm);return{default:n}},void 0).then(({default:n})=>n(...r)):e=fetch,(...r)=>e(...r)};class MP extends Error{constructor(e,r="FunctionsError",n){super(e),this.name=r,this.context=n}}class GR extends MP{constructor(e){super("Failed to send a request to the Edge Function","FunctionsFetchError",e)}}class WR extends MP{constructor(e){super("Relay Error invoking the Edge Function","FunctionsRelayError",e)}}class qR extends MP{constructor(e){super("Edge Function returned a non-2xx status code","FunctionsHttpError",e)}}var WT;(function(t){t.Any="any",t.ApNortheast1="ap-northeast-1",t.ApNortheast2="ap-northeast-2",t.ApSouth1="ap-south-1",t.ApSoutheast1="ap-southeast-1",t.ApSoutheast2="ap-southeast-2",t.CaCentral1="ca-central-1",t.EuCentral1="eu-central-1",t.EuWest1="eu-west-1",t.EuWest2="eu-west-2",t.EuWest3="eu-west-3",t.SaEast1="sa-east-1",t.UsEast1="us-east-1",t.UsWest1="us-west-1",t.UsWest2="us-west-2"})(WT||(WT={}));var KZ=function(t,e,r,n){function s(c){return c instanceof r?c:new r(function(l){l(c)})}return new(r||(r=Promise))(function(c,l){function a(v){try{y(n.next(v))}catch(T){l(T)}}function m(v){try{y(n.throw(v))}catch(T){l(T)}}function y(v){v.done?c(v.value):s(v.value).then(a,m)}y((n=n.apply(t,e||[])).next())})};class XZ{constructor(e,{headers:r={},customFetch:n,region:s=WT.Any}={}){this.url=e,this.headers=r,this.region=s,this.fetch=ZZ(n)}setAuth(e){this.headers.Authorization=`Bearer ${e}`}invoke(e){return KZ(this,arguments,void 0,function*(r,n={}){var s;try{const{headers:c,method:l,body:a,signal:m}=n;let y={},{region:v}=n;v||(v=this.region);const T=new URL(`${this.url}/${r}`);v&&v!=="any"&&(y["x-region"]=v,T.searchParams.set("forceFunctionRegion",v));let P;a&&(c&&!Object.prototype.hasOwnProperty.call(c,"Content-Type")||!c)&&(typeof Blob<"u"&&a instanceof Blob||a instanceof ArrayBuffer?(y["Content-Type"]="application/octet-stream",P=a):typeof a=="string"?(y["Content-Type"]="text/plain",P=a):typeof FormData<"u"&&a instanceof FormData?P=a:(y["Content-Type"]="application/json",P=JSON.stringify(a)));const A=yield this.fetch(T.toString(),{method:l||"POST",headers:Object.assign(Object.assign(Object.assign({},y),this.headers),c),body:P,signal:m}).catch(R=>{throw R.name==="AbortError"?R:new GR(R)}),O=A.headers.get("x-relay-error");if(O&&O==="true")throw new WR(A);if(!A.ok)throw new qR(A);let I=((s=A.headers.get("Content-Type"))!==null&&s!==void 0?s:"text/plain").split(";")[0].trim(),L;return I==="application/json"?L=yield A.json():I==="application/octet-stream"?L=yield A.blob():I==="text/event-stream"?L=A:I==="multipart/form-data"?L=yield A.formData():L=yield A.text(),{data:L,error:null,response:A}}catch(c){return c instanceof Error&&c.name==="AbortError"?{data:null,error:new GR(c)}:{data:null,error:c,response:c instanceof qR||c instanceof WR?c.context:void 0}}})}}var Ws={},IP={},i1={},H0={},s1={},o1={},YZ=function(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("unable to locate global object")},rm=YZ();const QZ=rm.fetch,J4=rm.fetch.bind(rm),eN=rm.Headers,JZ=rm.Request,eK=rm.Response,bm=Object.freeze(Object.defineProperty({__proto__:null,Headers:eN,Request:JZ,Response:eK,default:J4,fetch:QZ},Symbol.toStringTag,{value:"Module"})),tK=G8(bm);var a1={};Object.defineProperty(a1,"__esModule",{value:!0});let rK=class extends Error{constructor(e){super(e.message),this.name="PostgrestError",this.details=e.details,this.hint=e.hint,this.code=e.code}};a1.default=rK;var tN=Po&&Po.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(o1,"__esModule",{value:!0});const nK=tN(tK),iK=tN(a1);let sK=class{constructor(e){var r,n;this.shouldThrowOnError=!1,this.method=e.method,this.url=e.url,this.headers=new Headers(e.headers),this.schema=e.schema,this.body=e.body,this.shouldThrowOnError=(r=e.shouldThrowOnError)!==null&&r!==void 0?r:!1,this.signal=e.signal,this.isMaybeSingle=(n=e.isMaybeSingle)!==null&&n!==void 0?n:!1,e.fetch?this.fetch=e.fetch:typeof fetch>"u"?this.fetch=nK.default:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(e,r){return this.headers=new Headers(this.headers),this.headers.set(e,r),this}then(e,r){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers.set("Accept-Profile",this.schema):this.headers.set("Content-Profile",this.schema)),this.method!=="GET"&&this.method!=="HEAD"&&this.headers.set("Content-Type","application/json");const n=this.fetch;let s=n(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async c=>{var l,a,m,y;let v=null,T=null,P=null,A=c.status,O=c.statusText;if(c.ok){if(this.method!=="HEAD"){const z=await c.text();z===""||(this.headers.get("Accept")==="text/csv"||this.headers.get("Accept")&&(!((l=this.headers.get("Accept"))===null||l===void 0)&&l.includes("application/vnd.pgrst.plan+text"))?T=z:T=JSON.parse(z))}const L=(a=this.headers.get("Prefer"))===null||a===void 0?void 0:a.match(/count=(exact|planned|estimated)/),R=(m=c.headers.get("content-range"))===null||m===void 0?void 0:m.split("/");L&&R&&R.length>1&&(P=parseInt(R[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(T)&&(T.length>1?(v={code:"PGRST116",details:`Results contain ${T.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},T=null,P=null,A=406,O="Not Acceptable"):T.length===1?T=T[0]:T=null)}else{const L=await c.text();try{v=JSON.parse(L),Array.isArray(v)&&c.status===404&&(T=[],v=null,A=200,O="OK")}catch{c.status===404&&L===""?(A=204,O="No Content"):v={message:L}}if(v&&this.isMaybeSingle&&(!((y=v==null?void 0:v.details)===null||y===void 0)&&y.includes("0 rows"))&&(v=null,A=200,O="OK"),v&&this.shouldThrowOnError)throw new iK.default(v)}return{error:v,data:T,count:P,status:A,statusText:O}});return this.shouldThrowOnError||(s=s.catch(c=>{var l,a,m;return{error:{message:`${(l=c==null?void 0:c.name)!==null&&l!==void 0?l:"FetchError"}: ${c==null?void 0:c.message}`,details:`${(a=c==null?void 0:c.stack)!==null&&a!==void 0?a:""}`,hint:"",code:`${(m=c==null?void 0:c.code)!==null&&m!==void 0?m:""}`},data:null,count:null,status:0,statusText:""}})),s.then(e,r)}returns(){return this}overrideTypes(){return this}};o1.default=sK;var oK=Po&&Po.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(s1,"__esModule",{value:!0});const aK=oK(o1);let lK=class extends aK.default{select(e){let r=!1;const n=(e??"*").split("").map(s=>/\s/.test(s)&&!r?"":(s==='"'&&(r=!r),s)).join("");return this.url.searchParams.set("select",n),this.headers.append("Prefer","return=representation"),this}order(e,{ascending:r=!0,nullsFirst:n,foreignTable:s,referencedTable:c=s}={}){const l=c?`${c}.order`:"order",a=this.url.searchParams.get(l);return this.url.searchParams.set(l,`${a?`${a},`:""}${e}.${r?"asc":"desc"}${n===void 0?"":n?".nullsfirst":".nullslast"}`),this}limit(e,{foreignTable:r,referencedTable:n=r}={}){const s=typeof n>"u"?"limit":`${n}.limit`;return this.url.searchParams.set(s,`${e}`),this}range(e,r,{foreignTable:n,referencedTable:s=n}={}){const c=typeof s>"u"?"offset":`${s}.offset`,l=typeof s>"u"?"limit":`${s}.limit`;return this.url.searchParams.set(c,`${e}`),this.url.searchParams.set(l,`${r-e+1}`),this}abortSignal(e){return this.signal=e,this}single(){return this.headers.set("Accept","application/vnd.pgrst.object+json"),this}maybeSingle(){return this.method==="GET"?this.headers.set("Accept","application/json"):this.headers.set("Accept","application/vnd.pgrst.object+json"),this.isMaybeSingle=!0,this}csv(){return this.headers.set("Accept","text/csv"),this}geojson(){return this.headers.set("Accept","application/geo+json"),this}explain({analyze:e=!1,verbose:r=!1,settings:n=!1,buffers:s=!1,wal:c=!1,format:l="text"}={}){var a;const m=[e?"analyze":null,r?"verbose":null,n?"settings":null,s?"buffers":null,c?"wal":null].filter(Boolean).join("|"),y=(a=this.headers.get("Accept"))!==null&&a!==void 0?a:"application/json";return this.headers.set("Accept",`application/vnd.pgrst.plan+${l}; for="${y}"; options=${m};`),l==="json"?this:this}rollback(){return this.headers.append("Prefer","tx=rollback"),this}returns(){return this}maxAffected(e){return this.headers.append("Prefer","handling=strict"),this.headers.append("Prefer",`max-affected=${e}`),this}};s1.default=lK;var cK=Po&&Po.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(H0,"__esModule",{value:!0});const uK=cK(s1);let hK=class extends uK.default{eq(e,r){return this.url.searchParams.append(e,`eq.${r}`),this}neq(e,r){return this.url.searchParams.append(e,`neq.${r}`),this}gt(e,r){return this.url.searchParams.append(e,`gt.${r}`),this}gte(e,r){return this.url.searchParams.append(e,`gte.${r}`),this}lt(e,r){return this.url.searchParams.append(e,`lt.${r}`),this}lte(e,r){return this.url.searchParams.append(e,`lte.${r}`),this}like(e,r){return this.url.searchParams.append(e,`like.${r}`),this}likeAllOf(e,r){return this.url.searchParams.append(e,`like(all).{${r.join(",")}}`),this}likeAnyOf(e,r){return this.url.searchParams.append(e,`like(any).{${r.join(",")}}`),this}ilike(e,r){return this.url.searchParams.append(e,`ilike.${r}`),this}ilikeAllOf(e,r){return this.url.searchParams.append(e,`ilike(all).{${r.join(",")}}`),this}ilikeAnyOf(e,r){return this.url.searchParams.append(e,`ilike(any).{${r.join(",")}}`),this}is(e,r){return this.url.searchParams.append(e,`is.${r}`),this}in(e,r){const n=Array.from(new Set(r)).map(s=>typeof s=="string"&&new RegExp("[,()]").test(s)?`"${s}"`:`${s}`).join(",");return this.url.searchParams.append(e,`in.(${n})`),this}contains(e,r){return typeof r=="string"?this.url.searchParams.append(e,`cs.${r}`):Array.isArray(r)?this.url.searchParams.append(e,`cs.{${r.join(",")}}`):this.url.searchParams.append(e,`cs.${JSON.stringify(r)}`),this}containedBy(e,r){return typeof r=="string"?this.url.searchParams.append(e,`cd.${r}`):Array.isArray(r)?this.url.searchParams.append(e,`cd.{${r.join(",")}}`):this.url.searchParams.append(e,`cd.${JSON.stringify(r)}`),this}rangeGt(e,r){return this.url.searchParams.append(e,`sr.${r}`),this}rangeGte(e,r){return this.url.searchParams.append(e,`nxl.${r}`),this}rangeLt(e,r){return this.url.searchParams.append(e,`sl.${r}`),this}rangeLte(e,r){return this.url.searchParams.append(e,`nxr.${r}`),this}rangeAdjacent(e,r){return this.url.searchParams.append(e,`adj.${r}`),this}overlaps(e,r){return typeof r=="string"?this.url.searchParams.append(e,`ov.${r}`):this.url.searchParams.append(e,`ov.{${r.join(",")}}`),this}textSearch(e,r,{config:n,type:s}={}){let c="";s==="plain"?c="pl":s==="phrase"?c="ph":s==="websearch"&&(c="w");const l=n===void 0?"":`(${n})`;return this.url.searchParams.append(e,`${c}fts${l}.${r}`),this}match(e){return Object.entries(e).forEach(([r,n])=>{this.url.searchParams.append(r,`eq.${n}`)}),this}not(e,r,n){return this.url.searchParams.append(e,`not.${r}.${n}`),this}or(e,{foreignTable:r,referencedTable:n=r}={}){const s=n?`${n}.or`:"or";return this.url.searchParams.append(s,`(${e})`),this}filter(e,r,n){return this.url.searchParams.append(e,`${r}.${n}`),this}};H0.default=hK;var dK=Po&&Po.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(i1,"__esModule",{value:!0});const Hg=dK(H0);let fK=class{constructor(e,{headers:r={},schema:n,fetch:s}){this.url=e,this.headers=new Headers(r),this.schema=n,this.fetch=s}select(e,r){const{head:n=!1,count:s}=r??{},c=n?"HEAD":"GET";let l=!1;const a=(e??"*").split("").map(m=>/\s/.test(m)&&!l?"":(m==='"'&&(l=!l),m)).join("");return this.url.searchParams.set("select",a),s&&this.headers.append("Prefer",`count=${s}`),new Hg.default({method:c,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch})}insert(e,{count:r,defaultToNull:n=!0}={}){var s;const c="POST";if(r&&this.headers.append("Prefer",`count=${r}`),n||this.headers.append("Prefer","missing=default"),Array.isArray(e)){const l=e.reduce((a,m)=>a.concat(Object.keys(m)),[]);if(l.length>0){const a=[...new Set(l)].map(m=>`"${m}"`);this.url.searchParams.set("columns",a.join(","))}}return new Hg.default({method:c,url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:(s=this.fetch)!==null&&s!==void 0?s:fetch})}upsert(e,{onConflict:r,ignoreDuplicates:n=!1,count:s,defaultToNull:c=!0}={}){var l;const a="POST";if(this.headers.append("Prefer",`resolution=${n?"ignore":"merge"}-duplicates`),r!==void 0&&this.url.searchParams.set("on_conflict",r),s&&this.headers.append("Prefer",`count=${s}`),c||this.headers.append("Prefer","missing=default"),Array.isArray(e)){const m=e.reduce((y,v)=>y.concat(Object.keys(v)),[]);if(m.length>0){const y=[...new Set(m)].map(v=>`"${v}"`);this.url.searchParams.set("columns",y.join(","))}}return new Hg.default({method:a,url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:(l=this.fetch)!==null&&l!==void 0?l:fetch})}update(e,{count:r}={}){var n;const s="PATCH";return r&&this.headers.append("Prefer",`count=${r}`),new Hg.default({method:s,url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:(n=this.fetch)!==null&&n!==void 0?n:fetch})}delete({count:e}={}){var r;const n="DELETE";return e&&this.headers.append("Prefer",`count=${e}`),new Hg.default({method:n,url:this.url,headers:this.headers,schema:this.schema,fetch:(r=this.fetch)!==null&&r!==void 0?r:fetch})}};i1.default=fK;var rN=Po&&Po.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(IP,"__esModule",{value:!0});const pK=rN(i1),mK=rN(H0);let gK=class nN{constructor(e,{headers:r={},schema:n,fetch:s}={}){this.url=e,this.headers=new Headers(r),this.schemaName=n,this.fetch=s}from(e){const r=new URL(`${this.url}/${e}`);return new pK.default(r,{headers:new Headers(this.headers),schema:this.schemaName,fetch:this.fetch})}schema(e){return new nN(this.url,{headers:this.headers,schema:e,fetch:this.fetch})}rpc(e,r={},{head:n=!1,get:s=!1,count:c}={}){var l;let a;const m=new URL(`${this.url}/rpc/${e}`);let y;n||s?(a=n?"HEAD":"GET",Object.entries(r).filter(([T,P])=>P!==void 0).map(([T,P])=>[T,Array.isArray(P)?`{${P.join(",")}}`:`${P}`]).forEach(([T,P])=>{m.searchParams.append(T,P)})):(a="POST",y=r);const v=new Headers(this.headers);return c&&v.set("Prefer",`count=${c}`),new mK.default({method:a,url:m,headers:v,schema:this.schemaName,body:y,fetch:(l=this.fetch)!==null&&l!==void 0?l:fetch})}};IP.default=gK;var wm=Po&&Po.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(Ws,"__esModule",{value:!0});Ws.PostgrestError=Ws.PostgrestBuilder=Ws.PostgrestTransformBuilder=Ws.PostgrestFilterBuilder=Ws.PostgrestQueryBuilder=Ws.PostgrestClient=void 0;const iN=wm(IP);Ws.PostgrestClient=iN.default;const sN=wm(i1);Ws.PostgrestQueryBuilder=sN.default;const oN=wm(H0);Ws.PostgrestFilterBuilder=oN.default;const aN=wm(s1);Ws.PostgrestTransformBuilder=aN.default;const lN=wm(o1);Ws.PostgrestBuilder=lN.default;const cN=wm(a1);Ws.PostgrestError=cN.default;var yK=Ws.default={PostgrestClient:iN.default,PostgrestQueryBuilder:sN.default,PostgrestFilterBuilder:oN.default,PostgrestTransformBuilder:aN.default,PostgrestBuilder:lN.default,PostgrestError:cN.default};const{PostgrestClient:_K,PostgrestQueryBuilder:Cue,PostgrestFilterBuilder:Pue,PostgrestTransformBuilder:Aue,PostgrestBuilder:kue,PostgrestError:Mue}=yK;class vK{static detectEnvironment(){var e;if(typeof WebSocket<"u")return{type:"native",constructor:WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocket<"u")return{type:"native",constructor:globalThis.WebSocket};if(typeof global<"u"&&typeof global.WebSocket<"u")return{type:"native",constructor:global.WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocketPair<"u"&&typeof globalThis.WebSocket>"u")return{type:"cloudflare",error:"Cloudflare Workers detected. WebSocket clients are not supported in Cloudflare Workers.",workaround:"Use Cloudflare Workers WebSocket API for server-side WebSocket handling, or deploy to a different runtime."};if(typeof globalThis<"u"&&globalThis.EdgeRuntime||typeof navigator<"u"&&(!((e=navigator.userAgent)===null||e===void 0)&&e.includes("Vercel-Edge")))return{type:"unsupported",error:"Edge runtime detected (Vercel Edge/Netlify Edge). WebSockets are not supported in edge functions.",workaround:"Use serverless functions or a different deployment target for WebSocket functionality."};if(typeof process<"u"){const r=process.versions;if(r&&r.node){const n=r.node,s=parseInt(n.replace(/^v/,"").split(".")[0]);return s>=22?typeof globalThis.WebSocket<"u"?{type:"native",constructor:globalThis.WebSocket}:{type:"unsupported",error:`Node.js ${s} detected but native WebSocket not found.`,workaround:"Provide a WebSocket implementation via the transport option."}:{type:"unsupported",error:`Node.js ${s} detected without native WebSocket support.`,workaround:`For Node.js < 22, install "ws" package and provide it via the transport option:
import ws from "ws"
new RealtimeClient(url, { transport: ws })`}}}return{type:"unsupported",error:"Unknown JavaScript runtime without WebSocket support.",workaround:"Ensure you're running in a supported environment (browser, Node.js, Deno) or provide a custom WebSocket implementation."}}static getWebSocketConstructor(){const e=this.detectEnvironment();if(e.constructor)return e.constructor;let r=e.error||"WebSocket not supported in this environment.";throw e.workaround&&(r+=`

Suggested solution: ${e.workaround}`),new Error(r)}static createWebSocket(e,r){const n=this.getWebSocketConstructor();return new n(e,r)}static isWebSocketSupported(){try{const e=this.detectEnvironment();return e.type==="native"||e.type==="ws"}catch{return!1}}}const xK="2.75.1",bK=`realtime-js/${xK}`,wK="1.0.0",qT=1e4,SK=1e3,TK=100;var Ay;(function(t){t[t.connecting=0]="connecting",t[t.open=1]="open",t[t.closing=2]="closing",t[t.closed=3]="closed"})(Ay||(Ay={}));var Ai;(function(t){t.closed="closed",t.errored="errored",t.joined="joined",t.joining="joining",t.leaving="leaving"})(Ai||(Ai={}));var ba;(function(t){t.close="phx_close",t.error="phx_error",t.join="phx_join",t.reply="phx_reply",t.leave="phx_leave",t.access_token="access_token"})(ba||(ba={}));var HT;(function(t){t.websocket="websocket"})(HT||(HT={}));var Wh;(function(t){t.Connecting="connecting",t.Open="open",t.Closing="closing",t.Closed="closed"})(Wh||(Wh={}));class EK{constructor(){this.HEADER_LENGTH=1}decode(e,r){return e.constructor===ArrayBuffer?r(this._binaryDecode(e)):r(typeof e=="string"?JSON.parse(e):{})}_binaryDecode(e){const r=new DataView(e),n=new TextDecoder;return this._decodeBroadcast(e,r,n)}_decodeBroadcast(e,r,n){const s=r.getUint8(1),c=r.getUint8(2);let l=this.HEADER_LENGTH+2;const a=n.decode(e.slice(l,l+s));l=l+s;const m=n.decode(e.slice(l,l+c));l=l+c;const y=JSON.parse(n.decode(e.slice(l,e.byteLength)));return{ref:null,topic:a,event:m,payload:y}}}class uN{constructor(e,r){this.callback=e,this.timerCalc=r,this.timer=void 0,this.tries=0,this.callback=e,this.timerCalc=r}reset(){this.tries=0,clearTimeout(this.timer),this.timer=void 0}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var an;(function(t){t.abstime="abstime",t.bool="bool",t.date="date",t.daterange="daterange",t.float4="float4",t.float8="float8",t.int2="int2",t.int4="int4",t.int4range="int4range",t.int8="int8",t.int8range="int8range",t.json="json",t.jsonb="jsonb",t.money="money",t.numeric="numeric",t.oid="oid",t.reltime="reltime",t.text="text",t.time="time",t.timestamp="timestamp",t.timestamptz="timestamptz",t.timetz="timetz",t.tsrange="tsrange",t.tstzrange="tstzrange"})(an||(an={}));const HR=(t,e,r={})=>{var n;const s=(n=r.skipTypes)!==null&&n!==void 0?n:[];return e?Object.keys(e).reduce((c,l)=>(c[l]=CK(l,t,e,s),c),{}):{}},CK=(t,e,r,n)=>{const s=e.find(a=>a.name===t),c=s==null?void 0:s.type,l=r[t];return c&&!n.includes(c)?hN(c,l):ZT(l)},hN=(t,e)=>{if(t.charAt(0)==="_"){const r=t.slice(1,t.length);return MK(e,r)}switch(t){case an.bool:return PK(e);case an.float4:case an.float8:case an.int2:case an.int4:case an.int8:case an.numeric:case an.oid:return AK(e);case an.json:case an.jsonb:return kK(e);case an.timestamp:return IK(e);case an.abstime:case an.date:case an.daterange:case an.int4range:case an.int8range:case an.money:case an.reltime:case an.text:case an.time:case an.timestamptz:case an.timetz:case an.tsrange:case an.tstzrange:return ZT(e);default:return ZT(e)}},ZT=t=>t,PK=t=>{switch(t){case"t":return!0;case"f":return!1;default:return t}},AK=t=>{if(typeof t=="string"){const e=parseFloat(t);if(!Number.isNaN(e))return e}return t},kK=t=>{if(typeof t=="string")try{return JSON.parse(t)}catch(e){return console.log(`JSON parse error: ${e}`),t}return t},MK=(t,e)=>{if(typeof t!="string")return t;const r=t.length-1,n=t[r];if(t[0]==="{"&&n==="}"){let c;const l=t.slice(1,r);try{c=JSON.parse("["+l+"]")}catch{c=l?l.split(","):[]}return c.map(a=>hN(e,a))}return t},IK=t=>typeof t=="string"?t.replace(" ","T"):t,dN=t=>{let e=t;return e=e.replace(/^ws/i,"http"),e=e.replace(/(\/socket\/websocket|\/socket|\/websocket)\/?$/i,""),e.replace(/\/+$/,"")+"/api/broadcast"};class z2{constructor(e,r,n={},s=qT){this.channel=e,this.event=r,this.payload=n,this.timeout=s,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(e){this.timeout=e,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(e){this.payload=Object.assign(Object.assign({},this.payload),e)}receive(e,r){var n;return this._hasReceived(e)&&r((n=this.receivedResp)===null||n===void 0?void 0:n.response),this.recHooks.push({status:e,callback:r}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const e=r=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=r,this._matchReceive(r)};this.channel._on(this.refEvent,{},e),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(e,r){this.refEvent&&this.channel._trigger(this.refEvent,{status:e,response:r})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:e,response:r}){this.recHooks.filter(n=>n.status===e).forEach(n=>n.callback(r))}_hasReceived(e){return this.receivedResp&&this.receivedResp.status===e}}var ZR;(function(t){t.SYNC="sync",t.JOIN="join",t.LEAVE="leave"})(ZR||(ZR={}));class ky{constructor(e,r){this.channel=e,this.state={},this.pendingDiffs=[],this.joinRef=null,this.enabled=!1,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const n=(r==null?void 0:r.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(n.state,{},s=>{const{onJoin:c,onLeave:l,onSync:a}=this.caller;this.joinRef=this.channel._joinRef(),this.state=ky.syncState(this.state,s,c,l),this.pendingDiffs.forEach(m=>{this.state=ky.syncDiff(this.state,m,c,l)}),this.pendingDiffs=[],a()}),this.channel._on(n.diff,{},s=>{const{onJoin:c,onLeave:l,onSync:a}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(s):(this.state=ky.syncDiff(this.state,s,c,l),a())}),this.onJoin((s,c,l)=>{this.channel._trigger("presence",{event:"join",key:s,currentPresences:c,newPresences:l})}),this.onLeave((s,c,l)=>{this.channel._trigger("presence",{event:"leave",key:s,currentPresences:c,leftPresences:l})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(e,r,n,s){const c=this.cloneDeep(e),l=this.transformState(r),a={},m={};return this.map(c,(y,v)=>{l[y]||(m[y]=v)}),this.map(l,(y,v)=>{const T=c[y];if(T){const P=v.map(L=>L.presence_ref),A=T.map(L=>L.presence_ref),O=v.filter(L=>A.indexOf(L.presence_ref)<0),I=T.filter(L=>P.indexOf(L.presence_ref)<0);O.length>0&&(a[y]=O),I.length>0&&(m[y]=I)}else a[y]=v}),this.syncDiff(c,{joins:a,leaves:m},n,s)}static syncDiff(e,r,n,s){const{joins:c,leaves:l}={joins:this.transformState(r.joins),leaves:this.transformState(r.leaves)};return n||(n=()=>{}),s||(s=()=>{}),this.map(c,(a,m)=>{var y;const v=(y=e[a])!==null&&y!==void 0?y:[];if(e[a]=this.cloneDeep(m),v.length>0){const T=e[a].map(A=>A.presence_ref),P=v.filter(A=>T.indexOf(A.presence_ref)<0);e[a].unshift(...P)}n(a,v,m)}),this.map(l,(a,m)=>{let y=e[a];if(!y)return;const v=m.map(T=>T.presence_ref);y=y.filter(T=>v.indexOf(T.presence_ref)<0),e[a]=y,s(a,y,m),y.length===0&&delete e[a]}),e}static map(e,r){return Object.getOwnPropertyNames(e).map(n=>r(n,e[n]))}static transformState(e){return e=this.cloneDeep(e),Object.getOwnPropertyNames(e).reduce((r,n)=>{const s=e[n];return"metas"in s?r[n]=s.metas.map(c=>(c.presence_ref=c.phx_ref,delete c.phx_ref,delete c.phx_ref_prev,c)):r[n]=s,r},{})}static cloneDeep(e){return JSON.parse(JSON.stringify(e))}onJoin(e){this.caller.onJoin=e}onLeave(e){this.caller.onLeave=e}onSync(e){this.caller.onSync=e}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var KR;(function(t){t.ALL="*",t.INSERT="INSERT",t.UPDATE="UPDATE",t.DELETE="DELETE"})(KR||(KR={}));var My;(function(t){t.BROADCAST="broadcast",t.PRESENCE="presence",t.POSTGRES_CHANGES="postgres_changes",t.SYSTEM="system"})(My||(My={}));var Gl;(function(t){t.SUBSCRIBED="SUBSCRIBED",t.TIMED_OUT="TIMED_OUT",t.CLOSED="CLOSED",t.CHANNEL_ERROR="CHANNEL_ERROR"})(Gl||(Gl={}));class RP{constructor(e,r={config:{}},n){var s,c;if(this.topic=e,this.params=r,this.socket=n,this.bindings={},this.state=Ai.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=e.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:"",enabled:!1},private:!1},r.config),this.timeout=this.socket.timeout,this.joinPush=new z2(this,ba.join,this.params,this.timeout),this.rejoinTimer=new uN(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=Ai.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(l=>l.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=Ai.closed,this.socket._remove(this)}),this._onError(l=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,l),this.state=Ai.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=Ai.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("error",l=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,l),this.state=Ai.errored,this.rejoinTimer.scheduleTimeout())}),this._on(ba.reply,{},(l,a)=>{this._trigger(this._replyEventName(a),l)}),this.presence=new ky(this),this.broadcastEndpointURL=dN(this.socket.endPoint),this.private=this.params.config.private||!1,!this.private&&(!((c=(s=this.params.config)===null||s===void 0?void 0:s.broadcast)===null||c===void 0)&&c.replay))throw`tried to use replay on public channel '${this.topic}'. It must be a private channel.`}subscribe(e,r=this.timeout){var n,s,c;if(this.socket.isConnected()||this.socket.connect(),this.state==Ai.closed){const{config:{broadcast:l,presence:a,private:m}}=this.params,y=(s=(n=this.bindings.postgres_changes)===null||n===void 0?void 0:n.map(A=>A.filter))!==null&&s!==void 0?s:[],v=!!this.bindings[My.PRESENCE]&&this.bindings[My.PRESENCE].length>0||((c=this.params.config.presence)===null||c===void 0?void 0:c.enabled)===!0,T={},P={broadcast:l,presence:Object.assign(Object.assign({},a),{enabled:v}),postgres_changes:y,private:m};this.socket.accessTokenValue&&(T.access_token=this.socket.accessTokenValue),this._onError(A=>e==null?void 0:e(Gl.CHANNEL_ERROR,A)),this._onClose(()=>e==null?void 0:e(Gl.CLOSED)),this.updateJoinPayload(Object.assign({config:P},T)),this.joinedOnce=!0,this._rejoin(r),this.joinPush.receive("ok",async({postgres_changes:A})=>{var O;if(this.socket.setAuth(),A===void 0){e==null||e(Gl.SUBSCRIBED);return}else{const I=this.bindings.postgres_changes,L=(O=I==null?void 0:I.length)!==null&&O!==void 0?O:0,R=[];for(let z=0;z<L;z++){const j=I[z],{filter:{event:W,schema:Z,table:te,filter:ie}}=j,V=A&&A[z];if(V&&V.event===W&&V.schema===Z&&V.table===te&&V.filter===ie)R.push(Object.assign(Object.assign({},j),{id:V.id}));else{this.unsubscribe(),this.state=Ai.errored,e==null||e(Gl.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=R,e&&e(Gl.SUBSCRIBED);return}}).receive("error",A=>{this.state=Ai.errored,e==null||e(Gl.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(A).join(", ")||"error")))}).receive("timeout",()=>{e==null||e(Gl.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(e,r={}){return await this.send({type:"presence",event:"track",payload:e},r.timeout||this.timeout)}async untrack(e={}){return await this.send({type:"presence",event:"untrack"},e)}on(e,r,n){return this.state===Ai.joined&&e===My.PRESENCE&&(this.socket.log("channel",`resubscribe to ${this.topic} due to change in presence callbacks on joined channel`),this.unsubscribe().then(()=>this.subscribe())),this._on(e,r,n)}async send(e,r={}){var n,s;if(!this._canPush()&&e.type==="broadcast"){const{event:c,payload:l}=e,m={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:c,payload:l,private:this.private}]})};try{const y=await this._fetchWithTimeout(this.broadcastEndpointURL,m,(n=r.timeout)!==null&&n!==void 0?n:this.timeout);return await((s=y.body)===null||s===void 0?void 0:s.cancel()),y.ok?"ok":"error"}catch(y){return y.name==="AbortError"?"timed out":"error"}}else return new Promise(c=>{var l,a,m;const y=this._push(e.type,e,r.timeout||this.timeout);e.type==="broadcast"&&!(!((m=(a=(l=this.params)===null||l===void 0?void 0:l.config)===null||a===void 0?void 0:a.broadcast)===null||m===void 0)&&m.ack)&&c("ok"),y.receive("ok",()=>c("ok")),y.receive("error",()=>c("error")),y.receive("timeout",()=>c("timed out"))})}updateJoinPayload(e){this.joinPush.updatePayload(e)}unsubscribe(e=this.timeout){this.state=Ai.leaving;const r=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(ba.close,"leave",this._joinRef())};this.joinPush.destroy();let n=null;return new Promise(s=>{n=new z2(this,ba.leave,{},e),n.receive("ok",()=>{r(),s("ok")}).receive("timeout",()=>{r(),s("timed out")}).receive("error",()=>{s("error")}),n.send(),this._canPush()||n.trigger("ok",{})}).finally(()=>{n==null||n.destroy()})}teardown(){this.pushBuffer.forEach(e=>e.destroy()),this.pushBuffer=[],this.rejoinTimer.reset(),this.joinPush.destroy(),this.state=Ai.closed,this.bindings={}}async _fetchWithTimeout(e,r,n){const s=new AbortController,c=setTimeout(()=>s.abort(),n),l=await this.socket.fetch(e,Object.assign(Object.assign({},r),{signal:s.signal}));return clearTimeout(c),l}_push(e,r,n=this.timeout){if(!this.joinedOnce)throw`tried to push '${e}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let s=new z2(this,e,r,n);return this._canPush()?s.send():this._addToPushBuffer(s),s}_addToPushBuffer(e){if(e.startTimeout(),this.pushBuffer.push(e),this.pushBuffer.length>TK){const r=this.pushBuffer.shift();r&&(r.destroy(),this.socket.log("channel",`discarded push due to buffer overflow: ${r.event}`,r.payload))}}_onMessage(e,r,n){return r}_isMember(e){return this.topic===e}_joinRef(){return this.joinPush.ref}_trigger(e,r,n){var s,c;const l=e.toLocaleLowerCase(),{close:a,error:m,leave:y,join:v}=ba;if(n&&[a,m,y,v].indexOf(l)>=0&&n!==this._joinRef())return;let P=this._onMessage(l,r,n);if(r&&!P)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(l)?(s=this.bindings.postgres_changes)===null||s===void 0||s.filter(A=>{var O,I,L;return((O=A.filter)===null||O===void 0?void 0:O.event)==="*"||((L=(I=A.filter)===null||I===void 0?void 0:I.event)===null||L===void 0?void 0:L.toLocaleLowerCase())===l}).map(A=>A.callback(P,n)):(c=this.bindings[l])===null||c===void 0||c.filter(A=>{var O,I,L,R,z,j;if(["broadcast","presence","postgres_changes"].includes(l))if("id"in A){const W=A.id,Z=(O=A.filter)===null||O===void 0?void 0:O.event;return W&&((I=r.ids)===null||I===void 0?void 0:I.includes(W))&&(Z==="*"||(Z==null?void 0:Z.toLocaleLowerCase())===((L=r.data)===null||L===void 0?void 0:L.type.toLocaleLowerCase()))}else{const W=(z=(R=A==null?void 0:A.filter)===null||R===void 0?void 0:R.event)===null||z===void 0?void 0:z.toLocaleLowerCase();return W==="*"||W===((j=r==null?void 0:r.event)===null||j===void 0?void 0:j.toLocaleLowerCase())}else return A.type.toLocaleLowerCase()===l}).map(A=>{if(typeof P=="object"&&"ids"in P){const O=P.data,{schema:I,table:L,commit_timestamp:R,type:z,errors:j}=O;P=Object.assign(Object.assign({},{schema:I,table:L,commit_timestamp:R,eventType:z,new:{},old:{},errors:j}),this._getPayloadRecords(O))}A.callback(P,n)})}_isClosed(){return this.state===Ai.closed}_isJoined(){return this.state===Ai.joined}_isJoining(){return this.state===Ai.joining}_isLeaving(){return this.state===Ai.leaving}_replyEventName(e){return`chan_reply_${e}`}_on(e,r,n){const s=e.toLocaleLowerCase(),c={type:s,filter:r,callback:n};return this.bindings[s]?this.bindings[s].push(c):this.bindings[s]=[c],this}_off(e,r){const n=e.toLocaleLowerCase();return this.bindings[n]&&(this.bindings[n]=this.bindings[n].filter(s=>{var c;return!(((c=s.type)===null||c===void 0?void 0:c.toLocaleLowerCase())===n&&RP.isEqual(s.filter,r))})),this}static isEqual(e,r){if(Object.keys(e).length!==Object.keys(r).length)return!1;for(const n in e)if(e[n]!==r[n])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(e){this._on(ba.close,{},e)}_onError(e){this._on(ba.error,{},r=>e(r))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(e=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=Ai.joining,this.joinPush.resend(e))}_getPayloadRecords(e){const r={new:{},old:{}};return(e.type==="INSERT"||e.type==="UPDATE")&&(r.new=HR(e.columns,e.record)),(e.type==="UPDATE"||e.type==="DELETE")&&(r.old=HR(e.columns,e.old_record)),r}}const N2=()=>{},jv={HEARTBEAT_INTERVAL:25e3,RECONNECT_DELAY:10,HEARTBEAT_TIMEOUT_FALLBACK:100},RK=[1e3,2e3,5e3,1e4],DK=1e4,LK=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class OK{constructor(e,r){var n;if(this.accessTokenValue=null,this.apiKey=null,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=qT,this.transport=null,this.heartbeatIntervalMs=jv.HEARTBEAT_INTERVAL,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=N2,this.ref=0,this.reconnectTimer=null,this.logger=N2,this.conn=null,this.sendBuffer=[],this.serializer=new EK,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._connectionState="disconnected",this._wasManualDisconnect=!1,this._authPromise=null,this._resolveFetch=s=>{let c;return s?c=s:typeof fetch>"u"?c=(...l)=>q0(async()=>{const{default:a}=await Promise.resolve().then(()=>bm);return{default:a}},void 0).then(({default:a})=>a(...l)).catch(a=>{throw new Error(`Failed to load @supabase/node-fetch: ${a.message}. This is required for HTTP requests in Node.js environments without native fetch.`)}):c=fetch,(...l)=>c(...l)},!(!((n=r==null?void 0:r.params)===null||n===void 0)&&n.apikey))throw new Error("API key is required to connect to Realtime");this.apiKey=r.params.apikey,this.endPoint=`${e}/${HT.websocket}`,this.httpEndpoint=dN(e),this._initializeOptions(r),this._setupReconnectionTimer(),this.fetch=this._resolveFetch(r==null?void 0:r.fetch)}connect(){if(!(this.isConnecting()||this.isDisconnecting()||this.conn!==null&&this.isConnected())){if(this._setConnectionState("connecting"),this._setAuthSafely("connect"),this.transport)this.conn=new this.transport(this.endpointURL());else try{this.conn=vK.createWebSocket(this.endpointURL())}catch(e){this._setConnectionState("disconnected");const r=e.message;throw r.includes("Node.js")?new Error(`${r}

To use Realtime in Node.js, you need to provide a WebSocket implementation:

Option 1: Use Node.js 22+ which has native WebSocket support
Option 2: Install and provide the "ws" package:

  npm install ws

  import ws from "ws"
  const client = new RealtimeClient(url, {
    ...options,
    transport: ws
  })`):new Error(`WebSocket not available: ${r}`)}this._setupConnectionHandlers()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:wK}))}disconnect(e,r){if(!this.isDisconnecting())if(this._setConnectionState("disconnecting",!0),this.conn){const n=setTimeout(()=>{this._setConnectionState("disconnected")},100);this.conn.onclose=()=>{clearTimeout(n),this._setConnectionState("disconnected")},e?this.conn.close(e,r??""):this.conn.close(),this._teardownConnection()}else this._setConnectionState("disconnected")}getChannels(){return this.channels}async removeChannel(e){const r=await e.unsubscribe();return this.channels.length===0&&this.disconnect(),r}async removeAllChannels(){const e=await Promise.all(this.channels.map(r=>r.unsubscribe()));return this.channels=[],this.disconnect(),e}log(e,r,n){this.logger(e,r,n)}connectionState(){switch(this.conn&&this.conn.readyState){case Ay.connecting:return Wh.Connecting;case Ay.open:return Wh.Open;case Ay.closing:return Wh.Closing;default:return Wh.Closed}}isConnected(){return this.connectionState()===Wh.Open}isConnecting(){return this._connectionState==="connecting"}isDisconnecting(){return this._connectionState==="disconnecting"}channel(e,r={config:{}}){const n=`realtime:${e}`,s=this.getChannels().find(c=>c.topic===n);if(s)return s;{const c=new RP(`realtime:${e}`,r,this);return this.channels.push(c),c}}push(e){const{topic:r,event:n,payload:s,ref:c}=e,l=()=>{this.encode(e,a=>{var m;(m=this.conn)===null||m===void 0||m.send(a)})};this.log("push",`${r} ${n} (${c})`,s),this.isConnected()?l():this.sendBuffer.push(l)}async setAuth(e=null){this._authPromise=this._performAuth(e);try{await this._authPromise}finally{this._authPromise=null}}async sendHeartbeat(){var e;if(!this.isConnected()){try{this.heartbeatCallback("disconnected")}catch(r){this.log("error","error in heartbeat callback",r)}return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection");try{this.heartbeatCallback("timeout")}catch(r){this.log("error","error in heartbeat callback",r)}this._wasManualDisconnect=!1,(e=this.conn)===null||e===void 0||e.close(SK,"heartbeat timeout"),setTimeout(()=>{var r;this.isConnected()||(r=this.reconnectTimer)===null||r===void 0||r.scheduleTimeout()},jv.HEARTBEAT_TIMEOUT_FALLBACK);return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef});try{this.heartbeatCallback("sent")}catch(r){this.log("error","error in heartbeat callback",r)}this._setAuthSafely("heartbeat")}onHeartbeat(e){this.heartbeatCallback=e}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(e=>e()),this.sendBuffer=[])}_makeRef(){let e=this.ref+1;return e===this.ref?this.ref=0:this.ref=e,this.ref.toString()}_leaveOpenTopic(e){let r=this.channels.find(n=>n.topic===e&&(n._isJoined()||n._isJoining()));r&&(this.log("transport",`leaving duplicate topic "${e}"`),r.unsubscribe())}_remove(e){this.channels=this.channels.filter(r=>r.topic!==e.topic)}_onConnMessage(e){this.decode(e.data,r=>{if(r.topic==="phoenix"&&r.event==="phx_reply")try{this.heartbeatCallback(r.payload.status==="ok"?"ok":"error")}catch(y){this.log("error","error in heartbeat callback",y)}r.ref&&r.ref===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null);const{topic:n,event:s,payload:c,ref:l}=r,a=l?`(${l})`:"",m=c.status||"";this.log("receive",`${m} ${n} ${s} ${a}`.trim(),c),this.channels.filter(y=>y._isMember(n)).forEach(y=>y._trigger(s,c,l)),this._triggerStateCallbacks("message",r)})}_clearTimer(e){var r;e==="heartbeat"&&this.heartbeatTimer?(clearInterval(this.heartbeatTimer),this.heartbeatTimer=void 0):e==="reconnect"&&((r=this.reconnectTimer)===null||r===void 0||r.reset())}_clearAllTimers(){this._clearTimer("heartbeat"),this._clearTimer("reconnect")}_setupConnectionHandlers(){this.conn&&("binaryType"in this.conn&&(this.conn.binaryType="arraybuffer"),this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=e=>this._onConnError(e),this.conn.onmessage=e=>this._onConnMessage(e),this.conn.onclose=e=>this._onConnClose(e))}_teardownConnection(){this.conn&&(this.conn.onopen=null,this.conn.onerror=null,this.conn.onmessage=null,this.conn.onclose=null,this.conn=null),this._clearAllTimers(),this.channels.forEach(e=>e.teardown())}_onConnOpen(){this._setConnectionState("connected"),this.log("transport",`connected to ${this.endpointURL()}`),this.flushSendBuffer(),this._clearTimer("reconnect"),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this._triggerStateCallbacks("open")}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const e=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(e),this.workerRef.onerror=r=>{this.log("worker","worker error",r.message),this.workerRef.terminate()},this.workerRef.onmessage=r=>{r.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_onConnClose(e){var r;this._setConnectionState("disconnected"),this.log("transport","close",e),this._triggerChanError(),this._clearTimer("heartbeat"),this._wasManualDisconnect||(r=this.reconnectTimer)===null||r===void 0||r.scheduleTimeout(),this._triggerStateCallbacks("close",e)}_onConnError(e){this._setConnectionState("disconnected"),this.log("transport",`${e}`),this._triggerChanError(),this._triggerStateCallbacks("error",e)}_triggerChanError(){this.channels.forEach(e=>e._trigger(ba.error))}_appendParams(e,r){if(Object.keys(r).length===0)return e;const n=e.match(/\?/)?"&":"?",s=new URLSearchParams(r);return`${e}${n}${s}`}_workerObjectUrl(e){let r;if(e)r=e;else{const n=new Blob([LK],{type:"application/javascript"});r=URL.createObjectURL(n)}return r}_setConnectionState(e,r=!1){this._connectionState=e,e==="connecting"?this._wasManualDisconnect=!1:e==="disconnecting"&&(this._wasManualDisconnect=r)}async _performAuth(e=null){let r;e?r=e:this.accessToken?r=await this.accessToken():r=this.accessTokenValue,this.accessTokenValue!=r&&(this.accessTokenValue=r,this.channels.forEach(n=>{const s={access_token:r,version:bK};r&&n.updateJoinPayload(s),n.joinedOnce&&n._isJoined()&&n._push(ba.access_token,{access_token:r})}))}async _waitForAuthIfNeeded(){this._authPromise&&await this._authPromise}_setAuthSafely(e="general"){this.setAuth().catch(r=>{this.log("error",`error setting auth in ${e}`,r)})}_triggerStateCallbacks(e,r){try{this.stateChangeCallbacks[e].forEach(n=>{try{n(r)}catch(s){this.log("error",`error in ${e} callback`,s)}})}catch(n){this.log("error",`error triggering ${e} callbacks`,n)}}_setupReconnectionTimer(){this.reconnectTimer=new uN(async()=>{setTimeout(async()=>{await this._waitForAuthIfNeeded(),this.isConnected()||this.connect()},jv.RECONNECT_DELAY)},this.reconnectAfterMs)}_initializeOptions(e){var r,n,s,c,l,a,m,y,v;if(this.transport=(r=e==null?void 0:e.transport)!==null&&r!==void 0?r:null,this.timeout=(n=e==null?void 0:e.timeout)!==null&&n!==void 0?n:qT,this.heartbeatIntervalMs=(s=e==null?void 0:e.heartbeatIntervalMs)!==null&&s!==void 0?s:jv.HEARTBEAT_INTERVAL,this.worker=(c=e==null?void 0:e.worker)!==null&&c!==void 0?c:!1,this.accessToken=(l=e==null?void 0:e.accessToken)!==null&&l!==void 0?l:null,this.heartbeatCallback=(a=e==null?void 0:e.heartbeatCallback)!==null&&a!==void 0?a:N2,e!=null&&e.params&&(this.params=e.params),e!=null&&e.logger&&(this.logger=e.logger),(e!=null&&e.logLevel||e!=null&&e.log_level)&&(this.logLevel=e.logLevel||e.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),this.reconnectAfterMs=(m=e==null?void 0:e.reconnectAfterMs)!==null&&m!==void 0?m:T=>RK[T-1]||DK,this.encode=(y=e==null?void 0:e.encode)!==null&&y!==void 0?y:(T,P)=>P(JSON.stringify(T)),this.decode=(v=e==null?void 0:e.decode)!==null&&v!==void 0?v:this.serializer.decode.bind(this.serializer),this.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.workerUrl=e==null?void 0:e.workerUrl}}}class DP extends Error{constructor(e){super(e),this.__isStorageError=!0,this.name="StorageError"}}function fi(t){return typeof t=="object"&&t!==null&&"__isStorageError"in t}class zK extends DP{constructor(e,r,n){super(e),this.name="StorageApiError",this.status=r,this.statusCode=n}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}}class KT extends DP{constructor(e,r){super(e),this.name="StorageUnknownError",this.originalError=r}}var NK=function(t,e,r,n){function s(c){return c instanceof r?c:new r(function(l){l(c)})}return new(r||(r=Promise))(function(c,l){function a(v){try{y(n.next(v))}catch(T){l(T)}}function m(v){try{y(n.throw(v))}catch(T){l(T)}}function y(v){v.done?c(v.value):s(v.value).then(a,m)}y((n=n.apply(t,e||[])).next())})};const fN=t=>{let e;return t?e=t:typeof fetch>"u"?e=(...r)=>q0(async()=>{const{default:n}=await Promise.resolve().then(()=>bm);return{default:n}},void 0).then(({default:n})=>n(...r)):e=fetch,(...r)=>e(...r)},jK=()=>NK(void 0,void 0,void 0,function*(){return typeof Response>"u"?(yield q0(()=>Promise.resolve().then(()=>bm),void 0)).Response:Response}),XT=t=>{if(Array.isArray(t))return t.map(r=>XT(r));if(typeof t=="function"||t!==Object(t))return t;const e={};return Object.entries(t).forEach(([r,n])=>{const s=r.replace(/([-_][a-z])/gi,c=>c.toUpperCase().replace(/[-_]/g,""));e[s]=XT(n)}),e},FK=t=>{if(typeof t!="object"||t===null)return!1;const e=Object.getPrototypeOf(t);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Symbol.toStringTag in t)&&!(Symbol.iterator in t)};var Rd=function(t,e,r,n){function s(c){return c instanceof r?c:new r(function(l){l(c)})}return new(r||(r=Promise))(function(c,l){function a(v){try{y(n.next(v))}catch(T){l(T)}}function m(v){try{y(n.throw(v))}catch(T){l(T)}}function y(v){v.done?c(v.value):s(v.value).then(a,m)}y((n=n.apply(t,e||[])).next())})};const j2=t=>t.msg||t.message||t.error_description||t.error||JSON.stringify(t),BK=(t,e,r)=>Rd(void 0,void 0,void 0,function*(){const n=yield jK();t instanceof n&&!(r!=null&&r.noResolveJson)?t.json().then(s=>{const c=t.status||500,l=(s==null?void 0:s.statusCode)||c+"";e(new zK(j2(s),c,l))}).catch(s=>{e(new KT(j2(s),s))}):e(new KT(j2(t),t))}),$K=(t,e,r,n)=>{const s={method:t,headers:(e==null?void 0:e.headers)||{}};return t==="GET"||!n?s:(FK(n)?(s.headers=Object.assign({"Content-Type":"application/json"},e==null?void 0:e.headers),s.body=JSON.stringify(n)):s.body=n,e!=null&&e.duplex&&(s.duplex=e.duplex),Object.assign(Object.assign({},s),r))};function Z0(t,e,r,n,s,c){return Rd(this,void 0,void 0,function*(){return new Promise((l,a)=>{t(r,$K(e,n,s,c)).then(m=>{if(!m.ok)throw m;return n!=null&&n.noResolveJson?m:m.json()}).then(m=>l(m)).catch(m=>BK(m,a,n))})})}function hb(t,e,r,n){return Rd(this,void 0,void 0,function*(){return Z0(t,"GET",e,r,n)})}function Xa(t,e,r,n,s){return Rd(this,void 0,void 0,function*(){return Z0(t,"POST",e,n,s,r)})}function YT(t,e,r,n,s){return Rd(this,void 0,void 0,function*(){return Z0(t,"PUT",e,n,s,r)})}function VK(t,e,r,n){return Rd(this,void 0,void 0,function*(){return Z0(t,"HEAD",e,Object.assign(Object.assign({},r),{noResolveJson:!0}),n)})}function pN(t,e,r,n,s){return Rd(this,void 0,void 0,function*(){return Z0(t,"DELETE",e,n,s,r)})}var UK=function(t,e,r,n){function s(c){return c instanceof r?c:new r(function(l){l(c)})}return new(r||(r=Promise))(function(c,l){function a(v){try{y(n.next(v))}catch(T){l(T)}}function m(v){try{y(n.throw(v))}catch(T){l(T)}}function y(v){v.done?c(v.value):s(v.value).then(a,m)}y((n=n.apply(t,e||[])).next())})};class GK{constructor(e,r){this.downloadFn=e,this.shouldThrowOnError=r}then(e,r){return this.execute().then(e,r)}execute(){return UK(this,void 0,void 0,function*(){try{return{data:(yield this.downloadFn()).body,error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(fi(e))return{data:null,error:e};throw e}})}}var WK=function(t,e,r,n){function s(c){return c instanceof r?c:new r(function(l){l(c)})}return new(r||(r=Promise))(function(c,l){function a(v){try{y(n.next(v))}catch(T){l(T)}}function m(v){try{y(n.throw(v))}catch(T){l(T)}}function y(v){v.done?c(v.value):s(v.value).then(a,m)}y((n=n.apply(t,e||[])).next())})},mN;class qK{constructor(e,r){this.downloadFn=e,this.shouldThrowOnError=r,this[mN]="BlobDownloadBuilder",this.promise=null}asStream(){return new GK(this.downloadFn,this.shouldThrowOnError)}then(e,r){return this.getPromise().then(e,r)}catch(e){return this.getPromise().catch(e)}finally(e){return this.getPromise().finally(e)}getPromise(){return this.promise||(this.promise=this.execute()),this.promise}execute(){return WK(this,void 0,void 0,function*(){try{return{data:yield(yield this.downloadFn()).blob(),error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(fi(e))return{data:null,error:e};throw e}})}}mN=Symbol.toStringTag;var $s=function(t,e,r,n){function s(c){return c instanceof r?c:new r(function(l){l(c)})}return new(r||(r=Promise))(function(c,l){function a(v){try{y(n.next(v))}catch(T){l(T)}}function m(v){try{y(n.throw(v))}catch(T){l(T)}}function y(v){v.done?c(v.value):s(v.value).then(a,m)}y((n=n.apply(t,e||[])).next())})};const HK={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},XR={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class ZK{constructor(e,r={},n,s){this.shouldThrowOnError=!1,this.url=e,this.headers=r,this.bucketId=n,this.fetch=fN(s)}throwOnError(){return this.shouldThrowOnError=!0,this}uploadOrUpdate(e,r,n,s){return $s(this,void 0,void 0,function*(){try{let c;const l=Object.assign(Object.assign({},XR),s);let a=Object.assign(Object.assign({},this.headers),e==="POST"&&{"x-upsert":String(l.upsert)});const m=l.metadata;typeof Blob<"u"&&n instanceof Blob?(c=new FormData,c.append("cacheControl",l.cacheControl),m&&c.append("metadata",this.encodeMetadata(m)),c.append("",n)):typeof FormData<"u"&&n instanceof FormData?(c=n,c.append("cacheControl",l.cacheControl),m&&c.append("metadata",this.encodeMetadata(m))):(c=n,a["cache-control"]=`max-age=${l.cacheControl}`,a["content-type"]=l.contentType,m&&(a["x-metadata"]=this.toBase64(this.encodeMetadata(m)))),s!=null&&s.headers&&(a=Object.assign(Object.assign({},a),s.headers));const y=this._removeEmptyFolders(r),v=this._getFinalPath(y),T=yield(e=="PUT"?YT:Xa)(this.fetch,`${this.url}/object/${v}`,c,Object.assign({headers:a},l!=null&&l.duplex?{duplex:l.duplex}:{}));return{data:{path:y,id:T.Id,fullPath:T.Key},error:null}}catch(c){if(this.shouldThrowOnError)throw c;if(fi(c))return{data:null,error:c};throw c}})}upload(e,r,n){return $s(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",e,r,n)})}uploadToSignedUrl(e,r,n,s){return $s(this,void 0,void 0,function*(){const c=this._removeEmptyFolders(e),l=this._getFinalPath(c),a=new URL(this.url+`/object/upload/sign/${l}`);a.searchParams.set("token",r);try{let m;const y=Object.assign({upsert:XR.upsert},s),v=Object.assign(Object.assign({},this.headers),{"x-upsert":String(y.upsert)});typeof Blob<"u"&&n instanceof Blob?(m=new FormData,m.append("cacheControl",y.cacheControl),m.append("",n)):typeof FormData<"u"&&n instanceof FormData?(m=n,m.append("cacheControl",y.cacheControl)):(m=n,v["cache-control"]=`max-age=${y.cacheControl}`,v["content-type"]=y.contentType);const T=yield YT(this.fetch,a.toString(),m,{headers:v});return{data:{path:c,fullPath:T.Key},error:null}}catch(m){if(this.shouldThrowOnError)throw m;if(fi(m))return{data:null,error:m};throw m}})}createSignedUploadUrl(e,r){return $s(this,void 0,void 0,function*(){try{let n=this._getFinalPath(e);const s=Object.assign({},this.headers);r!=null&&r.upsert&&(s["x-upsert"]="true");const c=yield Xa(this.fetch,`${this.url}/object/upload/sign/${n}`,{},{headers:s}),l=new URL(this.url+c.url),a=l.searchParams.get("token");if(!a)throw new DP("No token returned by API");return{data:{signedUrl:l.toString(),path:e,token:a},error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(fi(n))return{data:null,error:n};throw n}})}update(e,r,n){return $s(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",e,r,n)})}move(e,r,n){return $s(this,void 0,void 0,function*(){try{return{data:yield Xa(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:e,destinationKey:r,destinationBucket:n==null?void 0:n.destinationBucket},{headers:this.headers}),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(fi(s))return{data:null,error:s};throw s}})}copy(e,r,n){return $s(this,void 0,void 0,function*(){try{return{data:{path:(yield Xa(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:e,destinationKey:r,destinationBucket:n==null?void 0:n.destinationBucket},{headers:this.headers})).Key},error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(fi(s))return{data:null,error:s};throw s}})}createSignedUrl(e,r,n){return $s(this,void 0,void 0,function*(){try{let s=this._getFinalPath(e),c=yield Xa(this.fetch,`${this.url}/object/sign/${s}`,Object.assign({expiresIn:r},n!=null&&n.transform?{transform:n.transform}:{}),{headers:this.headers});const l=n!=null&&n.download?`&download=${n.download===!0?"":n.download}`:"";return c={signedUrl:encodeURI(`${this.url}${c.signedURL}${l}`)},{data:c,error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(fi(s))return{data:null,error:s};throw s}})}createSignedUrls(e,r,n){return $s(this,void 0,void 0,function*(){try{const s=yield Xa(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:r,paths:e},{headers:this.headers}),c=n!=null&&n.download?`&download=${n.download===!0?"":n.download}`:"";return{data:s.map(l=>Object.assign(Object.assign({},l),{signedUrl:l.signedURL?encodeURI(`${this.url}${l.signedURL}${c}`):null})),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(fi(s))return{data:null,error:s};throw s}})}download(e,r){const s=typeof(r==null?void 0:r.transform)<"u"?"render/image/authenticated":"object",c=this.transformOptsToQueryString((r==null?void 0:r.transform)||{}),l=c?`?${c}`:"",a=this._getFinalPath(e),m=()=>hb(this.fetch,`${this.url}/${s}/${a}${l}`,{headers:this.headers,noResolveJson:!0});return new qK(m,this.shouldThrowOnError)}info(e){return $s(this,void 0,void 0,function*(){const r=this._getFinalPath(e);try{const n=yield hb(this.fetch,`${this.url}/object/info/${r}`,{headers:this.headers});return{data:XT(n),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(fi(n))return{data:null,error:n};throw n}})}exists(e){return $s(this,void 0,void 0,function*(){const r=this._getFinalPath(e);try{return yield VK(this.fetch,`${this.url}/object/${r}`,{headers:this.headers}),{data:!0,error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(fi(n)&&n instanceof KT){const s=n.originalError;if([400,404].includes(s==null?void 0:s.status))return{data:!1,error:n}}throw n}})}getPublicUrl(e,r){const n=this._getFinalPath(e),s=[],c=r!=null&&r.download?`download=${r.download===!0?"":r.download}`:"";c!==""&&s.push(c);const a=typeof(r==null?void 0:r.transform)<"u"?"render/image":"object",m=this.transformOptsToQueryString((r==null?void 0:r.transform)||{});m!==""&&s.push(m);let y=s.join("&");return y!==""&&(y=`?${y}`),{data:{publicUrl:encodeURI(`${this.url}/${a}/public/${n}${y}`)}}}remove(e){return $s(this,void 0,void 0,function*(){try{return{data:yield pN(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:e},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(fi(r))return{data:null,error:r};throw r}})}list(e,r,n){return $s(this,void 0,void 0,function*(){try{const s=Object.assign(Object.assign(Object.assign({},HK),r),{prefix:e||""});return{data:yield Xa(this.fetch,`${this.url}/object/list/${this.bucketId}`,s,{headers:this.headers},n),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(fi(s))return{data:null,error:s};throw s}})}listV2(e,r){return $s(this,void 0,void 0,function*(){try{const n=Object.assign({},e);return{data:yield Xa(this.fetch,`${this.url}/object/list-v2/${this.bucketId}`,n,{headers:this.headers},r),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(fi(n))return{data:null,error:n};throw n}})}encodeMetadata(e){return JSON.stringify(e)}toBase64(e){return typeof Buffer<"u"?Buffer.from(e).toString("base64"):btoa(e)}_getFinalPath(e){return`${this.bucketId}/${e.replace(/^\/+/,"")}`}_removeEmptyFolders(e){return e.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(e){const r=[];return e.width&&r.push(`width=${e.width}`),e.height&&r.push(`height=${e.height}`),e.resize&&r.push(`resize=${e.resize}`),e.format&&r.push(`format=${e.format}`),e.quality&&r.push(`quality=${e.quality}`),r.join("&")}}const KK="2.75.1",XK={"X-Client-Info":`storage-js/${KK}`};var Vf=function(t,e,r,n){function s(c){return c instanceof r?c:new r(function(l){l(c)})}return new(r||(r=Promise))(function(c,l){function a(v){try{y(n.next(v))}catch(T){l(T)}}function m(v){try{y(n.throw(v))}catch(T){l(T)}}function y(v){v.done?c(v.value):s(v.value).then(a,m)}y((n=n.apply(t,e||[])).next())})};class YK{constructor(e,r={},n,s){this.shouldThrowOnError=!1;const c=new URL(e);s!=null&&s.useNewHostname&&/supabase\.(co|in|red)$/.test(c.hostname)&&!c.hostname.includes("storage.supabase.")&&(c.hostname=c.hostname.replace("supabase.","storage.supabase.")),this.url=c.href.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},XK),r),this.fetch=fN(n)}throwOnError(){return this.shouldThrowOnError=!0,this}listBuckets(){return Vf(this,void 0,void 0,function*(){try{return{data:yield hb(this.fetch,`${this.url}/bucket`,{headers:this.headers}),error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(fi(e))return{data:null,error:e};throw e}})}getBucket(e){return Vf(this,void 0,void 0,function*(){try{return{data:yield hb(this.fetch,`${this.url}/bucket/${e}`,{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(fi(r))return{data:null,error:r};throw r}})}createBucket(e){return Vf(this,arguments,void 0,function*(r,n={public:!1}){try{return{data:yield Xa(this.fetch,`${this.url}/bucket`,{id:r,name:r,type:n.type,public:n.public,file_size_limit:n.fileSizeLimit,allowed_mime_types:n.allowedMimeTypes},{headers:this.headers}),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(fi(s))return{data:null,error:s};throw s}})}updateBucket(e,r){return Vf(this,void 0,void 0,function*(){try{return{data:yield YT(this.fetch,`${this.url}/bucket/${e}`,{id:e,name:e,public:r.public,file_size_limit:r.fileSizeLimit,allowed_mime_types:r.allowedMimeTypes},{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(fi(n))return{data:null,error:n};throw n}})}emptyBucket(e){return Vf(this,void 0,void 0,function*(){try{return{data:yield Xa(this.fetch,`${this.url}/bucket/${e}/empty`,{},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(fi(r))return{data:null,error:r};throw r}})}deleteBucket(e){return Vf(this,void 0,void 0,function*(){try{return{data:yield pN(this.fetch,`${this.url}/bucket/${e}`,{},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(fi(r))return{data:null,error:r};throw r}})}}class QK extends YK{constructor(e,r={},n,s){super(e,r,n,s)}from(e){return new ZK(this.url,this.headers,e,this.fetch)}}const JK="2.75.1";let sy="";typeof Deno<"u"?sy="deno":typeof document<"u"?sy="web":typeof navigator<"u"&&navigator.product==="ReactNative"?sy="react-native":sy="node";const eX={"X-Client-Info":`supabase-js-${sy}/${JK}`},tX={headers:eX},rX={schema:"public"},nX={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},iX={};var sX=function(t,e,r,n){function s(c){return c instanceof r?c:new r(function(l){l(c)})}return new(r||(r=Promise))(function(c,l){function a(v){try{y(n.next(v))}catch(T){l(T)}}function m(v){try{y(n.throw(v))}catch(T){l(T)}}function y(v){v.done?c(v.value):s(v.value).then(a,m)}y((n=n.apply(t,e||[])).next())})};const oX=t=>{let e;return t?e=t:typeof fetch>"u"?e=J4:e=fetch,(...r)=>e(...r)},aX=()=>typeof Headers>"u"?eN:Headers,lX=(t,e,r)=>{const n=oX(r),s=aX();return(c,l)=>sX(void 0,void 0,void 0,function*(){var a;const m=(a=yield e())!==null&&a!==void 0?a:t;let y=new s(l==null?void 0:l.headers);return y.has("apikey")||y.set("apikey",t),y.has("Authorization")||y.set("Authorization",`Bearer ${m}`),n(c,Object.assign(Object.assign({},l),{headers:y}))})};var cX=function(t,e,r,n){function s(c){return c instanceof r?c:new r(function(l){l(c)})}return new(r||(r=Promise))(function(c,l){function a(v){try{y(n.next(v))}catch(T){l(T)}}function m(v){try{y(n.throw(v))}catch(T){l(T)}}function y(v){v.done?c(v.value):s(v.value).then(a,m)}y((n=n.apply(t,e||[])).next())})};function uX(t){return t.endsWith("/")?t:t+"/"}function hX(t,e){var r,n;const{db:s,auth:c,realtime:l,global:a}=t,{db:m,auth:y,realtime:v,global:T}=e,P={db:Object.assign(Object.assign({},m),s),auth:Object.assign(Object.assign({},y),c),realtime:Object.assign(Object.assign({},v),l),storage:{},global:Object.assign(Object.assign(Object.assign({},T),a),{headers:Object.assign(Object.assign({},(r=T==null?void 0:T.headers)!==null&&r!==void 0?r:{}),(n=a==null?void 0:a.headers)!==null&&n!==void 0?n:{})}),accessToken:()=>cX(this,void 0,void 0,function*(){return""})};return t.accessToken?P.accessToken=t.accessToken:delete P.accessToken,P}function dX(t){const e=t==null?void 0:t.trim();if(!e)throw new Error("supabaseUrl is required.");if(!e.match(/^https?:\/\//i))throw new Error("Invalid supabaseUrl: Must be a valid HTTP or HTTPS URL.");try{return new URL(uX(e))}catch{throw Error("Invalid supabaseUrl: Provided URL is malformed.")}}const gN="2.75.1",ep=30*1e3,QT=3,F2=QT*ep,fX="http://localhost:9999",pX="supabase.auth.token",mX={"X-Client-Info":`gotrue-js/${gN}`},JT="X-Supabase-Api-Version",yN={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},gX=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,yX=10*60*1e3;class h0 extends Error{constructor(e,r,n){super(e),this.__isAuthError=!0,this.name="AuthError",this.status=r,this.code=n}}function Gt(t){return typeof t=="object"&&t!==null&&"__isAuthError"in t}class _X extends h0{constructor(e,r,n){super(e,r,n),this.name="AuthApiError",this.status=r,this.code=n}}function vX(t){return Gt(t)&&t.name==="AuthApiError"}class qh extends h0{constructor(e,r){super(e),this.name="AuthUnknownError",this.originalError=r}}class Bu extends h0{constructor(e,r,n,s){super(e,n,s),this.name=r,this.status=n}}class Kc extends Bu{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function xX(t){return Gt(t)&&t.name==="AuthSessionMissingError"}class Uf extends Bu{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class Fv extends Bu{constructor(e){super(e,"AuthInvalidCredentialsError",400,void 0)}}class Bv extends Bu{constructor(e,r=null){super(e,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function bX(t){return Gt(t)&&t.name==="AuthImplicitGrantRedirectError"}class YR extends Bu{constructor(e,r=null){super(e,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class eE extends Bu{constructor(e,r){super(e,"AuthRetryableFetchError",r,void 0)}}function B2(t){return Gt(t)&&t.name==="AuthRetryableFetchError"}class QR extends Bu{constructor(e,r,n){super(e,"AuthWeakPasswordError",r,"weak_password"),this.reasons=n}}class tE extends Bu{constructor(e){super(e,"AuthInvalidJwtError",400,"invalid_jwt")}}const db="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),JR=` 	
\r=`.split(""),wX=(()=>{const t=new Array(128);for(let e=0;e<t.length;e+=1)t[e]=-1;for(let e=0;e<JR.length;e+=1)t[JR[e].charCodeAt(0)]=-2;for(let e=0;e<db.length;e+=1)t[db[e].charCodeAt(0)]=e;return t})();function eD(t,e,r){if(t!==null)for(e.queue=e.queue<<8|t,e.queuedBits+=8;e.queuedBits>=6;){const n=e.queue>>e.queuedBits-6&63;r(db[n]),e.queuedBits-=6}else if(e.queuedBits>0)for(e.queue=e.queue<<6-e.queuedBits,e.queuedBits=6;e.queuedBits>=6;){const n=e.queue>>e.queuedBits-6&63;r(db[n]),e.queuedBits-=6}}function _N(t,e,r){const n=wX[t];if(n>-1)for(e.queue=e.queue<<6|n,e.queuedBits+=6;e.queuedBits>=8;)r(e.queue>>e.queuedBits-8&255),e.queuedBits-=8;else{if(n===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(t)}"`)}}function tD(t){const e=[],r=l=>{e.push(String.fromCodePoint(l))},n={utf8seq:0,codepoint:0},s={queue:0,queuedBits:0},c=l=>{EX(l,n,r)};for(let l=0;l<t.length;l+=1)_N(t.charCodeAt(l),s,c);return e.join("")}function SX(t,e){if(t<=127){e(t);return}else if(t<=2047){e(192|t>>6),e(128|t&63);return}else if(t<=65535){e(224|t>>12),e(128|t>>6&63),e(128|t&63);return}else if(t<=1114111){e(240|t>>18),e(128|t>>12&63),e(128|t>>6&63),e(128|t&63);return}throw new Error(`Unrecognized Unicode codepoint: ${t.toString(16)}`)}function TX(t,e){for(let r=0;r<t.length;r+=1){let n=t.charCodeAt(r);if(n>55295&&n<=56319){const s=(n-55296)*1024&65535;n=(t.charCodeAt(r+1)-56320&65535|s)+65536,r+=1}SX(n,e)}}function EX(t,e,r){if(e.utf8seq===0){if(t<=127){r(t);return}for(let n=1;n<6;n+=1)if(!(t>>7-n&1)){e.utf8seq=n;break}if(e.utf8seq===2)e.codepoint=t&31;else if(e.utf8seq===3)e.codepoint=t&15;else if(e.utf8seq===4)e.codepoint=t&7;else throw new Error("Invalid UTF-8 sequence");e.utf8seq-=1}else if(e.utf8seq>0){if(t<=127)throw new Error("Invalid UTF-8 sequence");e.codepoint=e.codepoint<<6|t&63,e.utf8seq-=1,e.utf8seq===0&&r(e.codepoint)}}function Mp(t){const e=[],r={queue:0,queuedBits:0},n=s=>{e.push(s)};for(let s=0;s<t.length;s+=1)_N(t.charCodeAt(s),r,n);return new Uint8Array(e)}function CX(t){const e=[];return TX(t,r=>e.push(r)),new Uint8Array(e)}function Jh(t){const e=[],r={queue:0,queuedBits:0},n=s=>{e.push(s)};return t.forEach(s=>eD(s,r,n)),eD(null,r,n),e.join("")}function PX(t){return Math.round(Date.now()/1e3)+t}function AX(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){const e=Math.random()*16|0;return(t=="x"?e:e&3|8).toString(16)})}const go=()=>typeof window<"u"&&typeof document<"u",Rh={tested:!1,writable:!1},vN=()=>{if(!go())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(Rh.tested)return Rh.writable;const t=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(t,t),globalThis.localStorage.removeItem(t),Rh.tested=!0,Rh.writable=!0}catch{Rh.tested=!0,Rh.writable=!1}return Rh.writable};function kX(t){const e={},r=new URL(t);if(r.hash&&r.hash[0]==="#")try{new URLSearchParams(r.hash.substring(1)).forEach((s,c)=>{e[c]=s})}catch{}return r.searchParams.forEach((n,s)=>{e[s]=n}),e}const xN=t=>{let e;return t?e=t:typeof fetch>"u"?e=(...r)=>q0(async()=>{const{default:n}=await Promise.resolve().then(()=>bm);return{default:n}},void 0).then(({default:n})=>n(...r)):e=fetch,(...r)=>e(...r)},MX=t=>typeof t=="object"&&t!==null&&"status"in t&&"ok"in t&&"json"in t&&typeof t.json=="function",tp=async(t,e,r)=>{await t.setItem(e,JSON.stringify(r))},Dh=async(t,e)=>{const r=await t.getItem(e);if(!r)return null;try{return JSON.parse(r)}catch{return r}},qc=async(t,e)=>{await t.removeItem(e)};class l1{constructor(){this.promise=new l1.promiseConstructor((e,r)=>{this.resolve=e,this.reject=r})}}l1.promiseConstructor=Promise;function $2(t){const e=t.split(".");if(e.length!==3)throw new tE("Invalid JWT structure");for(let n=0;n<e.length;n++)if(!gX.test(e[n]))throw new tE("JWT not in base64url format");return{header:JSON.parse(tD(e[0])),payload:JSON.parse(tD(e[1])),signature:Mp(e[2]),raw:{header:e[0],payload:e[1]}}}async function IX(t){return await new Promise(e=>{setTimeout(()=>e(null),t)})}function RX(t,e){return new Promise((n,s)=>{(async()=>{for(let c=0;c<1/0;c++)try{const l=await t(c);if(!e(c,null,l)){n(l);return}}catch(l){if(!e(c,l)){s(l);return}}})()})}function DX(t){return("0"+t.toString(16)).substr(-2)}function LX(){const e=new Uint32Array(56);if(typeof crypto>"u"){const r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",n=r.length;let s="";for(let c=0;c<56;c++)s+=r.charAt(Math.floor(Math.random()*n));return s}return crypto.getRandomValues(e),Array.from(e,DX).join("")}async function OX(t){const r=new TextEncoder().encode(t),n=await crypto.subtle.digest("SHA-256",r),s=new Uint8Array(n);return Array.from(s).map(c=>String.fromCharCode(c)).join("")}async function zX(t){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),t;const r=await OX(t);return btoa(r).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function Gf(t,e,r=!1){const n=LX();let s=n;r&&(s+="/PASSWORD_RECOVERY"),await tp(t,`${e}-code-verifier`,s);const c=await zX(n);return[c,n===c?"plain":"s256"]}const NX=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function jX(t){const e=t.headers.get(JT);if(!e||!e.match(NX))return null;try{return new Date(`${e}T00:00:00.0Z`)}catch{return null}}function FX(t){if(!t)throw new Error("Missing exp claim");const e=Math.floor(Date.now()/1e3);if(t<=e)throw new Error("JWT has expired")}function BX(t){switch(t){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const $X=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function Wf(t){if(!$X.test(t))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function V2(){const t={};return new Proxy(t,{get:(e,r)=>{if(r==="__isUserNotAvailableProxy")return!0;if(typeof r=="symbol"){const n=r.toString();if(n==="Symbol(Symbol.toPrimitive)"||n==="Symbol(Symbol.toStringTag)"||n==="Symbol(util.inspect.custom)")return}throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${r}" property of the session object is not supported. Please use getUser() instead.`)},set:(e,r)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${r}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(e,r)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${r}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}function rD(t){return JSON.parse(JSON.stringify(t))}var VX=function(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,n=Object.getOwnPropertySymbols(t);s<n.length;s++)e.indexOf(n[s])<0&&Object.prototype.propertyIsEnumerable.call(t,n[s])&&(r[n[s]]=t[n[s]]);return r};const $h=t=>t.msg||t.message||t.error_description||t.error||JSON.stringify(t),UX=[502,503,504];async function nD(t){var e;if(!MX(t))throw new eE($h(t),0);if(UX.includes(t.status))throw new eE($h(t),t.status);let r;try{r=await t.json()}catch(c){throw new qh($h(c),c)}let n;const s=jX(t);if(s&&s.getTime()>=yN["2024-01-01"].timestamp&&typeof r=="object"&&r&&typeof r.code=="string"?n=r.code:typeof r=="object"&&r&&typeof r.error_code=="string"&&(n=r.error_code),n){if(n==="weak_password")throw new QR($h(r),t.status,((e=r.weak_password)===null||e===void 0?void 0:e.reasons)||[]);if(n==="session_not_found")throw new Kc}else if(typeof r=="object"&&r&&typeof r.weak_password=="object"&&r.weak_password&&Array.isArray(r.weak_password.reasons)&&r.weak_password.reasons.length&&r.weak_password.reasons.reduce((c,l)=>c&&typeof l=="string",!0))throw new QR($h(r),t.status,r.weak_password.reasons);throw new _X($h(r),t.status||500,n)}const GX=(t,e,r,n)=>{const s={method:t,headers:(e==null?void 0:e.headers)||{}};return t==="GET"?s:(s.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},e==null?void 0:e.headers),s.body=JSON.stringify(n),Object.assign(Object.assign({},s),r))};async function rr(t,e,r,n){var s;const c=Object.assign({},n==null?void 0:n.headers);c[JT]||(c[JT]=yN["2024-01-01"].name),n!=null&&n.jwt&&(c.Authorization=`Bearer ${n.jwt}`);const l=(s=n==null?void 0:n.query)!==null&&s!==void 0?s:{};n!=null&&n.redirectTo&&(l.redirect_to=n.redirectTo);const a=Object.keys(l).length?"?"+new URLSearchParams(l).toString():"",m=await WX(t,e,r+a,{headers:c,noResolveJson:n==null?void 0:n.noResolveJson},{},n==null?void 0:n.body);return n!=null&&n.xform?n==null?void 0:n.xform(m):{data:Object.assign({},m),error:null}}async function WX(t,e,r,n,s,c){const l=GX(e,n,s,c);let a;try{a=await t(r,Object.assign({},l))}catch(m){throw console.error(m),new eE($h(m),0)}if(a.ok||await nD(a),n!=null&&n.noResolveJson)return a;try{return await a.json()}catch(m){await nD(m)}}function pa(t){var e;let r=null;ZX(t)&&(r=Object.assign({},t),t.expires_at||(r.expires_at=PX(t.expires_in)));const n=(e=t.user)!==null&&e!==void 0?e:t;return{data:{session:r,user:n},error:null}}function iD(t){const e=pa(t);return!e.error&&t.weak_password&&typeof t.weak_password=="object"&&Array.isArray(t.weak_password.reasons)&&t.weak_password.reasons.length&&t.weak_password.message&&typeof t.weak_password.message=="string"&&t.weak_password.reasons.reduce((r,n)=>r&&typeof n=="string",!0)&&(e.data.weak_password=t.weak_password),e}function ru(t){var e;return{data:{user:(e=t.user)!==null&&e!==void 0?e:t},error:null}}function qX(t){return{data:t,error:null}}function HX(t){const{action_link:e,email_otp:r,hashed_token:n,redirect_to:s,verification_type:c}=t,l=VX(t,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),a={action_link:e,email_otp:r,hashed_token:n,redirect_to:s,verification_type:c},m=Object.assign({},l);return{data:{properties:a,user:m},error:null}}function sD(t){return t}function ZX(t){return t.access_token&&t.refresh_token&&t.expires_in}const U2=["global","local","others"];var KX=function(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,n=Object.getOwnPropertySymbols(t);s<n.length;s++)e.indexOf(n[s])<0&&Object.prototype.propertyIsEnumerable.call(t,n[s])&&(r[n[s]]=t[n[s]]);return r};class XX{constructor({url:e="",headers:r={},fetch:n}){this.url=e,this.headers=r,this.fetch=xN(n),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)},this.oauth={listClients:this._listOAuthClients.bind(this),createClient:this._createOAuthClient.bind(this),getClient:this._getOAuthClient.bind(this),deleteClient:this._deleteOAuthClient.bind(this),regenerateClientSecret:this._regenerateOAuthClientSecret.bind(this)}}async signOut(e,r=U2[0]){if(U2.indexOf(r)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${U2.join(", ")}`);try{return await rr(this.fetch,"POST",`${this.url}/logout?scope=${r}`,{headers:this.headers,jwt:e,noResolveJson:!0}),{data:null,error:null}}catch(n){if(Gt(n))return{data:null,error:n};throw n}}async inviteUserByEmail(e,r={}){try{return await rr(this.fetch,"POST",`${this.url}/invite`,{body:{email:e,data:r.data},headers:this.headers,redirectTo:r.redirectTo,xform:ru})}catch(n){if(Gt(n))return{data:{user:null},error:n};throw n}}async generateLink(e){try{const{options:r}=e,n=KX(e,["options"]),s=Object.assign(Object.assign({},n),r);return"newEmail"in n&&(s.new_email=n==null?void 0:n.newEmail,delete s.newEmail),await rr(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:s,headers:this.headers,xform:HX,redirectTo:r==null?void 0:r.redirectTo})}catch(r){if(Gt(r))return{data:{properties:null,user:null},error:r};throw r}}async createUser(e){try{return await rr(this.fetch,"POST",`${this.url}/admin/users`,{body:e,headers:this.headers,xform:ru})}catch(r){if(Gt(r))return{data:{user:null},error:r};throw r}}async listUsers(e){var r,n,s,c,l,a,m;try{const y={nextPage:null,lastPage:0,total:0},v=await rr(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(n=(r=e==null?void 0:e.page)===null||r===void 0?void 0:r.toString())!==null&&n!==void 0?n:"",per_page:(c=(s=e==null?void 0:e.perPage)===null||s===void 0?void 0:s.toString())!==null&&c!==void 0?c:""},xform:sD});if(v.error)throw v.error;const T=await v.json(),P=(l=v.headers.get("x-total-count"))!==null&&l!==void 0?l:0,A=(m=(a=v.headers.get("link"))===null||a===void 0?void 0:a.split(","))!==null&&m!==void 0?m:[];return A.length>0&&(A.forEach(O=>{const I=parseInt(O.split(";")[0].split("=")[1].substring(0,1)),L=JSON.parse(O.split(";")[1].split("=")[1]);y[`${L}Page`]=I}),y.total=parseInt(P)),{data:Object.assign(Object.assign({},T),y),error:null}}catch(y){if(Gt(y))return{data:{users:[]},error:y};throw y}}async getUserById(e){Wf(e);try{return await rr(this.fetch,"GET",`${this.url}/admin/users/${e}`,{headers:this.headers,xform:ru})}catch(r){if(Gt(r))return{data:{user:null},error:r};throw r}}async updateUserById(e,r){Wf(e);try{return await rr(this.fetch,"PUT",`${this.url}/admin/users/${e}`,{body:r,headers:this.headers,xform:ru})}catch(n){if(Gt(n))return{data:{user:null},error:n};throw n}}async deleteUser(e,r=!1){Wf(e);try{return await rr(this.fetch,"DELETE",`${this.url}/admin/users/${e}`,{headers:this.headers,body:{should_soft_delete:r},xform:ru})}catch(n){if(Gt(n))return{data:{user:null},error:n};throw n}}async _listFactors(e){Wf(e.userId);try{const{data:r,error:n}=await rr(this.fetch,"GET",`${this.url}/admin/users/${e.userId}/factors`,{headers:this.headers,xform:s=>({data:{factors:s},error:null})});return{data:r,error:n}}catch(r){if(Gt(r))return{data:null,error:r};throw r}}async _deleteFactor(e){Wf(e.userId),Wf(e.id);try{return{data:await rr(this.fetch,"DELETE",`${this.url}/admin/users/${e.userId}/factors/${e.id}`,{headers:this.headers}),error:null}}catch(r){if(Gt(r))return{data:null,error:r};throw r}}async _listOAuthClients(e){var r,n,s,c,l,a,m;try{const y={nextPage:null,lastPage:0,total:0},v=await rr(this.fetch,"GET",`${this.url}/admin/oauth/clients`,{headers:this.headers,noResolveJson:!0,query:{page:(n=(r=e==null?void 0:e.page)===null||r===void 0?void 0:r.toString())!==null&&n!==void 0?n:"",per_page:(c=(s=e==null?void 0:e.perPage)===null||s===void 0?void 0:s.toString())!==null&&c!==void 0?c:""},xform:sD});if(v.error)throw v.error;const T=await v.json(),P=(l=v.headers.get("x-total-count"))!==null&&l!==void 0?l:0,A=(m=(a=v.headers.get("link"))===null||a===void 0?void 0:a.split(","))!==null&&m!==void 0?m:[];return A.length>0&&(A.forEach(O=>{const I=parseInt(O.split(";")[0].split("=")[1].substring(0,1)),L=JSON.parse(O.split(";")[1].split("=")[1]);y[`${L}Page`]=I}),y.total=parseInt(P)),{data:Object.assign(Object.assign({},T),y),error:null}}catch(y){if(Gt(y))return{data:{clients:[]},error:y};throw y}}async _createOAuthClient(e){try{return await rr(this.fetch,"POST",`${this.url}/admin/oauth/clients`,{body:e,headers:this.headers,xform:r=>({data:r,error:null})})}catch(r){if(Gt(r))return{data:null,error:r};throw r}}async _getOAuthClient(e){try{return await rr(this.fetch,"GET",`${this.url}/admin/oauth/clients/${e}`,{headers:this.headers,xform:r=>({data:r,error:null})})}catch(r){if(Gt(r))return{data:null,error:r};throw r}}async _deleteOAuthClient(e){try{return await rr(this.fetch,"DELETE",`${this.url}/admin/oauth/clients/${e}`,{headers:this.headers,xform:r=>({data:r,error:null})})}catch(r){if(Gt(r))return{data:null,error:r};throw r}}async _regenerateOAuthClientSecret(e){try{return await rr(this.fetch,"POST",`${this.url}/admin/oauth/clients/${e}/regenerate_secret`,{headers:this.headers,xform:r=>({data:r,error:null})})}catch(r){if(Gt(r))return{data:null,error:r};throw r}}}function oD(t={}){return{getItem:e=>t[e]||null,setItem:(e,r)=>{t[e]=r},removeItem:e=>{delete t[e]}}}const qf={debug:!!(globalThis&&vN()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class bN extends Error{constructor(e){super(e),this.isAcquireTimeout=!0}}class YX extends bN{}async function QX(t,e,r){qf.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",t,e);const n=new globalThis.AbortController;return e>0&&setTimeout(()=>{n.abort(),qf.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",t)},e),await Promise.resolve().then(()=>globalThis.navigator.locks.request(t,e===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:n.signal},async s=>{if(s){qf.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",t,s.name);try{return await r()}finally{qf.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",t,s.name)}}else{if(e===0)throw qf.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",t),new YX(`Acquiring an exclusive Navigator LockManager lock "${t}" immediately failed`);if(qf.debug)try{const c=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(c,null,"  "))}catch(c){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",c)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await r()}}))}function JX(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}function wN(t){if(!/^0x[a-fA-F0-9]{40}$/.test(t))throw new Error(`@supabase/auth-js: Address "${t}" is invalid.`);return t.toLowerCase()}function eY(t){return parseInt(t,16)}function tY(t){const e=new TextEncoder().encode(t);return"0x"+Array.from(e,n=>n.toString(16).padStart(2,"0")).join("")}function rY(t){var e;const{chainId:r,domain:n,expirationTime:s,issuedAt:c=new Date,nonce:l,notBefore:a,requestId:m,resources:y,scheme:v,uri:T,version:P}=t;{if(!Number.isInteger(r))throw new Error(`@supabase/auth-js: Invalid SIWE message field "chainId". Chain ID must be a EIP-155 chain ID. Provided value: ${r}`);if(!n)throw new Error('@supabase/auth-js: Invalid SIWE message field "domain". Domain must be provided.');if(l&&l.length<8)throw new Error(`@supabase/auth-js: Invalid SIWE message field "nonce". Nonce must be at least 8 characters. Provided value: ${l}`);if(!T)throw new Error('@supabase/auth-js: Invalid SIWE message field "uri". URI must be provided.');if(P!=="1")throw new Error(`@supabase/auth-js: Invalid SIWE message field "version". Version must be '1'. Provided value: ${P}`);if(!((e=t.statement)===null||e===void 0)&&e.includes(`
`))throw new Error(`@supabase/auth-js: Invalid SIWE message field "statement". Statement must not include '\\n'. Provided value: ${t.statement}`)}const A=wN(t.address),O=v?`${v}://${n}`:n,I=t.statement?`${t.statement}
`:"",L=`${O} wants you to sign in with your Ethereum account:
${A}

${I}`;let R=`URI: ${T}
Version: ${P}
Chain ID: ${r}${l?`
Nonce: ${l}`:""}
Issued At: ${c.toISOString()}`;if(s&&(R+=`
Expiration Time: ${s.toISOString()}`),a&&(R+=`
Not Before: ${a.toISOString()}`),m&&(R+=`
Request ID: ${m}`),y){let z=`
Resources:`;for(const j of y){if(!j||typeof j!="string")throw new Error(`@supabase/auth-js: Invalid SIWE message field "resources". Every resource must be a valid string. Provided value: ${j}`);z+=`
- ${j}`}R+=z}return`${L}
${R}`}class di extends Error{constructor({message:e,code:r,cause:n,name:s}){var c;super(e,{cause:n}),this.__isWebAuthnError=!0,this.name=(c=s??(n instanceof Error?n.name:void 0))!==null&&c!==void 0?c:"Unknown Error",this.code=r}}class fb extends di{constructor(e,r){super({code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:r,message:e}),this.name="WebAuthnUnknownError",this.originalError=r}}function nY({error:t,options:e}){var r,n,s;const{publicKey:c}=e;if(!c)throw Error("options was missing required publicKey property");if(t.name==="AbortError"){if(e.signal instanceof AbortSignal)return new di({message:"Registration ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:t})}else if(t.name==="ConstraintError"){if(((r=c.authenticatorSelection)===null||r===void 0?void 0:r.requireResidentKey)===!0)return new di({message:"Discoverable credentials were required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_DISCOVERABLE_CREDENTIAL_SUPPORT",cause:t});if(e.mediation==="conditional"&&((n=c.authenticatorSelection)===null||n===void 0?void 0:n.userVerification)==="required")return new di({message:"User verification was required during automatic registration but it could not be performed",code:"ERROR_AUTO_REGISTER_USER_VERIFICATION_FAILURE",cause:t});if(((s=c.authenticatorSelection)===null||s===void 0?void 0:s.userVerification)==="required")return new di({message:"User verification was required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_USER_VERIFICATION_SUPPORT",cause:t})}else{if(t.name==="InvalidStateError")return new di({message:"The authenticator was previously registered",code:"ERROR_AUTHENTICATOR_PREVIOUSLY_REGISTERED",cause:t});if(t.name==="NotAllowedError")return new di({message:t.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:t});if(t.name==="NotSupportedError")return c.pubKeyCredParams.filter(a=>a.type==="public-key").length===0?new di({message:'No entry in pubKeyCredParams was of type "public-key"',code:"ERROR_MALFORMED_PUBKEYCREDPARAMS",cause:t}):new di({message:"No available authenticator supported any of the specified pubKeyCredParams algorithms",code:"ERROR_AUTHENTICATOR_NO_SUPPORTED_PUBKEYCREDPARAMS_ALG",cause:t});if(t.name==="SecurityError"){const l=window.location.hostname;if(TN(l)){if(c.rp.id!==l)return new di({message:`The RP ID "${c.rp.id}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:t})}else return new di({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:t})}else if(t.name==="TypeError"){if(c.user.id.byteLength<1||c.user.id.byteLength>64)return new di({message:"User ID was not between 1 and 64 characters",code:"ERROR_INVALID_USER_ID_LENGTH",cause:t})}else if(t.name==="UnknownError")return new di({message:"The authenticator was unable to process the specified options, or could not create a new credential",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:t})}return new di({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:t})}function iY({error:t,options:e}){const{publicKey:r}=e;if(!r)throw Error("options was missing required publicKey property");if(t.name==="AbortError"){if(e.signal instanceof AbortSignal)return new di({message:"Authentication ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:t})}else{if(t.name==="NotAllowedError")return new di({message:t.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:t});if(t.name==="SecurityError"){const n=window.location.hostname;if(TN(n)){if(r.rpId!==n)return new di({message:`The RP ID "${r.rpId}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:t})}else return new di({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:t})}else if(t.name==="UnknownError")return new di({message:"The authenticator was unable to process the specified options, or could not create a new assertion signature",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:t})}return new di({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:t})}var SN=function(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,n=Object.getOwnPropertySymbols(t);s<n.length;s++)e.indexOf(n[s])<0&&Object.prototype.propertyIsEnumerable.call(t,n[s])&&(r[n[s]]=t[n[s]]);return r};class sY{createNewAbortSignal(){if(this.controller){const r=new Error("Cancelling existing WebAuthn API call for new one");r.name="AbortError",this.controller.abort(r)}const e=new AbortController;return this.controller=e,e.signal}cancelCeremony(){if(this.controller){const e=new Error("Manually cancelling existing WebAuthn API call");e.name="AbortError",this.controller.abort(e),this.controller=void 0}}}const oY=new sY;function aY(t){if(!t)throw new Error("Credential creation options are required");if(typeof PublicKeyCredential<"u"&&"parseCreationOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseCreationOptionsFromJSON=="function")return PublicKeyCredential.parseCreationOptionsFromJSON(t);const{challenge:e,user:r,excludeCredentials:n}=t,s=SN(t,["challenge","user","excludeCredentials"]),c=Mp(e).buffer,l=Object.assign(Object.assign({},r),{id:Mp(r.id).buffer}),a=Object.assign(Object.assign({},s),{challenge:c,user:l});if(n&&n.length>0){a.excludeCredentials=new Array(n.length);for(let m=0;m<n.length;m++){const y=n[m];a.excludeCredentials[m]=Object.assign(Object.assign({},y),{id:Mp(y.id).buffer,type:y.type||"public-key",transports:y.transports})}}return a}function lY(t){if(!t)throw new Error("Credential request options are required");if(typeof PublicKeyCredential<"u"&&"parseRequestOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseRequestOptionsFromJSON=="function")return PublicKeyCredential.parseRequestOptionsFromJSON(t);const{challenge:e,allowCredentials:r}=t,n=SN(t,["challenge","allowCredentials"]),s=Mp(e).buffer,c=Object.assign(Object.assign({},n),{challenge:s});if(r&&r.length>0){c.allowCredentials=new Array(r.length);for(let l=0;l<r.length;l++){const a=r[l];c.allowCredentials[l]=Object.assign(Object.assign({},a),{id:Mp(a.id).buffer,type:a.type||"public-key",transports:a.transports})}}return c}function cY(t){var e;if("toJSON"in t&&typeof t.toJSON=="function")return t.toJSON();const r=t;return{id:t.id,rawId:t.id,response:{attestationObject:Jh(new Uint8Array(t.response.attestationObject)),clientDataJSON:Jh(new Uint8Array(t.response.clientDataJSON))},type:"public-key",clientExtensionResults:t.getClientExtensionResults(),authenticatorAttachment:(e=r.authenticatorAttachment)!==null&&e!==void 0?e:void 0}}function uY(t){var e;if("toJSON"in t&&typeof t.toJSON=="function")return t.toJSON();const r=t,n=t.getClientExtensionResults(),s=t.response;return{id:t.id,rawId:t.id,response:{authenticatorData:Jh(new Uint8Array(s.authenticatorData)),clientDataJSON:Jh(new Uint8Array(s.clientDataJSON)),signature:Jh(new Uint8Array(s.signature)),userHandle:s.userHandle?Jh(new Uint8Array(s.userHandle)):void 0},type:"public-key",clientExtensionResults:n,authenticatorAttachment:(e=r.authenticatorAttachment)!==null&&e!==void 0?e:void 0}}function TN(t){return t==="localhost"||/^([a-z0-9]+(-[a-z0-9]+)*\.)+[a-z]{2,}$/i.test(t)}function aD(){var t,e;return!!(go()&&"PublicKeyCredential"in window&&window.PublicKeyCredential&&"credentials"in navigator&&typeof((t=navigator==null?void 0:navigator.credentials)===null||t===void 0?void 0:t.create)=="function"&&typeof((e=navigator==null?void 0:navigator.credentials)===null||e===void 0?void 0:e.get)=="function")}async function hY(t){try{const e=await navigator.credentials.create(t);return e?e instanceof PublicKeyCredential?{data:e,error:null}:{data:null,error:new fb("Browser returned unexpected credential type",e)}:{data:null,error:new fb("Empty credential response",e)}}catch(e){return{data:null,error:nY({error:e,options:t})}}}async function dY(t){try{const e=await navigator.credentials.get(t);return e?e instanceof PublicKeyCredential?{data:e,error:null}:{data:null,error:new fb("Browser returned unexpected credential type",e)}:{data:null,error:new fb("Empty credential response",e)}}catch(e){return{data:null,error:iY({error:e,options:t})}}}const fY={hints:["security-key"],authenticatorSelection:{authenticatorAttachment:"cross-platform",requireResidentKey:!1,userVerification:"preferred",residentKey:"discouraged"},attestation:"none"},pY={userVerification:"preferred",hints:["security-key"]};function pb(...t){const e=s=>s!==null&&typeof s=="object"&&!Array.isArray(s),r=s=>s instanceof ArrayBuffer||ArrayBuffer.isView(s),n={};for(const s of t)if(s)for(const c in s){const l=s[c];if(l!==void 0)if(Array.isArray(l))n[c]=l;else if(r(l))n[c]=l;else if(e(l)){const a=n[c];e(a)?n[c]=pb(a,l):n[c]=pb(l)}else n[c]=l}return n}function mY(t,e){return pb(fY,t,e||{})}function gY(t,e){return pb(pY,t,e||{})}class yY{constructor(e){this.client=e,this.enroll=this._enroll.bind(this),this.challenge=this._challenge.bind(this),this.verify=this._verify.bind(this),this.authenticate=this._authenticate.bind(this),this.register=this._register.bind(this)}async _enroll(e){return this.client.mfa.enroll(Object.assign(Object.assign({},e),{factorType:"webauthn"}))}async _challenge({factorId:e,webauthn:r,friendlyName:n,signal:s},c){try{const{data:l,error:a}=await this.client.mfa.challenge({factorId:e,webauthn:r});if(!l)return{data:null,error:a};const m=s??oY.createNewAbortSignal();if(l.webauthn.type==="create"){const{user:y}=l.webauthn.credential_options.publicKey;y.name||(y.name=`${y.id}:${n}`),y.displayName||(y.displayName=y.name)}switch(l.webauthn.type){case"create":{const y=mY(l.webauthn.credential_options.publicKey,c==null?void 0:c.create),{data:v,error:T}=await hY({publicKey:y,signal:m});return v?{data:{factorId:e,challengeId:l.id,webauthn:{type:l.webauthn.type,credential_response:v}},error:null}:{data:null,error:T}}case"request":{const y=gY(l.webauthn.credential_options.publicKey,c==null?void 0:c.request),{data:v,error:T}=await dY(Object.assign(Object.assign({},l.webauthn.credential_options),{publicKey:y,signal:m}));return v?{data:{factorId:e,challengeId:l.id,webauthn:{type:l.webauthn.type,credential_response:v}},error:null}:{data:null,error:T}}}}catch(l){return Gt(l)?{data:null,error:l}:{data:null,error:new qh("Unexpected error in challenge",l)}}}async _verify({challengeId:e,factorId:r,webauthn:n}){return this.client.mfa.verify({factorId:r,challengeId:e,webauthn:n})}async _authenticate({factorId:e,webauthn:{rpId:r=typeof window<"u"?window.location.hostname:void 0,rpOrigins:n=typeof window<"u"?[window.location.origin]:void 0,signal:s}},c){if(!r)return{data:null,error:new h0("rpId is required for WebAuthn authentication")};try{if(!aD())return{data:null,error:new qh("Browser does not support WebAuthn",null)};const{data:l,error:a}=await this.challenge({factorId:e,webauthn:{rpId:r,rpOrigins:n},signal:s},{request:c});if(!l)return{data:null,error:a};const{webauthn:m}=l;return this._verify({factorId:e,challengeId:l.challengeId,webauthn:{type:m.type,rpId:r,rpOrigins:n,credential_response:m.credential_response}})}catch(l){return Gt(l)?{data:null,error:l}:{data:null,error:new qh("Unexpected error in authenticate",l)}}}async _register({friendlyName:e,rpId:r=typeof window<"u"?window.location.hostname:void 0,rpOrigins:n=typeof window<"u"?[window.location.origin]:void 0,signal:s},c){if(!r)return{data:null,error:new h0("rpId is required for WebAuthn registration")};try{if(!aD())return{data:null,error:new qh("Browser does not support WebAuthn",null)};const{data:l,error:a}=await this._enroll({friendlyName:e});if(!l)return await this.client.mfa.listFactors().then(v=>{var T;return(T=v.data)===null||T===void 0?void 0:T.all.find(P=>P.factor_type==="webauthn"&&P.friendly_name===e&&P.status!=="unverified")}).then(v=>v?this.client.mfa.unenroll({factorId:v==null?void 0:v.id}):void 0),{data:null,error:a};const{data:m,error:y}=await this._challenge({factorId:l.id,friendlyName:l.friendly_name,webauthn:{rpId:r,rpOrigins:n},signal:s},{create:c});return m?this._verify({factorId:l.id,challengeId:m.challengeId,webauthn:{rpId:r,rpOrigins:n,type:m.webauthn.type,credential_response:m.webauthn.credential_response}}):{data:null,error:y}}catch(l){return Gt(l)?{data:null,error:l}:{data:null,error:new qh("Unexpected error in register",l)}}}}JX();const _Y={url:fX,storageKey:pX,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:mX,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1};async function lD(t,e,r){return await r()}const Hf={};class d0{get jwks(){var e,r;return(r=(e=Hf[this.storageKey])===null||e===void 0?void 0:e.jwks)!==null&&r!==void 0?r:{keys:[]}}set jwks(e){Hf[this.storageKey]=Object.assign(Object.assign({},Hf[this.storageKey]),{jwks:e})}get jwks_cached_at(){var e,r;return(r=(e=Hf[this.storageKey])===null||e===void 0?void 0:e.cachedAt)!==null&&r!==void 0?r:Number.MIN_SAFE_INTEGER}set jwks_cached_at(e){Hf[this.storageKey]=Object.assign(Object.assign({},Hf[this.storageKey]),{cachedAt:e})}constructor(e){var r,n;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.instanceID=d0.nextInstanceID,d0.nextInstanceID+=1,this.instanceID>0&&go()&&console.warn("Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.");const s=Object.assign(Object.assign({},_Y),e);if(this.logDebugMessages=!!s.debug,typeof s.debug=="function"&&(this.logger=s.debug),this.persistSession=s.persistSession,this.storageKey=s.storageKey,this.autoRefreshToken=s.autoRefreshToken,this.admin=new XX({url:s.url,headers:s.headers,fetch:s.fetch}),this.url=s.url,this.headers=s.headers,this.fetch=xN(s.fetch),this.lock=s.lock||lD,this.detectSessionInUrl=s.detectSessionInUrl,this.flowType=s.flowType,this.hasCustomAuthorizationHeader=s.hasCustomAuthorizationHeader,s.lock?this.lock=s.lock:go()&&(!((r=globalThis==null?void 0:globalThis.navigator)===null||r===void 0)&&r.locks)?this.lock=QX:this.lock=lD,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this),webauthn:new yY(this)},this.persistSession?(s.storage?this.storage=s.storage:vN()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=oD(this.memoryStorage)),s.userStorage&&(this.userStorage=s.userStorage)):(this.memoryStorage={},this.storage=oD(this.memoryStorage)),go()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(c){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",c)}(n=this.broadcastChannel)===null||n===void 0||n.addEventListener("message",async c=>{this._debug("received broadcast notification from other tab or client",c),await this._notifyAllSubscribers(c.data.event,c.data.session,!1)})}this.initialize()}_debug(...e){return this.logDebugMessages&&this.logger(`GoTrueClient@${this.instanceID} (${gN}) ${new Date().toISOString()}`,...e),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var e;try{const r=kX(window.location.href);let n="none";if(this._isImplicitGrantCallback(r)?n="implicit":await this._isPKCECallback(r)&&(n="pkce"),go()&&this.detectSessionInUrl&&n!=="none"){const{data:s,error:c}=await this._getSessionFromURL(r,n);if(c){if(this._debug("#_initialize()","error detecting session from URL",c),bX(c)){const m=(e=c.details)===null||e===void 0?void 0:e.code;if(m==="identity_already_exists"||m==="identity_not_found"||m==="single_identity_not_deletable")return{error:c}}return await this._removeSession(),{error:c}}const{session:l,redirectType:a}=s;return this._debug("#_initialize()","detected session in URL",l,"redirect type",a),await this._saveSession(l),setTimeout(async()=>{a==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",l):await this._notifyAllSubscribers("SIGNED_IN",l)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(r){return Gt(r)?{error:r}:{error:new qh("Unexpected error during initialization",r)}}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(e){var r,n,s;try{const c=await rr(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(n=(r=e==null?void 0:e.options)===null||r===void 0?void 0:r.data)!==null&&n!==void 0?n:{},gotrue_meta_security:{captcha_token:(s=e==null?void 0:e.options)===null||s===void 0?void 0:s.captchaToken}},xform:pa}),{data:l,error:a}=c;if(a||!l)return{data:{user:null,session:null},error:a};const m=l.session,y=l.user;return l.session&&(await this._saveSession(l.session),await this._notifyAllSubscribers("SIGNED_IN",m)),{data:{user:y,session:m},error:null}}catch(c){if(Gt(c))return{data:{user:null,session:null},error:c};throw c}}async signUp(e){var r,n,s;try{let c;if("email"in e){const{email:v,password:T,options:P}=e;let A=null,O=null;this.flowType==="pkce"&&([A,O]=await Gf(this.storage,this.storageKey)),c=await rr(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:P==null?void 0:P.emailRedirectTo,body:{email:v,password:T,data:(r=P==null?void 0:P.data)!==null&&r!==void 0?r:{},gotrue_meta_security:{captcha_token:P==null?void 0:P.captchaToken},code_challenge:A,code_challenge_method:O},xform:pa})}else if("phone"in e){const{phone:v,password:T,options:P}=e;c=await rr(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:v,password:T,data:(n=P==null?void 0:P.data)!==null&&n!==void 0?n:{},channel:(s=P==null?void 0:P.channel)!==null&&s!==void 0?s:"sms",gotrue_meta_security:{captcha_token:P==null?void 0:P.captchaToken}},xform:pa})}else throw new Fv("You must provide either an email or phone number and a password");const{data:l,error:a}=c;if(a||!l)return{data:{user:null,session:null},error:a};const m=l.session,y=l.user;return l.session&&(await this._saveSession(l.session),await this._notifyAllSubscribers("SIGNED_IN",m)),{data:{user:y,session:m},error:null}}catch(c){if(Gt(c))return{data:{user:null,session:null},error:c};throw c}}async signInWithPassword(e){try{let r;if("email"in e){const{email:c,password:l,options:a}=e;r=await rr(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:c,password:l,gotrue_meta_security:{captcha_token:a==null?void 0:a.captchaToken}},xform:iD})}else if("phone"in e){const{phone:c,password:l,options:a}=e;r=await rr(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:c,password:l,gotrue_meta_security:{captcha_token:a==null?void 0:a.captchaToken}},xform:iD})}else throw new Fv("You must provide either an email or phone number and a password");const{data:n,error:s}=r;return s?{data:{user:null,session:null},error:s}:!n||!n.session||!n.user?{data:{user:null,session:null},error:new Uf}:(n.session&&(await this._saveSession(n.session),await this._notifyAllSubscribers("SIGNED_IN",n.session)),{data:Object.assign({user:n.user,session:n.session},n.weak_password?{weakPassword:n.weak_password}:null),error:s})}catch(r){if(Gt(r))return{data:{user:null,session:null},error:r};throw r}}async signInWithOAuth(e){var r,n,s,c;return await this._handleProviderSignIn(e.provider,{redirectTo:(r=e.options)===null||r===void 0?void 0:r.redirectTo,scopes:(n=e.options)===null||n===void 0?void 0:n.scopes,queryParams:(s=e.options)===null||s===void 0?void 0:s.queryParams,skipBrowserRedirect:(c=e.options)===null||c===void 0?void 0:c.skipBrowserRedirect})}async exchangeCodeForSession(e){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(e))}async signInWithWeb3(e){const{chain:r}=e;switch(r){case"ethereum":return await this.signInWithEthereum(e);case"solana":return await this.signInWithSolana(e);default:throw new Error(`@supabase/auth-js: Unsupported chain "${r}"`)}}async signInWithEthereum(e){var r,n,s,c,l,a,m,y,v,T,P;let A,O;if("message"in e)A=e.message,O=e.signature;else{const{chain:I,wallet:L,statement:R,options:z}=e;let j;if(go())if(typeof L=="object")j=L;else{const q=window;if("ethereum"in q&&typeof q.ethereum=="object"&&"request"in q.ethereum&&typeof q.ethereum.request=="function")j=q.ethereum;else throw new Error("@supabase/auth-js: No compatible Ethereum wallet interface on the window object (window.ethereum) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'ethereum', wallet: resolvedUserWallet }) instead.")}else{if(typeof L!="object"||!(z!=null&&z.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");j=L}const W=new URL((r=z==null?void 0:z.url)!==null&&r!==void 0?r:window.location.href),Z=await j.request({method:"eth_requestAccounts"}).then(q=>q).catch(()=>{throw new Error("@supabase/auth-js: Wallet method eth_requestAccounts is missing or invalid")});if(!Z||Z.length===0)throw new Error("@supabase/auth-js: No accounts available. Please ensure the wallet is connected.");const te=wN(Z[0]);let ie=(n=z==null?void 0:z.signInWithEthereum)===null||n===void 0?void 0:n.chainId;if(!ie){const q=await j.request({method:"eth_chainId"});ie=eY(q)}const V={domain:W.host,address:te,statement:R,uri:W.href,version:"1",chainId:ie,nonce:(s=z==null?void 0:z.signInWithEthereum)===null||s===void 0?void 0:s.nonce,issuedAt:(l=(c=z==null?void 0:z.signInWithEthereum)===null||c===void 0?void 0:c.issuedAt)!==null&&l!==void 0?l:new Date,expirationTime:(a=z==null?void 0:z.signInWithEthereum)===null||a===void 0?void 0:a.expirationTime,notBefore:(m=z==null?void 0:z.signInWithEthereum)===null||m===void 0?void 0:m.notBefore,requestId:(y=z==null?void 0:z.signInWithEthereum)===null||y===void 0?void 0:y.requestId,resources:(v=z==null?void 0:z.signInWithEthereum)===null||v===void 0?void 0:v.resources};A=rY(V),O=await j.request({method:"personal_sign",params:[tY(A),te]})}try{const{data:I,error:L}=await rr(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"ethereum",message:A,signature:O},!((T=e.options)===null||T===void 0)&&T.captchaToken?{gotrue_meta_security:{captcha_token:(P=e.options)===null||P===void 0?void 0:P.captchaToken}}:null),xform:pa});if(L)throw L;return!I||!I.session||!I.user?{data:{user:null,session:null},error:new Uf}:(I.session&&(await this._saveSession(I.session),await this._notifyAllSubscribers("SIGNED_IN",I.session)),{data:Object.assign({},I),error:L})}catch(I){if(Gt(I))return{data:{user:null,session:null},error:I};throw I}}async signInWithSolana(e){var r,n,s,c,l,a,m,y,v,T,P,A;let O,I;if("message"in e)O=e.message,I=e.signature;else{const{chain:L,wallet:R,statement:z,options:j}=e;let W;if(go())if(typeof R=="object")W=R;else{const te=window;if("solana"in te&&typeof te.solana=="object"&&("signIn"in te.solana&&typeof te.solana.signIn=="function"||"signMessage"in te.solana&&typeof te.solana.signMessage=="function"))W=te.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof R!="object"||!(j!=null&&j.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");W=R}const Z=new URL((r=j==null?void 0:j.url)!==null&&r!==void 0?r:window.location.href);if("signIn"in W&&W.signIn){const te=await W.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},j==null?void 0:j.signInWithSolana),{version:"1",domain:Z.host,uri:Z.href}),z?{statement:z}:null));let ie;if(Array.isArray(te)&&te[0]&&typeof te[0]=="object")ie=te[0];else if(te&&typeof te=="object"&&"signedMessage"in te&&"signature"in te)ie=te;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in ie&&"signature"in ie&&(typeof ie.signedMessage=="string"||ie.signedMessage instanceof Uint8Array)&&ie.signature instanceof Uint8Array)O=typeof ie.signedMessage=="string"?ie.signedMessage:new TextDecoder().decode(ie.signedMessage),I=ie.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in W)||typeof W.signMessage!="function"||!("publicKey"in W)||typeof W!="object"||!W.publicKey||!("toBase58"in W.publicKey)||typeof W.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");O=[`${Z.host} wants you to sign in with your Solana account:`,W.publicKey.toBase58(),...z?["",z,""]:[""],"Version: 1",`URI: ${Z.href}`,`Issued At: ${(s=(n=j==null?void 0:j.signInWithSolana)===null||n===void 0?void 0:n.issuedAt)!==null&&s!==void 0?s:new Date().toISOString()}`,...!((c=j==null?void 0:j.signInWithSolana)===null||c===void 0)&&c.notBefore?[`Not Before: ${j.signInWithSolana.notBefore}`]:[],...!((l=j==null?void 0:j.signInWithSolana)===null||l===void 0)&&l.expirationTime?[`Expiration Time: ${j.signInWithSolana.expirationTime}`]:[],...!((a=j==null?void 0:j.signInWithSolana)===null||a===void 0)&&a.chainId?[`Chain ID: ${j.signInWithSolana.chainId}`]:[],...!((m=j==null?void 0:j.signInWithSolana)===null||m===void 0)&&m.nonce?[`Nonce: ${j.signInWithSolana.nonce}`]:[],...!((y=j==null?void 0:j.signInWithSolana)===null||y===void 0)&&y.requestId?[`Request ID: ${j.signInWithSolana.requestId}`]:[],...!((T=(v=j==null?void 0:j.signInWithSolana)===null||v===void 0?void 0:v.resources)===null||T===void 0)&&T.length?["Resources",...j.signInWithSolana.resources.map(ie=>`- ${ie}`)]:[]].join(`
`);const te=await W.signMessage(new TextEncoder().encode(O),"utf8");if(!te||!(te instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");I=te}}try{const{data:L,error:R}=await rr(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:O,signature:Jh(I)},!((P=e.options)===null||P===void 0)&&P.captchaToken?{gotrue_meta_security:{captcha_token:(A=e.options)===null||A===void 0?void 0:A.captchaToken}}:null),xform:pa});if(R)throw R;return!L||!L.session||!L.user?{data:{user:null,session:null},error:new Uf}:(L.session&&(await this._saveSession(L.session),await this._notifyAllSubscribers("SIGNED_IN",L.session)),{data:Object.assign({},L),error:R})}catch(L){if(Gt(L))return{data:{user:null,session:null},error:L};throw L}}async _exchangeCodeForSession(e){const r=await Dh(this.storage,`${this.storageKey}-code-verifier`),[n,s]=(r??"").split("/");try{const{data:c,error:l}=await rr(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:e,code_verifier:n},xform:pa});if(await qc(this.storage,`${this.storageKey}-code-verifier`),l)throw l;return!c||!c.session||!c.user?{data:{user:null,session:null,redirectType:null},error:new Uf}:(c.session&&(await this._saveSession(c.session),await this._notifyAllSubscribers("SIGNED_IN",c.session)),{data:Object.assign(Object.assign({},c),{redirectType:s??null}),error:l})}catch(c){if(Gt(c))return{data:{user:null,session:null,redirectType:null},error:c};throw c}}async signInWithIdToken(e){try{const{options:r,provider:n,token:s,access_token:c,nonce:l}=e,a=await rr(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:n,id_token:s,access_token:c,nonce:l,gotrue_meta_security:{captcha_token:r==null?void 0:r.captchaToken}},xform:pa}),{data:m,error:y}=a;return y?{data:{user:null,session:null},error:y}:!m||!m.session||!m.user?{data:{user:null,session:null},error:new Uf}:(m.session&&(await this._saveSession(m.session),await this._notifyAllSubscribers("SIGNED_IN",m.session)),{data:m,error:y})}catch(r){if(Gt(r))return{data:{user:null,session:null},error:r};throw r}}async signInWithOtp(e){var r,n,s,c,l;try{if("email"in e){const{email:a,options:m}=e;let y=null,v=null;this.flowType==="pkce"&&([y,v]=await Gf(this.storage,this.storageKey));const{error:T}=await rr(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:a,data:(r=m==null?void 0:m.data)!==null&&r!==void 0?r:{},create_user:(n=m==null?void 0:m.shouldCreateUser)!==null&&n!==void 0?n:!0,gotrue_meta_security:{captcha_token:m==null?void 0:m.captchaToken},code_challenge:y,code_challenge_method:v},redirectTo:m==null?void 0:m.emailRedirectTo});return{data:{user:null,session:null},error:T}}if("phone"in e){const{phone:a,options:m}=e,{data:y,error:v}=await rr(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:a,data:(s=m==null?void 0:m.data)!==null&&s!==void 0?s:{},create_user:(c=m==null?void 0:m.shouldCreateUser)!==null&&c!==void 0?c:!0,gotrue_meta_security:{captcha_token:m==null?void 0:m.captchaToken},channel:(l=m==null?void 0:m.channel)!==null&&l!==void 0?l:"sms"}});return{data:{user:null,session:null,messageId:y==null?void 0:y.message_id},error:v}}throw new Fv("You must provide either an email or phone number.")}catch(a){if(Gt(a))return{data:{user:null,session:null},error:a};throw a}}async verifyOtp(e){var r,n;try{let s,c;"options"in e&&(s=(r=e.options)===null||r===void 0?void 0:r.redirectTo,c=(n=e.options)===null||n===void 0?void 0:n.captchaToken);const{data:l,error:a}=await rr(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},e),{gotrue_meta_security:{captcha_token:c}}),redirectTo:s,xform:pa});if(a)throw a;if(!l)throw new Error("An error occurred on token verification.");const m=l.session,y=l.user;return m!=null&&m.access_token&&(await this._saveSession(m),await this._notifyAllSubscribers(e.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",m)),{data:{user:y,session:m},error:null}}catch(s){if(Gt(s))return{data:{user:null,session:null},error:s};throw s}}async signInWithSSO(e){var r,n,s;try{let c=null,l=null;return this.flowType==="pkce"&&([c,l]=await Gf(this.storage,this.storageKey)),await rr(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in e?{provider_id:e.providerId}:null),"domain"in e?{domain:e.domain}:null),{redirect_to:(n=(r=e.options)===null||r===void 0?void 0:r.redirectTo)!==null&&n!==void 0?n:void 0}),!((s=e==null?void 0:e.options)===null||s===void 0)&&s.captchaToken?{gotrue_meta_security:{captcha_token:e.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:c,code_challenge_method:l}),headers:this.headers,xform:qX})}catch(c){if(Gt(c))return{data:null,error:c};throw c}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async e=>{const{data:{session:r},error:n}=e;if(n)throw n;if(!r)throw new Kc;const{error:s}=await rr(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:r.access_token});return{data:{user:null,session:null},error:s}})}catch(e){if(Gt(e))return{data:{user:null,session:null},error:e};throw e}}async resend(e){try{const r=`${this.url}/resend`;if("email"in e){const{email:n,type:s,options:c}=e,{error:l}=await rr(this.fetch,"POST",r,{headers:this.headers,body:{email:n,type:s,gotrue_meta_security:{captcha_token:c==null?void 0:c.captchaToken}},redirectTo:c==null?void 0:c.emailRedirectTo});return{data:{user:null,session:null},error:l}}else if("phone"in e){const{phone:n,type:s,options:c}=e,{data:l,error:a}=await rr(this.fetch,"POST",r,{headers:this.headers,body:{phone:n,type:s,gotrue_meta_security:{captcha_token:c==null?void 0:c.captchaToken}}});return{data:{user:null,session:null,messageId:l==null?void 0:l.message_id},error:a}}throw new Fv("You must provide either an email or phone number and a type")}catch(r){if(Gt(r))return{data:{user:null,session:null},error:r};throw r}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async r=>r))}async _acquireLock(e,r){this._debug("#_acquireLock","begin",e);try{if(this.lockAcquired){const n=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),s=(async()=>(await n,await r()))();return this.pendingInLock.push((async()=>{try{await s}catch{}})()),s}return await this.lock(`lock:${this.storageKey}`,e,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const n=r();for(this.pendingInLock.push((async()=>{try{await n}catch{}})()),await n;this.pendingInLock.length;){const s=[...this.pendingInLock];await Promise.all(s),this.pendingInLock.splice(0,s.length)}return await n}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(e){this._debug("#_useSession","begin");try{const r=await this.__loadSession();return await e(r)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let e=null;const r=await Dh(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",r),r!==null&&(this._isValidSession(r)?e=r:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!e)return{data:{session:null},error:null};const n=e.expires_at?e.expires_at*1e3-Date.now()<F2:!1;if(this._debug("#__loadSession()",`session has${n?"":" not"} expired`,"expires_at",e.expires_at),!n){if(this.userStorage){const l=await Dh(this.userStorage,this.storageKey+"-user");l!=null&&l.user?e.user=l.user:e.user=V2()}if(this.storage.isServer&&e.user){let l=this.suppressGetSessionWarning;e=new Proxy(e,{get:(m,y,v)=>(!l&&y==="user"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),l=!0,this.suppressGetSessionWarning=!0),Reflect.get(m,y,v))})}return{data:{session:e},error:null}}const{data:s,error:c}=await this._callRefreshToken(e.refresh_token);return c?{data:{session:null},error:c}:{data:{session:s},error:null}}finally{this._debug("#__loadSession()","end")}}async getUser(e){return e?await this._getUser(e):(await this.initializePromise,await this._acquireLock(-1,async()=>await this._getUser()))}async _getUser(e){try{return e?await rr(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:e,xform:ru}):await this._useSession(async r=>{var n,s,c;const{data:l,error:a}=r;if(a)throw a;return!(!((n=l.session)===null||n===void 0)&&n.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new Kc}:await rr(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(c=(s=l.session)===null||s===void 0?void 0:s.access_token)!==null&&c!==void 0?c:void 0,xform:ru})})}catch(r){if(Gt(r))return xX(r)&&(await this._removeSession(),await qc(this.storage,`${this.storageKey}-code-verifier`)),{data:{user:null},error:r};throw r}}async updateUser(e,r={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(e,r))}async _updateUser(e,r={}){try{return await this._useSession(async n=>{const{data:s,error:c}=n;if(c)throw c;if(!s.session)throw new Kc;const l=s.session;let a=null,m=null;this.flowType==="pkce"&&e.email!=null&&([a,m]=await Gf(this.storage,this.storageKey));const{data:y,error:v}=await rr(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:r==null?void 0:r.emailRedirectTo,body:Object.assign(Object.assign({},e),{code_challenge:a,code_challenge_method:m}),jwt:l.access_token,xform:ru});if(v)throw v;return l.user=y.user,await this._saveSession(l),await this._notifyAllSubscribers("USER_UPDATED",l),{data:{user:l.user},error:null}})}catch(n){if(Gt(n))return{data:{user:null},error:n};throw n}}async setSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(e))}async _setSession(e){try{if(!e.access_token||!e.refresh_token)throw new Kc;const r=Date.now()/1e3;let n=r,s=!0,c=null;const{payload:l}=$2(e.access_token);if(l.exp&&(n=l.exp,s=n<=r),s){const{data:a,error:m}=await this._callRefreshToken(e.refresh_token);if(m)return{data:{user:null,session:null},error:m};if(!a)return{data:{user:null,session:null},error:null};c=a}else{const{data:a,error:m}=await this._getUser(e.access_token);if(m)throw m;c={access_token:e.access_token,refresh_token:e.refresh_token,user:a.user,token_type:"bearer",expires_in:n-r,expires_at:n},await this._saveSession(c),await this._notifyAllSubscribers("SIGNED_IN",c)}return{data:{user:c.user,session:c},error:null}}catch(r){if(Gt(r))return{data:{session:null,user:null},error:r};throw r}}async refreshSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(e))}async _refreshSession(e){try{return await this._useSession(async r=>{var n;if(!e){const{data:l,error:a}=r;if(a)throw a;e=(n=l.session)!==null&&n!==void 0?n:void 0}if(!(e!=null&&e.refresh_token))throw new Kc;const{data:s,error:c}=await this._callRefreshToken(e.refresh_token);return c?{data:{user:null,session:null},error:c}:s?{data:{user:s.user,session:s},error:null}:{data:{user:null,session:null},error:null}})}catch(r){if(Gt(r))return{data:{user:null,session:null},error:r};throw r}}async _getSessionFromURL(e,r){try{if(!go())throw new Bv("No browser detected.");if(e.error||e.error_description||e.error_code)throw new Bv(e.error_description||"Error in URL with unspecified error_description",{error:e.error||"unspecified_error",code:e.error_code||"unspecified_code"});switch(r){case"implicit":if(this.flowType==="pkce")throw new YR("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new Bv("Not a valid implicit grant flow url.");break;default:}if(r==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!e.code)throw new YR("No code detected.");const{data:z,error:j}=await this._exchangeCodeForSession(e.code);if(j)throw j;const W=new URL(window.location.href);return W.searchParams.delete("code"),window.history.replaceState(window.history.state,"",W.toString()),{data:{session:z.session,redirectType:null},error:null}}const{provider_token:n,provider_refresh_token:s,access_token:c,refresh_token:l,expires_in:a,expires_at:m,token_type:y}=e;if(!c||!a||!l||!y)throw new Bv("No session defined in URL");const v=Math.round(Date.now()/1e3),T=parseInt(a);let P=v+T;m&&(P=parseInt(m));const A=P-v;A*1e3<=ep&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${A}s, should have been closer to ${T}s`);const O=P-T;v-O>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",O,P,v):v-O<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",O,P,v);const{data:I,error:L}=await this._getUser(c);if(L)throw L;const R={provider_token:n,provider_refresh_token:s,access_token:c,expires_in:T,expires_at:P,refresh_token:l,token_type:y,user:I.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),{data:{session:R,redirectType:e.type},error:null}}catch(n){if(Gt(n))return{data:{session:null,redirectType:null},error:n};throw n}}_isImplicitGrantCallback(e){return!!(e.access_token||e.error_description)}async _isPKCECallback(e){const r=await Dh(this.storage,`${this.storageKey}-code-verifier`);return!!(e.code&&r)}async signOut(e={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(e))}async _signOut({scope:e}={scope:"global"}){return await this._useSession(async r=>{var n;const{data:s,error:c}=r;if(c)return{error:c};const l=(n=s.session)===null||n===void 0?void 0:n.access_token;if(l){const{error:a}=await this.admin.signOut(l,e);if(a&&!(vX(a)&&(a.status===404||a.status===401||a.status===403)))return{error:a}}return e!=="others"&&(await this._removeSession(),await qc(this.storage,`${this.storageKey}-code-verifier`)),{error:null}})}onAuthStateChange(e){const r=AX(),n={id:r,callback:e,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",r),this.stateChangeEmitters.delete(r)}};return this._debug("#onAuthStateChange()","registered callback with id",r),this.stateChangeEmitters.set(r,n),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(r)})))(),{data:{subscription:n}}}async _emitInitialSession(e){return await this._useSession(async r=>{var n,s;try{const{data:{session:c},error:l}=r;if(l)throw l;await((n=this.stateChangeEmitters.get(e))===null||n===void 0?void 0:n.callback("INITIAL_SESSION",c)),this._debug("INITIAL_SESSION","callback id",e,"session",c)}catch(c){await((s=this.stateChangeEmitters.get(e))===null||s===void 0?void 0:s.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",e,"error",c),console.error(c)}})}async resetPasswordForEmail(e,r={}){let n=null,s=null;this.flowType==="pkce"&&([n,s]=await Gf(this.storage,this.storageKey,!0));try{return await rr(this.fetch,"POST",`${this.url}/recover`,{body:{email:e,code_challenge:n,code_challenge_method:s,gotrue_meta_security:{captcha_token:r.captchaToken}},headers:this.headers,redirectTo:r.redirectTo})}catch(c){if(Gt(c))return{data:null,error:c};throw c}}async getUserIdentities(){var e;try{const{data:r,error:n}=await this.getUser();if(n)throw n;return{data:{identities:(e=r.user.identities)!==null&&e!==void 0?e:[]},error:null}}catch(r){if(Gt(r))return{data:null,error:r};throw r}}async linkIdentity(e){return"token"in e?this.linkIdentityIdToken(e):this.linkIdentityOAuth(e)}async linkIdentityOAuth(e){var r;try{const{data:n,error:s}=await this._useSession(async c=>{var l,a,m,y,v;const{data:T,error:P}=c;if(P)throw P;const A=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,e.provider,{redirectTo:(l=e.options)===null||l===void 0?void 0:l.redirectTo,scopes:(a=e.options)===null||a===void 0?void 0:a.scopes,queryParams:(m=e.options)===null||m===void 0?void 0:m.queryParams,skipBrowserRedirect:!0});return await rr(this.fetch,"GET",A,{headers:this.headers,jwt:(v=(y=T.session)===null||y===void 0?void 0:y.access_token)!==null&&v!==void 0?v:void 0})});if(s)throw s;return go()&&!(!((r=e.options)===null||r===void 0)&&r.skipBrowserRedirect)&&window.location.assign(n==null?void 0:n.url),{data:{provider:e.provider,url:n==null?void 0:n.url},error:null}}catch(n){if(Gt(n))return{data:{provider:e.provider,url:null},error:n};throw n}}async linkIdentityIdToken(e){return await this._useSession(async r=>{var n;try{const{error:s,data:{session:c}}=r;if(s)throw s;const{options:l,provider:a,token:m,access_token:y,nonce:v}=e,T=await rr(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,jwt:(n=c==null?void 0:c.access_token)!==null&&n!==void 0?n:void 0,body:{provider:a,id_token:m,access_token:y,nonce:v,link_identity:!0,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken}},xform:pa}),{data:P,error:A}=T;return A?{data:{user:null,session:null},error:A}:!P||!P.session||!P.user?{data:{user:null,session:null},error:new Uf}:(P.session&&(await this._saveSession(P.session),await this._notifyAllSubscribers("USER_UPDATED",P.session)),{data:P,error:A})}catch(s){if(Gt(s))return{data:{user:null,session:null},error:s};throw s}})}async unlinkIdentity(e){try{return await this._useSession(async r=>{var n,s;const{data:c,error:l}=r;if(l)throw l;return await rr(this.fetch,"DELETE",`${this.url}/user/identities/${e.identity_id}`,{headers:this.headers,jwt:(s=(n=c.session)===null||n===void 0?void 0:n.access_token)!==null&&s!==void 0?s:void 0})})}catch(r){if(Gt(r))return{data:null,error:r};throw r}}async _refreshAccessToken(e){const r=`#_refreshAccessToken(${e.substring(0,5)}...)`;this._debug(r,"begin");try{const n=Date.now();return await RX(async s=>(s>0&&await IX(200*Math.pow(2,s-1)),this._debug(r,"refreshing attempt",s),await rr(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:e},headers:this.headers,xform:pa})),(s,c)=>{const l=200*Math.pow(2,s);return c&&B2(c)&&Date.now()+l-n<ep})}catch(n){if(this._debug(r,"error",n),Gt(n))return{data:{session:null,user:null},error:n};throw n}finally{this._debug(r,"end")}}_isValidSession(e){return typeof e=="object"&&e!==null&&"access_token"in e&&"refresh_token"in e&&"expires_at"in e}async _handleProviderSignIn(e,r){const n=await this._getUrlForProvider(`${this.url}/authorize`,e,{redirectTo:r.redirectTo,scopes:r.scopes,queryParams:r.queryParams});return this._debug("#_handleProviderSignIn()","provider",e,"options",r,"url",n),go()&&!r.skipBrowserRedirect&&window.location.assign(n),{data:{provider:e,url:n},error:null}}async _recoverAndRefresh(){var e,r;const n="#_recoverAndRefresh()";this._debug(n,"begin");try{const s=await Dh(this.storage,this.storageKey);if(s&&this.userStorage){let l=await Dh(this.userStorage,this.storageKey+"-user");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!l&&(l={user:s.user},await tp(this.userStorage,this.storageKey+"-user",l)),s.user=(e=l==null?void 0:l.user)!==null&&e!==void 0?e:V2()}else if(s&&!s.user&&!s.user){const l=await Dh(this.storage,this.storageKey+"-user");l&&(l!=null&&l.user)?(s.user=l.user,await qc(this.storage,this.storageKey+"-user"),await tp(this.storage,this.storageKey,s)):s.user=V2()}if(this._debug(n,"session from storage",s),!this._isValidSession(s)){this._debug(n,"session is not valid"),s!==null&&await this._removeSession();return}const c=((r=s.expires_at)!==null&&r!==void 0?r:1/0)*1e3-Date.now()<F2;if(this._debug(n,`session has${c?"":" not"} expired with margin of ${F2}s`),c){if(this.autoRefreshToken&&s.refresh_token){const{error:l}=await this._callRefreshToken(s.refresh_token);l&&(console.error(l),B2(l)||(this._debug(n,"refresh failed with a non-retryable error, removing the session",l),await this._removeSession()))}}else if(s.user&&s.user.__isUserNotAvailableProxy===!0)try{const{data:l,error:a}=await this._getUser(s.access_token);!a&&(l!=null&&l.user)?(s.user=l.user,await this._saveSession(s),await this._notifyAllSubscribers("SIGNED_IN",s)):this._debug(n,"could not get user data, skipping SIGNED_IN notification")}catch(l){console.error("Error getting user data:",l),this._debug(n,"error getting user data, skipping SIGNED_IN notification",l)}else await this._notifyAllSubscribers("SIGNED_IN",s)}catch(s){this._debug(n,"error",s),console.error(s);return}finally{this._debug(n,"end")}}async _callRefreshToken(e){var r,n;if(!e)throw new Kc;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const s=`#_callRefreshToken(${e.substring(0,5)}...)`;this._debug(s,"begin");try{this.refreshingDeferred=new l1;const{data:c,error:l}=await this._refreshAccessToken(e);if(l)throw l;if(!c.session)throw new Kc;await this._saveSession(c.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",c.session);const a={data:c.session,error:null};return this.refreshingDeferred.resolve(a),a}catch(c){if(this._debug(s,"error",c),Gt(c)){const l={data:null,error:c};return B2(c)||await this._removeSession(),(r=this.refreshingDeferred)===null||r===void 0||r.resolve(l),l}throw(n=this.refreshingDeferred)===null||n===void 0||n.reject(c),c}finally{this.refreshingDeferred=null,this._debug(s,"end")}}async _notifyAllSubscribers(e,r,n=!0){const s=`#_notifyAllSubscribers(${e})`;this._debug(s,"begin",r,`broadcast = ${n}`);try{this.broadcastChannel&&n&&this.broadcastChannel.postMessage({event:e,session:r});const c=[],l=Array.from(this.stateChangeEmitters.values()).map(async a=>{try{await a.callback(e,r)}catch(m){c.push(m)}});if(await Promise.all(l),c.length>0){for(let a=0;a<c.length;a+=1)console.error(c[a]);throw c[0]}}finally{this._debug(s,"end")}}async _saveSession(e){this._debug("#_saveSession()",e),this.suppressGetSessionWarning=!0;const r=Object.assign({},e),n=r.user&&r.user.__isUserNotAvailableProxy===!0;if(this.userStorage){!n&&r.user&&await tp(this.userStorage,this.storageKey+"-user",{user:r.user});const s=Object.assign({},r);delete s.user;const c=rD(s);await tp(this.storage,this.storageKey,c)}else{const s=rD(r);await tp(this.storage,this.storageKey,s)}}async _removeSession(){this._debug("#_removeSession()"),await qc(this.storage,this.storageKey),await qc(this.storage,this.storageKey+"-code-verifier"),await qc(this.storage,this.storageKey+"-user"),this.userStorage&&await qc(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const e=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{e&&go()&&(window!=null&&window.removeEventListener)&&window.removeEventListener("visibilitychange",e)}catch(r){console.error("removing visibilitychange callback failed",r)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const e=setInterval(()=>this._autoRefreshTokenTick(),ep);this.autoRefreshTicker=e,e&&typeof e=="object"&&typeof e.unref=="function"?e.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(e),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const e=this.autoRefreshTicker;this.autoRefreshTicker=null,e&&clearInterval(e)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const e=Date.now();try{return await this._useSession(async r=>{const{data:{session:n}}=r;if(!n||!n.refresh_token||!n.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const s=Math.floor((n.expires_at*1e3-e)/ep);this._debug("#_autoRefreshTokenTick()",`access token expires in ${s} ticks, a tick lasts ${ep}ms, refresh threshold is ${QT} ticks`),s<=QT&&await this._callRefreshToken(n.refresh_token)})}catch(r){console.error("Auto refresh tick failed with error. This is likely a transient error.",r)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(e){if(e.isAcquireTimeout||e instanceof bN)this._debug("auto refresh token tick lock not available");else throw e}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!go()||!(window!=null&&window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window==null||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(e){console.error("_handleVisibilityChange",e)}}async _onVisibilityChanged(e){const r=`#_onVisibilityChanged(${e})`;this._debug(r,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),e||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(r,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(e,r,n){const s=[`provider=${encodeURIComponent(r)}`];if(n!=null&&n.redirectTo&&s.push(`redirect_to=${encodeURIComponent(n.redirectTo)}`),n!=null&&n.scopes&&s.push(`scopes=${encodeURIComponent(n.scopes)}`),this.flowType==="pkce"){const[c,l]=await Gf(this.storage,this.storageKey),a=new URLSearchParams({code_challenge:`${encodeURIComponent(c)}`,code_challenge_method:`${encodeURIComponent(l)}`});s.push(a.toString())}if(n!=null&&n.queryParams){const c=new URLSearchParams(n.queryParams);s.push(c.toString())}return n!=null&&n.skipBrowserRedirect&&s.push(`skip_http_redirect=${n.skipBrowserRedirect}`),`${e}?${s.join("&")}`}async _unenroll(e){try{return await this._useSession(async r=>{var n;const{data:s,error:c}=r;return c?{data:null,error:c}:await rr(this.fetch,"DELETE",`${this.url}/factors/${e.factorId}`,{headers:this.headers,jwt:(n=s==null?void 0:s.session)===null||n===void 0?void 0:n.access_token})})}catch(r){if(Gt(r))return{data:null,error:r};throw r}}async _enroll(e){try{return await this._useSession(async r=>{var n,s;const{data:c,error:l}=r;if(l)return{data:null,error:l};const a=Object.assign({friendly_name:e.friendlyName,factor_type:e.factorType},e.factorType==="phone"?{phone:e.phone}:e.factorType==="totp"?{issuer:e.issuer}:{}),{data:m,error:y}=await rr(this.fetch,"POST",`${this.url}/factors`,{body:a,headers:this.headers,jwt:(n=c==null?void 0:c.session)===null||n===void 0?void 0:n.access_token});return y?{data:null,error:y}:(e.factorType==="totp"&&m.type==="totp"&&(!((s=m==null?void 0:m.totp)===null||s===void 0)&&s.qr_code)&&(m.totp.qr_code=`data:image/svg+xml;utf-8,${m.totp.qr_code}`),{data:m,error:null})})}catch(r){if(Gt(r))return{data:null,error:r};throw r}}async _verify(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async r=>{var n;const{data:s,error:c}=r;if(c)return{data:null,error:c};const l=Object.assign({challenge_id:e.challengeId},"webauthn"in e?{webauthn:Object.assign(Object.assign({},e.webauthn),{credential_response:e.webauthn.type==="create"?cY(e.webauthn.credential_response):uY(e.webauthn.credential_response)})}:{code:e.code}),{data:a,error:m}=await rr(this.fetch,"POST",`${this.url}/factors/${e.factorId}/verify`,{body:l,headers:this.headers,jwt:(n=s==null?void 0:s.session)===null||n===void 0?void 0:n.access_token});return m?{data:null,error:m}:(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+a.expires_in},a)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",a),{data:a,error:m})})}catch(r){if(Gt(r))return{data:null,error:r};throw r}})}async _challenge(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async r=>{var n;const{data:s,error:c}=r;if(c)return{data:null,error:c};const l=await rr(this.fetch,"POST",`${this.url}/factors/${e.factorId}/challenge`,{body:e,headers:this.headers,jwt:(n=s==null?void 0:s.session)===null||n===void 0?void 0:n.access_token});if(l.error)return l;const{data:a}=l;if(a.type!=="webauthn")return{data:a,error:null};switch(a.webauthn.type){case"create":return{data:Object.assign(Object.assign({},a),{webauthn:Object.assign(Object.assign({},a.webauthn),{credential_options:Object.assign(Object.assign({},a.webauthn.credential_options),{publicKey:aY(a.webauthn.credential_options.publicKey)})})}),error:null};case"request":return{data:Object.assign(Object.assign({},a),{webauthn:Object.assign(Object.assign({},a.webauthn),{credential_options:Object.assign(Object.assign({},a.webauthn.credential_options),{publicKey:lY(a.webauthn.credential_options.publicKey)})})}),error:null}}})}catch(r){if(Gt(r))return{data:null,error:r};throw r}})}async _challengeAndVerify(e){const{data:r,error:n}=await this._challenge({factorId:e.factorId});return n?{data:null,error:n}:await this._verify({factorId:e.factorId,challengeId:r.id,code:e.code})}async _listFactors(){var e;const{data:{user:r},error:n}=await this.getUser();if(n)return{data:null,error:n};const s={all:[],phone:[],totp:[],webauthn:[]};for(const c of(e=r==null?void 0:r.factors)!==null&&e!==void 0?e:[])s.all.push(c),c.status==="verified"&&s[c.factor_type].push(c);return{data:s,error:null}}async _getAuthenticatorAssuranceLevel(){return this._acquireLock(-1,async()=>await this._useSession(async e=>{var r,n;const{data:{session:s},error:c}=e;if(c)return{data:null,error:c};if(!s)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:l}=$2(s.access_token);let a=null;l.aal&&(a=l.aal);let m=a;((n=(r=s.user.factors)===null||r===void 0?void 0:r.filter(T=>T.status==="verified"))!==null&&n!==void 0?n:[]).length>0&&(m="aal2");const v=l.amr||[];return{data:{currentLevel:a,nextLevel:m,currentAuthenticationMethods:v},error:null}}))}async fetchJwk(e,r={keys:[]}){let n=r.keys.find(a=>a.kid===e);if(n)return n;const s=Date.now();if(n=this.jwks.keys.find(a=>a.kid===e),n&&this.jwks_cached_at+yX>s)return n;const{data:c,error:l}=await rr(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(l)throw l;return!c.keys||c.keys.length===0||(this.jwks=c,this.jwks_cached_at=s,n=c.keys.find(a=>a.kid===e),!n)?null:n}async getClaims(e,r={}){try{let n=e;if(!n){const{data:A,error:O}=await this.getSession();if(O||!A.session)return{data:null,error:O};n=A.session.access_token}const{header:s,payload:c,signature:l,raw:{header:a,payload:m}}=$2(n);r!=null&&r.allowExpired||FX(c.exp);const y=!s.alg||s.alg.startsWith("HS")||!s.kid||!("crypto"in globalThis&&"subtle"in globalThis.crypto)?null:await this.fetchJwk(s.kid,r!=null&&r.keys?{keys:r.keys}:r==null?void 0:r.jwks);if(!y){const{error:A}=await this.getUser(n);if(A)throw A;return{data:{claims:c,header:s,signature:l},error:null}}const v=BX(s.alg),T=await crypto.subtle.importKey("jwk",y,v,!0,["verify"]);if(!await crypto.subtle.verify(v,T,l,CX(`${a}.${m}`)))throw new tE("Invalid JWT signature");return{data:{claims:c,header:s,signature:l},error:null}}catch(n){if(Gt(n))return{data:null,error:n};throw n}}}d0.nextInstanceID=0;const vY=d0;class xY extends vY{constructor(e){super(e)}}var bY=function(t,e,r,n){function s(c){return c instanceof r?c:new r(function(l){l(c)})}return new(r||(r=Promise))(function(c,l){function a(v){try{y(n.next(v))}catch(T){l(T)}}function m(v){try{y(n.throw(v))}catch(T){l(T)}}function y(v){v.done?c(v.value):s(v.value).then(a,m)}y((n=n.apply(t,e||[])).next())})};class wY{constructor(e,r,n){var s,c,l;this.supabaseUrl=e,this.supabaseKey=r;const a=dX(e);if(!r)throw new Error("supabaseKey is required.");this.realtimeUrl=new URL("realtime/v1",a),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",a),this.storageUrl=new URL("storage/v1",a),this.functionsUrl=new URL("functions/v1",a);const m=`sb-${a.hostname.split(".")[0]}-auth-token`,y={db:rX,realtime:iX,auth:Object.assign(Object.assign({},nX),{storageKey:m}),global:tX},v=hX(n??{},y);this.storageKey=(s=v.auth.storageKey)!==null&&s!==void 0?s:"",this.headers=(c=v.global.headers)!==null&&c!==void 0?c:{},v.accessToken?(this.accessToken=v.accessToken,this.auth=new Proxy({},{get:(T,P)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(P)} is not possible`)}})):this.auth=this._initSupabaseAuthClient((l=v.auth)!==null&&l!==void 0?l:{},this.headers,v.global.fetch),this.fetch=lX(r,this._getAccessToken.bind(this),v.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},v.realtime)),this.rest=new _K(new URL("rest/v1",a).href,{headers:this.headers,schema:v.db.schema,fetch:this.fetch}),this.storage=new QK(this.storageUrl.href,this.headers,this.fetch,n==null?void 0:n.storage),v.accessToken||this._listenForAuthEvents()}get functions(){return new XZ(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}from(e){return this.rest.from(e)}schema(e){return this.rest.schema(e)}rpc(e,r={},n={head:!1,get:!1,count:void 0}){return this.rest.rpc(e,r,n)}channel(e,r={config:{}}){return this.realtime.channel(e,r)}getChannels(){return this.realtime.getChannels()}removeChannel(e){return this.realtime.removeChannel(e)}removeAllChannels(){return this.realtime.removeAllChannels()}_getAccessToken(){return bY(this,void 0,void 0,function*(){var e,r;if(this.accessToken)return yield this.accessToken();const{data:n}=yield this.auth.getSession();return(r=(e=n.session)===null||e===void 0?void 0:e.access_token)!==null&&r!==void 0?r:this.supabaseKey})}_initSupabaseAuthClient({autoRefreshToken:e,persistSession:r,detectSessionInUrl:n,storage:s,userStorage:c,storageKey:l,flowType:a,lock:m,debug:y},v,T){const P={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new xY({url:this.authUrl.href,headers:Object.assign(Object.assign({},P),v),storageKey:l,autoRefreshToken:e,persistSession:r,detectSessionInUrl:n,storage:s,userStorage:c,flowType:a,lock:m,debug:y,fetch:T,hasCustomAuthorizationHeader:Object.keys(this.headers).some(A=>A.toLowerCase()==="authorization")})}_initRealtimeClient(e){return new OK(this.realtimeUrl.href,Object.assign(Object.assign({},e),{params:Object.assign({apikey:this.supabaseKey},e==null?void 0:e.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((r,n)=>{this._handleTokenChanged(r,"CLIENT",n==null?void 0:n.access_token)})}_handleTokenChanged(e,r,n){(e==="TOKEN_REFRESHED"||e==="SIGNED_IN")&&this.changedAccessToken!==n?(this.changedAccessToken=n,this.realtime.setAuth(n)):e==="SIGNED_OUT"&&(this.realtime.setAuth(),r=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const SY=(t,e,r)=>new wY(t,e,r);function TY(){if(typeof window<"u"||typeof process>"u")return!1;const t=process.version;if(t==null)return!1;const e=t.match(/^v(\d+)\./);return e?parseInt(e[1],10)<=18:!1}TY()&&console.warn("  Node.js 18 and below are deprecated and will no longer be supported in future versions of @supabase/supabase-js. Please upgrade to Node.js 20 or later. For more information, visit: https://github.com/orgs/supabase/discussions/37217");const EY="https://ysyocsycftqmgafytieg.supabase.co",CY="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InlzeW9jc3ljZnRxbWdhZnl0aWVnIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjA3OTk1MzAsImV4cCI6MjA3NjM3NTUzMH0.mtWwuh21CpZaWI0eWQH4C7yOJtVyLxbN00KPeoysKdI",Zf=SY(EY,CY);var PY=t=>{switch(t){case"success":return MY;case"info":return RY;case"warning":return IY;case"error":return DY;default:return null}},AY=Array(12).fill(0),kY=({visible:t,className:e})=>bt.createElement("div",{className:["sonner-loading-wrapper",e].filter(Boolean).join(" "),"data-visible":t},bt.createElement("div",{className:"sonner-spinner"},AY.map((r,n)=>bt.createElement("div",{className:"sonner-loading-bar",key:`spinner-bar-${n}`})))),MY=bt.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},bt.createElement("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.857-9.809a.75.75 0 00-1.214-.882l-3.483 4.79-1.88-1.88a.75.75 0 10-1.06 1.061l2.5 2.5a.75.75 0 001.137-.089l4-5.5z",clipRule:"evenodd"})),IY=bt.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",height:"20",width:"20"},bt.createElement("path",{fillRule:"evenodd",d:"M9.401 3.003c1.155-2 4.043-2 5.197 0l7.355 12.748c1.154 2-.29 4.5-2.599 4.5H4.645c-2.309 0-3.752-2.5-2.598-4.5L9.4 3.003zM12 8.25a.75.75 0 01.75.75v3.75a.75.75 0 01-1.5 0V9a.75.75 0 01.75-.75zm0 8.25a.75.75 0 100-1.5.75.75 0 000 1.5z",clipRule:"evenodd"})),RY=bt.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},bt.createElement("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a.75.75 0 000 1.5h.253a.25.25 0 01.244.304l-.459 2.066A1.75 1.75 0 0010.747 15H11a.75.75 0 000-1.5h-.253a.25.25 0 01-.244-.304l.459-2.066A1.75 1.75 0 009.253 9H9z",clipRule:"evenodd"})),DY=bt.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},bt.createElement("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-8-5a.75.75 0 01.75.75v4.5a.75.75 0 01-1.5 0v-4.5A.75.75 0 0110 5zm0 10a1 1 0 100-2 1 1 0 000 2z",clipRule:"evenodd"})),LY=bt.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"},bt.createElement("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),bt.createElement("line",{x1:"6",y1:"6",x2:"18",y2:"18"})),OY=()=>{let[t,e]=bt.useState(document.hidden);return bt.useEffect(()=>{let r=()=>{e(document.hidden)};return document.addEventListener("visibilitychange",r),()=>window.removeEventListener("visibilitychange",r)},[]),t},rE=1,zY=class{constructor(){this.subscribe=e=>(this.subscribers.push(e),()=>{let r=this.subscribers.indexOf(e);this.subscribers.splice(r,1)}),this.publish=e=>{this.subscribers.forEach(r=>r(e))},this.addToast=e=>{this.publish(e),this.toasts=[...this.toasts,e]},this.create=e=>{var r;let{message:n,...s}=e,c=typeof(e==null?void 0:e.id)=="number"||((r=e.id)==null?void 0:r.length)>0?e.id:rE++,l=this.toasts.find(m=>m.id===c),a=e.dismissible===void 0?!0:e.dismissible;return this.dismissedToasts.has(c)&&this.dismissedToasts.delete(c),l?this.toasts=this.toasts.map(m=>m.id===c?(this.publish({...m,...e,id:c,title:n}),{...m,...e,id:c,dismissible:a,title:n}):m):this.addToast({title:n,...s,dismissible:a,id:c}),c},this.dismiss=e=>(this.dismissedToasts.add(e),e||this.toasts.forEach(r=>{this.subscribers.forEach(n=>n({id:r.id,dismiss:!0}))}),this.subscribers.forEach(r=>r({id:e,dismiss:!0})),e),this.message=(e,r)=>this.create({...r,message:e}),this.error=(e,r)=>this.create({...r,message:e,type:"error"}),this.success=(e,r)=>this.create({...r,type:"success",message:e}),this.info=(e,r)=>this.create({...r,type:"info",message:e}),this.warning=(e,r)=>this.create({...r,type:"warning",message:e}),this.loading=(e,r)=>this.create({...r,type:"loading",message:e}),this.promise=(e,r)=>{if(!r)return;let n;r.loading!==void 0&&(n=this.create({...r,promise:e,type:"loading",message:r.loading,description:typeof r.description!="function"?r.description:void 0}));let s=e instanceof Promise?e:e(),c=n!==void 0,l,a=s.then(async y=>{if(l=["resolve",y],bt.isValidElement(y))c=!1,this.create({id:n,type:"default",message:y});else if(jY(y)&&!y.ok){c=!1;let v=typeof r.error=="function"?await r.error(`HTTP error! status: ${y.status}`):r.error,T=typeof r.description=="function"?await r.description(`HTTP error! status: ${y.status}`):r.description;this.create({id:n,type:"error",message:v,description:T})}else if(r.success!==void 0){c=!1;let v=typeof r.success=="function"?await r.success(y):r.success,T=typeof r.description=="function"?await r.description(y):r.description;this.create({id:n,type:"success",message:v,description:T})}}).catch(async y=>{if(l=["reject",y],r.error!==void 0){c=!1;let v=typeof r.error=="function"?await r.error(y):r.error,T=typeof r.description=="function"?await r.description(y):r.description;this.create({id:n,type:"error",message:v,description:T})}}).finally(()=>{var y;c&&(this.dismiss(n),n=void 0),(y=r.finally)==null||y.call(r)}),m=()=>new Promise((y,v)=>a.then(()=>l[0]==="reject"?v(l[1]):y(l[1])).catch(v));return typeof n!="string"&&typeof n!="number"?{unwrap:m}:Object.assign(n,{unwrap:m})},this.custom=(e,r)=>{let n=(r==null?void 0:r.id)||rE++;return this.create({jsx:e(n),id:n,...r}),n},this.getActiveToasts=()=>this.toasts.filter(e=>!this.dismissedToasts.has(e.id)),this.subscribers=[],this.toasts=[],this.dismissedToasts=new Set}},Us=new zY,NY=(t,e)=>{let r=(e==null?void 0:e.id)||rE++;return Us.addToast({title:t,...e,id:r}),r},jY=t=>t&&typeof t=="object"&&"ok"in t&&typeof t.ok=="boolean"&&"status"in t&&typeof t.status=="number",FY=NY,BY=()=>Us.toasts,$Y=()=>Us.getActiveToasts(),Ya=Object.assign(FY,{success:Us.success,info:Us.info,warning:Us.warning,error:Us.error,custom:Us.custom,message:Us.message,promise:Us.promise,dismiss:Us.dismiss,loading:Us.loading},{getHistory:BY,getToasts:$Y});function VY(t,{insertAt:e}={}){if(typeof document>"u")return;let r=document.head||document.getElementsByTagName("head")[0],n=document.createElement("style");n.type="text/css",e==="top"&&r.firstChild?r.insertBefore(n,r.firstChild):r.appendChild(n),n.styleSheet?n.styleSheet.cssText=t:n.appendChild(document.createTextNode(t))}VY(`:where(html[dir="ltr"]),:where([data-sonner-toaster][dir="ltr"]){--toast-icon-margin-start: -3px;--toast-icon-margin-end: 4px;--toast-svg-margin-start: -1px;--toast-svg-margin-end: 0px;--toast-button-margin-start: auto;--toast-button-margin-end: 0;--toast-close-button-start: 0;--toast-close-button-end: unset;--toast-close-button-transform: translate(-35%, -35%)}:where(html[dir="rtl"]),:where([data-sonner-toaster][dir="rtl"]){--toast-icon-margin-start: 4px;--toast-icon-margin-end: -3px;--toast-svg-margin-start: 0px;--toast-svg-margin-end: -1px;--toast-button-margin-start: 0;--toast-button-margin-end: auto;--toast-close-button-start: unset;--toast-close-button-end: 0;--toast-close-button-transform: translate(35%, -35%)}:where([data-sonner-toaster]){position:fixed;width:var(--width);font-family:ui-sans-serif,system-ui,-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Arial,Noto Sans,sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol,Noto Color Emoji;--gray1: hsl(0, 0%, 99%);--gray2: hsl(0, 0%, 97.3%);--gray3: hsl(0, 0%, 95.1%);--gray4: hsl(0, 0%, 93%);--gray5: hsl(0, 0%, 90.9%);--gray6: hsl(0, 0%, 88.7%);--gray7: hsl(0, 0%, 85.8%);--gray8: hsl(0, 0%, 78%);--gray9: hsl(0, 0%, 56.1%);--gray10: hsl(0, 0%, 52.3%);--gray11: hsl(0, 0%, 43.5%);--gray12: hsl(0, 0%, 9%);--border-radius: 8px;box-sizing:border-box;padding:0;margin:0;list-style:none;outline:none;z-index:999999999;transition:transform .4s ease}:where([data-sonner-toaster][data-lifted="true"]){transform:translateY(-10px)}@media (hover: none) and (pointer: coarse){:where([data-sonner-toaster][data-lifted="true"]){transform:none}}:where([data-sonner-toaster][data-x-position="right"]){right:var(--offset-right)}:where([data-sonner-toaster][data-x-position="left"]){left:var(--offset-left)}:where([data-sonner-toaster][data-x-position="center"]){left:50%;transform:translate(-50%)}:where([data-sonner-toaster][data-y-position="top"]){top:var(--offset-top)}:where([data-sonner-toaster][data-y-position="bottom"]){bottom:var(--offset-bottom)}:where([data-sonner-toast]){--y: translateY(100%);--lift-amount: calc(var(--lift) * var(--gap));z-index:var(--z-index);position:absolute;opacity:0;transform:var(--y);filter:blur(0);touch-action:none;transition:transform .4s,opacity .4s,height .4s,box-shadow .2s;box-sizing:border-box;outline:none;overflow-wrap:anywhere}:where([data-sonner-toast][data-styled="true"]){padding:16px;background:var(--normal-bg);border:1px solid var(--normal-border);color:var(--normal-text);border-radius:var(--border-radius);box-shadow:0 4px 12px #0000001a;width:var(--width);font-size:13px;display:flex;align-items:center;gap:6px}:where([data-sonner-toast]:focus-visible){box-shadow:0 4px 12px #0000001a,0 0 0 2px #0003}:where([data-sonner-toast][data-y-position="top"]){top:0;--y: translateY(-100%);--lift: 1;--lift-amount: calc(1 * var(--gap))}:where([data-sonner-toast][data-y-position="bottom"]){bottom:0;--y: translateY(100%);--lift: -1;--lift-amount: calc(var(--lift) * var(--gap))}:where([data-sonner-toast]) :where([data-description]){font-weight:400;line-height:1.4;color:inherit}:where([data-sonner-toast]) :where([data-title]){font-weight:500;line-height:1.5;color:inherit}:where([data-sonner-toast]) :where([data-icon]){display:flex;height:16px;width:16px;position:relative;justify-content:flex-start;align-items:center;flex-shrink:0;margin-left:var(--toast-icon-margin-start);margin-right:var(--toast-icon-margin-end)}:where([data-sonner-toast][data-promise="true"]) :where([data-icon])>svg{opacity:0;transform:scale(.8);transform-origin:center;animation:sonner-fade-in .3s ease forwards}:where([data-sonner-toast]) :where([data-icon])>*{flex-shrink:0}:where([data-sonner-toast]) :where([data-icon]) svg{margin-left:var(--toast-svg-margin-start);margin-right:var(--toast-svg-margin-end)}:where([data-sonner-toast]) :where([data-content]){display:flex;flex-direction:column;gap:2px}[data-sonner-toast][data-styled=true] [data-button]{border-radius:4px;padding-left:8px;padding-right:8px;height:24px;font-size:12px;color:var(--normal-bg);background:var(--normal-text);margin-left:var(--toast-button-margin-start);margin-right:var(--toast-button-margin-end);border:none;cursor:pointer;outline:none;display:flex;align-items:center;flex-shrink:0;transition:opacity .4s,box-shadow .2s}:where([data-sonner-toast]) :where([data-button]):focus-visible{box-shadow:0 0 0 2px #0006}:where([data-sonner-toast]) :where([data-button]):first-of-type{margin-left:var(--toast-button-margin-start);margin-right:var(--toast-button-margin-end)}:where([data-sonner-toast]) :where([data-cancel]){color:var(--normal-text);background:rgba(0,0,0,.08)}:where([data-sonner-toast][data-theme="dark"]) :where([data-cancel]){background:rgba(255,255,255,.3)}:where([data-sonner-toast]) :where([data-close-button]){position:absolute;left:var(--toast-close-button-start);right:var(--toast-close-button-end);top:0;height:20px;width:20px;display:flex;justify-content:center;align-items:center;padding:0;color:var(--gray12);border:1px solid var(--gray4);transform:var(--toast-close-button-transform);border-radius:50%;cursor:pointer;z-index:1;transition:opacity .1s,background .2s,border-color .2s}[data-sonner-toast] [data-close-button]{background:var(--gray1)}:where([data-sonner-toast]) :where([data-close-button]):focus-visible{box-shadow:0 4px 12px #0000001a,0 0 0 2px #0003}:where([data-sonner-toast]) :where([data-disabled="true"]){cursor:not-allowed}:where([data-sonner-toast]):hover :where([data-close-button]):hover{background:var(--gray2);border-color:var(--gray5)}:where([data-sonner-toast][data-swiping="true"]):before{content:"";position:absolute;left:-50%;right:-50%;height:100%;z-index:-1}:where([data-sonner-toast][data-y-position="top"][data-swiping="true"]):before{bottom:50%;transform:scaleY(3) translateY(50%)}:where([data-sonner-toast][data-y-position="bottom"][data-swiping="true"]):before{top:50%;transform:scaleY(3) translateY(-50%)}:where([data-sonner-toast][data-swiping="false"][data-removed="true"]):before{content:"";position:absolute;inset:0;transform:scaleY(2)}:where([data-sonner-toast]):after{content:"";position:absolute;left:0;height:calc(var(--gap) + 1px);bottom:100%;width:100%}:where([data-sonner-toast][data-mounted="true"]){--y: translateY(0);opacity:1}:where([data-sonner-toast][data-expanded="false"][data-front="false"]){--scale: var(--toasts-before) * .05 + 1;--y: translateY(calc(var(--lift-amount) * var(--toasts-before))) scale(calc(-1 * var(--scale)));height:var(--front-toast-height)}:where([data-sonner-toast])>*{transition:opacity .4s}:where([data-sonner-toast][data-expanded="false"][data-front="false"][data-styled="true"])>*{opacity:0}:where([data-sonner-toast][data-visible="false"]){opacity:0;pointer-events:none}:where([data-sonner-toast][data-mounted="true"][data-expanded="true"]){--y: translateY(calc(var(--lift) * var(--offset)));height:var(--initial-height)}:where([data-sonner-toast][data-removed="true"][data-front="true"][data-swipe-out="false"]){--y: translateY(calc(var(--lift) * -100%));opacity:0}:where([data-sonner-toast][data-removed="true"][data-front="false"][data-swipe-out="false"][data-expanded="true"]){--y: translateY(calc(var(--lift) * var(--offset) + var(--lift) * -100%));opacity:0}:where([data-sonner-toast][data-removed="true"][data-front="false"][data-swipe-out="false"][data-expanded="false"]){--y: translateY(40%);opacity:0;transition:transform .5s,opacity .2s}:where([data-sonner-toast][data-removed="true"][data-front="false"]):before{height:calc(var(--initial-height) + 20%)}[data-sonner-toast][data-swiping=true]{transform:var(--y) translateY(var(--swipe-amount-y, 0px)) translate(var(--swipe-amount-x, 0px));transition:none}[data-sonner-toast][data-swiped=true]{user-select:none}[data-sonner-toast][data-swipe-out=true][data-y-position=bottom],[data-sonner-toast][data-swipe-out=true][data-y-position=top]{animation-duration:.2s;animation-timing-function:ease-out;animation-fill-mode:forwards}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=left]{animation-name:swipe-out-left}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=right]{animation-name:swipe-out-right}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=up]{animation-name:swipe-out-up}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=down]{animation-name:swipe-out-down}@keyframes swipe-out-left{0%{transform:var(--y) translate(var(--swipe-amount-x));opacity:1}to{transform:var(--y) translate(calc(var(--swipe-amount-x) - 100%));opacity:0}}@keyframes swipe-out-right{0%{transform:var(--y) translate(var(--swipe-amount-x));opacity:1}to{transform:var(--y) translate(calc(var(--swipe-amount-x) + 100%));opacity:0}}@keyframes swipe-out-up{0%{transform:var(--y) translateY(var(--swipe-amount-y));opacity:1}to{transform:var(--y) translateY(calc(var(--swipe-amount-y) - 100%));opacity:0}}@keyframes swipe-out-down{0%{transform:var(--y) translateY(var(--swipe-amount-y));opacity:1}to{transform:var(--y) translateY(calc(var(--swipe-amount-y) + 100%));opacity:0}}@media (max-width: 600px){[data-sonner-toaster]{position:fixed;right:var(--mobile-offset-right);left:var(--mobile-offset-left);width:100%}[data-sonner-toaster][dir=rtl]{left:calc(var(--mobile-offset-left) * -1)}[data-sonner-toaster] [data-sonner-toast]{left:0;right:0;width:calc(100% - var(--mobile-offset-left) * 2)}[data-sonner-toaster][data-x-position=left]{left:var(--mobile-offset-left)}[data-sonner-toaster][data-y-position=bottom]{bottom:var(--mobile-offset-bottom)}[data-sonner-toaster][data-y-position=top]{top:var(--mobile-offset-top)}[data-sonner-toaster][data-x-position=center]{left:var(--mobile-offset-left);right:var(--mobile-offset-right);transform:none}}[data-sonner-toaster][data-theme=light]{--normal-bg: #fff;--normal-border: var(--gray4);--normal-text: var(--gray12);--success-bg: hsl(143, 85%, 96%);--success-border: hsl(145, 92%, 91%);--success-text: hsl(140, 100%, 27%);--info-bg: hsl(208, 100%, 97%);--info-border: hsl(221, 91%, 91%);--info-text: hsl(210, 92%, 45%);--warning-bg: hsl(49, 100%, 97%);--warning-border: hsl(49, 91%, 91%);--warning-text: hsl(31, 92%, 45%);--error-bg: hsl(359, 100%, 97%);--error-border: hsl(359, 100%, 94%);--error-text: hsl(360, 100%, 45%)}[data-sonner-toaster][data-theme=light] [data-sonner-toast][data-invert=true]{--normal-bg: #000;--normal-border: hsl(0, 0%, 20%);--normal-text: var(--gray1)}[data-sonner-toaster][data-theme=dark] [data-sonner-toast][data-invert=true]{--normal-bg: #fff;--normal-border: var(--gray3);--normal-text: var(--gray12)}[data-sonner-toaster][data-theme=dark]{--normal-bg: #000;--normal-bg-hover: hsl(0, 0%, 12%);--normal-border: hsl(0, 0%, 20%);--normal-border-hover: hsl(0, 0%, 25%);--normal-text: var(--gray1);--success-bg: hsl(150, 100%, 6%);--success-border: hsl(147, 100%, 12%);--success-text: hsl(150, 86%, 65%);--info-bg: hsl(215, 100%, 6%);--info-border: hsl(223, 100%, 12%);--info-text: hsl(216, 87%, 65%);--warning-bg: hsl(64, 100%, 6%);--warning-border: hsl(60, 100%, 12%);--warning-text: hsl(46, 87%, 65%);--error-bg: hsl(358, 76%, 10%);--error-border: hsl(357, 89%, 16%);--error-text: hsl(358, 100%, 81%)}[data-sonner-toaster][data-theme=dark] [data-sonner-toast] [data-close-button]{background:var(--normal-bg);border-color:var(--normal-border);color:var(--normal-text)}[data-sonner-toaster][data-theme=dark] [data-sonner-toast] [data-close-button]:hover{background:var(--normal-bg-hover);border-color:var(--normal-border-hover)}[data-rich-colors=true][data-sonner-toast][data-type=success],[data-rich-colors=true][data-sonner-toast][data-type=success] [data-close-button]{background:var(--success-bg);border-color:var(--success-border);color:var(--success-text)}[data-rich-colors=true][data-sonner-toast][data-type=info],[data-rich-colors=true][data-sonner-toast][data-type=info] [data-close-button]{background:var(--info-bg);border-color:var(--info-border);color:var(--info-text)}[data-rich-colors=true][data-sonner-toast][data-type=warning],[data-rich-colors=true][data-sonner-toast][data-type=warning] [data-close-button]{background:var(--warning-bg);border-color:var(--warning-border);color:var(--warning-text)}[data-rich-colors=true][data-sonner-toast][data-type=error],[data-rich-colors=true][data-sonner-toast][data-type=error] [data-close-button]{background:var(--error-bg);border-color:var(--error-border);color:var(--error-text)}.sonner-loading-wrapper{--size: 16px;height:var(--size);width:var(--size);position:absolute;inset:0;z-index:10}.sonner-loading-wrapper[data-visible=false]{transform-origin:center;animation:sonner-fade-out .2s ease forwards}.sonner-spinner{position:relative;top:50%;left:50%;height:var(--size);width:var(--size)}.sonner-loading-bar{animation:sonner-spin 1.2s linear infinite;background:var(--gray11);border-radius:6px;height:8%;left:-10%;position:absolute;top:-3.9%;width:24%}.sonner-loading-bar:nth-child(1){animation-delay:-1.2s;transform:rotate(.0001deg) translate(146%)}.sonner-loading-bar:nth-child(2){animation-delay:-1.1s;transform:rotate(30deg) translate(146%)}.sonner-loading-bar:nth-child(3){animation-delay:-1s;transform:rotate(60deg) translate(146%)}.sonner-loading-bar:nth-child(4){animation-delay:-.9s;transform:rotate(90deg) translate(146%)}.sonner-loading-bar:nth-child(5){animation-delay:-.8s;transform:rotate(120deg) translate(146%)}.sonner-loading-bar:nth-child(6){animation-delay:-.7s;transform:rotate(150deg) translate(146%)}.sonner-loading-bar:nth-child(7){animation-delay:-.6s;transform:rotate(180deg) translate(146%)}.sonner-loading-bar:nth-child(8){animation-delay:-.5s;transform:rotate(210deg) translate(146%)}.sonner-loading-bar:nth-child(9){animation-delay:-.4s;transform:rotate(240deg) translate(146%)}.sonner-loading-bar:nth-child(10){animation-delay:-.3s;transform:rotate(270deg) translate(146%)}.sonner-loading-bar:nth-child(11){animation-delay:-.2s;transform:rotate(300deg) translate(146%)}.sonner-loading-bar:nth-child(12){animation-delay:-.1s;transform:rotate(330deg) translate(146%)}@keyframes sonner-fade-in{0%{opacity:0;transform:scale(.8)}to{opacity:1;transform:scale(1)}}@keyframes sonner-fade-out{0%{opacity:1;transform:scale(1)}to{opacity:0;transform:scale(.8)}}@keyframes sonner-spin{0%{opacity:1}to{opacity:.15}}@media (prefers-reduced-motion){[data-sonner-toast],[data-sonner-toast]>*,.sonner-loading-bar{transition:none!important;animation:none!important}}.sonner-loader{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);transform-origin:center;transition:opacity .2s,transform .2s}.sonner-loader[data-visible=false]{opacity:0;transform:scale(.8) translate(-50%,-50%)}
`);function $v(t){return t.label!==void 0}var UY=3,GY="32px",WY="16px",cD=4e3,qY=356,HY=14,ZY=20,KY=200;function da(...t){return t.filter(Boolean).join(" ")}function XY(t){let[e,r]=t.split("-"),n=[];return e&&n.push(e),r&&n.push(r),n}var YY=t=>{var e,r,n,s,c,l,a,m,y,v,T;let{invert:P,toast:A,unstyled:O,interacting:I,setHeights:L,visibleToasts:R,heights:z,index:j,toasts:W,expanded:Z,removeToast:te,defaultRichColors:ie,closeButton:V,style:q,cancelButtonStyle:Q,actionButtonStyle:ce,className:se="",descriptionClassName:ue="",duration:he,position:ye,gap:xe,loadingIcon:Se,expandByDefault:fe,classNames:ve,icons:Re,closeButtonAriaLabel:$e="Close toast",pauseWhenPageIsHidden:Xe}=t,[st,at]=bt.useState(null),[_t,Ct]=bt.useState(null),[Pt,Ht]=bt.useState(!1),[ir,yr]=bt.useState(!1),[$t,vt]=bt.useState(!1),[Et,Rt]=bt.useState(!1),[Ft,Nr]=bt.useState(!1),[Zr,Kr]=bt.useState(0),[Ar,Gn]=bt.useState(0),Nn=bt.useRef(A.duration||he||cD),xi=bt.useRef(null),rn=bt.useRef(null),Zt=j===0,Or=j+1<=R,St=A.type,Sn=A.dismissible!==!1,Br=A.className||"",Me=A.descriptionClassName||"",ne=bt.useMemo(()=>z.findIndex(wt=>wt.toastId===A.id)||0,[z,A.id]),oe=bt.useMemo(()=>{var wt;return(wt=A.closeButton)!=null?wt:V},[A.closeButton,V]),de=bt.useMemo(()=>A.duration||he||cD,[A.duration,he]),we=bt.useRef(0),Ae=bt.useRef(0),Oe=bt.useRef(0),Be=bt.useRef(null),[ze,He]=ye.split("-"),nt=bt.useMemo(()=>z.reduce((wt,lt,Dt)=>Dt>=ne?wt:wt+lt.height,0),[z,ne]),Qe=OY(),Tt=A.invert||P,It=St==="loading";Ae.current=bt.useMemo(()=>ne*xe+nt,[ne,nt]),bt.useEffect(()=>{Nn.current=de},[de]),bt.useEffect(()=>{Ht(!0)},[]),bt.useEffect(()=>{let wt=rn.current;if(wt){let lt=wt.getBoundingClientRect().height;return Gn(lt),L(Dt=>[{toastId:A.id,height:lt,position:A.position},...Dt]),()=>L(Dt=>Dt.filter(_r=>_r.toastId!==A.id))}},[L,A.id]),bt.useLayoutEffect(()=>{if(!Pt)return;let wt=rn.current,lt=wt.style.height;wt.style.height="auto";let Dt=wt.getBoundingClientRect().height;wt.style.height=lt,Gn(Dt),L(_r=>_r.find(xr=>xr.toastId===A.id)?_r.map(xr=>xr.toastId===A.id?{...xr,height:Dt}:xr):[{toastId:A.id,height:Dt,position:A.position},..._r])},[Pt,A.title,A.description,L,A.id]);let je=bt.useCallback(()=>{yr(!0),Kr(Ae.current),L(wt=>wt.filter(lt=>lt.toastId!==A.id)),setTimeout(()=>{te(A)},KY)},[A,te,L,Ae]);bt.useEffect(()=>{if(A.promise&&St==="loading"||A.duration===1/0||A.type==="loading")return;let wt;return Z||I||Xe&&Qe?(()=>{if(Oe.current<we.current){let lt=new Date().getTime()-we.current;Nn.current=Nn.current-lt}Oe.current=new Date().getTime()})():Nn.current!==1/0&&(we.current=new Date().getTime(),wt=setTimeout(()=>{var lt;(lt=A.onAutoClose)==null||lt.call(A,A),je()},Nn.current)),()=>clearTimeout(wt)},[Z,I,A,St,Xe,Qe,je]),bt.useEffect(()=>{A.delete&&je()},[je,A.delete]);function Kt(){var wt,lt,Dt;return Re!=null&&Re.loading?bt.createElement("div",{className:da(ve==null?void 0:ve.loader,(wt=A==null?void 0:A.classNames)==null?void 0:wt.loader,"sonner-loader"),"data-visible":St==="loading"},Re.loading):Se?bt.createElement("div",{className:da(ve==null?void 0:ve.loader,(lt=A==null?void 0:A.classNames)==null?void 0:lt.loader,"sonner-loader"),"data-visible":St==="loading"},Se):bt.createElement(kY,{className:da(ve==null?void 0:ve.loader,(Dt=A==null?void 0:A.classNames)==null?void 0:Dt.loader),visible:St==="loading"})}return bt.createElement("li",{tabIndex:0,ref:rn,className:da(se,Br,ve==null?void 0:ve.toast,(e=A==null?void 0:A.classNames)==null?void 0:e.toast,ve==null?void 0:ve.default,ve==null?void 0:ve[St],(r=A==null?void 0:A.classNames)==null?void 0:r[St]),"data-sonner-toast":"","data-rich-colors":(n=A.richColors)!=null?n:ie,"data-styled":!(A.jsx||A.unstyled||O),"data-mounted":Pt,"data-promise":!!A.promise,"data-swiped":Ft,"data-removed":ir,"data-visible":Or,"data-y-position":ze,"data-x-position":He,"data-index":j,"data-front":Zt,"data-swiping":$t,"data-dismissible":Sn,"data-type":St,"data-invert":Tt,"data-swipe-out":Et,"data-swipe-direction":_t,"data-expanded":!!(Z||fe&&Pt),style:{"--index":j,"--toasts-before":j,"--z-index":W.length-j,"--offset":`${ir?Zr:Ae.current}px`,"--initial-height":fe?"auto":`${Ar}px`,...q,...A.style},onDragEnd:()=>{vt(!1),at(null),Be.current=null},onPointerDown:wt=>{It||!Sn||(xi.current=new Date,Kr(Ae.current),wt.target.setPointerCapture(wt.pointerId),wt.target.tagName!=="BUTTON"&&(vt(!0),Be.current={x:wt.clientX,y:wt.clientY}))},onPointerUp:()=>{var wt,lt,Dt,_r;if(Et||!Sn)return;Be.current=null;let xr=Number(((wt=rn.current)==null?void 0:wt.style.getPropertyValue("--swipe-amount-x").replace("px",""))||0),kr=Number(((lt=rn.current)==null?void 0:lt.style.getPropertyValue("--swipe-amount-y").replace("px",""))||0),Vr=new Date().getTime()-((Dt=xi.current)==null?void 0:Dt.getTime()),tr=st==="x"?xr:kr,zr=Math.abs(tr)/Vr;if(Math.abs(tr)>=ZY||zr>.11){Kr(Ae.current),(_r=A.onDismiss)==null||_r.call(A,A),Ct(st==="x"?xr>0?"right":"left":kr>0?"down":"up"),je(),Rt(!0),Nr(!1);return}vt(!1),at(null)},onPointerMove:wt=>{var lt,Dt,_r,xr;if(!Be.current||!Sn||((lt=window.getSelection())==null?void 0:lt.toString().length)>0)return;let kr=wt.clientY-Be.current.y,Vr=wt.clientX-Be.current.x,tr=(Dt=t.swipeDirections)!=null?Dt:XY(ye);!st&&(Math.abs(Vr)>1||Math.abs(kr)>1)&&at(Math.abs(Vr)>Math.abs(kr)?"x":"y");let zr={x:0,y:0};st==="y"?(tr.includes("top")||tr.includes("bottom"))&&(tr.includes("top")&&kr<0||tr.includes("bottom")&&kr>0)&&(zr.y=kr):st==="x"&&(tr.includes("left")||tr.includes("right"))&&(tr.includes("left")&&Vr<0||tr.includes("right")&&Vr>0)&&(zr.x=Vr),(Math.abs(zr.x)>0||Math.abs(zr.y)>0)&&Nr(!0),(_r=rn.current)==null||_r.style.setProperty("--swipe-amount-x",`${zr.x}px`),(xr=rn.current)==null||xr.style.setProperty("--swipe-amount-y",`${zr.y}px`)}},oe&&!A.jsx?bt.createElement("button",{"aria-label":$e,"data-disabled":It,"data-close-button":!0,onClick:It||!Sn?()=>{}:()=>{var wt;je(),(wt=A.onDismiss)==null||wt.call(A,A)},className:da(ve==null?void 0:ve.closeButton,(s=A==null?void 0:A.classNames)==null?void 0:s.closeButton)},(c=Re==null?void 0:Re.close)!=null?c:LY):null,A.jsx||X.isValidElement(A.title)?A.jsx?A.jsx:typeof A.title=="function"?A.title():A.title:bt.createElement(bt.Fragment,null,St||A.icon||A.promise?bt.createElement("div",{"data-icon":"",className:da(ve==null?void 0:ve.icon,(l=A==null?void 0:A.classNames)==null?void 0:l.icon)},A.promise||A.type==="loading"&&!A.icon?A.icon||Kt():null,A.type!=="loading"?A.icon||(Re==null?void 0:Re[St])||PY(St):null):null,bt.createElement("div",{"data-content":"",className:da(ve==null?void 0:ve.content,(a=A==null?void 0:A.classNames)==null?void 0:a.content)},bt.createElement("div",{"data-title":"",className:da(ve==null?void 0:ve.title,(m=A==null?void 0:A.classNames)==null?void 0:m.title)},typeof A.title=="function"?A.title():A.title),A.description?bt.createElement("div",{"data-description":"",className:da(ue,Me,ve==null?void 0:ve.description,(y=A==null?void 0:A.classNames)==null?void 0:y.description)},typeof A.description=="function"?A.description():A.description):null),X.isValidElement(A.cancel)?A.cancel:A.cancel&&$v(A.cancel)?bt.createElement("button",{"data-button":!0,"data-cancel":!0,style:A.cancelButtonStyle||Q,onClick:wt=>{var lt,Dt;$v(A.cancel)&&Sn&&((Dt=(lt=A.cancel).onClick)==null||Dt.call(lt,wt),je())},className:da(ve==null?void 0:ve.cancelButton,(v=A==null?void 0:A.classNames)==null?void 0:v.cancelButton)},A.cancel.label):null,X.isValidElement(A.action)?A.action:A.action&&$v(A.action)?bt.createElement("button",{"data-button":!0,"data-action":!0,style:A.actionButtonStyle||ce,onClick:wt=>{var lt,Dt;$v(A.action)&&((Dt=(lt=A.action).onClick)==null||Dt.call(lt,wt),!wt.defaultPrevented&&je())},className:da(ve==null?void 0:ve.actionButton,(T=A==null?void 0:A.classNames)==null?void 0:T.actionButton)},A.action.label):null))};function uD(){if(typeof window>"u"||typeof document>"u")return"ltr";let t=document.documentElement.getAttribute("dir");return t==="auto"||!t?window.getComputedStyle(document.documentElement).direction:t}function QY(t,e){let r={};return[t,e].forEach((n,s)=>{let c=s===1,l=c?"--mobile-offset":"--offset",a=c?WY:GY;function m(y){["top","right","bottom","left"].forEach(v=>{r[`${l}-${v}`]=typeof y=="number"?`${y}px`:y})}typeof n=="number"||typeof n=="string"?m(n):typeof n=="object"?["top","right","bottom","left"].forEach(y=>{n[y]===void 0?r[`${l}-${y}`]=a:r[`${l}-${y}`]=typeof n[y]=="number"?`${n[y]}px`:n[y]}):m(a)}),r}var JY=X.forwardRef(function(t,e){let{invert:r,position:n="bottom-right",hotkey:s=["altKey","KeyT"],expand:c,closeButton:l,className:a,offset:m,mobileOffset:y,theme:v="light",richColors:T,duration:P,style:A,visibleToasts:O=UY,toastOptions:I,dir:L=uD(),gap:R=HY,loadingIcon:z,icons:j,containerAriaLabel:W="Notifications",pauseWhenPageIsHidden:Z}=t,[te,ie]=bt.useState([]),V=bt.useMemo(()=>Array.from(new Set([n].concat(te.filter(Xe=>Xe.position).map(Xe=>Xe.position)))),[te,n]),[q,Q]=bt.useState([]),[ce,se]=bt.useState(!1),[ue,he]=bt.useState(!1),[ye,xe]=bt.useState(v!=="system"?v:typeof window<"u"&&window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"),Se=bt.useRef(null),fe=s.join("+").replace(/Key/g,"").replace(/Digit/g,""),ve=bt.useRef(null),Re=bt.useRef(!1),$e=bt.useCallback(Xe=>{ie(st=>{var at;return(at=st.find(_t=>_t.id===Xe.id))!=null&&at.delete||Us.dismiss(Xe.id),st.filter(({id:_t})=>_t!==Xe.id)})},[]);return bt.useEffect(()=>Us.subscribe(Xe=>{if(Xe.dismiss){ie(st=>st.map(at=>at.id===Xe.id?{...at,delete:!0}:at));return}setTimeout(()=>{Xz.flushSync(()=>{ie(st=>{let at=st.findIndex(_t=>_t.id===Xe.id);return at!==-1?[...st.slice(0,at),{...st[at],...Xe},...st.slice(at+1)]:[Xe,...st]})})})}),[]),bt.useEffect(()=>{if(v!=="system"){xe(v);return}if(v==="system"&&(window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?xe("dark"):xe("light")),typeof window>"u")return;let Xe=window.matchMedia("(prefers-color-scheme: dark)");try{Xe.addEventListener("change",({matches:st})=>{xe(st?"dark":"light")})}catch{Xe.addListener(({matches:at})=>{try{xe(at?"dark":"light")}catch(_t){console.error(_t)}})}},[v]),bt.useEffect(()=>{te.length<=1&&se(!1)},[te]),bt.useEffect(()=>{let Xe=st=>{var at,_t;s.every(Ct=>st[Ct]||st.code===Ct)&&(se(!0),(at=Se.current)==null||at.focus()),st.code==="Escape"&&(document.activeElement===Se.current||(_t=Se.current)!=null&&_t.contains(document.activeElement))&&se(!1)};return document.addEventListener("keydown",Xe),()=>document.removeEventListener("keydown",Xe)},[s]),bt.useEffect(()=>{if(Se.current)return()=>{ve.current&&(ve.current.focus({preventScroll:!0}),ve.current=null,Re.current=!1)}},[Se.current]),bt.createElement("section",{ref:e,"aria-label":`${W} ${fe}`,tabIndex:-1,"aria-live":"polite","aria-relevant":"additions text","aria-atomic":"false",suppressHydrationWarning:!0},V.map((Xe,st)=>{var at;let[_t,Ct]=Xe.split("-");return te.length?bt.createElement("ol",{key:Xe,dir:L==="auto"?uD():L,tabIndex:-1,ref:Se,className:a,"data-sonner-toaster":!0,"data-theme":ye,"data-y-position":_t,"data-lifted":ce&&te.length>1&&!c,"data-x-position":Ct,style:{"--front-toast-height":`${((at=q[0])==null?void 0:at.height)||0}px`,"--width":`${qY}px`,"--gap":`${R}px`,...A,...QY(m,y)},onBlur:Pt=>{Re.current&&!Pt.currentTarget.contains(Pt.relatedTarget)&&(Re.current=!1,ve.current&&(ve.current.focus({preventScroll:!0}),ve.current=null))},onFocus:Pt=>{Pt.target instanceof HTMLElement&&Pt.target.dataset.dismissible==="false"||Re.current||(Re.current=!0,ve.current=Pt.relatedTarget)},onMouseEnter:()=>se(!0),onMouseMove:()=>se(!0),onMouseLeave:()=>{ue||se(!1)},onDragEnd:()=>se(!1),onPointerDown:Pt=>{Pt.target instanceof HTMLElement&&Pt.target.dataset.dismissible==="false"||he(!0)},onPointerUp:()=>he(!1)},te.filter(Pt=>!Pt.position&&st===0||Pt.position===Xe).map((Pt,Ht)=>{var ir,yr;return bt.createElement(YY,{key:Pt.id,icons:j,index:Ht,toast:Pt,defaultRichColors:T,duration:(ir=I==null?void 0:I.duration)!=null?ir:P,className:I==null?void 0:I.className,descriptionClassName:I==null?void 0:I.descriptionClassName,invert:r,visibleToasts:O,closeButton:(yr=I==null?void 0:I.closeButton)!=null?yr:l,interacting:ue,position:Xe,style:I==null?void 0:I.style,unstyled:I==null?void 0:I.unstyled,classNames:I==null?void 0:I.classNames,cancelButtonStyle:I==null?void 0:I.cancelButtonStyle,actionButtonStyle:I==null?void 0:I.actionButtonStyle,removeToast:$e,toasts:te.filter($t=>$t.position==Pt.position),heights:q.filter($t=>$t.position==Pt.position),setHeights:Q,expandByDefault:c,gap:R,loadingIcon:z,expanded:ce,pauseWhenPageIsHidden:Z,swipeDirections:t.swipeDirections})})):null}))});const EN=X.createContext(void 0),eQ=({children:t})=>{const[e,r]=X.useState(null),[n,s]=X.useState(null),[c,l]=X.useState(!0);X.useEffect(()=>{Zf.auth.getSession().then(({data:{session:P}})=>{r(P),s((P==null?void 0:P.user)??null),l(!1)});const{data:{subscription:T}}=Zf.auth.onAuthStateChange((P,A)=>{r(A),s((A==null?void 0:A.user)??null),l(!1)});return()=>T.unsubscribe()},[]);const a=async(T,P)=>{try{l(!0);const{error:A}=await Zf.auth.signInWithPassword({email:T,password:P});if(A)throw A;Ya.success("Signed in successfully")}catch(A){throw Ya.error(A.message||"Error signing in"),A}finally{l(!1)}},m=async(T,P)=>{try{l(!0);const{error:A}=await Zf.auth.signUp({email:T,password:P});if(A)throw A;Ya.success("Account created! Please check your email to confirm your account.")}catch(A){throw Ya.error(A.message||"Error creating account"),A}finally{l(!1)}},y=async T=>{try{l(!0);const{error:P}=await Zf.auth.signInWithOAuth({provider:T,options:{redirectTo:window.location.origin}});if(P)throw P}catch(P){throw Ya.error(P.message||`Error signing in with ${T}`),P}finally{l(!1)}},v=async()=>{try{l(!0),await Zf.auth.signOut(),Ya.success("Signed out successfully")}catch(T){Ya.error(T.message||"Error signing out")}finally{l(!1)}};return B.jsx(EN.Provider,{value:{session:e,user:n,loading:c,signIn:a,signUp:m,signInWithSocial:y,signOut:v},children:t})},tQ=()=>{const t=X.useContext(EN);if(t===void 0)throw new Error("useAuth must be used within an AuthProvider");return t},c1=()=>tQ();function Rr(t,e,{checkForDefaultPrevented:r=!0}={}){return function(s){if(t==null||t(s),r===!1||!s.defaultPrevented)return e==null?void 0:e(s)}}function hD(t,e){if(typeof t=="function")return t(e);t!=null&&(t.current=e)}function CN(...t){return e=>{let r=!1;const n=t.map(s=>{const c=hD(s,e);return!r&&typeof c=="function"&&(r=!0),c});if(r)return()=>{for(let s=0;s<n.length;s++){const c=n[s];typeof c=="function"?c():hD(t[s],null)}}}}function ms(...t){return X.useCallback(CN(...t),t)}function rQ(t,e){const r=X.createContext(e),n=c=>{const{children:l,...a}=c,m=X.useMemo(()=>a,Object.values(a));return B.jsx(r.Provider,{value:m,children:l})};n.displayName=t+"Provider";function s(c){const l=X.useContext(r);if(l)return l;if(e!==void 0)return e;throw new Error(`\`${c}\` must be used within \`${t}\``)}return[n,s]}function Dd(t,e=[]){let r=[];function n(c,l){const a=X.createContext(l),m=r.length;r=[...r,l];const y=T=>{var R;const{scope:P,children:A,...O}=T,I=((R=P==null?void 0:P[t])==null?void 0:R[m])||a,L=X.useMemo(()=>O,Object.values(O));return B.jsx(I.Provider,{value:L,children:A})};y.displayName=c+"Provider";function v(T,P){var I;const A=((I=P==null?void 0:P[t])==null?void 0:I[m])||a,O=X.useContext(A);if(O)return O;if(l!==void 0)return l;throw new Error(`\`${T}\` must be used within \`${c}\``)}return[y,v]}const s=()=>{const c=r.map(l=>X.createContext(l));return function(a){const m=(a==null?void 0:a[t])||c;return X.useMemo(()=>({[`__scope${t}`]:{...a,[t]:m}}),[a,m])}};return s.scopeName=t,[n,nQ(s,...e)]}function nQ(...t){const e=t[0];if(t.length===1)return e;const r=()=>{const n=t.map(s=>({useScope:s(),scopeName:s.scopeName}));return function(c){const l=n.reduce((a,{useScope:m,scopeName:y})=>{const T=m(c)[`__scope${y}`];return{...a,...T}},{});return X.useMemo(()=>({[`__scope${e.scopeName}`]:l}),[l])}};return r.scopeName=e.scopeName,r}var ic=globalThis!=null&&globalThis.document?X.useLayoutEffect:()=>{},iQ=iC[" useId ".trim().toString()]||(()=>{}),sQ=0;function Iy(t){const[e,r]=X.useState(iQ());return ic(()=>{r(n=>n??String(sQ++))},[t]),e?`radix-${e}`:""}var oQ=iC[" useInsertionEffect ".trim().toString()]||ic;function u1({prop:t,defaultProp:e,onChange:r=()=>{},caller:n}){const[s,c,l]=aQ({defaultProp:e,onChange:r}),a=t!==void 0,m=a?t:s;{const v=X.useRef(t!==void 0);X.useEffect(()=>{const T=v.current;T!==a&&console.warn(`${n} is changing from ${T?"controlled":"uncontrolled"} to ${a?"controlled":"uncontrolled"}. Components should not switch from controlled to uncontrolled (or vice versa). Decide between using a controlled or uncontrolled value for the lifetime of the component.`),v.current=a},[a,n])}const y=X.useCallback(v=>{var T;if(a){const P=lQ(v)?v(t):v;P!==t&&((T=l.current)==null||T.call(l,P))}else c(v)},[a,t,c,l]);return[m,y]}function aQ({defaultProp:t,onChange:e}){const[r,n]=X.useState(t),s=X.useRef(r),c=X.useRef(e);return oQ(()=>{c.current=e},[e]),X.useEffect(()=>{var l;s.current!==r&&((l=c.current)==null||l.call(c,r),s.current=r)},[r,s]),[r,n,c]}function lQ(t){return typeof t=="function"}function f0(t){const e=uQ(t),r=X.forwardRef((n,s)=>{const{children:c,...l}=n,a=X.Children.toArray(c),m=a.find(dQ);if(m){const y=m.props.children,v=a.map(T=>T===m?X.Children.count(y)>1?X.Children.only(null):X.isValidElement(y)?y.props.children:null:T);return B.jsx(e,{...l,ref:s,children:X.isValidElement(y)?X.cloneElement(y,void 0,v):null})}return B.jsx(e,{...l,ref:s,children:c})});return r.displayName=`${t}.Slot`,r}var cQ=f0("Slot");function uQ(t){const e=X.forwardRef((r,n)=>{const{children:s,...c}=r;if(X.isValidElement(s)){const l=pQ(s),a=fQ(c,s.props);return s.type!==X.Fragment&&(a.ref=n?CN(n,l):l),X.cloneElement(s,a)}return X.Children.count(s)>1?X.Children.only(null):null});return e.displayName=`${t}.SlotClone`,e}var PN=Symbol("radix.slottable");function hQ(t){const e=({children:r})=>B.jsx(B.Fragment,{children:r});return e.displayName=`${t}.Slottable`,e.__radixId=PN,e}function dQ(t){return X.isValidElement(t)&&typeof t.type=="function"&&"__radixId"in t.type&&t.type.__radixId===PN}function fQ(t,e){const r={...e};for(const n in e){const s=t[n],c=e[n];/^on[A-Z]/.test(n)?s&&c?r[n]=(...a)=>{const m=c(...a);return s(...a),m}:s&&(r[n]=s):n==="style"?r[n]={...s,...c}:n==="className"&&(r[n]=[s,c].filter(Boolean).join(" "))}return{...t,...r}}function pQ(t){var n,s;let e=(n=Object.getOwnPropertyDescriptor(t.props,"ref"))==null?void 0:n.get,r=e&&"isReactWarning"in e&&e.isReactWarning;return r?t.ref:(e=(s=Object.getOwnPropertyDescriptor(t,"ref"))==null?void 0:s.get,r=e&&"isReactWarning"in e&&e.isReactWarning,r?t.props.ref:t.props.ref||t.ref)}var mQ=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"],tn=mQ.reduce((t,e)=>{const r=f0(`Primitive.${e}`),n=X.forwardRef((s,c)=>{const{asChild:l,...a}=s,m=l?r:e;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),B.jsx(m,{...a,ref:c})});return n.displayName=`Primitive.${e}`,{...t,[e]:n}},{});function AN(t,e){t&&B0.flushSync(()=>t.dispatchEvent(e))}function ka(t){const e=X.useRef(t);return X.useEffect(()=>{e.current=t}),X.useMemo(()=>(...r)=>{var n;return(n=e.current)==null?void 0:n.call(e,...r)},[])}function gQ(t,e=globalThis==null?void 0:globalThis.document){const r=ka(t);X.useEffect(()=>{const n=s=>{s.key==="Escape"&&r(s)};return e.addEventListener("keydown",n,{capture:!0}),()=>e.removeEventListener("keydown",n,{capture:!0})},[r,e])}var yQ="DismissableLayer",nE="dismissableLayer.update",_Q="dismissableLayer.pointerDownOutside",vQ="dismissableLayer.focusOutside",dD,kN=X.createContext({layers:new Set,layersWithOutsidePointerEventsDisabled:new Set,branches:new Set}),h1=X.forwardRef((t,e)=>{const{disableOutsidePointerEvents:r=!1,onEscapeKeyDown:n,onPointerDownOutside:s,onFocusOutside:c,onInteractOutside:l,onDismiss:a,...m}=t,y=X.useContext(kN),[v,T]=X.useState(null),P=(v==null?void 0:v.ownerDocument)??(globalThis==null?void 0:globalThis.document),[,A]=X.useState({}),O=ms(e,ie=>T(ie)),I=Array.from(y.layers),[L]=[...y.layersWithOutsidePointerEventsDisabled].slice(-1),R=I.indexOf(L),z=v?I.indexOf(v):-1,j=y.layersWithOutsidePointerEventsDisabled.size>0,W=z>=R,Z=bQ(ie=>{const V=ie.target,q=[...y.branches].some(Q=>Q.contains(V));!W||q||(s==null||s(ie),l==null||l(ie),ie.defaultPrevented||a==null||a())},P),te=wQ(ie=>{const V=ie.target;[...y.branches].some(Q=>Q.contains(V))||(c==null||c(ie),l==null||l(ie),ie.defaultPrevented||a==null||a())},P);return gQ(ie=>{z===y.layers.size-1&&(n==null||n(ie),!ie.defaultPrevented&&a&&(ie.preventDefault(),a()))},P),X.useEffect(()=>{if(v)return r&&(y.layersWithOutsidePointerEventsDisabled.size===0&&(dD=P.body.style.pointerEvents,P.body.style.pointerEvents="none"),y.layersWithOutsidePointerEventsDisabled.add(v)),y.layers.add(v),fD(),()=>{r&&y.layersWithOutsidePointerEventsDisabled.size===1&&(P.body.style.pointerEvents=dD)}},[v,P,r,y]),X.useEffect(()=>()=>{v&&(y.layers.delete(v),y.layersWithOutsidePointerEventsDisabled.delete(v),fD())},[v,y]),X.useEffect(()=>{const ie=()=>A({});return document.addEventListener(nE,ie),()=>document.removeEventListener(nE,ie)},[]),B.jsx(tn.div,{...m,ref:O,style:{pointerEvents:j?W?"auto":"none":void 0,...t.style},onFocusCapture:Rr(t.onFocusCapture,te.onFocusCapture),onBlurCapture:Rr(t.onBlurCapture,te.onBlurCapture),onPointerDownCapture:Rr(t.onPointerDownCapture,Z.onPointerDownCapture)})});h1.displayName=yQ;var xQ="DismissableLayerBranch",MN=X.forwardRef((t,e)=>{const r=X.useContext(kN),n=X.useRef(null),s=ms(e,n);return X.useEffect(()=>{const c=n.current;if(c)return r.branches.add(c),()=>{r.branches.delete(c)}},[r.branches]),B.jsx(tn.div,{...t,ref:s})});MN.displayName=xQ;function bQ(t,e=globalThis==null?void 0:globalThis.document){const r=ka(t),n=X.useRef(!1),s=X.useRef(()=>{});return X.useEffect(()=>{const c=a=>{if(a.target&&!n.current){let m=function(){IN(_Q,r,y,{discrete:!0})};const y={originalEvent:a};a.pointerType==="touch"?(e.removeEventListener("click",s.current),s.current=m,e.addEventListener("click",s.current,{once:!0})):m()}else e.removeEventListener("click",s.current);n.current=!1},l=window.setTimeout(()=>{e.addEventListener("pointerdown",c)},0);return()=>{window.clearTimeout(l),e.removeEventListener("pointerdown",c),e.removeEventListener("click",s.current)}},[e,r]),{onPointerDownCapture:()=>n.current=!0}}function wQ(t,e=globalThis==null?void 0:globalThis.document){const r=ka(t),n=X.useRef(!1);return X.useEffect(()=>{const s=c=>{c.target&&!n.current&&IN(vQ,r,{originalEvent:c},{discrete:!1})};return e.addEventListener("focusin",s),()=>e.removeEventListener("focusin",s)},[e,r]),{onFocusCapture:()=>n.current=!0,onBlurCapture:()=>n.current=!1}}function fD(){const t=new CustomEvent(nE);document.dispatchEvent(t)}function IN(t,e,r,{discrete:n}){const s=r.originalEvent.target,c=new CustomEvent(t,{bubbles:!1,cancelable:!0,detail:r});e&&s.addEventListener(t,e,{once:!0}),n?AN(s,c):s.dispatchEvent(c)}var SQ=h1,TQ=MN,G2="focusScope.autoFocusOnMount",W2="focusScope.autoFocusOnUnmount",pD={bubbles:!1,cancelable:!0},EQ="FocusScope",RN=X.forwardRef((t,e)=>{const{loop:r=!1,trapped:n=!1,onMountAutoFocus:s,onUnmountAutoFocus:c,...l}=t,[a,m]=X.useState(null),y=ka(s),v=ka(c),T=X.useRef(null),P=ms(e,I=>m(I)),A=X.useRef({paused:!1,pause(){this.paused=!0},resume(){this.paused=!1}}).current;X.useEffect(()=>{if(n){let I=function(j){if(A.paused||!a)return;const W=j.target;a.contains(W)?T.current=W:Xc(T.current,{select:!0})},L=function(j){if(A.paused||!a)return;const W=j.relatedTarget;W!==null&&(a.contains(W)||Xc(T.current,{select:!0}))},R=function(j){if(document.activeElement===document.body)for(const Z of j)Z.removedNodes.length>0&&Xc(a)};document.addEventListener("focusin",I),document.addEventListener("focusout",L);const z=new MutationObserver(R);return a&&z.observe(a,{childList:!0,subtree:!0}),()=>{document.removeEventListener("focusin",I),document.removeEventListener("focusout",L),z.disconnect()}}},[n,a,A.paused]),X.useEffect(()=>{if(a){gD.add(A);const I=document.activeElement;if(!a.contains(I)){const R=new CustomEvent(G2,pD);a.addEventListener(G2,y),a.dispatchEvent(R),R.defaultPrevented||(CQ(IQ(DN(a)),{select:!0}),document.activeElement===I&&Xc(a))}return()=>{a.removeEventListener(G2,y),setTimeout(()=>{const R=new CustomEvent(W2,pD);a.addEventListener(W2,v),a.dispatchEvent(R),R.defaultPrevented||Xc(I??document.body,{select:!0}),a.removeEventListener(W2,v),gD.remove(A)},0)}}},[a,y,v,A]);const O=X.useCallback(I=>{if(!r&&!n||A.paused)return;const L=I.key==="Tab"&&!I.altKey&&!I.ctrlKey&&!I.metaKey,R=document.activeElement;if(L&&R){const z=I.currentTarget,[j,W]=PQ(z);j&&W?!I.shiftKey&&R===W?(I.preventDefault(),r&&Xc(j,{select:!0})):I.shiftKey&&R===j&&(I.preventDefault(),r&&Xc(W,{select:!0})):R===z&&I.preventDefault()}},[r,n,A.paused]);return B.jsx(tn.div,{tabIndex:-1,...l,ref:P,onKeyDown:O})});RN.displayName=EQ;function CQ(t,{select:e=!1}={}){const r=document.activeElement;for(const n of t)if(Xc(n,{select:e}),document.activeElement!==r)return}function PQ(t){const e=DN(t),r=mD(e,t),n=mD(e.reverse(),t);return[r,n]}function DN(t){const e=[],r=document.createTreeWalker(t,NodeFilter.SHOW_ELEMENT,{acceptNode:n=>{const s=n.tagName==="INPUT"&&n.type==="hidden";return n.disabled||n.hidden||s?NodeFilter.FILTER_SKIP:n.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;r.nextNode();)e.push(r.currentNode);return e}function mD(t,e){for(const r of t)if(!AQ(r,{upTo:e}))return r}function AQ(t,{upTo:e}){if(getComputedStyle(t).visibility==="hidden")return!0;for(;t;){if(e!==void 0&&t===e)return!1;if(getComputedStyle(t).display==="none")return!0;t=t.parentElement}return!1}function kQ(t){return t instanceof HTMLInputElement&&"select"in t}function Xc(t,{select:e=!1}={}){if(t&&t.focus){const r=document.activeElement;t.focus({preventScroll:!0}),t!==r&&kQ(t)&&e&&t.select()}}var gD=MQ();function MQ(){let t=[];return{add(e){const r=t[0];e!==r&&(r==null||r.pause()),t=yD(t,e),t.unshift(e)},remove(e){var r;t=yD(t,e),(r=t[0])==null||r.resume()}}}function yD(t,e){const r=[...t],n=r.indexOf(e);return n!==-1&&r.splice(n,1),r}function IQ(t){return t.filter(e=>e.tagName!=="A")}var RQ="Portal",LP=X.forwardRef((t,e)=>{var a;const{container:r,...n}=t,[s,c]=X.useState(!1);ic(()=>c(!0),[]);const l=r||s&&((a=globalThis==null?void 0:globalThis.document)==null?void 0:a.body);return l?Xz.createPortal(B.jsx(tn.div,{...n,ref:e}),l):null});LP.displayName=RQ;function DQ(t,e){return X.useReducer((r,n)=>e[r][n]??r,t)}var Ld=t=>{const{present:e,children:r}=t,n=LQ(e),s=typeof r=="function"?r({present:n.isPresent}):X.Children.only(r),c=ms(n.ref,OQ(s));return typeof r=="function"||n.isPresent?X.cloneElement(s,{ref:c}):null};Ld.displayName="Presence";function LQ(t){const[e,r]=X.useState(),n=X.useRef(null),s=X.useRef(t),c=X.useRef("none"),l=t?"mounted":"unmounted",[a,m]=DQ(l,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}});return X.useEffect(()=>{const y=Vv(n.current);c.current=a==="mounted"?y:"none"},[a]),ic(()=>{const y=n.current,v=s.current;if(v!==t){const P=c.current,A=Vv(y);t?m("MOUNT"):A==="none"||(y==null?void 0:y.display)==="none"?m("UNMOUNT"):m(v&&P!==A?"ANIMATION_OUT":"UNMOUNT"),s.current=t}},[t,m]),ic(()=>{if(e){let y;const v=e.ownerDocument.defaultView??window,T=A=>{const I=Vv(n.current).includes(CSS.escape(A.animationName));if(A.target===e&&I&&(m("ANIMATION_END"),!s.current)){const L=e.style.animationFillMode;e.style.animationFillMode="forwards",y=v.setTimeout(()=>{e.style.animationFillMode==="forwards"&&(e.style.animationFillMode=L)})}},P=A=>{A.target===e&&(c.current=Vv(n.current))};return e.addEventListener("animationstart",P),e.addEventListener("animationcancel",T),e.addEventListener("animationend",T),()=>{v.clearTimeout(y),e.removeEventListener("animationstart",P),e.removeEventListener("animationcancel",T),e.removeEventListener("animationend",T)}}else m("ANIMATION_END")},[e,m]),{isPresent:["mounted","unmountSuspended"].includes(a),ref:X.useCallback(y=>{n.current=y?getComputedStyle(y):null,r(y)},[])}}function Vv(t){return(t==null?void 0:t.animationName)||"none"}function OQ(t){var n,s;let e=(n=Object.getOwnPropertyDescriptor(t.props,"ref"))==null?void 0:n.get,r=e&&"isReactWarning"in e&&e.isReactWarning;return r?t.ref:(e=(s=Object.getOwnPropertyDescriptor(t,"ref"))==null?void 0:s.get,r=e&&"isReactWarning"in e&&e.isReactWarning,r?t.props.ref:t.props.ref||t.ref)}var q2=0;function zQ(){X.useEffect(()=>{const t=document.querySelectorAll("[data-radix-focus-guard]");return document.body.insertAdjacentElement("afterbegin",t[0]??_D()),document.body.insertAdjacentElement("beforeend",t[1]??_D()),q2++,()=>{q2===1&&document.querySelectorAll("[data-radix-focus-guard]").forEach(e=>e.remove()),q2--}},[])}function _D(){const t=document.createElement("span");return t.setAttribute("data-radix-focus-guard",""),t.tabIndex=0,t.style.outline="none",t.style.opacity="0",t.style.position="fixed",t.style.pointerEvents="none",t}var il=function(){return il=Object.assign||function(e){for(var r,n=1,s=arguments.length;n<s;n++){r=arguments[n];for(var c in r)Object.prototype.hasOwnProperty.call(r,c)&&(e[c]=r[c])}return e},il.apply(this,arguments)};function LN(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,n=Object.getOwnPropertySymbols(t);s<n.length;s++)e.indexOf(n[s])<0&&Object.prototype.propertyIsEnumerable.call(t,n[s])&&(r[n[s]]=t[n[s]]);return r}function NQ(t,e,r){if(r||arguments.length===2)for(var n=0,s=e.length,c;n<s;n++)(c||!(n in e))&&(c||(c=Array.prototype.slice.call(e,0,n)),c[n]=e[n]);return t.concat(c||Array.prototype.slice.call(e))}var bx="right-scroll-bar-position",wx="width-before-scroll-bar",jQ="with-scroll-bars-hidden",FQ="--removed-body-scroll-bar-size";function H2(t,e){return typeof t=="function"?t(e):t&&(t.current=e),t}function BQ(t,e){var r=X.useState(function(){return{value:t,callback:e,facade:{get current(){return r.value},set current(n){var s=r.value;s!==n&&(r.value=n,r.callback(n,s))}}}})[0];return r.callback=e,r.facade}var $Q=typeof window<"u"?X.useLayoutEffect:X.useEffect,vD=new WeakMap;function VQ(t,e){var r=BQ(null,function(n){return t.forEach(function(s){return H2(s,n)})});return $Q(function(){var n=vD.get(r);if(n){var s=new Set(n),c=new Set(t),l=r.current;s.forEach(function(a){c.has(a)||H2(a,null)}),c.forEach(function(a){s.has(a)||H2(a,l)})}vD.set(r,t)},[t]),r}function UQ(t){return t}function GQ(t,e){e===void 0&&(e=UQ);var r=[],n=!1,s={read:function(){if(n)throw new Error("Sidecar: could not `read` from an `assigned` medium. `read` could be used only with `useMedium`.");return r.length?r[r.length-1]:t},useMedium:function(c){var l=e(c,n);return r.push(l),function(){r=r.filter(function(a){return a!==l})}},assignSyncMedium:function(c){for(n=!0;r.length;){var l=r;r=[],l.forEach(c)}r={push:function(a){return c(a)},filter:function(){return r}}},assignMedium:function(c){n=!0;var l=[];if(r.length){var a=r;r=[],a.forEach(c),l=r}var m=function(){var v=l;l=[],v.forEach(c)},y=function(){return Promise.resolve().then(m)};y(),r={push:function(v){l.push(v),y()},filter:function(v){return l=l.filter(v),r}}}};return s}function WQ(t){t===void 0&&(t={});var e=GQ(null);return e.options=il({async:!0,ssr:!1},t),e}var ON=function(t){var e=t.sideCar,r=LN(t,["sideCar"]);if(!e)throw new Error("Sidecar: please provide `sideCar` property to import the right car");var n=e.read();if(!n)throw new Error("Sidecar medium not found");return X.createElement(n,il({},r))};ON.isSideCarExport=!0;function qQ(t,e){return t.useMedium(e),ON}var zN=WQ(),Z2=function(){},d1=X.forwardRef(function(t,e){var r=X.useRef(null),n=X.useState({onScrollCapture:Z2,onWheelCapture:Z2,onTouchMoveCapture:Z2}),s=n[0],c=n[1],l=t.forwardProps,a=t.children,m=t.className,y=t.removeScrollBar,v=t.enabled,T=t.shards,P=t.sideCar,A=t.noRelative,O=t.noIsolation,I=t.inert,L=t.allowPinchZoom,R=t.as,z=R===void 0?"div":R,j=t.gapMode,W=LN(t,["forwardProps","children","className","removeScrollBar","enabled","shards","sideCar","noRelative","noIsolation","inert","allowPinchZoom","as","gapMode"]),Z=P,te=VQ([r,e]),ie=il(il({},W),s);return X.createElement(X.Fragment,null,v&&X.createElement(Z,{sideCar:zN,removeScrollBar:y,shards:T,noRelative:A,noIsolation:O,inert:I,setCallbacks:c,allowPinchZoom:!!L,lockRef:r,gapMode:j}),l?X.cloneElement(X.Children.only(a),il(il({},ie),{ref:te})):X.createElement(z,il({},ie,{className:m,ref:te}),a))});d1.defaultProps={enabled:!0,removeScrollBar:!0,inert:!1};d1.classNames={fullWidth:wx,zeroRight:bx};var HQ=function(){if(typeof __webpack_nonce__<"u")return __webpack_nonce__};function ZQ(){if(!document)return null;var t=document.createElement("style");t.type="text/css";var e=HQ();return e&&t.setAttribute("nonce",e),t}function KQ(t,e){t.styleSheet?t.styleSheet.cssText=e:t.appendChild(document.createTextNode(e))}function XQ(t){var e=document.head||document.getElementsByTagName("head")[0];e.appendChild(t)}var YQ=function(){var t=0,e=null;return{add:function(r){t==0&&(e=ZQ())&&(KQ(e,r),XQ(e)),t++},remove:function(){t--,!t&&e&&(e.parentNode&&e.parentNode.removeChild(e),e=null)}}},QQ=function(){var t=YQ();return function(e,r){X.useEffect(function(){return t.add(e),function(){t.remove()}},[e&&r])}},NN=function(){var t=QQ(),e=function(r){var n=r.styles,s=r.dynamic;return t(n,s),null};return e},JQ={left:0,top:0,right:0,gap:0},K2=function(t){return parseInt(t||"",10)||0},eJ=function(t){var e=window.getComputedStyle(document.body),r=e[t==="padding"?"paddingLeft":"marginLeft"],n=e[t==="padding"?"paddingTop":"marginTop"],s=e[t==="padding"?"paddingRight":"marginRight"];return[K2(r),K2(n),K2(s)]},tJ=function(t){if(t===void 0&&(t="margin"),typeof window>"u")return JQ;var e=eJ(t),r=document.documentElement.clientWidth,n=window.innerWidth;return{left:e[0],top:e[1],right:e[2],gap:Math.max(0,n-r+e[2]-e[0])}},rJ=NN(),Ip="data-scroll-locked",nJ=function(t,e,r,n){var s=t.left,c=t.top,l=t.right,a=t.gap;return r===void 0&&(r="margin"),`
  .`.concat(jQ,` {
   overflow: hidden `).concat(n,`;
   padding-right: `).concat(a,"px ").concat(n,`;
  }
  body[`).concat(Ip,`] {
    overflow: hidden `).concat(n,`;
    overscroll-behavior: contain;
    `).concat([e&&"position: relative ".concat(n,";"),r==="margin"&&`
    padding-left: `.concat(s,`px;
    padding-top: `).concat(c,`px;
    padding-right: `).concat(l,`px;
    margin-left:0;
    margin-top:0;
    margin-right: `).concat(a,"px ").concat(n,`;
    `),r==="padding"&&"padding-right: ".concat(a,"px ").concat(n,";")].filter(Boolean).join(""),`
  }
  
  .`).concat(bx,` {
    right: `).concat(a,"px ").concat(n,`;
  }
  
  .`).concat(wx,` {
    margin-right: `).concat(a,"px ").concat(n,`;
  }
  
  .`).concat(bx," .").concat(bx,` {
    right: 0 `).concat(n,`;
  }
  
  .`).concat(wx," .").concat(wx,` {
    margin-right: 0 `).concat(n,`;
  }
  
  body[`).concat(Ip,`] {
    `).concat(FQ,": ").concat(a,`px;
  }
`)},xD=function(){var t=parseInt(document.body.getAttribute(Ip)||"0",10);return isFinite(t)?t:0},iJ=function(){X.useEffect(function(){return document.body.setAttribute(Ip,(xD()+1).toString()),function(){var t=xD()-1;t<=0?document.body.removeAttribute(Ip):document.body.setAttribute(Ip,t.toString())}},[])},sJ=function(t){var e=t.noRelative,r=t.noImportant,n=t.gapMode,s=n===void 0?"margin":n;iJ();var c=X.useMemo(function(){return tJ(s)},[s]);return X.createElement(rJ,{styles:nJ(c,!e,s,r?"":"!important")})},iE=!1;if(typeof window<"u")try{var Uv=Object.defineProperty({},"passive",{get:function(){return iE=!0,!0}});window.addEventListener("test",Uv,Uv),window.removeEventListener("test",Uv,Uv)}catch{iE=!1}var Kf=iE?{passive:!1}:!1,oJ=function(t){return t.tagName==="TEXTAREA"},jN=function(t,e){if(!(t instanceof Element))return!1;var r=window.getComputedStyle(t);return r[e]!=="hidden"&&!(r.overflowY===r.overflowX&&!oJ(t)&&r[e]==="visible")},aJ=function(t){return jN(t,"overflowY")},lJ=function(t){return jN(t,"overflowX")},bD=function(t,e){var r=e.ownerDocument,n=e;do{typeof ShadowRoot<"u"&&n instanceof ShadowRoot&&(n=n.host);var s=FN(t,n);if(s){var c=BN(t,n),l=c[1],a=c[2];if(l>a)return!0}n=n.parentNode}while(n&&n!==r.body);return!1},cJ=function(t){var e=t.scrollTop,r=t.scrollHeight,n=t.clientHeight;return[e,r,n]},uJ=function(t){var e=t.scrollLeft,r=t.scrollWidth,n=t.clientWidth;return[e,r,n]},FN=function(t,e){return t==="v"?aJ(e):lJ(e)},BN=function(t,e){return t==="v"?cJ(e):uJ(e)},hJ=function(t,e){return t==="h"&&e==="rtl"?-1:1},dJ=function(t,e,r,n,s){var c=hJ(t,window.getComputedStyle(e).direction),l=c*n,a=r.target,m=e.contains(a),y=!1,v=l>0,T=0,P=0;do{if(!a)break;var A=BN(t,a),O=A[0],I=A[1],L=A[2],R=I-L-c*O;(O||R)&&FN(t,a)&&(T+=R,P+=O);var z=a.parentNode;a=z&&z.nodeType===Node.DOCUMENT_FRAGMENT_NODE?z.host:z}while(!m&&a!==document.body||m&&(e.contains(a)||e===a));return(v&&Math.abs(T)<1||!v&&Math.abs(P)<1)&&(y=!0),y},Gv=function(t){return"changedTouches"in t?[t.changedTouches[0].clientX,t.changedTouches[0].clientY]:[0,0]},wD=function(t){return[t.deltaX,t.deltaY]},SD=function(t){return t&&"current"in t?t.current:t},fJ=function(t,e){return t[0]===e[0]&&t[1]===e[1]},pJ=function(t){return`
  .block-interactivity-`.concat(t,` {pointer-events: none;}
  .allow-interactivity-`).concat(t,` {pointer-events: all;}
`)},mJ=0,Xf=[];function gJ(t){var e=X.useRef([]),r=X.useRef([0,0]),n=X.useRef(),s=X.useState(mJ++)[0],c=X.useState(NN)[0],l=X.useRef(t);X.useEffect(function(){l.current=t},[t]),X.useEffect(function(){if(t.inert){document.body.classList.add("block-interactivity-".concat(s));var I=NQ([t.lockRef.current],(t.shards||[]).map(SD),!0).filter(Boolean);return I.forEach(function(L){return L.classList.add("allow-interactivity-".concat(s))}),function(){document.body.classList.remove("block-interactivity-".concat(s)),I.forEach(function(L){return L.classList.remove("allow-interactivity-".concat(s))})}}},[t.inert,t.lockRef.current,t.shards]);var a=X.useCallback(function(I,L){if("touches"in I&&I.touches.length===2||I.type==="wheel"&&I.ctrlKey)return!l.current.allowPinchZoom;var R=Gv(I),z=r.current,j="deltaX"in I?I.deltaX:z[0]-R[0],W="deltaY"in I?I.deltaY:z[1]-R[1],Z,te=I.target,ie=Math.abs(j)>Math.abs(W)?"h":"v";if("touches"in I&&ie==="h"&&te.type==="range")return!1;var V=bD(ie,te);if(!V)return!0;if(V?Z=ie:(Z=ie==="v"?"h":"v",V=bD(ie,te)),!V)return!1;if(!n.current&&"changedTouches"in I&&(j||W)&&(n.current=Z),!Z)return!0;var q=n.current||Z;return dJ(q,L,I,q==="h"?j:W)},[]),m=X.useCallback(function(I){var L=I;if(!(!Xf.length||Xf[Xf.length-1]!==c)){var R="deltaY"in L?wD(L):Gv(L),z=e.current.filter(function(Z){return Z.name===L.type&&(Z.target===L.target||L.target===Z.shadowParent)&&fJ(Z.delta,R)})[0];if(z&&z.should){L.cancelable&&L.preventDefault();return}if(!z){var j=(l.current.shards||[]).map(SD).filter(Boolean).filter(function(Z){return Z.contains(L.target)}),W=j.length>0?a(L,j[0]):!l.current.noIsolation;W&&L.cancelable&&L.preventDefault()}}},[]),y=X.useCallback(function(I,L,R,z){var j={name:I,delta:L,target:R,should:z,shadowParent:yJ(R)};e.current.push(j),setTimeout(function(){e.current=e.current.filter(function(W){return W!==j})},1)},[]),v=X.useCallback(function(I){r.current=Gv(I),n.current=void 0},[]),T=X.useCallback(function(I){y(I.type,wD(I),I.target,a(I,t.lockRef.current))},[]),P=X.useCallback(function(I){y(I.type,Gv(I),I.target,a(I,t.lockRef.current))},[]);X.useEffect(function(){return Xf.push(c),t.setCallbacks({onScrollCapture:T,onWheelCapture:T,onTouchMoveCapture:P}),document.addEventListener("wheel",m,Kf),document.addEventListener("touchmove",m,Kf),document.addEventListener("touchstart",v,Kf),function(){Xf=Xf.filter(function(I){return I!==c}),document.removeEventListener("wheel",m,Kf),document.removeEventListener("touchmove",m,Kf),document.removeEventListener("touchstart",v,Kf)}},[]);var A=t.removeScrollBar,O=t.inert;return X.createElement(X.Fragment,null,O?X.createElement(c,{styles:pJ(s)}):null,A?X.createElement(sJ,{noRelative:t.noRelative,gapMode:t.gapMode}):null)}function yJ(t){for(var e=null;t!==null;)t instanceof ShadowRoot&&(e=t.host,t=t.host),t=t.parentNode;return e}const _J=qQ(zN,gJ);var $N=X.forwardRef(function(t,e){return X.createElement(d1,il({},t,{ref:e,sideCar:_J}))});$N.classNames=d1.classNames;var vJ=function(t){if(typeof document>"u")return null;var e=Array.isArray(t)?t[0]:t;return e.ownerDocument.body},Yf=new WeakMap,Wv=new WeakMap,qv={},X2=0,VN=function(t){return t&&(t.host||VN(t.parentNode))},xJ=function(t,e){return e.map(function(r){if(t.contains(r))return r;var n=VN(r);return n&&t.contains(n)?n:(console.error("aria-hidden",r,"in not contained inside",t,". Doing nothing"),null)}).filter(function(r){return!!r})},bJ=function(t,e,r,n){var s=xJ(e,Array.isArray(t)?t:[t]);qv[r]||(qv[r]=new WeakMap);var c=qv[r],l=[],a=new Set,m=new Set(s),y=function(T){!T||a.has(T)||(a.add(T),y(T.parentNode))};s.forEach(y);var v=function(T){!T||m.has(T)||Array.prototype.forEach.call(T.children,function(P){if(a.has(P))v(P);else try{var A=P.getAttribute(n),O=A!==null&&A!=="false",I=(Yf.get(P)||0)+1,L=(c.get(P)||0)+1;Yf.set(P,I),c.set(P,L),l.push(P),I===1&&O&&Wv.set(P,!0),L===1&&P.setAttribute(r,"true"),O||P.setAttribute(n,"true")}catch(R){console.error("aria-hidden: cannot operate on ",P,R)}})};return v(e),a.clear(),X2++,function(){l.forEach(function(T){var P=Yf.get(T)-1,A=c.get(T)-1;Yf.set(T,P),c.set(T,A),P||(Wv.has(T)||T.removeAttribute(n),Wv.delete(T)),A||T.removeAttribute(r)}),X2--,X2||(Yf=new WeakMap,Yf=new WeakMap,Wv=new WeakMap,qv={})}},wJ=function(t,e,r){r===void 0&&(r="data-aria-hidden");var n=Array.from(Array.isArray(t)?t:[t]),s=vJ(t);return s?(n.push.apply(n,Array.from(s.querySelectorAll("[aria-live], script"))),bJ(n,s,r,"aria-hidden")):function(){return null}},f1="Dialog",[UN]=Dd(f1),[SJ,Ra]=UN(f1),GN=t=>{const{__scopeDialog:e,children:r,open:n,defaultOpen:s,onOpenChange:c,modal:l=!0}=t,a=X.useRef(null),m=X.useRef(null),[y,v]=u1({prop:n,defaultProp:s??!1,onChange:c,caller:f1});return B.jsx(SJ,{scope:e,triggerRef:a,contentRef:m,contentId:Iy(),titleId:Iy(),descriptionId:Iy(),open:y,onOpenChange:v,onOpenToggle:X.useCallback(()=>v(T=>!T),[v]),modal:l,children:r})};GN.displayName=f1;var WN="DialogTrigger",TJ=X.forwardRef((t,e)=>{const{__scopeDialog:r,...n}=t,s=Ra(WN,r),c=ms(e,s.triggerRef);return B.jsx(tn.button,{type:"button","aria-haspopup":"dialog","aria-expanded":s.open,"aria-controls":s.contentId,"data-state":NP(s.open),...n,ref:c,onClick:Rr(t.onClick,s.onOpenToggle)})});TJ.displayName=WN;var OP="DialogPortal",[EJ,qN]=UN(OP,{forceMount:void 0}),HN=t=>{const{__scopeDialog:e,forceMount:r,children:n,container:s}=t,c=Ra(OP,e);return B.jsx(EJ,{scope:e,forceMount:r,children:X.Children.map(n,l=>B.jsx(Ld,{present:r||c.open,children:B.jsx(LP,{asChild:!0,container:s,children:l})}))})};HN.displayName=OP;var mb="DialogOverlay",ZN=X.forwardRef((t,e)=>{const r=qN(mb,t.__scopeDialog),{forceMount:n=r.forceMount,...s}=t,c=Ra(mb,t.__scopeDialog);return c.modal?B.jsx(Ld,{present:n||c.open,children:B.jsx(PJ,{...s,ref:e})}):null});ZN.displayName=mb;var CJ=f0("DialogOverlay.RemoveScroll"),PJ=X.forwardRef((t,e)=>{const{__scopeDialog:r,...n}=t,s=Ra(mb,r);return B.jsx($N,{as:CJ,allowPinchZoom:!0,shards:[s.contentRef],children:B.jsx(tn.div,{"data-state":NP(s.open),...n,ref:e,style:{pointerEvents:"auto",...n.style}})})}),Sd="DialogContent",KN=X.forwardRef((t,e)=>{const r=qN(Sd,t.__scopeDialog),{forceMount:n=r.forceMount,...s}=t,c=Ra(Sd,t.__scopeDialog);return B.jsx(Ld,{present:n||c.open,children:c.modal?B.jsx(AJ,{...s,ref:e}):B.jsx(kJ,{...s,ref:e})})});KN.displayName=Sd;var AJ=X.forwardRef((t,e)=>{const r=Ra(Sd,t.__scopeDialog),n=X.useRef(null),s=ms(e,r.contentRef,n);return X.useEffect(()=>{const c=n.current;if(c)return wJ(c)},[]),B.jsx(XN,{...t,ref:s,trapFocus:r.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:Rr(t.onCloseAutoFocus,c=>{var l;c.preventDefault(),(l=r.triggerRef.current)==null||l.focus()}),onPointerDownOutside:Rr(t.onPointerDownOutside,c=>{const l=c.detail.originalEvent,a=l.button===0&&l.ctrlKey===!0;(l.button===2||a)&&c.preventDefault()}),onFocusOutside:Rr(t.onFocusOutside,c=>c.preventDefault())})}),kJ=X.forwardRef((t,e)=>{const r=Ra(Sd,t.__scopeDialog),n=X.useRef(!1),s=X.useRef(!1);return B.jsx(XN,{...t,ref:e,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:c=>{var l,a;(l=t.onCloseAutoFocus)==null||l.call(t,c),c.defaultPrevented||(n.current||(a=r.triggerRef.current)==null||a.focus(),c.preventDefault()),n.current=!1,s.current=!1},onInteractOutside:c=>{var m,y;(m=t.onInteractOutside)==null||m.call(t,c),c.defaultPrevented||(n.current=!0,c.detail.originalEvent.type==="pointerdown"&&(s.current=!0));const l=c.target;((y=r.triggerRef.current)==null?void 0:y.contains(l))&&c.preventDefault(),c.detail.originalEvent.type==="focusin"&&s.current&&c.preventDefault()}})}),XN=X.forwardRef((t,e)=>{const{__scopeDialog:r,trapFocus:n,onOpenAutoFocus:s,onCloseAutoFocus:c,...l}=t,a=Ra(Sd,r),m=X.useRef(null),y=ms(e,m);return zQ(),B.jsxs(B.Fragment,{children:[B.jsx(RN,{asChild:!0,loop:!0,trapped:n,onMountAutoFocus:s,onUnmountAutoFocus:c,children:B.jsx(h1,{role:"dialog",id:a.contentId,"aria-describedby":a.descriptionId,"aria-labelledby":a.titleId,"data-state":NP(a.open),...l,ref:y,onDismiss:()=>a.onOpenChange(!1)})}),B.jsxs(B.Fragment,{children:[B.jsx(MJ,{titleId:a.titleId}),B.jsx(RJ,{contentRef:m,descriptionId:a.descriptionId})]})]})}),zP="DialogTitle",YN=X.forwardRef((t,e)=>{const{__scopeDialog:r,...n}=t,s=Ra(zP,r);return B.jsx(tn.h2,{id:s.titleId,...n,ref:e})});YN.displayName=zP;var QN="DialogDescription",JN=X.forwardRef((t,e)=>{const{__scopeDialog:r,...n}=t,s=Ra(QN,r);return B.jsx(tn.p,{id:s.descriptionId,...n,ref:e})});JN.displayName=QN;var ej="DialogClose",tj=X.forwardRef((t,e)=>{const{__scopeDialog:r,...n}=t,s=Ra(ej,r);return B.jsx(tn.button,{type:"button",...n,ref:e,onClick:Rr(t.onClick,()=>s.onOpenChange(!1))})});tj.displayName=ej;function NP(t){return t?"open":"closed"}var rj="DialogTitleWarning",[Rue,nj]=rQ(rj,{contentName:Sd,titleName:zP,docsSlug:"dialog"}),MJ=({titleId:t})=>{const e=nj(rj),r=`\`${e.contentName}\` requires a \`${e.titleName}\` for the component to be accessible for screen reader users.

If you want to hide the \`${e.titleName}\`, you can wrap it with our VisuallyHidden component.

For more information, see https://radix-ui.com/primitives/docs/components/${e.docsSlug}`;return X.useEffect(()=>{t&&(document.getElementById(t)||console.error(r))},[r,t]),null},IJ="DialogDescriptionWarning",RJ=({contentRef:t,descriptionId:e})=>{const n=`Warning: Missing \`Description\` or \`aria-describedby={undefined}\` for {${nj(IJ).contentName}}.`;return X.useEffect(()=>{var c;const s=(c=t.current)==null?void 0:c.getAttribute("aria-describedby");e&&s&&(document.getElementById(e)||console.warn(n))},[n,t,e]),null},DJ=GN,LJ=HN,ij=ZN,sj=KN,oj=YN,aj=JN,OJ=tj;const zJ=DJ,NJ=LJ,lj=X.forwardRef(({className:t,...e},r)=>B.jsx(ij,{ref:r,className:Lr("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",t),...e}));lj.displayName=ij.displayName;const cj=X.forwardRef(({className:t,children:e,...r},n)=>B.jsxs(NJ,{children:[B.jsx(lj,{}),B.jsxs(sj,{ref:n,className:Lr("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",t),...r,children:[e,B.jsxs(OJ,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[B.jsx(Gh,{className:"h-4 w-4"}),B.jsx("span",{className:"sr-only",children:"Close"})]})]})]}));cj.displayName=sj.displayName;const jJ=X.forwardRef(({className:t,...e},r)=>B.jsx(oj,{ref:r,className:Lr("text-lg font-semibold leading-none tracking-tight",t),...e}));jJ.displayName=oj.displayName;const FJ=X.forwardRef(({className:t,...e},r)=>B.jsx(aj,{ref:r,className:Lr("text-sm text-muted-foreground",t),...e}));FJ.displayName=aj.displayName;const TD=t=>typeof t=="boolean"?`${t}`:t===0?"0":t,ED=H4,jP=(t,e)=>r=>{var n;if((e==null?void 0:e.variants)==null)return ED(t,r==null?void 0:r.class,r==null?void 0:r.className);const{variants:s,defaultVariants:c}=e,l=Object.keys(s).map(y=>{const v=r==null?void 0:r[y],T=c==null?void 0:c[y];if(v===null)return null;const P=TD(v)||TD(T);return s[y][P]}),a=r&&Object.entries(r).reduce((y,v)=>{let[T,P]=v;return P===void 0||(y[T]=P),y},{}),m=e==null||(n=e.compoundVariants)===null||n===void 0?void 0:n.reduce((y,v)=>{let{class:T,className:P,...A}=v;return Object.entries(A).every(O=>{let[I,L]=O;return Array.isArray(L)?L.includes({...c,...a}[I]):{...c,...a}[I]===L})?[...y,T,P]:y},[]);return ED(t,l,m,r==null?void 0:r.class,r==null?void 0:r.className)},BJ=jP("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),Qi=X.forwardRef(({className:t,variant:e,size:r,asChild:n=!1,...s},c)=>{const l=n?cQ:"button";return B.jsx(l,{className:Lr(BJ({variant:e,size:r,className:t})),ref:c,...s})});Qi.displayName="Button";const Rp=X.forwardRef(({className:t,type:e,...r},n)=>B.jsx("input",{type:e,className:Lr("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",t),ref:n,...r}));Rp.displayName="Input";var $J="Label",uj=X.forwardRef((t,e)=>B.jsx(tn.label,{...t,ref:e,onMouseDown:r=>{var s;r.target.closest("button, input, select, textarea")||((s=t.onMouseDown)==null||s.call(t,r),!r.defaultPrevented&&r.detail>1&&r.preventDefault())}}));uj.displayName=$J;var hj=uj;const VJ=jP("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),Dp=X.forwardRef(({className:t,...e},r)=>B.jsx(hj,{ref:r,className:Lr(VJ(),t),...e}));Dp.displayName=hj.displayName;function UJ({onToggleForm:t,onSuccess:e}){const[r,n]=X.useState(""),[s,c]=X.useState(""),[l,a]=X.useState(!1),{signIn:m}=c1(),y=async v=>{if(v.preventDefault(),!r||!s){Ya.error("Please fill in all fields");return}try{a(!0),await m(r,s),e&&e()}catch{}finally{a(!1)}};return B.jsxs("div",{className:"space-y-6 animate-scale-in",children:[B.jsxs("div",{className:"space-y-2 text-center",children:[B.jsx("h1",{className:"text-3xl font-bold tracking-tighter",children:"Welcome back"}),B.jsx("p",{className:"text-muted-foreground",children:"Sign in to your NeuroCrop account"})]}),B.jsxs("form",{onSubmit:y,className:"space-y-4",children:[B.jsxs("div",{className:"space-y-2",children:[B.jsx(Dp,{htmlFor:"email",children:"Email"}),B.jsx(Rp,{id:"email",type:"email",placeholder:"m@example.com",value:r,onChange:v=>n(v.target.value),className:"transition-all duration-200"})]}),B.jsxs("div",{className:"space-y-2",children:[B.jsxs("div",{className:"flex items-center justify-between",children:[B.jsx(Dp,{htmlFor:"password",children:"Password"}),B.jsx(Qi,{variant:"link",className:"px-0 font-normal h-auto",type:"button",children:"Forgot password?"})]}),B.jsx(Rp,{id:"password",type:"password",value:s,onChange:v=>c(v.target.value),className:"transition-all duration-200"})]}),B.jsx(Qi,{type:"submit",className:"w-full button-animated",disabled:l,children:l?"Signing in...":"Sign In"})]}),B.jsx("div",{className:"text-center",children:B.jsxs("p",{className:"text-sm text-muted-foreground",children:["Don't have an account?"," ",B.jsx(Qi,{variant:"link",onClick:t,className:"p-0 h-auto font-normal animated-link",children:"Sign up"})]})})]})}function GJ({onToggleForm:t,onSuccess:e}){const[r,n]=X.useState(""),[s,c]=X.useState(""),[l,a]=X.useState(""),[m,y]=X.useState(!1),{signUp:v}=c1(),T=async P=>{if(P.preventDefault(),!r||!s||!l){Ya.error("Please fill in all fields");return}if(s!==l){Ya.error("Passwords do not match");return}try{y(!0),await v(r,s),e&&e()}catch{}finally{y(!1)}};return B.jsxs("div",{className:"space-y-6 animate-scale-in",children:[B.jsxs("div",{className:"space-y-2 text-center",children:[B.jsx("h1",{className:"text-3xl font-bold tracking-tighter",children:"Create your account"}),B.jsx("p",{className:"text-muted-foreground",children:"Sign up to start using NeuroCrop"})]}),B.jsxs("form",{onSubmit:T,className:"space-y-4",children:[B.jsxs("div",{className:"space-y-2",children:[B.jsx(Dp,{htmlFor:"signup-email",children:"Email"}),B.jsx(Rp,{id:"signup-email",type:"email",placeholder:"m@example.com",value:r,onChange:P=>n(P.target.value),className:"transition-all duration-200"})]}),B.jsxs("div",{className:"space-y-2",children:[B.jsx(Dp,{htmlFor:"signup-password",children:"Password"}),B.jsx(Rp,{id:"signup-password",type:"password",value:s,onChange:P=>c(P.target.value),className:"transition-all duration-200"})]}),B.jsxs("div",{className:"space-y-2",children:[B.jsx(Dp,{htmlFor:"confirm-password",children:"Confirm Password"}),B.jsx(Rp,{id:"confirm-password",type:"password",value:l,onChange:P=>a(P.target.value),className:"transition-all duration-200"})]}),B.jsx(Qi,{type:"submit",className:"w-full button-animated",disabled:m,children:m?"Creating account...":"Sign Up"})]}),B.jsx("div",{className:"text-center",children:B.jsxs("p",{className:"text-sm text-muted-foreground",children:["Already have an account?"," ",B.jsx(Qi,{variant:"link",onClick:t,className:"p-0 h-auto font-normal animated-link",children:"Sign in"})]})})]})}function WJ({open:t,onOpenChange:e,defaultView:r="login"}){const[n,s]=X.useState(r),c=()=>{s(n==="login"?"signup":"login")},l=()=>{e(!1)};return B.jsx(zJ,{open:t,onOpenChange:e,children:B.jsx(cj,{className:"sm:max-w-[425px] bg-background/95 backdrop-blur-sm border border-border/50",children:n==="login"?B.jsx(UJ,{onToggleForm:c,onSuccess:l}):B.jsx(GJ,{onToggleForm:c,onSuccess:l})})})}const qJ="radial-gradient(2px 2px at 20px 30px, #ffffff, transparent), radial-gradient(2px 2px at 90px 40px, #ffffff, transparent), radial-gradient(2px 2px at 40px 70px, #ffffff, transparent), radial-gradient(1px 1px at 150px 10px, #ffffff, transparent), radial-gradient(1px 1px at 200px 80px, #ffffff, transparent), radial-gradient(1px 1px at 250px 50px, #ffffff, transparent), radial-gradient(2px 2px at 300px 30px, #ffffff, transparent), radial-gradient(1px 1px at 350px 70px, #ffffff, transparent), radial-gradient(2px 2px at 400px 10px, #ffffff, transparent), radial-gradient(1px 1px at 450px 90px, #ffffff, transparent), radial-gradient(2px 2px at 500px 50px, #ffffff, transparent), radial-gradient(1px 1px at 550px 20px, #ffffff, transparent), radial-gradient(2px 2px at 600px 60px, #ffffff, transparent), radial-gradient(1px 1px at 650px 40px, #ffffff, transparent), radial-gradient(2px 2px at 700px 80px, #ffffff, transparent), radial-gradient(1px 1px at 750px 10px, #ffffff, transparent), radial-gradient(2px 2px at 800px 50px, #ffffff, transparent), radial-gradient(1px 1px at 850px 30px, #ffffff, transparent), radial-gradient(2px 2px at 900px 70px, #ffffff, transparent), radial-gradient(1px 1px at 950px 90px, #ffffff, transparent), linear-gradient(to bottom, rgba(5, 5, 20, 0.15), rgba(15, 10, 40, 0.15))";function HJ(){const[t,e]=X.useState(!1),[r,n]=X.useState("login"),[s,c]=X.useState(!0),[l,a]=X.useState(0),m=gm(),{user:y}=c1(),v=[{name:"Home",href:"/",icon:sZ},{name:"About",href:"/about",icon:oZ},{name:y?"Dashboard":"Account",href:"/account",icon:y?aZ:hZ,authRequired:!0}];X.useEffect(()=>{const P=()=>{const A=window.scrollY;A>l&&A>100?c(!1):c(!0),a(A)};return window.addEventListener("scroll",P),()=>window.removeEventListener("scroll",P)},[l]);const T=(P,A)=>{A&&!y&&(P.preventDefault(),n("login"),e(!0))};return B.jsxs(B.Fragment,{children:[B.jsx(nr.div,{className:"fixed top-6 transform -translate-x-1/2 z-50 w-full flex justify-center",initial:{y:-100,opacity:0},animate:{y:s?0:-100,opacity:s?1:0},transition:{duration:.3},children:B.jsx("nav",{className:"flex items-center gap-1 bg-background/20 backdrop-blur-md border border-border/30 rounded-full p-1.5 shadow-lg w-auto min-w-[900px]",style:{backgroundImage:qJ,backgroundSize:"1000px 100px",backgroundRepeat:"repeat-x"},children:v.map(P=>{const A=m.pathname===P.href;return B.jsxs(_T,{to:P.href,onClick:O=>T(O,P.authRequired),className:Lr("flex flex-col items-center justify-center px-3 py-2 rounded-full transition-colors relative flex-1",A?"text-white":"text-muted-foreground text-foreground text-white"),children:[B.jsx(P.icon,{className:"w-5 h-5"}),B.jsx("span",{className:"text-xs font-medium mt-1",children:P.name}),A&&B.jsx(nr.div,{className:"absolute inset-0 bg-blue-500/10 rounded-full -z-10",layoutId:"activeNavBackground",transition:{type:"spring",duration:.6}})]},P.name)})})}),B.jsx(WJ,{open:t,onOpenChange:e,defaultView:r})]})}var CD=["light","dark"],ZJ="(prefers-color-scheme: dark)",KJ=X.createContext(void 0),XJ={setTheme:t=>{},themes:[]},YJ=()=>{var t;return(t=X.useContext(KJ))!=null?t:XJ};X.memo(({forcedTheme:t,storageKey:e,attribute:r,enableSystem:n,enableColorScheme:s,defaultTheme:c,value:l,attrs:a,nonce:m})=>{let y=c==="system",v=r==="class"?`var d=document.documentElement,c=d.classList;${`c.remove(${a.map(O=>`'${O}'`).join(",")})`};`:`var d=document.documentElement,n='${r}',s='setAttribute';`,T=s?CD.includes(c)&&c?`if(e==='light'||e==='dark'||!e)d.style.colorScheme=e||'${c}'`:"if(e==='light'||e==='dark')d.style.colorScheme=e":"",P=(O,I=!1,L=!0)=>{let R=l?l[O]:O,z=I?O+"|| ''":`'${R}'`,j="";return s&&L&&!I&&CD.includes(O)&&(j+=`d.style.colorScheme = '${O}';`),r==="class"?I||R?j+=`c.add(${z})`:j+="null":R&&(j+=`d[s](n,${z})`),j},A=t?`!function(){${v}${P(t)}}()`:n?`!function(){try{${v}var e=localStorage.getItem('${e}');if('system'===e||(!e&&${y})){var t='${ZJ}',m=window.matchMedia(t);if(m.media!==t||m.matches){${P("dark")}}else{${P("light")}}}else if(e){${l?`var x=${JSON.stringify(l)};`:""}${P(l?"x[e]":"e",!0)}}${y?"":"else{"+P(c,!1,!1)+"}"}${T}}catch(e){}}()`:`!function(){try{${v}var e=localStorage.getItem('${e}');if(e){${l?`var x=${JSON.stringify(l)};`:""}${P(l?"x[e]":"e",!0)}}else{${P(c,!1,!1)};}${T}}catch(t){}}();`;return X.createElement("script",{nonce:m,dangerouslySetInnerHTML:{__html:A}})});const QJ=({...t})=>{const{theme:e="system"}=YJ();return B.jsx(JY,{theme:e,className:"toaster group",toastOptions:{classNames:{toast:"group toast group-[.toaster]:bg-background group-[.toaster]:text-foreground group-[.toaster]:border-border group-[.toaster]:shadow-lg",description:"group-[.toast]:text-muted-foreground",actionButton:"group-[.toast]:bg-primary group-[.toast]:text-primary-foreground",cancelButton:"group-[.toast]:bg-muted group-[.toast]:text-muted-foreground"}},...t})},JJ=1,eee=1e6;let Y2=0;function tee(){return Y2=(Y2+1)%Number.MAX_SAFE_INTEGER,Y2.toString()}const Q2=new Map,PD=t=>{if(Q2.has(t))return;const e=setTimeout(()=>{Q2.delete(t),Ry({type:"REMOVE_TOAST",toastId:t})},eee);Q2.set(t,e)},ree=(t,e)=>{switch(e.type){case"ADD_TOAST":return{...t,toasts:[e.toast,...t.toasts].slice(0,JJ)};case"UPDATE_TOAST":return{...t,toasts:t.toasts.map(r=>r.id===e.toast.id?{...r,...e.toast}:r)};case"DISMISS_TOAST":{const{toastId:r}=e;return r?PD(r):t.toasts.forEach(n=>{PD(n.id)}),{...t,toasts:t.toasts.map(n=>n.id===r||r===void 0?{...n,open:!1}:n)}}case"REMOVE_TOAST":return e.toastId===void 0?{...t,toasts:[]}:{...t,toasts:t.toasts.filter(r=>r.id!==e.toastId)}}},Sx=[];let Tx={toasts:[]};function Ry(t){Tx=ree(Tx,t),Sx.forEach(e=>{e(Tx)})}function nee({...t}){const e=tee(),r=s=>Ry({type:"UPDATE_TOAST",toast:{...s,id:e}}),n=()=>Ry({type:"DISMISS_TOAST",toastId:e});return Ry({type:"ADD_TOAST",toast:{...t,id:e,open:!0,onOpenChange:s=>{s||n()}}}),{id:e,dismiss:n,update:r}}function dj(){const[t,e]=X.useState(Tx);return X.useEffect(()=>(Sx.push(e),()=>{const r=Sx.indexOf(e);r>-1&&Sx.splice(r,1)}),[t]),{...t,toast:nee,dismiss:r=>Ry({type:"DISMISS_TOAST",toastId:r})}}function fj(t){const e=t+"CollectionProvider",[r,n]=Dd(e),[s,c]=r(e,{collectionRef:{current:null},itemMap:new Map}),l=I=>{const{scope:L,children:R}=I,z=bt.useRef(null),j=bt.useRef(new Map).current;return B.jsx(s,{scope:L,itemMap:j,collectionRef:z,children:R})};l.displayName=e;const a=t+"CollectionSlot",m=f0(a),y=bt.forwardRef((I,L)=>{const{scope:R,children:z}=I,j=c(a,R),W=ms(L,j.collectionRef);return B.jsx(m,{ref:W,children:z})});y.displayName=a;const v=t+"CollectionItemSlot",T="data-radix-collection-item",P=f0(v),A=bt.forwardRef((I,L)=>{const{scope:R,children:z,...j}=I,W=bt.useRef(null),Z=ms(L,W),te=c(v,R);return bt.useEffect(()=>(te.itemMap.set(W,{ref:W,...j}),()=>void te.itemMap.delete(W))),B.jsx(P,{[T]:"",ref:Z,children:z})});A.displayName=v;function O(I){const L=c(t+"CollectionConsumer",I);return bt.useCallback(()=>{const z=L.collectionRef.current;if(!z)return[];const j=Array.from(z.querySelectorAll(`[${T}]`));return Array.from(L.itemMap.values()).sort((te,ie)=>j.indexOf(te.ref.current)-j.indexOf(ie.ref.current))},[L.collectionRef,L.itemMap])}return[{Provider:l,Slot:y,ItemSlot:A},O,n]}var iee=Object.freeze({position:"absolute",border:0,width:1,height:1,padding:0,margin:-1,overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",wordWrap:"normal"}),see="VisuallyHidden",p1=X.forwardRef((t,e)=>B.jsx(tn.span,{...t,ref:e,style:{...iee,...t.style}}));p1.displayName=see;var oee=p1,FP="ToastProvider",[BP,aee,lee]=fj("Toast"),[pj]=Dd("Toast",[lee]),[cee,m1]=pj(FP),mj=t=>{const{__scopeToast:e,label:r="Notification",duration:n=5e3,swipeDirection:s="right",swipeThreshold:c=50,children:l}=t,[a,m]=X.useState(null),[y,v]=X.useState(0),T=X.useRef(!1),P=X.useRef(!1);return r.trim()||console.error(`Invalid prop \`label\` supplied to \`${FP}\`. Expected non-empty \`string\`.`),B.jsx(BP.Provider,{scope:e,children:B.jsx(cee,{scope:e,label:r,duration:n,swipeDirection:s,swipeThreshold:c,toastCount:y,viewport:a,onViewportChange:m,onToastAdd:X.useCallback(()=>v(A=>A+1),[]),onToastRemove:X.useCallback(()=>v(A=>A-1),[]),isFocusedToastEscapeKeyDownRef:T,isClosePausedRef:P,children:l})})};mj.displayName=FP;var gj="ToastViewport",uee=["F8"],sE="toast.viewportPause",oE="toast.viewportResume",yj=X.forwardRef((t,e)=>{const{__scopeToast:r,hotkey:n=uee,label:s="Notifications ({hotkey})",...c}=t,l=m1(gj,r),a=aee(r),m=X.useRef(null),y=X.useRef(null),v=X.useRef(null),T=X.useRef(null),P=ms(e,T,l.onViewportChange),A=n.join("+").replace(/Key/g,"").replace(/Digit/g,""),O=l.toastCount>0;X.useEffect(()=>{const L=R=>{var j;n.length!==0&&n.every(W=>R[W]||R.code===W)&&((j=T.current)==null||j.focus())};return document.addEventListener("keydown",L),()=>document.removeEventListener("keydown",L)},[n]),X.useEffect(()=>{const L=m.current,R=T.current;if(O&&L&&R){const z=()=>{if(!l.isClosePausedRef.current){const te=new CustomEvent(sE);R.dispatchEvent(te),l.isClosePausedRef.current=!0}},j=()=>{if(l.isClosePausedRef.current){const te=new CustomEvent(oE);R.dispatchEvent(te),l.isClosePausedRef.current=!1}},W=te=>{!L.contains(te.relatedTarget)&&j()},Z=()=>{L.contains(document.activeElement)||j()};return L.addEventListener("focusin",z),L.addEventListener("focusout",W),L.addEventListener("pointermove",z),L.addEventListener("pointerleave",Z),window.addEventListener("blur",z),window.addEventListener("focus",j),()=>{L.removeEventListener("focusin",z),L.removeEventListener("focusout",W),L.removeEventListener("pointermove",z),L.removeEventListener("pointerleave",Z),window.removeEventListener("blur",z),window.removeEventListener("focus",j)}}},[O,l.isClosePausedRef]);const I=X.useCallback(({tabbingDirection:L})=>{const z=a().map(j=>{const W=j.ref.current,Z=[W,...See(W)];return L==="forwards"?Z:Z.reverse()});return(L==="forwards"?z.reverse():z).flat()},[a]);return X.useEffect(()=>{const L=T.current;if(L){const R=z=>{var Z,te,ie;const j=z.altKey||z.ctrlKey||z.metaKey;if(z.key==="Tab"&&!j){const V=document.activeElement,q=z.shiftKey;if(z.target===L&&q){(Z=y.current)==null||Z.focus();return}const se=I({tabbingDirection:q?"backwards":"forwards"}),ue=se.findIndex(he=>he===V);J2(se.slice(ue+1))?z.preventDefault():q?(te=y.current)==null||te.focus():(ie=v.current)==null||ie.focus()}};return L.addEventListener("keydown",R),()=>L.removeEventListener("keydown",R)}},[a,I]),B.jsxs(TQ,{ref:m,role:"region","aria-label":s.replace("{hotkey}",A),tabIndex:-1,style:{pointerEvents:O?void 0:"none"},children:[O&&B.jsx(aE,{ref:y,onFocusFromOutsideViewport:()=>{const L=I({tabbingDirection:"forwards"});J2(L)}}),B.jsx(BP.Slot,{scope:r,children:B.jsx(tn.ol,{tabIndex:-1,...c,ref:P})}),O&&B.jsx(aE,{ref:v,onFocusFromOutsideViewport:()=>{const L=I({tabbingDirection:"backwards"});J2(L)}})]})});yj.displayName=gj;var _j="ToastFocusProxy",aE=X.forwardRef((t,e)=>{const{__scopeToast:r,onFocusFromOutsideViewport:n,...s}=t,c=m1(_j,r);return B.jsx(p1,{tabIndex:0,...s,ref:e,style:{position:"fixed"},onFocus:l=>{var y;const a=l.relatedTarget;!((y=c.viewport)!=null&&y.contains(a))&&n()}})});aE.displayName=_j;var K0="Toast",hee="toast.swipeStart",dee="toast.swipeMove",fee="toast.swipeCancel",pee="toast.swipeEnd",vj=X.forwardRef((t,e)=>{const{forceMount:r,open:n,defaultOpen:s,onOpenChange:c,...l}=t,[a,m]=u1({prop:n,defaultProp:s??!0,onChange:c,caller:K0});return B.jsx(Ld,{present:r||a,children:B.jsx(yee,{open:a,...l,ref:e,onClose:()=>m(!1),onPause:ka(t.onPause),onResume:ka(t.onResume),onSwipeStart:Rr(t.onSwipeStart,y=>{y.currentTarget.setAttribute("data-swipe","start")}),onSwipeMove:Rr(t.onSwipeMove,y=>{const{x:v,y:T}=y.detail.delta;y.currentTarget.setAttribute("data-swipe","move"),y.currentTarget.style.setProperty("--radix-toast-swipe-move-x",`${v}px`),y.currentTarget.style.setProperty("--radix-toast-swipe-move-y",`${T}px`)}),onSwipeCancel:Rr(t.onSwipeCancel,y=>{y.currentTarget.setAttribute("data-swipe","cancel"),y.currentTarget.style.removeProperty("--radix-toast-swipe-move-x"),y.currentTarget.style.removeProperty("--radix-toast-swipe-move-y"),y.currentTarget.style.removeProperty("--radix-toast-swipe-end-x"),y.currentTarget.style.removeProperty("--radix-toast-swipe-end-y")}),onSwipeEnd:Rr(t.onSwipeEnd,y=>{const{x:v,y:T}=y.detail.delta;y.currentTarget.setAttribute("data-swipe","end"),y.currentTarget.style.removeProperty("--radix-toast-swipe-move-x"),y.currentTarget.style.removeProperty("--radix-toast-swipe-move-y"),y.currentTarget.style.setProperty("--radix-toast-swipe-end-x",`${v}px`),y.currentTarget.style.setProperty("--radix-toast-swipe-end-y",`${T}px`),m(!1)})})})});vj.displayName=K0;var[mee,gee]=pj(K0,{onClose(){}}),yee=X.forwardRef((t,e)=>{const{__scopeToast:r,type:n="foreground",duration:s,open:c,onClose:l,onEscapeKeyDown:a,onPause:m,onResume:y,onSwipeStart:v,onSwipeMove:T,onSwipeCancel:P,onSwipeEnd:A,...O}=t,I=m1(K0,r),[L,R]=X.useState(null),z=ms(e,he=>R(he)),j=X.useRef(null),W=X.useRef(null),Z=s||I.duration,te=X.useRef(0),ie=X.useRef(Z),V=X.useRef(0),{onToastAdd:q,onToastRemove:Q}=I,ce=ka(()=>{var ye;(L==null?void 0:L.contains(document.activeElement))&&((ye=I.viewport)==null||ye.focus()),l()}),se=X.useCallback(he=>{!he||he===1/0||(window.clearTimeout(V.current),te.current=new Date().getTime(),V.current=window.setTimeout(ce,he))},[ce]);X.useEffect(()=>{const he=I.viewport;if(he){const ye=()=>{se(ie.current),y==null||y()},xe=()=>{const Se=new Date().getTime()-te.current;ie.current=ie.current-Se,window.clearTimeout(V.current),m==null||m()};return he.addEventListener(sE,xe),he.addEventListener(oE,ye),()=>{he.removeEventListener(sE,xe),he.removeEventListener(oE,ye)}}},[I.viewport,Z,m,y,se]),X.useEffect(()=>{c&&!I.isClosePausedRef.current&&se(Z)},[c,Z,I.isClosePausedRef,se]),X.useEffect(()=>(q(),()=>Q()),[q,Q]);const ue=X.useMemo(()=>L?Cj(L):null,[L]);return I.viewport?B.jsxs(B.Fragment,{children:[ue&&B.jsx(_ee,{__scopeToast:r,role:"status","aria-live":n==="foreground"?"assertive":"polite",children:ue}),B.jsx(mee,{scope:r,onClose:ce,children:B0.createPortal(B.jsx(BP.ItemSlot,{scope:r,children:B.jsx(SQ,{asChild:!0,onEscapeKeyDown:Rr(a,()=>{I.isFocusedToastEscapeKeyDownRef.current||ce(),I.isFocusedToastEscapeKeyDownRef.current=!1}),children:B.jsx(tn.li,{tabIndex:0,"data-state":c?"open":"closed","data-swipe-direction":I.swipeDirection,...O,ref:z,style:{userSelect:"none",touchAction:"none",...t.style},onKeyDown:Rr(t.onKeyDown,he=>{he.key==="Escape"&&(a==null||a(he.nativeEvent),he.nativeEvent.defaultPrevented||(I.isFocusedToastEscapeKeyDownRef.current=!0,ce()))}),onPointerDown:Rr(t.onPointerDown,he=>{he.button===0&&(j.current={x:he.clientX,y:he.clientY})}),onPointerMove:Rr(t.onPointerMove,he=>{if(!j.current)return;const ye=he.clientX-j.current.x,xe=he.clientY-j.current.y,Se=!!W.current,fe=["left","right"].includes(I.swipeDirection),ve=["left","up"].includes(I.swipeDirection)?Math.min:Math.max,Re=fe?ve(0,ye):0,$e=fe?0:ve(0,xe),Xe=he.pointerType==="touch"?10:2,st={x:Re,y:$e},at={originalEvent:he,delta:st};Se?(W.current=st,Hv(dee,T,at,{discrete:!1})):AD(st,I.swipeDirection,Xe)?(W.current=st,Hv(hee,v,at,{discrete:!1}),he.target.setPointerCapture(he.pointerId)):(Math.abs(ye)>Xe||Math.abs(xe)>Xe)&&(j.current=null)}),onPointerUp:Rr(t.onPointerUp,he=>{const ye=W.current,xe=he.target;if(xe.hasPointerCapture(he.pointerId)&&xe.releasePointerCapture(he.pointerId),W.current=null,j.current=null,ye){const Se=he.currentTarget,fe={originalEvent:he,delta:ye};AD(ye,I.swipeDirection,I.swipeThreshold)?Hv(pee,A,fe,{discrete:!0}):Hv(fee,P,fe,{discrete:!0}),Se.addEventListener("click",ve=>ve.preventDefault(),{once:!0})}})})})}),I.viewport)})]}):null}),_ee=t=>{const{__scopeToast:e,children:r,...n}=t,s=m1(K0,e),[c,l]=X.useState(!1),[a,m]=X.useState(!1);return bee(()=>l(!0)),X.useEffect(()=>{const y=window.setTimeout(()=>m(!0),1e3);return()=>window.clearTimeout(y)},[]),a?null:B.jsx(LP,{asChild:!0,children:B.jsx(p1,{...n,children:c&&B.jsxs(B.Fragment,{children:[s.label," ",r]})})})},vee="ToastTitle",xj=X.forwardRef((t,e)=>{const{__scopeToast:r,...n}=t;return B.jsx(tn.div,{...n,ref:e})});xj.displayName=vee;var xee="ToastDescription",bj=X.forwardRef((t,e)=>{const{__scopeToast:r,...n}=t;return B.jsx(tn.div,{...n,ref:e})});bj.displayName=xee;var wj="ToastAction",Sj=X.forwardRef((t,e)=>{const{altText:r,...n}=t;return r.trim()?B.jsx(Ej,{altText:r,asChild:!0,children:B.jsx($P,{...n,ref:e})}):(console.error(`Invalid prop \`altText\` supplied to \`${wj}\`. Expected non-empty \`string\`.`),null)});Sj.displayName=wj;var Tj="ToastClose",$P=X.forwardRef((t,e)=>{const{__scopeToast:r,...n}=t,s=gee(Tj,r);return B.jsx(Ej,{asChild:!0,children:B.jsx(tn.button,{type:"button",...n,ref:e,onClick:Rr(t.onClick,s.onClose)})})});$P.displayName=Tj;var Ej=X.forwardRef((t,e)=>{const{__scopeToast:r,altText:n,...s}=t;return B.jsx(tn.div,{"data-radix-toast-announce-exclude":"","data-radix-toast-announce-alt":n||void 0,...s,ref:e})});function Cj(t){const e=[];return Array.from(t.childNodes).forEach(n=>{if(n.nodeType===n.TEXT_NODE&&n.textContent&&e.push(n.textContent),wee(n)){const s=n.ariaHidden||n.hidden||n.style.display==="none",c=n.dataset.radixToastAnnounceExclude==="";if(!s)if(c){const l=n.dataset.radixToastAnnounceAlt;l&&e.push(l)}else e.push(...Cj(n))}}),e}function Hv(t,e,r,{discrete:n}){const s=r.originalEvent.currentTarget,c=new CustomEvent(t,{bubbles:!0,cancelable:!0,detail:r});e&&s.addEventListener(t,e,{once:!0}),n?AN(s,c):s.dispatchEvent(c)}var AD=(t,e,r=0)=>{const n=Math.abs(t.x),s=Math.abs(t.y),c=n>s;return e==="left"||e==="right"?c&&n>r:!c&&s>r};function bee(t=()=>{}){const e=ka(t);ic(()=>{let r=0,n=0;return r=window.requestAnimationFrame(()=>n=window.requestAnimationFrame(e)),()=>{window.cancelAnimationFrame(r),window.cancelAnimationFrame(n)}},[e])}function wee(t){return t.nodeType===t.ELEMENT_NODE}function See(t){const e=[],r=document.createTreeWalker(t,NodeFilter.SHOW_ELEMENT,{acceptNode:n=>{const s=n.tagName==="INPUT"&&n.type==="hidden";return n.disabled||n.hidden||s?NodeFilter.FILTER_SKIP:n.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;r.nextNode();)e.push(r.currentNode);return e}function J2(t){const e=document.activeElement;return t.some(r=>r===e?!0:(r.focus(),document.activeElement!==e))}var Tee=mj,Pj=yj,Aj=vj,kj=xj,Mj=bj,Ij=Sj,Rj=$P;const Eee=Tee,Dj=X.forwardRef(({className:t,...e},r)=>B.jsx(Pj,{ref:r,className:Lr("fixed top-0 z-[100] flex max-h-screen w-full flex-col-reverse p-4 sm:bottom-0 sm:right-0 sm:top-auto sm:flex-col md:max-w-[420px]",t),...e}));Dj.displayName=Pj.displayName;const Cee=jP("group pointer-events-auto relative flex w-full items-center justify-between space-x-4 overflow-hidden rounded-md border p-6 pr-8 shadow-lg transition-all data-[swipe=cancel]:translate-x-0 data-[swipe=end]:translate-x-[var(--radix-toast-swipe-end-x)] data-[swipe=move]:translate-x-[var(--radix-toast-swipe-move-x)] data-[swipe=move]:transition-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[swipe=end]:animate-out data-[state=closed]:fade-out-80 data-[state=closed]:slide-out-to-right-full data-[state=open]:slide-in-from-top-full data-[state=open]:sm:slide-in-from-bottom-full",{variants:{variant:{default:"border bg-background text-foreground",destructive:"destructive group border-destructive bg-destructive text-destructive-foreground"}},defaultVariants:{variant:"default"}}),Lj=X.forwardRef(({className:t,variant:e,...r},n)=>B.jsx(Aj,{ref:n,className:Lr(Cee({variant:e}),t),...r}));Lj.displayName=Aj.displayName;const Pee=X.forwardRef(({className:t,...e},r)=>B.jsx(Ij,{ref:r,className:Lr("inline-flex h-8 shrink-0 items-center justify-center rounded-md border bg-transparent px-3 text-sm font-medium ring-offset-background transition-colors hover:bg-secondary focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 group-[.destructive]:border-muted/40 group-[.destructive]:hover:border-destructive/30 group-[.destructive]:hover:bg-destructive group-[.destructive]:hover:text-destructive-foreground group-[.destructive]:focus:ring-destructive",t),...e}));Pee.displayName=Ij.displayName;const Oj=X.forwardRef(({className:t,...e},r)=>B.jsx(Rj,{ref:r,className:Lr("absolute right-2 top-2 rounded-md p-1 text-foreground/50 opacity-0 transition-opacity hover:text-foreground focus:opacity-100 focus:outline-none focus:ring-2 group-hover:opacity-100 group-[.destructive]:text-red-300 group-[.destructive]:hover:text-red-50 group-[.destructive]:focus:ring-red-400 group-[.destructive]:focus:ring-offset-red-600",t),"toast-close":"",...e,children:B.jsx(Gh,{className:"h-4 w-4"})}));Oj.displayName=Rj.displayName;const zj=X.forwardRef(({className:t,...e},r)=>B.jsx(kj,{ref:r,className:Lr("text-sm font-semibold",t),...e}));zj.displayName=kj.displayName;const Nj=X.forwardRef(({className:t,...e},r)=>B.jsx(Mj,{ref:r,className:Lr("text-sm opacity-90",t),...e}));Nj.displayName=Mj.displayName;function Aee(){const{toasts:t}=dj();return B.jsxs(Eee,{children:[t.map(function({id:e,title:r,description:n,action:s,...c}){return B.jsxs(Lj,{...c,children:[B.jsxs("div",{className:"grid gap-1",children:[r&&B.jsx(zj,{children:r}),n&&B.jsx(Nj,{children:n})]}),s,B.jsx(Oj,{})]},e)}),B.jsx(Dj,{})]})}const kee=["top","right","bottom","left"],Mu=Math.min,xo=Math.max,gb=Math.round,Zv=Math.floor,ml=t=>({x:t,y:t}),Mee={left:"right",right:"left",bottom:"top",top:"bottom"},Iee={start:"end",end:"start"};function lE(t,e,r){return xo(t,Mu(e,r))}function sc(t,e){return typeof t=="function"?t(e):t}function oc(t){return t.split("-")[0]}function Sm(t){return t.split("-")[1]}function VP(t){return t==="x"?"y":"x"}function UP(t){return t==="y"?"height":"width"}const Ree=new Set(["top","bottom"]);function al(t){return Ree.has(oc(t))?"y":"x"}function GP(t){return VP(al(t))}function Dee(t,e,r){r===void 0&&(r=!1);const n=Sm(t),s=GP(t),c=UP(s);let l=s==="x"?n===(r?"end":"start")?"right":"left":n==="start"?"bottom":"top";return e.reference[c]>e.floating[c]&&(l=yb(l)),[l,yb(l)]}function Lee(t){const e=yb(t);return[cE(t),e,cE(e)]}function cE(t){return t.replace(/start|end/g,e=>Iee[e])}const kD=["left","right"],MD=["right","left"],Oee=["top","bottom"],zee=["bottom","top"];function Nee(t,e,r){switch(t){case"top":case"bottom":return r?e?MD:kD:e?kD:MD;case"left":case"right":return e?Oee:zee;default:return[]}}function jee(t,e,r,n){const s=Sm(t);let c=Nee(oc(t),r==="start",n);return s&&(c=c.map(l=>l+"-"+s),e&&(c=c.concat(c.map(cE)))),c}function yb(t){return t.replace(/left|right|bottom|top/g,e=>Mee[e])}function Fee(t){return{top:0,right:0,bottom:0,left:0,...t}}function jj(t){return typeof t!="number"?Fee(t):{top:t,right:t,bottom:t,left:t}}function _b(t){const{x:e,y:r,width:n,height:s}=t;return{width:n,height:s,top:r,left:e,right:e+n,bottom:r+s,x:e,y:r}}function ID(t,e,r){let{reference:n,floating:s}=t;const c=al(e),l=GP(e),a=UP(l),m=oc(e),y=c==="y",v=n.x+n.width/2-s.width/2,T=n.y+n.height/2-s.height/2,P=n[a]/2-s[a]/2;let A;switch(m){case"top":A={x:v,y:n.y-s.height};break;case"bottom":A={x:v,y:n.y+n.height};break;case"right":A={x:n.x+n.width,y:T};break;case"left":A={x:n.x-s.width,y:T};break;default:A={x:n.x,y:n.y}}switch(Sm(e)){case"start":A[l]-=P*(r&&y?-1:1);break;case"end":A[l]+=P*(r&&y?-1:1);break}return A}const Bee=async(t,e,r)=>{const{placement:n="bottom",strategy:s="absolute",middleware:c=[],platform:l}=r,a=c.filter(Boolean),m=await(l.isRTL==null?void 0:l.isRTL(e));let y=await l.getElementRects({reference:t,floating:e,strategy:s}),{x:v,y:T}=ID(y,n,m),P=n,A={},O=0;for(let I=0;I<a.length;I++){const{name:L,fn:R}=a[I],{x:z,y:j,data:W,reset:Z}=await R({x:v,y:T,initialPlacement:n,placement:P,strategy:s,middlewareData:A,rects:y,platform:l,elements:{reference:t,floating:e}});v=z??v,T=j??T,A={...A,[L]:{...A[L],...W}},Z&&O<=50&&(O++,typeof Z=="object"&&(Z.placement&&(P=Z.placement),Z.rects&&(y=Z.rects===!0?await l.getElementRects({reference:t,floating:e,strategy:s}):Z.rects),{x:v,y:T}=ID(y,P,m)),I=-1)}return{x:v,y:T,placement:P,strategy:s,middlewareData:A}};async function p0(t,e){var r;e===void 0&&(e={});const{x:n,y:s,platform:c,rects:l,elements:a,strategy:m}=t,{boundary:y="clippingAncestors",rootBoundary:v="viewport",elementContext:T="floating",altBoundary:P=!1,padding:A=0}=sc(e,t),O=jj(A),L=a[P?T==="floating"?"reference":"floating":T],R=_b(await c.getClippingRect({element:(r=await(c.isElement==null?void 0:c.isElement(L)))==null||r?L:L.contextElement||await(c.getDocumentElement==null?void 0:c.getDocumentElement(a.floating)),boundary:y,rootBoundary:v,strategy:m})),z=T==="floating"?{x:n,y:s,width:l.floating.width,height:l.floating.height}:l.reference,j=await(c.getOffsetParent==null?void 0:c.getOffsetParent(a.floating)),W=await(c.isElement==null?void 0:c.isElement(j))?await(c.getScale==null?void 0:c.getScale(j))||{x:1,y:1}:{x:1,y:1},Z=_b(c.convertOffsetParentRelativeRectToViewportRelativeRect?await c.convertOffsetParentRelativeRectToViewportRelativeRect({elements:a,rect:z,offsetParent:j,strategy:m}):z);return{top:(R.top-Z.top+O.top)/W.y,bottom:(Z.bottom-R.bottom+O.bottom)/W.y,left:(R.left-Z.left+O.left)/W.x,right:(Z.right-R.right+O.right)/W.x}}const $ee=t=>({name:"arrow",options:t,async fn(e){const{x:r,y:n,placement:s,rects:c,platform:l,elements:a,middlewareData:m}=e,{element:y,padding:v=0}=sc(t,e)||{};if(y==null)return{};const T=jj(v),P={x:r,y:n},A=GP(s),O=UP(A),I=await l.getDimensions(y),L=A==="y",R=L?"top":"left",z=L?"bottom":"right",j=L?"clientHeight":"clientWidth",W=c.reference[O]+c.reference[A]-P[A]-c.floating[O],Z=P[A]-c.reference[A],te=await(l.getOffsetParent==null?void 0:l.getOffsetParent(y));let ie=te?te[j]:0;(!ie||!await(l.isElement==null?void 0:l.isElement(te)))&&(ie=a.floating[j]||c.floating[O]);const V=W/2-Z/2,q=ie/2-I[O]/2-1,Q=Mu(T[R],q),ce=Mu(T[z],q),se=Q,ue=ie-I[O]-ce,he=ie/2-I[O]/2+V,ye=lE(se,he,ue),xe=!m.arrow&&Sm(s)!=null&&he!==ye&&c.reference[O]/2-(he<se?Q:ce)-I[O]/2<0,Se=xe?he<se?he-se:he-ue:0;return{[A]:P[A]+Se,data:{[A]:ye,centerOffset:he-ye-Se,...xe&&{alignmentOffset:Se}},reset:xe}}}),Vee=function(t){return t===void 0&&(t={}),{name:"flip",options:t,async fn(e){var r,n;const{placement:s,middlewareData:c,rects:l,initialPlacement:a,platform:m,elements:y}=e,{mainAxis:v=!0,crossAxis:T=!0,fallbackPlacements:P,fallbackStrategy:A="bestFit",fallbackAxisSideDirection:O="none",flipAlignment:I=!0,...L}=sc(t,e);if((r=c.arrow)!=null&&r.alignmentOffset)return{};const R=oc(s),z=al(a),j=oc(a)===a,W=await(m.isRTL==null?void 0:m.isRTL(y.floating)),Z=P||(j||!I?[yb(a)]:Lee(a)),te=O!=="none";!P&&te&&Z.push(...jee(a,I,O,W));const ie=[a,...Z],V=await p0(e,L),q=[];let Q=((n=c.flip)==null?void 0:n.overflows)||[];if(v&&q.push(V[R]),T){const he=Dee(s,l,W);q.push(V[he[0]],V[he[1]])}if(Q=[...Q,{placement:s,overflows:q}],!q.every(he=>he<=0)){var ce,se;const he=(((ce=c.flip)==null?void 0:ce.index)||0)+1,ye=ie[he];if(ye&&(!(T==="alignment"?z!==al(ye):!1)||Q.every(fe=>al(fe.placement)===z?fe.overflows[0]>0:!0)))return{data:{index:he,overflows:Q},reset:{placement:ye}};let xe=(se=Q.filter(Se=>Se.overflows[0]<=0).sort((Se,fe)=>Se.overflows[1]-fe.overflows[1])[0])==null?void 0:se.placement;if(!xe)switch(A){case"bestFit":{var ue;const Se=(ue=Q.filter(fe=>{if(te){const ve=al(fe.placement);return ve===z||ve==="y"}return!0}).map(fe=>[fe.placement,fe.overflows.filter(ve=>ve>0).reduce((ve,Re)=>ve+Re,0)]).sort((fe,ve)=>fe[1]-ve[1])[0])==null?void 0:ue[0];Se&&(xe=Se);break}case"initialPlacement":xe=a;break}if(s!==xe)return{reset:{placement:xe}}}return{}}}};function RD(t,e){return{top:t.top-e.height,right:t.right-e.width,bottom:t.bottom-e.height,left:t.left-e.width}}function DD(t){return kee.some(e=>t[e]>=0)}const Uee=function(t){return t===void 0&&(t={}),{name:"hide",options:t,async fn(e){const{rects:r}=e,{strategy:n="referenceHidden",...s}=sc(t,e);switch(n){case"referenceHidden":{const c=await p0(e,{...s,elementContext:"reference"}),l=RD(c,r.reference);return{data:{referenceHiddenOffsets:l,referenceHidden:DD(l)}}}case"escaped":{const c=await p0(e,{...s,altBoundary:!0}),l=RD(c,r.floating);return{data:{escapedOffsets:l,escaped:DD(l)}}}default:return{}}}}},Fj=new Set(["left","top"]);async function Gee(t,e){const{placement:r,platform:n,elements:s}=t,c=await(n.isRTL==null?void 0:n.isRTL(s.floating)),l=oc(r),a=Sm(r),m=al(r)==="y",y=Fj.has(l)?-1:1,v=c&&m?-1:1,T=sc(e,t);let{mainAxis:P,crossAxis:A,alignmentAxis:O}=typeof T=="number"?{mainAxis:T,crossAxis:0,alignmentAxis:null}:{mainAxis:T.mainAxis||0,crossAxis:T.crossAxis||0,alignmentAxis:T.alignmentAxis};return a&&typeof O=="number"&&(A=a==="end"?O*-1:O),m?{x:A*v,y:P*y}:{x:P*y,y:A*v}}const Wee=function(t){return t===void 0&&(t=0),{name:"offset",options:t,async fn(e){var r,n;const{x:s,y:c,placement:l,middlewareData:a}=e,m=await Gee(e,t);return l===((r=a.offset)==null?void 0:r.placement)&&(n=a.arrow)!=null&&n.alignmentOffset?{}:{x:s+m.x,y:c+m.y,data:{...m,placement:l}}}}},qee=function(t){return t===void 0&&(t={}),{name:"shift",options:t,async fn(e){const{x:r,y:n,placement:s}=e,{mainAxis:c=!0,crossAxis:l=!1,limiter:a={fn:L=>{let{x:R,y:z}=L;return{x:R,y:z}}},...m}=sc(t,e),y={x:r,y:n},v=await p0(e,m),T=al(oc(s)),P=VP(T);let A=y[P],O=y[T];if(c){const L=P==="y"?"top":"left",R=P==="y"?"bottom":"right",z=A+v[L],j=A-v[R];A=lE(z,A,j)}if(l){const L=T==="y"?"top":"left",R=T==="y"?"bottom":"right",z=O+v[L],j=O-v[R];O=lE(z,O,j)}const I=a.fn({...e,[P]:A,[T]:O});return{...I,data:{x:I.x-r,y:I.y-n,enabled:{[P]:c,[T]:l}}}}}},Hee=function(t){return t===void 0&&(t={}),{options:t,fn(e){const{x:r,y:n,placement:s,rects:c,middlewareData:l}=e,{offset:a=0,mainAxis:m=!0,crossAxis:y=!0}=sc(t,e),v={x:r,y:n},T=al(s),P=VP(T);let A=v[P],O=v[T];const I=sc(a,e),L=typeof I=="number"?{mainAxis:I,crossAxis:0}:{mainAxis:0,crossAxis:0,...I};if(m){const j=P==="y"?"height":"width",W=c.reference[P]-c.floating[j]+L.mainAxis,Z=c.reference[P]+c.reference[j]-L.mainAxis;A<W?A=W:A>Z&&(A=Z)}if(y){var R,z;const j=P==="y"?"width":"height",W=Fj.has(oc(s)),Z=c.reference[T]-c.floating[j]+(W&&((R=l.offset)==null?void 0:R[T])||0)+(W?0:L.crossAxis),te=c.reference[T]+c.reference[j]+(W?0:((z=l.offset)==null?void 0:z[T])||0)-(W?L.crossAxis:0);O<Z?O=Z:O>te&&(O=te)}return{[P]:A,[T]:O}}}},Zee=function(t){return t===void 0&&(t={}),{name:"size",options:t,async fn(e){var r,n;const{placement:s,rects:c,platform:l,elements:a}=e,{apply:m=()=>{},...y}=sc(t,e),v=await p0(e,y),T=oc(s),P=Sm(s),A=al(s)==="y",{width:O,height:I}=c.floating;let L,R;T==="top"||T==="bottom"?(L=T,R=P===(await(l.isRTL==null?void 0:l.isRTL(a.floating))?"start":"end")?"left":"right"):(R=T,L=P==="end"?"top":"bottom");const z=I-v.top-v.bottom,j=O-v.left-v.right,W=Mu(I-v[L],z),Z=Mu(O-v[R],j),te=!e.middlewareData.shift;let ie=W,V=Z;if((r=e.middlewareData.shift)!=null&&r.enabled.x&&(V=j),(n=e.middlewareData.shift)!=null&&n.enabled.y&&(ie=z),te&&!P){const Q=xo(v.left,0),ce=xo(v.right,0),se=xo(v.top,0),ue=xo(v.bottom,0);A?V=O-2*(Q!==0||ce!==0?Q+ce:xo(v.left,v.right)):ie=I-2*(se!==0||ue!==0?se+ue:xo(v.top,v.bottom))}await m({...e,availableWidth:V,availableHeight:ie});const q=await l.getDimensions(a.floating);return O!==q.width||I!==q.height?{reset:{rects:!0}}:{}}}};function g1(){return typeof window<"u"}function Tm(t){return Bj(t)?(t.nodeName||"").toLowerCase():"#document"}function Eo(t){var e;return(t==null||(e=t.ownerDocument)==null?void 0:e.defaultView)||window}function _l(t){var e;return(e=(Bj(t)?t.ownerDocument:t.document)||window.document)==null?void 0:e.documentElement}function Bj(t){return g1()?t instanceof Node||t instanceof Eo(t).Node:!1}function Ma(t){return g1()?t instanceof Element||t instanceof Eo(t).Element:!1}function gl(t){return g1()?t instanceof HTMLElement||t instanceof Eo(t).HTMLElement:!1}function LD(t){return!g1()||typeof ShadowRoot>"u"?!1:t instanceof ShadowRoot||t instanceof Eo(t).ShadowRoot}const Kee=new Set(["inline","contents"]);function X0(t){const{overflow:e,overflowX:r,overflowY:n,display:s}=Ia(t);return/auto|scroll|overlay|hidden|clip/.test(e+n+r)&&!Kee.has(s)}const Xee=new Set(["table","td","th"]);function Yee(t){return Xee.has(Tm(t))}const Qee=[":popover-open",":modal"];function y1(t){return Qee.some(e=>{try{return t.matches(e)}catch{return!1}})}const Jee=["transform","translate","scale","rotate","perspective"],ete=["transform","translate","scale","rotate","perspective","filter"],tte=["paint","layout","strict","content"];function WP(t){const e=qP(),r=Ma(t)?Ia(t):t;return Jee.some(n=>r[n]?r[n]!=="none":!1)||(r.containerType?r.containerType!=="normal":!1)||!e&&(r.backdropFilter?r.backdropFilter!=="none":!1)||!e&&(r.filter?r.filter!=="none":!1)||ete.some(n=>(r.willChange||"").includes(n))||tte.some(n=>(r.contain||"").includes(n))}function rte(t){let e=Iu(t);for(;gl(e)&&!nm(e);){if(WP(e))return e;if(y1(e))return null;e=Iu(e)}return null}function qP(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}const nte=new Set(["html","body","#document"]);function nm(t){return nte.has(Tm(t))}function Ia(t){return Eo(t).getComputedStyle(t)}function _1(t){return Ma(t)?{scrollLeft:t.scrollLeft,scrollTop:t.scrollTop}:{scrollLeft:t.scrollX,scrollTop:t.scrollY}}function Iu(t){if(Tm(t)==="html")return t;const e=t.assignedSlot||t.parentNode||LD(t)&&t.host||_l(t);return LD(e)?e.host:e}function $j(t){const e=Iu(t);return nm(e)?t.ownerDocument?t.ownerDocument.body:t.body:gl(e)&&X0(e)?e:$j(e)}function m0(t,e,r){var n;e===void 0&&(e=[]),r===void 0&&(r=!0);const s=$j(t),c=s===((n=t.ownerDocument)==null?void 0:n.body),l=Eo(s);if(c){const a=uE(l);return e.concat(l,l.visualViewport||[],X0(s)?s:[],a&&r?m0(a):[])}return e.concat(s,m0(s,[],r))}function uE(t){return t.parent&&Object.getPrototypeOf(t.parent)?t.frameElement:null}function Vj(t){const e=Ia(t);let r=parseFloat(e.width)||0,n=parseFloat(e.height)||0;const s=gl(t),c=s?t.offsetWidth:r,l=s?t.offsetHeight:n,a=gb(r)!==c||gb(n)!==l;return a&&(r=c,n=l),{width:r,height:n,$:a}}function HP(t){return Ma(t)?t:t.contextElement}function Lp(t){const e=HP(t);if(!gl(e))return ml(1);const r=e.getBoundingClientRect(),{width:n,height:s,$:c}=Vj(e);let l=(c?gb(r.width):r.width)/n,a=(c?gb(r.height):r.height)/s;return(!l||!Number.isFinite(l))&&(l=1),(!a||!Number.isFinite(a))&&(a=1),{x:l,y:a}}const ite=ml(0);function Uj(t){const e=Eo(t);return!qP()||!e.visualViewport?ite:{x:e.visualViewport.offsetLeft,y:e.visualViewport.offsetTop}}function ste(t,e,r){return e===void 0&&(e=!1),!r||e&&r!==Eo(t)?!1:e}function Td(t,e,r,n){e===void 0&&(e=!1),r===void 0&&(r=!1);const s=t.getBoundingClientRect(),c=HP(t);let l=ml(1);e&&(n?Ma(n)&&(l=Lp(n)):l=Lp(t));const a=ste(c,r,n)?Uj(c):ml(0);let m=(s.left+a.x)/l.x,y=(s.top+a.y)/l.y,v=s.width/l.x,T=s.height/l.y;if(c){const P=Eo(c),A=n&&Ma(n)?Eo(n):n;let O=P,I=uE(O);for(;I&&n&&A!==O;){const L=Lp(I),R=I.getBoundingClientRect(),z=Ia(I),j=R.left+(I.clientLeft+parseFloat(z.paddingLeft))*L.x,W=R.top+(I.clientTop+parseFloat(z.paddingTop))*L.y;m*=L.x,y*=L.y,v*=L.x,T*=L.y,m+=j,y+=W,O=Eo(I),I=uE(O)}}return _b({width:v,height:T,x:m,y})}function v1(t,e){const r=_1(t).scrollLeft;return e?e.left+r:Td(_l(t)).left+r}function Gj(t,e){const r=t.getBoundingClientRect(),n=r.left+e.scrollLeft-v1(t,r),s=r.top+e.scrollTop;return{x:n,y:s}}function ote(t){let{elements:e,rect:r,offsetParent:n,strategy:s}=t;const c=s==="fixed",l=_l(n),a=e?y1(e.floating):!1;if(n===l||a&&c)return r;let m={scrollLeft:0,scrollTop:0},y=ml(1);const v=ml(0),T=gl(n);if((T||!T&&!c)&&((Tm(n)!=="body"||X0(l))&&(m=_1(n)),gl(n))){const A=Td(n);y=Lp(n),v.x=A.x+n.clientLeft,v.y=A.y+n.clientTop}const P=l&&!T&&!c?Gj(l,m):ml(0);return{width:r.width*y.x,height:r.height*y.y,x:r.x*y.x-m.scrollLeft*y.x+v.x+P.x,y:r.y*y.y-m.scrollTop*y.y+v.y+P.y}}function ate(t){return Array.from(t.getClientRects())}function lte(t){const e=_l(t),r=_1(t),n=t.ownerDocument.body,s=xo(e.scrollWidth,e.clientWidth,n.scrollWidth,n.clientWidth),c=xo(e.scrollHeight,e.clientHeight,n.scrollHeight,n.clientHeight);let l=-r.scrollLeft+v1(t);const a=-r.scrollTop;return Ia(n).direction==="rtl"&&(l+=xo(e.clientWidth,n.clientWidth)-s),{width:s,height:c,x:l,y:a}}const OD=25;function cte(t,e){const r=Eo(t),n=_l(t),s=r.visualViewport;let c=n.clientWidth,l=n.clientHeight,a=0,m=0;if(s){c=s.width,l=s.height;const v=qP();(!v||v&&e==="fixed")&&(a=s.offsetLeft,m=s.offsetTop)}const y=v1(n);if(y<=0){const v=n.ownerDocument,T=v.body,P=getComputedStyle(T),A=v.compatMode==="CSS1Compat"&&parseFloat(P.marginLeft)+parseFloat(P.marginRight)||0,O=Math.abs(n.clientWidth-T.clientWidth-A);O<=OD&&(c-=O)}else y<=OD&&(c+=y);return{width:c,height:l,x:a,y:m}}const ute=new Set(["absolute","fixed"]);function hte(t,e){const r=Td(t,!0,e==="fixed"),n=r.top+t.clientTop,s=r.left+t.clientLeft,c=gl(t)?Lp(t):ml(1),l=t.clientWidth*c.x,a=t.clientHeight*c.y,m=s*c.x,y=n*c.y;return{width:l,height:a,x:m,y}}function zD(t,e,r){let n;if(e==="viewport")n=cte(t,r);else if(e==="document")n=lte(_l(t));else if(Ma(e))n=hte(e,r);else{const s=Uj(t);n={x:e.x-s.x,y:e.y-s.y,width:e.width,height:e.height}}return _b(n)}function Wj(t,e){const r=Iu(t);return r===e||!Ma(r)||nm(r)?!1:Ia(r).position==="fixed"||Wj(r,e)}function dte(t,e){const r=e.get(t);if(r)return r;let n=m0(t,[],!1).filter(a=>Ma(a)&&Tm(a)!=="body"),s=null;const c=Ia(t).position==="fixed";let l=c?Iu(t):t;for(;Ma(l)&&!nm(l);){const a=Ia(l),m=WP(l);!m&&a.position==="fixed"&&(s=null),(c?!m&&!s:!m&&a.position==="static"&&!!s&&ute.has(s.position)||X0(l)&&!m&&Wj(t,l))?n=n.filter(v=>v!==l):s=a,l=Iu(l)}return e.set(t,n),n}function fte(t){let{element:e,boundary:r,rootBoundary:n,strategy:s}=t;const l=[...r==="clippingAncestors"?y1(e)?[]:dte(e,this._c):[].concat(r),n],a=l[0],m=l.reduce((y,v)=>{const T=zD(e,v,s);return y.top=xo(T.top,y.top),y.right=Mu(T.right,y.right),y.bottom=Mu(T.bottom,y.bottom),y.left=xo(T.left,y.left),y},zD(e,a,s));return{width:m.right-m.left,height:m.bottom-m.top,x:m.left,y:m.top}}function pte(t){const{width:e,height:r}=Vj(t);return{width:e,height:r}}function mte(t,e,r){const n=gl(e),s=_l(e),c=r==="fixed",l=Td(t,!0,c,e);let a={scrollLeft:0,scrollTop:0};const m=ml(0);function y(){m.x=v1(s)}if(n||!n&&!c)if((Tm(e)!=="body"||X0(s))&&(a=_1(e)),n){const A=Td(e,!0,c,e);m.x=A.x+e.clientLeft,m.y=A.y+e.clientTop}else s&&y();c&&!n&&s&&y();const v=s&&!n&&!c?Gj(s,a):ml(0),T=l.left+a.scrollLeft-m.x-v.x,P=l.top+a.scrollTop-m.y-v.y;return{x:T,y:P,width:l.width,height:l.height}}function eS(t){return Ia(t).position==="static"}function ND(t,e){if(!gl(t)||Ia(t).position==="fixed")return null;if(e)return e(t);let r=t.offsetParent;return _l(t)===r&&(r=r.ownerDocument.body),r}function qj(t,e){const r=Eo(t);if(y1(t))return r;if(!gl(t)){let s=Iu(t);for(;s&&!nm(s);){if(Ma(s)&&!eS(s))return s;s=Iu(s)}return r}let n=ND(t,e);for(;n&&Yee(n)&&eS(n);)n=ND(n,e);return n&&nm(n)&&eS(n)&&!WP(n)?r:n||rte(t)||r}const gte=async function(t){const e=this.getOffsetParent||qj,r=this.getDimensions,n=await r(t.floating);return{reference:mte(t.reference,await e(t.floating),t.strategy),floating:{x:0,y:0,width:n.width,height:n.height}}};function yte(t){return Ia(t).direction==="rtl"}const _te={convertOffsetParentRelativeRectToViewportRelativeRect:ote,getDocumentElement:_l,getClippingRect:fte,getOffsetParent:qj,getElementRects:gte,getClientRects:ate,getDimensions:pte,getScale:Lp,isElement:Ma,isRTL:yte};function Hj(t,e){return t.x===e.x&&t.y===e.y&&t.width===e.width&&t.height===e.height}function vte(t,e){let r=null,n;const s=_l(t);function c(){var a;clearTimeout(n),(a=r)==null||a.disconnect(),r=null}function l(a,m){a===void 0&&(a=!1),m===void 0&&(m=1),c();const y=t.getBoundingClientRect(),{left:v,top:T,width:P,height:A}=y;if(a||e(),!P||!A)return;const O=Zv(T),I=Zv(s.clientWidth-(v+P)),L=Zv(s.clientHeight-(T+A)),R=Zv(v),j={rootMargin:-O+"px "+-I+"px "+-L+"px "+-R+"px",threshold:xo(0,Mu(1,m))||1};let W=!0;function Z(te){const ie=te[0].intersectionRatio;if(ie!==m){if(!W)return l();ie?l(!1,ie):n=setTimeout(()=>{l(!1,1e-7)},1e3)}ie===1&&!Hj(y,t.getBoundingClientRect())&&l(),W=!1}try{r=new IntersectionObserver(Z,{...j,root:s.ownerDocument})}catch{r=new IntersectionObserver(Z,j)}r.observe(t)}return l(!0),c}function xte(t,e,r,n){n===void 0&&(n={});const{ancestorScroll:s=!0,ancestorResize:c=!0,elementResize:l=typeof ResizeObserver=="function",layoutShift:a=typeof IntersectionObserver=="function",animationFrame:m=!1}=n,y=HP(t),v=s||c?[...y?m0(y):[],...m0(e)]:[];v.forEach(R=>{s&&R.addEventListener("scroll",r,{passive:!0}),c&&R.addEventListener("resize",r)});const T=y&&a?vte(y,r):null;let P=-1,A=null;l&&(A=new ResizeObserver(R=>{let[z]=R;z&&z.target===y&&A&&(A.unobserve(e),cancelAnimationFrame(P),P=requestAnimationFrame(()=>{var j;(j=A)==null||j.observe(e)})),r()}),y&&!m&&A.observe(y),A.observe(e));let O,I=m?Td(t):null;m&&L();function L(){const R=Td(t);I&&!Hj(I,R)&&r(),I=R,O=requestAnimationFrame(L)}return r(),()=>{var R;v.forEach(z=>{s&&z.removeEventListener("scroll",r),c&&z.removeEventListener("resize",r)}),T==null||T(),(R=A)==null||R.disconnect(),A=null,m&&cancelAnimationFrame(O)}}const bte=Wee,wte=qee,Ste=Vee,Tte=Zee,Ete=Uee,jD=$ee,Cte=Hee,Pte=(t,e,r)=>{const n=new Map,s={platform:_te,...r},c={...s.platform,_c:n};return Bee(t,e,{...s,platform:c})};var Ate=typeof document<"u",kte=function(){},Ex=Ate?X.useLayoutEffect:kte;function vb(t,e){if(t===e)return!0;if(typeof t!=typeof e)return!1;if(typeof t=="function"&&t.toString()===e.toString())return!0;let r,n,s;if(t&&e&&typeof t=="object"){if(Array.isArray(t)){if(r=t.length,r!==e.length)return!1;for(n=r;n--!==0;)if(!vb(t[n],e[n]))return!1;return!0}if(s=Object.keys(t),r=s.length,r!==Object.keys(e).length)return!1;for(n=r;n--!==0;)if(!{}.hasOwnProperty.call(e,s[n]))return!1;for(n=r;n--!==0;){const c=s[n];if(!(c==="_owner"&&t.$$typeof)&&!vb(t[c],e[c]))return!1}return!0}return t!==t&&e!==e}function Zj(t){return typeof window>"u"?1:(t.ownerDocument.defaultView||window).devicePixelRatio||1}function FD(t,e){const r=Zj(t);return Math.round(e*r)/r}function tS(t){const e=X.useRef(t);return Ex(()=>{e.current=t}),e}function Mte(t){t===void 0&&(t={});const{placement:e="bottom",strategy:r="absolute",middleware:n=[],platform:s,elements:{reference:c,floating:l}={},transform:a=!0,whileElementsMounted:m,open:y}=t,[v,T]=X.useState({x:0,y:0,strategy:r,placement:e,middlewareData:{},isPositioned:!1}),[P,A]=X.useState(n);vb(P,n)||A(n);const[O,I]=X.useState(null),[L,R]=X.useState(null),z=X.useCallback(fe=>{fe!==te.current&&(te.current=fe,I(fe))},[]),j=X.useCallback(fe=>{fe!==ie.current&&(ie.current=fe,R(fe))},[]),W=c||O,Z=l||L,te=X.useRef(null),ie=X.useRef(null),V=X.useRef(v),q=m!=null,Q=tS(m),ce=tS(s),se=tS(y),ue=X.useCallback(()=>{if(!te.current||!ie.current)return;const fe={placement:e,strategy:r,middleware:P};ce.current&&(fe.platform=ce.current),Pte(te.current,ie.current,fe).then(ve=>{const Re={...ve,isPositioned:se.current!==!1};he.current&&!vb(V.current,Re)&&(V.current=Re,B0.flushSync(()=>{T(Re)}))})},[P,e,r,ce,se]);Ex(()=>{y===!1&&V.current.isPositioned&&(V.current.isPositioned=!1,T(fe=>({...fe,isPositioned:!1})))},[y]);const he=X.useRef(!1);Ex(()=>(he.current=!0,()=>{he.current=!1}),[]),Ex(()=>{if(W&&(te.current=W),Z&&(ie.current=Z),W&&Z){if(Q.current)return Q.current(W,Z,ue);ue()}},[W,Z,ue,Q,q]);const ye=X.useMemo(()=>({reference:te,floating:ie,setReference:z,setFloating:j}),[z,j]),xe=X.useMemo(()=>({reference:W,floating:Z}),[W,Z]),Se=X.useMemo(()=>{const fe={position:r,left:0,top:0};if(!xe.floating)return fe;const ve=FD(xe.floating,v.x),Re=FD(xe.floating,v.y);return a?{...fe,transform:"translate("+ve+"px, "+Re+"px)",...Zj(xe.floating)>=1.5&&{willChange:"transform"}}:{position:r,left:ve,top:Re}},[r,a,xe.floating,v.x,v.y]);return X.useMemo(()=>({...v,update:ue,refs:ye,elements:xe,floatingStyles:Se}),[v,ue,ye,xe,Se])}const Ite=t=>{function e(r){return{}.hasOwnProperty.call(r,"current")}return{name:"arrow",options:t,fn(r){const{element:n,padding:s}=typeof t=="function"?t(r):t;return n&&e(n)?n.current!=null?jD({element:n.current,padding:s}).fn(r):{}:n?jD({element:n,padding:s}).fn(r):{}}}},Rte=(t,e)=>({...bte(t),options:[t,e]}),Dte=(t,e)=>({...wte(t),options:[t,e]}),Lte=(t,e)=>({...Cte(t),options:[t,e]}),Ote=(t,e)=>({...Ste(t),options:[t,e]}),zte=(t,e)=>({...Tte(t),options:[t,e]}),Nte=(t,e)=>({...Ete(t),options:[t,e]}),jte=(t,e)=>({...Ite(t),options:[t,e]});var Fte="Arrow",Kj=X.forwardRef((t,e)=>{const{children:r,width:n=10,height:s=5,...c}=t;return B.jsx(tn.svg,{...c,ref:e,width:n,height:s,viewBox:"0 0 30 10",preserveAspectRatio:"none",children:t.asChild?r:B.jsx("polygon",{points:"0,0 30,0 15,10"})})});Kj.displayName=Fte;var Bte=Kj;function $te(t){const[e,r]=X.useState(void 0);return ic(()=>{if(t){r({width:t.offsetWidth,height:t.offsetHeight});const n=new ResizeObserver(s=>{if(!Array.isArray(s)||!s.length)return;const c=s[0];let l,a;if("borderBoxSize"in c){const m=c.borderBoxSize,y=Array.isArray(m)?m[0]:m;l=y.inlineSize,a=y.blockSize}else l=t.offsetWidth,a=t.offsetHeight;r({width:l,height:a})});return n.observe(t,{box:"border-box"}),()=>n.unobserve(t)}else r(void 0)},[t]),e}var Xj="Popper",[Yj,Qj]=Dd(Xj),[Due,Jj]=Yj(Xj),eF="PopperAnchor",tF=X.forwardRef((t,e)=>{const{__scopePopper:r,virtualRef:n,...s}=t,c=Jj(eF,r),l=X.useRef(null),a=ms(e,l),m=X.useRef(null);return X.useEffect(()=>{const y=m.current;m.current=(n==null?void 0:n.current)||l.current,y!==m.current&&c.onAnchorChange(m.current)}),n?null:B.jsx(tn.div,{...s,ref:a})});tF.displayName=eF;var ZP="PopperContent",[Vte,Ute]=Yj(ZP),rF=X.forwardRef((t,e)=>{var Pt,Ht,ir,yr,$t,vt;const{__scopePopper:r,side:n="bottom",sideOffset:s=0,align:c="center",alignOffset:l=0,arrowPadding:a=0,avoidCollisions:m=!0,collisionBoundary:y=[],collisionPadding:v=0,sticky:T="partial",hideWhenDetached:P=!1,updatePositionStrategy:A="optimized",onPlaced:O,...I}=t,L=Jj(ZP,r),[R,z]=X.useState(null),j=ms(e,Et=>z(Et)),[W,Z]=X.useState(null),te=$te(W),ie=(te==null?void 0:te.width)??0,V=(te==null?void 0:te.height)??0,q=n+(c!=="center"?"-"+c:""),Q=typeof v=="number"?v:{top:0,right:0,bottom:0,left:0,...v},ce=Array.isArray(y)?y:[y],se=ce.length>0,ue={padding:Q,boundary:ce.filter(Wte),altBoundary:se},{refs:he,floatingStyles:ye,placement:xe,isPositioned:Se,middlewareData:fe}=Mte({strategy:"fixed",placement:q,whileElementsMounted:(...Et)=>xte(...Et,{animationFrame:A==="always"}),elements:{reference:L.anchor},middleware:[Rte({mainAxis:s+V,alignmentAxis:l}),m&&Dte({mainAxis:!0,crossAxis:!1,limiter:T==="partial"?Lte():void 0,...ue}),m&&Ote({...ue}),zte({...ue,apply:({elements:Et,rects:Rt,availableWidth:Ft,availableHeight:Nr})=>{const{width:Zr,height:Kr}=Rt.reference,Ar=Et.floating.style;Ar.setProperty("--radix-popper-available-width",`${Ft}px`),Ar.setProperty("--radix-popper-available-height",`${Nr}px`),Ar.setProperty("--radix-popper-anchor-width",`${Zr}px`),Ar.setProperty("--radix-popper-anchor-height",`${Kr}px`)}}),W&&jte({element:W,padding:a}),qte({arrowWidth:ie,arrowHeight:V}),P&&Nte({strategy:"referenceHidden",...ue})]}),[ve,Re]=sF(xe),$e=ka(O);ic(()=>{Se&&($e==null||$e())},[Se,$e]);const Xe=(Pt=fe.arrow)==null?void 0:Pt.x,st=(Ht=fe.arrow)==null?void 0:Ht.y,at=((ir=fe.arrow)==null?void 0:ir.centerOffset)!==0,[_t,Ct]=X.useState();return ic(()=>{R&&Ct(window.getComputedStyle(R).zIndex)},[R]),B.jsx("div",{ref:he.setFloating,"data-radix-popper-content-wrapper":"",style:{...ye,transform:Se?ye.transform:"translate(0, -200%)",minWidth:"max-content",zIndex:_t,"--radix-popper-transform-origin":[(yr=fe.transformOrigin)==null?void 0:yr.x,($t=fe.transformOrigin)==null?void 0:$t.y].join(" "),...((vt=fe.hide)==null?void 0:vt.referenceHidden)&&{visibility:"hidden",pointerEvents:"none"}},dir:t.dir,children:B.jsx(Vte,{scope:r,placedSide:ve,onArrowChange:Z,arrowX:Xe,arrowY:st,shouldHideArrow:at,children:B.jsx(tn.div,{"data-side":ve,"data-align":Re,...I,ref:j,style:{...I.style,animation:Se?void 0:"none"}})})})});rF.displayName=ZP;var nF="PopperArrow",Gte={top:"bottom",right:"left",bottom:"top",left:"right"},iF=X.forwardRef(function(e,r){const{__scopePopper:n,...s}=e,c=Ute(nF,n),l=Gte[c.placedSide];return B.jsx("span",{ref:c.onArrowChange,style:{position:"absolute",left:c.arrowX,top:c.arrowY,[l]:0,transformOrigin:{top:"",right:"0 0",bottom:"center 0",left:"100% 0"}[c.placedSide],transform:{top:"translateY(100%)",right:"translateY(50%) rotate(90deg) translateX(-50%)",bottom:"rotate(180deg)",left:"translateY(50%) rotate(-90deg) translateX(50%)"}[c.placedSide],visibility:c.shouldHideArrow?"hidden":void 0},children:B.jsx(Bte,{...s,ref:r,style:{...s.style,display:"block"}})})});iF.displayName=nF;function Wte(t){return t!==null}var qte=t=>({name:"transformOrigin",options:t,fn(e){var L,R,z;const{placement:r,rects:n,middlewareData:s}=e,l=((L=s.arrow)==null?void 0:L.centerOffset)!==0,a=l?0:t.arrowWidth,m=l?0:t.arrowHeight,[y,v]=sF(r),T={start:"0%",center:"50%",end:"100%"}[v],P=(((R=s.arrow)==null?void 0:R.x)??0)+a/2,A=(((z=s.arrow)==null?void 0:z.y)??0)+m/2;let O="",I="";return y==="bottom"?(O=l?T:`${P}px`,I=`${-m}px`):y==="top"?(O=l?T:`${P}px`,I=`${n.floating.height+m}px`):y==="right"?(O=`${-m}px`,I=l?T:`${A}px`):y==="left"&&(O=`${n.floating.width+m}px`,I=l?T:`${A}px`),{data:{x:O,y:I}}}});function sF(t){const[e,r="center"]=t.split("-");return[e,r]}var Hte=tF,Zte=rF,Kte=iF,[x1]=Dd("Tooltip",[Qj]),KP=Qj(),oF="TooltipProvider",Xte=700,BD="tooltip.open",[Yte,aF]=x1(oF),lF=t=>{const{__scopeTooltip:e,delayDuration:r=Xte,skipDelayDuration:n=300,disableHoverableContent:s=!1,children:c}=t,l=X.useRef(!0),a=X.useRef(!1),m=X.useRef(0);return X.useEffect(()=>{const y=m.current;return()=>window.clearTimeout(y)},[]),B.jsx(Yte,{scope:e,isOpenDelayedRef:l,delayDuration:r,onOpen:X.useCallback(()=>{window.clearTimeout(m.current),l.current=!1},[]),onClose:X.useCallback(()=>{window.clearTimeout(m.current),m.current=window.setTimeout(()=>l.current=!0,n)},[n]),isPointerInTransitRef:a,onPointerInTransitChange:X.useCallback(y=>{a.current=y},[]),disableHoverableContent:s,children:c})};lF.displayName=oF;var cF="Tooltip",[Lue,b1]=x1(cF),hE="TooltipTrigger",Qte=X.forwardRef((t,e)=>{const{__scopeTooltip:r,...n}=t,s=b1(hE,r),c=aF(hE,r),l=KP(r),a=X.useRef(null),m=ms(e,a,s.onTriggerChange),y=X.useRef(!1),v=X.useRef(!1),T=X.useCallback(()=>y.current=!1,[]);return X.useEffect(()=>()=>document.removeEventListener("pointerup",T),[T]),B.jsx(Hte,{asChild:!0,...l,children:B.jsx(tn.button,{"aria-describedby":s.open?s.contentId:void 0,"data-state":s.stateAttribute,...n,ref:m,onPointerMove:Rr(t.onPointerMove,P=>{P.pointerType!=="touch"&&!v.current&&!c.isPointerInTransitRef.current&&(s.onTriggerEnter(),v.current=!0)}),onPointerLeave:Rr(t.onPointerLeave,()=>{s.onTriggerLeave(),v.current=!1}),onPointerDown:Rr(t.onPointerDown,()=>{s.open&&s.onClose(),y.current=!0,document.addEventListener("pointerup",T,{once:!0})}),onFocus:Rr(t.onFocus,()=>{y.current||s.onOpen()}),onBlur:Rr(t.onBlur,s.onClose),onClick:Rr(t.onClick,s.onClose)})})});Qte.displayName=hE;var Jte="TooltipPortal",[Oue,ere]=x1(Jte,{forceMount:void 0}),im="TooltipContent",uF=X.forwardRef((t,e)=>{const r=ere(im,t.__scopeTooltip),{forceMount:n=r.forceMount,side:s="top",...c}=t,l=b1(im,t.__scopeTooltip);return B.jsx(Ld,{present:n||l.open,children:l.disableHoverableContent?B.jsx(hF,{side:s,...c,ref:e}):B.jsx(tre,{side:s,...c,ref:e})})}),tre=X.forwardRef((t,e)=>{const r=b1(im,t.__scopeTooltip),n=aF(im,t.__scopeTooltip),s=X.useRef(null),c=ms(e,s),[l,a]=X.useState(null),{trigger:m,onClose:y}=r,v=s.current,{onPointerInTransitChange:T}=n,P=X.useCallback(()=>{a(null),T(!1)},[T]),A=X.useCallback((O,I)=>{const L=O.currentTarget,R={x:O.clientX,y:O.clientY},z=ore(R,L.getBoundingClientRect()),j=are(R,z),W=lre(I.getBoundingClientRect()),Z=ure([...j,...W]);a(Z),T(!0)},[T]);return X.useEffect(()=>()=>P(),[P]),X.useEffect(()=>{if(m&&v){const O=L=>A(L,v),I=L=>A(L,m);return m.addEventListener("pointerleave",O),v.addEventListener("pointerleave",I),()=>{m.removeEventListener("pointerleave",O),v.removeEventListener("pointerleave",I)}}},[m,v,A,P]),X.useEffect(()=>{if(l){const O=I=>{const L=I.target,R={x:I.clientX,y:I.clientY},z=(m==null?void 0:m.contains(L))||(v==null?void 0:v.contains(L)),j=!cre(R,l);z?P():j&&(P(),y())};return document.addEventListener("pointermove",O),()=>document.removeEventListener("pointermove",O)}},[m,v,l,y,P]),B.jsx(hF,{...t,ref:c})}),[rre,nre]=x1(cF,{isInside:!1}),ire=hQ("TooltipContent"),hF=X.forwardRef((t,e)=>{const{__scopeTooltip:r,children:n,"aria-label":s,onEscapeKeyDown:c,onPointerDownOutside:l,...a}=t,m=b1(im,r),y=KP(r),{onClose:v}=m;return X.useEffect(()=>(document.addEventListener(BD,v),()=>document.removeEventListener(BD,v)),[v]),X.useEffect(()=>{if(m.trigger){const T=P=>{const A=P.target;A!=null&&A.contains(m.trigger)&&v()};return window.addEventListener("scroll",T,{capture:!0}),()=>window.removeEventListener("scroll",T,{capture:!0})}},[m.trigger,v]),B.jsx(h1,{asChild:!0,disableOutsidePointerEvents:!1,onEscapeKeyDown:c,onPointerDownOutside:l,onFocusOutside:T=>T.preventDefault(),onDismiss:v,children:B.jsxs(Zte,{"data-state":m.stateAttribute,...y,...a,ref:e,style:{...a.style,"--radix-tooltip-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-tooltip-content-available-width":"var(--radix-popper-available-width)","--radix-tooltip-content-available-height":"var(--radix-popper-available-height)","--radix-tooltip-trigger-width":"var(--radix-popper-anchor-width)","--radix-tooltip-trigger-height":"var(--radix-popper-anchor-height)"},children:[B.jsx(ire,{children:n}),B.jsx(rre,{scope:r,isInside:!0,children:B.jsx(oee,{id:m.contentId,role:"tooltip",children:s||n})})]})})});uF.displayName=im;var dF="TooltipArrow",sre=X.forwardRef((t,e)=>{const{__scopeTooltip:r,...n}=t,s=KP(r);return nre(dF,r).isInside?null:B.jsx(Kte,{...s,...n,ref:e})});sre.displayName=dF;function ore(t,e){const r=Math.abs(e.top-t.y),n=Math.abs(e.bottom-t.y),s=Math.abs(e.right-t.x),c=Math.abs(e.left-t.x);switch(Math.min(r,n,s,c)){case c:return"left";case s:return"right";case r:return"top";case n:return"bottom";default:throw new Error("unreachable")}}function are(t,e,r=5){const n=[];switch(e){case"top":n.push({x:t.x-r,y:t.y+r},{x:t.x+r,y:t.y+r});break;case"bottom":n.push({x:t.x-r,y:t.y-r},{x:t.x+r,y:t.y-r});break;case"left":n.push({x:t.x+r,y:t.y-r},{x:t.x+r,y:t.y+r});break;case"right":n.push({x:t.x-r,y:t.y-r},{x:t.x-r,y:t.y+r});break}return n}function lre(t){const{top:e,right:r,bottom:n,left:s}=t;return[{x:s,y:e},{x:r,y:e},{x:r,y:n},{x:s,y:n}]}function cre(t,e){const{x:r,y:n}=t;let s=!1;for(let c=0,l=e.length-1;c<e.length;l=c++){const a=e[c],m=e[l],y=a.x,v=a.y,T=m.x,P=m.y;v>n!=P>n&&r<(T-y)*(n-v)/(P-v)+y&&(s=!s)}return s}function ure(t){const e=t.slice();return e.sort((r,n)=>r.x<n.x?-1:r.x>n.x?1:r.y<n.y?-1:r.y>n.y?1:0),hre(e)}function hre(t){if(t.length<=1)return t.slice();const e=[];for(let n=0;n<t.length;n++){const s=t[n];for(;e.length>=2;){const c=e[e.length-1],l=e[e.length-2];if((c.x-l.x)*(s.y-l.y)>=(c.y-l.y)*(s.x-l.x))e.pop();else break}e.push(s)}e.pop();const r=[];for(let n=t.length-1;n>=0;n--){const s=t[n];for(;r.length>=2;){const c=r[r.length-1],l=r[r.length-2];if((c.x-l.x)*(s.y-l.y)>=(c.y-l.y)*(s.x-l.x))r.pop();else break}r.push(s)}return r.pop(),e.length===1&&r.length===1&&e[0].x===r[0].x&&e[0].y===r[0].y?e:e.concat(r)}var dre=lF,fF=uF;const fre=dre,pre=X.forwardRef(({className:t,sideOffset:e=4,...r},n)=>B.jsx(fF,{ref:n,sideOffset:e,className:Lr("z-50 overflow-hidden rounded-md border bg-popover px-3 py-1.5 text-sm text-popover-foreground shadow-md animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",t),...r}));pre.displayName=fF.displayName;var w1=class{constructor(){this.listeners=new Set,this.subscribe=this.subscribe.bind(this)}subscribe(t){return this.listeners.add(t),this.onSubscribe(),()=>{this.listeners.delete(t),this.onUnsubscribe()}}hasListeners(){return this.listeners.size>0}onSubscribe(){}onUnsubscribe(){}},mre={setTimeout:(t,e)=>setTimeout(t,e),clearTimeout:t=>clearTimeout(t),setInterval:(t,e)=>setInterval(t,e),clearInterval:t=>clearInterval(t)},nu,QE,A3,gre=(A3=class{constructor(){Er(this,nu,mre);Er(this,QE,!1)}setTimeoutProvider(t){Jt(this,nu,t)}setTimeout(t,e){return rt(this,nu).setTimeout(t,e)}clearTimeout(t){rt(this,nu).clearTimeout(t)}setInterval(t,e){return rt(this,nu).setInterval(t,e)}clearInterval(t){rt(this,nu).clearInterval(t)}},nu=new WeakMap,QE=new WeakMap,A3),dE=new gre;function yre(t){setTimeout(t,0)}var S1=typeof window>"u"||"Deno"in globalThis;function ya(){}function _re(t,e){return typeof t=="function"?t(e):t}function vre(t){return typeof t=="number"&&t>=0&&t!==1/0}function xre(t,e){return Math.max(t+(e||0)-Date.now(),0)}function fE(t,e){return typeof t=="function"?t(e):t}function bre(t,e){return typeof t=="function"?t(e):t}function $D(t,e){const{type:r="all",exact:n,fetchStatus:s,predicate:c,queryKey:l,stale:a}=t;if(l){if(n){if(e.queryHash!==XP(l,e.options))return!1}else if(!y0(e.queryKey,l))return!1}if(r!=="all"){const m=e.isActive();if(r==="active"&&!m||r==="inactive"&&m)return!1}return!(typeof a=="boolean"&&e.isStale()!==a||s&&s!==e.state.fetchStatus||c&&!c(e))}function VD(t,e){const{exact:r,status:n,predicate:s,mutationKey:c}=t;if(c){if(!e.options.mutationKey)return!1;if(r){if(g0(e.options.mutationKey)!==g0(c))return!1}else if(!y0(e.options.mutationKey,c))return!1}return!(n&&e.state.status!==n||s&&!s(e))}function XP(t,e){return((e==null?void 0:e.queryKeyHashFn)||g0)(t)}function g0(t){return JSON.stringify(t,(e,r)=>pE(r)?Object.keys(r).sort().reduce((n,s)=>(n[s]=r[s],n),{}):r)}function y0(t,e){return t===e?!0:typeof t!=typeof e?!1:t&&e&&typeof t=="object"&&typeof e=="object"?Object.keys(e).every(r=>y0(t[r],e[r])):!1}var wre=Object.prototype.hasOwnProperty;function pF(t,e){if(t===e)return t;const r=UD(t)&&UD(e);if(!r&&!(pE(t)&&pE(e)))return e;const s=(r?t:Object.keys(t)).length,c=r?e:Object.keys(e),l=c.length,a=r?new Array(l):{};let m=0;for(let y=0;y<l;y++){const v=r?y:c[y],T=t[v],P=e[v];if(T===P){a[v]=T,(r?y<s:wre.call(t,v))&&m++;continue}if(T===null||P===null||typeof T!="object"||typeof P!="object"){a[v]=P;continue}const A=pF(T,P);a[v]=A,A===T&&m++}return s===l&&m===s?t:a}function UD(t){return Array.isArray(t)&&t.length===Object.keys(t).length}function pE(t){if(!GD(t))return!1;const e=t.constructor;if(e===void 0)return!0;const r=e.prototype;return!(!GD(r)||!r.hasOwnProperty("isPrototypeOf")||Object.getPrototypeOf(t)!==Object.prototype)}function GD(t){return Object.prototype.toString.call(t)==="[object Object]"}function Sre(t){return new Promise(e=>{dE.setTimeout(e,t)})}function Tre(t,e,r){return typeof r.structuralSharing=="function"?r.structuralSharing(t,e):r.structuralSharing!==!1?pF(t,e):e}function Ere(t,e,r=0){const n=[...t,e];return r&&n.length>r?n.slice(1):n}function Cre(t,e,r=0){const n=[e,...t];return r&&n.length>r?n.slice(0,-1):n}var YP=Symbol();function mF(t,e){return!t.queryFn&&(e!=null&&e.initialPromise)?()=>e.initialPromise:!t.queryFn||t.queryFn===YP?()=>Promise.reject(new Error(`Missing queryFn: '${t.queryHash}'`)):t.queryFn}var nd,iu,Fp,k3,Pre=(k3=class extends w1{constructor(){super();Er(this,nd);Er(this,iu);Er(this,Fp);Jt(this,Fp,e=>{if(!S1&&window.addEventListener){const r=()=>e();return window.addEventListener("visibilitychange",r,!1),()=>{window.removeEventListener("visibilitychange",r)}}})}onSubscribe(){rt(this,iu)||this.setEventListener(rt(this,Fp))}onUnsubscribe(){var e;this.hasListeners()||((e=rt(this,iu))==null||e.call(this),Jt(this,iu,void 0))}setEventListener(e){var r;Jt(this,Fp,e),(r=rt(this,iu))==null||r.call(this),Jt(this,iu,e(n=>{typeof n=="boolean"?this.setFocused(n):this.onFocus()}))}setFocused(e){rt(this,nd)!==e&&(Jt(this,nd,e),this.onFocus())}onFocus(){const e=this.isFocused();this.listeners.forEach(r=>{r(e)})}isFocused(){var e;return typeof rt(this,nd)=="boolean"?rt(this,nd):((e=globalThis.document)==null?void 0:e.visibilityState)!=="hidden"}},nd=new WeakMap,iu=new WeakMap,Fp=new WeakMap,k3),gF=new Pre;function Are(){let t,e;const r=new Promise((s,c)=>{t=s,e=c});r.status="pending",r.catch(()=>{});function n(s){Object.assign(r,s),delete r.resolve,delete r.reject}return r.resolve=s=>{n({status:"fulfilled",value:s}),t(s)},r.reject=s=>{n({status:"rejected",reason:s}),e(s)},r}var kre=yre;function Mre(){let t=[],e=0,r=a=>{a()},n=a=>{a()},s=kre;const c=a=>{e?t.push(a):s(()=>{r(a)})},l=()=>{const a=t;t=[],a.length&&s(()=>{n(()=>{a.forEach(m=>{r(m)})})})};return{batch:a=>{let m;e++;try{m=a()}finally{e--,e||l()}return m},batchCalls:a=>(...m)=>{c(()=>{a(...m)})},schedule:c,setNotifyFunction:a=>{r=a},setBatchNotifyFunction:a=>{n=a},setScheduler:a=>{s=a}}}var Ps=Mre(),Bp,su,$p,M3,Ire=(M3=class extends w1{constructor(){super();Er(this,Bp,!0);Er(this,su);Er(this,$p);Jt(this,$p,e=>{if(!S1&&window.addEventListener){const r=()=>e(!0),n=()=>e(!1);return window.addEventListener("online",r,!1),window.addEventListener("offline",n,!1),()=>{window.removeEventListener("online",r),window.removeEventListener("offline",n)}}})}onSubscribe(){rt(this,su)||this.setEventListener(rt(this,$p))}onUnsubscribe(){var e;this.hasListeners()||((e=rt(this,su))==null||e.call(this),Jt(this,su,void 0))}setEventListener(e){var r;Jt(this,$p,e),(r=rt(this,su))==null||r.call(this),Jt(this,su,e(this.setOnline.bind(this)))}setOnline(e){rt(this,Bp)!==e&&(Jt(this,Bp,e),this.listeners.forEach(n=>{n(e)}))}isOnline(){return rt(this,Bp)}},Bp=new WeakMap,su=new WeakMap,$p=new WeakMap,M3),xb=new Ire;function Rre(t){return Math.min(1e3*2**t,3e4)}function yF(t){return(t??"online")==="online"?xb.isOnline():!0}var mE=class extends Error{constructor(t){super("CancelledError"),this.revert=t==null?void 0:t.revert,this.silent=t==null?void 0:t.silent}};function _F(t){let e=!1,r=0,n;const s=Are(),c=()=>s.status!=="pending",l=I=>{var L;if(!c()){const R=new mE(I);P(R),(L=t.onCancel)==null||L.call(t,R)}},a=()=>{e=!0},m=()=>{e=!1},y=()=>gF.isFocused()&&(t.networkMode==="always"||xb.isOnline())&&t.canRun(),v=()=>yF(t.networkMode)&&t.canRun(),T=I=>{c()||(n==null||n(),s.resolve(I))},P=I=>{c()||(n==null||n(),s.reject(I))},A=()=>new Promise(I=>{var L;n=R=>{(c()||y())&&I(R)},(L=t.onPause)==null||L.call(t)}).then(()=>{var I;n=void 0,c()||(I=t.onContinue)==null||I.call(t)}),O=()=>{if(c())return;let I;const L=r===0?t.initialPromise:void 0;try{I=L??t.fn()}catch(R){I=Promise.reject(R)}Promise.resolve(I).then(T).catch(R=>{var te;if(c())return;const z=t.retry??(S1?0:3),j=t.retryDelay??Rre,W=typeof j=="function"?j(r,R):j,Z=z===!0||typeof z=="number"&&r<z||typeof z=="function"&&z(r,R);if(e||!Z){P(R);return}r++,(te=t.onFail)==null||te.call(t,r,R),Sre(W).then(()=>y()?void 0:A()).then(()=>{e?P(R):O()})})};return{promise:s,status:()=>s.status,cancel:l,continue:()=>(n==null||n(),s),cancelRetry:a,continueRetry:m,canStart:v,start:()=>(v()?O():A().then(O),s)}}var id,I3,vF=(I3=class{constructor(){Er(this,id)}destroy(){this.clearGcTimeout()}scheduleGc(){this.clearGcTimeout(),vre(this.gcTime)&&Jt(this,id,dE.setTimeout(()=>{this.optionalRemove()},this.gcTime))}updateGcTime(t){this.gcTime=Math.max(this.gcTime||0,t??(S1?1/0:5*60*1e3))}clearGcTimeout(){rt(this,id)&&(dE.clearTimeout(rt(this,id)),Jt(this,id,void 0))}},id=new WeakMap,I3),sd,Vp,Go,od,zi,R0,ad,_a,Vl,R3,Dre=(R3=class extends vF{constructor(e){super();Er(this,_a);Er(this,sd);Er(this,Vp);Er(this,Go);Er(this,od);Er(this,zi);Er(this,R0);Er(this,ad);Jt(this,ad,!1),Jt(this,R0,e.defaultOptions),this.setOptions(e.options),this.observers=[],Jt(this,od,e.client),Jt(this,Go,rt(this,od).getQueryCache()),this.queryKey=e.queryKey,this.queryHash=e.queryHash,Jt(this,sd,WD(this.options)),this.state=e.state??rt(this,sd),this.scheduleGc()}get meta(){return this.options.meta}get promise(){var e;return(e=rt(this,zi))==null?void 0:e.promise}setOptions(e){if(this.options={...rt(this,R0),...e},this.updateGcTime(this.options.gcTime),this.state&&this.state.data===void 0){const r=WD(this.options);r.data!==void 0&&(this.setData(r.data,{updatedAt:r.dataUpdatedAt,manual:!0}),Jt(this,sd,r))}}optionalRemove(){!this.observers.length&&this.state.fetchStatus==="idle"&&rt(this,Go).remove(this)}setData(e,r){const n=Tre(this.state.data,e,this.options);return os(this,_a,Vl).call(this,{data:n,type:"success",dataUpdatedAt:r==null?void 0:r.updatedAt,manual:r==null?void 0:r.manual}),n}setState(e,r){os(this,_a,Vl).call(this,{type:"setState",state:e,setStateOptions:r})}cancel(e){var n,s;const r=(n=rt(this,zi))==null?void 0:n.promise;return(s=rt(this,zi))==null||s.cancel(e),r?r.then(ya).catch(ya):Promise.resolve()}destroy(){super.destroy(),this.cancel({silent:!0})}reset(){this.destroy(),this.setState(rt(this,sd))}isActive(){return this.observers.some(e=>bre(e.options.enabled,this)!==!1)}isDisabled(){return this.getObserversCount()>0?!this.isActive():this.options.queryFn===YP||this.state.dataUpdateCount+this.state.errorUpdateCount===0}isStatic(){return this.getObserversCount()>0?this.observers.some(e=>fE(e.options.staleTime,this)==="static"):!1}isStale(){return this.getObserversCount()>0?this.observers.some(e=>e.getCurrentResult().isStale):this.state.data===void 0||this.state.isInvalidated}isStaleByTime(e=0){return this.state.data===void 0?!0:e==="static"?!1:this.state.isInvalidated?!0:!xre(this.state.dataUpdatedAt,e)}onFocus(){var r;const e=this.observers.find(n=>n.shouldFetchOnWindowFocus());e==null||e.refetch({cancelRefetch:!1}),(r=rt(this,zi))==null||r.continue()}onOnline(){var r;const e=this.observers.find(n=>n.shouldFetchOnReconnect());e==null||e.refetch({cancelRefetch:!1}),(r=rt(this,zi))==null||r.continue()}addObserver(e){this.observers.includes(e)||(this.observers.push(e),this.clearGcTimeout(),rt(this,Go).notify({type:"observerAdded",query:this,observer:e}))}removeObserver(e){this.observers.includes(e)&&(this.observers=this.observers.filter(r=>r!==e),this.observers.length||(rt(this,zi)&&(rt(this,ad)?rt(this,zi).cancel({revert:!0}):rt(this,zi).cancelRetry()),this.scheduleGc()),rt(this,Go).notify({type:"observerRemoved",query:this,observer:e}))}getObserversCount(){return this.observers.length}invalidate(){this.state.isInvalidated||os(this,_a,Vl).call(this,{type:"invalidate"})}async fetch(e,r){var m,y,v,T,P,A,O,I,L,R,z,j;if(this.state.fetchStatus!=="idle"&&((m=rt(this,zi))==null?void 0:m.status())!=="rejected"){if(this.state.data!==void 0&&(r!=null&&r.cancelRefetch))this.cancel({silent:!0});else if(rt(this,zi))return rt(this,zi).continueRetry(),rt(this,zi).promise}if(e&&this.setOptions(e),!this.options.queryFn){const W=this.observers.find(Z=>Z.options.queryFn);W&&this.setOptions(W.options)}const n=new AbortController,s=W=>{Object.defineProperty(W,"signal",{enumerable:!0,get:()=>(Jt(this,ad,!0),n.signal)})},c=()=>{const W=mF(this.options,r),te=(()=>{const ie={client:rt(this,od),queryKey:this.queryKey,meta:this.meta};return s(ie),ie})();return Jt(this,ad,!1),this.options.persister?this.options.persister(W,te,this):W(te)},a=(()=>{const W={fetchOptions:r,options:this.options,queryKey:this.queryKey,client:rt(this,od),state:this.state,fetchFn:c};return s(W),W})();(y=this.options.behavior)==null||y.onFetch(a,this),Jt(this,Vp,this.state),(this.state.fetchStatus==="idle"||this.state.fetchMeta!==((v=a.fetchOptions)==null?void 0:v.meta))&&os(this,_a,Vl).call(this,{type:"fetch",meta:(T=a.fetchOptions)==null?void 0:T.meta}),Jt(this,zi,_F({initialPromise:r==null?void 0:r.initialPromise,fn:a.fetchFn,onCancel:W=>{W instanceof mE&&W.revert&&this.setState({...rt(this,Vp),fetchStatus:"idle"}),n.abort()},onFail:(W,Z)=>{os(this,_a,Vl).call(this,{type:"failed",failureCount:W,error:Z})},onPause:()=>{os(this,_a,Vl).call(this,{type:"pause"})},onContinue:()=>{os(this,_a,Vl).call(this,{type:"continue"})},retry:a.options.retry,retryDelay:a.options.retryDelay,networkMode:a.options.networkMode,canRun:()=>!0}));try{const W=await rt(this,zi).start();if(W===void 0)throw new Error(`${this.queryHash} data is undefined`);return this.setData(W),(A=(P=rt(this,Go).config).onSuccess)==null||A.call(P,W,this),(I=(O=rt(this,Go).config).onSettled)==null||I.call(O,W,this.state.error,this),W}catch(W){if(W instanceof mE){if(W.silent)return rt(this,zi).promise;if(W.revert){if(this.state.data===void 0)throw W;return this.state.data}}throw os(this,_a,Vl).call(this,{type:"error",error:W}),(R=(L=rt(this,Go).config).onError)==null||R.call(L,W,this),(j=(z=rt(this,Go).config).onSettled)==null||j.call(z,this.state.data,W,this),W}finally{this.scheduleGc()}}},sd=new WeakMap,Vp=new WeakMap,Go=new WeakMap,od=new WeakMap,zi=new WeakMap,R0=new WeakMap,ad=new WeakMap,_a=new WeakSet,Vl=function(e){const r=n=>{switch(e.type){case"failed":return{...n,fetchFailureCount:e.failureCount,fetchFailureReason:e.error};case"pause":return{...n,fetchStatus:"paused"};case"continue":return{...n,fetchStatus:"fetching"};case"fetch":return{...n,...Lre(n.data,this.options),fetchMeta:e.meta??null};case"success":const s={...n,data:e.data,dataUpdateCount:n.dataUpdateCount+1,dataUpdatedAt:e.dataUpdatedAt??Date.now(),error:null,isInvalidated:!1,status:"success",...!e.manual&&{fetchStatus:"idle",fetchFailureCount:0,fetchFailureReason:null}};return Jt(this,Vp,e.manual?s:void 0),s;case"error":const c=e.error;return{...n,error:c,errorUpdateCount:n.errorUpdateCount+1,errorUpdatedAt:Date.now(),fetchFailureCount:n.fetchFailureCount+1,fetchFailureReason:c,fetchStatus:"idle",status:"error"};case"invalidate":return{...n,isInvalidated:!0};case"setState":return{...n,...e.state}}};this.state=r(this.state),Ps.batch(()=>{this.observers.forEach(n=>{n.onQueryUpdate()}),rt(this,Go).notify({query:this,type:"updated",action:e})})},R3);function Lre(t,e){return{fetchFailureCount:0,fetchFailureReason:null,fetchStatus:yF(e.networkMode)?"fetching":"paused",...t===void 0&&{error:null,status:"pending"}}}function WD(t){const e=typeof t.initialData=="function"?t.initialData():t.initialData,r=e!==void 0,n=r?typeof t.initialDataUpdatedAt=="function"?t.initialDataUpdatedAt():t.initialDataUpdatedAt:0;return{data:e,dataUpdateCount:0,dataUpdatedAt:r?n??Date.now():0,error:null,errorUpdateCount:0,errorUpdatedAt:0,fetchFailureCount:0,fetchFailureReason:null,fetchMeta:null,isInvalidated:!1,status:r?"success":"pending",fetchStatus:"idle"}}function qD(t){return{onFetch:(e,r)=>{var v,T,P,A,O;const n=e.options,s=(P=(T=(v=e.fetchOptions)==null?void 0:v.meta)==null?void 0:T.fetchMore)==null?void 0:P.direction,c=((A=e.state.data)==null?void 0:A.pages)||[],l=((O=e.state.data)==null?void 0:O.pageParams)||[];let a={pages:[],pageParams:[]},m=0;const y=async()=>{let I=!1;const L=j=>{Object.defineProperty(j,"signal",{enumerable:!0,get:()=>(e.signal.aborted?I=!0:e.signal.addEventListener("abort",()=>{I=!0}),e.signal)})},R=mF(e.options,e.fetchOptions),z=async(j,W,Z)=>{if(I)return Promise.reject();if(W==null&&j.pages.length)return Promise.resolve(j);const ie=(()=>{const ce={client:e.client,queryKey:e.queryKey,pageParam:W,direction:Z?"backward":"forward",meta:e.options.meta};return L(ce),ce})(),V=await R(ie),{maxPages:q}=e.options,Q=Z?Cre:Ere;return{pages:Q(j.pages,V,q),pageParams:Q(j.pageParams,W,q)}};if(s&&c.length){const j=s==="backward",W=j?Ore:HD,Z={pages:c,pageParams:l},te=W(n,Z);a=await z(Z,te,j)}else{const j=t??c.length;do{const W=m===0?l[0]??n.initialPageParam:HD(n,a);if(m>0&&W==null)break;a=await z(a,W),m++}while(m<j)}return a};e.options.persister?e.fetchFn=()=>{var I,L;return(L=(I=e.options).persister)==null?void 0:L.call(I,y,{client:e.client,queryKey:e.queryKey,meta:e.options.meta,signal:e.signal},r)}:e.fetchFn=y}}}function HD(t,{pages:e,pageParams:r}){const n=e.length-1;return e.length>0?t.getNextPageParam(e[n],e,r[n],r):void 0}function Ore(t,{pages:e,pageParams:r}){var n;return e.length>0?(n=t.getPreviousPageParam)==null?void 0:n.call(t,e[0],e,r[0],r):void 0}var D0,el,Es,ld,tl,Yc,D3,zre=(D3=class extends vF{constructor(e){super();Er(this,tl);Er(this,D0);Er(this,el);Er(this,Es);Er(this,ld);Jt(this,D0,e.client),this.mutationId=e.mutationId,Jt(this,Es,e.mutationCache),Jt(this,el,[]),this.state=e.state||Nre(),this.setOptions(e.options),this.scheduleGc()}setOptions(e){this.options=e,this.updateGcTime(this.options.gcTime)}get meta(){return this.options.meta}addObserver(e){rt(this,el).includes(e)||(rt(this,el).push(e),this.clearGcTimeout(),rt(this,Es).notify({type:"observerAdded",mutation:this,observer:e}))}removeObserver(e){Jt(this,el,rt(this,el).filter(r=>r!==e)),this.scheduleGc(),rt(this,Es).notify({type:"observerRemoved",mutation:this,observer:e})}optionalRemove(){rt(this,el).length||(this.state.status==="pending"?this.scheduleGc():rt(this,Es).remove(this))}continue(){var e;return((e=rt(this,ld))==null?void 0:e.continue())??this.execute(this.state.variables)}async execute(e){var l,a,m,y,v,T,P,A,O,I,L,R,z,j,W,Z,te,ie,V,q;const r=()=>{os(this,tl,Yc).call(this,{type:"continue"})},n={client:rt(this,D0),meta:this.options.meta,mutationKey:this.options.mutationKey};Jt(this,ld,_F({fn:()=>this.options.mutationFn?this.options.mutationFn(e,n):Promise.reject(new Error("No mutationFn found")),onFail:(Q,ce)=>{os(this,tl,Yc).call(this,{type:"failed",failureCount:Q,error:ce})},onPause:()=>{os(this,tl,Yc).call(this,{type:"pause"})},onContinue:r,retry:this.options.retry??0,retryDelay:this.options.retryDelay,networkMode:this.options.networkMode,canRun:()=>rt(this,Es).canRun(this)}));const s=this.state.status==="pending",c=!rt(this,ld).canStart();try{if(s)r();else{os(this,tl,Yc).call(this,{type:"pending",variables:e,isPaused:c}),await((a=(l=rt(this,Es).config).onMutate)==null?void 0:a.call(l,e,this,n));const ce=await((y=(m=this.options).onMutate)==null?void 0:y.call(m,e,n));ce!==this.state.context&&os(this,tl,Yc).call(this,{type:"pending",context:ce,variables:e,isPaused:c})}const Q=await rt(this,ld).start();return await((T=(v=rt(this,Es).config).onSuccess)==null?void 0:T.call(v,Q,e,this.state.context,this,n)),await((A=(P=this.options).onSuccess)==null?void 0:A.call(P,Q,e,this.state.context,n)),await((I=(O=rt(this,Es).config).onSettled)==null?void 0:I.call(O,Q,null,this.state.variables,this.state.context,this,n)),await((R=(L=this.options).onSettled)==null?void 0:R.call(L,Q,null,e,this.state.context,n)),os(this,tl,Yc).call(this,{type:"success",data:Q}),Q}catch(Q){try{throw await((j=(z=rt(this,Es).config).onError)==null?void 0:j.call(z,Q,e,this.state.context,this,n)),await((Z=(W=this.options).onError)==null?void 0:Z.call(W,Q,e,this.state.context,n)),await((ie=(te=rt(this,Es).config).onSettled)==null?void 0:ie.call(te,void 0,Q,this.state.variables,this.state.context,this,n)),await((q=(V=this.options).onSettled)==null?void 0:q.call(V,void 0,Q,e,this.state.context,n)),Q}finally{os(this,tl,Yc).call(this,{type:"error",error:Q})}}finally{rt(this,Es).runNext(this)}}},D0=new WeakMap,el=new WeakMap,Es=new WeakMap,ld=new WeakMap,tl=new WeakSet,Yc=function(e){const r=n=>{switch(e.type){case"failed":return{...n,failureCount:e.failureCount,failureReason:e.error};case"pause":return{...n,isPaused:!0};case"continue":return{...n,isPaused:!1};case"pending":return{...n,context:e.context,data:void 0,failureCount:0,failureReason:null,error:null,isPaused:e.isPaused,status:"pending",variables:e.variables,submittedAt:Date.now()};case"success":return{...n,data:e.data,failureCount:0,failureReason:null,error:null,status:"success",isPaused:!1};case"error":return{...n,data:void 0,error:e.error,failureCount:n.failureCount+1,failureReason:e.error,isPaused:!1,status:"error"}}};this.state=r(this.state),Ps.batch(()=>{rt(this,el).forEach(n=>{n.onMutationUpdate(e)}),rt(this,Es).notify({mutation:this,type:"updated",action:e})})},D3);function Nre(){return{context:void 0,data:void 0,error:null,failureCount:0,failureReason:null,isPaused:!1,status:"idle",variables:void 0,submittedAt:0}}var Zl,va,L0,L3,jre=(L3=class extends w1{constructor(e={}){super();Er(this,Zl);Er(this,va);Er(this,L0);this.config=e,Jt(this,Zl,new Set),Jt(this,va,new Map),Jt(this,L0,0)}build(e,r,n){const s=new zre({client:e,mutationCache:this,mutationId:++gv(this,L0)._,options:e.defaultMutationOptions(r),state:n});return this.add(s),s}add(e){rt(this,Zl).add(e);const r=Kv(e);if(typeof r=="string"){const n=rt(this,va).get(r);n?n.push(e):rt(this,va).set(r,[e])}this.notify({type:"added",mutation:e})}remove(e){if(rt(this,Zl).delete(e)){const r=Kv(e);if(typeof r=="string"){const n=rt(this,va).get(r);if(n)if(n.length>1){const s=n.indexOf(e);s!==-1&&n.splice(s,1)}else n[0]===e&&rt(this,va).delete(r)}}this.notify({type:"removed",mutation:e})}canRun(e){const r=Kv(e);if(typeof r=="string"){const n=rt(this,va).get(r),s=n==null?void 0:n.find(c=>c.state.status==="pending");return!s||s===e}else return!0}runNext(e){var n;const r=Kv(e);if(typeof r=="string"){const s=(n=rt(this,va).get(r))==null?void 0:n.find(c=>c!==e&&c.state.isPaused);return(s==null?void 0:s.continue())??Promise.resolve()}else return Promise.resolve()}clear(){Ps.batch(()=>{rt(this,Zl).forEach(e=>{this.notify({type:"removed",mutation:e})}),rt(this,Zl).clear(),rt(this,va).clear()})}getAll(){return Array.from(rt(this,Zl))}find(e){const r={exact:!0,...e};return this.getAll().find(n=>VD(r,n))}findAll(e={}){return this.getAll().filter(r=>VD(e,r))}notify(e){Ps.batch(()=>{this.listeners.forEach(r=>{r(e)})})}resumePausedMutations(){const e=this.getAll().filter(r=>r.state.isPaused);return Ps.batch(()=>Promise.all(e.map(r=>r.continue().catch(ya))))}},Zl=new WeakMap,va=new WeakMap,L0=new WeakMap,L3);function Kv(t){var e;return(e=t.options.scope)==null?void 0:e.id}var rl,O3,Fre=(O3=class extends w1{constructor(e={}){super();Er(this,rl);this.config=e,Jt(this,rl,new Map)}build(e,r,n){const s=r.queryKey,c=r.queryHash??XP(s,r);let l=this.get(c);return l||(l=new Dre({client:e,queryKey:s,queryHash:c,options:e.defaultQueryOptions(r),state:n,defaultOptions:e.getQueryDefaults(s)}),this.add(l)),l}add(e){rt(this,rl).has(e.queryHash)||(rt(this,rl).set(e.queryHash,e),this.notify({type:"added",query:e}))}remove(e){const r=rt(this,rl).get(e.queryHash);r&&(e.destroy(),r===e&&rt(this,rl).delete(e.queryHash),this.notify({type:"removed",query:e}))}clear(){Ps.batch(()=>{this.getAll().forEach(e=>{this.remove(e)})})}get(e){return rt(this,rl).get(e)}getAll(){return[...rt(this,rl).values()]}find(e){const r={exact:!0,...e};return this.getAll().find(n=>$D(r,n))}findAll(e={}){const r=this.getAll();return Object.keys(e).length>0?r.filter(n=>$D(e,n)):r}notify(e){Ps.batch(()=>{this.listeners.forEach(r=>{r(e)})})}onFocus(){Ps.batch(()=>{this.getAll().forEach(e=>{e.onFocus()})})}onOnline(){Ps.batch(()=>{this.getAll().forEach(e=>{e.onOnline()})})}},rl=new WeakMap,O3),Fn,ou,au,Up,Gp,lu,Wp,qp,z3,Bre=(z3=class{constructor(t={}){Er(this,Fn);Er(this,ou);Er(this,au);Er(this,Up);Er(this,Gp);Er(this,lu);Er(this,Wp);Er(this,qp);Jt(this,Fn,t.queryCache||new Fre),Jt(this,ou,t.mutationCache||new jre),Jt(this,au,t.defaultOptions||{}),Jt(this,Up,new Map),Jt(this,Gp,new Map),Jt(this,lu,0)}mount(){gv(this,lu)._++,rt(this,lu)===1&&(Jt(this,Wp,gF.subscribe(async t=>{t&&(await this.resumePausedMutations(),rt(this,Fn).onFocus())})),Jt(this,qp,xb.subscribe(async t=>{t&&(await this.resumePausedMutations(),rt(this,Fn).onOnline())})))}unmount(){var t,e;gv(this,lu)._--,rt(this,lu)===0&&((t=rt(this,Wp))==null||t.call(this),Jt(this,Wp,void 0),(e=rt(this,qp))==null||e.call(this),Jt(this,qp,void 0))}isFetching(t){return rt(this,Fn).findAll({...t,fetchStatus:"fetching"}).length}isMutating(t){return rt(this,ou).findAll({...t,status:"pending"}).length}getQueryData(t){var r;const e=this.defaultQueryOptions({queryKey:t});return(r=rt(this,Fn).get(e.queryHash))==null?void 0:r.state.data}ensureQueryData(t){const e=this.defaultQueryOptions(t),r=rt(this,Fn).build(this,e),n=r.state.data;return n===void 0?this.fetchQuery(t):(t.revalidateIfStale&&r.isStaleByTime(fE(e.staleTime,r))&&this.prefetchQuery(e),Promise.resolve(n))}getQueriesData(t){return rt(this,Fn).findAll(t).map(({queryKey:e,state:r})=>{const n=r.data;return[e,n]})}setQueryData(t,e,r){const n=this.defaultQueryOptions({queryKey:t}),s=rt(this,Fn).get(n.queryHash),c=s==null?void 0:s.state.data,l=_re(e,c);if(l!==void 0)return rt(this,Fn).build(this,n).setData(l,{...r,manual:!0})}setQueriesData(t,e,r){return Ps.batch(()=>rt(this,Fn).findAll(t).map(({queryKey:n})=>[n,this.setQueryData(n,e,r)]))}getQueryState(t){var r;const e=this.defaultQueryOptions({queryKey:t});return(r=rt(this,Fn).get(e.queryHash))==null?void 0:r.state}removeQueries(t){const e=rt(this,Fn);Ps.batch(()=>{e.findAll(t).forEach(r=>{e.remove(r)})})}resetQueries(t,e){const r=rt(this,Fn);return Ps.batch(()=>(r.findAll(t).forEach(n=>{n.reset()}),this.refetchQueries({type:"active",...t},e)))}cancelQueries(t,e={}){const r={revert:!0,...e},n=Ps.batch(()=>rt(this,Fn).findAll(t).map(s=>s.cancel(r)));return Promise.all(n).then(ya).catch(ya)}invalidateQueries(t,e={}){return Ps.batch(()=>(rt(this,Fn).findAll(t).forEach(r=>{r.invalidate()}),(t==null?void 0:t.refetchType)==="none"?Promise.resolve():this.refetchQueries({...t,type:(t==null?void 0:t.refetchType)??(t==null?void 0:t.type)??"active"},e)))}refetchQueries(t,e={}){const r={...e,cancelRefetch:e.cancelRefetch??!0},n=Ps.batch(()=>rt(this,Fn).findAll(t).filter(s=>!s.isDisabled()&&!s.isStatic()).map(s=>{let c=s.fetch(void 0,r);return r.throwOnError||(c=c.catch(ya)),s.state.fetchStatus==="paused"?Promise.resolve():c}));return Promise.all(n).then(ya)}fetchQuery(t){const e=this.defaultQueryOptions(t);e.retry===void 0&&(e.retry=!1);const r=rt(this,Fn).build(this,e);return r.isStaleByTime(fE(e.staleTime,r))?r.fetch(e):Promise.resolve(r.state.data)}prefetchQuery(t){return this.fetchQuery(t).then(ya).catch(ya)}fetchInfiniteQuery(t){return t.behavior=qD(t.pages),this.fetchQuery(t)}prefetchInfiniteQuery(t){return this.fetchInfiniteQuery(t).then(ya).catch(ya)}ensureInfiniteQueryData(t){return t.behavior=qD(t.pages),this.ensureQueryData(t)}resumePausedMutations(){return xb.isOnline()?rt(this,ou).resumePausedMutations():Promise.resolve()}getQueryCache(){return rt(this,Fn)}getMutationCache(){return rt(this,ou)}getDefaultOptions(){return rt(this,au)}setDefaultOptions(t){Jt(this,au,t)}setQueryDefaults(t,e){rt(this,Up).set(g0(t),{queryKey:t,defaultOptions:e})}getQueryDefaults(t){const e=[...rt(this,Up).values()],r={};return e.forEach(n=>{y0(t,n.queryKey)&&Object.assign(r,n.defaultOptions)}),r}setMutationDefaults(t,e){rt(this,Gp).set(g0(t),{mutationKey:t,defaultOptions:e})}getMutationDefaults(t){const e=[...rt(this,Gp).values()],r={};return e.forEach(n=>{y0(t,n.mutationKey)&&Object.assign(r,n.defaultOptions)}),r}defaultQueryOptions(t){if(t._defaulted)return t;const e={...rt(this,au).queries,...this.getQueryDefaults(t.queryKey),...t,_defaulted:!0};return e.queryHash||(e.queryHash=XP(e.queryKey,e)),e.refetchOnReconnect===void 0&&(e.refetchOnReconnect=e.networkMode!=="always"),e.throwOnError===void 0&&(e.throwOnError=!!e.suspense),!e.networkMode&&e.persister&&(e.networkMode="offlineFirst"),e.queryFn===YP&&(e.enabled=!1),e}defaultMutationOptions(t){return t!=null&&t._defaulted?t:{...rt(this,au).mutations,...(t==null?void 0:t.mutationKey)&&this.getMutationDefaults(t.mutationKey),...t,_defaulted:!0}}clear(){rt(this,Fn).clear(),rt(this,ou).clear()}},Fn=new WeakMap,ou=new WeakMap,au=new WeakMap,Up=new WeakMap,Gp=new WeakMap,lu=new WeakMap,Wp=new WeakMap,qp=new WeakMap,z3),$re=X.createContext(void 0),Vre=({client:t,children:e})=>(X.useEffect(()=>(t.mount(),()=>{t.unmount()}),[t]),B.jsx($re.Provider,{value:t,children:e}));function Ure(){const t={hidden:{opacity:0,y:20},visible:{opacity:1,y:0,transition:{duration:.6}}};return B.jsxs("div",{className:"min-h-screen pt-20 bg-[#1f2022]",children:[B.jsxs("section",{className:"relative py-20 overflow-hidden",children:[B.jsxs("div",{className:"absolute inset-0 opacity-10 z-0",children:[B.jsx("div",{className:"absolute inset-0 bg-gradient-to-b from-neurocrop-green/20 to-background/5 z-10"}),B.jsx("img",{src:"https://i.pinimg.com/originals/15/09/96/150996d5036e9230edc3fc48decaecd4.jpg",alt:"Security camera overlooking a school hallway",className:"w-full h-full object-cover"})]}),B.jsx("div",{className:"neurocrop-container relative z-10",children:B.jsxs(nr.div,{className:"max-w-3xl mx-auto text-center",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.8},children:[B.jsxs("h1",{className:"text-4xl md:text-5xl font-bold text-blue-200 tracking-tight mb-6",children:["Safer Schools with ",B.jsx("span",{className:"text-blue-500",children:"AI Vision"})," and Audio Detection"]}),B.jsx("p",{className:"text-xl text-muted-foreground text-blue-100",children:"We integrate AI-powered vision and audio detection into existing security cameras to identify threats like weapons, aggressive actions, and gunshots in real timehelping staff respond faster and keep students and educators safe."})]})})]}),B.jsx("section",{className:"py-20",children:B.jsxs("div",{className:"neurocrop-container",children:[B.jsxs(nr.div,{className:"text-center mb-16",variants:t,initial:"hidden",whileInView:"visible",viewport:{once:!0},children:[B.jsx("h2",{className:"text-3xl font-bold tracking-tight mb-4 text-blue-200",children:"Who We Are"}),B.jsx("p",{className:"text-lg text-muted-foreground max-w-2xl mx-auto text-blue-100",children:"We are computer vision engineers, ML researchers, and campus safety advocates building privacy-first detection that runs at the edge, minimizes false alarms, and alerts the right people in seconds."})]}),B.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-8",children:[B.jsx("div",{className:"flex justify-center",children:B.jsx("div",{className:"aspect-square w-full max-w-[300px] bg-muted rounded-2xl animate-pulse-gentle",children:B.jsx("img",{src:"/placeholder.svg",alt:"Team member",className:"w-full h-full object-cover rounded-2xl"})})}),B.jsx("div",{className:"flex justify-center",children:B.jsx("div",{className:"aspect-square w-full max-w-[300px] bg-muted rounded-2xl animate-pulse-gentle",children:B.jsx("img",{src:"/placeholder.svg",alt:"Team member",className:"w-full h-full object-cover rounded-2xl"})})}),B.jsx("div",{className:"flex justify-center",children:B.jsx("div",{className:"aspect-square w-full max-w-[300px] bg-muted rounded-2xl animate-pulse-gentle",children:B.jsx("img",{src:"/placeholder.svg",alt:"Team member",className:"w-full h-full object-cover rounded-2xl"})})}),B.jsx("div",{className:"flex justify-center",children:B.jsx("div",{className:"aspect-square w-full max-w-[300px] bg-muted rounded-2xl animate-pulse-gentle",children:B.jsx("img",{src:"/placeholder.svg",alt:"Team member",className:"w-full h-full object-cover rounded-2xl"})})})]})]})})]})}const Dy=X.forwardRef(({className:t,...e},r)=>B.jsx("div",{ref:r,className:Lr("rounded-lg border bg-card text-card-foreground shadow-sm",t),...e}));Dy.displayName="Card";const Gre=X.forwardRef(({className:t,...e},r)=>B.jsx("div",{ref:r,className:Lr("flex flex-col space-y-1.5 p-6",t),...e}));Gre.displayName="CardHeader";const Wre=X.forwardRef(({className:t,...e},r)=>B.jsx("h3",{ref:r,className:Lr("text-2xl font-semibold leading-none tracking-tight",t),...e}));Wre.displayName="CardTitle";const qre=X.forwardRef(({className:t,...e},r)=>B.jsx("p",{ref:r,className:Lr("text-sm text-muted-foreground",t),...e}));qre.displayName="CardDescription";const xF=X.forwardRef(({className:t,...e},r)=>B.jsx("div",{ref:r,className:Lr("p-6 pt-0",t),...e}));xF.displayName="CardContent";const Hre=X.forwardRef(({className:t,...e},r)=>B.jsx("div",{ref:r,className:Lr("flex items-center p-6 pt-0",t),...e}));Hre.displayName="CardFooter";var Zre=X.createContext(void 0);function bF(t){const e=X.useContext(Zre);return t||e||"ltr"}var rS="rovingFocusGroup.onEntryFocus",Kre={bubbles:!1,cancelable:!0},Y0="RovingFocusGroup",[gE,wF,Xre]=fj(Y0),[Yre,SF]=Dd(Y0,[Xre]),[Qre,Jre]=Yre(Y0),TF=X.forwardRef((t,e)=>B.jsx(gE.Provider,{scope:t.__scopeRovingFocusGroup,children:B.jsx(gE.Slot,{scope:t.__scopeRovingFocusGroup,children:B.jsx(ene,{...t,ref:e})})}));TF.displayName=Y0;var ene=X.forwardRef((t,e)=>{const{__scopeRovingFocusGroup:r,orientation:n,loop:s=!1,dir:c,currentTabStopId:l,defaultCurrentTabStopId:a,onCurrentTabStopIdChange:m,onEntryFocus:y,preventScrollOnEntryFocus:v=!1,...T}=t,P=X.useRef(null),A=ms(e,P),O=bF(c),[I,L]=u1({prop:l,defaultProp:a??null,onChange:m,caller:Y0}),[R,z]=X.useState(!1),j=ka(y),W=wF(r),Z=X.useRef(!1),[te,ie]=X.useState(0);return X.useEffect(()=>{const V=P.current;if(V)return V.addEventListener(rS,j),()=>V.removeEventListener(rS,j)},[j]),B.jsx(Qre,{scope:r,orientation:n,dir:O,loop:s,currentTabStopId:I,onItemFocus:X.useCallback(V=>L(V),[L]),onItemShiftTab:X.useCallback(()=>z(!0),[]),onFocusableItemAdd:X.useCallback(()=>ie(V=>V+1),[]),onFocusableItemRemove:X.useCallback(()=>ie(V=>V-1),[]),children:B.jsx(tn.div,{tabIndex:R||te===0?-1:0,"data-orientation":n,...T,ref:A,style:{outline:"none",...t.style},onMouseDown:Rr(t.onMouseDown,()=>{Z.current=!0}),onFocus:Rr(t.onFocus,V=>{const q=!Z.current;if(V.target===V.currentTarget&&q&&!R){const Q=new CustomEvent(rS,Kre);if(V.currentTarget.dispatchEvent(Q),!Q.defaultPrevented){const ce=W().filter(xe=>xe.focusable),se=ce.find(xe=>xe.active),ue=ce.find(xe=>xe.id===I),ye=[se,ue,...ce].filter(Boolean).map(xe=>xe.ref.current);PF(ye,v)}}Z.current=!1}),onBlur:Rr(t.onBlur,()=>z(!1))})})}),EF="RovingFocusGroupItem",CF=X.forwardRef((t,e)=>{const{__scopeRovingFocusGroup:r,focusable:n=!0,active:s=!1,tabStopId:c,children:l,...a}=t,m=Iy(),y=c||m,v=Jre(EF,r),T=v.currentTabStopId===y,P=wF(r),{onFocusableItemAdd:A,onFocusableItemRemove:O,currentTabStopId:I}=v;return X.useEffect(()=>{if(n)return A(),()=>O()},[n,A,O]),B.jsx(gE.ItemSlot,{scope:r,id:y,focusable:n,active:s,children:B.jsx(tn.span,{tabIndex:T?0:-1,"data-orientation":v.orientation,...a,ref:e,onMouseDown:Rr(t.onMouseDown,L=>{n?v.onItemFocus(y):L.preventDefault()}),onFocus:Rr(t.onFocus,()=>v.onItemFocus(y)),onKeyDown:Rr(t.onKeyDown,L=>{if(L.key==="Tab"&&L.shiftKey){v.onItemShiftTab();return}if(L.target!==L.currentTarget)return;const R=nne(L,v.orientation,v.dir);if(R!==void 0){if(L.metaKey||L.ctrlKey||L.altKey||L.shiftKey)return;L.preventDefault();let j=P().filter(W=>W.focusable).map(W=>W.ref.current);if(R==="last")j.reverse();else if(R==="prev"||R==="next"){R==="prev"&&j.reverse();const W=j.indexOf(L.currentTarget);j=v.loop?ine(j,W+1):j.slice(W+1)}setTimeout(()=>PF(j))}}),children:typeof l=="function"?l({isCurrentTabStop:T,hasTabStop:I!=null}):l})})});CF.displayName=EF;var tne={ArrowLeft:"prev",ArrowUp:"prev",ArrowRight:"next",ArrowDown:"next",PageUp:"first",Home:"first",PageDown:"last",End:"last"};function rne(t,e){return e!=="rtl"?t:t==="ArrowLeft"?"ArrowRight":t==="ArrowRight"?"ArrowLeft":t}function nne(t,e,r){const n=rne(t.key,r);if(!(e==="vertical"&&["ArrowLeft","ArrowRight"].includes(n))&&!(e==="horizontal"&&["ArrowUp","ArrowDown"].includes(n)))return tne[n]}function PF(t,e=!1){const r=document.activeElement;for(const n of t)if(n===r||(n.focus({preventScroll:e}),document.activeElement!==r))return}function ine(t,e){return t.map((r,n)=>t[(e+n)%t.length])}var sne=TF,one=CF,T1="Tabs",[ane]=Dd(T1,[SF]),AF=SF(),[lne,QP]=ane(T1),kF=X.forwardRef((t,e)=>{const{__scopeTabs:r,value:n,onValueChange:s,defaultValue:c,orientation:l="horizontal",dir:a,activationMode:m="automatic",...y}=t,v=bF(a),[T,P]=u1({prop:n,onChange:s,defaultProp:c??"",caller:T1});return B.jsx(lne,{scope:r,baseId:Iy(),value:T,onValueChange:P,orientation:l,dir:v,activationMode:m,children:B.jsx(tn.div,{dir:v,"data-orientation":l,...y,ref:e})})});kF.displayName=T1;var MF="TabsList",IF=X.forwardRef((t,e)=>{const{__scopeTabs:r,loop:n=!0,...s}=t,c=QP(MF,r),l=AF(r);return B.jsx(sne,{asChild:!0,...l,orientation:c.orientation,dir:c.dir,loop:n,children:B.jsx(tn.div,{role:"tablist","aria-orientation":c.orientation,...s,ref:e})})});IF.displayName=MF;var RF="TabsTrigger",DF=X.forwardRef((t,e)=>{const{__scopeTabs:r,value:n,disabled:s=!1,...c}=t,l=QP(RF,r),a=AF(r),m=zF(l.baseId,n),y=NF(l.baseId,n),v=n===l.value;return B.jsx(one,{asChild:!0,...a,focusable:!s,active:v,children:B.jsx(tn.button,{type:"button",role:"tab","aria-selected":v,"aria-controls":y,"data-state":v?"active":"inactive","data-disabled":s?"":void 0,disabled:s,id:m,...c,ref:e,onMouseDown:Rr(t.onMouseDown,T=>{!s&&T.button===0&&T.ctrlKey===!1?l.onValueChange(n):T.preventDefault()}),onKeyDown:Rr(t.onKeyDown,T=>{[" ","Enter"].includes(T.key)&&l.onValueChange(n)}),onFocus:Rr(t.onFocus,()=>{const T=l.activationMode!=="manual";!v&&!s&&T&&l.onValueChange(n)})})})});DF.displayName=RF;var LF="TabsContent",OF=X.forwardRef((t,e)=>{const{__scopeTabs:r,value:n,forceMount:s,children:c,...l}=t,a=QP(LF,r),m=zF(a.baseId,n),y=NF(a.baseId,n),v=n===a.value,T=X.useRef(v);return X.useEffect(()=>{const P=requestAnimationFrame(()=>T.current=!1);return()=>cancelAnimationFrame(P)},[]),B.jsx(Ld,{present:s||v,children:({present:P})=>B.jsx(tn.div,{"data-state":v?"active":"inactive","data-orientation":a.orientation,role:"tabpanel","aria-labelledby":m,hidden:!P,id:y,tabIndex:0,...l,ref:e,style:{...t.style,animationDuration:T.current?"0s":void 0},children:P&&c})})});OF.displayName=LF;function zF(t,e){return`${t}-trigger-${e}`}function NF(t,e){return`${t}-content-${e}`}var cne=kF,jF=IF,FF=DF,BF=OF;const une=cne,$F=X.forwardRef(({className:t,...e},r)=>B.jsx(jF,{ref:r,className:Lr("inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground",t),...e}));$F.displayName=jF.displayName;const yE=X.forwardRef(({className:t,...e},r)=>B.jsx(FF,{ref:r,className:Lr("inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm",t),...e}));yE.displayName=FF.displayName;const _E=X.forwardRef(({className:t,...e},r)=>B.jsx(BF,{ref:r,className:Lr("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",t),...e}));_E.displayName=BF.displayName;function hne(){const{user:t,signOut:e,loading:r}=c1(),{toast:n}=dj(),[s,c]=X.useState("feed"),[l,a]=X.useState([]),[m,y]=X.useState([]),v=X.useRef(null),T=X.useRef(null),[P,A]=X.useState(!1),[O,I]=X.useState("live"),[L,R]=X.useState(null),[z,j]=X.useState(!1),[W,Z]=X.useState(null),te=X.useRef(null),ie=X.useRef(null),V=X.useRef(null),q=Qh(te,{once:!0,amount:.3}),Q=Qh(ie,{once:!0,amount:.2});Qh(V,{once:!0,amount:.2});const ce={hidden:{opacity:0,y:30},visible:{opacity:1,y:0,transition:{duration:.6}}},se={hidden:{opacity:0},visible:{opacity:1,transition:{staggerChildren:.15,delayChildren:.1}}},ue={hidden:{opacity:0,y:20,scale:.95},visible:{opacity:1,y:0,scale:1,transition:{duration:.5}}},he=async()=>{if(!(P||T.current)){A(!0);try{const Re=await navigator.mediaDevices.getUserMedia({video:{width:{ideal:1280},height:{ideal:720}},audio:!1});T.current=Re,v.current&&(v.current.srcObject=Re,v.current.onloadedmetadata=()=>{var $e;($e=v.current)==null||$e.play().catch(()=>{console.log("Autoplay prevented, user interaction required")})}),n({title:"Camera started",description:"Live feed is now active"})}catch(Re){console.error("Camera error:",Re),n({title:"Camera error",description:(Re==null?void 0:Re.message)||"Unable to access camera. Please check permissions.",variant:"destructive"})}finally{A(!1)}}},ye=()=>{T.current&&(T.current.getTracks().forEach(Re=>{Re.stop(),console.log("Stopped track:",Re.kind)}),T.current=null),v.current&&(v.current.srcObject=null,v.current.pause()),n({title:"Camera stopped",description:"Live feed has been disabled"})};X.useEffect(()=>(s==="live"?he():ye(),()=>{ye()}),[s]);const xe=Re=>{console.log("Received AI model event:",Re);const $e=st=>{if(!st||st.length===0)return"Unknown threat detected";const at=[...new Set(st.map(_t=>_t.type))];return at.includes("weapon")?"Weapon detected":at.includes("gunshot")?"Gunshot detected":at.includes("violence")?"Violence detected":at.includes("suspicious_behavior")?"Suspicious behavior detected":at.includes("unauthorized_access")?"Unauthorized access detected":at.includes("threat")?"Threat detected":"Security threat detected"},Xe={id:Re.event_id,camera:`Camera ${Re.camera_id}`,detected:$e(Re.detections),timestamp:new Date(Re.event_start).toLocaleString(),status:"live",event_id:Re.event_id,camera_id:Re.camera_id,event_start:Re.event_start,event_end:Re.event_end,combined_score:Re.combined_score,scores:Re.scores,detections:Re.detections,severity:Re.severity};a(st=>[Xe,...st]),Re.severity==="high"?(R(Xe),j(!0),n({title:" HIGH SEVERITY ALERT",description:`Weapon detected on ${Xe.camera} - Immediate action required!`,variant:"destructive"})):n({title:`Security Alert (${Re.severity.toUpperCase()})`,description:`${Xe.detected}  ${Xe.camera}`,variant:"default"})},Se=()=>{console.log("Simulate AI Event button clicked!");const Re=[{type:"weapon",description:"Weapon detected"},{type:"gunshot",description:"Gunshot detected"},{type:"suspicious_behavior",description:"Suspicious behavior detected"},{type:"unauthorized_access",description:"Unauthorized access detected"},{type:"violence",description:"Violence detected"},{type:"threat",description:"Threat detected"}],$e=["low","medium","high"],Xe=$e[Math.floor(Math.random()*$e.length)],st=Re[Math.floor(Math.random()*Re.length)];let at=0;Xe==="high"?at=75+Math.random()*25:Xe==="medium"?at=50+Math.random()*25:at=25+Math.random()*25;const _t=Math.max(0,Math.min(100,at+(Math.random()-.5)*20)),Ct=Math.max(0,Math.min(100,at+(Math.random()-.5)*20)),Pt=(_t+Ct)/2,Ht=Array.from({length:Math.floor(Math.random()*3)+1},(yr,$t)=>({type:st.type,confidence:Math.max(0,Math.min(100,at+(Math.random()-.5)*15)),bbox:[Math.floor(Math.random()*400)+50,Math.floor(Math.random()*300)+50,Math.floor(Math.random()*200)+100,Math.floor(Math.random()*150)+100],timestamp:new Date(Date.now()-Math.random()*5e3).toISOString(),frame_id:Math.floor(Math.random()*1e3)+$t})),ir={event_id:`evt_${Math.random().toString(36).substr(2,12)}`,camera_id:`cam_${Math.floor(Math.random()*6)+1}`,event_start:new Date().toISOString(),event_end:new Date(Date.now()+Math.random()*1e4+2e3).toISOString(),combined_score:Math.round(Pt*10)/10,scores:{video:Math.round(_t*10)/10,audio:Math.round(Ct*10)/10},detections:Ht,severity:Xe};console.log("Generated AI Event:",ir),xe(ir)},fe=Re=>{const $e=l.find(Xe=>Xe.id===Re);$e&&(n({title:"Calling principal"}),setTimeout(()=>n({title:"Calling police station"}),500),a(Xe=>Xe.filter(st=>st.id!==Re)),y(Xe=>[{...$e,status:"accepted"},...Xe]))},ve=Re=>{const $e=l.find(Xe=>Xe.id===Re);$e&&(a(Xe=>Xe.filter(st=>st.id!==Re)),y(Xe=>[{...$e,status:"rejected"},...Xe]))};return r||!t?B.jsx("div",{className:"min-h-screen flex items-center justify-center pt-16",children:B.jsx(BR,{className:"w-8 h-8 animate-spin text-primary"})}):B.jsxs("main",{className:"bg-black text-white min-h-screen",children:[B.jsx("section",{className:"bg-gradient-to-b from-[#1f2022] to-[#171819] py-16 md:py-24 overflow-hidden",children:B.jsxs("div",{className:"mx-auto max-w-8xl px-8",children:[B.jsxs(nr.div,{ref:te,initial:"hidden",animate:q?"visible":"hidden",variants:ce,className:"flex items-center justify-between mb-12",children:[B.jsxs("div",{className:"text-left",children:[B.jsxs("div",{className:"inline-flex items-center gap-2 rounded-full border border-blue-500/20 bg-blue-500/10 px-4 py-1.5 mb-6",children:[B.jsx(VT,{className:"h-4 w-4 text-blue-400"}),B.jsx("span",{className:"text-sm font-medium text-blue-300",children:"Security Dashboard"})]}),B.jsx("h1",{className:"text-3xl md:text-5xl font-bold tracking-tight mb-4 bg-gradient-to-r from-white to-zinc-400 bg-clip-text text-transparent",children:"Monitor & Respond"}),B.jsx("p",{className:"text-lg md:text-xl text-zinc-300 max-w-3xl leading-relaxed mb-[-20px]",children:"Real-time security monitoring with AI-powered threat detection and instant escalation."})]}),B.jsx("div",{className:"flex items-center gap-4",children:B.jsx(Qi,{onClick:e,variant:"outline",className:"rounded-full border border-white/20 px-6 py-2 text-base font-medium hover:bg-white/10 focus:outline-none focus:ring-2 focus:ring-white/40 transition-all",children:"Sign Out"})})]}),B.jsxs(nr.div,{ref:ie,initial:"hidden",animate:Q?"visible":"hidden",variants:se,className:"grid grid-cols-1 lg:grid-cols-[minmax(14rem,18rem)_1fr_minmax(20rem,26rem)] gap-8 lg:gap-12 items-start",children:[B.jsx(nr.aside,{variants:ue,className:"w-full",children:B.jsxs(Dy,{className:"group relative rounded-2xl border border-white/10 bg-zinc-900/40 p-6 backdrop-blur hover:border-blue-500/30 transition-colors",children:[B.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-blue-500/5 to-transparent opacity-0 group-hover:opacity-100 transition-opacity rounded-2xl"}),B.jsxs("nav",{className:"flex lg:flex-col gap-3 relative z-10",children:[B.jsxs("button",{className:Lr("w-full text-left px-4 py-3 text-sm rounded-xl transition-all duration-300 hover-scale relative overflow-hidden group/nav",s==="feed"?"text-blue-400 font-medium bg-blue-500/10":"text-zinc-300 hover:text-white hover:bg-white/5"),onClick:()=>c("feed"),children:[B.jsxs("span",{className:"inline-flex items-center gap-3 relative z-10",children:[B.jsx(fZ,{className:"w-5 h-5"}),B.jsx("span",{children:"Feed"})]}),s==="feed"&&B.jsx(nr.div,{className:"absolute inset-0 bg-blue-500/20 rounded-xl z-0",layoutId:"activeSubNavBg",transition:{type:"spring",duration:.6}})]}),B.jsxs("button",{className:Lr("w-full text-left px-4 py-3 text-sm rounded-xl transition-all duration-300 hover-scale relative overflow-hidden group/nav",s==="live"?"text-blue-400 font-medium bg-blue-500/10":"text-zinc-300 hover:text-white hover:bg-white/5"),onClick:()=>c("live"),children:[B.jsxs("span",{className:"inline-flex items-center gap-3 relative z-10",children:[B.jsx(Nv,{className:"w-5 h-5"}),B.jsx("span",{children:"Live Camera"})]}),s==="live"&&B.jsx(nr.div,{className:"absolute inset-0 bg-blue-500/20 rounded-xl z-0",layoutId:"activeSubNavBg",transition:{type:"spring",duration:.6}})]}),B.jsxs("button",{className:Lr("w-full text-left px-4 py-3 text-sm rounded-xl transition-all duration-300 hover-scale relative overflow-hidden group/nav",s==="sos"?"text-red-400 font-medium bg-red-500/10":"text-zinc-300 hover:text-white hover:bg-white/5"),onClick:()=>c("sos"),children:[B.jsxs("span",{className:"inline-flex items-center gap-3 relative z-10",children:[B.jsx(Uh,{className:"w-5 h-5"}),B.jsx("span",{children:"Emergency SOS"})]}),s==="sos"&&B.jsx(nr.div,{className:"absolute inset-0 bg-red-500/20 rounded-xl z-0",layoutId:"activeSubNavBg",transition:{type:"spring",duration:.6}})]})]}),B.jsx("div",{className:"mt-6 relative z-20",children:B.jsxs(Qi,{size:"sm",className:"w-full rounded-xl bg-blue-500/20 hover:bg-blue-500/30 border border-blue-500/30 text-blue-300 hover:text-blue-200 transition-all relative z-20 pointer-events-auto",onClick:Re=>{Re.preventDefault(),Re.stopPropagation(),console.log("Button click event fired!"),Se()},type:"button",children:[B.jsx(UT,{className:"w-4 h-4 mr-2"}),"Simulate AI Event"]})})]})}),B.jsxs(nr.main,{variants:ue,className:"flex-1 min-w-0",children:[s==="feed"&&B.jsxs("div",{children:[B.jsx("h2",{className:"text-2xl font-semibold mb-2 text-white",children:"Security Feeds"}),B.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-2",children:Array.from({length:6}).map((Re,$e)=>B.jsxs(nr.div,{variants:ue,className:"group relative rounded-2xl border border-white/10 bg-zinc-900/40 p-8 backdrop-blur hover:border-blue-500/30 transition-all duration-300 h-80 cursor-pointer hover:scale-105",onClick:()=>Z($e),children:[B.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-blue-500/5 to-transparent opacity-0 group-hover:opacity-100 transition-opacity rounded-2xl"}),B.jsx("div",{className:"absolute inset-0 flex items-center justify-center text-zinc-400 group-hover:text-zinc-300 transition-colors",children:B.jsxs("div",{className:"text-center",children:[B.jsx($T,{className:"w-12 h-12 mx-auto mb-3"}),B.jsxs("span",{className:"text-lg font-medium",children:["Camera ",$e+1," feed"]}),B.jsx("p",{className:"text-sm text-zinc-500 mt-2",children:"Click to expand"})]})})]},$e))})]}),s==="live"&&B.jsxs("div",{children:[B.jsx("h2",{className:"text-2xl font-semibold mb-6 text-white",children:"Live Camera"}),B.jsxs(Dy,{className:"group relative rounded-2xl border border-white/10 bg-zinc-900/40 backdrop-blur hover:border-blue-500/30 transition-colors overflow-hidden min-h-[18rem] lg:min-h-[24rem]",children:[B.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-blue-500/5 to-transparent opacity-0 group-hover:opacity-100 transition-opacity rounded-2xl"}),B.jsx("video",{ref:v,className:"w-full h-full object-contain bg-black rounded-2xl",autoPlay:!0,muted:!0,playsInline:!0}),B.jsxs("div",{className:"absolute top-4 right-4 flex gap-2",children:[B.jsxs(Qi,{size:"sm",className:"rounded-xl bg-blue-500/20 hover:bg-blue-500/30 border border-blue-500/30 text-blue-300 hover:text-blue-200 transition-all",onClick:he,disabled:P||!!T.current,children:[P?B.jsx(BR,{className:"w-4 h-4 mr-2 animate-spin"}):B.jsx(Nv,{className:"w-4 h-4 mr-2"}),P?"Starting...":"Start"]}),B.jsxs(Qi,{size:"sm",className:"rounded-xl bg-red-500/20 hover:bg-red-500/30 border border-red-500/30 text-red-300 hover:text-red-200 transition-all",onClick:ye,disabled:!T.current,children:[B.jsx(Gh,{className:"w-4 h-4 mr-2"}),"Stop"]})]})]})]}),s==="sos"&&B.jsxs("div",{className:"flex flex-col items-center justify-center gap-6 py-12",children:[B.jsxs(nr.div,{initial:{scale:.8,opacity:0},animate:{scale:1,opacity:1},transition:{duration:.5},className:"relative",children:[B.jsx(Uh,{className:"w-16 h-16 text-red-400"}),B.jsx("div",{className:"absolute inset-0 animate-ping",children:B.jsx(Uh,{className:"w-16 h-16 text-red-400/30"})})]}),B.jsx("h2",{className:"text-3xl font-semibold text-white",children:"Emergency SOS"}),B.jsx("p",{className:"text-zinc-400 text-center max-w-md",children:"Use only in genuine emergencies. This will immediately notify school administration and law enforcement."}),B.jsxs(Qi,{size:"lg",className:"bg-red-600 hover:bg-red-700 text-white px-8 py-6 text-lg rounded-full transition-all hover:scale-105 shadow-lg shadow-red-500/25",onClick:()=>{confirm("Trigger Emergency SOS? This will notify principal and police.")&&(n({title:"SOS triggered",description:"Notifying principal"}),setTimeout(()=>n({title:"Notifying police station"}),600))},children:[B.jsx(Uh,{className:"w-6 h-6 mr-3"}),"Send SOS"]}),B.jsx("p",{className:"text-sm text-zinc-500",children:"Use only in emergencies."})]})]}),B.jsx(nr.aside,{variants:ue,className:"w-full",children:B.jsxs(Dy,{className:"group relative rounded-2xl border border-white/10 bg-zinc-900/40 p-6 backdrop-blur hover:border-blue-500/30 transition-colors",children:[B.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-blue-500/5 to-transparent opacity-0 group-hover:opacity-100 transition-opacity rounded-2xl"}),B.jsxs("div",{className:"flex items-center justify-between mb-6",children:[B.jsx("h3",{className:"text-xl font-semibold text-white",children:"Security Events"}),B.jsx(BT,{className:"w-5 h-5 text-blue-400"})]}),B.jsxs(une,{value:O,onValueChange:Re=>I(Re),className:"w-full",children:[B.jsxs($F,{className:"relative grid grid-cols-2 gap-2 p-1 items-center bg-transparent backdrop-blur-md border border-border/30 rounded-full shadow-lg w-auto h-full",children:[B.jsx(nr.div,{className:"absolute top-1 bottom-1 bg-blue-500/20 rounded-full",layout:!0,transition:{type:"spring",stiffness:400,damping:30},style:{width:"calc(50% - 4px)",left:O==="live"?"4px":"calc(50% + 1px)"}}),B.jsx(yE,{value:"live",className:"relative px-3 py-2 text-sm rounded-lg data-[state=active]:bg-transparent text-white data-[state=active]:text-white",children:B.jsx("span",{className:"relative z-10",children:"Live"})}),B.jsx(yE,{value:"past",className:"relative px-3 py-2 text-sm rounded-lg data-[state=active]:bg-transparent text-white data-[state=active]:text-white",children:B.jsx("span",{className:"relative z-10",children:"Past"})})]}),B.jsx(_E,{value:"live",children:B.jsx("div",{className:"mt-6 space-y-4 max-h-[60vh] overflow-y-auto pr-2",children:l.length===0?B.jsxs("div",{className:"text-center py-8",children:[B.jsx(BT,{className:"w-8 h-8 text-zinc-500 mx-auto mb-3"}),B.jsx("div",{className:"text-sm text-zinc-400",children:"No live events"}),B.jsx("div",{className:"text-xs text-zinc-500 mt-1",children:"All clear for now"})]}):l.map(Re=>{const $e=Re.severity==="high"?"red":Re.severity==="medium"?"orange":"blue",Xe=Re.severity==="high"?"red-500/10":Re.severity==="medium"?"orange-500/10":"blue-500/10",st=Re.severity==="high"?"red-500/30":Re.severity==="medium"?"orange-500/30":"blue-500/30";return B.jsxs(nr.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},className:`group relative rounded-xl border border-white/10 bg-zinc-800/40 p-4 backdrop-blur hover:border-${$e}-500/30 transition-colors`,children:[B.jsx("div",{className:`absolute inset-0 bg-gradient-to-br from-${$e}-500/5 to-transparent opacity-0 group-hover:opacity-100 transition-opacity rounded-xl`}),B.jsxs("div",{className:"flex items-start justify-between gap-3 mb-4",children:[B.jsxs("div",{className:"flex-1",children:[B.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[B.jsx("div",{className:"font-medium text-white",children:Re.detected}),Re.severity&&B.jsx("span",{className:`text-xs px-2 py-1 rounded-full font-medium bg-${Xe} text-${$e}-300 border border-${st}`,children:Re.severity.toUpperCase()})]}),B.jsxs("div",{className:"text-sm text-zinc-400",children:[Re.camera,"  ",Re.timestamp]}),Re.combined_score&&B.jsxs("div",{className:"text-xs text-zinc-500 mt-1",children:["Confidence: ",Re.combined_score.toFixed(1),"%",Re.scores&&B.jsxs("span",{className:"ml-2",children:["(Video: ",Re.scores.video.toFixed(1),"%, Audio: ",Re.scores.audio.toFixed(1),"%)"]})]})]}),B.jsx("div",{className:`w-2 h-2 bg-${$e}-400 rounded-full animate-pulse`})]}),B.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[B.jsxs(Qi,{variant:"outline",onClick:()=>ve(Re.id),className:"rounded-lg bg-red-500/10 hover:bg-red-500/20 border-red-500/30 text-red-300 hover:text-red-200 transition-all",children:[B.jsx(Gh,{className:"w-4 h-4 mr-2"}),"Reject"]}),B.jsxs(Qi,{onClick:()=>fe(Re.id),className:"rounded-lg bg-blue-500/20 hover:bg-blue-500/30 border-blue-500/30 text-blue-300 hover:text-blue-200 transition-all",children:[B.jsx(jR,{className:"w-4 h-4 mr-2"}),"Approve"]})]})]},Re.id)})})}),B.jsx(_E,{value:"past",children:B.jsx("div",{className:"mt-6 space-y-4 max-h-[60vh] overflow-y-auto pr-2",children:m.length===0?B.jsxs("div",{className:"text-center py-8",children:[B.jsx(G4,{className:"w-8 h-8 text-zinc-500 mx-auto mb-3"}),B.jsx("div",{className:"text-sm text-zinc-400",children:"No past events"}),B.jsx("div",{className:"text-xs text-zinc-500 mt-1",children:"Event history will appear here"})]}):m.map(Re=>B.jsxs(nr.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"group relative rounded-xl border border-white/10 bg-zinc-800/40 p-4 backdrop-blur hover:border-zinc-500/30 transition-colors",children:[B.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-zinc-500/5 to-transparent opacity-0 group-hover:opacity-100 transition-opacity rounded-xl"}),B.jsxs("div",{className:"flex items-start justify-between gap-3",children:[B.jsxs("div",{className:"flex-1",children:[B.jsx("div",{className:"font-medium text-white mb-1",children:Re.detected}),B.jsxs("div",{className:"text-sm text-zinc-400",children:[Re.camera,"  ",Re.timestamp]})]}),B.jsx("span",{className:`text-xs px-3 py-1 rounded-full font-medium ${Re.status==="accepted"?"bg-green-500/20 text-green-300 border border-green-500/30":"bg-red-500/20 text-red-300 border border-red-500/30"}`,children:Re.status==="accepted"?"Accepted":"Rejected"})]})]},Re.id))})})]})]})})]})]})}),z&&L&&B.jsx(nr.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black/90 backdrop-blur-sm z-50 flex items-center justify-center p-4",onClick:()=>j(!1),children:B.jsxs(nr.div,{initial:{scale:.8,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.8,opacity:0},className:"relative w-full h-full max-w-7xl max-h-[80vh] bg-gradient-to-br from-red-900/20 to-red-800/10 border border-red-500/30 rounded-3xl overflow-hidden",onClick:Re=>Re.stopPropagation(),children:[B.jsx("div",{className:"absolute top-0 left-0 right-0 bg-gradient-to-r from-red-600/20 to-red-500/20 backdrop-blur-md border-b border-red-500/30 p-6",children:B.jsxs("div",{className:"flex items-center justify-between",children:[B.jsxs("div",{className:"flex items-center gap-4",children:[B.jsx("div",{className:"w-12 h-12 bg-red-500/20 rounded-full flex items-center justify-center",children:B.jsx(Uh,{className:"w-6 h-6 text-red-400 animate-pulse"})}),B.jsxs("div",{children:[B.jsx("h2",{className:"text-2xl font-bold text-white",children:" HIGH SEVERITY ALERT"}),B.jsx("p",{className:"text-red-300",children:"Immediate action required"})]})]}),B.jsx("button",{onClick:()=>j(!1),className:"w-10 h-10 bg-red-500/20 hover:bg-red-500/30 rounded-full flex items-center justify-center text-red-300 hover:text-white transition-colors",children:B.jsx(Gh,{className:"w-5 h-5"})})]})}),B.jsx("div",{className:"pt-24 p-8 h-full overflow-y-auto",children:B.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8 h-full",children:[B.jsxs("div",{className:"space-y-6",children:[B.jsxs("div",{className:"bg-zinc-900/40 rounded-2xl p-6 border border-red-500/20",children:[B.jsx("h3",{className:"text-xl font-semibold text-white mb-4",children:"Event Details"}),B.jsxs("div",{className:"space-y-3",children:[B.jsxs("div",{className:"flex justify-between",children:[B.jsx("span",{className:"text-zinc-400",children:"Detection:"}),B.jsx("span",{className:"text-white font-medium",children:L.detected})]}),B.jsxs("div",{className:"flex justify-between",children:[B.jsx("span",{className:"text-zinc-400",children:"Camera:"}),B.jsx("span",{className:"text-white font-medium",children:L.camera})]}),B.jsxs("div",{className:"flex justify-between",children:[B.jsx("span",{className:"text-zinc-400",children:"Timestamp:"}),B.jsx("span",{className:"text-white font-medium",children:L.timestamp})]}),B.jsxs("div",{className:"flex justify-between",children:[B.jsx("span",{className:"text-zinc-400",children:"Event ID:"}),B.jsx("span",{className:"text-white font-mono text-sm",children:L.event_id})]}),L.combined_score&&B.jsxs("div",{className:"flex justify-between",children:[B.jsx("span",{className:"text-zinc-400",children:"Confidence:"}),B.jsxs("span",{className:"text-red-400 font-bold",children:[L.combined_score.toFixed(1),"%"]})]})]})]}),L.scores&&B.jsxs("div",{className:"bg-zinc-900/40 rounded-2xl p-6 border border-red-500/20",children:[B.jsx("h3",{className:"text-xl font-semibold text-white mb-4",children:"Detection Scores"}),B.jsxs("div",{className:"space-y-4",children:[B.jsxs("div",{children:[B.jsxs("div",{className:"flex justify-between mb-2",children:[B.jsx("span",{className:"text-zinc-400",children:"Video Analysis"}),B.jsxs("span",{className:"text-white font-medium",children:[L.scores.video.toFixed(1),"%"]})]}),B.jsx("div",{className:"w-full bg-zinc-700 rounded-full h-2",children:B.jsx("div",{className:"bg-red-500 h-2 rounded-full transition-all duration-500",style:{width:`${L.scores.video}%`}})})]}),B.jsxs("div",{children:[B.jsxs("div",{className:"flex justify-between mb-2",children:[B.jsx("span",{className:"text-zinc-400",children:"Audio Analysis"}),B.jsxs("span",{className:"text-white font-medium",children:[L.scores.audio.toFixed(1),"%"]})]}),B.jsx("div",{className:"w-full bg-zinc-700 rounded-full h-2",children:B.jsx("div",{className:"bg-red-500 h-2 rounded-full transition-all duration-500",style:{width:`${L.scores.audio}%`}})})]})]})]}),B.jsxs("div",{className:"space-y-4",children:[B.jsxs(Qi,{size:"lg",className:"w-full bg-red-600 hover:bg-red-700 text-white py-4 text-lg rounded-xl",onClick:()=>{fe(L.id),j(!1)},children:[B.jsx(jR,{className:"w-5 h-5 mr-2"}),"CONFIRM THREAT - ESCALATE NOW"]}),B.jsxs(Qi,{size:"lg",variant:"outline",className:"w-full border-red-500/30 text-red-300 hover:bg-red-500/10 py-4 text-lg rounded-xl",onClick:()=>{ve(L.id),j(!1)},children:[B.jsx(Gh,{className:"w-5 h-5 mr-2"}),"FALSE ALARM - DISMISS"]})]})]}),B.jsxs("div",{className:"bg-zinc-900/40 rounded-2xl p-6 border border-red-500/20",children:[B.jsx("h3",{className:"text-xl font-semibold text-white mb-4",children:"Live Camera Feed"}),B.jsxs("div",{className:"relative bg-black rounded-xl h-64 flex items-center justify-center",children:[B.jsxs("div",{className:"text-center",children:[B.jsx(Nv,{className:"w-16 h-16 text-red-400 mx-auto mb-4 animate-pulse"}),B.jsxs("p",{className:"text-red-300 font-medium",children:["Live Feed from ",L.camera]}),B.jsx("p",{className:"text-zinc-500 text-sm mt-2",children:"Weapon detection in progress..."})]}),B.jsx("div",{className:"absolute top-4 left-4 bg-red-600/90 text-white px-3 py-1 rounded-full text-sm font-medium animate-pulse",children:"WEAPON DETECTED"}),B.jsx("div",{className:"absolute bottom-4 right-4 bg-red-600/90 text-white px-3 py-1 rounded-full text-sm font-medium",children:"LIVE"})]})]})]})})]})}),W!==null&&B.jsx(nr.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black/95 backdrop-blur-sm z-50 flex items-center justify-center p-4",onClick:()=>Z(null),children:B.jsxs(nr.div,{initial:{scale:.8,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.8,opacity:0},className:"relative w-full h-full max-w-7xl max-h-[90vh] bg-zinc-900 rounded-3xl border border-white/20 overflow-hidden",onClick:Re=>Re.stopPropagation(),children:[B.jsx("div",{className:"absolute top-0 left-0 right-0 bg-gradient-to-r from-blue-600/20 to-blue-500/20 backdrop-blur-md border-b border-blue-500/30 p-4 z-10",children:B.jsxs("div",{className:"flex items-center justify-between",children:[B.jsxs("div",{className:"flex items-center gap-4",children:[B.jsx("div",{className:"w-10 h-10 bg-blue-500/20 rounded-full flex items-center justify-center",children:B.jsx(Nv,{className:"w-5 h-5 text-blue-400"})}),B.jsxs("div",{children:[B.jsxs("h2",{className:"text-xl font-bold text-white",children:["Camera ",W+1," Feed"]}),B.jsx("p",{className:"text-blue-300",children:"Live Security Feed"})]})]}),B.jsx("button",{onClick:()=>Z(null),className:"w-8 h-8 bg-zinc-800 hover:bg-zinc-700 rounded-full flex items-center justify-center text-white transition-colors",children:B.jsx(Gh,{className:"w-4 h-4"})})]})}),B.jsx("div",{className:"pt-16 h-full flex items-center justify-center bg-black",children:B.jsxs("div",{className:"relative w-full h-full max-w-5xl max-h-[70vh] bg-zinc-800 rounded-2xl border border-white/10 flex items-center justify-center",children:[B.jsxs("div",{className:"text-center",children:[B.jsx($T,{className:"w-24 h-24 mx-auto mb-6 text-blue-400 animate-pulse"}),B.jsxs("h3",{className:"text-3xl font-bold text-white mb-2",children:["Camera ",W+1," Feed"]}),B.jsx("p",{className:"text-xl text-zinc-400 mb-4",children:"Live Security Feed"}),B.jsxs("div",{className:"flex items-center justify-center gap-2 mb-6",children:[B.jsx("div",{className:"w-3 h-3 bg-red-500 rounded-full animate-pulse"}),B.jsx("span",{className:"text-sm text-red-400 font-medium",children:"LIVE"})]}),B.jsxs("div",{className:"text-sm text-zinc-500",children:[B.jsx("p",{children:"Resolution: 1920x1080"}),B.jsx("p",{children:"FPS: 30"}),B.jsx("p",{children:"Status: Active"})]})]}),B.jsx("div",{className:"absolute top-4 left-4 bg-red-600/90 text-white px-3 py-1 rounded-full text-sm font-medium animate-pulse",children:"LIVE FEED"}),B.jsx("div",{className:"absolute top-4 right-4 bg-green-600/90 text-white px-3 py-1 rounded-full text-sm font-medium",children:"REC"}),B.jsx("div",{className:"absolute bottom-4 left-4 bg-black/50 text-white px-3 py-1 rounded text-sm",children:new Date().toLocaleTimeString()}),B.jsxs("div",{className:"absolute bottom-4 right-4 bg-black/50 text-white px-3 py-1 rounded text-sm",children:["Camera ",W+1]})]})})]})})]})}function Ly(t){let e=t[0],r=t[1],n=t[2];return Math.sqrt(e*e+r*r+n*n)}function vE(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t}function dne(t,e,r,n){return t[0]=e,t[1]=r,t[2]=n,t}function ZD(t,e,r){return t[0]=e[0]+r[0],t[1]=e[1]+r[1],t[2]=e[2]+r[2],t}function KD(t,e,r){return t[0]=e[0]-r[0],t[1]=e[1]-r[1],t[2]=e[2]-r[2],t}function fne(t,e,r){return t[0]=e[0]*r[0],t[1]=e[1]*r[1],t[2]=e[2]*r[2],t}function pne(t,e,r){return t[0]=e[0]/r[0],t[1]=e[1]/r[1],t[2]=e[2]/r[2],t}function nS(t,e,r){return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t}function mne(t,e){let r=e[0]-t[0],n=e[1]-t[1],s=e[2]-t[2];return Math.sqrt(r*r+n*n+s*s)}function gne(t,e){let r=e[0]-t[0],n=e[1]-t[1],s=e[2]-t[2];return r*r+n*n+s*s}function XD(t){let e=t[0],r=t[1],n=t[2];return e*e+r*r+n*n}function yne(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t}function _ne(t,e){return t[0]=1/e[0],t[1]=1/e[1],t[2]=1/e[2],t}function xE(t,e){let r=e[0],n=e[1],s=e[2],c=r*r+n*n+s*s;return c>0&&(c=1/Math.sqrt(c)),t[0]=e[0]*c,t[1]=e[1]*c,t[2]=e[2]*c,t}function VF(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}function YD(t,e,r){let n=e[0],s=e[1],c=e[2],l=r[0],a=r[1],m=r[2];return t[0]=s*m-c*a,t[1]=c*l-n*m,t[2]=n*a-s*l,t}function vne(t,e,r,n){let s=e[0],c=e[1],l=e[2];return t[0]=s+n*(r[0]-s),t[1]=c+n*(r[1]-c),t[2]=l+n*(r[2]-l),t}function xne(t,e,r,n,s){const c=Math.exp(-n*s);let l=e[0],a=e[1],m=e[2];return t[0]=r[0]+(l-r[0])*c,t[1]=r[1]+(a-r[1])*c,t[2]=r[2]+(m-r[2])*c,t}function bne(t,e,r){let n=e[0],s=e[1],c=e[2],l=r[3]*n+r[7]*s+r[11]*c+r[15];return l=l||1,t[0]=(r[0]*n+r[4]*s+r[8]*c+r[12])/l,t[1]=(r[1]*n+r[5]*s+r[9]*c+r[13])/l,t[2]=(r[2]*n+r[6]*s+r[10]*c+r[14])/l,t}function wne(t,e,r){let n=e[0],s=e[1],c=e[2],l=r[3]*n+r[7]*s+r[11]*c+r[15];return l=l||1,t[0]=(r[0]*n+r[4]*s+r[8]*c)/l,t[1]=(r[1]*n+r[5]*s+r[9]*c)/l,t[2]=(r[2]*n+r[6]*s+r[10]*c)/l,t}function Sne(t,e,r){let n=e[0],s=e[1],c=e[2];return t[0]=n*r[0]+s*r[3]+c*r[6],t[1]=n*r[1]+s*r[4]+c*r[7],t[2]=n*r[2]+s*r[5]+c*r[8],t}function Tne(t,e,r){let n=e[0],s=e[1],c=e[2],l=r[0],a=r[1],m=r[2],y=r[3],v=a*c-m*s,T=m*n-l*c,P=l*s-a*n,A=a*P-m*T,O=m*v-l*P,I=l*T-a*v,L=y*2;return v*=L,T*=L,P*=L,A*=2,O*=2,I*=2,t[0]=n+v+A,t[1]=s+T+O,t[2]=c+P+I,t}const Ene=function(){const t=[0,0,0],e=[0,0,0];return function(r,n){vE(t,r),vE(e,n),xE(t,t),xE(e,e);let s=VF(t,e);return s>1?0:s<-1?Math.PI:Math.acos(s)}}();function Cne(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]}class Sa extends Array{constructor(e=0,r=e,n=e){return super(e,r,n),this}get x(){return this[0]}get y(){return this[1]}get z(){return this[2]}set x(e){this[0]=e}set y(e){this[1]=e}set z(e){this[2]=e}set(e,r=e,n=e){return e.length?this.copy(e):(dne(this,e,r,n),this)}copy(e){return vE(this,e),this}add(e,r){return r?ZD(this,e,r):ZD(this,this,e),this}sub(e,r){return r?KD(this,e,r):KD(this,this,e),this}multiply(e){return e.length?fne(this,this,e):nS(this,this,e),this}divide(e){return e.length?pne(this,this,e):nS(this,this,1/e),this}inverse(e=this){return _ne(this,e),this}len(){return Ly(this)}distance(e){return e?mne(this,e):Ly(this)}squaredLen(){return XD(this)}squaredDistance(e){return e?gne(this,e):XD(this)}negate(e=this){return yne(this,e),this}cross(e,r){return r?YD(this,e,r):YD(this,this,e),this}scale(e){return nS(this,this,e),this}normalize(){return xE(this,this),this}dot(e){return VF(this,e)}equals(e){return Cne(this,e)}applyMatrix3(e){return Sne(this,this,e),this}applyMatrix4(e){return bne(this,this,e),this}scaleRotateMatrix4(e){return wne(this,this,e),this}applyQuaternion(e){return Tne(this,this,e),this}angle(e){return Ene(this,e)}lerp(e,r){return vne(this,this,e,r),this}smoothLerp(e,r,n){return xne(this,this,e,r,n),this}clone(){return new Sa(this[0],this[1],this[2])}fromArray(e,r=0){return this[0]=e[r],this[1]=e[r+1],this[2]=e[r+2],this}toArray(e=[],r=0){return e[r]=this[0],e[r+1]=this[1],e[r+2]=this[2],e}transformDirection(e){const r=this[0],n=this[1],s=this[2];return this[0]=e[0]*r+e[4]*n+e[8]*s,this[1]=e[1]*r+e[5]*n+e[9]*s,this[2]=e[2]*r+e[6]*n+e[10]*s,this.normalize()}}const QD=new Sa;let Pne=1,Ane=1,JD=!1;class kne{constructor(e,r={}){e.canvas||console.error("gl not passed as first argument to Geometry"),this.gl=e,this.attributes=r,this.id=Pne++,this.VAOs={},this.drawRange={start:0,count:0},this.instancedCount=0,this.gl.renderer.bindVertexArray(null),this.gl.renderer.currentGeometry=null,this.glState=this.gl.renderer.state;for(let n in r)this.addAttribute(n,r[n])}addAttribute(e,r){if(this.attributes[e]=r,r.id=Ane++,r.size=r.size||1,r.type=r.type||(r.data.constructor===Float32Array?this.gl.FLOAT:r.data.constructor===Uint16Array?this.gl.UNSIGNED_SHORT:this.gl.UNSIGNED_INT),r.target=e==="index"?this.gl.ELEMENT_ARRAY_BUFFER:this.gl.ARRAY_BUFFER,r.normalized=r.normalized||!1,r.stride=r.stride||0,r.offset=r.offset||0,r.count=r.count||(r.stride?r.data.byteLength/r.stride:r.data.length/r.size),r.divisor=r.instanced||0,r.needsUpdate=!1,r.usage=r.usage||this.gl.STATIC_DRAW,r.buffer||this.updateAttribute(r),r.divisor){if(this.isInstanced=!0,this.instancedCount&&this.instancedCount!==r.count*r.divisor)return console.warn("geometry has multiple instanced buffers of different length"),this.instancedCount=Math.min(this.instancedCount,r.count*r.divisor);this.instancedCount=r.count*r.divisor}else e==="index"?this.drawRange.count=r.count:this.attributes.index||(this.drawRange.count=Math.max(this.drawRange.count,r.count))}updateAttribute(e){const r=!e.buffer;r&&(e.buffer=this.gl.createBuffer()),this.glState.boundBuffer!==e.buffer&&(this.gl.bindBuffer(e.target,e.buffer),this.glState.boundBuffer=e.buffer),r?this.gl.bufferData(e.target,e.data,e.usage):this.gl.bufferSubData(e.target,0,e.data),e.needsUpdate=!1}setIndex(e){this.addAttribute("index",e)}setDrawRange(e,r){this.drawRange.start=e,this.drawRange.count=r}setInstancedCount(e){this.instancedCount=e}createVAO(e){this.VAOs[e.attributeOrder]=this.gl.renderer.createVertexArray(),this.gl.renderer.bindVertexArray(this.VAOs[e.attributeOrder]),this.bindAttributes(e)}bindAttributes(e){e.attributeLocations.forEach((r,{name:n,type:s})=>{if(!this.attributes[n]){console.warn(`active attribute ${n} not being supplied`);return}const c=this.attributes[n];this.gl.bindBuffer(c.target,c.buffer),this.glState.boundBuffer=c.buffer;let l=1;s===35674&&(l=2),s===35675&&(l=3),s===35676&&(l=4);const a=c.size/l,m=l===1?0:l*l*4,y=l===1?0:l*4;for(let v=0;v<l;v++)this.gl.vertexAttribPointer(r+v,a,c.type,c.normalized,c.stride+m,c.offset+v*y),this.gl.enableVertexAttribArray(r+v),this.gl.renderer.vertexAttribDivisor(r+v,c.divisor)}),this.attributes.index&&this.gl.bindBuffer(this.gl.ELEMENT_ARRAY_BUFFER,this.attributes.index.buffer)}draw({program:e,mode:r=this.gl.TRIANGLES}){var s;this.gl.renderer.currentGeometry!==`${this.id}_${e.attributeOrder}`&&(this.VAOs[e.attributeOrder]||this.createVAO(e),this.gl.renderer.bindVertexArray(this.VAOs[e.attributeOrder]),this.gl.renderer.currentGeometry=`${this.id}_${e.attributeOrder}`),e.attributeLocations.forEach((c,{name:l})=>{const a=this.attributes[l];a.needsUpdate&&this.updateAttribute(a)});let n=2;((s=this.attributes.index)==null?void 0:s.type)===this.gl.UNSIGNED_INT&&(n=4),this.isInstanced?this.attributes.index?this.gl.renderer.drawElementsInstanced(r,this.drawRange.count,this.attributes.index.type,this.attributes.index.offset+this.drawRange.start*n,this.instancedCount):this.gl.renderer.drawArraysInstanced(r,this.drawRange.start,this.drawRange.count,this.instancedCount):this.attributes.index?this.gl.drawElements(r,this.drawRange.count,this.attributes.index.type,this.attributes.index.offset+this.drawRange.start*n):this.gl.drawArrays(r,this.drawRange.start,this.drawRange.count)}getPosition(){const e=this.attributes.position;if(e.data)return e;if(!JD)return console.warn("No position buffer data found to compute bounds"),JD=!0}computeBoundingBox(e){e||(e=this.getPosition());const r=e.data,n=e.size;this.bounds||(this.bounds={min:new Sa,max:new Sa,center:new Sa,scale:new Sa,radius:1/0});const s=this.bounds.min,c=this.bounds.max,l=this.bounds.center,a=this.bounds.scale;s.set(1/0),c.set(-1/0);for(let m=0,y=r.length;m<y;m+=n){const v=r[m],T=r[m+1],P=r[m+2];s.x=Math.min(v,s.x),s.y=Math.min(T,s.y),s.z=Math.min(P,s.z),c.x=Math.max(v,c.x),c.y=Math.max(T,c.y),c.z=Math.max(P,c.z)}a.sub(c,s),l.add(s,c).divide(2)}computeBoundingSphere(e){e||(e=this.getPosition());const r=e.data,n=e.size;this.bounds||this.computeBoundingBox(e);let s=0;for(let c=0,l=r.length;c<l;c+=n)QD.fromArray(r,c),s=Math.max(s,this.bounds.center.squaredDistance(QD));this.bounds.radius=Math.sqrt(s)}remove(){for(let e in this.VAOs)this.gl.renderer.deleteVertexArray(this.VAOs[e]),delete this.VAOs[e];for(let e in this.attributes)this.gl.deleteBuffer(this.attributes[e].buffer),delete this.attributes[e]}}let Mne=1;const eL={};class Ine{constructor(e,{vertex:r,fragment:n,uniforms:s={},transparent:c=!1,cullFace:l=e.BACK,frontFace:a=e.CCW,depthTest:m=!0,depthWrite:y=!0,depthFunc:v=e.LEQUAL}={}){e.canvas||console.error("gl not passed as first argument to Program"),this.gl=e,this.uniforms=s,this.id=Mne++,r||console.warn("vertex shader not supplied"),n||console.warn("fragment shader not supplied"),this.transparent=c,this.cullFace=l,this.frontFace=a,this.depthTest=m,this.depthWrite=y,this.depthFunc=v,this.blendFunc={},this.blendEquation={},this.stencilFunc={},this.stencilOp={},this.transparent&&!this.blendFunc.src&&(this.gl.renderer.premultipliedAlpha?this.setBlendFunc(this.gl.ONE,this.gl.ONE_MINUS_SRC_ALPHA):this.setBlendFunc(this.gl.SRC_ALPHA,this.gl.ONE_MINUS_SRC_ALPHA)),this.vertexShader=e.createShader(e.VERTEX_SHADER),this.fragmentShader=e.createShader(e.FRAGMENT_SHADER),this.program=e.createProgram(),e.attachShader(this.program,this.vertexShader),e.attachShader(this.program,this.fragmentShader),this.setShaders({vertex:r,fragment:n})}setShaders({vertex:e,fragment:r}){if(e&&(this.gl.shaderSource(this.vertexShader,e),this.gl.compileShader(this.vertexShader),this.gl.getShaderInfoLog(this.vertexShader)!==""&&console.warn(`${this.gl.getShaderInfoLog(this.vertexShader)}
Vertex Shader
${tL(e)}`)),r&&(this.gl.shaderSource(this.fragmentShader,r),this.gl.compileShader(this.fragmentShader),this.gl.getShaderInfoLog(this.fragmentShader)!==""&&console.warn(`${this.gl.getShaderInfoLog(this.fragmentShader)}
Fragment Shader
${tL(r)}`)),this.gl.linkProgram(this.program),!this.gl.getProgramParameter(this.program,this.gl.LINK_STATUS))return console.warn(this.gl.getProgramInfoLog(this.program));this.uniformLocations=new Map;let n=this.gl.getProgramParameter(this.program,this.gl.ACTIVE_UNIFORMS);for(let l=0;l<n;l++){let a=this.gl.getActiveUniform(this.program,l);this.uniformLocations.set(a,this.gl.getUniformLocation(this.program,a.name));const m=a.name.match(/(\w+)/g);a.uniformName=m[0],a.nameComponents=m.slice(1)}this.attributeLocations=new Map;const s=[],c=this.gl.getProgramParameter(this.program,this.gl.ACTIVE_ATTRIBUTES);for(let l=0;l<c;l++){const a=this.gl.getActiveAttrib(this.program,l),m=this.gl.getAttribLocation(this.program,a.name);m!==-1&&(s[m]=a.name,this.attributeLocations.set(a,m))}this.attributeOrder=s.join("")}setBlendFunc(e,r,n,s){this.blendFunc.src=e,this.blendFunc.dst=r,this.blendFunc.srcAlpha=n,this.blendFunc.dstAlpha=s,e&&(this.transparent=!0)}setBlendEquation(e,r){this.blendEquation.modeRGB=e,this.blendEquation.modeAlpha=r}setStencilFunc(e,r,n){this.stencilRef=r,this.stencilFunc.func=e,this.stencilFunc.ref=r,this.stencilFunc.mask=n}setStencilOp(e,r,n){this.stencilOp.stencilFail=e,this.stencilOp.depthFail=r,this.stencilOp.depthPass=n}applyState(){this.depthTest?this.gl.renderer.enable(this.gl.DEPTH_TEST):this.gl.renderer.disable(this.gl.DEPTH_TEST),this.cullFace?this.gl.renderer.enable(this.gl.CULL_FACE):this.gl.renderer.disable(this.gl.CULL_FACE),this.blendFunc.src?this.gl.renderer.enable(this.gl.BLEND):this.gl.renderer.disable(this.gl.BLEND),this.cullFace&&this.gl.renderer.setCullFace(this.cullFace),this.gl.renderer.setFrontFace(this.frontFace),this.gl.renderer.setDepthMask(this.depthWrite),this.gl.renderer.setDepthFunc(this.depthFunc),this.blendFunc.src&&this.gl.renderer.setBlendFunc(this.blendFunc.src,this.blendFunc.dst,this.blendFunc.srcAlpha,this.blendFunc.dstAlpha),this.gl.renderer.setBlendEquation(this.blendEquation.modeRGB,this.blendEquation.modeAlpha),this.stencilFunc.func||this.stencilOp.stencilFail?this.gl.renderer.enable(this.gl.STENCIL_TEST):this.gl.renderer.disable(this.gl.STENCIL_TEST),this.gl.renderer.setStencilFunc(this.stencilFunc.func,this.stencilFunc.ref,this.stencilFunc.mask),this.gl.renderer.setStencilOp(this.stencilOp.stencilFail,this.stencilOp.depthFail,this.stencilOp.depthPass)}use({flipFaces:e=!1}={}){let r=-1;this.gl.renderer.state.currentProgram===this.id||(this.gl.useProgram(this.program),this.gl.renderer.state.currentProgram=this.id),this.uniformLocations.forEach((s,c)=>{let l=this.uniforms[c.uniformName];for(const a of c.nameComponents){if(!l)break;if(a in l)l=l[a];else{if(Array.isArray(l.value))break;l=void 0;break}}if(!l)return rL(`Active uniform ${c.name} has not been supplied`);if(l&&l.value===void 0)return rL(`${c.name} uniform is missing a value parameter`);if(l.value.texture)return r=r+1,l.value.update(r),iS(this.gl,c.type,s,r);if(l.value.length&&l.value[0].texture){const a=[];return l.value.forEach(m=>{r=r+1,m.update(r),a.push(r)}),iS(this.gl,c.type,s,a)}iS(this.gl,c.type,s,l.value)}),this.applyState(),e&&this.gl.renderer.setFrontFace(this.frontFace===this.gl.CCW?this.gl.CW:this.gl.CCW)}remove(){this.gl.deleteProgram(this.program)}}function iS(t,e,r,n){n=n.length?Rne(n):n;const s=t.renderer.state.uniformLocations.get(r);if(n.length)if(s===void 0||s.length!==n.length)t.renderer.state.uniformLocations.set(r,n.slice(0));else{if(Dne(s,n))return;s.set?s.set(n):Lne(s,n),t.renderer.state.uniformLocations.set(r,s)}else{if(s===n)return;t.renderer.state.uniformLocations.set(r,n)}switch(e){case 5126:return n.length?t.uniform1fv(r,n):t.uniform1f(r,n);case 35664:return t.uniform2fv(r,n);case 35665:return t.uniform3fv(r,n);case 35666:return t.uniform4fv(r,n);case 35670:case 5124:case 35678:case 36306:case 35680:case 36289:return n.length?t.uniform1iv(r,n):t.uniform1i(r,n);case 35671:case 35667:return t.uniform2iv(r,n);case 35672:case 35668:return t.uniform3iv(r,n);case 35673:case 35669:return t.uniform4iv(r,n);case 35674:return t.uniformMatrix2fv(r,!1,n);case 35675:return t.uniformMatrix3fv(r,!1,n);case 35676:return t.uniformMatrix4fv(r,!1,n)}}function tL(t){let e=t.split(`
`);for(let r=0;r<e.length;r++)e[r]=r+1+": "+e[r];return e.join(`
`)}function Rne(t){const e=t.length,r=t[0].length;if(r===void 0)return t;const n=e*r;let s=eL[n];s||(eL[n]=s=new Float32Array(n));for(let c=0;c<e;c++)s.set(t[c],c*r);return s}function Dne(t,e){if(t.length!==e.length)return!1;for(let r=0,n=t.length;r<n;r++)if(t[r]!==e[r])return!1;return!0}function Lne(t,e){for(let r=0,n=t.length;r<n;r++)t[r]=e[r]}let sS=0;function rL(t){sS>100||(console.warn(t),sS++,sS>100&&console.warn("More than 100 program warnings - stopping logs."))}const oS=new Sa;let One=1;class zne{constructor({canvas:e=document.createElement("canvas"),width:r=300,height:n=150,dpr:s=1,alpha:c=!1,depth:l=!0,stencil:a=!1,antialias:m=!1,premultipliedAlpha:y=!1,preserveDrawingBuffer:v=!1,powerPreference:T="default",autoClear:P=!0,webgl:A=2}={}){const O={alpha:c,depth:l,stencil:a,antialias:m,premultipliedAlpha:y,preserveDrawingBuffer:v,powerPreference:T};this.dpr=s,this.alpha=c,this.color=!0,this.depth=l,this.stencil=a,this.premultipliedAlpha=y,this.autoClear=P,this.id=One++,A===2&&(this.gl=e.getContext("webgl2",O)),this.isWebgl2=!!this.gl,this.gl||(this.gl=e.getContext("webgl",O)),this.gl||console.error("unable to create webgl context"),this.gl.renderer=this,this.setSize(r,n),this.state={},this.state.blendFunc={src:this.gl.ONE,dst:this.gl.ZERO},this.state.blendEquation={modeRGB:this.gl.FUNC_ADD},this.state.cullFace=!1,this.state.frontFace=this.gl.CCW,this.state.depthMask=!0,this.state.depthFunc=this.gl.LEQUAL,this.state.premultiplyAlpha=!1,this.state.flipY=!1,this.state.unpackAlignment=4,this.state.framebuffer=null,this.state.viewport={x:0,y:0,width:null,height:null},this.state.textureUnits=[],this.state.activeTextureUnit=0,this.state.boundBuffer=null,this.state.uniformLocations=new Map,this.state.currentProgram=null,this.extensions={},this.isWebgl2?(this.getExtension("EXT_color_buffer_float"),this.getExtension("OES_texture_float_linear")):(this.getExtension("OES_texture_float"),this.getExtension("OES_texture_float_linear"),this.getExtension("OES_texture_half_float"),this.getExtension("OES_texture_half_float_linear"),this.getExtension("OES_element_index_uint"),this.getExtension("OES_standard_derivatives"),this.getExtension("EXT_sRGB"),this.getExtension("WEBGL_depth_texture"),this.getExtension("WEBGL_draw_buffers")),this.getExtension("WEBGL_compressed_texture_astc"),this.getExtension("EXT_texture_compression_bptc"),this.getExtension("WEBGL_compressed_texture_s3tc"),this.getExtension("WEBGL_compressed_texture_etc1"),this.getExtension("WEBGL_compressed_texture_pvrtc"),this.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc"),this.vertexAttribDivisor=this.getExtension("ANGLE_instanced_arrays","vertexAttribDivisor","vertexAttribDivisorANGLE"),this.drawArraysInstanced=this.getExtension("ANGLE_instanced_arrays","drawArraysInstanced","drawArraysInstancedANGLE"),this.drawElementsInstanced=this.getExtension("ANGLE_instanced_arrays","drawElementsInstanced","drawElementsInstancedANGLE"),this.createVertexArray=this.getExtension("OES_vertex_array_object","createVertexArray","createVertexArrayOES"),this.bindVertexArray=this.getExtension("OES_vertex_array_object","bindVertexArray","bindVertexArrayOES"),this.deleteVertexArray=this.getExtension("OES_vertex_array_object","deleteVertexArray","deleteVertexArrayOES"),this.drawBuffers=this.getExtension("WEBGL_draw_buffers","drawBuffers","drawBuffersWEBGL"),this.parameters={},this.parameters.maxTextureUnits=this.gl.getParameter(this.gl.MAX_COMBINED_TEXTURE_IMAGE_UNITS),this.parameters.maxAnisotropy=this.getExtension("EXT_texture_filter_anisotropic")?this.gl.getParameter(this.getExtension("EXT_texture_filter_anisotropic").MAX_TEXTURE_MAX_ANISOTROPY_EXT):0}setSize(e,r){this.width=e,this.height=r,this.gl.canvas.width=e*this.dpr,this.gl.canvas.height=r*this.dpr,this.gl.canvas.style&&Object.assign(this.gl.canvas.style,{width:e+"px",height:r+"px"})}setViewport(e,r,n=0,s=0){this.state.viewport.width===e&&this.state.viewport.height===r||(this.state.viewport.width=e,this.state.viewport.height=r,this.state.viewport.x=n,this.state.viewport.y=s,this.gl.viewport(n,s,e,r))}setScissor(e,r,n=0,s=0){this.gl.scissor(n,s,e,r)}enable(e){this.state[e]!==!0&&(this.gl.enable(e),this.state[e]=!0)}disable(e){this.state[e]!==!1&&(this.gl.disable(e),this.state[e]=!1)}setBlendFunc(e,r,n,s){this.state.blendFunc.src===e&&this.state.blendFunc.dst===r&&this.state.blendFunc.srcAlpha===n&&this.state.blendFunc.dstAlpha===s||(this.state.blendFunc.src=e,this.state.blendFunc.dst=r,this.state.blendFunc.srcAlpha=n,this.state.blendFunc.dstAlpha=s,n!==void 0?this.gl.blendFuncSeparate(e,r,n,s):this.gl.blendFunc(e,r))}setBlendEquation(e,r){e=e||this.gl.FUNC_ADD,!(this.state.blendEquation.modeRGB===e&&this.state.blendEquation.modeAlpha===r)&&(this.state.blendEquation.modeRGB=e,this.state.blendEquation.modeAlpha=r,r!==void 0?this.gl.blendEquationSeparate(e,r):this.gl.blendEquation(e))}setCullFace(e){this.state.cullFace!==e&&(this.state.cullFace=e,this.gl.cullFace(e))}setFrontFace(e){this.state.frontFace!==e&&(this.state.frontFace=e,this.gl.frontFace(e))}setDepthMask(e){this.state.depthMask!==e&&(this.state.depthMask=e,this.gl.depthMask(e))}setDepthFunc(e){this.state.depthFunc!==e&&(this.state.depthFunc=e,this.gl.depthFunc(e))}setStencilMask(e){this.state.stencilMask!==e&&(this.state.stencilMask=e,this.gl.stencilMask(e))}setStencilFunc(e,r,n){this.state.stencilFunc===e&&this.state.stencilRef===r&&this.state.stencilFuncMask===n||(this.state.stencilFunc=e||this.gl.ALWAYS,this.state.stencilRef=r||0,this.state.stencilFuncMask=n||0,this.gl.stencilFunc(e||this.gl.ALWAYS,r||0,n||0))}setStencilOp(e,r,n){this.state.stencilFail===e&&this.state.stencilDepthFail===r&&this.state.stencilDepthPass===n||(this.state.stencilFail=e,this.state.stencilDepthFail=r,this.state.stencilDepthPass=n,this.gl.stencilOp(e,r,n))}activeTexture(e){this.state.activeTextureUnit!==e&&(this.state.activeTextureUnit=e,this.gl.activeTexture(this.gl.TEXTURE0+e))}bindFramebuffer({target:e=this.gl.FRAMEBUFFER,buffer:r=null}={}){this.state.framebuffer!==r&&(this.state.framebuffer=r,this.gl.bindFramebuffer(e,r))}getExtension(e,r,n){return r&&this.gl[r]?this.gl[r].bind(this.gl):(this.extensions[e]||(this.extensions[e]=this.gl.getExtension(e)),r?this.extensions[e]?this.extensions[e][n].bind(this.extensions[e]):null:this.extensions[e])}sortOpaque(e,r){return e.renderOrder!==r.renderOrder?e.renderOrder-r.renderOrder:e.program.id!==r.program.id?e.program.id-r.program.id:e.zDepth!==r.zDepth?e.zDepth-r.zDepth:r.id-e.id}sortTransparent(e,r){return e.renderOrder!==r.renderOrder?e.renderOrder-r.renderOrder:e.zDepth!==r.zDepth?r.zDepth-e.zDepth:r.id-e.id}sortUI(e,r){return e.renderOrder!==r.renderOrder?e.renderOrder-r.renderOrder:e.program.id!==r.program.id?e.program.id-r.program.id:r.id-e.id}getRenderList({scene:e,camera:r,frustumCull:n,sort:s}){let c=[];if(r&&n&&r.updateFrustum(),e.traverse(l=>{if(!l.visible)return!0;l.draw&&(n&&l.frustumCulled&&r&&!r.frustumIntersectsMesh(l)||c.push(l))}),s){const l=[],a=[],m=[];c.forEach(y=>{y.program.transparent?y.program.depthTest?a.push(y):m.push(y):l.push(y),y.zDepth=0,!(y.renderOrder!==0||!y.program.depthTest||!r)&&(y.worldMatrix.getTranslation(oS),oS.applyMatrix4(r.projectionViewMatrix),y.zDepth=oS.z)}),l.sort(this.sortOpaque),a.sort(this.sortTransparent),m.sort(this.sortUI),c=l.concat(a,m)}return c}render({scene:e,camera:r,target:n=null,update:s=!0,sort:c=!0,frustumCull:l=!0,clear:a}){n===null?(this.bindFramebuffer(),this.setViewport(this.width*this.dpr,this.height*this.dpr)):(this.bindFramebuffer(n),this.setViewport(n.width,n.height)),(a||this.autoClear&&a!==!1)&&(this.depth&&(!n||n.depth)&&(this.enable(this.gl.DEPTH_TEST),this.setDepthMask(!0)),(this.stencil||!n||n.stencil)&&(this.enable(this.gl.STENCIL_TEST),this.setStencilMask(255)),this.gl.clear((this.color?this.gl.COLOR_BUFFER_BIT:0)|(this.depth?this.gl.DEPTH_BUFFER_BIT:0)|(this.stencil?this.gl.STENCIL_BUFFER_BIT:0))),s&&e.updateMatrixWorld(),r&&r.updateMatrixWorld(),this.getRenderList({scene:e,camera:r,frustumCull:l,sort:c}).forEach(y=>{y.draw({camera:r})})}}function Nne(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t}function jne(t,e,r,n,s){return t[0]=e,t[1]=r,t[2]=n,t[3]=s,t}function Fne(t,e){let r=e[0],n=e[1],s=e[2],c=e[3],l=r*r+n*n+s*s+c*c;return l>0&&(l=1/Math.sqrt(l)),t[0]=r*l,t[1]=n*l,t[2]=s*l,t[3]=c*l,t}function Bne(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]+t[3]*e[3]}function $ne(t){return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t}function Vne(t,e,r){r=r*.5;let n=Math.sin(r);return t[0]=n*e[0],t[1]=n*e[1],t[2]=n*e[2],t[3]=Math.cos(r),t}function nL(t,e,r){let n=e[0],s=e[1],c=e[2],l=e[3],a=r[0],m=r[1],y=r[2],v=r[3];return t[0]=n*v+l*a+s*y-c*m,t[1]=s*v+l*m+c*a-n*y,t[2]=c*v+l*y+n*m-s*a,t[3]=l*v-n*a-s*m-c*y,t}function Une(t,e,r){r*=.5;let n=e[0],s=e[1],c=e[2],l=e[3],a=Math.sin(r),m=Math.cos(r);return t[0]=n*m+l*a,t[1]=s*m+c*a,t[2]=c*m-s*a,t[3]=l*m-n*a,t}function Gne(t,e,r){r*=.5;let n=e[0],s=e[1],c=e[2],l=e[3],a=Math.sin(r),m=Math.cos(r);return t[0]=n*m-c*a,t[1]=s*m+l*a,t[2]=c*m+n*a,t[3]=l*m-s*a,t}function Wne(t,e,r){r*=.5;let n=e[0],s=e[1],c=e[2],l=e[3],a=Math.sin(r),m=Math.cos(r);return t[0]=n*m+s*a,t[1]=s*m-n*a,t[2]=c*m+l*a,t[3]=l*m-c*a,t}function qne(t,e,r,n){let s=e[0],c=e[1],l=e[2],a=e[3],m=r[0],y=r[1],v=r[2],T=r[3],P,A,O,I,L;return A=s*m+c*y+l*v+a*T,A<0&&(A=-A,m=-m,y=-y,v=-v,T=-T),1-A>1e-6?(P=Math.acos(A),O=Math.sin(P),I=Math.sin((1-n)*P)/O,L=Math.sin(n*P)/O):(I=1-n,L=n),t[0]=I*s+L*m,t[1]=I*c+L*y,t[2]=I*l+L*v,t[3]=I*a+L*T,t}function Hne(t,e){let r=e[0],n=e[1],s=e[2],c=e[3],l=r*r+n*n+s*s+c*c,a=l?1/l:0;return t[0]=-r*a,t[1]=-n*a,t[2]=-s*a,t[3]=c*a,t}function Zne(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=e[3],t}function Kne(t,e){let r=e[0]+e[4]+e[8],n;if(r>0)n=Math.sqrt(r+1),t[3]=.5*n,n=.5/n,t[0]=(e[5]-e[7])*n,t[1]=(e[6]-e[2])*n,t[2]=(e[1]-e[3])*n;else{let s=0;e[4]>e[0]&&(s=1),e[8]>e[s*3+s]&&(s=2);let c=(s+1)%3,l=(s+2)%3;n=Math.sqrt(e[s*3+s]-e[c*3+c]-e[l*3+l]+1),t[s]=.5*n,n=.5/n,t[3]=(e[c*3+l]-e[l*3+c])*n,t[c]=(e[c*3+s]+e[s*3+c])*n,t[l]=(e[l*3+s]+e[s*3+l])*n}return t}function Xne(t,e,r="YXZ"){let n=Math.sin(e[0]*.5),s=Math.cos(e[0]*.5),c=Math.sin(e[1]*.5),l=Math.cos(e[1]*.5),a=Math.sin(e[2]*.5),m=Math.cos(e[2]*.5);return r==="XYZ"?(t[0]=n*l*m+s*c*a,t[1]=s*c*m-n*l*a,t[2]=s*l*a+n*c*m,t[3]=s*l*m-n*c*a):r==="YXZ"?(t[0]=n*l*m+s*c*a,t[1]=s*c*m-n*l*a,t[2]=s*l*a-n*c*m,t[3]=s*l*m+n*c*a):r==="ZXY"?(t[0]=n*l*m-s*c*a,t[1]=s*c*m+n*l*a,t[2]=s*l*a+n*c*m,t[3]=s*l*m-n*c*a):r==="ZYX"?(t[0]=n*l*m-s*c*a,t[1]=s*c*m+n*l*a,t[2]=s*l*a-n*c*m,t[3]=s*l*m+n*c*a):r==="YZX"?(t[0]=n*l*m+s*c*a,t[1]=s*c*m+n*l*a,t[2]=s*l*a-n*c*m,t[3]=s*l*m-n*c*a):r==="XZY"&&(t[0]=n*l*m-s*c*a,t[1]=s*c*m-n*l*a,t[2]=s*l*a+n*c*m,t[3]=s*l*m+n*c*a),t}const Yne=Nne,Qne=jne,Jne=Bne,eie=Fne;class tie extends Array{constructor(e=0,r=0,n=0,s=1){super(e,r,n,s),this.onChange=()=>{},this._target=this;const c=["0","1","2","3"];return new Proxy(this,{set(l,a){const m=Reflect.set(...arguments);return m&&c.includes(a)&&l.onChange(),m}})}get x(){return this[0]}get y(){return this[1]}get z(){return this[2]}get w(){return this[3]}set x(e){this._target[0]=e,this.onChange()}set y(e){this._target[1]=e,this.onChange()}set z(e){this._target[2]=e,this.onChange()}set w(e){this._target[3]=e,this.onChange()}identity(){return $ne(this._target),this.onChange(),this}set(e,r,n,s){return e.length?this.copy(e):(Qne(this._target,e,r,n,s),this.onChange(),this)}rotateX(e){return Une(this._target,this._target,e),this.onChange(),this}rotateY(e){return Gne(this._target,this._target,e),this.onChange(),this}rotateZ(e){return Wne(this._target,this._target,e),this.onChange(),this}inverse(e=this._target){return Hne(this._target,e),this.onChange(),this}conjugate(e=this._target){return Zne(this._target,e),this.onChange(),this}copy(e){return Yne(this._target,e),this.onChange(),this}normalize(e=this._target){return eie(this._target,e),this.onChange(),this}multiply(e,r){return r?nL(this._target,e,r):nL(this._target,this._target,e),this.onChange(),this}dot(e){return Jne(this._target,e)}fromMatrix3(e){return Kne(this._target,e),this.onChange(),this}fromEuler(e,r){return Xne(this._target,e,e.order),r||this.onChange(),this}fromAxisAngle(e,r){return Vne(this._target,e,r),this.onChange(),this}slerp(e,r){return qne(this._target,this._target,e,r),this.onChange(),this}fromArray(e,r=0){return this._target[0]=e[r],this._target[1]=e[r+1],this._target[2]=e[r+2],this._target[3]=e[r+3],this.onChange(),this}toArray(e=[],r=0){return e[r]=this[0],e[r+1]=this[1],e[r+2]=this[2],e[r+3]=this[3],e}}const rie=1e-6;function nie(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function iie(t,e,r,n,s,c,l,a,m,y,v,T,P,A,O,I,L){return t[0]=e,t[1]=r,t[2]=n,t[3]=s,t[4]=c,t[5]=l,t[6]=a,t[7]=m,t[8]=y,t[9]=v,t[10]=T,t[11]=P,t[12]=A,t[13]=O,t[14]=I,t[15]=L,t}function sie(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function oie(t,e){let r=e[0],n=e[1],s=e[2],c=e[3],l=e[4],a=e[5],m=e[6],y=e[7],v=e[8],T=e[9],P=e[10],A=e[11],O=e[12],I=e[13],L=e[14],R=e[15],z=r*a-n*l,j=r*m-s*l,W=r*y-c*l,Z=n*m-s*a,te=n*y-c*a,ie=s*y-c*m,V=v*I-T*O,q=v*L-P*O,Q=v*R-A*O,ce=T*L-P*I,se=T*R-A*I,ue=P*R-A*L,he=z*ue-j*se+W*ce+Z*Q-te*q+ie*V;return he?(he=1/he,t[0]=(a*ue-m*se+y*ce)*he,t[1]=(s*se-n*ue-c*ce)*he,t[2]=(I*ie-L*te+R*Z)*he,t[3]=(P*te-T*ie-A*Z)*he,t[4]=(m*Q-l*ue-y*q)*he,t[5]=(r*ue-s*Q+c*q)*he,t[6]=(L*W-O*ie-R*j)*he,t[7]=(v*ie-P*W+A*j)*he,t[8]=(l*se-a*Q+y*V)*he,t[9]=(n*Q-r*se-c*V)*he,t[10]=(O*te-I*W+R*z)*he,t[11]=(T*W-v*te-A*z)*he,t[12]=(a*q-l*ce-m*V)*he,t[13]=(r*ce-n*q+s*V)*he,t[14]=(I*j-O*Z-L*z)*he,t[15]=(v*Z-T*j+P*z)*he,t):null}function UF(t){let e=t[0],r=t[1],n=t[2],s=t[3],c=t[4],l=t[5],a=t[6],m=t[7],y=t[8],v=t[9],T=t[10],P=t[11],A=t[12],O=t[13],I=t[14],L=t[15],R=e*l-r*c,z=e*a-n*c,j=e*m-s*c,W=r*a-n*l,Z=r*m-s*l,te=n*m-s*a,ie=y*O-v*A,V=y*I-T*A,q=y*L-P*A,Q=v*I-T*O,ce=v*L-P*O,se=T*L-P*I;return R*se-z*ce+j*Q+W*q-Z*V+te*ie}function iL(t,e,r){let n=e[0],s=e[1],c=e[2],l=e[3],a=e[4],m=e[5],y=e[6],v=e[7],T=e[8],P=e[9],A=e[10],O=e[11],I=e[12],L=e[13],R=e[14],z=e[15],j=r[0],W=r[1],Z=r[2],te=r[3];return t[0]=j*n+W*a+Z*T+te*I,t[1]=j*s+W*m+Z*P+te*L,t[2]=j*c+W*y+Z*A+te*R,t[3]=j*l+W*v+Z*O+te*z,j=r[4],W=r[5],Z=r[6],te=r[7],t[4]=j*n+W*a+Z*T+te*I,t[5]=j*s+W*m+Z*P+te*L,t[6]=j*c+W*y+Z*A+te*R,t[7]=j*l+W*v+Z*O+te*z,j=r[8],W=r[9],Z=r[10],te=r[11],t[8]=j*n+W*a+Z*T+te*I,t[9]=j*s+W*m+Z*P+te*L,t[10]=j*c+W*y+Z*A+te*R,t[11]=j*l+W*v+Z*O+te*z,j=r[12],W=r[13],Z=r[14],te=r[15],t[12]=j*n+W*a+Z*T+te*I,t[13]=j*s+W*m+Z*P+te*L,t[14]=j*c+W*y+Z*A+te*R,t[15]=j*l+W*v+Z*O+te*z,t}function aie(t,e,r){let n=r[0],s=r[1],c=r[2],l,a,m,y,v,T,P,A,O,I,L,R;return e===t?(t[12]=e[0]*n+e[4]*s+e[8]*c+e[12],t[13]=e[1]*n+e[5]*s+e[9]*c+e[13],t[14]=e[2]*n+e[6]*s+e[10]*c+e[14],t[15]=e[3]*n+e[7]*s+e[11]*c+e[15]):(l=e[0],a=e[1],m=e[2],y=e[3],v=e[4],T=e[5],P=e[6],A=e[7],O=e[8],I=e[9],L=e[10],R=e[11],t[0]=l,t[1]=a,t[2]=m,t[3]=y,t[4]=v,t[5]=T,t[6]=P,t[7]=A,t[8]=O,t[9]=I,t[10]=L,t[11]=R,t[12]=l*n+v*s+O*c+e[12],t[13]=a*n+T*s+I*c+e[13],t[14]=m*n+P*s+L*c+e[14],t[15]=y*n+A*s+R*c+e[15]),t}function lie(t,e,r){let n=r[0],s=r[1],c=r[2];return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t[4]=e[4]*s,t[5]=e[5]*s,t[6]=e[6]*s,t[7]=e[7]*s,t[8]=e[8]*c,t[9]=e[9]*c,t[10]=e[10]*c,t[11]=e[11]*c,t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function cie(t,e,r,n){let s=n[0],c=n[1],l=n[2],a=Math.hypot(s,c,l),m,y,v,T,P,A,O,I,L,R,z,j,W,Z,te,ie,V,q,Q,ce,se,ue,he,ye;return Math.abs(a)<rie?null:(a=1/a,s*=a,c*=a,l*=a,m=Math.sin(r),y=Math.cos(r),v=1-y,T=e[0],P=e[1],A=e[2],O=e[3],I=e[4],L=e[5],R=e[6],z=e[7],j=e[8],W=e[9],Z=e[10],te=e[11],ie=s*s*v+y,V=c*s*v+l*m,q=l*s*v-c*m,Q=s*c*v-l*m,ce=c*c*v+y,se=l*c*v+s*m,ue=s*l*v+c*m,he=c*l*v-s*m,ye=l*l*v+y,t[0]=T*ie+I*V+j*q,t[1]=P*ie+L*V+W*q,t[2]=A*ie+R*V+Z*q,t[3]=O*ie+z*V+te*q,t[4]=T*Q+I*ce+j*se,t[5]=P*Q+L*ce+W*se,t[6]=A*Q+R*ce+Z*se,t[7]=O*Q+z*ce+te*se,t[8]=T*ue+I*he+j*ye,t[9]=P*ue+L*he+W*ye,t[10]=A*ue+R*he+Z*ye,t[11]=O*ue+z*he+te*ye,e!==t&&(t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t)}function uie(t,e){return t[0]=e[12],t[1]=e[13],t[2]=e[14],t}function GF(t,e){let r=e[0],n=e[1],s=e[2],c=e[4],l=e[5],a=e[6],m=e[8],y=e[9],v=e[10];return t[0]=Math.hypot(r,n,s),t[1]=Math.hypot(c,l,a),t[2]=Math.hypot(m,y,v),t}function hie(t){let e=t[0],r=t[1],n=t[2],s=t[4],c=t[5],l=t[6],a=t[8],m=t[9],y=t[10];const v=e*e+r*r+n*n,T=s*s+c*c+l*l,P=a*a+m*m+y*y;return Math.sqrt(Math.max(v,T,P))}const WF=function(){const t=[1,1,1];return function(e,r){let n=t;GF(n,r);let s=1/n[0],c=1/n[1],l=1/n[2],a=r[0]*s,m=r[1]*c,y=r[2]*l,v=r[4]*s,T=r[5]*c,P=r[6]*l,A=r[8]*s,O=r[9]*c,I=r[10]*l,L=a+T+I,R=0;return L>0?(R=Math.sqrt(L+1)*2,e[3]=.25*R,e[0]=(P-O)/R,e[1]=(A-y)/R,e[2]=(m-v)/R):a>T&&a>I?(R=Math.sqrt(1+a-T-I)*2,e[3]=(P-O)/R,e[0]=.25*R,e[1]=(m+v)/R,e[2]=(A+y)/R):T>I?(R=Math.sqrt(1+T-a-I)*2,e[3]=(A-y)/R,e[0]=(m+v)/R,e[1]=.25*R,e[2]=(P+O)/R):(R=Math.sqrt(1+I-a-T)*2,e[3]=(m-v)/R,e[0]=(A+y)/R,e[1]=(P+O)/R,e[2]=.25*R),e}}();function die(t,e,r,n){let s=Ly([t[0],t[1],t[2]]);const c=Ly([t[4],t[5],t[6]]),l=Ly([t[8],t[9],t[10]]);UF(t)<0&&(s=-s),r[0]=t[12],r[1]=t[13],r[2]=t[14];const m=t.slice(),y=1/s,v=1/c,T=1/l;m[0]*=y,m[1]*=y,m[2]*=y,m[4]*=v,m[5]*=v,m[6]*=v,m[8]*=T,m[9]*=T,m[10]*=T,WF(e,m),n[0]=s,n[1]=c,n[2]=l}function fie(t,e,r,n){const s=t,c=e[0],l=e[1],a=e[2],m=e[3],y=c+c,v=l+l,T=a+a,P=c*y,A=c*v,O=c*T,I=l*v,L=l*T,R=a*T,z=m*y,j=m*v,W=m*T,Z=n[0],te=n[1],ie=n[2];return s[0]=(1-(I+R))*Z,s[1]=(A+W)*Z,s[2]=(O-j)*Z,s[3]=0,s[4]=(A-W)*te,s[5]=(1-(P+R))*te,s[6]=(L+z)*te,s[7]=0,s[8]=(O+j)*ie,s[9]=(L-z)*ie,s[10]=(1-(P+I))*ie,s[11]=0,s[12]=r[0],s[13]=r[1],s[14]=r[2],s[15]=1,s}function pie(t,e){let r=e[0],n=e[1],s=e[2],c=e[3],l=r+r,a=n+n,m=s+s,y=r*l,v=n*l,T=n*a,P=s*l,A=s*a,O=s*m,I=c*l,L=c*a,R=c*m;return t[0]=1-T-O,t[1]=v+R,t[2]=P-L,t[3]=0,t[4]=v-R,t[5]=1-y-O,t[6]=A+I,t[7]=0,t[8]=P+L,t[9]=A-I,t[10]=1-y-T,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function mie(t,e,r,n,s){let c=1/Math.tan(e/2),l=1/(n-s);return t[0]=c/r,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=c,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=(s+n)*l,t[11]=-1,t[12]=0,t[13]=0,t[14]=2*s*n*l,t[15]=0,t}function gie(t,e,r,n,s,c,l){let a=1/(e-r),m=1/(n-s),y=1/(c-l);return t[0]=-2*a,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*m,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*y,t[11]=0,t[12]=(e+r)*a,t[13]=(s+n)*m,t[14]=(l+c)*y,t[15]=1,t}function yie(t,e,r,n){let s=e[0],c=e[1],l=e[2],a=n[0],m=n[1],y=n[2],v=s-r[0],T=c-r[1],P=l-r[2],A=v*v+T*T+P*P;A===0?P=1:(A=1/Math.sqrt(A),v*=A,T*=A,P*=A);let O=m*P-y*T,I=y*v-a*P,L=a*T-m*v;return A=O*O+I*I+L*L,A===0&&(y?a+=1e-6:m?y+=1e-6:m+=1e-6,O=m*P-y*T,I=y*v-a*P,L=a*T-m*v,A=O*O+I*I+L*L),A=1/Math.sqrt(A),O*=A,I*=A,L*=A,t[0]=O,t[1]=I,t[2]=L,t[3]=0,t[4]=T*L-P*I,t[5]=P*O-v*L,t[6]=v*I-T*O,t[7]=0,t[8]=v,t[9]=T,t[10]=P,t[11]=0,t[12]=s,t[13]=c,t[14]=l,t[15]=1,t}function sL(t,e,r){return t[0]=e[0]+r[0],t[1]=e[1]+r[1],t[2]=e[2]+r[2],t[3]=e[3]+r[3],t[4]=e[4]+r[4],t[5]=e[5]+r[5],t[6]=e[6]+r[6],t[7]=e[7]+r[7],t[8]=e[8]+r[8],t[9]=e[9]+r[9],t[10]=e[10]+r[10],t[11]=e[11]+r[11],t[12]=e[12]+r[12],t[13]=e[13]+r[13],t[14]=e[14]+r[14],t[15]=e[15]+r[15],t}function oL(t,e,r){return t[0]=e[0]-r[0],t[1]=e[1]-r[1],t[2]=e[2]-r[2],t[3]=e[3]-r[3],t[4]=e[4]-r[4],t[5]=e[5]-r[5],t[6]=e[6]-r[6],t[7]=e[7]-r[7],t[8]=e[8]-r[8],t[9]=e[9]-r[9],t[10]=e[10]-r[10],t[11]=e[11]-r[11],t[12]=e[12]-r[12],t[13]=e[13]-r[13],t[14]=e[14]-r[14],t[15]=e[15]-r[15],t}function _ie(t,e,r){return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t[4]=e[4]*r,t[5]=e[5]*r,t[6]=e[6]*r,t[7]=e[7]*r,t[8]=e[8]*r,t[9]=e[9]*r,t[10]=e[10]*r,t[11]=e[11]*r,t[12]=e[12]*r,t[13]=e[13]*r,t[14]=e[14]*r,t[15]=e[15]*r,t}class bb extends Array{constructor(e=1,r=0,n=0,s=0,c=0,l=1,a=0,m=0,y=0,v=0,T=1,P=0,A=0,O=0,I=0,L=1){return super(e,r,n,s,c,l,a,m,y,v,T,P,A,O,I,L),this}get x(){return this[12]}get y(){return this[13]}get z(){return this[14]}get w(){return this[15]}set x(e){this[12]=e}set y(e){this[13]=e}set z(e){this[14]=e}set w(e){this[15]=e}set(e,r,n,s,c,l,a,m,y,v,T,P,A,O,I,L){return e.length?this.copy(e):(iie(this,e,r,n,s,c,l,a,m,y,v,T,P,A,O,I,L),this)}translate(e,r=this){return aie(this,r,e),this}rotate(e,r,n=this){return cie(this,n,e,r),this}scale(e,r=this){return lie(this,r,typeof e=="number"?[e,e,e]:e),this}add(e,r){return r?sL(this,e,r):sL(this,this,e),this}sub(e,r){return r?oL(this,e,r):oL(this,this,e),this}multiply(e,r){return e.length?r?iL(this,e,r):iL(this,this,e):_ie(this,this,e),this}identity(){return sie(this),this}copy(e){return nie(this,e),this}fromPerspective({fov:e,aspect:r,near:n,far:s}={}){return mie(this,e,r,n,s),this}fromOrthogonal({left:e,right:r,bottom:n,top:s,near:c,far:l}){return gie(this,e,r,n,s,c,l),this}fromQuaternion(e){return pie(this,e),this}setPosition(e){return this.x=e[0],this.y=e[1],this.z=e[2],this}inverse(e=this){return oie(this,e),this}compose(e,r,n){return fie(this,e,r,n),this}decompose(e,r,n){return die(this,e,r,n),this}getRotation(e){return WF(e,this),this}getTranslation(e){return uie(e,this),this}getScaling(e){return GF(e,this),this}getMaxScaleOnAxis(){return hie(this)}lookAt(e,r,n){return yie(this,e,r,n),this}determinant(){return UF(this)}fromArray(e,r=0){return this[0]=e[r],this[1]=e[r+1],this[2]=e[r+2],this[3]=e[r+3],this[4]=e[r+4],this[5]=e[r+5],this[6]=e[r+6],this[7]=e[r+7],this[8]=e[r+8],this[9]=e[r+9],this[10]=e[r+10],this[11]=e[r+11],this[12]=e[r+12],this[13]=e[r+13],this[14]=e[r+14],this[15]=e[r+15],this}toArray(e=[],r=0){return e[r]=this[0],e[r+1]=this[1],e[r+2]=this[2],e[r+3]=this[3],e[r+4]=this[4],e[r+5]=this[5],e[r+6]=this[6],e[r+7]=this[7],e[r+8]=this[8],e[r+9]=this[9],e[r+10]=this[10],e[r+11]=this[11],e[r+12]=this[12],e[r+13]=this[13],e[r+14]=this[14],e[r+15]=this[15],e}}function vie(t,e,r="YXZ"){return r==="XYZ"?(t[1]=Math.asin(Math.min(Math.max(e[8],-1),1)),Math.abs(e[8])<.99999?(t[0]=Math.atan2(-e[9],e[10]),t[2]=Math.atan2(-e[4],e[0])):(t[0]=Math.atan2(e[6],e[5]),t[2]=0)):r==="YXZ"?(t[0]=Math.asin(-Math.min(Math.max(e[9],-1),1)),Math.abs(e[9])<.99999?(t[1]=Math.atan2(e[8],e[10]),t[2]=Math.atan2(e[1],e[5])):(t[1]=Math.atan2(-e[2],e[0]),t[2]=0)):r==="ZXY"?(t[0]=Math.asin(Math.min(Math.max(e[6],-1),1)),Math.abs(e[6])<.99999?(t[1]=Math.atan2(-e[2],e[10]),t[2]=Math.atan2(-e[4],e[5])):(t[1]=0,t[2]=Math.atan2(e[1],e[0]))):r==="ZYX"?(t[1]=Math.asin(-Math.min(Math.max(e[2],-1),1)),Math.abs(e[2])<.99999?(t[0]=Math.atan2(e[6],e[10]),t[2]=Math.atan2(e[1],e[0])):(t[0]=0,t[2]=Math.atan2(-e[4],e[5]))):r==="YZX"?(t[2]=Math.asin(Math.min(Math.max(e[1],-1),1)),Math.abs(e[1])<.99999?(t[0]=Math.atan2(-e[9],e[5]),t[1]=Math.atan2(-e[2],e[0])):(t[0]=0,t[1]=Math.atan2(e[8],e[10]))):r==="XZY"&&(t[2]=Math.asin(-Math.min(Math.max(e[4],-1),1)),Math.abs(e[4])<.99999?(t[0]=Math.atan2(e[6],e[5]),t[1]=Math.atan2(e[8],e[0])):(t[0]=Math.atan2(-e[9],e[10]),t[1]=0)),t}const aL=new bb;class xie extends Array{constructor(e=0,r=e,n=e,s="YXZ"){super(e,r,n),this.order=s,this.onChange=()=>{},this._target=this;const c=["0","1","2"];return new Proxy(this,{set(l,a){const m=Reflect.set(...arguments);return m&&c.includes(a)&&l.onChange(),m}})}get x(){return this[0]}get y(){return this[1]}get z(){return this[2]}set x(e){this._target[0]=e,this.onChange()}set y(e){this._target[1]=e,this.onChange()}set z(e){this._target[2]=e,this.onChange()}set(e,r=e,n=e){return e.length?this.copy(e):(this._target[0]=e,this._target[1]=r,this._target[2]=n,this.onChange(),this)}copy(e){return this._target[0]=e[0],this._target[1]=e[1],this._target[2]=e[2],this.onChange(),this}reorder(e){return this._target.order=e,this.onChange(),this}fromRotationMatrix(e,r=this.order){return vie(this._target,e,r),this.onChange(),this}fromQuaternion(e,r=this.order,n){return aL.fromQuaternion(e),this._target.fromRotationMatrix(aL,r),n||this.onChange(),this}fromArray(e,r=0){return this._target[0]=e[r],this._target[1]=e[r+1],this._target[2]=e[r+2],this}toArray(e=[],r=0){return e[r]=this[0],e[r+1]=this[1],e[r+2]=this[2],e}}class bie{constructor(){this.parent=null,this.children=[],this.visible=!0,this.matrix=new bb,this.worldMatrix=new bb,this.matrixAutoUpdate=!0,this.worldMatrixNeedsUpdate=!1,this.position=new Sa,this.quaternion=new tie,this.scale=new Sa(1),this.rotation=new xie,this.up=new Sa(0,1,0),this.rotation._target.onChange=()=>this.quaternion.fromEuler(this.rotation,!0),this.quaternion._target.onChange=()=>this.rotation.fromQuaternion(this.quaternion,void 0,!0)}setParent(e,r=!0){this.parent&&e!==this.parent&&this.parent.removeChild(this,!1),this.parent=e,r&&e&&e.addChild(this,!1)}addChild(e,r=!0){~this.children.indexOf(e)||this.children.push(e),r&&e.setParent(this,!1)}removeChild(e,r=!0){~this.children.indexOf(e)&&this.children.splice(this.children.indexOf(e),1),r&&e.setParent(null,!1)}updateMatrixWorld(e){this.matrixAutoUpdate&&this.updateMatrix(),(this.worldMatrixNeedsUpdate||e)&&(this.parent===null?this.worldMatrix.copy(this.matrix):this.worldMatrix.multiply(this.parent.worldMatrix,this.matrix),this.worldMatrixNeedsUpdate=!1,e=!0);for(let r=0,n=this.children.length;r<n;r++)this.children[r].updateMatrixWorld(e)}updateMatrix(){this.matrix.compose(this.quaternion,this.position,this.scale),this.worldMatrixNeedsUpdate=!0}traverse(e){if(!e(this))for(let r=0,n=this.children.length;r<n;r++)this.children[r].traverse(e)}decompose(){this.matrix.decompose(this.quaternion._target,this.position,this.scale),this.rotation.fromQuaternion(this.quaternion)}lookAt(e,r=!1){r?this.matrix.lookAt(this.position,e,this.up):this.matrix.lookAt(e,this.position,this.up),this.matrix.getRotation(this.quaternion._target),this.rotation.fromQuaternion(this.quaternion)}}function wie(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[4],t[4]=e[5],t[5]=e[6],t[6]=e[8],t[7]=e[9],t[8]=e[10],t}function Sie(t,e){let r=e[0],n=e[1],s=e[2],c=e[3],l=r+r,a=n+n,m=s+s,y=r*l,v=n*l,T=n*a,P=s*l,A=s*a,O=s*m,I=c*l,L=c*a,R=c*m;return t[0]=1-T-O,t[3]=v-R,t[6]=P+L,t[1]=v+R,t[4]=1-y-O,t[7]=A-I,t[2]=P-L,t[5]=A+I,t[8]=1-y-T,t}function Tie(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t}function Eie(t,e,r,n,s,c,l,a,m,y){return t[0]=e,t[1]=r,t[2]=n,t[3]=s,t[4]=c,t[5]=l,t[6]=a,t[7]=m,t[8]=y,t}function Cie(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t}function Pie(t,e){let r=e[0],n=e[1],s=e[2],c=e[3],l=e[4],a=e[5],m=e[6],y=e[7],v=e[8],T=v*l-a*y,P=-v*c+a*m,A=y*c-l*m,O=r*T+n*P+s*A;return O?(O=1/O,t[0]=T*O,t[1]=(-v*n+s*y)*O,t[2]=(a*n-s*l)*O,t[3]=P*O,t[4]=(v*r-s*m)*O,t[5]=(-a*r+s*c)*O,t[6]=A*O,t[7]=(-y*r+n*m)*O,t[8]=(l*r-n*c)*O,t):null}function lL(t,e,r){let n=e[0],s=e[1],c=e[2],l=e[3],a=e[4],m=e[5],y=e[6],v=e[7],T=e[8],P=r[0],A=r[1],O=r[2],I=r[3],L=r[4],R=r[5],z=r[6],j=r[7],W=r[8];return t[0]=P*n+A*l+O*y,t[1]=P*s+A*a+O*v,t[2]=P*c+A*m+O*T,t[3]=I*n+L*l+R*y,t[4]=I*s+L*a+R*v,t[5]=I*c+L*m+R*T,t[6]=z*n+j*l+W*y,t[7]=z*s+j*a+W*v,t[8]=z*c+j*m+W*T,t}function Aie(t,e,r){let n=e[0],s=e[1],c=e[2],l=e[3],a=e[4],m=e[5],y=e[6],v=e[7],T=e[8],P=r[0],A=r[1];return t[0]=n,t[1]=s,t[2]=c,t[3]=l,t[4]=a,t[5]=m,t[6]=P*n+A*l+y,t[7]=P*s+A*a+v,t[8]=P*c+A*m+T,t}function kie(t,e,r){let n=e[0],s=e[1],c=e[2],l=e[3],a=e[4],m=e[5],y=e[6],v=e[7],T=e[8],P=Math.sin(r),A=Math.cos(r);return t[0]=A*n+P*l,t[1]=A*s+P*a,t[2]=A*c+P*m,t[3]=A*l-P*n,t[4]=A*a-P*s,t[5]=A*m-P*c,t[6]=y,t[7]=v,t[8]=T,t}function Mie(t,e,r){let n=r[0],s=r[1];return t[0]=n*e[0],t[1]=n*e[1],t[2]=n*e[2],t[3]=s*e[3],t[4]=s*e[4],t[5]=s*e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t}function Iie(t,e){let r=e[0],n=e[1],s=e[2],c=e[3],l=e[4],a=e[5],m=e[6],y=e[7],v=e[8],T=e[9],P=e[10],A=e[11],O=e[12],I=e[13],L=e[14],R=e[15],z=r*a-n*l,j=r*m-s*l,W=r*y-c*l,Z=n*m-s*a,te=n*y-c*a,ie=s*y-c*m,V=v*I-T*O,q=v*L-P*O,Q=v*R-A*O,ce=T*L-P*I,se=T*R-A*I,ue=P*R-A*L,he=z*ue-j*se+W*ce+Z*Q-te*q+ie*V;return he?(he=1/he,t[0]=(a*ue-m*se+y*ce)*he,t[1]=(m*Q-l*ue-y*q)*he,t[2]=(l*se-a*Q+y*V)*he,t[3]=(s*se-n*ue-c*ce)*he,t[4]=(r*ue-s*Q+c*q)*he,t[5]=(n*Q-r*se-c*V)*he,t[6]=(I*ie-L*te+R*Z)*he,t[7]=(L*W-O*ie-R*j)*he,t[8]=(O*te-I*W+R*z)*he,t):null}class Rie extends Array{constructor(e=1,r=0,n=0,s=0,c=1,l=0,a=0,m=0,y=1){return super(e,r,n,s,c,l,a,m,y),this}set(e,r,n,s,c,l,a,m,y){return e.length?this.copy(e):(Eie(this,e,r,n,s,c,l,a,m,y),this)}translate(e,r=this){return Aie(this,r,e),this}rotate(e,r=this){return kie(this,r,e),this}scale(e,r=this){return Mie(this,r,e),this}multiply(e,r){return r?lL(this,e,r):lL(this,this,e),this}identity(){return Cie(this),this}copy(e){return Tie(this,e),this}fromMatrix4(e){return wie(this,e),this}fromQuaternion(e){return Sie(this,e),this}fromBasis(e,r,n){return this.set(e[0],e[1],e[2],r[0],r[1],r[2],n[0],n[1],n[2]),this}inverse(e=this){return Pie(this,e),this}getNormalMatrix(e){return Iie(this,e),this}}let Die=0;class Lie extends bie{constructor(e,{geometry:r,program:n,mode:s=e.TRIANGLES,frustumCulled:c=!0,renderOrder:l=0}={}){super(),e.canvas||console.error("gl not passed as first argument to Mesh"),this.gl=e,this.id=Die++,this.geometry=r,this.program=n,this.mode=s,this.frustumCulled=c,this.renderOrder=l,this.modelViewMatrix=new bb,this.normalMatrix=new Rie,this.beforeRenderCallbacks=[],this.afterRenderCallbacks=[]}onBeforeRender(e){return this.beforeRenderCallbacks.push(e),this}onAfterRender(e){return this.afterRenderCallbacks.push(e),this}draw({camera:e}={}){e&&(this.program.uniforms.modelMatrix||Object.assign(this.program.uniforms,{modelMatrix:{value:null},viewMatrix:{value:null},modelViewMatrix:{value:null},normalMatrix:{value:null},projectionMatrix:{value:null},cameraPosition:{value:null}}),this.program.uniforms.projectionMatrix.value=e.projectionMatrix,this.program.uniforms.cameraPosition.value=e.worldPosition,this.program.uniforms.viewMatrix.value=e.viewMatrix,this.modelViewMatrix.multiply(e.viewMatrix,this.worldMatrix),this.normalMatrix.getNormalMatrix(this.modelViewMatrix),this.program.uniforms.modelMatrix.value=this.worldMatrix,this.program.uniforms.modelViewMatrix.value=this.modelViewMatrix,this.program.uniforms.normalMatrix.value=this.normalMatrix),this.beforeRenderCallbacks.forEach(n=>n&&n({mesh:this,camera:e}));let r=this.program.cullFace&&this.worldMatrix.determinant()<0;this.program.use({flipFaces:r}),this.geometry.draw({mode:this.mode,program:this.program}),this.afterRenderCallbacks.forEach(n=>n&&n({mesh:this,camera:e}))}}const cL={black:"#000000",white:"#ffffff",red:"#ff0000",green:"#00ff00",blue:"#0000ff",fuchsia:"#ff00ff",cyan:"#00ffff",yellow:"#ffff00",orange:"#ff8000"};function uL(t){t.length===4&&(t=t[0]+t[1]+t[1]+t[2]+t[2]+t[3]+t[3]);const e=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(t);return e||console.warn(`Unable to convert hex string ${t} to rgb values`),[parseInt(e[1],16)/255,parseInt(e[2],16)/255,parseInt(e[3],16)/255]}function Oie(t){return t=parseInt(t),[(t>>16&255)/255,(t>>8&255)/255,(t&255)/255]}function hL(t){return t===void 0?[0,0,0]:arguments.length===3?arguments:isNaN(t)?t[0]==="#"?uL(t):cL[t.toLowerCase()]?uL(cL[t.toLowerCase()]):(console.warn("Color format not recognised"),[0,0,0]):Oie(t)}class dL extends Array{constructor(e){return Array.isArray(e)?super(...e):super(...hL(...arguments))}get r(){return this[0]}get g(){return this[1]}get b(){return this[2]}set r(e){this[0]=e}set g(e){this[1]=e}set b(e){this[2]=e}set(e){return Array.isArray(e)?this.copy(e):this.copy(hL(...arguments))}copy(e){return this[0]=e[0],this[1]=e[1],this[2]=e[2],this}}class zie extends kne{constructor(e,{attributes:r={}}={}){Object.assign(r,{position:{size:2,data:new Float32Array([-1,-1,3,-1,-1,3])},uv:{size:2,data:new Float32Array([0,0,2,0,0,2])}}),super(e,r)}}const Nie=`
attribute vec2 uv;
attribute vec2 position;

varying vec2 vUv;

void main() {
  vUv = uv;
  gl_Position = vec4(position, 0, 1);
}
`,jie=`
precision highp float;

uniform float uTime;
uniform vec3 uResolution;
uniform vec2 uFocal;
uniform vec2 uRotation;
uniform float uStarSpeed;
uniform float uDensity;
uniform float uHueShift;
uniform float uSpeed;
uniform vec2 uMouse;
uniform float uGlowIntensity;
uniform float uSaturation;
uniform bool uMouseRepulsion;
uniform float uTwinkleIntensity;
uniform float uRotationSpeed;
uniform float uRepulsionStrength;
uniform float uMouseActiveFactor;
uniform float uAutoCenterRepulsion;
uniform bool uTransparent;

varying vec2 vUv;

#define NUM_LAYER 4.0
#define STAR_COLOR_CUTOFF 0.2
#define MAT45 mat2(0.7071, -0.7071, 0.7071, 0.7071)
#define PERIOD 3.0

float Hash21(vec2 p) {
  p = fract(p * vec2(123.34, 456.21));
  p += dot(p, p + 45.32);
  return fract(p.x * p.y);
}

float tri(float x) {
  return abs(fract(x) * 2.0 - 1.0);
}

float tris(float x) {
  float t = fract(x);
  return 1.0 - smoothstep(0.0, 1.0, abs(2.0 * t - 1.0));
}

float trisn(float x) {
  float t = fract(x);
  return 2.0 * (1.0 - smoothstep(0.0, 1.0, abs(2.0 * t - 1.0))) - 1.0;
}

vec3 hsv2rgb(vec3 c) {
  vec4 K = vec4(1.0, 2.0 / 3.0, 1.0 / 3.0, 3.0);
  vec3 p = abs(fract(c.xxx + K.xyz) * 6.0 - K.www);
  return c.z * mix(K.xxx, clamp(p - K.xxx, 0.0, 1.0), c.y);
}

float Star(vec2 uv, float flare) {
  float d = length(uv);
  float m = (0.05 * uGlowIntensity) / d;
  float rays = smoothstep(0.0, 1.0, 1.0 - abs(uv.x * uv.y * 1000.0));
  m += rays * flare * uGlowIntensity;
  uv *= MAT45;
  rays = smoothstep(0.0, 1.0, 1.0 - abs(uv.x * uv.y * 1000.0));
  m += rays * 0.3 * flare * uGlowIntensity;
  m *= smoothstep(1.0, 0.2, d);
  return m;
}

vec3 StarLayer(vec2 uv) {
  vec3 col = vec3(0.0);

  vec2 gv = fract(uv) - 0.5; 
  vec2 id = floor(uv);

  for (int y = -1; y <= 1; y++) {
    for (int x = -1; x <= 1; x++) {
      vec2 offset = vec2(float(x), float(y));
      vec2 si = id + vec2(float(x), float(y));
      float seed = Hash21(si);
      float size = fract(seed * 345.32);
      float glossLocal = tri(uStarSpeed / (PERIOD * seed + 1.0));
      float flareSize = smoothstep(0.9, 1.0, size) * glossLocal;

      float red = smoothstep(STAR_COLOR_CUTOFF, 1.0, Hash21(si + 1.0)) + STAR_COLOR_CUTOFF;
      float blu = smoothstep(STAR_COLOR_CUTOFF, 1.0, Hash21(si + 3.0)) + STAR_COLOR_CUTOFF;
      float grn = min(red, blu) * seed;
      vec3 base = vec3(red, grn, blu);
      
      float hue = atan(base.g - base.r, base.b - base.r) / (2.0 * 3.14159) + 0.5;
      hue = fract(hue + uHueShift / 360.0);
      float sat = length(base - vec3(dot(base, vec3(0.299, 0.587, 0.114)))) * uSaturation;
      float val = max(max(base.r, base.g), base.b);
      base = hsv2rgb(vec3(hue, sat, val));

      vec2 pad = vec2(tris(seed * 34.0 + uTime * uSpeed / 10.0), tris(seed * 38.0 + uTime * uSpeed / 30.0)) - 0.5;

      float star = Star(gv - offset - pad, flareSize);
      vec3 color = base;

      float twinkle = trisn(uTime * uSpeed + seed * 6.2831) * 0.5 + 1.0;
      twinkle = mix(1.0, twinkle, uTwinkleIntensity);
      star *= twinkle;
      
      col += star * size * color;
    }
  }

  return col;
}

void main() {
  vec2 focalPx = uFocal * uResolution.xy;
  vec2 uv = (vUv * uResolution.xy - focalPx) / uResolution.y;

  vec2 mouseNorm = uMouse - vec2(0.5);
  
  if (uAutoCenterRepulsion > 0.0) {
    vec2 centerUV = vec2(0.0, 0.0);
    float centerDist = length(uv - centerUV);
    vec2 repulsion = normalize(uv - centerUV) * (uAutoCenterRepulsion / (centerDist + 0.1));
    uv += repulsion * 0.05;
  } else if (uMouseRepulsion) {
    vec2 mousePosUV = (uMouse * uResolution.xy - focalPx) / uResolution.y;
    float mouseDist = length(uv - mousePosUV);
    vec2 repulsion = normalize(uv - mousePosUV) * (uRepulsionStrength / (mouseDist + 0.1));
    uv += repulsion * 0.05 * uMouseActiveFactor;
  } else {
    vec2 mouseOffset = mouseNorm * 0.1 * uMouseActiveFactor;
    uv += mouseOffset;
  }

  float autoRotAngle = uTime * uRotationSpeed;
  mat2 autoRot = mat2(cos(autoRotAngle), -sin(autoRotAngle), sin(autoRotAngle), cos(autoRotAngle));
  uv = autoRot * uv;

  uv = mat2(uRotation.x, -uRotation.y, uRotation.y, uRotation.x) * uv;

  vec3 col = vec3(0.0);

  for (float i = 0.0; i < 1.0; i += 1.0 / NUM_LAYER) {
    float depth = fract(i + uStarSpeed * uSpeed);
    float scale = mix(20.0 * uDensity, 0.5 * uDensity, depth);
    float fade = depth * smoothstep(1.0, 0.9, depth);
    col += StarLayer(uv * scale + i * 453.32) * fade;
  }

  if (uTransparent) {
    float alpha = length(col);
    alpha = smoothstep(0.0, 0.3, alpha);
    alpha = min(alpha, 1.0);
    gl_FragColor = vec4(col, alpha);
  } else {
    gl_FragColor = vec4(col, 1.0);
  }
}
`;function Fie({focal:t=[.5,.5],rotation:e=[1,0],starSpeed:r=.5,density:n=1,hueShift:s=0,disableAnimation:c=!1,speed:l=1,mouseInteraction:a=!0,glowIntensity:m=.3,saturation:y=0,mouseRepulsion:v=!0,repulsionStrength:T=.5,twinkleIntensity:P=.3,rotationSpeed:A=.1,autoCenterRepulsion:O=0,transparent:I=!0,...L}){const R=X.useRef(null),z=X.useRef({x:.5,y:.5}),j=X.useRef({x:.5,y:.5}),W=X.useRef(0),Z=X.useRef(0);return X.useEffect(()=>{if(!R.current)return;const te=R.current,ie=new zne({alpha:I,premultipliedAlpha:!1}),V=ie.gl;I?(V.enable(V.BLEND),V.blendFunc(V.SRC_ALPHA,V.ONE_MINUS_SRC_ALPHA),V.clearColor(0,0,0,0)):V.clearColor(0,0,0,1);let q;function Q(){ie.setSize(te.offsetWidth*1,te.offsetHeight*1),q&&(q.uniforms.uResolution.value=new dL(V.canvas.width,V.canvas.height,V.canvas.width/V.canvas.height))}window.addEventListener("resize",Q,!1),Q();const ce=new zie(V);q=new Ine(V,{vertex:Nie,fragment:jie,uniforms:{uTime:{value:0},uResolution:{value:new dL(V.canvas.width,V.canvas.height,V.canvas.width/V.canvas.height)},uFocal:{value:new Float32Array(t)},uRotation:{value:new Float32Array(e)},uStarSpeed:{value:r},uDensity:{value:n},uHueShift:{value:s},uSpeed:{value:l},uMouse:{value:new Float32Array([j.current.x,j.current.y])},uGlowIntensity:{value:m},uSaturation:{value:y},uMouseRepulsion:{value:v},uTwinkleIntensity:{value:P},uRotationSpeed:{value:A},uRepulsionStrength:{value:T},uMouseActiveFactor:{value:0},uAutoCenterRepulsion:{value:O},uTransparent:{value:I}}});const se=new Lie(V,{geometry:ce,program:q});let ue;function he(Se){ue=requestAnimationFrame(he),c||(q.uniforms.uTime.value=Se*.001,q.uniforms.uStarSpeed.value=Se*.001*r/10);const fe=.05;j.current.x+=(z.current.x-j.current.x)*fe,j.current.y+=(z.current.y-j.current.y)*fe,Z.current+=(W.current-Z.current)*fe,q.uniforms.uMouse.value[0]=j.current.x,q.uniforms.uMouse.value[1]=j.current.y,q.uniforms.uMouseActiveFactor.value=Z.current,ie.render({scene:se})}ue=requestAnimationFrame(he),te.appendChild(V.canvas);function ye(Se){const fe=te.getBoundingClientRect(),ve=(Se.clientX-fe.left)/fe.width,Re=1-(Se.clientY-fe.top)/fe.height;z.current={x:ve,y:Re},W.current=1}function xe(){W.current=0}return a&&(te.addEventListener("mousemove",ye),te.addEventListener("mouseleave",xe)),()=>{var Se;cancelAnimationFrame(ue),window.removeEventListener("resize",Q),a&&(te.removeEventListener("mousemove",ye),te.removeEventListener("mouseleave",xe)),te.removeChild(V.canvas),(Se=V.getExtension("WEBGL_lose_context"))==null||Se.loseContext()}},[t,e,r,n,s,c,l,a,m,y,v,P,A,T,O,I]),B.jsx("div",{ref:R,className:"galaxy-container",...L})}function Wl(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function qF(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t,t.__proto__=e}/*!
 * GSAP 3.13.0
 * https://gsap.com
 *
 * @license Copyright 2008-2025, GreenSock. All rights reserved.
 * Subject to the terms at https://gsap.com/standard-license
 * @author: Jack Doyle, jack@greensock.com
*/var Co={autoSleep:120,force3D:"auto",nullTargetWarn:1,units:{lineHeight:""}},sm={duration:.5,overwrite:!1,delay:0},JP,es,bn,Ko=1e8,Qr=1/Ko,bE=Math.PI*2,Bie=bE/4,$ie=0,HF=Math.sqrt,Vie=Math.cos,Uie=Math.sin,Fi=function(e){return typeof e=="string"},Un=function(e){return typeof e=="function"},ac=function(e){return typeof e=="number"},eA=function(e){return typeof e>"u"},yl=function(e){return typeof e=="object"},Ys=function(e){return e!==!1},tA=function(){return typeof window<"u"},Xv=function(e){return Un(e)||Fi(e)},ZF=typeof ArrayBuffer=="function"&&ArrayBuffer.isView||function(){},fs=Array.isArray,wE=/(?:-?\.?\d|\.)+/gi,KF=/[-+=.]*\d+[.e\-+]*\d*[e\-+]*\d*/g,xp=/[-+=.]*\d+[.e-]*\d*[a-z%]*/g,aS=/[-+=.]*\d+\.?\d*(?:e-|e\+)?\d*/gi,XF=/[+-]=-?[.\d]+/,YF=/[^,'"\[\]\s]+/gi,Gie=/^[+\-=e\s\d]*\d+[.\d]*([a-z]*|%)\s*$/i,In,Qa,SE,rA,ko={},wb={},QF,JF=function(e){return(wb=om(e,ko))&&no},nA=function(e,r){return console.warn("Invalid property",e,"set to",r,"Missing plugin? gsap.registerPlugin()")},_0=function(e,r){return!r&&console.warn(e)},eB=function(e,r){return e&&(ko[e]=r)&&wb&&(wb[e]=r)||ko},v0=function(){return 0},Wie={suppressEvents:!0,isStart:!0,kill:!1},Cx={suppressEvents:!0,kill:!1},qie={suppressEvents:!0},iA={},Tu=[],TE={},tB,_o={},lS={},fL=30,Px=[],sA="",oA=function(e){var r=e[0],n,s;if(yl(r)||Un(r)||(e=[e]),!(n=(r._gsap||{}).harness)){for(s=Px.length;s--&&!Px[s].targetTest(r););n=Px[s]}for(s=e.length;s--;)e[s]&&(e[s]._gsap||(e[s]._gsap=new EB(e[s],n)))||e.splice(s,1);return e},fd=function(e){return e._gsap||oA(Xo(e))[0]._gsap},rB=function(e,r,n){return(n=e[r])&&Un(n)?e[r]():eA(n)&&e.getAttribute&&e.getAttribute(r)||n},Qs=function(e,r){return(e=e.split(",")).forEach(r)||e},Jn=function(e){return Math.round(e*1e5)/1e5||0},yi=function(e){return Math.round(e*1e7)/1e7||0},Op=function(e,r){var n=r.charAt(0),s=parseFloat(r.substr(2));return e=parseFloat(e),n==="+"?e+s:n==="-"?e-s:n==="*"?e*s:e/s},Hie=function(e,r){for(var n=r.length,s=0;e.indexOf(r[s])<0&&++s<n;);return s<n},Sb=function(){var e=Tu.length,r=Tu.slice(0),n,s;for(TE={},Tu.length=0,n=0;n<e;n++)s=r[n],s&&s._lazy&&(s.render(s._lazy[0],s._lazy[1],!0)._lazy=0)},aA=function(e){return!!(e._initted||e._startAt||e.add)},nB=function(e,r,n,s){Tu.length&&!es&&Sb(),e.render(r,n,!!(es&&r<0&&aA(e))),Tu.length&&!es&&Sb()},iB=function(e){var r=parseFloat(e);return(r||r===0)&&(e+"").match(YF).length<2?r:Fi(e)?e.trim():e},sB=function(e){return e},Mo=function(e,r){for(var n in r)n in e||(e[n]=r[n]);return e},Zie=function(e){return function(r,n){for(var s in n)s in r||s==="duration"&&e||s==="ease"||(r[s]=n[s])}},om=function(e,r){for(var n in r)e[n]=r[n];return e},pL=function t(e,r){for(var n in r)n!=="__proto__"&&n!=="constructor"&&n!=="prototype"&&(e[n]=yl(r[n])?t(e[n]||(e[n]={}),r[n]):r[n]);return e},Tb=function(e,r){var n={},s;for(s in e)s in r||(n[s]=e[s]);return n},Oy=function(e){var r=e.parent||In,n=e.keyframes?Zie(fs(e.keyframes)):Mo;if(Ys(e.inherit))for(;r;)n(e,r.vars.defaults),r=r.parent||r._dp;return e},Kie=function(e,r){for(var n=e.length,s=n===r.length;s&&n--&&e[n]===r[n];);return n<0},oB=function(e,r,n,s,c){var l=e[s],a;if(c)for(a=r[c];l&&l[c]>a;)l=l._prev;return l?(r._next=l._next,l._next=r):(r._next=e[n],e[n]=r),r._next?r._next._prev=r:e[s]=r,r._prev=l,r.parent=r._dp=e,r},E1=function(e,r,n,s){n===void 0&&(n="_first"),s===void 0&&(s="_last");var c=r._prev,l=r._next;c?c._next=l:e[n]===r&&(e[n]=l),l?l._prev=c:e[s]===r&&(e[s]=c),r._next=r._prev=r.parent=null},Ru=function(e,r){e.parent&&(!r||e.parent.autoRemoveChildren)&&e.parent.remove&&e.parent.remove(e),e._act=0},pd=function(e,r){if(e&&(!r||r._end>e._dur||r._start<0))for(var n=e;n;)n._dirty=1,n=n.parent;return e},Xie=function(e){for(var r=e.parent;r&&r.parent;)r._dirty=1,r.totalDuration(),r=r.parent;return e},EE=function(e,r,n,s){return e._startAt&&(es?e._startAt.revert(Cx):e.vars.immediateRender&&!e.vars.autoRevert||e._startAt.render(r,!0,s))},Yie=function t(e){return!e||e._ts&&t(e.parent)},mL=function(e){return e._repeat?am(e._tTime,e=e.duration()+e._rDelay)*e:0},am=function(e,r){var n=Math.floor(e=yi(e/r));return e&&n===e?n-1:n},Eb=function(e,r){return(e-r._start)*r._ts+(r._ts>=0?0:r._dirty?r.totalDuration():r._tDur)},C1=function(e){return e._end=yi(e._start+(e._tDur/Math.abs(e._ts||e._rts||Qr)||0))},P1=function(e,r){var n=e._dp;return n&&n.smoothChildTiming&&e._ts&&(e._start=yi(n._time-(e._ts>0?r/e._ts:((e._dirty?e.totalDuration():e._tDur)-r)/-e._ts)),C1(e),n._dirty||pd(n,e)),e},aB=function(e,r){var n;if((r._time||!r._dur&&r._initted||r._start<e._time&&(r._dur||!r.add))&&(n=Eb(e.rawTime(),r),(!r._dur||Q0(0,r.totalDuration(),n)-r._tTime>Qr)&&r.render(n,!0)),pd(e,r)._dp&&e._initted&&e._time>=e._dur&&e._ts){if(e._dur<e.duration())for(n=e;n._dp;)n.rawTime()>=0&&n.totalTime(n._tTime),n=n._dp;e._zTime=-Qr}},sl=function(e,r,n,s){return r.parent&&Ru(r),r._start=yi((ac(n)?n:n||e!==In?Uo(e,n,r):e._time)+r._delay),r._end=yi(r._start+(r.totalDuration()/Math.abs(r.timeScale())||0)),oB(e,r,"_first","_last",e._sort?"_start":0),CE(r)||(e._recent=r),s||aB(e,r),e._ts<0&&P1(e,e._tTime),e},lB=function(e,r){return(ko.ScrollTrigger||nA("scrollTrigger",r))&&ko.ScrollTrigger.create(r,e)},cB=function(e,r,n,s,c){if(cA(e,r,c),!e._initted)return 1;if(!n&&e._pt&&!es&&(e._dur&&e.vars.lazy!==!1||!e._dur&&e.vars.lazy)&&tB!==bo.frame)return Tu.push(e),e._lazy=[c,s],1},Qie=function t(e){var r=e.parent;return r&&r._ts&&r._initted&&!r._lock&&(r.rawTime()<0||t(r))},CE=function(e){var r=e.data;return r==="isFromStart"||r==="isStart"},Jie=function(e,r,n,s){var c=e.ratio,l=r<0||!r&&(!e._start&&Qie(e)&&!(!e._initted&&CE(e))||(e._ts<0||e._dp._ts<0)&&!CE(e))?0:1,a=e._rDelay,m=0,y,v,T;if(a&&e._repeat&&(m=Q0(0,e._tDur,r),v=am(m,a),e._yoyo&&v&1&&(l=1-l),v!==am(e._tTime,a)&&(c=1-l,e.vars.repeatRefresh&&e._initted&&e.invalidate())),l!==c||es||s||e._zTime===Qr||!r&&e._zTime){if(!e._initted&&cB(e,r,s,n,m))return;for(T=e._zTime,e._zTime=r||(n?Qr:0),n||(n=r&&!T),e.ratio=l,e._from&&(l=1-l),e._time=0,e._tTime=m,y=e._pt;y;)y.r(l,y.d),y=y._next;r<0&&EE(e,r,n,!0),e._onUpdate&&!n&&So(e,"onUpdate"),m&&e._repeat&&!n&&e.parent&&So(e,"onRepeat"),(r>=e._tDur||r<0)&&e.ratio===l&&(l&&Ru(e,1),!n&&!es&&(So(e,l?"onComplete":"onReverseComplete",!0),e._prom&&e._prom()))}else e._zTime||(e._zTime=r)},ese=function(e,r,n){var s;if(n>r)for(s=e._first;s&&s._start<=n;){if(s.data==="isPause"&&s._start>r)return s;s=s._next}else for(s=e._last;s&&s._start>=n;){if(s.data==="isPause"&&s._start<r)return s;s=s._prev}},lm=function(e,r,n,s){var c=e._repeat,l=yi(r)||0,a=e._tTime/e._tDur;return a&&!s&&(e._time*=l/e._dur),e._dur=l,e._tDur=c?c<0?1e10:yi(l*(c+1)+e._rDelay*c):l,a>0&&!s&&P1(e,e._tTime=e._tDur*a),e.parent&&C1(e),n||pd(e.parent,e),e},gL=function(e){return e instanceof As?pd(e):lm(e,e._dur)},tse={_start:0,endTime:v0,totalDuration:v0},Uo=function t(e,r,n){var s=e.labels,c=e._recent||tse,l=e.duration()>=Ko?c.endTime(!1):e._dur,a,m,y;return Fi(r)&&(isNaN(r)||r in s)?(m=r.charAt(0),y=r.substr(-1)==="%",a=r.indexOf("="),m==="<"||m===">"?(a>=0&&(r=r.replace(/=/,"")),(m==="<"?c._start:c.endTime(c._repeat>=0))+(parseFloat(r.substr(1))||0)*(y?(a<0?c:n).totalDuration()/100:1)):a<0?(r in s||(s[r]=l),s[r]):(m=parseFloat(r.charAt(a-1)+r.substr(a+1)),y&&n&&(m=m/100*(fs(n)?n[0]:n).totalDuration()),a>1?t(e,r.substr(0,a-1),n)+m:l+m)):r==null?l:+r},zy=function(e,r,n){var s=ac(r[1]),c=(s?2:1)+(e<2?0:1),l=r[c],a,m;if(s&&(l.duration=r[1]),l.parent=n,e){for(a=l,m=n;m&&!("immediateRender"in a);)a=m.vars.defaults||{},m=Ys(m.vars.inherit)&&m.parent;l.immediateRender=Ys(a.immediateRender),e<2?l.runBackwards=1:l.startAt=r[c-1]}return new gi(r[0],l,r[c+1])},$u=function(e,r){return e||e===0?r(e):r},Q0=function(e,r,n){return n<e?e:n>r?r:n},us=function(e,r){return!Fi(e)||!(r=Gie.exec(e))?"":r[1]},rse=function(e,r,n){return $u(n,function(s){return Q0(e,r,s)})},PE=[].slice,uB=function(e,r){return e&&yl(e)&&"length"in e&&(!r&&!e.length||e.length-1 in e&&yl(e[0]))&&!e.nodeType&&e!==Qa},nse=function(e,r,n){return n===void 0&&(n=[]),e.forEach(function(s){var c;return Fi(s)&&!r||uB(s,1)?(c=n).push.apply(c,Xo(s)):n.push(s)})||n},Xo=function(e,r,n){return bn&&!r&&bn.selector?bn.selector(e):Fi(e)&&!n&&(SE||!cm())?PE.call((r||rA).querySelectorAll(e),0):fs(e)?nse(e,n):uB(e)?PE.call(e,0):e?[e]:[]},AE=function(e){return e=Xo(e)[0]||_0("Invalid scope")||{},function(r){var n=e.current||e.nativeElement||e;return Xo(r,n.querySelectorAll?n:n===e?_0("Invalid scope")||rA.createElement("div"):e)}},hB=function(e){return e.sort(function(){return .5-Math.random()})},dB=function(e){if(Un(e))return e;var r=yl(e)?e:{each:e},n=md(r.ease),s=r.from||0,c=parseFloat(r.base)||0,l={},a=s>0&&s<1,m=isNaN(s)||a,y=r.axis,v=s,T=s;return Fi(s)?v=T={center:.5,edges:.5,end:1}[s]||0:!a&&m&&(v=s[0],T=s[1]),function(P,A,O){var I=(O||r).length,L=l[I],R,z,j,W,Z,te,ie,V,q;if(!L){if(q=r.grid==="auto"?0:(r.grid||[1,Ko])[1],!q){for(ie=-Ko;ie<(ie=O[q++].getBoundingClientRect().left)&&q<I;);q<I&&q--}for(L=l[I]=[],R=m?Math.min(q,I)*v-.5:s%q,z=q===Ko?0:m?I*T/q-.5:s/q|0,ie=0,V=Ko,te=0;te<I;te++)j=te%q-R,W=z-(te/q|0),L[te]=Z=y?Math.abs(y==="y"?W:j):HF(j*j+W*W),Z>ie&&(ie=Z),Z<V&&(V=Z);s==="random"&&hB(L),L.max=ie-V,L.min=V,L.v=I=(parseFloat(r.amount)||parseFloat(r.each)*(q>I?I-1:y?y==="y"?I/q:q:Math.max(q,I/q))||0)*(s==="edges"?-1:1),L.b=I<0?c-I:c,L.u=us(r.amount||r.each)||0,n=n&&I<0?wB(n):n}return I=(L[P]-L.min)/L.max||0,yi(L.b+(n?n(I):I)*L.v)+L.u}},kE=function(e){var r=Math.pow(10,((e+"").split(".")[1]||"").length);return function(n){var s=yi(Math.round(parseFloat(n)/e)*e*r);return(s-s%1)/r+(ac(n)?0:us(n))}},fB=function(e,r){var n=fs(e),s,c;return!n&&yl(e)&&(s=n=e.radius||Ko,e.values?(e=Xo(e.values),(c=!ac(e[0]))&&(s*=s)):e=kE(e.increment)),$u(r,n?Un(e)?function(l){return c=e(l),Math.abs(c-l)<=s?c:l}:function(l){for(var a=parseFloat(c?l.x:l),m=parseFloat(c?l.y:0),y=Ko,v=0,T=e.length,P,A;T--;)c?(P=e[T].x-a,A=e[T].y-m,P=P*P+A*A):P=Math.abs(e[T]-a),P<y&&(y=P,v=T);return v=!s||y<=s?e[v]:l,c||v===l||ac(l)?v:v+us(l)}:kE(e))},pB=function(e,r,n,s){return $u(fs(e)?!r:n===!0?!!(n=0):!s,function(){return fs(e)?e[~~(Math.random()*e.length)]:(n=n||1e-5)&&(s=n<1?Math.pow(10,(n+"").length-2):1)&&Math.floor(Math.round((e-n/2+Math.random()*(r-e+n*.99))/n)*n*s)/s})},ise=function(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return function(s){return r.reduce(function(c,l){return l(c)},s)}},sse=function(e,r){return function(n){return e(parseFloat(n))+(r||us(n))}},ose=function(e,r,n){return gB(e,r,0,1,n)},mB=function(e,r,n){return $u(n,function(s){return e[~~r(s)]})},ase=function t(e,r,n){var s=r-e;return fs(e)?mB(e,t(0,e.length),r):$u(n,function(c){return(s+(c-e)%s)%s+e})},lse=function t(e,r,n){var s=r-e,c=s*2;return fs(e)?mB(e,t(0,e.length-1),r):$u(n,function(l){return l=(c+(l-e)%c)%c||0,e+(l>s?c-l:l)})},x0=function(e){for(var r=0,n="",s,c,l,a;~(s=e.indexOf("random(",r));)l=e.indexOf(")",s),a=e.charAt(s+7)==="[",c=e.substr(s+7,l-s-7).match(a?YF:wE),n+=e.substr(r,s-r)+pB(a?c:+c[0],a?0:+c[1],+c[2]||1e-5),r=l+1;return n+e.substr(r,e.length-r)},gB=function(e,r,n,s,c){var l=r-e,a=s-n;return $u(c,function(m){return n+((m-e)/l*a||0)})},cse=function t(e,r,n,s){var c=isNaN(e+r)?0:function(A){return(1-A)*e+A*r};if(!c){var l=Fi(e),a={},m,y,v,T,P;if(n===!0&&(s=1)&&(n=null),l)e={p:e},r={p:r};else if(fs(e)&&!fs(r)){for(v=[],T=e.length,P=T-2,y=1;y<T;y++)v.push(t(e[y-1],e[y]));T--,c=function(O){O*=T;var I=Math.min(P,~~O);return v[I](O-I)},n=r}else s||(e=om(fs(e)?[]:{},e));if(!v){for(m in r)lA.call(a,e,m,"get",r[m]);c=function(O){return dA(O,a)||(l?e.p:e)}}}return $u(n,c)},yL=function(e,r,n){var s=e.labels,c=Ko,l,a,m;for(l in s)a=s[l]-r,a<0==!!n&&a&&c>(a=Math.abs(a))&&(m=l,c=a);return m},So=function(e,r,n){var s=e.vars,c=s[r],l=bn,a=e._ctx,m,y,v;if(c)return m=s[r+"Params"],y=s.callbackScope||e,n&&Tu.length&&Sb(),a&&(bn=a),v=m?c.apply(y,m):c.call(y),bn=l,v},oy=function(e){return Ru(e),e.scrollTrigger&&e.scrollTrigger.kill(!!es),e.progress()<1&&So(e,"onInterrupt"),e},bp,yB=[],_B=function(e){if(e)if(e=!e.name&&e.default||e,tA()||e.headless){var r=e.name,n=Un(e),s=r&&!n&&e.init?function(){this._props=[]}:e,c={init:v0,render:dA,add:lA,kill:Ese,modifier:Tse,rawVars:0},l={targetTest:0,get:0,getSetter:hA,aliases:{},register:0};if(cm(),e!==s){if(_o[r])return;Mo(s,Mo(Tb(e,c),l)),om(s.prototype,om(c,Tb(e,l))),_o[s.prop=r]=s,e.targetTest&&(Px.push(s),iA[r]=1),r=(r==="css"?"CSS":r.charAt(0).toUpperCase()+r.substr(1))+"Plugin"}eB(r,s),e.register&&e.register(no,s,Js)}else yB.push(e)},Yr=255,ay={aqua:[0,Yr,Yr],lime:[0,Yr,0],silver:[192,192,192],black:[0,0,0],maroon:[128,0,0],teal:[0,128,128],blue:[0,0,Yr],navy:[0,0,128],white:[Yr,Yr,Yr],olive:[128,128,0],yellow:[Yr,Yr,0],orange:[Yr,165,0],gray:[128,128,128],purple:[128,0,128],green:[0,128,0],red:[Yr,0,0],pink:[Yr,192,203],cyan:[0,Yr,Yr],transparent:[Yr,Yr,Yr,0]},cS=function(e,r,n){return e+=e<0?1:e>1?-1:0,(e*6<1?r+(n-r)*e*6:e<.5?n:e*3<2?r+(n-r)*(2/3-e)*6:r)*Yr+.5|0},vB=function(e,r,n){var s=e?ac(e)?[e>>16,e>>8&Yr,e&Yr]:0:ay.black,c,l,a,m,y,v,T,P,A,O;if(!s){if(e.substr(-1)===","&&(e=e.substr(0,e.length-1)),ay[e])s=ay[e];else if(e.charAt(0)==="#"){if(e.length<6&&(c=e.charAt(1),l=e.charAt(2),a=e.charAt(3),e="#"+c+c+l+l+a+a+(e.length===5?e.charAt(4)+e.charAt(4):"")),e.length===9)return s=parseInt(e.substr(1,6),16),[s>>16,s>>8&Yr,s&Yr,parseInt(e.substr(7),16)/255];e=parseInt(e.substr(1),16),s=[e>>16,e>>8&Yr,e&Yr]}else if(e.substr(0,3)==="hsl"){if(s=O=e.match(wE),!r)m=+s[0]%360/360,y=+s[1]/100,v=+s[2]/100,l=v<=.5?v*(y+1):v+y-v*y,c=v*2-l,s.length>3&&(s[3]*=1),s[0]=cS(m+1/3,c,l),s[1]=cS(m,c,l),s[2]=cS(m-1/3,c,l);else if(~e.indexOf("="))return s=e.match(KF),n&&s.length<4&&(s[3]=1),s}else s=e.match(wE)||ay.transparent;s=s.map(Number)}return r&&!O&&(c=s[0]/Yr,l=s[1]/Yr,a=s[2]/Yr,T=Math.max(c,l,a),P=Math.min(c,l,a),v=(T+P)/2,T===P?m=y=0:(A=T-P,y=v>.5?A/(2-T-P):A/(T+P),m=T===c?(l-a)/A+(l<a?6:0):T===l?(a-c)/A+2:(c-l)/A+4,m*=60),s[0]=~~(m+.5),s[1]=~~(y*100+.5),s[2]=~~(v*100+.5)),n&&s.length<4&&(s[3]=1),s},xB=function(e){var r=[],n=[],s=-1;return e.split(Eu).forEach(function(c){var l=c.match(xp)||[];r.push.apply(r,l),n.push(s+=l.length+1)}),r.c=n,r},_L=function(e,r,n){var s="",c=(e+s).match(Eu),l=r?"hsla(":"rgba(",a=0,m,y,v,T;if(!c)return e;if(c=c.map(function(P){return(P=vB(P,r,1))&&l+(r?P[0]+","+P[1]+"%,"+P[2]+"%,"+P[3]:P.join(","))+")"}),n&&(v=xB(e),m=n.c,m.join(s)!==v.c.join(s)))for(y=e.replace(Eu,"1").split(xp),T=y.length-1;a<T;a++)s+=y[a]+(~m.indexOf(a)?c.shift()||l+"0,0,0,0)":(v.length?v:c.length?c:n).shift());if(!y)for(y=e.split(Eu),T=y.length-1;a<T;a++)s+=y[a]+c[a];return s+y[T]},Eu=function(){var t="(?:\\b(?:(?:rgb|rgba|hsl|hsla)\\(.+?\\))|\\B#(?:[0-9a-f]{3,4}){1,2}\\b",e;for(e in ay)t+="|"+e+"\\b";return new RegExp(t+")","gi")}(),use=/hsl[a]?\(/,bB=function(e){var r=e.join(" "),n;if(Eu.lastIndex=0,Eu.test(r))return n=use.test(r),e[1]=_L(e[1],n),e[0]=_L(e[0],n,xB(e[1])),!0},b0,bo=function(){var t=Date.now,e=500,r=33,n=t(),s=n,c=1e3/240,l=c,a=[],m,y,v,T,P,A,O=function I(L){var R=t()-s,z=L===!0,j,W,Z,te;if((R>e||R<0)&&(n+=R-r),s+=R,Z=s-n,j=Z-l,(j>0||z)&&(te=++T.frame,P=Z-T.time*1e3,T.time=Z=Z/1e3,l+=j+(j>=c?4:c-j),W=1),z||(m=y(I)),W)for(A=0;A<a.length;A++)a[A](Z,P,te,L)};return T={time:0,frame:0,tick:function(){O(!0)},deltaRatio:function(L){return P/(1e3/(L||60))},wake:function(){QF&&(!SE&&tA()&&(Qa=SE=window,rA=Qa.document||{},ko.gsap=no,(Qa.gsapVersions||(Qa.gsapVersions=[])).push(no.version),JF(wb||Qa.GreenSockGlobals||!Qa.gsap&&Qa||{}),yB.forEach(_B)),v=typeof requestAnimationFrame<"u"&&requestAnimationFrame,m&&T.sleep(),y=v||function(L){return setTimeout(L,l-T.time*1e3+1|0)},b0=1,O(2))},sleep:function(){(v?cancelAnimationFrame:clearTimeout)(m),b0=0,y=v0},lagSmoothing:function(L,R){e=L||1/0,r=Math.min(R||33,e)},fps:function(L){c=1e3/(L||240),l=T.time*1e3+c},add:function(L,R,z){var j=R?function(W,Z,te,ie){L(W,Z,te,ie),T.remove(j)}:L;return T.remove(L),a[z?"unshift":"push"](j),cm(),j},remove:function(L,R){~(R=a.indexOf(L))&&a.splice(R,1)&&A>=R&&A--},_listeners:a},T}(),cm=function(){return!b0&&bo.wake()},Cr={},hse=/^[\d.\-M][\d.\-,\s]/,dse=/["']/g,fse=function(e){for(var r={},n=e.substr(1,e.length-3).split(":"),s=n[0],c=1,l=n.length,a,m,y;c<l;c++)m=n[c],a=c!==l-1?m.lastIndexOf(","):m.length,y=m.substr(0,a),r[s]=isNaN(y)?y.replace(dse,"").trim():+y,s=m.substr(a+1).trim();return r},pse=function(e){var r=e.indexOf("(")+1,n=e.indexOf(")"),s=e.indexOf("(",r);return e.substring(r,~s&&s<n?e.indexOf(")",n+1):n)},mse=function(e){var r=(e+"").split("("),n=Cr[r[0]];return n&&r.length>1&&n.config?n.config.apply(null,~e.indexOf("{")?[fse(r[1])]:pse(e).split(",").map(iB)):Cr._CE&&hse.test(e)?Cr._CE("",e):n},wB=function(e){return function(r){return 1-e(1-r)}},SB=function t(e,r){for(var n=e._first,s;n;)n instanceof As?t(n,r):n.vars.yoyoEase&&(!n._yoyo||!n._repeat)&&n._yoyo!==r&&(n.timeline?t(n.timeline,r):(s=n._ease,n._ease=n._yEase,n._yEase=s,n._yoyo=r)),n=n._next},md=function(e,r){return e&&(Un(e)?e:Cr[e]||mse(e))||r},Od=function(e,r,n,s){n===void 0&&(n=function(m){return 1-r(1-m)}),s===void 0&&(s=function(m){return m<.5?r(m*2)/2:1-r((1-m)*2)/2});var c={easeIn:r,easeOut:n,easeInOut:s},l;return Qs(e,function(a){Cr[a]=ko[a]=c,Cr[l=a.toLowerCase()]=n;for(var m in c)Cr[l+(m==="easeIn"?".in":m==="easeOut"?".out":".inOut")]=Cr[a+"."+m]=c[m]}),c},TB=function(e){return function(r){return r<.5?(1-e(1-r*2))/2:.5+e((r-.5)*2)/2}},uS=function t(e,r,n){var s=r>=1?r:1,c=(n||(e?.3:.45))/(r<1?r:1),l=c/bE*(Math.asin(1/s)||0),a=function(v){return v===1?1:s*Math.pow(2,-10*v)*Uie((v-l)*c)+1},m=e==="out"?a:e==="in"?function(y){return 1-a(1-y)}:TB(a);return c=bE/c,m.config=function(y,v){return t(e,y,v)},m},hS=function t(e,r){r===void 0&&(r=1.70158);var n=function(l){return l?--l*l*((r+1)*l+r)+1:0},s=e==="out"?n:e==="in"?function(c){return 1-n(1-c)}:TB(n);return s.config=function(c){return t(e,c)},s};Qs("Linear,Quad,Cubic,Quart,Quint,Strong",function(t,e){var r=e<5?e+1:e;Od(t+",Power"+(r-1),e?function(n){return Math.pow(n,r)}:function(n){return n},function(n){return 1-Math.pow(1-n,r)},function(n){return n<.5?Math.pow(n*2,r)/2:1-Math.pow((1-n)*2,r)/2})});Cr.Linear.easeNone=Cr.none=Cr.Linear.easeIn;Od("Elastic",uS("in"),uS("out"),uS());(function(t,e){var r=1/e,n=2*r,s=2.5*r,c=function(a){return a<r?t*a*a:a<n?t*Math.pow(a-1.5/e,2)+.75:a<s?t*(a-=2.25/e)*a+.9375:t*Math.pow(a-2.625/e,2)+.984375};Od("Bounce",function(l){return 1-c(1-l)},c)})(7.5625,2.75);Od("Expo",function(t){return Math.pow(2,10*(t-1))*t+t*t*t*t*t*t*(1-t)});Od("Circ",function(t){return-(HF(1-t*t)-1)});Od("Sine",function(t){return t===1?1:-Vie(t*Bie)+1});Od("Back",hS("in"),hS("out"),hS());Cr.SteppedEase=Cr.steps=ko.SteppedEase={config:function(e,r){e===void 0&&(e=1);var n=1/e,s=e+(r?0:1),c=r?1:0,l=1-Qr;return function(a){return((s*Q0(0,l,a)|0)+c)*n}}};sm.ease=Cr["quad.out"];Qs("onComplete,onUpdate,onStart,onRepeat,onReverseComplete,onInterrupt",function(t){return sA+=t+","+t+"Params,"});var EB=function(e,r){this.id=$ie++,e._gsap=this,this.target=e,this.harness=r,this.get=r?r.get:rB,this.set=r?r.getSetter:hA},w0=function(){function t(r){this.vars=r,this._delay=+r.delay||0,(this._repeat=r.repeat===1/0?-2:r.repeat||0)&&(this._rDelay=r.repeatDelay||0,this._yoyo=!!r.yoyo||!!r.yoyoEase),this._ts=1,lm(this,+r.duration,1,1),this.data=r.data,bn&&(this._ctx=bn,bn.data.push(this)),b0||bo.wake()}var e=t.prototype;return e.delay=function(n){return n||n===0?(this.parent&&this.parent.smoothChildTiming&&this.startTime(this._start+n-this._delay),this._delay=n,this):this._delay},e.duration=function(n){return arguments.length?this.totalDuration(this._repeat>0?n+(n+this._rDelay)*this._repeat:n):this.totalDuration()&&this._dur},e.totalDuration=function(n){return arguments.length?(this._dirty=0,lm(this,this._repeat<0?n:(n-this._repeat*this._rDelay)/(this._repeat+1))):this._tDur},e.totalTime=function(n,s){if(cm(),!arguments.length)return this._tTime;var c=this._dp;if(c&&c.smoothChildTiming&&this._ts){for(P1(this,n),!c._dp||c.parent||aB(c,this);c&&c.parent;)c.parent._time!==c._start+(c._ts>=0?c._tTime/c._ts:(c.totalDuration()-c._tTime)/-c._ts)&&c.totalTime(c._tTime,!0),c=c.parent;!this.parent&&this._dp.autoRemoveChildren&&(this._ts>0&&n<this._tDur||this._ts<0&&n>0||!this._tDur&&!n)&&sl(this._dp,this,this._start-this._delay)}return(this._tTime!==n||!this._dur&&!s||this._initted&&Math.abs(this._zTime)===Qr||!n&&!this._initted&&(this.add||this._ptLookup))&&(this._ts||(this._pTime=n),nB(this,n,s)),this},e.time=function(n,s){return arguments.length?this.totalTime(Math.min(this.totalDuration(),n+mL(this))%(this._dur+this._rDelay)||(n?this._dur:0),s):this._time},e.totalProgress=function(n,s){return arguments.length?this.totalTime(this.totalDuration()*n,s):this.totalDuration()?Math.min(1,this._tTime/this._tDur):this.rawTime()>=0&&this._initted?1:0},e.progress=function(n,s){return arguments.length?this.totalTime(this.duration()*(this._yoyo&&!(this.iteration()&1)?1-n:n)+mL(this),s):this.duration()?Math.min(1,this._time/this._dur):this.rawTime()>0?1:0},e.iteration=function(n,s){var c=this.duration()+this._rDelay;return arguments.length?this.totalTime(this._time+(n-1)*c,s):this._repeat?am(this._tTime,c)+1:1},e.timeScale=function(n,s){if(!arguments.length)return this._rts===-Qr?0:this._rts;if(this._rts===n)return this;var c=this.parent&&this._ts?Eb(this.parent._time,this):this._tTime;return this._rts=+n||0,this._ts=this._ps||n===-Qr?0:this._rts,this.totalTime(Q0(-Math.abs(this._delay),this.totalDuration(),c),s!==!1),C1(this),Xie(this)},e.paused=function(n){return arguments.length?(this._ps!==n&&(this._ps=n,n?(this._pTime=this._tTime||Math.max(-this._delay,this.rawTime()),this._ts=this._act=0):(cm(),this._ts=this._rts,this.totalTime(this.parent&&!this.parent.smoothChildTiming?this.rawTime():this._tTime||this._pTime,this.progress()===1&&Math.abs(this._zTime)!==Qr&&(this._tTime-=Qr)))),this):this._ps},e.startTime=function(n){if(arguments.length){this._start=n;var s=this.parent||this._dp;return s&&(s._sort||!this.parent)&&sl(s,this,n-this._delay),this}return this._start},e.endTime=function(n){return this._start+(Ys(n)?this.totalDuration():this.duration())/Math.abs(this._ts||1)},e.rawTime=function(n){var s=this.parent||this._dp;return s?n&&(!this._ts||this._repeat&&this._time&&this.totalProgress()<1)?this._tTime%(this._dur+this._rDelay):this._ts?Eb(s.rawTime(n),this):this._tTime:this._tTime},e.revert=function(n){n===void 0&&(n=qie);var s=es;return es=n,aA(this)&&(this.timeline&&this.timeline.revert(n),this.totalTime(-.01,n.suppressEvents)),this.data!=="nested"&&n.kill!==!1&&this.kill(),es=s,this},e.globalTime=function(n){for(var s=this,c=arguments.length?n:s.rawTime();s;)c=s._start+c/(Math.abs(s._ts)||1),s=s._dp;return!this.parent&&this._sat?this._sat.globalTime(n):c},e.repeat=function(n){return arguments.length?(this._repeat=n===1/0?-2:n,gL(this)):this._repeat===-2?1/0:this._repeat},e.repeatDelay=function(n){if(arguments.length){var s=this._time;return this._rDelay=n,gL(this),s?this.time(s):this}return this._rDelay},e.yoyo=function(n){return arguments.length?(this._yoyo=n,this):this._yoyo},e.seek=function(n,s){return this.totalTime(Uo(this,n),Ys(s))},e.restart=function(n,s){return this.play().totalTime(n?-this._delay:0,Ys(s)),this._dur||(this._zTime=-Qr),this},e.play=function(n,s){return n!=null&&this.seek(n,s),this.reversed(!1).paused(!1)},e.reverse=function(n,s){return n!=null&&this.seek(n||this.totalDuration(),s),this.reversed(!0).paused(!1)},e.pause=function(n,s){return n!=null&&this.seek(n,s),this.paused(!0)},e.resume=function(){return this.paused(!1)},e.reversed=function(n){return arguments.length?(!!n!==this.reversed()&&this.timeScale(-this._rts||(n?-Qr:0)),this):this._rts<0},e.invalidate=function(){return this._initted=this._act=0,this._zTime=-Qr,this},e.isActive=function(){var n=this.parent||this._dp,s=this._start,c;return!!(!n||this._ts&&this._initted&&n.isActive()&&(c=n.rawTime(!0))>=s&&c<this.endTime(!0)-Qr)},e.eventCallback=function(n,s,c){var l=this.vars;return arguments.length>1?(s?(l[n]=s,c&&(l[n+"Params"]=c),n==="onUpdate"&&(this._onUpdate=s)):delete l[n],this):l[n]},e.then=function(n){var s=this;return new Promise(function(c){var l=Un(n)?n:sB,a=function(){var y=s.then;s.then=null,Un(l)&&(l=l(s))&&(l.then||l===s)&&(s.then=y),c(l),s.then=y};s._initted&&s.totalProgress()===1&&s._ts>=0||!s._tTime&&s._ts<0?a():s._prom=a})},e.kill=function(){oy(this)},t}();Mo(w0.prototype,{_time:0,_start:0,_end:0,_tTime:0,_tDur:0,_dirty:0,_repeat:0,_yoyo:!1,parent:null,_initted:!1,_rDelay:0,_ts:1,_dp:0,ratio:0,_zTime:-Qr,_prom:0,_ps:!1,_rts:1});var As=function(t){qF(e,t);function e(n,s){var c;return n===void 0&&(n={}),c=t.call(this,n)||this,c.labels={},c.smoothChildTiming=!!n.smoothChildTiming,c.autoRemoveChildren=!!n.autoRemoveChildren,c._sort=Ys(n.sortChildren),In&&sl(n.parent||In,Wl(c),s),n.reversed&&c.reverse(),n.paused&&c.paused(!0),n.scrollTrigger&&lB(Wl(c),n.scrollTrigger),c}var r=e.prototype;return r.to=function(s,c,l){return zy(0,arguments,this),this},r.from=function(s,c,l){return zy(1,arguments,this),this},r.fromTo=function(s,c,l,a){return zy(2,arguments,this),this},r.set=function(s,c,l){return c.duration=0,c.parent=this,Oy(c).repeatDelay||(c.repeat=0),c.immediateRender=!!c.immediateRender,new gi(s,c,Uo(this,l),1),this},r.call=function(s,c,l){return sl(this,gi.delayedCall(0,s,c),l)},r.staggerTo=function(s,c,l,a,m,y,v){return l.duration=c,l.stagger=l.stagger||a,l.onComplete=y,l.onCompleteParams=v,l.parent=this,new gi(s,l,Uo(this,m)),this},r.staggerFrom=function(s,c,l,a,m,y,v){return l.runBackwards=1,Oy(l).immediateRender=Ys(l.immediateRender),this.staggerTo(s,c,l,a,m,y,v)},r.staggerFromTo=function(s,c,l,a,m,y,v,T){return a.startAt=l,Oy(a).immediateRender=Ys(a.immediateRender),this.staggerTo(s,c,a,m,y,v,T)},r.render=function(s,c,l){var a=this._time,m=this._dirty?this.totalDuration():this._tDur,y=this._dur,v=s<=0?0:yi(s),T=this._zTime<0!=s<0&&(this._initted||!y),P,A,O,I,L,R,z,j,W,Z,te,ie;if(this!==In&&v>m&&s>=0&&(v=m),v!==this._tTime||l||T){if(a!==this._time&&y&&(v+=this._time-a,s+=this._time-a),P=v,W=this._start,j=this._ts,R=!j,T&&(y||(a=this._zTime),(s||!c)&&(this._zTime=s)),this._repeat){if(te=this._yoyo,L=y+this._rDelay,this._repeat<-1&&s<0)return this.totalTime(L*100+s,c,l);if(P=yi(v%L),v===m?(I=this._repeat,P=y):(Z=yi(v/L),I=~~Z,I&&I===Z&&(P=y,I--),P>y&&(P=y)),Z=am(this._tTime,L),!a&&this._tTime&&Z!==I&&this._tTime-Z*L-this._dur<=0&&(Z=I),te&&I&1&&(P=y-P,ie=1),I!==Z&&!this._lock){var V=te&&Z&1,q=V===(te&&I&1);if(I<Z&&(V=!V),a=V?0:v%y?y:v,this._lock=1,this.render(a||(ie?0:yi(I*L)),c,!y)._lock=0,this._tTime=v,!c&&this.parent&&So(this,"onRepeat"),this.vars.repeatRefresh&&!ie&&(this.invalidate()._lock=1),a&&a!==this._time||R!==!this._ts||this.vars.onRepeat&&!this.parent&&!this._act)return this;if(y=this._dur,m=this._tDur,q&&(this._lock=2,a=V?y:-1e-4,this.render(a,!0),this.vars.repeatRefresh&&!ie&&this.invalidate()),this._lock=0,!this._ts&&!R)return this;SB(this,ie)}}if(this._hasPause&&!this._forcing&&this._lock<2&&(z=ese(this,yi(a),yi(P)),z&&(v-=P-(P=z._start))),this._tTime=v,this._time=P,this._act=!j,this._initted||(this._onUpdate=this.vars.onUpdate,this._initted=1,this._zTime=s,a=0),!a&&v&&!c&&!Z&&(So(this,"onStart"),this._tTime!==v))return this;if(P>=a&&s>=0)for(A=this._first;A;){if(O=A._next,(A._act||P>=A._start)&&A._ts&&z!==A){if(A.parent!==this)return this.render(s,c,l);if(A.render(A._ts>0?(P-A._start)*A._ts:(A._dirty?A.totalDuration():A._tDur)+(P-A._start)*A._ts,c,l),P!==this._time||!this._ts&&!R){z=0,O&&(v+=this._zTime=-Qr);break}}A=O}else{A=this._last;for(var Q=s<0?s:P;A;){if(O=A._prev,(A._act||Q<=A._end)&&A._ts&&z!==A){if(A.parent!==this)return this.render(s,c,l);if(A.render(A._ts>0?(Q-A._start)*A._ts:(A._dirty?A.totalDuration():A._tDur)+(Q-A._start)*A._ts,c,l||es&&aA(A)),P!==this._time||!this._ts&&!R){z=0,O&&(v+=this._zTime=Q?-Qr:Qr);break}}A=O}}if(z&&!c&&(this.pause(),z.render(P>=a?0:-Qr)._zTime=P>=a?1:-1,this._ts))return this._start=W,C1(this),this.render(s,c,l);this._onUpdate&&!c&&So(this,"onUpdate",!0),(v===m&&this._tTime>=this.totalDuration()||!v&&a)&&(W===this._start||Math.abs(j)!==Math.abs(this._ts))&&(this._lock||((s||!y)&&(v===m&&this._ts>0||!v&&this._ts<0)&&Ru(this,1),!c&&!(s<0&&!a)&&(v||a||!m)&&(So(this,v===m&&s>=0?"onComplete":"onReverseComplete",!0),this._prom&&!(v<m&&this.timeScale()>0)&&this._prom())))}return this},r.add=function(s,c){var l=this;if(ac(c)||(c=Uo(this,c,s)),!(s instanceof w0)){if(fs(s))return s.forEach(function(a){return l.add(a,c)}),this;if(Fi(s))return this.addLabel(s,c);if(Un(s))s=gi.delayedCall(0,s);else return this}return this!==s?sl(this,s,c):this},r.getChildren=function(s,c,l,a){s===void 0&&(s=!0),c===void 0&&(c=!0),l===void 0&&(l=!0),a===void 0&&(a=-Ko);for(var m=[],y=this._first;y;)y._start>=a&&(y instanceof gi?c&&m.push(y):(l&&m.push(y),s&&m.push.apply(m,y.getChildren(!0,c,l)))),y=y._next;return m},r.getById=function(s){for(var c=this.getChildren(1,1,1),l=c.length;l--;)if(c[l].vars.id===s)return c[l]},r.remove=function(s){return Fi(s)?this.removeLabel(s):Un(s)?this.killTweensOf(s):(s.parent===this&&E1(this,s),s===this._recent&&(this._recent=this._last),pd(this))},r.totalTime=function(s,c){return arguments.length?(this._forcing=1,!this._dp&&this._ts&&(this._start=yi(bo.time-(this._ts>0?s/this._ts:(this.totalDuration()-s)/-this._ts))),t.prototype.totalTime.call(this,s,c),this._forcing=0,this):this._tTime},r.addLabel=function(s,c){return this.labels[s]=Uo(this,c),this},r.removeLabel=function(s){return delete this.labels[s],this},r.addPause=function(s,c,l){var a=gi.delayedCall(0,c||v0,l);return a.data="isPause",this._hasPause=1,sl(this,a,Uo(this,s))},r.removePause=function(s){var c=this._first;for(s=Uo(this,s);c;)c._start===s&&c.data==="isPause"&&Ru(c),c=c._next},r.killTweensOf=function(s,c,l){for(var a=this.getTweensOf(s,l),m=a.length;m--;)du!==a[m]&&a[m].kill(s,c);return this},r.getTweensOf=function(s,c){for(var l=[],a=Xo(s),m=this._first,y=ac(c),v;m;)m instanceof gi?Hie(m._targets,a)&&(y?(!du||m._initted&&m._ts)&&m.globalTime(0)<=c&&m.globalTime(m.totalDuration())>c:!c||m.isActive())&&l.push(m):(v=m.getTweensOf(a,c)).length&&l.push.apply(l,v),m=m._next;return l},r.tweenTo=function(s,c){c=c||{};var l=this,a=Uo(l,s),m=c,y=m.startAt,v=m.onStart,T=m.onStartParams,P=m.immediateRender,A,O=gi.to(l,Mo({ease:c.ease||"none",lazy:!1,immediateRender:!1,time:a,overwrite:"auto",duration:c.duration||Math.abs((a-(y&&"time"in y?y.time:l._time))/l.timeScale())||Qr,onStart:function(){if(l.pause(),!A){var L=c.duration||Math.abs((a-(y&&"time"in y?y.time:l._time))/l.timeScale());O._dur!==L&&lm(O,L,0,1).render(O._time,!0,!0),A=1}v&&v.apply(O,T||[])}},c));return P?O.render(0):O},r.tweenFromTo=function(s,c,l){return this.tweenTo(c,Mo({startAt:{time:Uo(this,s)}},l))},r.recent=function(){return this._recent},r.nextLabel=function(s){return s===void 0&&(s=this._time),yL(this,Uo(this,s))},r.previousLabel=function(s){return s===void 0&&(s=this._time),yL(this,Uo(this,s),1)},r.currentLabel=function(s){return arguments.length?this.seek(s,!0):this.previousLabel(this._time+Qr)},r.shiftChildren=function(s,c,l){l===void 0&&(l=0);for(var a=this._first,m=this.labels,y;a;)a._start>=l&&(a._start+=s,a._end+=s),a=a._next;if(c)for(y in m)m[y]>=l&&(m[y]+=s);return pd(this)},r.invalidate=function(s){var c=this._first;for(this._lock=0;c;)c.invalidate(s),c=c._next;return t.prototype.invalidate.call(this,s)},r.clear=function(s){s===void 0&&(s=!0);for(var c=this._first,l;c;)l=c._next,this.remove(c),c=l;return this._dp&&(this._time=this._tTime=this._pTime=0),s&&(this.labels={}),pd(this)},r.totalDuration=function(s){var c=0,l=this,a=l._last,m=Ko,y,v,T;if(arguments.length)return l.timeScale((l._repeat<0?l.duration():l.totalDuration())/(l.reversed()?-s:s));if(l._dirty){for(T=l.parent;a;)y=a._prev,a._dirty&&a.totalDuration(),v=a._start,v>m&&l._sort&&a._ts&&!l._lock?(l._lock=1,sl(l,a,v-a._delay,1)._lock=0):m=v,v<0&&a._ts&&(c-=v,(!T&&!l._dp||T&&T.smoothChildTiming)&&(l._start+=v/l._ts,l._time-=v,l._tTime-=v),l.shiftChildren(-v,!1,-1/0),m=0),a._end>c&&a._ts&&(c=a._end),a=y;lm(l,l===In&&l._time>c?l._time:c,1,1),l._dirty=0}return l._tDur},e.updateRoot=function(s){if(In._ts&&(nB(In,Eb(s,In)),tB=bo.frame),bo.frame>=fL){fL+=Co.autoSleep||120;var c=In._first;if((!c||!c._ts)&&Co.autoSleep&&bo._listeners.length<2){for(;c&&!c._ts;)c=c._next;c||bo.sleep()}}},e}(w0);Mo(As.prototype,{_lock:0,_hasPause:0,_forcing:0});var gse=function(e,r,n,s,c,l,a){var m=new Js(this._pt,e,r,0,1,IB,null,c),y=0,v=0,T,P,A,O,I,L,R,z;for(m.b=n,m.e=s,n+="",s+="",(R=~s.indexOf("random("))&&(s=x0(s)),l&&(z=[n,s],l(z,e,r),n=z[0],s=z[1]),P=n.match(aS)||[];T=aS.exec(s);)O=T[0],I=s.substring(y,T.index),A?A=(A+1)%5:I.substr(-5)==="rgba("&&(A=1),O!==P[v++]&&(L=parseFloat(P[v-1])||0,m._pt={_next:m._pt,p:I||v===1?I:",",s:L,c:O.charAt(1)==="="?Op(L,O)-L:parseFloat(O)-L,m:A&&A<4?Math.round:0},y=aS.lastIndex);return m.c=y<s.length?s.substring(y,s.length):"",m.fp=a,(XF.test(s)||R)&&(m.e=0),this._pt=m,m},lA=function(e,r,n,s,c,l,a,m,y,v){Un(s)&&(s=s(c||0,e,l));var T=e[r],P=n!=="get"?n:Un(T)?y?e[r.indexOf("set")||!Un(e["get"+r.substr(3)])?r:"get"+r.substr(3)](y):e[r]():T,A=Un(T)?y?bse:kB:uA,O;if(Fi(s)&&(~s.indexOf("random(")&&(s=x0(s)),s.charAt(1)==="="&&(O=Op(P,s)+(us(P)||0),(O||O===0)&&(s=O))),!v||P!==s||ME)return!isNaN(P*s)&&s!==""?(O=new Js(this._pt,e,r,+P||0,s-(P||0),typeof T=="boolean"?Sse:MB,0,A),y&&(O.fp=y),a&&O.modifier(a,this,e),this._pt=O):(!T&&!(r in e)&&nA(r,s),gse.call(this,e,r,P,s,A,m||Co.stringFilter,y))},yse=function(e,r,n,s,c){if(Un(e)&&(e=Ny(e,c,r,n,s)),!yl(e)||e.style&&e.nodeType||fs(e)||ZF(e))return Fi(e)?Ny(e,c,r,n,s):e;var l={},a;for(a in e)l[a]=Ny(e[a],c,r,n,s);return l},CB=function(e,r,n,s,c,l){var a,m,y,v;if(_o[e]&&(a=new _o[e]).init(c,a.rawVars?r[e]:yse(r[e],s,c,l,n),n,s,l)!==!1&&(n._pt=m=new Js(n._pt,c,e,0,1,a.render,a,0,a.priority),n!==bp))for(y=n._ptLookup[n._targets.indexOf(c)],v=a._props.length;v--;)y[a._props[v]]=m;return a},du,ME,cA=function t(e,r,n){var s=e.vars,c=s.ease,l=s.startAt,a=s.immediateRender,m=s.lazy,y=s.onUpdate,v=s.runBackwards,T=s.yoyoEase,P=s.keyframes,A=s.autoRevert,O=e._dur,I=e._startAt,L=e._targets,R=e.parent,z=R&&R.data==="nested"?R.vars.targets:L,j=e._overwrite==="auto"&&!JP,W=e.timeline,Z,te,ie,V,q,Q,ce,se,ue,he,ye,xe,Se;if(W&&(!P||!c)&&(c="none"),e._ease=md(c,sm.ease),e._yEase=T?wB(md(T===!0?c:T,sm.ease)):0,T&&e._yoyo&&!e._repeat&&(T=e._yEase,e._yEase=e._ease,e._ease=T),e._from=!W&&!!s.runBackwards,!W||P&&!s.stagger){if(se=L[0]?fd(L[0]).harness:0,xe=se&&s[se.prop],Z=Tb(s,iA),I&&(I._zTime<0&&I.progress(1),r<0&&v&&a&&!A?I.render(-1,!0):I.revert(v&&O?Cx:Wie),I._lazy=0),l){if(Ru(e._startAt=gi.set(L,Mo({data:"isStart",overwrite:!1,parent:R,immediateRender:!0,lazy:!I&&Ys(m),startAt:null,delay:0,onUpdate:y&&function(){return So(e,"onUpdate")},stagger:0},l))),e._startAt._dp=0,e._startAt._sat=e,r<0&&(es||!a&&!A)&&e._startAt.revert(Cx),a&&O&&r<=0&&n<=0){r&&(e._zTime=r);return}}else if(v&&O&&!I){if(r&&(a=!1),ie=Mo({overwrite:!1,data:"isFromStart",lazy:a&&!I&&Ys(m),immediateRender:a,stagger:0,parent:R},Z),xe&&(ie[se.prop]=xe),Ru(e._startAt=gi.set(L,ie)),e._startAt._dp=0,e._startAt._sat=e,r<0&&(es?e._startAt.revert(Cx):e._startAt.render(-1,!0)),e._zTime=r,!a)t(e._startAt,Qr,Qr);else if(!r)return}for(e._pt=e._ptCache=0,m=O&&Ys(m)||m&&!O,te=0;te<L.length;te++){if(q=L[te],ce=q._gsap||oA(L)[te]._gsap,e._ptLookup[te]=he={},TE[ce.id]&&Tu.length&&Sb(),ye=z===L?te:z.indexOf(q),se&&(ue=new se).init(q,xe||Z,e,ye,z)!==!1&&(e._pt=V=new Js(e._pt,q,ue.name,0,1,ue.render,ue,0,ue.priority),ue._props.forEach(function(fe){he[fe]=V}),ue.priority&&(Q=1)),!se||xe)for(ie in Z)_o[ie]&&(ue=CB(ie,Z,e,ye,q,z))?ue.priority&&(Q=1):he[ie]=V=lA.call(e,q,ie,"get",Z[ie],ye,z,0,s.stringFilter);e._op&&e._op[te]&&e.kill(q,e._op[te]),j&&e._pt&&(du=e,In.killTweensOf(q,he,e.globalTime(r)),Se=!e.parent,du=0),e._pt&&m&&(TE[ce.id]=1)}Q&&RB(e),e._onInit&&e._onInit(e)}e._onUpdate=y,e._initted=(!e._op||e._pt)&&!Se,P&&r<=0&&W.render(Ko,!0,!0)},_se=function(e,r,n,s,c,l,a,m){var y=(e._pt&&e._ptCache||(e._ptCache={}))[r],v,T,P,A;if(!y)for(y=e._ptCache[r]=[],P=e._ptLookup,A=e._targets.length;A--;){if(v=P[A][r],v&&v.d&&v.d._pt)for(v=v.d._pt;v&&v.p!==r&&v.fp!==r;)v=v._next;if(!v)return ME=1,e.vars[r]="+=0",cA(e,a),ME=0,m?_0(r+" not eligible for reset"):1;y.push(v)}for(A=y.length;A--;)T=y[A],v=T._pt||T,v.s=(s||s===0)&&!c?s:v.s+(s||0)+l*v.c,v.c=n-v.s,T.e&&(T.e=Jn(n)+us(T.e)),T.b&&(T.b=v.s+us(T.b))},vse=function(e,r){var n=e[0]?fd(e[0]).harness:0,s=n&&n.aliases,c,l,a,m;if(!s)return r;c=om({},r);for(l in s)if(l in c)for(m=s[l].split(","),a=m.length;a--;)c[m[a]]=c[l];return c},xse=function(e,r,n,s){var c=r.ease||s||"power1.inOut",l,a;if(fs(r))a=n[e]||(n[e]=[]),r.forEach(function(m,y){return a.push({t:y/(r.length-1)*100,v:m,e:c})});else for(l in r)a=n[l]||(n[l]=[]),l==="ease"||a.push({t:parseFloat(e),v:r[l],e:c})},Ny=function(e,r,n,s,c){return Un(e)?e.call(r,n,s,c):Fi(e)&&~e.indexOf("random(")?x0(e):e},PB=sA+"repeat,repeatDelay,yoyo,repeatRefresh,yoyoEase,autoRevert",AB={};Qs(PB+",id,stagger,delay,duration,paused,scrollTrigger",function(t){return AB[t]=1});var gi=function(t){qF(e,t);function e(n,s,c,l){var a;typeof s=="number"&&(c.duration=s,s=c,c=null),a=t.call(this,l?s:Oy(s))||this;var m=a.vars,y=m.duration,v=m.delay,T=m.immediateRender,P=m.stagger,A=m.overwrite,O=m.keyframes,I=m.defaults,L=m.scrollTrigger,R=m.yoyoEase,z=s.parent||In,j=(fs(n)||ZF(n)?ac(n[0]):"length"in s)?[n]:Xo(n),W,Z,te,ie,V,q,Q,ce;if(a._targets=j.length?oA(j):_0("GSAP target "+n+" not found. https://gsap.com",!Co.nullTargetWarn)||[],a._ptLookup=[],a._overwrite=A,O||P||Xv(y)||Xv(v)){if(s=a.vars,W=a.timeline=new As({data:"nested",defaults:I||{},targets:z&&z.data==="nested"?z.vars.targets:j}),W.kill(),W.parent=W._dp=Wl(a),W._start=0,P||Xv(y)||Xv(v)){if(ie=j.length,Q=P&&dB(P),yl(P))for(V in P)~PB.indexOf(V)&&(ce||(ce={}),ce[V]=P[V]);for(Z=0;Z<ie;Z++)te=Tb(s,AB),te.stagger=0,R&&(te.yoyoEase=R),ce&&om(te,ce),q=j[Z],te.duration=+Ny(y,Wl(a),Z,q,j),te.delay=(+Ny(v,Wl(a),Z,q,j)||0)-a._delay,!P&&ie===1&&te.delay&&(a._delay=v=te.delay,a._start+=v,te.delay=0),W.to(q,te,Q?Q(Z,q,j):0),W._ease=Cr.none;W.duration()?y=v=0:a.timeline=0}else if(O){Oy(Mo(W.vars.defaults,{ease:"none"})),W._ease=md(O.ease||s.ease||"none");var se=0,ue,he,ye;if(fs(O))O.forEach(function(xe){return W.to(j,xe,">")}),W.duration();else{te={};for(V in O)V==="ease"||V==="easeEach"||xse(V,O[V],te,O.easeEach);for(V in te)for(ue=te[V].sort(function(xe,Se){return xe.t-Se.t}),se=0,Z=0;Z<ue.length;Z++)he=ue[Z],ye={ease:he.e,duration:(he.t-(Z?ue[Z-1].t:0))/100*y},ye[V]=he.v,W.to(j,ye,se),se+=ye.duration;W.duration()<y&&W.to({},{duration:y-W.duration()})}}y||a.duration(y=W.duration())}else a.timeline=0;return A===!0&&!JP&&(du=Wl(a),In.killTweensOf(j),du=0),sl(z,Wl(a),c),s.reversed&&a.reverse(),s.paused&&a.paused(!0),(T||!y&&!O&&a._start===yi(z._time)&&Ys(T)&&Yie(Wl(a))&&z.data!=="nested")&&(a._tTime=-Qr,a.render(Math.max(0,-v)||0)),L&&lB(Wl(a),L),a}var r=e.prototype;return r.render=function(s,c,l){var a=this._time,m=this._tDur,y=this._dur,v=s<0,T=s>m-Qr&&!v?m:s<Qr?0:s,P,A,O,I,L,R,z,j,W;if(!y)Jie(this,s,c,l);else if(T!==this._tTime||!s||l||!this._initted&&this._tTime||this._startAt&&this._zTime<0!==v||this._lazy){if(P=T,j=this.timeline,this._repeat){if(I=y+this._rDelay,this._repeat<-1&&v)return this.totalTime(I*100+s,c,l);if(P=yi(T%I),T===m?(O=this._repeat,P=y):(L=yi(T/I),O=~~L,O&&O===L?(P=y,O--):P>y&&(P=y)),R=this._yoyo&&O&1,R&&(W=this._yEase,P=y-P),L=am(this._tTime,I),P===a&&!l&&this._initted&&O===L)return this._tTime=T,this;O!==L&&(j&&this._yEase&&SB(j,R),this.vars.repeatRefresh&&!R&&!this._lock&&P!==I&&this._initted&&(this._lock=l=1,this.render(yi(I*O),!0).invalidate()._lock=0))}if(!this._initted){if(cB(this,v?s:P,l,c,T))return this._tTime=0,this;if(a!==this._time&&!(l&&this.vars.repeatRefresh&&O!==L))return this;if(y!==this._dur)return this.render(s,c,l)}if(this._tTime=T,this._time=P,!this._act&&this._ts&&(this._act=1,this._lazy=0),this.ratio=z=(W||this._ease)(P/y),this._from&&(this.ratio=z=1-z),!a&&T&&!c&&!L&&(So(this,"onStart"),this._tTime!==T))return this;for(A=this._pt;A;)A.r(z,A.d),A=A._next;j&&j.render(s<0?s:j._dur*j._ease(P/this._dur),c,l)||this._startAt&&(this._zTime=s),this._onUpdate&&!c&&(v&&EE(this,s,c,l),So(this,"onUpdate")),this._repeat&&O!==L&&this.vars.onRepeat&&!c&&this.parent&&So(this,"onRepeat"),(T===this._tDur||!T)&&this._tTime===T&&(v&&!this._onUpdate&&EE(this,s,!0,!0),(s||!y)&&(T===this._tDur&&this._ts>0||!T&&this._ts<0)&&Ru(this,1),!c&&!(v&&!a)&&(T||a||R)&&(So(this,T===m?"onComplete":"onReverseComplete",!0),this._prom&&!(T<m&&this.timeScale()>0)&&this._prom()))}return this},r.targets=function(){return this._targets},r.invalidate=function(s){return(!s||!this.vars.runBackwards)&&(this._startAt=0),this._pt=this._op=this._onUpdate=this._lazy=this.ratio=0,this._ptLookup=[],this.timeline&&this.timeline.invalidate(s),t.prototype.invalidate.call(this,s)},r.resetTo=function(s,c,l,a,m){b0||bo.wake(),this._ts||this.play();var y=Math.min(this._dur,(this._dp._time-this._start)*this._ts),v;return this._initted||cA(this,y),v=this._ease(y/this._dur),_se(this,s,c,l,a,v,y,m)?this.resetTo(s,c,l,a,1):(P1(this,0),this.parent||oB(this._dp,this,"_first","_last",this._dp._sort?"_start":0),this.render(0))},r.kill=function(s,c){if(c===void 0&&(c="all"),!s&&(!c||c==="all"))return this._lazy=this._pt=0,this.parent?oy(this):this.scrollTrigger&&this.scrollTrigger.kill(!!es),this;if(this.timeline){var l=this.timeline.totalDuration();return this.timeline.killTweensOf(s,c,du&&du.vars.overwrite!==!0)._first||oy(this),this.parent&&l!==this.timeline.totalDuration()&&lm(this,this._dur*this.timeline._tDur/l,0,1),this}var a=this._targets,m=s?Xo(s):a,y=this._ptLookup,v=this._pt,T,P,A,O,I,L,R;if((!c||c==="all")&&Kie(a,m))return c==="all"&&(this._pt=0),oy(this);for(T=this._op=this._op||[],c!=="all"&&(Fi(c)&&(I={},Qs(c,function(z){return I[z]=1}),c=I),c=vse(a,c)),R=a.length;R--;)if(~m.indexOf(a[R])){P=y[R],c==="all"?(T[R]=c,O=P,A={}):(A=T[R]=T[R]||{},O=c);for(I in O)L=P&&P[I],L&&((!("kill"in L.d)||L.d.kill(I)===!0)&&E1(this,L,"_pt"),delete P[I]),A!=="all"&&(A[I]=1)}return this._initted&&!this._pt&&v&&oy(this),this},e.to=function(s,c){return new e(s,c,arguments[2])},e.from=function(s,c){return zy(1,arguments)},e.delayedCall=function(s,c,l,a){return new e(c,0,{immediateRender:!1,lazy:!1,overwrite:!1,delay:s,onComplete:c,onReverseComplete:c,onCompleteParams:l,onReverseCompleteParams:l,callbackScope:a})},e.fromTo=function(s,c,l){return zy(2,arguments)},e.set=function(s,c){return c.duration=0,c.repeatDelay||(c.repeat=0),new e(s,c)},e.killTweensOf=function(s,c,l){return In.killTweensOf(s,c,l)},e}(w0);Mo(gi.prototype,{_targets:[],_lazy:0,_startAt:0,_op:0,_onInit:0});Qs("staggerTo,staggerFrom,staggerFromTo",function(t){gi[t]=function(){var e=new As,r=PE.call(arguments,0);return r.splice(t==="staggerFromTo"?5:4,0,0),e[t].apply(e,r)}});var uA=function(e,r,n){return e[r]=n},kB=function(e,r,n){return e[r](n)},bse=function(e,r,n,s){return e[r](s.fp,n)},wse=function(e,r,n){return e.setAttribute(r,n)},hA=function(e,r){return Un(e[r])?kB:eA(e[r])&&e.setAttribute?wse:uA},MB=function(e,r){return r.set(r.t,r.p,Math.round((r.s+r.c*e)*1e6)/1e6,r)},Sse=function(e,r){return r.set(r.t,r.p,!!(r.s+r.c*e),r)},IB=function(e,r){var n=r._pt,s="";if(!e&&r.b)s=r.b;else if(e===1&&r.e)s=r.e;else{for(;n;)s=n.p+(n.m?n.m(n.s+n.c*e):Math.round((n.s+n.c*e)*1e4)/1e4)+s,n=n._next;s+=r.c}r.set(r.t,r.p,s,r)},dA=function(e,r){for(var n=r._pt;n;)n.r(e,n.d),n=n._next},Tse=function(e,r,n,s){for(var c=this._pt,l;c;)l=c._next,c.p===s&&c.modifier(e,r,n),c=l},Ese=function(e){for(var r=this._pt,n,s;r;)s=r._next,r.p===e&&!r.op||r.op===e?E1(this,r,"_pt"):r.dep||(n=1),r=s;return!n},Cse=function(e,r,n,s){s.mSet(e,r,s.m.call(s.tween,n,s.mt),s)},RB=function(e){for(var r=e._pt,n,s,c,l;r;){for(n=r._next,s=c;s&&s.pr>r.pr;)s=s._next;(r._prev=s?s._prev:l)?r._prev._next=r:c=r,(r._next=s)?s._prev=r:l=r,r=n}e._pt=c},Js=function(){function t(r,n,s,c,l,a,m,y,v){this.t=n,this.s=c,this.c=l,this.p=s,this.r=a||MB,this.d=m||this,this.set=y||uA,this.pr=v||0,this._next=r,r&&(r._prev=this)}var e=t.prototype;return e.modifier=function(n,s,c){this.mSet=this.mSet||this.set,this.set=Cse,this.m=n,this.mt=c,this.tween=s},t}();Qs(sA+"parent,duration,ease,delay,overwrite,runBackwards,startAt,yoyo,immediateRender,repeat,repeatDelay,data,paused,reversed,lazy,callbackScope,stringFilter,id,yoyoEase,stagger,inherit,repeatRefresh,keyframes,autoRevert,scrollTrigger",function(t){return iA[t]=1});ko.TweenMax=ko.TweenLite=gi;ko.TimelineLite=ko.TimelineMax=As;In=new As({sortChildren:!1,defaults:sm,autoRemoveChildren:!0,id:"root",smoothChildTiming:!0});Co.stringFilter=bB;var gd=[],Ax={},Pse=[],vL=0,Ase=0,dS=function(e){return(Ax[e]||Pse).map(function(r){return r()})},IE=function(){var e=Date.now(),r=[];e-vL>2&&(dS("matchMediaInit"),gd.forEach(function(n){var s=n.queries,c=n.conditions,l,a,m,y;for(a in s)l=Qa.matchMedia(s[a]).matches,l&&(m=1),l!==c[a]&&(c[a]=l,y=1);y&&(n.revert(),m&&r.push(n))}),dS("matchMediaRevert"),r.forEach(function(n){return n.onMatch(n,function(s){return n.add(null,s)})}),vL=e,dS("matchMedia"))},DB=function(){function t(r,n){this.selector=n&&AE(n),this.data=[],this._r=[],this.isReverted=!1,this.id=Ase++,r&&this.add(r)}var e=t.prototype;return e.add=function(n,s,c){Un(n)&&(c=s,s=n,n=Un);var l=this,a=function(){var y=bn,v=l.selector,T;return y&&y!==l&&y.data.push(l),c&&(l.selector=AE(c)),bn=l,T=s.apply(l,arguments),Un(T)&&l._r.push(T),bn=y,l.selector=v,l.isReverted=!1,T};return l.last=a,n===Un?a(l,function(m){return l.add(null,m)}):n?l[n]=a:a},e.ignore=function(n){var s=bn;bn=null,n(this),bn=s},e.getTweens=function(){var n=[];return this.data.forEach(function(s){return s instanceof t?n.push.apply(n,s.getTweens()):s instanceof gi&&!(s.parent&&s.parent.data==="nested")&&n.push(s)}),n},e.clear=function(){this._r.length=this.data.length=0},e.kill=function(n,s){var c=this;if(n?function(){for(var a=c.getTweens(),m=c.data.length,y;m--;)y=c.data[m],y.data==="isFlip"&&(y.revert(),y.getChildren(!0,!0,!1).forEach(function(v){return a.splice(a.indexOf(v),1)}));for(a.map(function(v){return{g:v._dur||v._delay||v._sat&&!v._sat.vars.immediateRender?v.globalTime(0):-1/0,t:v}}).sort(function(v,T){return T.g-v.g||-1/0}).forEach(function(v){return v.t.revert(n)}),m=c.data.length;m--;)y=c.data[m],y instanceof As?y.data!=="nested"&&(y.scrollTrigger&&y.scrollTrigger.revert(),y.kill()):!(y instanceof gi)&&y.revert&&y.revert(n);c._r.forEach(function(v){return v(n,c)}),c.isReverted=!0}():this.data.forEach(function(a){return a.kill&&a.kill()}),this.clear(),s)for(var l=gd.length;l--;)gd[l].id===this.id&&gd.splice(l,1)},e.revert=function(n){this.kill(n||{})},t}(),kse=function(){function t(r){this.contexts=[],this.scope=r,bn&&bn.data.push(this)}var e=t.prototype;return e.add=function(n,s,c){yl(n)||(n={matches:n});var l=new DB(0,c||this.scope),a=l.conditions={},m,y,v;bn&&!l.selector&&(l.selector=bn.selector),this.contexts.push(l),s=l.add("onMatch",s),l.queries=n;for(y in n)y==="all"?v=1:(m=Qa.matchMedia(n[y]),m&&(gd.indexOf(l)<0&&gd.push(l),(a[y]=m.matches)&&(v=1),m.addListener?m.addListener(IE):m.addEventListener("change",IE)));return v&&s(l,function(T){return l.add(null,T)}),this},e.revert=function(n){this.kill(n||{})},e.kill=function(n){this.contexts.forEach(function(s){return s.kill(n,!0)})},t}(),Cb={registerPlugin:function(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];r.forEach(function(s){return _B(s)})},timeline:function(e){return new As(e)},getTweensOf:function(e,r){return In.getTweensOf(e,r)},getProperty:function(e,r,n,s){Fi(e)&&(e=Xo(e)[0]);var c=fd(e||{}).get,l=n?sB:iB;return n==="native"&&(n=""),e&&(r?l((_o[r]&&_o[r].get||c)(e,r,n,s)):function(a,m,y){return l((_o[a]&&_o[a].get||c)(e,a,m,y))})},quickSetter:function(e,r,n){if(e=Xo(e),e.length>1){var s=e.map(function(v){return no.quickSetter(v,r,n)}),c=s.length;return function(v){for(var T=c;T--;)s[T](v)}}e=e[0]||{};var l=_o[r],a=fd(e),m=a.harness&&(a.harness.aliases||{})[r]||r,y=l?function(v){var T=new l;bp._pt=0,T.init(e,n?v+n:v,bp,0,[e]),T.render(1,T),bp._pt&&dA(1,bp)}:a.set(e,m);return l?y:function(v){return y(e,m,n?v+n:v,a,1)}},quickTo:function(e,r,n){var s,c=no.to(e,Mo((s={},s[r]="+=0.1",s.paused=!0,s.stagger=0,s),n||{})),l=function(m,y,v){return c.resetTo(r,m,y,v)};return l.tween=c,l},isTweening:function(e){return In.getTweensOf(e,!0).length>0},defaults:function(e){return e&&e.ease&&(e.ease=md(e.ease,sm.ease)),pL(sm,e||{})},config:function(e){return pL(Co,e||{})},registerEffect:function(e){var r=e.name,n=e.effect,s=e.plugins,c=e.defaults,l=e.extendTimeline;(s||"").split(",").forEach(function(a){return a&&!_o[a]&&!ko[a]&&_0(r+" effect requires "+a+" plugin.")}),lS[r]=function(a,m,y){return n(Xo(a),Mo(m||{},c),y)},l&&(As.prototype[r]=function(a,m,y){return this.add(lS[r](a,yl(m)?m:(y=m)&&{},this),y)})},registerEase:function(e,r){Cr[e]=md(r)},parseEase:function(e,r){return arguments.length?md(e,r):Cr},getById:function(e){return In.getById(e)},exportRoot:function(e,r){e===void 0&&(e={});var n=new As(e),s,c;for(n.smoothChildTiming=Ys(e.smoothChildTiming),In.remove(n),n._dp=0,n._time=n._tTime=In._time,s=In._first;s;)c=s._next,(r||!(!s._dur&&s instanceof gi&&s.vars.onComplete===s._targets[0]))&&sl(n,s,s._start-s._delay),s=c;return sl(In,n,0),n},context:function(e,r){return e?new DB(e,r):bn},matchMedia:function(e){return new kse(e)},matchMediaRefresh:function(){return gd.forEach(function(e){var r=e.conditions,n,s;for(s in r)r[s]&&(r[s]=!1,n=1);n&&e.revert()})||IE()},addEventListener:function(e,r){var n=Ax[e]||(Ax[e]=[]);~n.indexOf(r)||n.push(r)},removeEventListener:function(e,r){var n=Ax[e],s=n&&n.indexOf(r);s>=0&&n.splice(s,1)},utils:{wrap:ase,wrapYoyo:lse,distribute:dB,random:pB,snap:fB,normalize:ose,getUnit:us,clamp:rse,splitColor:vB,toArray:Xo,selector:AE,mapRange:gB,pipe:ise,unitize:sse,interpolate:cse,shuffle:hB},install:JF,effects:lS,ticker:bo,updateRoot:As.updateRoot,plugins:_o,globalTimeline:In,core:{PropTween:Js,globals:eB,Tween:gi,Timeline:As,Animation:w0,getCache:fd,_removeLinkedListItem:E1,reverting:function(){return es},context:function(e){return e&&bn&&(bn.data.push(e),e._ctx=bn),bn},suppressOverwrites:function(e){return JP=e}}};Qs("to,from,fromTo,delayedCall,set,killTweensOf",function(t){return Cb[t]=gi[t]});bo.add(As.updateRoot);bp=Cb.to({},{duration:0});var Mse=function(e,r){for(var n=e._pt;n&&n.p!==r&&n.op!==r&&n.fp!==r;)n=n._next;return n},Ise=function(e,r){var n=e._targets,s,c,l;for(s in r)for(c=n.length;c--;)l=e._ptLookup[c][s],l&&(l=l.d)&&(l._pt&&(l=Mse(l,s)),l&&l.modifier&&l.modifier(r[s],e,n[c],s))},fS=function(e,r){return{name:e,headless:1,rawVars:1,init:function(s,c,l){l._onInit=function(a){var m,y;if(Fi(c)&&(m={},Qs(c,function(v){return m[v]=1}),c=m),r){m={};for(y in c)m[y]=r(c[y]);c=m}Ise(a,c)}}}},no=Cb.registerPlugin({name:"attr",init:function(e,r,n,s,c){var l,a,m;this.tween=n;for(l in r)m=e.getAttribute(l)||"",a=this.add(e,"setAttribute",(m||0)+"",r[l],s,c,0,0,l),a.op=l,a.b=m,this._props.push(l)},render:function(e,r){for(var n=r._pt;n;)es?n.set(n.t,n.p,n.b,n):n.r(e,n.d),n=n._next}},{name:"endArray",headless:1,init:function(e,r){for(var n=r.length;n--;)this.add(e,n,e[n]||0,r[n],0,0,0,0,0,1)}},fS("roundProps",kE),fS("modifiers"),fS("snap",fB))||Cb;gi.version=As.version=no.version="3.13.0";QF=1;tA()&&cm();Cr.Power0;Cr.Power1;Cr.Power2;Cr.Power3;Cr.Power4;Cr.Linear;Cr.Quad;Cr.Cubic;Cr.Quart;Cr.Quint;Cr.Strong;Cr.Elastic;Cr.Back;Cr.SteppedEase;Cr.Bounce;Cr.Sine;Cr.Expo;Cr.Circ;/*!
 * CSSPlugin 3.13.0
 * https://gsap.com
 *
 * Copyright 2008-2025, GreenSock. All rights reserved.
 * Subject to the terms at https://gsap.com/standard-license
 * @author: Jack Doyle, jack@greensock.com
*/var xL,fu,zp,fA,ed,bL,pA,Rse=function(){return typeof window<"u"},lc={},Vh=180/Math.PI,Np=Math.PI/180,Qf=Math.atan2,wL=1e8,mA=/([A-Z])/g,Dse=/(left|right|width|margin|padding|x)/i,Lse=/[\s,\(]\S/,ll={autoAlpha:"opacity,visibility",scale:"scaleX,scaleY",alpha:"opacity"},RE=function(e,r){return r.set(r.t,r.p,Math.round((r.s+r.c*e)*1e4)/1e4+r.u,r)},Ose=function(e,r){return r.set(r.t,r.p,e===1?r.e:Math.round((r.s+r.c*e)*1e4)/1e4+r.u,r)},zse=function(e,r){return r.set(r.t,r.p,e?Math.round((r.s+r.c*e)*1e4)/1e4+r.u:r.b,r)},Nse=function(e,r){var n=r.s+r.c*e;r.set(r.t,r.p,~~(n+(n<0?-.5:.5))+r.u,r)},LB=function(e,r){return r.set(r.t,r.p,e?r.e:r.b,r)},OB=function(e,r){return r.set(r.t,r.p,e!==1?r.b:r.e,r)},jse=function(e,r,n){return e.style[r]=n},Fse=function(e,r,n){return e.style.setProperty(r,n)},Bse=function(e,r,n){return e._gsap[r]=n},$se=function(e,r,n){return e._gsap.scaleX=e._gsap.scaleY=n},Vse=function(e,r,n,s,c){var l=e._gsap;l.scaleX=l.scaleY=n,l.renderTransform(c,l)},Use=function(e,r,n,s,c){var l=e._gsap;l[r]=n,l.renderTransform(c,l)},Dn="transform",eo=Dn+"Origin",Gse=function t(e,r){var n=this,s=this.target,c=s.style,l=s._gsap;if(e in lc&&c){if(this.tfm=this.tfm||{},e!=="transform")e=ll[e]||e,~e.indexOf(",")?e.split(",").forEach(function(a){return n.tfm[a]=Hl(s,a)}):this.tfm[e]=l.x?l[e]:Hl(s,e),e===eo&&(this.tfm.zOrigin=l.zOrigin);else return ll.transform.split(",").forEach(function(a){return t.call(n,a,r)});if(this.props.indexOf(Dn)>=0)return;l.svg&&(this.svgo=s.getAttribute("data-svg-origin"),this.props.push(eo,r,"")),e=Dn}(c||r)&&this.props.push(e,r,c[e])},zB=function(e){e.translate&&(e.removeProperty("translate"),e.removeProperty("scale"),e.removeProperty("rotate"))},Wse=function(){var e=this.props,r=this.target,n=r.style,s=r._gsap,c,l;for(c=0;c<e.length;c+=3)e[c+1]?e[c+1]===2?r[e[c]](e[c+2]):r[e[c]]=e[c+2]:e[c+2]?n[e[c]]=e[c+2]:n.removeProperty(e[c].substr(0,2)==="--"?e[c]:e[c].replace(mA,"-$1").toLowerCase());if(this.tfm){for(l in this.tfm)s[l]=this.tfm[l];s.svg&&(s.renderTransform(),r.setAttribute("data-svg-origin",this.svgo||"")),c=pA(),(!c||!c.isStart)&&!n[Dn]&&(zB(n),s.zOrigin&&n[eo]&&(n[eo]+=" "+s.zOrigin+"px",s.zOrigin=0,s.renderTransform()),s.uncache=1)}},NB=function(e,r){var n={target:e,props:[],revert:Wse,save:Gse};return e._gsap||no.core.getCache(e),r&&e.style&&e.nodeType&&r.split(",").forEach(function(s){return n.save(s)}),n},jB,DE=function(e,r){var n=fu.createElementNS?fu.createElementNS((r||"http://www.w3.org/1999/xhtml").replace(/^https/,"http"),e):fu.createElement(e);return n&&n.style?n:fu.createElement(e)},Yo=function t(e,r,n){var s=getComputedStyle(e);return s[r]||s.getPropertyValue(r.replace(mA,"-$1").toLowerCase())||s.getPropertyValue(r)||!n&&t(e,um(r)||r,1)||""},SL="O,Moz,ms,Ms,Webkit".split(","),um=function(e,r,n){var s=r||ed,c=s.style,l=5;if(e in c&&!n)return e;for(e=e.charAt(0).toUpperCase()+e.substr(1);l--&&!(SL[l]+e in c););return l<0?null:(l===3?"ms":l>=0?SL[l]:"")+e},LE=function(){Rse()&&window.document&&(xL=window,fu=xL.document,zp=fu.documentElement,ed=DE("div")||{style:{}},DE("div"),Dn=um(Dn),eo=Dn+"Origin",ed.style.cssText="border-width:0;line-height:0;position:absolute;padding:0",jB=!!um("perspective"),pA=no.core.reverting,fA=1)},TL=function(e){var r=e.ownerSVGElement,n=DE("svg",r&&r.getAttribute("xmlns")||"http://www.w3.org/2000/svg"),s=e.cloneNode(!0),c;s.style.display="block",n.appendChild(s),zp.appendChild(n);try{c=s.getBBox()}catch{}return n.removeChild(s),zp.removeChild(n),c},EL=function(e,r){for(var n=r.length;n--;)if(e.hasAttribute(r[n]))return e.getAttribute(r[n])},FB=function(e){var r,n;try{r=e.getBBox()}catch{r=TL(e),n=1}return r&&(r.width||r.height)||n||(r=TL(e)),r&&!r.width&&!r.x&&!r.y?{x:+EL(e,["x","cx","x1"])||0,y:+EL(e,["y","cy","y1"])||0,width:0,height:0}:r},BB=function(e){return!!(e.getCTM&&(!e.parentNode||e.ownerSVGElement)&&FB(e))},Ed=function(e,r){if(r){var n=e.style,s;r in lc&&r!==eo&&(r=Dn),n.removeProperty?(s=r.substr(0,2),(s==="ms"||r.substr(0,6)==="webkit")&&(r="-"+r),n.removeProperty(s==="--"?r:r.replace(mA,"-$1").toLowerCase())):n.removeAttribute(r)}},pu=function(e,r,n,s,c,l){var a=new Js(e._pt,r,n,0,1,l?OB:LB);return e._pt=a,a.b=s,a.e=c,e._props.push(n),a},CL={deg:1,rad:1,turn:1},qse={grid:1,flex:1},Du=function t(e,r,n,s){var c=parseFloat(n)||0,l=(n+"").trim().substr((c+"").length)||"px",a=ed.style,m=Dse.test(r),y=e.tagName.toLowerCase()==="svg",v=(y?"client":"offset")+(m?"Width":"Height"),T=100,P=s==="px",A=s==="%",O,I,L,R;if(s===l||!c||CL[s]||CL[l])return c;if(l!=="px"&&!P&&(c=t(e,r,n,"px")),R=e.getCTM&&BB(e),(A||l==="%")&&(lc[r]||~r.indexOf("adius")))return O=R?e.getBBox()[m?"width":"height"]:e[v],Jn(A?c/O*T:c/100*O);if(a[m?"width":"height"]=T+(P?l:s),I=s!=="rem"&&~r.indexOf("adius")||s==="em"&&e.appendChild&&!y?e:e.parentNode,R&&(I=(e.ownerSVGElement||{}).parentNode),(!I||I===fu||!I.appendChild)&&(I=fu.body),L=I._gsap,L&&A&&L.width&&m&&L.time===bo.time&&!L.uncache)return Jn(c/L.width*T);if(A&&(r==="height"||r==="width")){var z=e.style[r];e.style[r]=T+s,O=e[v],z?e.style[r]=z:Ed(e,r)}else(A||l==="%")&&!qse[Yo(I,"display")]&&(a.position=Yo(e,"position")),I===e&&(a.position="static"),I.appendChild(ed),O=ed[v],I.removeChild(ed),a.position="absolute";return m&&A&&(L=fd(I),L.time=bo.time,L.width=I[v]),Jn(P?O*c/T:O&&c?T/O*c:0)},Hl=function(e,r,n,s){var c;return fA||LE(),r in ll&&r!=="transform"&&(r=ll[r],~r.indexOf(",")&&(r=r.split(",")[0])),lc[r]&&r!=="transform"?(c=T0(e,s),c=r!=="transformOrigin"?c[r]:c.svg?c.origin:Ab(Yo(e,eo))+" "+c.zOrigin+"px"):(c=e.style[r],(!c||c==="auto"||s||~(c+"").indexOf("calc("))&&(c=Pb[r]&&Pb[r](e,r,n)||Yo(e,r)||rB(e,r)||(r==="opacity"?1:0))),n&&!~(c+"").trim().indexOf(" ")?Du(e,r,c,n)+n:c},Hse=function(e,r,n,s){if(!n||n==="none"){var c=um(r,e,1),l=c&&Yo(e,c,1);l&&l!==n?(r=c,n=l):r==="borderColor"&&(n=Yo(e,"borderTopColor"))}var a=new Js(this._pt,e.style,r,0,1,IB),m=0,y=0,v,T,P,A,O,I,L,R,z,j,W,Z;if(a.b=n,a.e=s,n+="",s+="",s.substring(0,6)==="var(--"&&(s=Yo(e,s.substring(4,s.indexOf(")")))),s==="auto"&&(I=e.style[r],e.style[r]=s,s=Yo(e,r)||s,I?e.style[r]=I:Ed(e,r)),v=[n,s],bB(v),n=v[0],s=v[1],P=n.match(xp)||[],Z=s.match(xp)||[],Z.length){for(;T=xp.exec(s);)L=T[0],z=s.substring(m,T.index),O?O=(O+1)%5:(z.substr(-5)==="rgba("||z.substr(-5)==="hsla(")&&(O=1),L!==(I=P[y++]||"")&&(A=parseFloat(I)||0,W=I.substr((A+"").length),L.charAt(1)==="="&&(L=Op(A,L)+W),R=parseFloat(L),j=L.substr((R+"").length),m=xp.lastIndex-j.length,j||(j=j||Co.units[r]||W,m===s.length&&(s+=j,a.e+=j)),W!==j&&(A=Du(e,r,I,j)||0),a._pt={_next:a._pt,p:z||y===1?z:",",s:A,c:R-A,m:O&&O<4||r==="zIndex"?Math.round:0});a.c=m<s.length?s.substring(m,s.length):""}else a.r=r==="display"&&s==="none"?OB:LB;return XF.test(s)&&(a.e=0),this._pt=a,a},PL={top:"0%",bottom:"100%",left:"0%",right:"100%",center:"50%"},Zse=function(e){var r=e.split(" "),n=r[0],s=r[1]||"50%";return(n==="top"||n==="bottom"||s==="left"||s==="right")&&(e=n,n=s,s=e),r[0]=PL[n]||n,r[1]=PL[s]||s,r.join(" ")},Kse=function(e,r){if(r.tween&&r.tween._time===r.tween._dur){var n=r.t,s=n.style,c=r.u,l=n._gsap,a,m,y;if(c==="all"||c===!0)s.cssText="",m=1;else for(c=c.split(","),y=c.length;--y>-1;)a=c[y],lc[a]&&(m=1,a=a==="transformOrigin"?eo:Dn),Ed(n,a);m&&(Ed(n,Dn),l&&(l.svg&&n.removeAttribute("transform"),s.scale=s.rotate=s.translate="none",T0(n,1),l.uncache=1,zB(s)))}},Pb={clearProps:function(e,r,n,s,c){if(c.data!=="isFromStart"){var l=e._pt=new Js(e._pt,r,n,0,0,Kse);return l.u=s,l.pr=-10,l.tween=c,e._props.push(n),1}}},S0=[1,0,0,1,0,0],$B={},VB=function(e){return e==="matrix(1, 0, 0, 1, 0, 0)"||e==="none"||!e},AL=function(e){var r=Yo(e,Dn);return VB(r)?S0:r.substr(7).match(KF).map(Jn)},gA=function(e,r){var n=e._gsap||fd(e),s=e.style,c=AL(e),l,a,m,y;return n.svg&&e.getAttribute("transform")?(m=e.transform.baseVal.consolidate().matrix,c=[m.a,m.b,m.c,m.d,m.e,m.f],c.join(",")==="1,0,0,1,0,0"?S0:c):(c===S0&&!e.offsetParent&&e!==zp&&!n.svg&&(m=s.display,s.display="block",l=e.parentNode,(!l||!e.offsetParent&&!e.getBoundingClientRect().width)&&(y=1,a=e.nextElementSibling,zp.appendChild(e)),c=AL(e),m?s.display=m:Ed(e,"display"),y&&(a?l.insertBefore(e,a):l?l.appendChild(e):zp.removeChild(e))),r&&c.length>6?[c[0],c[1],c[4],c[5],c[12],c[13]]:c)},OE=function(e,r,n,s,c,l){var a=e._gsap,m=c||gA(e,!0),y=a.xOrigin||0,v=a.yOrigin||0,T=a.xOffset||0,P=a.yOffset||0,A=m[0],O=m[1],I=m[2],L=m[3],R=m[4],z=m[5],j=r.split(" "),W=parseFloat(j[0])||0,Z=parseFloat(j[1])||0,te,ie,V,q;n?m!==S0&&(ie=A*L-O*I)&&(V=W*(L/ie)+Z*(-I/ie)+(I*z-L*R)/ie,q=W*(-O/ie)+Z*(A/ie)-(A*z-O*R)/ie,W=V,Z=q):(te=FB(e),W=te.x+(~j[0].indexOf("%")?W/100*te.width:W),Z=te.y+(~(j[1]||j[0]).indexOf("%")?Z/100*te.height:Z)),s||s!==!1&&a.smooth?(R=W-y,z=Z-v,a.xOffset=T+(R*A+z*I)-R,a.yOffset=P+(R*O+z*L)-z):a.xOffset=a.yOffset=0,a.xOrigin=W,a.yOrigin=Z,a.smooth=!!s,a.origin=r,a.originIsAbsolute=!!n,e.style[eo]="0px 0px",l&&(pu(l,a,"xOrigin",y,W),pu(l,a,"yOrigin",v,Z),pu(l,a,"xOffset",T,a.xOffset),pu(l,a,"yOffset",P,a.yOffset)),e.setAttribute("data-svg-origin",W+" "+Z)},T0=function(e,r){var n=e._gsap||new EB(e);if("x"in n&&!r&&!n.uncache)return n;var s=e.style,c=n.scaleX<0,l="px",a="deg",m=getComputedStyle(e),y=Yo(e,eo)||"0",v,T,P,A,O,I,L,R,z,j,W,Z,te,ie,V,q,Q,ce,se,ue,he,ye,xe,Se,fe,ve,Re,$e,Xe,st,at,_t;return v=T=P=I=L=R=z=j=W=0,A=O=1,n.svg=!!(e.getCTM&&BB(e)),m.translate&&((m.translate!=="none"||m.scale!=="none"||m.rotate!=="none")&&(s[Dn]=(m.translate!=="none"?"translate3d("+(m.translate+" 0 0").split(" ").slice(0,3).join(", ")+") ":"")+(m.rotate!=="none"?"rotate("+m.rotate+") ":"")+(m.scale!=="none"?"scale("+m.scale.split(" ").join(",")+") ":"")+(m[Dn]!=="none"?m[Dn]:"")),s.scale=s.rotate=s.translate="none"),ie=gA(e,n.svg),n.svg&&(n.uncache?(fe=e.getBBox(),y=n.xOrigin-fe.x+"px "+(n.yOrigin-fe.y)+"px",Se=""):Se=!r&&e.getAttribute("data-svg-origin"),OE(e,Se||y,!!Se||n.originIsAbsolute,n.smooth!==!1,ie)),Z=n.xOrigin||0,te=n.yOrigin||0,ie!==S0&&(ce=ie[0],se=ie[1],ue=ie[2],he=ie[3],v=ye=ie[4],T=xe=ie[5],ie.length===6?(A=Math.sqrt(ce*ce+se*se),O=Math.sqrt(he*he+ue*ue),I=ce||se?Qf(se,ce)*Vh:0,z=ue||he?Qf(ue,he)*Vh+I:0,z&&(O*=Math.abs(Math.cos(z*Np))),n.svg&&(v-=Z-(Z*ce+te*ue),T-=te-(Z*se+te*he))):(_t=ie[6],st=ie[7],Re=ie[8],$e=ie[9],Xe=ie[10],at=ie[11],v=ie[12],T=ie[13],P=ie[14],V=Qf(_t,Xe),L=V*Vh,V&&(q=Math.cos(-V),Q=Math.sin(-V),Se=ye*q+Re*Q,fe=xe*q+$e*Q,ve=_t*q+Xe*Q,Re=ye*-Q+Re*q,$e=xe*-Q+$e*q,Xe=_t*-Q+Xe*q,at=st*-Q+at*q,ye=Se,xe=fe,_t=ve),V=Qf(-ue,Xe),R=V*Vh,V&&(q=Math.cos(-V),Q=Math.sin(-V),Se=ce*q-Re*Q,fe=se*q-$e*Q,ve=ue*q-Xe*Q,at=he*Q+at*q,ce=Se,se=fe,ue=ve),V=Qf(se,ce),I=V*Vh,V&&(q=Math.cos(V),Q=Math.sin(V),Se=ce*q+se*Q,fe=ye*q+xe*Q,se=se*q-ce*Q,xe=xe*q-ye*Q,ce=Se,ye=fe),L&&Math.abs(L)+Math.abs(I)>359.9&&(L=I=0,R=180-R),A=Jn(Math.sqrt(ce*ce+se*se+ue*ue)),O=Jn(Math.sqrt(xe*xe+_t*_t)),V=Qf(ye,xe),z=Math.abs(V)>2e-4?V*Vh:0,W=at?1/(at<0?-at:at):0),n.svg&&(Se=e.getAttribute("transform"),n.forceCSS=e.setAttribute("transform","")||!VB(Yo(e,Dn)),Se&&e.setAttribute("transform",Se))),Math.abs(z)>90&&Math.abs(z)<270&&(c?(A*=-1,z+=I<=0?180:-180,I+=I<=0?180:-180):(O*=-1,z+=z<=0?180:-180)),r=r||n.uncache,n.x=v-((n.xPercent=v&&(!r&&n.xPercent||(Math.round(e.offsetWidth/2)===Math.round(-v)?-50:0)))?e.offsetWidth*n.xPercent/100:0)+l,n.y=T-((n.yPercent=T&&(!r&&n.yPercent||(Math.round(e.offsetHeight/2)===Math.round(-T)?-50:0)))?e.offsetHeight*n.yPercent/100:0)+l,n.z=P+l,n.scaleX=Jn(A),n.scaleY=Jn(O),n.rotation=Jn(I)+a,n.rotationX=Jn(L)+a,n.rotationY=Jn(R)+a,n.skewX=z+a,n.skewY=j+a,n.transformPerspective=W+l,(n.zOrigin=parseFloat(y.split(" ")[2])||!r&&n.zOrigin||0)&&(s[eo]=Ab(y)),n.xOffset=n.yOffset=0,n.force3D=Co.force3D,n.renderTransform=n.svg?Yse:jB?UB:Xse,n.uncache=0,n},Ab=function(e){return(e=e.split(" "))[0]+" "+e[1]},pS=function(e,r,n){var s=us(r);return Jn(parseFloat(r)+parseFloat(Du(e,"x",n+"px",s)))+s},Xse=function(e,r){r.z="0px",r.rotationY=r.rotationX="0deg",r.force3D=0,UB(e,r)},Lh="0deg",Zg="0px",Oh=") ",UB=function(e,r){var n=r||this,s=n.xPercent,c=n.yPercent,l=n.x,a=n.y,m=n.z,y=n.rotation,v=n.rotationY,T=n.rotationX,P=n.skewX,A=n.skewY,O=n.scaleX,I=n.scaleY,L=n.transformPerspective,R=n.force3D,z=n.target,j=n.zOrigin,W="",Z=R==="auto"&&e&&e!==1||R===!0;if(j&&(T!==Lh||v!==Lh)){var te=parseFloat(v)*Np,ie=Math.sin(te),V=Math.cos(te),q;te=parseFloat(T)*Np,q=Math.cos(te),l=pS(z,l,ie*q*-j),a=pS(z,a,-Math.sin(te)*-j),m=pS(z,m,V*q*-j+j)}L!==Zg&&(W+="perspective("+L+Oh),(s||c)&&(W+="translate("+s+"%, "+c+"%) "),(Z||l!==Zg||a!==Zg||m!==Zg)&&(W+=m!==Zg||Z?"translate3d("+l+", "+a+", "+m+") ":"translate("+l+", "+a+Oh),y!==Lh&&(W+="rotate("+y+Oh),v!==Lh&&(W+="rotateY("+v+Oh),T!==Lh&&(W+="rotateX("+T+Oh),(P!==Lh||A!==Lh)&&(W+="skew("+P+", "+A+Oh),(O!==1||I!==1)&&(W+="scale("+O+", "+I+Oh),z.style[Dn]=W||"translate(0, 0)"},Yse=function(e,r){var n=r||this,s=n.xPercent,c=n.yPercent,l=n.x,a=n.y,m=n.rotation,y=n.skewX,v=n.skewY,T=n.scaleX,P=n.scaleY,A=n.target,O=n.xOrigin,I=n.yOrigin,L=n.xOffset,R=n.yOffset,z=n.forceCSS,j=parseFloat(l),W=parseFloat(a),Z,te,ie,V,q;m=parseFloat(m),y=parseFloat(y),v=parseFloat(v),v&&(v=parseFloat(v),y+=v,m+=v),m||y?(m*=Np,y*=Np,Z=Math.cos(m)*T,te=Math.sin(m)*T,ie=Math.sin(m-y)*-P,V=Math.cos(m-y)*P,y&&(v*=Np,q=Math.tan(y-v),q=Math.sqrt(1+q*q),ie*=q,V*=q,v&&(q=Math.tan(v),q=Math.sqrt(1+q*q),Z*=q,te*=q)),Z=Jn(Z),te=Jn(te),ie=Jn(ie),V=Jn(V)):(Z=T,V=P,te=ie=0),(j&&!~(l+"").indexOf("px")||W&&!~(a+"").indexOf("px"))&&(j=Du(A,"x",l,"px"),W=Du(A,"y",a,"px")),(O||I||L||R)&&(j=Jn(j+O-(O*Z+I*ie)+L),W=Jn(W+I-(O*te+I*V)+R)),(s||c)&&(q=A.getBBox(),j=Jn(j+s/100*q.width),W=Jn(W+c/100*q.height)),q="matrix("+Z+","+te+","+ie+","+V+","+j+","+W+")",A.setAttribute("transform",q),z&&(A.style[Dn]=q)},Qse=function(e,r,n,s,c){var l=360,a=Fi(c),m=parseFloat(c)*(a&&~c.indexOf("rad")?Vh:1),y=m-s,v=s+y+"deg",T,P;return a&&(T=c.split("_")[1],T==="short"&&(y%=l,y!==y%(l/2)&&(y+=y<0?l:-l)),T==="cw"&&y<0?y=(y+l*wL)%l-~~(y/l)*l:T==="ccw"&&y>0&&(y=(y-l*wL)%l-~~(y/l)*l)),e._pt=P=new Js(e._pt,r,n,s,y,Ose),P.e=v,P.u="deg",e._props.push(n),P},kL=function(e,r){for(var n in r)e[n]=r[n];return e},Jse=function(e,r,n){var s=kL({},n._gsap),c="perspective,force3D,transformOrigin,svgOrigin",l=n.style,a,m,y,v,T,P,A,O;s.svg?(y=n.getAttribute("transform"),n.setAttribute("transform",""),l[Dn]=r,a=T0(n,1),Ed(n,Dn),n.setAttribute("transform",y)):(y=getComputedStyle(n)[Dn],l[Dn]=r,a=T0(n,1),l[Dn]=y);for(m in lc)y=s[m],v=a[m],y!==v&&c.indexOf(m)<0&&(A=us(y),O=us(v),T=A!==O?Du(n,m,y,O):parseFloat(y),P=parseFloat(v),e._pt=new Js(e._pt,a,m,T,P-T,RE),e._pt.u=O||0,e._props.push(m));kL(a,s)};Qs("padding,margin,Width,Radius",function(t,e){var r="Top",n="Right",s="Bottom",c="Left",l=(e<3?[r,n,s,c]:[r+c,r+n,s+n,s+c]).map(function(a){return e<2?t+a:"border"+a+t});Pb[e>1?"border"+t:t]=function(a,m,y,v,T){var P,A;if(arguments.length<4)return P=l.map(function(O){return Hl(a,O,y)}),A=P.join(" "),A.split(P[0]).length===5?P[0]:A;P=(v+"").split(" "),A={},l.forEach(function(O,I){return A[O]=P[I]=P[I]||P[(I-1)/2|0]}),a.init(m,A,T)}});var GB={name:"css",register:LE,targetTest:function(e){return e.style&&e.nodeType},init:function(e,r,n,s,c){var l=this._props,a=e.style,m=n.vars.startAt,y,v,T,P,A,O,I,L,R,z,j,W,Z,te,ie,V;fA||LE(),this.styles=this.styles||NB(e),V=this.styles.props,this.tween=n;for(I in r)if(I!=="autoRound"&&(v=r[I],!(_o[I]&&CB(I,r,n,s,e,c)))){if(A=typeof v,O=Pb[I],A==="function"&&(v=v.call(n,s,e,c),A=typeof v),A==="string"&&~v.indexOf("random(")&&(v=x0(v)),O)O(this,e,I,v,n)&&(ie=1);else if(I.substr(0,2)==="--")y=(getComputedStyle(e).getPropertyValue(I)+"").trim(),v+="",Eu.lastIndex=0,Eu.test(y)||(L=us(y),R=us(v)),R?L!==R&&(y=Du(e,I,y,R)+R):L&&(v+=L),this.add(a,"setProperty",y,v,s,c,0,0,I),l.push(I),V.push(I,0,a[I]);else if(A!=="undefined"){if(m&&I in m?(y=typeof m[I]=="function"?m[I].call(n,s,e,c):m[I],Fi(y)&&~y.indexOf("random(")&&(y=x0(y)),us(y+"")||y==="auto"||(y+=Co.units[I]||us(Hl(e,I))||""),(y+"").charAt(1)==="="&&(y=Hl(e,I))):y=Hl(e,I),P=parseFloat(y),z=A==="string"&&v.charAt(1)==="="&&v.substr(0,2),z&&(v=v.substr(2)),T=parseFloat(v),I in ll&&(I==="autoAlpha"&&(P===1&&Hl(e,"visibility")==="hidden"&&T&&(P=0),V.push("visibility",0,a.visibility),pu(this,a,"visibility",P?"inherit":"hidden",T?"inherit":"hidden",!T)),I!=="scale"&&I!=="transform"&&(I=ll[I],~I.indexOf(",")&&(I=I.split(",")[0]))),j=I in lc,j){if(this.styles.save(I),A==="string"&&v.substring(0,6)==="var(--"&&(v=Yo(e,v.substring(4,v.indexOf(")"))),T=parseFloat(v)),W||(Z=e._gsap,Z.renderTransform&&!r.parseTransform||T0(e,r.parseTransform),te=r.smoothOrigin!==!1&&Z.smooth,W=this._pt=new Js(this._pt,a,Dn,0,1,Z.renderTransform,Z,0,-1),W.dep=1),I==="scale")this._pt=new Js(this._pt,Z,"scaleY",Z.scaleY,(z?Op(Z.scaleY,z+T):T)-Z.scaleY||0,RE),this._pt.u=0,l.push("scaleY",I),I+="X";else if(I==="transformOrigin"){V.push(eo,0,a[eo]),v=Zse(v),Z.svg?OE(e,v,0,te,0,this):(R=parseFloat(v.split(" ")[2])||0,R!==Z.zOrigin&&pu(this,Z,"zOrigin",Z.zOrigin,R),pu(this,a,I,Ab(y),Ab(v)));continue}else if(I==="svgOrigin"){OE(e,v,1,te,0,this);continue}else if(I in $B){Qse(this,Z,I,P,z?Op(P,z+v):v);continue}else if(I==="smoothOrigin"){pu(this,Z,"smooth",Z.smooth,v);continue}else if(I==="force3D"){Z[I]=v;continue}else if(I==="transform"){Jse(this,v,e);continue}}else I in a||(I=um(I)||I);if(j||(T||T===0)&&(P||P===0)&&!Lse.test(v)&&I in a)L=(y+"").substr((P+"").length),T||(T=0),R=us(v)||(I in Co.units?Co.units[I]:L),L!==R&&(P=Du(e,I,y,R)),this._pt=new Js(this._pt,j?Z:a,I,P,(z?Op(P,z+T):T)-P,!j&&(R==="px"||I==="zIndex")&&r.autoRound!==!1?Nse:RE),this._pt.u=R||0,L!==R&&R!=="%"&&(this._pt.b=y,this._pt.r=zse);else if(I in a)Hse.call(this,e,I,y,z?z+v:v);else if(I in e)this.add(e,I,y||e[I],z?z+v:v,s,c);else if(I!=="parseTransform"){nA(I,v);continue}j||(I in a?V.push(I,0,a[I]):typeof e[I]=="function"?V.push(I,2,e[I]()):V.push(I,1,y||e[I])),l.push(I)}}ie&&RB(this)},render:function(e,r){if(r.tween._time||!pA())for(var n=r._pt;n;)n.r(e,n.d),n=n._next;else r.styles.revert()},get:Hl,aliases:ll,getSetter:function(e,r,n){var s=ll[r];return s&&s.indexOf(",")<0&&(r=s),r in lc&&r!==eo&&(e._gsap.x||Hl(e,"x"))?n&&bL===n?r==="scale"?$se:Bse:(bL=n||{})&&(r==="scale"?Vse:Use):e.style&&!eA(e.style[r])?jse:~r.indexOf("-")?Fse:hA(e,r)},core:{_removeProperty:Ed,_getMatrix:gA}};no.utils.checkPrefix=um;no.core.getStyleSaver=NB;(function(t,e,r,n){var s=Qs(t+","+e+","+r,function(c){lc[c]=1});Qs(e,function(c){Co.units[c]="deg",$B[c]=1}),ll[s[13]]=t+","+e,Qs(n,function(c){var l=c.split(":");ll[l[1]]=s[l[0]]})})("x,y,z,scale,scaleX,scaleY,xPercent,yPercent","rotation,rotationX,rotationY,skewX,skewY","transform,transformOrigin,svgOrigin,force3D,smoothOrigin,transformPerspective","0:translateX,1:translateY,2:translateZ,8:rotate,8:rotationZ,8:rotateZ,9:rotateX,10:rotateY");Qs("x,y,z,top,right,bottom,left,width,height,fontSize,padding,margin,perspective",function(t){Co.units[t]="px"});no.registerPlugin(GB);var $n=no.registerPlugin(GB)||no;$n.core.Tween;const eoe=({text:t,as:e="div",typingSpeed:r=50,initialDelay:n=0,pauseDuration:s=2e3,deletingSpeed:c=30,loop:l=!0,className:a="",showCursor:m=!0,hideCursorWhileTyping:y=!1,cursorCharacter:v="|",cursorClassName:T="",cursorBlinkDuration:P=.5,textColors:A=[],variableSpeed:O,onSentenceComplete:I,startOnVisible:L=!1,reverseMode:R=!1,...z})=>{const[j,W]=X.useState(""),[Z,te]=X.useState(0),[ie,V]=X.useState(!1),[q,Q]=X.useState(0),[ce,se]=X.useState(!L),ue=X.useRef(null),he=X.useRef(null),ye=X.useMemo(()=>Array.isArray(t)?t:[t],[t]),xe=X.useCallback(()=>{if(!O)return r;const{min:ve,max:Re}=O;return Math.random()*(Re-ve)+ve},[O,r]),Se=()=>A.length===0?"#b3c9edff":A[q%A.length];X.useEffect(()=>{if(!L||!he.current)return;const ve=new IntersectionObserver(Re=>{Re.forEach($e=>{$e.isIntersecting&&se(!0)})},{threshold:.1});return ve.observe(he.current),()=>ve.disconnect()},[L]),X.useEffect(()=>{m&&ue.current&&($n.set(ue.current,{opacity:1}),$n.to(ue.current,{opacity:0,duration:P,repeat:-1,yoyo:!0,ease:"power2.inOut"}))},[m,P]),X.useEffect(()=>{if(!ce)return;let ve;const Re=ye[q],$e=R?Re.split("").reverse().join(""):Re,Xe=()=>{if(ie)if(j===""){if(V(!1),q===ye.length-1&&!l)return;I&&I(ye[q],q),Q(st=>(st+1)%ye.length),te(0),ve=setTimeout(()=>{},s)}else ve=setTimeout(()=>{W(st=>st.slice(0,-1))},c);else Z<$e.length?ve=setTimeout(()=>{W(st=>st+$e[Z]),te(st=>st+1)},O?xe():r):ye.length>1&&(ve=setTimeout(()=>{V(!0)},s))};return Z===0&&!ie&&j===""?ve=setTimeout(Xe,n):Xe(),()=>clearTimeout(ve)},[Z,j,ie,r,c,s,ye,q,l,n,ce,R,O,I]);const fe=y&&(Z<ye[q].length||ie);return X.createElement(e,{ref:he,className:`text-type ${a}`,...z},B.jsx("span",{className:"text-type__content",style:{color:Se()},children:j}),m&&B.jsx("span",{ref:ue,className:`text-type__cursor ${T} ${fe?"text-type__cursor--hidden":""}`,children:v}))};function toe(){return B.jsxs("header",{className:"relative isolate overflow-hidden min-h-screen","aria-label":"Constellation header",children:[B.jsx("div",{className:"pt-28 md:pt-36"}),B.jsxs("div",{className:"absolute inset-0",children:[B.jsx(Fie,{mouseRepulsion:!0,mouseInteraction:!0,density:1.5,glowIntensity:.35,saturation:0,hueShift:0}),B.jsx("div",{className:"absolute inset-x-0 bottom-0 h-32 bg-gradient-to-b from-transparent to-[#1f2022] pointer-events-none"})]}),B.jsxs("div",{className:"relative mx-auto max-w-6xl px-6 pb-20 md:pb-28 flex flex-col justify-center min-h-screen pointer-events-none",children:[B.jsx(nr.h1,{initial:{opacity:0,y:8},animate:{opacity:1,y:0},transition:{type:"spring",stiffness:100,damping:18},className:"text-6xl md:text-8xl font-bold tracking-tight text-blue-200",children:"Aegis"}),B.jsx(nr.div,{initial:{opacity:0,y:8},animate:{opacity:1,y:0},transition:{delay:.3,type:"spring",stiffness:100,damping:18},className:"mt-6 text-2xl md:text-3xl min-h-[3rem]",children:B.jsx(eoe,{text:["AI vigilance for safer schools","Continuous threat monitoring","Human-verified security alerts"],typingSpeed:75,pauseDuration:1500,showCursor:!0,cursorCharacter:"|",loop:!0,className:"text-blue-400"})}),B.jsxs(nr.div,{initial:{opacity:0,y:8},animate:{opacity:1,y:0},transition:{delay:.6,type:"spring",stiffness:100,damping:18},className:"mt-8 flex flex-wrap items-center gap-3",children:[B.jsx("a",{href:"/account",className:"rounded-full border border-white/20 bg-white/10 px-5 py-2.5 text-m font-medium backdrop-blur hover:bg-white/15 focus:outline-none focus:ring-2 focus:ring-white/40 pointer-events-auto w-40 text-center",children:"Get started"}),B.jsx("a",{href:"#how-it-works",className:"rounded-full border border-white/20 px-5 py-2.5 text-m font-medium hover:bg-white/10 focus:outline-none focus:ring-2 focus:ring-white/40 pointer-events-auto w-40 text-center",children:"How it works"})]})]})]})}const WB=12,qB=300,A1="#ffffff",roe=768,noe=[{color:"#060010",title:"Analytics",description:"Track user behavior",label:"Insights"},{color:"#060010",title:"Dashboard",description:"Centralized data view",label:"Overview"},{color:"#060010",title:"Integration",description:"Connect favorite tools",label:"Connectivity"},{color:"#060010",title:"Security",description:"Enterprise-grade protection",label:"Protection"}],ioe=(t,e,r=A1)=>{const n=document.createElement("div");return n.className="particle",n.style.cssText=`
    position: absolute;
    width: 4px;
    height: 4px;
    border-radius: 50%;
    background: rgba(${r}, 1);
    box-shadow: 0 0 6px rgba(${r}, 0.6);
    pointer-events: none;
    z-index: 100;
    left: ${t}px;
    top: ${e}px;
  `,n},soe=t=>({proximity:t*.5,fadeDistance:t*.75}),ooe=(t,e,r,n,s)=>{const c=t.getBoundingClientRect(),l=(e-c.left)/c.width*100,a=(r-c.top)/c.height*100;t.style.setProperty("--glow-x",`${l}%`),t.style.setProperty("--glow-y",`${a}%`),t.style.setProperty("--glow-intensity",n.toString()),t.style.setProperty("--glow-radius",`${s}px`)},aoe=({children:t,className:e="",disableAnimations:r=!1,style:n,particleCount:s=WB,glowColor:c=A1,enableTilt:l=!0,clickEffect:a=!1,enableMagnetism:m=!1})=>{const y=X.useRef(null),v=X.useRef([]),T=X.useRef([]),P=X.useRef(!1),A=X.useRef([]),O=X.useRef(!1),I=X.useRef(null),L=X.useCallback(()=>{if(O.current||!y.current)return;const{width:j,height:W}=y.current.getBoundingClientRect();A.current=Array.from({length:s},()=>ioe(Math.random()*j,Math.random()*W,c)),O.current=!0},[s,c]),R=X.useCallback(()=>{var j;T.current.forEach(clearTimeout),T.current=[],(j=I.current)==null||j.kill(),v.current.forEach(W=>{$n.to(W,{scale:0,opacity:0,duration:.3,ease:"back.in(1.7)",onComplete:()=>{var Z;(Z=W.parentNode)==null||Z.removeChild(W)}})}),v.current=[]},[]),z=X.useCallback(()=>{!y.current||!P.current||(O.current||L(),A.current.forEach((j,W)=>{const Z=setTimeout(()=>{if(!P.current||!y.current)return;const te=j.cloneNode(!0);y.current.appendChild(te),v.current.push(te),$n.fromTo(te,{scale:0,opacity:0},{scale:1,opacity:1,duration:.3,ease:"back.out(1.7)"}),$n.to(te,{x:(Math.random()-.5)*100,y:(Math.random()-.5)*100,rotation:Math.random()*360,duration:2+Math.random()*2,ease:"none",repeat:-1,yoyo:!0}),$n.to(te,{opacity:.3,duration:1.5,ease:"power2.inOut",repeat:-1,yoyo:!0})},W*100);T.current.push(Z)}))},[L]);return X.useEffect(()=>{if(r||!y.current)return;const j=y.current,W=()=>{P.current=!0,z(),l&&$n.to(j,{rotateX:5,rotateY:5,duration:.3,ease:"power2.out",transformPerspective:1e3})},Z=()=>{P.current=!1,R(),l&&$n.to(j,{rotateX:0,rotateY:0,duration:.3,ease:"power2.out"}),m&&$n.to(j,{x:0,y:0,duration:.3,ease:"power2.out"})},te=V=>{if(!l&&!m)return;const q=j.getBoundingClientRect(),Q=V.clientX-q.left,ce=V.clientY-q.top,se=q.width/2,ue=q.height/2;if(l){const he=(ce-ue)/ue*-10,ye=(Q-se)/se*10;$n.to(j,{rotateX:he,rotateY:ye,duration:.1,ease:"power2.out",transformPerspective:1e3})}if(m){const he=(Q-se)*.05,ye=(ce-ue)*.05;I.current=$n.to(j,{x:he,y:ye,duration:.3,ease:"power2.out"})}},ie=V=>{if(!a)return;const q=j.getBoundingClientRect(),Q=V.clientX-q.left,ce=V.clientY-q.top,se=Math.max(Math.hypot(Q,ce),Math.hypot(Q-q.width,ce),Math.hypot(Q,ce-q.height),Math.hypot(Q-q.width,ce-q.height)),ue=document.createElement("div");ue.style.cssText=`
        position: absolute;
        width: ${se*2}px;
        height: ${se*2}px;
        border-radius: 50%;
        background: radial-gradient(circle, rgba(${c}, 0.4) 0%, rgba(${c}, 0.2) 30%, transparent 70%);
        left: ${Q-se}px;
        top: ${ce-se}px;
        pointer-events: none;
        z-index: 1000;
      `,j.appendChild(ue),$n.fromTo(ue,{scale:0,opacity:1},{scale:1,opacity:0,duration:.8,ease:"power2.out",onComplete:()=>ue.remove()})};return j.addEventListener("mouseenter",W),j.addEventListener("mouseleave",Z),j.addEventListener("mousemove",te),j.addEventListener("click",ie),()=>{P.current=!1,j.removeEventListener("mouseenter",W),j.removeEventListener("mouseleave",Z),j.removeEventListener("mousemove",te),j.removeEventListener("click",ie),R()}},[z,R,r,l,m,a,c]),B.jsx("div",{ref:y,className:`${e} relative overflow-hidden`,style:{...n,position:"relative",overflow:"hidden"},children:t})},loe=({gridRef:t,disableAnimations:e=!1,enabled:r=!0,spotlightRadius:n=qB,glowColor:s=A1})=>{const c=X.useRef(null),l=X.useRef(!1);return X.useEffect(()=>{if(e||!(t!=null&&t.current)||!r)return;const a=document.createElement("div");a.className="global-spotlight",a.style.cssText=`
      position: fixed;
      width: 800px;
      height: 800px;
      border-radius: 50%;
      pointer-events: none;
      background: radial-gradient(circle,
        rgba(${s}, 0.15) 0%,
        rgba(${s}, 0.08) 15%,
        rgba(${s}, 0.04) 25%,
        rgba(${s}, 0.02) 40%,
        rgba(${s}, 0.01) 65%,
        transparent 70%
      );
      z-index: 200;
      opacity: 0;
      transform: translate(-50%, -50%);
      mix-blend-mode: screen;
    `,document.body.appendChild(a),c.current=a;const m=v=>{if(!c.current||!t.current)return;const T=t.current.closest(".bento-section"),P=T==null?void 0:T.getBoundingClientRect(),A=P&&v.clientX>=P.left&&v.clientX<=P.right&&v.clientY>=P.top&&v.clientY<=P.bottom;l.current=A||!1;const O=t.current.querySelectorAll(".card");if(!A){$n.to(c.current,{opacity:0,duration:.3,ease:"power2.out"}),O.forEach(j=>{j.style.setProperty("--glow-intensity","0")});return}const{proximity:I,fadeDistance:L}=soe(n);let R=1/0;O.forEach(j=>{const W=j,Z=W.getBoundingClientRect(),te=Z.left+Z.width/2,ie=Z.top+Z.height/2,V=Math.hypot(v.clientX-te,v.clientY-ie)-Math.max(Z.width,Z.height)/2,q=Math.max(0,V);R=Math.min(R,q);let Q=0;q<=I?Q=1:q<=L&&(Q=(L-q)/(L-I)),ooe(W,v.clientX,v.clientY,Q,n)}),$n.to(c.current,{left:v.clientX,top:v.clientY,duration:.1,ease:"power2.out"});const z=R<=I?.8:R<=L?(L-R)/(L-I)*.8:0;$n.to(c.current,{opacity:z,duration:z>0?.2:.5,ease:"power2.out"})},y=()=>{var v;l.current=!1,(v=t.current)==null||v.querySelectorAll(".card").forEach(T=>{T.style.setProperty("--glow-intensity","0")}),c.current&&$n.to(c.current,{opacity:0,duration:.3,ease:"power2.out"})};return document.addEventListener("mousemove",m),document.addEventListener("mouseleave",y),()=>{var v,T;document.removeEventListener("mousemove",m),document.removeEventListener("mouseleave",y),(T=(v=c.current)==null?void 0:v.parentNode)==null||T.removeChild(c.current)}},[t,e,r,n,s]),null},coe=({children:t,gridRef:e,fullWidth:r=!1})=>B.jsx("div",{className:`bento-section grid ${r?"justify-items-stretch":"justify-items-center"} gap-4 p-4 md:p-6 select-none relative ${r?"w-full px-4 md:px-6":"max-w-[80rem] mx-auto"}`,style:{fontSize:"clamp(1rem, 1rem + 0.6vw, 1.75rem)"},ref:e,children:t}),uoe=()=>{const[t,e]=X.useState(!1);return X.useEffect(()=>{const r=()=>e(window.innerWidth<=roe);return r(),window.addEventListener("resize",r),()=>window.removeEventListener("resize",r)},[]),t},ML=({textAutoHide:t=!0,enableStars:e=!0,enableSpotlight:r=!0,enableBorderGlow:n=!0,disableAnimations:s=!1,spotlightRadius:c=qB,particleCount:l=WB,enableTilt:a=!1,glowColor:m=A1,clickEffect:y=!0,enableMagnetism:v=!0,items:T,columns:P=2})=>{const A=X.useRef(null),O=uoe(),I=s||O,L=T&&T.length>0?T:noe;return B.jsxs(B.Fragment,{children:[B.jsx("style",{children:`
          .bento-section {
            --glow-x: 50%;
            --glow-y: 50%;
            --glow-intensity: 0;
            --glow-radius: 200px;
            --glow-color: ${m};
            --border-color: rgba(${m}, 0.3);
            --background-dark: #ffffff;
            --white: hsl(0, 0%, 100%);
            --purple-primary: rgba(255, 255, 255);
            --purple-glow: rgba(132, 0, 255, 0.2);
            --purple-border: rgba(255, 255, 255);
          }
          
          .card-responsive {
            grid-template-columns: 1fr;
            width: 100%;
            margin: 0 auto;
            padding: 0.5rem;
          }
          
          @media (min-width: 600px) {
            .card-responsive {
              grid-template-columns: repeat(2, 2fr);
            }
          }
          
          .card-responsive .card:nth-child(6) {
            grid-column: 4;
            grid-row: 3;
          }
          
          .card--border-glow::after {
            content: '';
            position: absolute;
            inset: 0;
            padding: 6px;
            background: radial-gradient(var(--glow-radius) circle at var(--glow-x) var(--glow-y),
            rgba(${m}, calc(var(--glow-intensity) * 0.8)) 0%,
            rgba(${m}, calc(var(--glow-intensity) * 0.4)) 30%,
            transparent 60%);
            border-radius: inherit;
            mask: linear-gradient(#fff 0 0) content-box, linear-gradient(#fff 0 0);
            mask-composite: subtract;
            -webkit-mask: linear-gradient(#fff 0 0) content-box, linear-gradient(#fff 0 0);
            -webkit-mask-composite: xor;
            pointer-events: none;
            transition: opacity 0.3s ease;
            z-index: 1;
          }
          
          .card--border-glow:hover::after {
            opacity: 1;
          }
          
          .card--border-glow:hover {
            box-shadow: 0 4px 20px rgba(46, 24, 78, 0.4), 0 0 30px rgba(${m}, 0.2);
          }
          
          .particle::before {
            content: '';
            position: absolute;
            top: -2px;
            left: -2px;
            right: -2px;
            bottom: -2px;
            background: rgba(${m}, 0.2);
            border-radius: 50%;
            z-index: -1;
          }
          
          .particle-container:hover {
            box-shadow: 0 4px 20px rgba(46, 24, 78, 0.2), 0 0 30px rgba(${m}, 0.2);
          }
          
          .text-clamp-1 {
            display: -webkit-box;
            -webkit-box-orient: vertical;
            -webkit-line-clamp: 1;
            line-clamp: 1;
            overflow: hidden;
            text-overflow: ellipsis;
          }
          
          .text-clamp-2 {
            display: -webkit-box;
            -webkit-box-orient: vertical;
            -webkit-line-clamp: 2;
            line-clamp: 2;
            overflow: hidden;
            text-overflow: ellipsis;
          }
          
          .text-clamp-3 {
            display: -webkit-box;
            -webkit-box-orient: vertical;
            -webkit-line-clamp: 3;
            line-clamp: 3;
            overflow: hidden;
            text-overflow: ellipsis;
          }
          
          .text-clamp-4 {
            display: -webkit-box;
            -webkit-box-orient: vertical;
            -webkit-line-clamp: 4;
            line-clamp: 4;
            overflow: hidden;
            text-overflow: ellipsis;
          }
          
          .text-clamp-5 {
            display: -webkit-box;
            -webkit-box-orient: vertical;
            -webkit-line-clamp: 5;
            line-clamp: 5;
            overflow: hidden;
            text-overflow: ellipsis;
          }
          
          @media (max-width: 599px) {
            .card-responsive {
              grid-template-columns: 1fr;
              width: 90%;
              margin: 0 auto;
              padding: 0.5rem;
            }
            
            .card-responsive .card {
              width: 100%;
              min-height: 180px;
            }
          }
        `}),r&&B.jsx(loe,{gridRef:A,disableAnimations:I,enabled:r,spotlightRadius:c,glowColor:m}),B.jsx(coe,{gridRef:A,fullWidth:P>=3,children:B.jsx("div",{className:"card-responsive grid w-full gap-4 md:gap-6 w-full",style:{gridTemplateColumns:`repeat(${P}, minmax(0, 1fr))`},children:L.map((R,z)=>{const j=`card flex flex-col justify-start relative aspect-[6/3] min-h-[10px] md:min-h-[120px] w-full p-2 md:p-6 rounded-[25px] border border-solid font-light overflow-hidden transition-all duration-300 ease-in-out hover:-translate-y-0.5 hover:shadow-[0_8px_25px_rgba(0,0,0,0.15)] ${n?"card--border-glow":""}`,W={backgroundColor:R.color||"var(--background-dark)",borderColor:"var(--border-color)",color:"var(--white)","--glow-x":"50%","--glow-y":"50%","--glow-intensity":"0","--glow-radius":"200px"};return e?B.jsxs(aoe,{className:j,style:W,disableAnimations:I,particleCount:l,glowColor:m,enableTilt:a,clickEffect:y,enableMagnetism:v,children:[B.jsx("div",{className:"card__header flex items-center justify-start gap-3 relative text-white",children:R.icon?B.jsx("span",{className:"shrink-0",children:R.icon}):R.imageSrc?B.jsx("img",{src:R.imageSrc,alt:R.title||R.label||"Card",className:"h-10 w-10 rounded-md object-cover"}):R.label?B.jsx("span",{className:"card__label text-lg md:text-xl",children:R.label}):null}),B.jsxs("div",{className:"card__content flex flex-col relative",children:[B.jsx("h3",{className:`card__title font-bold text-xl md:text-2xl m-0 mb-6 ${t?"text-clamp-1":""}`,children:R.title}),B.jsx("p",{className:`card__description text-sm md:text-base leading-6 opacity-90 ${t?R.maxLines?`text-clamp-${Math.min(R.maxLines,5)}`:"text-clamp-2":""}`,children:R.description})]})]},z):B.jsxs("div",{className:j,style:W,ref:Z=>{if(!Z)return;const te=q=>{if(I)return;const Q=Z.getBoundingClientRect(),ce=q.clientX-Q.left,se=q.clientY-Q.top,ue=Q.width/2,he=Q.height/2;if(a){const ye=(se-he)/he*-10,xe=(ce-ue)/ue*10;$n.to(Z,{rotateX:ye,rotateY:xe,duration:.1,ease:"power2.out",transformPerspective:1e3})}if(v){const ye=(ce-ue)*.05,xe=(se-he)*.05;$n.to(Z,{x:ye,y:xe,duration:.3,ease:"power2.out"})}},ie=()=>{I||(a&&$n.to(Z,{rotateX:0,rotateY:0,duration:.3,ease:"power2.out"}),v&&$n.to(Z,{x:0,y:0,duration:.3,ease:"power2.out"}))},V=q=>{if(!y||I)return;const Q=Z.getBoundingClientRect(),ce=q.clientX-Q.left,se=q.clientY-Q.top,ue=Math.max(Math.hypot(ce,se),Math.hypot(ce-Q.width,se),Math.hypot(ce,se-Q.height),Math.hypot(ce-Q.width,se-Q.height)),he=document.createElement("div");he.style.cssText=`
                      position: absolute;
                      width: ${ue*2}px;
                      height: ${ue*2}px;
                      border-radius: 50%;
                      background: radial-gradient(circle, rgba(${m}, 0.4) 0%, rgba(${m}, 0.2) 30%, transparent 70%);
                      left: ${ce-ue}px;
                      top: ${se-ue}px;
                      pointer-events: none;
                      z-index: 1000;
                    `,Z.appendChild(he),$n.fromTo(he,{scale:0,opacity:1},{scale:1,opacity:0,duration:.8,ease:"power2.out",onComplete:()=>he.remove()})};Z.addEventListener("mousemove",te),Z.addEventListener("mouseleave",ie),Z.addEventListener("click",V)},children:[B.jsx("div",{className:"card__header flex items-center justify-start gap-3 relative text-white",children:R.icon?B.jsx("span",{className:"shrink-0",children:R.icon}):R.imageSrc?B.jsx("img",{src:R.imageSrc,alt:R.title||R.label||"Card",className:"h-10 w-10 rounded-md object-cover"}):R.label?B.jsx("span",{className:"card__label text-lg md:text-xl",children:R.label}):null}),B.jsxs("div",{className:"card__content flex flex-col relative text-white",children:[B.jsx("h3",{className:`card__title font-normal text-xl md:text-2xl m-0 mb-0 ${t?"text-clamp-1":""}`,children:R.title}),B.jsx("p",{className:`card__description text-sm md:text-base leading-6 opacity-90 ${t?R.maxLines?`text-clamp-${Math.min(R.maxLines,5)}`:"text-clamp-2":""}`,children:R.description})]})]},z)})})})]})};function hoe(){const t=X.useRef(null),e=X.useRef(null),r=X.useRef(null),n=X.useRef(null),s=Qh(t,{once:!0,amount:.3}),c=Qh(e,{once:!0,amount:.3}),l=Qh(r,{once:!0,amount:.3}),a=Qh(n,{once:!0,amount:.2}),m={hidden:{opacity:0,y:30},visible:{opacity:1,y:0,transition:{duration:.6}}},y={hidden:{opacity:0},visible:{opacity:1,transition:{staggerChildren:.15,delayChildren:.1}}},v={hidden:{opacity:0,y:20,scale:.95},visible:{opacity:1,y:0,scale:1,transition:{duration:.5}}};return B.jsxs("main",{className:"bg-black text-white",children:[B.jsx(toe,{}),B.jsx("section",{ref:t,className:"bg-gradient-to-b from-[#1f2022] to-[#171819] py-16 md:py-24 overflow-hidden",children:B.jsxs("div",{className:"mx-auto max-w-6xl px-6",children:[B.jsxs(nr.div,{initial:"hidden",animate:s?"visible":"hidden",variants:m,className:"text-center mb-12",children:[B.jsxs("div",{className:"inline-flex items-center gap-2 rounded-full border border-red-500/20 bg-red-500/10 px-4 py-1.5 mb-6",children:[B.jsx(Uh,{className:"h-4 w-4 text-red-400"}),B.jsx("span",{className:"text-sm font-medium text-red-300",children:"Critical Challenge"})]}),B.jsx("h2",{className:"text-3xl md:text-5xl font-bold tracking-tight mb-6 bg-gradient-to-r from-white to-zinc-400 bg-clip-text text-transparent",children:"School Safety Can't Wait"}),B.jsx("p",{className:"text-lg md:text-xl text-zinc-300 max-w-3xl mx-auto leading-relaxed",children:"Every year, thousands of schools face security threats that could be prevented or mitigated with faster detection and response times. Traditional security systems can't keep pace with modern threats."})]}),B.jsxs(nr.div,{initial:"hidden",animate:s?"visible":"hidden",variants:y,className:"grid gap-6 md:grid-cols-2 lg:grid-cols-3 mt-12",children:[B.jsxs(nr.div,{variants:v,className:"group relative rounded-2xl border border-white/10 bg-zinc-900/40 p-6 backdrop-blur hover:border-red-500/30 transition-colors",children:[B.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-red-500/5 to-transparent opacity-0 group-hover:opacity-100 transition-opacity rounded-2xl"}),B.jsx(G4,{className:"h-8 w-8 text-red-400 mb-4"}),B.jsx("h3",{className:"text-xl font-semibold mb-2",children:"Delayed Response"}),B.jsx("p",{className:"text-zinc-400",children:"Manual monitoring leads to critical delays in identifying and responding to threats, often missing early warning signs."})]}),B.jsxs(nr.div,{variants:v,className:"group relative rounded-2xl border border-white/10 bg-zinc-900/40 p-6 backdrop-blur hover:border-red-500/30 transition-colors",children:[B.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-red-500/5 to-transparent opacity-0 group-hover:opacity-100 transition-opacity rounded-2xl"}),B.jsx(dZ,{className:"h-8 w-8 text-red-400 mb-4"}),B.jsx("h3",{className:"text-xl font-semibold mb-2",children:"Human Limitations"}),B.jsx("p",{className:"text-zinc-400",children:"Security personnel can't monitor dozens of camera feeds 24/7, creating blind spots in coverage and reaction time."})]}),B.jsxs(nr.div,{variants:v,className:"group relative rounded-2xl border border-white/10 bg-zinc-900/40 p-6 backdrop-blur hover:border-red-500/30 transition-colors",children:[B.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-red-500/5 to-transparent opacity-0 group-hover:opacity-100 transition-opacity rounded-2xl"}),B.jsx(Uh,{className:"h-8 w-8 text-red-400 mb-4"}),B.jsx("h3",{className:"text-xl font-semibold mb-2",children:"False Alarms"}),B.jsx("p",{className:"text-zinc-400",children:"Legacy systems generate overwhelming false positives, causing alert fatigue and reducing trust in security infrastructure."})]})]})]})}),B.jsx("section",{ref:e,className:"bg-[#171819] py-16 border-y border-white/5",children:B.jsx("div",{className:"mx-auto max-w-6xl px-6",children:B.jsxs(nr.div,{initial:"hidden",animate:c?"visible":"hidden",variants:y,className:"grid gap-8 md:grid-cols-3",children:[B.jsxs(nr.div,{variants:v,className:"text-center",children:[B.jsxs("div",{className:"text-4xl md:text-5xl font-bold text-blue-400 mb-2",children:[B.jsx(uZ,{className:"inline h-10 w-10 mb-2"}),B.jsx("div",{children:"98%"})]}),B.jsx("p",{className:"text-lg text-zinc-300 font-medium",children:"Detection Accuracy"}),B.jsx("p",{className:"text-sm text-zinc-500 mt-1",children:"AI-powered threat identification"})]}),B.jsxs(nr.div,{variants:v,className:"text-center",children:[B.jsxs("div",{className:"text-4xl md:text-5xl font-bold text-blue-400 mb-2",children:[B.jsx(UT,{className:"inline h-10 w-10 mb-2"}),B.jsx("div",{children:"<3s"})]}),B.jsx("p",{className:"text-lg text-zinc-300 font-medium",children:"Alert Response Time"}),B.jsx("p",{className:"text-sm text-zinc-500 mt-1",children:"From detection to notification"})]}),B.jsxs(nr.div,{variants:v,className:"text-center",children:[B.jsxs("div",{className:"text-4xl md:text-5xl font-bold text-blue-400 mb-2",children:[B.jsx(FR,{className:"inline h-10 w-10 mb-2"}),B.jsx("div",{children:"24/7"})]}),B.jsx("p",{className:"text-lg text-zinc-300 font-medium",children:"Continuous Monitoring"}),B.jsx("p",{className:"text-sm text-zinc-500 mt-1",children:"Never-sleeping AI vigilance"})]})]})})}),B.jsx("section",{ref:r,className:"bg-gradient-to-b from-[#171819] to-[#1f2022] py-16 md:py-24",children:B.jsx("div",{className:"mx-auto max-w-6xl px-6",children:B.jsxs(nr.div,{initial:"hidden",animate:l?"visible":"hidden",variants:m,className:"text-center ",children:[B.jsxs("div",{className:"inline-flex items-center gap-2 rounded-full border border-blue-500/20 bg-blue-500/10 px-4 py-1.5 mb-6",children:[B.jsx(FR,{className:"h-4 w-4 text-blue-400"}),B.jsx("span",{className:"text-sm font-medium text-blue-300",children:"Our Solution"})]}),B.jsx("h2",{className:"text-3xl md:text-5xl font-bold tracking-tight mb-6 bg-gradient-to-r from-blue-400 to-blue-600 bg-clip-text text-transparent",children:"AI-Powered School Security"}),B.jsx("p",{className:"text-lg md:text-xl text-zinc-300 max-w-3xl mx-auto leading-relaxed",children:"Aegis transforms your existing security infrastructure into an intelligent threat detection system that works around the clock to keep schools safe."}),B.jsx(ML,{textAutoHide:!0,enableStars:!0,enableSpotlight:!0,enableBorderGlow:!0,enableTilt:!0,enableMagnetism:!1,clickEffect:!0,spotlightRadius:300,particleCount:12,glowColor:"59, 130, 246",items:[{color:"#1F2022",title:"Computer Vision AI",description:"Our advanced AI models analyze video feeds in real-time, detecting weapons, aggressive behavior, and suspicious activities with industry-leading accuracy. The system learns and adapts to your school's unique environment.",icon:B.jsx($T,{className:"h-10 w-10 text-blue-400"}),maxLines:4},{color:"#1F2022",title:"Smart Audio Detection",description:"Audio analysis identifies gunshots, breaking glass, and distress calls. Our multi-modal approach combines visual and audio cues to provide comprehensive threat detection with minimal false positives.",icon:B.jsx(BT,{className:"h-10 w-10 text-blue-400"}),maxLines:4},{color:"#1F2022",title:"Human-in-the-Loop",description:"Security personnel verify AI detections through an intuitive dashboard before escalation. This approach eliminates false alarms while maintaining rapid response times and building trust in the system.",icon:B.jsx(VT,{className:"h-10 w-10 text-blue-400"}),maxLines:4},{color:"#1F2022",title:"Instant Escalation",description:"Once verified, threats are immediately escalated to school administration and law enforcement with precise location data, camera feeds, and threat detailsenabling the fastest possible response.",icon:B.jsx(UT,{className:"h-10 w-10 text-blue-400"}),maxLines:4}]})]})})}),B.jsx("section",{ref:n,"aria-labelledby":"how-it-works",className:"bg-[#1f2022] py-16 md:py-24",children:B.jsx("div",{className:"mx-auto max-w-6xl px-6",children:B.jsxs(nr.div,{initial:"hidden",animate:a?"visible":"hidden",variants:m,className:"text-center mb-12",children:[B.jsx("h2",{id:"how-it-works",className:"text-3xl md:text-4xl font-bold tracking-tight mb-4",children:"How It Works"}),B.jsx("p",{className:"text-lg text-zinc-400 max-w-2xl mx-auto",children:"Three simple steps to transform your security infrastructure"}),B.jsx("div",{className:"mt-8"})]})})}),B.jsx("div",{className:"bg-[#1f2022] mt-[-80px] pb-16 text-center",children:B.jsx(ML,{textAutoHide:!0,enableStars:!0,enableSpotlight:!0,enableBorderGlow:!0,enableTilt:!0,enableMagnetism:!1,clickEffect:!0,spotlightRadius:220,particleCount:8,glowColor:"59, 130, 246",columns:3,items:[{color:"#1F2022",title:"Detect",description:"AI models continuously analyze incoming camera frames and optional audio streams to flag weapons, threats, or gunshots with precision.",icon:B.jsx(W4,{className:"h-10 w-10 text-blue-400"}),maxLines:3},{color:"#1F2022",title:"Verify",description:"Security personnel approve or reject each alert in the Events panel with a clear thumbnail, location data, and confidence score for informed decisions.",icon:B.jsx(VT,{className:"h-10 w-10 text-blue-400"}),maxLines:3},{color:"#1F2022",title:"Escalate",description:"On approval, the system instantly notifies school administration and contacts local law enforcement automaticallyno delays, no missed alerts.",icon:B.jsx(JH,{className:"h-10 w-10 text-blue-400"}),maxLines:3}]})}),B.jsx("section",{className:"bg-gradient-to-b from-[#1f2022] to-black py-16 md:py-24",children:B.jsx("div",{className:"mx-auto max-w-6xl px-6",children:B.jsxs(nr.div,{initial:{opacity:0,y:20},whileInView:{opacity:1,y:0},viewport:{once:!0},transition:{duration:.6},className:"relative rounded-3xl border border-white/10 bg-gradient-to-br from-blue-500/10 to-transparent p-12 text-center overflow-hidden backdrop-blur",children:[B.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-blue-500/5 via-transparent to-transparent"}),B.jsxs("div",{className:"relative z-10",children:[B.jsx("h2",{className:"text-3xl md:text-4xl font-bold tracking-tight mb-4",children:"Ready to See Aegis in Action?"}),B.jsx("p",{className:"text-lg text-zinc-300 max-w-2xl mx-auto mb-8",children:"Explore the dashboard, review live alerts, and experience rapid escalation flows that can save lives."}),B.jsxs("div",{className:"flex flex-wrap items-center justify-center gap-4",children:[B.jsxs(_T,{to:"/account",className:"group relative rounded-full border border-blue-500/30 bg-blue-500/20 px-8 py-3 text-base font-medium backdrop-blur hover:bg-blue-500/30 focus:outline-none focus:ring-2 focus:ring-blue-500/40 transition-all",children:[B.jsx("span",{className:"relative z-10",children:"Get Started Now"}),B.jsx("div",{className:"absolute inset-0 rounded-full bg-blue-500/10 opacity-0 group-hover:opacity-100 transition-opacity"})]}),B.jsx(_T,{to:"/contact",className:"rounded-full border border-white/20 px-8 py-3 text-base font-medium hover:bg-white/10 focus:outline-none focus:ring-2 focus:ring-white/40 transition-all",children:"Request a Demo"})]})]})]})})})]})}var HB={exports:{}};/**
 * MapLibre GL JS
 * @license 3-Clause BSD. Full text of license: https://github.com/maplibre/maplibre-gl-js/blob/v5.9.0/LICENSE.txt
 */(function(t,e){(function(r,n){t.exports=n()})(Po,function(){var r={},n={};function s(l,a,m){if(n[l]=m,l==="index"){var y="var sharedModule = {}; ("+n.shared+")(sharedModule); ("+n.worker+")(sharedModule);",v={};return n.shared(v),n.index(r,v),typeof window<"u"&&r.setWorkerUrl(window.URL.createObjectURL(new Blob([y],{type:"text/javascript"}))),r}}s("shared",["exports"],function(l){function a(h,o,u,f){return new(u||(u=Promise))(function(g,b){function S(N){try{k(f.next(N))}catch(F){b(F)}}function C(N){try{k(f.throw(N))}catch(F){b(F)}}function k(N){var F;N.done?g(N.value):(F=N.value,F instanceof u?F:new u(function(G){G(F)})).then(S,C)}k((f=f.apply(h,o||[])).next())})}function m(h,o){this.x=h,this.y=o}function y(h){return h&&h.__esModule&&Object.prototype.hasOwnProperty.call(h,"default")?h.default:h}var v,T;typeof SuppressedError=="function"&&SuppressedError,m.prototype={clone(){return new m(this.x,this.y)},add(h){return this.clone()._add(h)},sub(h){return this.clone()._sub(h)},multByPoint(h){return this.clone()._multByPoint(h)},divByPoint(h){return this.clone()._divByPoint(h)},mult(h){return this.clone()._mult(h)},div(h){return this.clone()._div(h)},rotate(h){return this.clone()._rotate(h)},rotateAround(h,o){return this.clone()._rotateAround(h,o)},matMult(h){return this.clone()._matMult(h)},unit(){return this.clone()._unit()},perp(){return this.clone()._perp()},round(){return this.clone()._round()},mag(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals(h){return this.x===h.x&&this.y===h.y},dist(h){return Math.sqrt(this.distSqr(h))},distSqr(h){const o=h.x-this.x,u=h.y-this.y;return o*o+u*u},angle(){return Math.atan2(this.y,this.x)},angleTo(h){return Math.atan2(this.y-h.y,this.x-h.x)},angleWith(h){return this.angleWithSep(h.x,h.y)},angleWithSep(h,o){return Math.atan2(this.x*o-this.y*h,this.x*h+this.y*o)},_matMult(h){const o=h[2]*this.x+h[3]*this.y;return this.x=h[0]*this.x+h[1]*this.y,this.y=o,this},_add(h){return this.x+=h.x,this.y+=h.y,this},_sub(h){return this.x-=h.x,this.y-=h.y,this},_mult(h){return this.x*=h,this.y*=h,this},_div(h){return this.x/=h,this.y/=h,this},_multByPoint(h){return this.x*=h.x,this.y*=h.y,this},_divByPoint(h){return this.x/=h.x,this.y/=h.y,this},_unit(){return this._div(this.mag()),this},_perp(){const h=this.y;return this.y=this.x,this.x=-h,this},_rotate(h){const o=Math.cos(h),u=Math.sin(h),f=u*this.x+o*this.y;return this.x=o*this.x-u*this.y,this.y=f,this},_rotateAround(h,o){const u=Math.cos(h),f=Math.sin(h),g=o.y+f*(this.x-o.x)+u*(this.y-o.y);return this.x=o.x+u*(this.x-o.x)-f*(this.y-o.y),this.y=g,this},_round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},constructor:m},m.convert=function(h){if(h instanceof m)return h;if(Array.isArray(h))return new m(+h[0],+h[1]);if(h.x!==void 0&&h.y!==void 0)return new m(+h.x,+h.y);throw new Error("Expected [x, y] or {x, y} point format")};var P=function(){if(T)return v;function h(o,u,f,g){this.cx=3*o,this.bx=3*(f-o)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*u,this.by=3*(g-u)-this.cy,this.ay=1-this.cy-this.by,this.p1x=o,this.p1y=u,this.p2x=f,this.p2y=g}return T=1,v=h,h.prototype={sampleCurveX:function(o){return((this.ax*o+this.bx)*o+this.cx)*o},sampleCurveY:function(o){return((this.ay*o+this.by)*o+this.cy)*o},sampleCurveDerivativeX:function(o){return(3*this.ax*o+2*this.bx)*o+this.cx},solveCurveX:function(o,u){if(u===void 0&&(u=1e-6),o<0)return 0;if(o>1)return 1;for(var f=o,g=0;g<8;g++){var b=this.sampleCurveX(f)-o;if(Math.abs(b)<u)return f;var S=this.sampleCurveDerivativeX(f);if(Math.abs(S)<1e-6)break;f-=b/S}var C=0,k=1;for(f=o,g=0;g<20&&(b=this.sampleCurveX(f),!(Math.abs(b-o)<u));g++)o>b?C=f:k=f,f=.5*(k-C)+C;return f},solve:function(o,u){return this.sampleCurveY(this.solveCurveX(o,u))}},v}(),A=y(P);let O,I;function L(){return O==null&&(O=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")&&typeof createImageBitmap=="function"),O}function R(){if(I==null&&(I=!1,L())){const o=new OffscreenCanvas(5,5).getContext("2d",{willReadFrequently:!0});if(o){for(let f=0;f<5*5;f++){const g=4*f;o.fillStyle=`rgb(${g},${g+1},${g+2})`,o.fillRect(f%5,Math.floor(f/5),1,1)}const u=o.getImageData(0,0,5,5).data;for(let f=0;f<5*5*4;f++)if(f%4!=3&&u[f]!==f){I=!0;break}}}return I||!1}var z=1e-6,j=typeof Float32Array<"u"?Float32Array:Array;function W(){var h=new j(9);return j!=Float32Array&&(h[1]=0,h[2]=0,h[3]=0,h[5]=0,h[6]=0,h[7]=0),h[0]=1,h[4]=1,h[8]=1,h}function Z(h){return h[0]=1,h[1]=0,h[2]=0,h[3]=0,h[4]=0,h[5]=1,h[6]=0,h[7]=0,h[8]=0,h[9]=0,h[10]=1,h[11]=0,h[12]=0,h[13]=0,h[14]=0,h[15]=1,h}function te(){var h=new j(3);return j!=Float32Array&&(h[0]=0,h[1]=0,h[2]=0),h}function ie(h){var o=h[0],u=h[1],f=h[2];return Math.sqrt(o*o+u*u+f*f)}function V(h,o,u){var f=new j(3);return f[0]=h,f[1]=o,f[2]=u,f}function q(h,o,u){return h[0]=o[0]+u[0],h[1]=o[1]+u[1],h[2]=o[2]+u[2],h}function Q(h,o,u){return h[0]=o[0]*u,h[1]=o[1]*u,h[2]=o[2]*u,h}function ce(h,o,u){var f=o[0],g=o[1],b=o[2],S=u[0],C=u[1],k=u[2];return h[0]=g*k-b*C,h[1]=b*S-f*k,h[2]=f*C-g*S,h}var se,ue=ie;function he(h,o,u){var f=o[0],g=o[1],b=o[2],S=o[3];return h[0]=u[0]*f+u[4]*g+u[8]*b+u[12]*S,h[1]=u[1]*f+u[5]*g+u[9]*b+u[13]*S,h[2]=u[2]*f+u[6]*g+u[10]*b+u[14]*S,h[3]=u[3]*f+u[7]*g+u[11]*b+u[15]*S,h}function ye(){var h=new j(4);return j!=Float32Array&&(h[0]=0,h[1]=0,h[2]=0),h[3]=1,h}function xe(h,o,u,f){var g=arguments.length>4&&arguments[4]!==void 0?arguments[4]:"zyx",b=Math.PI/360;o*=b,f*=b,u*=b;var S=Math.sin(o),C=Math.cos(o),k=Math.sin(u),N=Math.cos(u),F=Math.sin(f),G=Math.cos(f);switch(g){case"xyz":h[0]=S*N*G+C*k*F,h[1]=C*k*G-S*N*F,h[2]=C*N*F+S*k*G,h[3]=C*N*G-S*k*F;break;case"xzy":h[0]=S*N*G-C*k*F,h[1]=C*k*G-S*N*F,h[2]=C*N*F+S*k*G,h[3]=C*N*G+S*k*F;break;case"yxz":h[0]=S*N*G+C*k*F,h[1]=C*k*G-S*N*F,h[2]=C*N*F-S*k*G,h[3]=C*N*G+S*k*F;break;case"yzx":h[0]=S*N*G+C*k*F,h[1]=C*k*G+S*N*F,h[2]=C*N*F-S*k*G,h[3]=C*N*G-S*k*F;break;case"zxy":h[0]=S*N*G-C*k*F,h[1]=C*k*G+S*N*F,h[2]=C*N*F+S*k*G,h[3]=C*N*G-S*k*F;break;case"zyx":h[0]=S*N*G-C*k*F,h[1]=C*k*G+S*N*F,h[2]=C*N*F-S*k*G,h[3]=C*N*G+S*k*F;break;default:throw new Error("Unknown angle order "+g)}return h}function Se(){var h=new j(2);return j!=Float32Array&&(h[0]=0,h[1]=0),h}function fe(h,o){var u=new j(2);return u[0]=h,u[1]=o,u}te(),se=new j(4),j!=Float32Array&&(se[0]=0,se[1]=0,se[2]=0,se[3]=0),te(),V(1,0,0),V(0,1,0),ye(),ye(),W(),Se();const ve=8192;function Re(h,o,u){return o*(ve/(h.tileSize*Math.pow(2,u-h.tileID.overscaledZ)))}function $e(h,o){return(h%o+o)%o}function Xe(h,o,u){return h*(1-u)+o*u}function st(h){if(h<=0)return 0;if(h>=1)return 1;const o=h*h,u=o*h;return 4*(h<.5?u:3*(h-o)+u-.75)}function at(h,o,u,f){const g=new A(h,o,u,f);return b=>g.solve(b)}const _t=at(.25,.1,.25,1);function Ct(h,o,u){return Math.min(u,Math.max(o,h))}function Pt(h,o,u){const f=u-o,g=((h-o)%f+f)%f+o;return g===o?u:g}function Ht(h,...o){for(const u of o)for(const f in u)h[f]=u[f];return h}let ir=1;function yr(h,o,u){const f={};for(const g in h)f[g]=o.call(this,h[g],g,h);return f}function $t(h,o,u){const f={};for(const g in h)o.call(this,h[g],g,h)&&(f[g]=h[g]);return f}function vt(h){return Array.isArray(h)?h.map(vt):typeof h=="object"&&h?yr(h,vt):h}const Et={};function Rt(h){Et[h]||(typeof console<"u"&&console.warn(h),Et[h]=!0)}function Ft(h,o,u){return(u.y-h.y)*(o.x-h.x)>(o.y-h.y)*(u.x-h.x)}function Nr(h){return typeof WorkerGlobalScope<"u"&&h!==void 0&&h instanceof WorkerGlobalScope}let Zr=null;function Kr(h){if(Zr==null){const o=h.navigator?h.navigator.userAgent:null;Zr=!!h.safari||!(!o||!(/\b(iPad|iPhone|iPod)\b/.test(o)||o.match("Safari")&&!o.match("Chrome")))}return Zr}function Ar(h){return typeof ImageBitmap<"u"&&h instanceof ImageBitmap}const Gn="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";function Nn(h,o,u,f,g){return a(this,void 0,void 0,function*(){if(typeof VideoFrame>"u")throw new Error("VideoFrame not supported");const b=new VideoFrame(h,{timestamp:0});try{const S=b==null?void 0:b.format;if(!S||!S.startsWith("BGR")&&!S.startsWith("RGB"))throw new Error(`Unrecognized format ${S}`);const C=S.startsWith("BGR"),k=new Uint8ClampedArray(f*g*4);if(yield b.copyTo(k,function(N,F,G,Y,J){const re=4*Math.max(-F,0),le=(Math.max(0,G)-G)*Y*4+re,pe=4*Y,be=Math.max(0,F),Fe=Math.max(0,G);return{rect:{x:be,y:Fe,width:Math.min(N.width,F+Y)-be,height:Math.min(N.height,G+J)-Fe},layout:[{offset:le,stride:pe}]}}(h,o,u,f,g)),C)for(let N=0;N<k.length;N+=4){const F=k[N];k[N]=k[N+2],k[N+2]=F}return k}finally{b.close()}})}let xi,rn;function Zt(h,o,u,f){return h.addEventListener(o,u,f),{unsubscribe:()=>{h.removeEventListener(o,u,f)}}}function Or(h){return h*Math.PI/180}function St(h){return h/Math.PI*180}const Sn={touchstart:!0,touchmove:!0,touchmoveWindow:!0,touchend:!0,touchcancel:!0},Br={dblclick:!0,click:!0,mouseover:!0,mouseout:!0,mousedown:!0,mousemove:!0,mousemoveWindow:!0,mouseup:!0,mouseupWindow:!0,contextmenu:!0,wheel:!0},Me="AbortError";function ne(){return new Error(Me)}const oe={MAX_PARALLEL_IMAGE_REQUESTS:16,MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:8,MAX_TILE_CACHE_ZOOM_LEVELS:5,REGISTERED_PROTOCOLS:{},WORKER_URL:""};function de(h){return oe.REGISTERED_PROTOCOLS[h.substring(0,h.indexOf("://"))]}const we="global-dispatcher";class Ae extends Error{constructor(o,u,f,g){super(`AJAXError: ${u} (${o}): ${f}`),this.status=o,this.statusText=u,this.url=f,this.body=g}}const Oe=()=>Nr(self)?self.worker&&self.worker.referrer:(window.location.protocol==="blob:"?window.parent:window).location.href,Be=function(h,o){if(/:\/\//.test(h.url)&&!/^https?:|^file:/.test(h.url)){const f=de(h.url);if(f)return f(h,o);if(Nr(self)&&self.worker&&self.worker.actor)return self.worker.actor.sendAsync({type:"GR",data:h,targetMapId:we},o)}if(!(/^file:/.test(u=h.url)||/^file:/.test(Oe())&&!/^\w+:/.test(u))){if(fetch&&Request&&AbortController&&Object.prototype.hasOwnProperty.call(Request.prototype,"signal"))return function(f,g){return a(this,void 0,void 0,function*(){const b=new Request(f.url,{method:f.method||"GET",body:f.body,credentials:f.credentials,headers:f.headers,cache:f.cache,referrer:Oe(),signal:g.signal});let S,C;f.type!=="json"||b.headers.has("Accept")||b.headers.set("Accept","application/json");try{S=yield fetch(b)}catch(N){throw new Ae(0,N.message,f.url,new Blob)}if(!S.ok){const N=yield S.blob();throw new Ae(S.status,S.statusText,f.url,N)}C=f.type==="arrayBuffer"||f.type==="image"?S.arrayBuffer():f.type==="json"?S.json():S.text();const k=yield C;if(g.signal.aborted)throw ne();return{data:k,cacheControl:S.headers.get("Cache-Control"),expires:S.headers.get("Expires")}})}(h,o);if(Nr(self)&&self.worker&&self.worker.actor)return self.worker.actor.sendAsync({type:"GR",data:h,mustQueue:!0,targetMapId:we},o)}var u;return function(f,g){return new Promise((b,S)=>{var C;const k=new XMLHttpRequest;k.open(f.method||"GET",f.url,!0),f.type!=="arrayBuffer"&&f.type!=="image"||(k.responseType="arraybuffer");for(const N in f.headers)k.setRequestHeader(N,f.headers[N]);f.type==="json"&&(k.responseType="text",!((C=f.headers)===null||C===void 0)&&C.Accept||k.setRequestHeader("Accept","application/json")),k.withCredentials=f.credentials==="include",k.onerror=()=>{S(new Error(k.statusText))},k.onload=()=>{if(!g.signal.aborted)if((k.status>=200&&k.status<300||k.status===0)&&k.response!==null){let N=k.response;if(f.type==="json")try{N=JSON.parse(k.response)}catch(F){return void S(F)}b({data:N,cacheControl:k.getResponseHeader("Cache-Control"),expires:k.getResponseHeader("Expires")})}else{const N=new Blob([k.response],{type:k.getResponseHeader("Content-Type")});S(new Ae(k.status,k.statusText,f.url,N))}},g.signal.addEventListener("abort",()=>{k.abort(),S(ne())}),k.send(f.body)})}(h,o)};function ze(h){if(!h||h.indexOf("://")<=0||h.indexOf("data:image/")===0||h.indexOf("blob:")===0)return!0;const o=new URL(h),u=window.location;return o.protocol===u.protocol&&o.host===u.host}function He(h,o,u){u[h]&&u[h].indexOf(o)!==-1||(u[h]=u[h]||[],u[h].push(o))}function nt(h,o,u){if(u&&u[h]){const f=u[h].indexOf(o);f!==-1&&u[h].splice(f,1)}}class Qe{constructor(o,u={}){Ht(this,u),this.type=o}}class Tt extends Qe{constructor(o,u={}){super("error",Ht({error:o},u))}}class It{on(o,u){return this._listeners=this._listeners||{},He(o,u,this._listeners),{unsubscribe:()=>{this.off(o,u)}}}off(o,u){return nt(o,u,this._listeners),nt(o,u,this._oneTimeListeners),this}once(o,u){return u?(this._oneTimeListeners=this._oneTimeListeners||{},He(o,u,this._oneTimeListeners),this):new Promise(f=>this.once(o,f))}fire(o,u){typeof o=="string"&&(o=new Qe(o,u||{}));const f=o.type;if(this.listens(f)){o.target=this;const g=this._listeners&&this._listeners[f]?this._listeners[f].slice():[];for(const C of g)C.call(this,o);const b=this._oneTimeListeners&&this._oneTimeListeners[f]?this._oneTimeListeners[f].slice():[];for(const C of b)nt(f,C,this._oneTimeListeners),C.call(this,o);const S=this._eventedParent;S&&(Ht(o,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),S.fire(o))}else o instanceof Tt&&console.error(o.error);return this}listens(o){return this._listeners&&this._listeners[o]&&this._listeners[o].length>0||this._oneTimeListeners&&this._oneTimeListeners[o]&&this._oneTimeListeners[o].length>0||this._eventedParent&&this._eventedParent.listens(o)}setEventedParent(o,u){return this._eventedParent=o,this._eventedParentData=u,this}}var je={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},centerAltitude:{type:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},roll:{type:"number",default:0,units:"degrees"},state:{type:"state",default:{}},light:{type:"light"},sky:{type:"sky"},projection:{type:"projection"},terrain:{type:"terrain"},sources:{required:!0,type:"sources"},sprite:{type:"sprite"},glyphs:{type:"string"},"font-faces":{type:"array",value:"fontFaces"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],source_vector:{type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster:{type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster_dem:{type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{},custom:{}},default:"mapbox"},redFactor:{type:"number",default:1},blueFactor:{type:"number",default:1},greenFactor:{type:"number",default:1},baseShift:{type:"number",default:0},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{}}},data:{required:!0,type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},filter:{type:"*"},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterMinPoints:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},"color-relief":{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_color-relief","layout_background"],layout_background:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_fill:{"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_circle:{"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_heatmap:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_line:{"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_symbol:{"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image",{"!":"icon-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"padding",default:[2],units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},"viewport-glyph":{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-variable-anchor-offset":{type:"variableAnchorOffsetCollection",requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field",{"!":"text-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_raster:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_hillshade:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_color-relief":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},filter:{type:"array",value:"*"},filter_operator:{type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{}}},geometry_type:{type:"enum",values:{Point:{},LineString:{},Polygon:{}}},function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:{type:"array",minimum:0,maximum:24,value:["number","color"],length:2},expression:{type:"array",value:"*",minimum:1},light:{anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},sky:{"sky-color":{type:"color","property-type":"data-constant",default:"#88C6FC",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"horizon-color":{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"fog-color":{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"fog-ground-blend":{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"horizon-fog-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"sky-horizon-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"atmosphere-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},terrain:{source:{type:"string",required:!0},exaggeration:{type:"number",minimum:0,default:1}},projection:{type:{type:"projectionDefinition",default:"mercator","property-type":"data-constant",transition:!1,expression:{interpolated:!0,parameters:["zoom"]}}},paint:["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_color-relief","paint_background"],paint_fill:{"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:{"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},paint_heatmap:{"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_symbol:{"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_raster:{"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_hillshade:{"hillshade-illumination-direction":{type:"numberArray",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-altitude":{type:"numberArray",default:45,minimum:0,maximum:90,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"colorArray",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"colorArray",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-method":{type:"enum",values:{standard:{},basic:{},combined:{},igor:{},multidirectional:{}},default:"standard",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},"paint_color-relief":{"color-relief-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"color-relief-color":{type:"color",transition:!1,expression:{interpolated:!0,parameters:["elevation"]},"property-type":"color-ramp"}},paint_background:{"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:{"*":{type:"string"}}};const Kt=["type","source","source-layer","minzoom","maxzoom","filter","layout"];function wt(h,o){const u={};for(const f in h)f!=="ref"&&(u[f]=h[f]);return Kt.forEach(f=>{f in o&&(u[f]=o[f])}),u}function lt(h,o){if(Array.isArray(h)){if(!Array.isArray(o)||h.length!==o.length)return!1;for(let u=0;u<h.length;u++)if(!lt(h[u],o[u]))return!1;return!0}if(typeof h=="object"&&h!==null&&o!==null){if(typeof o!="object"||Object.keys(h).length!==Object.keys(o).length)return!1;for(const u in h)if(!lt(h[u],o[u]))return!1;return!0}return h===o}function Dt(h,o){h.push(o)}function _r(h,o,u){Dt(u,{command:"addSource",args:[h,o[h]]})}function xr(h,o,u){Dt(o,{command:"removeSource",args:[h]}),u[h]=!0}function kr(h,o,u,f){xr(h,u,f),_r(h,o,u)}function Vr(h,o,u){let f;for(f in h[u])if(Object.prototype.hasOwnProperty.call(h[u],f)&&f!=="data"&&!lt(h[u][f],o[u][f]))return!1;for(f in o[u])if(Object.prototype.hasOwnProperty.call(o[u],f)&&f!=="data"&&!lt(h[u][f],o[u][f]))return!1;return!0}function tr(h,o,u,f,g,b){h=h||{},o=o||{};for(const S in h)Object.prototype.hasOwnProperty.call(h,S)&&(lt(h[S],o[S])||u.push({command:b,args:[f,S,o[S],g]}));for(const S in o)Object.prototype.hasOwnProperty.call(o,S)&&!Object.prototype.hasOwnProperty.call(h,S)&&(lt(h[S],o[S])||u.push({command:b,args:[f,S,o[S],g]}))}function zr(h){return h.id}function Tr(h,o){return h[o.id]=o,h}class ot{constructor(o,u,f,g){this.message=(o?`${o}: `:"")+f,g&&(this.identifier=g),u!=null&&u.__line__&&(this.line=u.__line__)}}function Ds(h,...o){for(const u of o)for(const f in u)h[f]=u[f];return h}class Bi extends Error{constructor(o,u){super(u),this.message=u,this.key=o}}class $i{constructor(o,u=[]){this.parent=o,this.bindings={};for(const[f,g]of u)this.bindings[f]=g}concat(o){return new $i(this,o)}get(o){if(this.bindings[o])return this.bindings[o];if(this.parent)return this.parent.get(o);throw new Error(`${o} not found in scope.`)}has(o){return!!this.bindings[o]||!!this.parent&&this.parent.has(o)}}const Tn={kind:"null"},dt={kind:"number"},er={kind:"string"},Yt={kind:"boolean"},Vi={kind:"color"},Ze={kind:"projectionDefinition"},or={kind:"object"},Nt={kind:"value"},En={kind:"collator"},Wn={kind:"formatted"},ri={kind:"padding"},Ri={kind:"colorArray"},hr={kind:"numberArray"},ys={kind:"resolvedImage"},br={kind:"variableAnchorOffsetCollection"};function bi(h,o){return{kind:"array",itemType:h,N:o}}function wr(h){if(h.kind==="array"){const o=wr(h.itemType);return typeof h.N=="number"?`array<${o}, ${h.N}>`:h.itemType.kind==="value"?"array":`array<${o}>`}return h.kind}const La=[Tn,dt,er,Yt,Vi,Ze,Wn,or,bi(Nt),ri,hr,Ri,ys,br];function Ls(h,o){if(o.kind==="error")return null;if(h.kind==="array"){if(o.kind==="array"&&(o.N===0&&o.itemType.kind==="value"||!Ls(h.itemType,o.itemType))&&(typeof h.N!="number"||h.N===o.N))return null}else{if(h.kind===o.kind)return null;if(h.kind==="value"){for(const u of La)if(!Ls(u,o))return null}}return`Expected ${wr(h)} but found ${wr(o)} instead.`}function Wu(h,o){return o.some(u=>u.kind===h.kind)}function Os(h,o){return o.some(u=>u==="null"?h===null:u==="array"?Array.isArray(h):u==="object"?h&&!Array.isArray(h)&&typeof h=="object":u===typeof h)}function Ui(h,o){return h.kind==="array"&&o.kind==="array"?h.itemType.kind===o.itemType.kind&&typeof h.N=="number":h.kind===o.kind}const qn=.96422,Pm=.82521,i_=4/29,pc=6/29,s_=3*pc*pc,z1=pc*pc*pc,N1=Math.PI/180,j1=180/Math.PI;function o_(h){return(h%=360)<0&&(h+=360),h}function Am([h,o,u,f]){let g,b;const S=km((.2225045*(h=vl(h))+.7168786*(o=vl(o))+.0606169*(u=vl(u)))/1);h===o&&o===u?g=b=S:(g=km((.4360747*h+.3850649*o+.1430804*u)/qn),b=km((.0139322*h+.0971045*o+.7141733*u)/Pm));const C=116*S-16;return[C<0?0:C,500*(g-S),200*(S-b),f]}function vl(h){return h<=.04045?h/12.92:Math.pow((h+.055)/1.055,2.4)}function km(h){return h>z1?Math.pow(h,1/3):h/s_+i_}function a_([h,o,u,f]){let g=(h+16)/116,b=isNaN(o)?g:g+o/500,S=isNaN(u)?g:g-u/200;return g=1*Mm(g),b=qn*Mm(b),S=Pm*Mm(S),[xl(3.1338561*b-1.6168667*g-.4906146*S),xl(-.9787684*b+1.9161415*g+.033454*S),xl(.0719453*b-.2289914*g+1.4052427*S),f]}function xl(h){return(h=h<=.00304?12.92*h:1.055*Math.pow(h,1/2.4)-.055)<0?0:h>1?1:h}function Mm(h){return h>pc?h*h*h:s_*(h-i_)}const F1=Object.hasOwn||function(h,o){return Object.prototype.hasOwnProperty.call(h,o)};function qu(h,o){return F1(h,o)?h[o]:void 0}function Hu(h){return parseInt(h.padEnd(2,h),16)/255}function Im(h,o){return Gi(o?h/100:h,0,1)}function Gi(h,o,u){return Math.min(Math.max(o,h),u)}function mr(h){return!h.some(Number.isNaN)}const mc={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]};function Wi(h,o,u){return h+u*(o-h)}function bl(h,o,u){return h.map((f,g)=>Wi(f,o[g],u))}class ar{constructor(o,u,f,g=1,b=!0){this.r=o,this.g=u,this.b=f,this.a=g,b||(this.r*=g,this.g*=g,this.b*=g,g||this.overwriteGetter("rgb",[o,u,f,g]))}static parse(o){if(o instanceof ar)return o;if(typeof o!="string")return;const u=function(f){if((f=f.toLowerCase().trim())==="transparent")return[0,0,0,0];const g=qu(mc,f);if(g){const[S,C,k]=g;return[S/255,C/255,k/255,1]}if(f.startsWith("#")&&/^#(?:[0-9a-f]{3,4}|[0-9a-f]{6}|[0-9a-f]{8})$/.test(f)){const S=f.length<6?1:2;let C=1;return[Hu(f.slice(C,C+=S)),Hu(f.slice(C,C+=S)),Hu(f.slice(C,C+=S)),Hu(f.slice(C,C+S)||"ff")]}if(f.startsWith("rgb")){const S=f.match(/^rgba?\(\s*([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(S){const[C,k,N,F,G,Y,J,re,le,pe,be,Fe]=S,ke=[F||" ",J||" ",pe].join("");if(ke==="  "||ke==="  /"||ke===",,"||ke===",,,"){const De=[N,Y,le].join(""),Ue=De==="%%%"?100:De===""?255:0;if(Ue){const Ke=[Gi(+k/Ue,0,1),Gi(+G/Ue,0,1),Gi(+re/Ue,0,1),be?Im(+be,Fe):1];if(mr(Ke))return Ke}}return}}const b=f.match(/^hsla?\(\s*([\de.+-]+)(?:deg)?(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(b){const[S,C,k,N,F,G,Y,J,re]=b,le=[k||" ",F||" ",Y].join("");if(le==="  "||le==="  /"||le===",,"||le===",,,"){const pe=[+C,Gi(+N,0,100),Gi(+G,0,100),J?Im(+J,re):1];if(mr(pe))return function([be,Fe,ke,De]){function Ue(Ke){const it=(Ke+be/30)%12,yt=Fe*Math.min(ke,1-ke);return ke-yt*Math.max(-1,Math.min(it-3,9-it,1))}return be=o_(be),Fe/=100,ke/=100,[Ue(0),Ue(8),Ue(4),De]}(pe)}}}(o);return u?new ar(...u,!1):void 0}get rgb(){const{r:o,g:u,b:f,a:g}=this,b=g||1/0;return this.overwriteGetter("rgb",[o/b,u/b,f/b,g])}get hcl(){return this.overwriteGetter("hcl",function(o){const[u,f,g,b]=Am(o),S=Math.sqrt(f*f+g*g);return[Math.round(1e4*S)?o_(Math.atan2(g,f)*j1):NaN,S,u,b]}(this.rgb))}get lab(){return this.overwriteGetter("lab",Am(this.rgb))}overwriteGetter(o,u){return Object.defineProperty(this,o,{value:u}),u}toString(){const[o,u,f,g]=this.rgb;return`rgba(${[o,u,f].map(b=>Math.round(255*b)).join(",")},${g})`}static interpolate(o,u,f,g="rgb"){switch(g){case"rgb":{const[b,S,C,k]=bl(o.rgb,u.rgb,f);return new ar(b,S,C,k,!1)}case"hcl":{const[b,S,C,k]=o.hcl,[N,F,G,Y]=u.hcl;let J,re;if(isNaN(b)||isNaN(N))isNaN(b)?isNaN(N)?J=NaN:(J=N,C!==1&&C!==0||(re=F)):(J=b,G!==1&&G!==0||(re=S));else{let ke=N-b;N>b&&ke>180?ke-=360:N<b&&b-N>180&&(ke+=360),J=b+f*ke}const[le,pe,be,Fe]=function([ke,De,Ue,Ke]){return ke=isNaN(ke)?0:ke*N1,a_([Ue,Math.cos(ke)*De,Math.sin(ke)*De,Ke])}([J,re??Wi(S,F,f),Wi(C,G,f),Wi(k,Y,f)]);return new ar(le,pe,be,Fe,!1)}case"lab":{const[b,S,C,k]=a_(bl(o.lab,u.lab,f));return new ar(b,S,C,k,!1)}}}}ar.black=new ar(0,0,0,1),ar.white=new ar(1,1,1,1),ar.transparent=new ar(0,0,0,0),ar.red=new ar(1,0,0,1);class Zu{constructor(o,u,f){this.sensitivity=o?u?"variant":"case":u?"accent":"base",this.locale=f,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(o,u){return this.collator.compare(o,u)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}const Ku=["bottom","center","top"];class gc{constructor(o,u,f,g,b,S){this.text=o,this.image=u,this.scale=f,this.fontStack=g,this.textColor=b,this.verticalAlign=S}}class rs{constructor(o){this.sections=o}static fromString(o){return new rs([new gc(o,null,null,null,null,null)])}isEmpty(){return this.sections.length===0||!this.sections.some(o=>o.text.length!==0||o.image&&o.image.name.length!==0)}static factory(o){return o instanceof rs?o:rs.fromString(o)}toString(){return this.sections.length===0?"":this.sections.map(o=>o.text).join("")}}class wi{constructor(o){this.values=o.slice()}static parse(o){if(o instanceof wi)return o;if(typeof o=="number")return new wi([o,o,o,o]);if(Array.isArray(o)&&!(o.length<1||o.length>4)){for(const u of o)if(typeof u!="number")return;switch(o.length){case 1:o=[o[0],o[0],o[0],o[0]];break;case 2:o=[o[0],o[1],o[0],o[1]];break;case 3:o=[o[0],o[1],o[2],o[1]]}return new wi(o)}}toString(){return JSON.stringify(this.values)}static interpolate(o,u,f){return new wi(bl(o.values,u.values,f))}}class ni{constructor(o){this.values=o.slice()}static parse(o){if(o instanceof ni)return o;if(typeof o=="number")return new ni([o]);if(Array.isArray(o)){for(const u of o)if(typeof u!="number")return;return new ni(o)}}toString(){return JSON.stringify(this.values)}static interpolate(o,u,f){return new ni(bl(o.values,u.values,f))}}class Si{constructor(o){this.values=o.slice()}static parse(o){if(o instanceof Si)return o;if(typeof o=="string"){const f=ar.parse(o);return f?new Si([f]):void 0}if(!Array.isArray(o))return;const u=[];for(const f of o){if(typeof f!="string")return;const g=ar.parse(f);if(!g)return;u.push(g)}return new Si(u)}toString(){return JSON.stringify(this.values)}static interpolate(o,u,f,g="rgb"){const b=[];if(o.values.length!=u.values.length)throw new Error(`colorArray: Arrays have mismatched length (${o.values.length} vs. ${u.values.length}), cannot interpolate.`);for(let S=0;S<o.values.length;S++)b.push(ar.interpolate(o.values[S],u.values[S],f,g));return new Si(b)}}class qr extends Error{constructor(o){super(o),this.name="RuntimeError"}toJSON(){return this.message}}const yc=new Set(["center","left","right","top","bottom","top-left","top-right","bottom-left","bottom-right"]);class qi{constructor(o){this.values=o.slice()}static parse(o){if(o instanceof qi)return o;if(Array.isArray(o)&&!(o.length<1)&&o.length%2==0){for(let u=0;u<o.length;u+=2){const f=o[u],g=o[u+1];if(typeof f!="string"||!yc.has(f)||!Array.isArray(g)||g.length!==2||typeof g[0]!="number"||typeof g[1]!="number")return}return new qi(o)}}toString(){return JSON.stringify(this.values)}static interpolate(o,u,f){const g=o.values,b=u.values;if(g.length!==b.length)throw new qr(`Cannot interpolate values of different length. from: ${o.toString()}, to: ${u.toString()}`);const S=[];for(let C=0;C<g.length;C+=2){if(g[C]!==b[C])throw new qr(`Cannot interpolate values containing mismatched anchors. from[${C}]: ${g[C]}, to[${C}]: ${b[C]}`);S.push(g[C]);const[k,N]=g[C+1],[F,G]=b[C+1];S.push([Wi(k,F,f),Wi(N,G,f)])}return new qi(S)}}class _s{constructor(o){this.name=o.name,this.available=o.available}toString(){return this.name}static fromString(o){return o?new _s({name:o,available:!1}):null}}class ns{constructor(o,u,f){this.from=o,this.to=u,this.transition=f}static interpolate(o,u,f){return new ns(o,u,f)}static parse(o){return o instanceof ns?o:Array.isArray(o)&&o.length===3&&typeof o[0]=="string"&&typeof o[1]=="string"&&typeof o[2]=="number"?new ns(o[0],o[1],o[2]):typeof o=="object"&&typeof o.from=="string"&&typeof o.to=="string"&&typeof o.transition=="number"?new ns(o.from,o.to,o.transition):typeof o=="string"?new ns(o,o,1):void 0}}function Xu(h,o,u,f){return typeof h=="number"&&h>=0&&h<=255&&typeof o=="number"&&o>=0&&o<=255&&typeof u=="number"&&u>=0&&u<=255?f===void 0||typeof f=="number"&&f>=0&&f<=1?null:`Invalid rgba value [${[h,o,u,f].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${(typeof f=="number"?[h,o,u,f]:[h,o,u]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function jr(h){if(h===null||typeof h=="string"||typeof h=="boolean"||typeof h=="number"||h instanceof ns||h instanceof ar||h instanceof Zu||h instanceof rs||h instanceof wi||h instanceof ni||h instanceof Si||h instanceof qi||h instanceof _s)return!0;if(Array.isArray(h)){for(const o of h)if(!jr(o))return!1;return!0}if(typeof h=="object"){for(const o in h)if(!jr(h[o]))return!1;return!0}return!1}function un(h){if(h===null)return Tn;if(typeof h=="string")return er;if(typeof h=="boolean")return Yt;if(typeof h=="number")return dt;if(h instanceof ar)return Vi;if(h instanceof ns)return Ze;if(h instanceof Zu)return En;if(h instanceof rs)return Wn;if(h instanceof wi)return ri;if(h instanceof ni)return hr;if(h instanceof Si)return Ri;if(h instanceof qi)return br;if(h instanceof _s)return ys;if(Array.isArray(h)){const o=h.length;let u;for(const f of h){const g=un(f);if(u){if(u===g)continue;u=Nt;break}u=g}return bi(u||Nt,o)}return or}function dr(h){const o=typeof h;return h===null?"":o==="string"||o==="number"||o==="boolean"?String(h):h instanceof ar||h instanceof ns||h instanceof rs||h instanceof wi||h instanceof ni||h instanceof Si||h instanceof qi||h instanceof _s?h.toString():JSON.stringify(h)}class Wt{constructor(o,u){this.type=o,this.value=u}static parse(o,u){if(o.length!==2)return u.error(`'literal' expression requires exactly one argument, but found ${o.length-1} instead.`);if(!jr(o[1]))return u.error("invalid value");const f=o[1];let g=un(f);const b=u.expectedType;return g.kind!=="array"||g.N!==0||!b||b.kind!=="array"||typeof b.N=="number"&&b.N!==0||(g=b),new Wt(g,f)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}}const _c={string:er,number:dt,boolean:Yt,object:or};class Qt{constructor(o,u){this.type=o,this.args=u}static parse(o,u){if(o.length<2)return u.error("Expected at least one argument.");let f,g=1;const b=o[0];if(b==="array"){let C,k;if(o.length>2){const N=o[1];if(typeof N!="string"||!(N in _c)||N==="object")return u.error('The item type argument of "array" must be one of string, number, boolean',1);C=_c[N],g++}else C=Nt;if(o.length>3){if(o[2]!==null&&(typeof o[2]!="number"||o[2]<0||o[2]!==Math.floor(o[2])))return u.error('The length argument to "array" must be a positive integer literal',2);k=o[2],g++}f=bi(C,k)}else{if(!_c[b])throw new Error(`Types doesn't contain name = ${b}`);f=_c[b]}const S=[];for(;g<o.length;g++){const C=u.parse(o[g],g,Nt);if(!C)return null;S.push(C)}return new Qt(f,S)}evaluate(o){for(let u=0;u<this.args.length;u++){const f=this.args[u].evaluate(o);if(!Ls(this.type,un(f)))return f;if(u===this.args.length-1)throw new qr(`Expected value to be of type ${wr(this.type)}, but found ${wr(un(f))} instead.`)}throw new Error}eachChild(o){this.args.forEach(o)}outputDefined(){return this.args.every(o=>o.outputDefined())}}const zd={"to-boolean":Yt,"to-color":Vi,"to-number":dt,"to-string":er};class Di{constructor(o,u){this.type=o,this.args=u}static parse(o,u){if(o.length<2)return u.error("Expected at least one argument.");const f=o[0];if(!zd[f])throw new Error(`Can't parse ${f} as it is not part of the known types`);if((f==="to-boolean"||f==="to-string")&&o.length!==2)return u.error("Expected one argument.");const g=zd[f],b=[];for(let S=1;S<o.length;S++){const C=u.parse(o[S],S,Nt);if(!C)return null;b.push(C)}return new Di(g,b)}evaluate(o){switch(this.type.kind){case"boolean":return!!this.args[0].evaluate(o);case"color":{let u,f;for(const g of this.args){if(u=g.evaluate(o),f=null,u instanceof ar)return u;if(typeof u=="string"){const b=o.parseColor(u);if(b)return b}else if(Array.isArray(u)&&(f=u.length<3||u.length>4?`Invalid rgba value ${JSON.stringify(u)}: expected an array containing either three or four numeric values.`:Xu(u[0],u[1],u[2],u[3]),!f))return new ar(u[0]/255,u[1]/255,u[2]/255,u[3])}throw new qr(f||`Could not parse color from value '${typeof u=="string"?u:JSON.stringify(u)}'`)}case"padding":{let u;for(const f of this.args){u=f.evaluate(o);const g=wi.parse(u);if(g)return g}throw new qr(`Could not parse padding from value '${typeof u=="string"?u:JSON.stringify(u)}'`)}case"numberArray":{let u;for(const f of this.args){u=f.evaluate(o);const g=ni.parse(u);if(g)return g}throw new qr(`Could not parse numberArray from value '${typeof u=="string"?u:JSON.stringify(u)}'`)}case"colorArray":{let u;for(const f of this.args){u=f.evaluate(o);const g=Si.parse(u);if(g)return g}throw new qr(`Could not parse colorArray from value '${typeof u=="string"?u:JSON.stringify(u)}'`)}case"variableAnchorOffsetCollection":{let u;for(const f of this.args){u=f.evaluate(o);const g=qi.parse(u);if(g)return g}throw new qr(`Could not parse variableAnchorOffsetCollection from value '${typeof u=="string"?u:JSON.stringify(u)}'`)}case"number":{let u=null;for(const f of this.args){if(u=f.evaluate(o),u===null)return 0;const g=Number(u);if(!isNaN(g))return g}throw new qr(`Could not convert ${JSON.stringify(u)} to number.`)}case"formatted":return rs.fromString(dr(this.args[0].evaluate(o)));case"resolvedImage":return _s.fromString(dr(this.args[0].evaluate(o)));case"projectionDefinition":return this.args[0].evaluate(o);default:return dr(this.args[0].evaluate(o))}}eachChild(o){this.args.forEach(o)}outputDefined(){return this.args.every(o=>o.outputDefined())}}const Rm=["Unknown","Point","LineString","Polygon"];class Yu{constructor(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache=new Map,this.availableImages=null,this.canonical=null}id(){return this.feature&&"id"in this.feature?this.feature.id:null}geometryType(){return this.feature?typeof this.feature.type=="number"?Rm[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}parseColor(o){let u=this._parseColorCache.get(o);return u||(u=ar.parse(o),this._parseColorCache.set(o,u)),u}}class Qu{constructor(o,u,f=[],g,b=new $i,S=[]){this.registry=o,this.path=f,this.key=f.map(C=>`[${C}]`).join(""),this.scope=b,this.errors=S,this.expectedType=g,this._isConstant=u}parse(o,u,f,g,b={}){return u?this.concat(u,f,g)._parse(o,b):this._parse(o,b)}_parse(o,u){function f(g,b,S){return S==="assert"?new Qt(b,[g]):S==="coerce"?new Di(b,[g]):g}if(o!==null&&typeof o!="string"&&typeof o!="boolean"&&typeof o!="number"||(o=["literal",o]),Array.isArray(o)){if(o.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const g=o[0];if(typeof g!="string")return this.error(`Expression name must be a string, but found ${typeof g} instead. If you wanted a literal array, use ["literal", [...]].`,0),null;const b=this.registry[g];if(b){let S=b.parse(o,this);if(!S)return null;if(this.expectedType){const C=this.expectedType,k=S.type;if(C.kind!=="string"&&C.kind!=="number"&&C.kind!=="boolean"&&C.kind!=="object"&&C.kind!=="array"||k.kind!=="value"){if(C.kind==="projectionDefinition"&&["string","array"].includes(k.kind)||["color","formatted","resolvedImage"].includes(C.kind)&&["value","string"].includes(k.kind)||["padding","numberArray"].includes(C.kind)&&["value","number","array"].includes(k.kind)||C.kind==="colorArray"&&["value","string","array"].includes(k.kind)||C.kind==="variableAnchorOffsetCollection"&&["value","array"].includes(k.kind))S=f(S,C,u.typeAnnotation||"coerce");else if(this.checkSubtype(C,k))return null}else S=f(S,C,u.typeAnnotation||"assert")}if(!(S instanceof Wt)&&S.type.kind!=="resolvedImage"&&this._isConstant(S)){const C=new Yu;try{S=new Wt(S.type,S.evaluate(C))}catch(k){return this.error(k.message),null}}return S}return this.error(`Unknown expression "${g}". If you wanted a literal array, use ["literal", [...]].`,0)}return this.error(o===void 0?"'undefined' value invalid. Use null instead.":typeof o=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof o} instead.`)}concat(o,u,f){const g=typeof o=="number"?this.path.concat(o):this.path,b=f?this.scope.concat(f):this.scope;return new Qu(this.registry,this._isConstant,g,u||null,b,this.errors)}error(o,...u){const f=`${this.key}${u.map(g=>`[${g}]`).join("")}`;this.errors.push(new Bi(f,o))}checkSubtype(o,u){const f=Ls(o,u);return f&&this.error(f),f}}class vc{constructor(o,u){this.type=u.type,this.bindings=[].concat(o),this.result=u}evaluate(o){return this.result.evaluate(o)}eachChild(o){for(const u of this.bindings)o(u[1]);o(this.result)}static parse(o,u){if(o.length<4)return u.error(`Expected at least 3 arguments, but found ${o.length-1} instead.`);const f=[];for(let b=1;b<o.length-1;b+=2){const S=o[b];if(typeof S!="string")return u.error(`Expected string, but found ${typeof S} instead.`,b);if(/[^a-zA-Z0-9_]/.test(S))return u.error("Variable names must contain only alphanumeric characters or '_'.",b);const C=u.parse(o[b+1],b+1);if(!C)return null;f.push([S,C])}const g=u.parse(o[o.length-1],o.length-1,u.expectedType,f);return g?new vc(f,g):null}outputDefined(){return this.result.outputDefined()}}class Ju{constructor(o,u){this.type=u.type,this.name=o,this.boundExpression=u}static parse(o,u){if(o.length!==2||typeof o[1]!="string")return u.error("'var' expression requires exactly one string literal argument.");const f=o[1];return u.scope.has(f)?new Ju(f,u.scope.get(f)):u.error(`Unknown variable "${f}". Make sure "${f}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(o){return this.boundExpression.evaluate(o)}eachChild(){}outputDefined(){return!1}}class Dm{constructor(o,u,f){this.type=o,this.index=u,this.input=f}static parse(o,u){if(o.length!==3)return u.error(`Expected 2 arguments, but found ${o.length-1} instead.`);const f=u.parse(o[1],1,dt),g=u.parse(o[2],2,bi(u.expectedType||Nt));return f&&g?new Dm(g.type.itemType,f,g):null}evaluate(o){const u=this.index.evaluate(o),f=this.input.evaluate(o);if(u<0)throw new qr(`Array index out of bounds: ${u} < 0.`);if(u>=f.length)throw new qr(`Array index out of bounds: ${u} > ${f.length-1}.`);if(u!==Math.floor(u))throw new qr(`Array index must be an integer, but found ${u} instead.`);return f[u]}eachChild(o){o(this.index),o(this.input)}outputDefined(){return!1}}class Nd{constructor(o,u){this.type=Yt,this.needle=o,this.haystack=u}static parse(o,u){if(o.length!==3)return u.error(`Expected 2 arguments, but found ${o.length-1} instead.`);const f=u.parse(o[1],1,Nt),g=u.parse(o[2],2,Nt);return f&&g?Wu(f.type,[Yt,er,dt,Tn,Nt])?new Nd(f,g):u.error(`Expected first argument to be of type boolean, string, number or null, but found ${wr(f.type)} instead`):null}evaluate(o){const u=this.needle.evaluate(o),f=this.haystack.evaluate(o);if(!f)return!1;if(!Os(u,["boolean","string","number","null"]))throw new qr(`Expected first argument to be of type boolean, string, number or null, but found ${wr(un(u))} instead.`);if(!Os(f,["string","array"]))throw new qr(`Expected second argument to be of type array or string, but found ${wr(un(f))} instead.`);return f.indexOf(u)>=0}eachChild(o){o(this.needle),o(this.haystack)}outputDefined(){return!0}}class eh{constructor(o,u,f){this.type=dt,this.needle=o,this.haystack=u,this.fromIndex=f}static parse(o,u){if(o.length<=2||o.length>=5)return u.error(`Expected 2 or 3 arguments, but found ${o.length-1} instead.`);const f=u.parse(o[1],1,Nt),g=u.parse(o[2],2,Nt);if(!f||!g)return null;if(!Wu(f.type,[Yt,er,dt,Tn,Nt]))return u.error(`Expected first argument to be of type boolean, string, number or null, but found ${wr(f.type)} instead`);if(o.length===4){const b=u.parse(o[3],3,dt);return b?new eh(f,g,b):null}return new eh(f,g)}evaluate(o){const u=this.needle.evaluate(o),f=this.haystack.evaluate(o);if(!Os(u,["boolean","string","number","null"]))throw new qr(`Expected first argument to be of type boolean, string, number or null, but found ${wr(un(u))} instead.`);let g;if(this.fromIndex&&(g=this.fromIndex.evaluate(o)),Os(f,["string"])){const b=f.indexOf(u,g);return b===-1?-1:[...f.slice(0,b)].length}if(Os(f,["array"]))return f.indexOf(u,g);throw new qr(`Expected second argument to be of type array or string, but found ${wr(un(f))} instead.`)}eachChild(o){o(this.needle),o(this.haystack),this.fromIndex&&o(this.fromIndex)}outputDefined(){return!1}}class Do{constructor(o,u,f,g,b,S){this.inputType=o,this.type=u,this.input=f,this.cases=g,this.outputs=b,this.otherwise=S}static parse(o,u){if(o.length<5)return u.error(`Expected at least 4 arguments, but found only ${o.length-1}.`);if(o.length%2!=1)return u.error("Expected an even number of arguments.");let f,g;u.expectedType&&u.expectedType.kind!=="value"&&(g=u.expectedType);const b={},S=[];for(let N=2;N<o.length-1;N+=2){let F=o[N];const G=o[N+1];Array.isArray(F)||(F=[F]);const Y=u.concat(N);if(F.length===0)return Y.error("Expected at least one branch label.");for(const re of F){if(typeof re!="number"&&typeof re!="string")return Y.error("Branch labels must be numbers or strings.");if(typeof re=="number"&&Math.abs(re)>Number.MAX_SAFE_INTEGER)return Y.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if(typeof re=="number"&&Math.floor(re)!==re)return Y.error("Numeric branch labels must be integer values.");if(f){if(Y.checkSubtype(f,un(re)))return null}else f=un(re);if(b[String(re)]!==void 0)return Y.error("Branch labels must be unique.");b[String(re)]=S.length}const J=u.parse(G,N,g);if(!J)return null;g=g||J.type,S.push(J)}const C=u.parse(o[1],1,Nt);if(!C)return null;const k=u.parse(o[o.length-1],o.length-1,g);return k?C.type.kind!=="value"&&u.concat(1).checkSubtype(f,C.type)?null:new Do(f,g,C,b,S,k):null}evaluate(o){const u=this.input.evaluate(o);return(un(u)===this.inputType&&this.outputs[this.cases[u]]||this.otherwise).evaluate(o)}eachChild(o){o(this.input),this.outputs.forEach(o),o(this.otherwise)}outputDefined(){return this.outputs.every(o=>o.outputDefined())&&this.otherwise.outputDefined()}}class ii{constructor(o,u,f){this.type=o,this.branches=u,this.otherwise=f}static parse(o,u){if(o.length<4)return u.error(`Expected at least 3 arguments, but found only ${o.length-1}.`);if(o.length%2!=0)return u.error("Expected an odd number of arguments.");let f;u.expectedType&&u.expectedType.kind!=="value"&&(f=u.expectedType);const g=[];for(let S=1;S<o.length-1;S+=2){const C=u.parse(o[S],S,Yt);if(!C)return null;const k=u.parse(o[S+1],S+1,f);if(!k)return null;g.push([C,k]),f=f||k.type}const b=u.parse(o[o.length-1],o.length-1,f);if(!b)return null;if(!f)throw new Error("Can't infer output type");return new ii(f,g,b)}evaluate(o){for(const[u,f]of this.branches)if(u.evaluate(o))return f.evaluate(o);return this.otherwise.evaluate(o)}eachChild(o){for(const[u,f]of this.branches)o(u),o(f);o(this.otherwise)}outputDefined(){return this.branches.every(([o,u])=>u.outputDefined())&&this.otherwise.outputDefined()}}class wl{constructor(o,u,f,g){this.type=o,this.input=u,this.beginIndex=f,this.endIndex=g}static parse(o,u){if(o.length<=2||o.length>=5)return u.error(`Expected 2 or 3 arguments, but found ${o.length-1} instead.`);const f=u.parse(o[1],1,Nt),g=u.parse(o[2],2,dt);if(!f||!g)return null;if(!Wu(f.type,[bi(Nt),er,Nt]))return u.error(`Expected first argument to be of type array or string, but found ${wr(f.type)} instead`);if(o.length===4){const b=u.parse(o[3],3,dt);return b?new wl(f.type,f,g,b):null}return new wl(f.type,f,g)}evaluate(o){const u=this.input.evaluate(o),f=this.beginIndex.evaluate(o);let g;if(this.endIndex&&(g=this.endIndex.evaluate(o)),Os(u,["string"]))return[...u].slice(f,g).join("");if(Os(u,["array"]))return u.slice(f,g);throw new qr(`Expected first argument to be of type array or string, but found ${wr(un(u))} instead.`)}eachChild(o){o(this.input),o(this.beginIndex),this.endIndex&&o(this.endIndex)}outputDefined(){return!1}}function th(h,o){const u=h.length-1;let f,g,b=0,S=u,C=0;for(;b<=S;)if(C=Math.floor((b+S)/2),f=h[C],g=h[C+1],f<=o){if(C===u||o<g)return C;b=C+1}else{if(!(f>o))throw new qr("Input is not a number.");S=C-1}return 0}class Oa{constructor(o,u,f){this.type=o,this.input=u,this.labels=[],this.outputs=[];for(const[g,b]of f)this.labels.push(g),this.outputs.push(b)}static parse(o,u){if(o.length-1<4)return u.error(`Expected at least 4 arguments, but found only ${o.length-1}.`);if((o.length-1)%2!=0)return u.error("Expected an even number of arguments.");const f=u.parse(o[1],1,dt);if(!f)return null;const g=[];let b=null;u.expectedType&&u.expectedType.kind!=="value"&&(b=u.expectedType);for(let S=1;S<o.length;S+=2){const C=S===1?-1/0:o[S],k=o[S+1],N=S,F=S+1;if(typeof C!="number")return u.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',N);if(g.length&&g[g.length-1][0]>=C)return u.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',N);const G=u.parse(k,F,b);if(!G)return null;b=b||G.type,g.push([C,G])}return new Oa(b,f,g)}evaluate(o){const u=this.labels,f=this.outputs;if(u.length===1)return f[0].evaluate(o);const g=this.input.evaluate(o);if(g<=u[0])return f[0].evaluate(o);const b=u.length;return g>=u[b-1]?f[b-1].evaluate(o):f[th(u,g)].evaluate(o)}eachChild(o){o(this.input);for(const u of this.outputs)o(u)}outputDefined(){return this.outputs.every(o=>o.outputDefined())}}function si(h){return h&&h.__esModule&&Object.prototype.hasOwnProperty.call(h,"default")?h.default:h}var jd,Fd,l_=function(){if(Fd)return jd;function h(o,u,f,g){this.cx=3*o,this.bx=3*(f-o)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*u,this.by=3*(g-u)-this.cy,this.ay=1-this.cy-this.by,this.p1x=o,this.p1y=u,this.p2x=f,this.p2y=g}return Fd=1,jd=h,h.prototype={sampleCurveX:function(o){return((this.ax*o+this.bx)*o+this.cx)*o},sampleCurveY:function(o){return((this.ay*o+this.by)*o+this.cy)*o},sampleCurveDerivativeX:function(o){return(3*this.ax*o+2*this.bx)*o+this.cx},solveCurveX:function(o,u){if(u===void 0&&(u=1e-6),o<0)return 0;if(o>1)return 1;for(var f=o,g=0;g<8;g++){var b=this.sampleCurveX(f)-o;if(Math.abs(b)<u)return f;var S=this.sampleCurveDerivativeX(f);if(Math.abs(S)<1e-6)break;f-=b/S}var C=0,k=1;for(f=o,g=0;g<20&&(b=this.sampleCurveX(f),!(Math.abs(b-o)<u));g++)o>b?C=f:k=f,f=.5*(k-C)+C;return f},solve:function(o,u){return this.sampleCurveY(this.solveCurveX(o,u))}},jd}(),B1=si(l_);class Hn{constructor(o,u,f,g,b){this.type=o,this.operator=u,this.interpolation=f,this.input=g,this.labels=[],this.outputs=[];for(const[S,C]of b)this.labels.push(S),this.outputs.push(C)}static interpolationFactor(o,u,f,g){let b=0;if(o.name==="exponential")b=xc(u,o.base,f,g);else if(o.name==="linear")b=xc(u,1,f,g);else if(o.name==="cubic-bezier"){const S=o.controlPoints;b=new B1(S[0],S[1],S[2],S[3]).solve(xc(u,1,f,g))}return b}static parse(o,u){let[f,g,b,...S]=o;if(!Array.isArray(g)||g.length===0)return u.error("Expected an interpolation type expression.",1);if(g[0]==="linear")g={name:"linear"};else if(g[0]==="exponential"){const N=g[1];if(typeof N!="number")return u.error("Exponential interpolation requires a numeric base.",1,1);g={name:"exponential",base:N}}else{if(g[0]!=="cubic-bezier")return u.error(`Unknown interpolation type ${String(g[0])}`,1,0);{const N=g.slice(1);if(N.length!==4||N.some(F=>typeof F!="number"||F<0||F>1))return u.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);g={name:"cubic-bezier",controlPoints:N}}}if(o.length-1<4)return u.error(`Expected at least 4 arguments, but found only ${o.length-1}.`);if((o.length-1)%2!=0)return u.error("Expected an even number of arguments.");if(b=u.parse(b,2,dt),!b)return null;const C=[];let k=null;f!=="interpolate-hcl"&&f!=="interpolate-lab"||u.expectedType==Ri?u.expectedType&&u.expectedType.kind!=="value"&&(k=u.expectedType):k=Vi;for(let N=0;N<S.length;N+=2){const F=S[N],G=S[N+1],Y=N+3,J=N+4;if(typeof F!="number")return u.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',Y);if(C.length&&C[C.length-1][0]>=F)return u.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',Y);const re=u.parse(G,J,k);if(!re)return null;k=k||re.type,C.push([F,re])}return Ui(k,dt)||Ui(k,Ze)||Ui(k,Vi)||Ui(k,ri)||Ui(k,hr)||Ui(k,Ri)||Ui(k,br)||Ui(k,bi(dt))?new Hn(k,f,g,b,C):u.error(`Type ${wr(k)} is not interpolatable.`)}evaluate(o){const u=this.labels,f=this.outputs;if(u.length===1)return f[0].evaluate(o);const g=this.input.evaluate(o);if(g<=u[0])return f[0].evaluate(o);const b=u.length;if(g>=u[b-1])return f[b-1].evaluate(o);const S=th(u,g),C=Hn.interpolationFactor(this.interpolation,g,u[S],u[S+1]),k=f[S].evaluate(o),N=f[S+1].evaluate(o);switch(this.operator){case"interpolate":switch(this.type.kind){case"number":return Wi(k,N,C);case"color":return ar.interpolate(k,N,C);case"padding":return wi.interpolate(k,N,C);case"colorArray":return Si.interpolate(k,N,C);case"numberArray":return ni.interpolate(k,N,C);case"variableAnchorOffsetCollection":return qi.interpolate(k,N,C);case"array":return bl(k,N,C);case"projectionDefinition":return ns.interpolate(k,N,C)}case"interpolate-hcl":switch(this.type.kind){case"color":return ar.interpolate(k,N,C,"hcl");case"colorArray":return Si.interpolate(k,N,C,"hcl")}case"interpolate-lab":switch(this.type.kind){case"color":return ar.interpolate(k,N,C,"lab");case"colorArray":return Si.interpolate(k,N,C,"lab")}}}eachChild(o){o(this.input);for(const u of this.outputs)o(u)}outputDefined(){return this.outputs.every(o=>o.outputDefined())}}function xc(h,o,u,f){const g=f-u,b=h-u;return g===0?0:o===1?b/g:(Math.pow(o,b)-1)/(Math.pow(o,g)-1)}const zs={color:ar.interpolate,number:Wi,padding:wi.interpolate,numberArray:ni.interpolate,colorArray:Si.interpolate,variableAnchorOffsetCollection:qi.interpolate,array:bl};class Bd{constructor(o,u){this.type=o,this.args=u}static parse(o,u){if(o.length<2)return u.error("Expected at least one argument.");let f=null;const g=u.expectedType;g&&g.kind!=="value"&&(f=g);const b=[];for(const C of o.slice(1)){const k=u.parse(C,1+b.length,f,void 0,{typeAnnotation:"omit"});if(!k)return null;f=f||k.type,b.push(k)}if(!f)throw new Error("No output type");const S=g&&b.some(C=>Ls(g,C.type));return new Bd(S?Nt:f,b)}evaluate(o){let u,f=null,g=0;for(const b of this.args)if(g++,f=b.evaluate(o),f&&f instanceof _s&&!f.available&&(u||(u=f.name),f=null,g===this.args.length&&(f=u)),f!==null)break;return f}eachChild(o){this.args.forEach(o)}outputDefined(){return this.args.every(o=>o.outputDefined())}}function Lm(h,o){return h==="=="||h==="!="?o.kind==="boolean"||o.kind==="string"||o.kind==="number"||o.kind==="null"||o.kind==="value":o.kind==="string"||o.kind==="number"||o.kind==="value"}function rh(h,o,u,f){return f.compare(o,u)===0}function ra(h,o,u){const f=h!=="=="&&h!=="!=";return class ZB{constructor(b,S,C){this.type=Yt,this.lhs=b,this.rhs=S,this.collator=C,this.hasUntypedArgument=b.type.kind==="value"||S.type.kind==="value"}static parse(b,S){if(b.length!==3&&b.length!==4)return S.error("Expected two or three arguments.");const C=b[0];let k=S.parse(b[1],1,Nt);if(!k)return null;if(!Lm(C,k.type))return S.concat(1).error(`"${C}" comparisons are not supported for type '${wr(k.type)}'.`);let N=S.parse(b[2],2,Nt);if(!N)return null;if(!Lm(C,N.type))return S.concat(2).error(`"${C}" comparisons are not supported for type '${wr(N.type)}'.`);if(k.type.kind!==N.type.kind&&k.type.kind!=="value"&&N.type.kind!=="value")return S.error(`Cannot compare types '${wr(k.type)}' and '${wr(N.type)}'.`);f&&(k.type.kind==="value"&&N.type.kind!=="value"?k=new Qt(N.type,[k]):k.type.kind!=="value"&&N.type.kind==="value"&&(N=new Qt(k.type,[N])));let F=null;if(b.length===4){if(k.type.kind!=="string"&&N.type.kind!=="string"&&k.type.kind!=="value"&&N.type.kind!=="value")return S.error("Cannot use collator to compare non-string types.");if(F=S.parse(b[3],3,En),!F)return null}return new ZB(k,N,F)}evaluate(b){const S=this.lhs.evaluate(b),C=this.rhs.evaluate(b);if(f&&this.hasUntypedArgument){const k=un(S),N=un(C);if(k.kind!==N.kind||k.kind!=="string"&&k.kind!=="number")throw new qr(`Expected arguments for "${h}" to be (string, string) or (number, number), but found (${k.kind}, ${N.kind}) instead.`)}if(this.collator&&!f&&this.hasUntypedArgument){const k=un(S),N=un(C);if(k.kind!=="string"||N.kind!=="string")return o(b,S,C)}return this.collator?u(b,S,C,this.collator.evaluate(b)):o(b,S,C)}eachChild(b){b(this.lhs),b(this.rhs),this.collator&&b(this.collator)}outputDefined(){return!0}}}const io=ra("==",function(h,o,u){return o===u},rh),c_=ra("!=",function(h,o,u){return o!==u},function(h,o,u,f){return!rh(0,o,u,f)}),$d=ra("<",function(h,o,u){return o<u},function(h,o,u,f){return f.compare(o,u)<0}),$1=ra(">",function(h,o,u){return o>u},function(h,o,u,f){return f.compare(o,u)>0}),Om=ra("<=",function(h,o,u){return o<=u},function(h,o,u,f){return f.compare(o,u)<=0}),V1=ra(">=",function(h,o,u){return o>=u},function(h,o,u,f){return f.compare(o,u)>=0});class Vd{constructor(o,u,f){this.type=En,this.locale=f,this.caseSensitive=o,this.diacriticSensitive=u}static parse(o,u){if(o.length!==2)return u.error("Expected one argument.");const f=o[1];if(typeof f!="object"||Array.isArray(f))return u.error("Collator options argument must be an object.");const g=u.parse(f["case-sensitive"]!==void 0&&f["case-sensitive"],1,Yt);if(!g)return null;const b=u.parse(f["diacritic-sensitive"]!==void 0&&f["diacritic-sensitive"],1,Yt);if(!b)return null;let S=null;return f.locale&&(S=u.parse(f.locale,1,er),!S)?null:new Vd(g,b,S)}evaluate(o){return new Zu(this.caseSensitive.evaluate(o),this.diacriticSensitive.evaluate(o),this.locale?this.locale.evaluate(o):null)}eachChild(o){o(this.caseSensitive),o(this.diacriticSensitive),this.locale&&o(this.locale)}outputDefined(){return!1}}class zm{constructor(o,u,f,g,b){this.type=er,this.number=o,this.locale=u,this.currency=f,this.minFractionDigits=g,this.maxFractionDigits=b}static parse(o,u){if(o.length!==3)return u.error("Expected two arguments.");const f=u.parse(o[1],1,dt);if(!f)return null;const g=o[2];if(typeof g!="object"||Array.isArray(g))return u.error("NumberFormat options argument must be an object.");let b=null;if(g.locale&&(b=u.parse(g.locale,1,er),!b))return null;let S=null;if(g.currency&&(S=u.parse(g.currency,1,er),!S))return null;let C=null;if(g["min-fraction-digits"]&&(C=u.parse(g["min-fraction-digits"],1,dt),!C))return null;let k=null;return g["max-fraction-digits"]&&(k=u.parse(g["max-fraction-digits"],1,dt),!k)?null:new zm(f,b,S,C,k)}evaluate(o){return new Intl.NumberFormat(this.locale?this.locale.evaluate(o):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(o):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(o):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(o):void 0}).format(this.number.evaluate(o))}eachChild(o){o(this.number),this.locale&&o(this.locale),this.currency&&o(this.currency),this.minFractionDigits&&o(this.minFractionDigits),this.maxFractionDigits&&o(this.maxFractionDigits)}outputDefined(){return!1}}class Ud{constructor(o){this.type=Wn,this.sections=o}static parse(o,u){if(o.length<2)return u.error("Expected at least one argument.");const f=o[1];if(!Array.isArray(f)&&typeof f=="object")return u.error("First argument must be an image or text section.");const g=[];let b=!1;for(let S=1;S<=o.length-1;++S){const C=o[S];if(b&&typeof C=="object"&&!Array.isArray(C)){b=!1;let k=null;if(C["font-scale"]&&(k=u.parse(C["font-scale"],1,dt),!k))return null;let N=null;if(C["text-font"]&&(N=u.parse(C["text-font"],1,bi(er)),!N))return null;let F=null;if(C["text-color"]&&(F=u.parse(C["text-color"],1,Vi),!F))return null;let G=null;if(C["vertical-align"]){if(typeof C["vertical-align"]=="string"&&!Ku.includes(C["vertical-align"]))return u.error(`'vertical-align' must be one of: 'bottom', 'center', 'top' but found '${C["vertical-align"]}' instead.`);if(G=u.parse(C["vertical-align"],1,er),!G)return null}const Y=g[g.length-1];Y.scale=k,Y.font=N,Y.textColor=F,Y.verticalAlign=G}else{const k=u.parse(o[S],1,Nt);if(!k)return null;const N=k.type.kind;if(N!=="string"&&N!=="value"&&N!=="null"&&N!=="resolvedImage")return u.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");b=!0,g.push({content:k,scale:null,font:null,textColor:null,verticalAlign:null})}}return new Ud(g)}evaluate(o){return new rs(this.sections.map(u=>{const f=u.content.evaluate(o);return un(f)===ys?new gc("",f,null,null,null,u.verticalAlign?u.verticalAlign.evaluate(o):null):new gc(dr(f),null,u.scale?u.scale.evaluate(o):null,u.font?u.font.evaluate(o).join(","):null,u.textColor?u.textColor.evaluate(o):null,u.verticalAlign?u.verticalAlign.evaluate(o):null)}))}eachChild(o){for(const u of this.sections)o(u.content),u.scale&&o(u.scale),u.font&&o(u.font),u.textColor&&o(u.textColor),u.verticalAlign&&o(u.verticalAlign)}outputDefined(){return!1}}class bc{constructor(o){this.type=ys,this.input=o}static parse(o,u){if(o.length!==2)return u.error("Expected two arguments.");const f=u.parse(o[1],1,er);return f?new bc(f):u.error("No image name provided.")}evaluate(o){const u=this.input.evaluate(o),f=_s.fromString(u);return f&&o.availableImages&&(f.available=o.availableImages.indexOf(u)>-1),f}eachChild(o){o(this.input)}outputDefined(){return!1}}class Nm{constructor(o){this.type=dt,this.input=o}static parse(o,u){if(o.length!==2)return u.error(`Expected 1 argument, but found ${o.length-1} instead.`);const f=u.parse(o[1],1);return f?f.type.kind!=="array"&&f.type.kind!=="string"&&f.type.kind!=="value"?u.error(`Expected argument of type string or array, but found ${wr(f.type)} instead.`):new Nm(f):null}evaluate(o){const u=this.input.evaluate(o);if(typeof u=="string")return[...u].length;if(Array.isArray(u))return u.length;throw new qr(`Expected value to be of type string or array, but found ${wr(un(u))} instead.`)}eachChild(o){o(this.input)}outputDefined(){return!1}}const so=8192;function u_(h,o){const u=(180+h[0])/360,f=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+h[1]*Math.PI/360)))/360,g=Math.pow(2,o.z);return[Math.round(u*g*so),Math.round(f*g*so)]}function jm(h,o){const u=Math.pow(2,o.z);return[(g=(h[0]/so+o.x)/u,360*g-180),(f=(h[1]/so+o.y)/u,360/Math.PI*Math.atan(Math.exp((180-360*f)*Math.PI/180))-90)];var f,g}function wc(h,o){h[0]=Math.min(h[0],o[0]),h[1]=Math.min(h[1],o[1]),h[2]=Math.max(h[2],o[0]),h[3]=Math.max(h[3],o[1])}function nh(h,o){return!(h[0]<=o[0]||h[2]>=o[2]||h[1]<=o[1]||h[3]>=o[3])}function U1(h,o,u){const f=h[0]-o[0],g=h[1]-o[1],b=h[0]-u[0],S=h[1]-u[1];return f*S-b*g==0&&f*b<=0&&g*S<=0}function Gd(h,o,u,f){return(g=[f[0]-u[0],f[1]-u[1]])[0]*(b=[o[0]-h[0],o[1]-h[1]])[1]-g[1]*b[0]!=0&&!(!f_(h,o,u,f)||!f_(u,f,h,o));var g,b}function G1(h,o,u){for(const f of u)for(let g=0;g<f.length-1;++g)if(Gd(h,o,f[g],f[g+1]))return!0;return!1}function Sc(h,o,u=!1){let f=!1;for(const C of o)for(let k=0;k<C.length-1;k++){if(U1(h,C[k],C[k+1]))return u;(b=C[k])[1]>(g=h)[1]!=(S=C[k+1])[1]>g[1]&&g[0]<(S[0]-b[0])*(g[1]-b[1])/(S[1]-b[1])+b[0]&&(f=!f)}var g,b,S;return f}function h_(h,o){for(const u of o)if(Sc(h,u))return!0;return!1}function Fm(h,o){for(const u of h)if(!Sc(u,o))return!1;for(let u=0;u<h.length-1;++u)if(G1(h[u],h[u+1],o))return!1;return!0}function d_(h,o){for(const u of o)if(Fm(h,u))return!0;return!1}function f_(h,o,u,f){const g=f[0]-u[0],b=f[1]-u[1],S=(h[0]-u[0])*b-g*(h[1]-u[1]),C=(o[0]-u[0])*b-g*(o[1]-u[1]);return S>0&&C<0||S<0&&C>0}function Bm(h,o,u){const f=[];for(let g=0;g<h.length;g++){const b=[];for(let S=0;S<h[g].length;S++){const C=u_(h[g][S],u);wc(o,C),b.push(C)}f.push(b)}return f}function p_(h,o,u){const f=[];for(let g=0;g<h.length;g++){const b=Bm(h[g],o,u);f.push(b)}return f}function m_(h,o,u,f){if(h[0]<u[0]||h[0]>u[2]){const g=.5*f;let b=h[0]-u[0]>g?-f:u[0]-h[0]>g?f:0;b===0&&(b=h[0]-u[2]>g?-f:u[2]-h[0]>g?f:0),h[0]+=b}wc(o,h)}function ih(h,o,u,f){const g=Math.pow(2,f.z)*so,b=[f.x*so,f.y*so],S=[];for(const C of h)for(const k of C){const N=[k.x+b[0],k.y+b[1]];m_(N,o,u,g),S.push(N)}return S}function g_(h,o,u,f){const g=Math.pow(2,f.z)*so,b=[f.x*so,f.y*so],S=[];for(const k of h){const N=[];for(const F of k){const G=[F.x+b[0],F.y+b[1]];wc(o,G),N.push(G)}S.push(N)}if(o[2]-o[0]<=g/2){(C=o)[0]=C[1]=1/0,C[2]=C[3]=-1/0;for(const k of S)for(const N of k)m_(N,o,u,g)}var C;return S}class Sl{constructor(o,u){this.type=Yt,this.geojson=o,this.geometries=u}static parse(o,u){if(o.length!==2)return u.error(`'within' expression requires exactly one argument, but found ${o.length-1} instead.`);if(jr(o[1])){const f=o[1];if(f.type==="FeatureCollection"){const g=[];for(const b of f.features){const{type:S,coordinates:C}=b.geometry;S==="Polygon"&&g.push(C),S==="MultiPolygon"&&g.push(...C)}if(g.length)return new Sl(f,{type:"MultiPolygon",coordinates:g})}else if(f.type==="Feature"){const g=f.geometry.type;if(g==="Polygon"||g==="MultiPolygon")return new Sl(f,f.geometry)}else if(f.type==="Polygon"||f.type==="MultiPolygon")return new Sl(f,f)}return u.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(o){if(o.geometry()!=null&&o.canonicalID()!=null){if(o.geometryType()==="Point")return function(u,f){const g=[1/0,1/0,-1/0,-1/0],b=[1/0,1/0,-1/0,-1/0],S=u.canonicalID();if(f.type==="Polygon"){const C=Bm(f.coordinates,b,S),k=ih(u.geometry(),g,b,S);if(!nh(g,b))return!1;for(const N of k)if(!Sc(N,C))return!1}if(f.type==="MultiPolygon"){const C=p_(f.coordinates,b,S),k=ih(u.geometry(),g,b,S);if(!nh(g,b))return!1;for(const N of k)if(!h_(N,C))return!1}return!0}(o,this.geometries);if(o.geometryType()==="LineString")return function(u,f){const g=[1/0,1/0,-1/0,-1/0],b=[1/0,1/0,-1/0,-1/0],S=u.canonicalID();if(f.type==="Polygon"){const C=Bm(f.coordinates,b,S),k=g_(u.geometry(),g,b,S);if(!nh(g,b))return!1;for(const N of k)if(!Fm(N,C))return!1}if(f.type==="MultiPolygon"){const C=p_(f.coordinates,b,S),k=g_(u.geometry(),g,b,S);if(!nh(g,b))return!1;for(const N of k)if(!d_(N,C))return!1}return!0}(o,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}}let y_=class{constructor(h=[],o=(u,f)=>u<f?-1:u>f?1:0){if(this.data=h,this.length=this.data.length,this.compare=o,this.length>0)for(let u=(this.length>>1)-1;u>=0;u--)this._down(u)}push(h){this.data.push(h),this._up(this.length++)}pop(){if(this.length===0)return;const h=this.data[0],o=this.data.pop();return--this.length>0&&(this.data[0]=o,this._down(0)),h}peek(){return this.data[0]}_up(h){const{data:o,compare:u}=this,f=o[h];for(;h>0;){const g=h-1>>1,b=o[g];if(u(f,b)>=0)break;o[h]=b,h=g}o[h]=f}_down(h){const{data:o,compare:u}=this,f=this.length>>1,g=o[h];for(;h<f;){let b=1+(h<<1);const S=b+1;if(S<this.length&&u(o[S],o[b])<0&&(b=S),u(o[b],g)>=0)break;o[h]=o[b],h=b}o[h]=g}};function __(h,o,u=0,f=h.length-1,g=v_){for(;f>u;){if(f-u>600){const k=f-u+1,N=o-u+1,F=Math.log(k),G=.5*Math.exp(2*F/3),Y=.5*Math.sqrt(F*G*(k-G)/k)*(N-k/2<0?-1:1);__(h,o,Math.max(u,Math.floor(o-N*G/k+Y)),Math.min(f,Math.floor(o+(k-N)*G/k+Y)),g)}const b=h[o];let S=u,C=f;for(Tl(h,u,o),g(h[f],b)>0&&Tl(h,u,f);S<C;){for(Tl(h,S,C),S++,C--;g(h[S],b)<0;)S++;for(;g(h[C],b)>0;)C--}g(h[u],b)===0?Tl(h,u,C):(C++,Tl(h,C,f)),C<=o&&(u=C+1),o<=C&&(f=C-1)}}function Tl(h,o,u){const f=h[o];h[o]=h[u],h[u]=f}function v_(h,o){return h<o?-1:h>o?1:0}function Wd(h,o){if(h.length<=1)return[h];const u=[];let f,g;for(const b of h){const S=x_(b);S!==0&&(b.area=Math.abs(S),g===void 0&&(g=S<0),g===S<0?(f&&u.push(f),f=[b]):f.push(b))}if(f&&u.push(f),o>1)for(let b=0;b<u.length;b++)u[b].length<=o||(__(u[b],o,1,u[b].length-1,W1),u[b]=u[b].slice(0,o));return u}function W1(h,o){return o.area-h.area}function x_(h){let o=0;for(let u,f,g=0,b=h.length,S=b-1;g<b;S=g++)u=h[g],f=h[S],o+=(f.x-u.x)*(u.y+f.y);return o}const $m=1/298.257223563,b_=$m*(2-$m),w_=Math.PI/180;class Vm{constructor(o){const u=6378.137*w_*1e3,f=Math.cos(o*w_),g=1/(1-b_*(1-f*f)),b=Math.sqrt(g);this.kx=u*b*f,this.ky=u*b*g*(1-b_)}distance(o,u){const f=this.wrap(o[0]-u[0])*this.kx,g=(o[1]-u[1])*this.ky;return Math.sqrt(f*f+g*g)}pointOnLine(o,u){let f,g,b,S,C=1/0;for(let k=0;k<o.length-1;k++){let N=o[k][0],F=o[k][1],G=this.wrap(o[k+1][0]-N)*this.kx,Y=(o[k+1][1]-F)*this.ky,J=0;G===0&&Y===0||(J=(this.wrap(u[0]-N)*this.kx*G+(u[1]-F)*this.ky*Y)/(G*G+Y*Y),J>1?(N=o[k+1][0],F=o[k+1][1]):J>0&&(N+=G/this.kx*J,F+=Y/this.ky*J)),G=this.wrap(u[0]-N)*this.kx,Y=(u[1]-F)*this.ky;const re=G*G+Y*Y;re<C&&(C=re,f=N,g=F,b=k,S=J)}return{point:[f,g],index:b,t:Math.max(0,Math.min(1,S))}}wrap(o){for(;o<-180;)o+=360;for(;o>180;)o-=360;return o}}function Um(h,o){return o[0]-h[0]}function qd(h){return h[1]-h[0]+1}function na(h,o){return h[1]>=h[0]&&h[1]<o}function Gm(h,o){if(h[0]>h[1])return[null,null];const u=qd(h);if(o){if(u===2)return[h,null];const g=Math.floor(u/2);return[[h[0],h[0]+g],[h[0]+g,h[1]]]}if(u===1)return[h,null];const f=Math.floor(u/2)-1;return[[h[0],h[0]+f],[h[0]+f+1,h[1]]]}function Wm(h,o){if(!na(o,h.length))return[1/0,1/0,-1/0,-1/0];const u=[1/0,1/0,-1/0,-1/0];for(let f=o[0];f<=o[1];++f)wc(u,h[f]);return u}function Sr(h){const o=[1/0,1/0,-1/0,-1/0];for(const u of h)for(const f of u)wc(o,f);return o}function S_(h){return h[0]!==-1/0&&h[1]!==-1/0&&h[2]!==1/0&&h[3]!==1/0}function qm(h,o,u){if(!S_(h)||!S_(o))return NaN;let f=0,g=0;return h[2]<o[0]&&(f=o[0]-h[2]),h[0]>o[2]&&(f=h[0]-o[2]),h[1]>o[3]&&(g=h[1]-o[3]),h[3]<o[1]&&(g=o[1]-h[3]),u.distance([0,0],[f,g])}function El(h,o,u){const f=u.pointOnLine(o,h);return u.distance(h,f.point)}function Hm(h,o,u,f,g){const b=Math.min(El(h,[u,f],g),El(o,[u,f],g)),S=Math.min(El(u,[h,o],g),El(f,[h,o],g));return Math.min(b,S)}function q1(h,o,u,f,g){if(!na(o,h.length)||!na(f,u.length))return 1/0;let b=1/0;for(let S=o[0];S<o[1];++S){const C=h[S],k=h[S+1];for(let N=f[0];N<f[1];++N){const F=u[N],G=u[N+1];if(Gd(C,k,F,G))return 0;b=Math.min(b,Hm(C,k,F,G,g))}}return b}function H1(h,o,u,f,g){if(!na(o,h.length)||!na(f,u.length))return NaN;let b=1/0;for(let S=o[0];S<=o[1];++S)for(let C=f[0];C<=f[1];++C)if(b=Math.min(b,g.distance(h[S],u[C])),b===0)return b;return b}function Z1(h,o,u){if(Sc(h,o,!0))return 0;let f=1/0;for(const g of o){const b=g[0],S=g[g.length-1];if(b!==S&&(f=Math.min(f,El(h,[S,b],u)),f===0))return f;const C=u.pointOnLine(g,h);if(f=Math.min(f,u.distance(h,C.point)),f===0)return f}return f}function K1(h,o,u,f){if(!na(o,h.length))return NaN;for(let b=o[0];b<=o[1];++b)if(Sc(h[b],u,!0))return 0;let g=1/0;for(let b=o[0];b<o[1];++b){const S=h[b],C=h[b+1];for(const k of u)for(let N=0,F=k.length,G=F-1;N<F;G=N++){const Y=k[G],J=k[N];if(Gd(S,C,Y,J))return 0;g=Math.min(g,Hm(S,C,Y,J,f))}}return g}function T_(h,o){for(const u of h)for(const f of u)if(Sc(f,o,!0))return!0;return!1}function X1(h,o,u,f=1/0){const g=Sr(h),b=Sr(o);if(f!==1/0&&qm(g,b,u)>=f)return f;if(nh(g,b)){if(T_(h,o))return 0}else if(T_(o,h))return 0;let S=1/0;for(const C of h)for(let k=0,N=C.length,F=N-1;k<N;F=k++){const G=C[F],Y=C[k];for(const J of o)for(let re=0,le=J.length,pe=le-1;re<le;pe=re++){const be=J[pe],Fe=J[re];if(Gd(G,Y,be,Fe))return 0;S=Math.min(S,Hm(G,Y,be,Fe,u))}}return S}function E_(h,o,u,f,g,b){if(!b)return;const S=qm(Wm(f,b),g,u);S<o&&h.push([S,b,[0,0]])}function Hd(h,o,u,f,g,b,S){if(!b||!S)return;const C=qm(Wm(f,b),Wm(g,S),u);C<o&&h.push([C,b,S])}function Zd(h,o,u,f,g=1/0){let b=Math.min(f.distance(h[0],u[0][0]),g);if(b===0)return b;const S=new y_([[0,[0,h.length-1],[0,0]]],Um),C=Sr(u);for(;S.length>0;){const k=S.pop();if(k[0]>=b)continue;const N=k[1],F=o?50:100;if(qd(N)<=F){if(!na(N,h.length))return NaN;if(o){const G=K1(h,N,u,f);if(isNaN(G)||G===0)return G;b=Math.min(b,G)}else for(let G=N[0];G<=N[1];++G){const Y=Z1(h[G],u,f);if(b=Math.min(b,Y),b===0)return 0}}else{const G=Gm(N,o);E_(S,b,f,h,C,G[0]),E_(S,b,f,h,C,G[1])}}return b}function Kd(h,o,u,f,g,b=1/0){let S=Math.min(b,g.distance(h[0],u[0]));if(S===0)return S;const C=new y_([[0,[0,h.length-1],[0,u.length-1]]],Um);for(;C.length>0;){const k=C.pop();if(k[0]>=S)continue;const N=k[1],F=k[2],G=o?50:100,Y=f?50:100;if(qd(N)<=G&&qd(F)<=Y){if(!na(N,h.length)&&na(F,u.length))return NaN;let J;if(o&&f)J=q1(h,N,u,F,g),S=Math.min(S,J);else if(o&&!f){const re=h.slice(N[0],N[1]+1);for(let le=F[0];le<=F[1];++le)if(J=El(u[le],re,g),S=Math.min(S,J),S===0)return S}else if(!o&&f){const re=u.slice(F[0],F[1]+1);for(let le=N[0];le<=N[1];++le)if(J=El(h[le],re,g),S=Math.min(S,J),S===0)return S}else J=H1(h,N,u,F,g),S=Math.min(S,J)}else{const J=Gm(N,o),re=Gm(F,f);Hd(C,S,g,h,u,J[0],re[0]),Hd(C,S,g,h,u,J[0],re[1]),Hd(C,S,g,h,u,J[1],re[0]),Hd(C,S,g,h,u,J[1],re[1])}}return S}function Zm(h){return h.type==="MultiPolygon"?h.coordinates.map(o=>({type:"Polygon",coordinates:o})):h.type==="MultiLineString"?h.coordinates.map(o=>({type:"LineString",coordinates:o})):h.type==="MultiPoint"?h.coordinates.map(o=>({type:"Point",coordinates:o})):[h]}class Cl{constructor(o,u){this.type=dt,this.geojson=o,this.geometries=u}static parse(o,u){if(o.length!==2)return u.error(`'distance' expression requires exactly one argument, but found ${o.length-1} instead.`);if(jr(o[1])){const f=o[1];if(f.type==="FeatureCollection")return new Cl(f,f.features.map(g=>Zm(g.geometry)).flat());if(f.type==="Feature")return new Cl(f,Zm(f.geometry));if("type"in f&&"coordinates"in f)return new Cl(f,Zm(f))}return u.error("'distance' expression requires valid geojson object that contains polygon geometry type.")}evaluate(o){if(o.geometry()!=null&&o.canonicalID()!=null){if(o.geometryType()==="Point")return function(u,f){const g=u.geometry(),b=g.flat().map(k=>jm([k.x,k.y],u.canonical));if(g.length===0)return NaN;const S=new Vm(b[0][1]);let C=1/0;for(const k of f){switch(k.type){case"Point":C=Math.min(C,Kd(b,!1,[k.coordinates],!1,S,C));break;case"LineString":C=Math.min(C,Kd(b,!1,k.coordinates,!0,S,C));break;case"Polygon":C=Math.min(C,Zd(b,!1,k.coordinates,S,C))}if(C===0)return C}return C}(o,this.geometries);if(o.geometryType()==="LineString")return function(u,f){const g=u.geometry(),b=g.flat().map(k=>jm([k.x,k.y],u.canonical));if(g.length===0)return NaN;const S=new Vm(b[0][1]);let C=1/0;for(const k of f){switch(k.type){case"Point":C=Math.min(C,Kd(b,!0,[k.coordinates],!1,S,C));break;case"LineString":C=Math.min(C,Kd(b,!0,k.coordinates,!0,S,C));break;case"Polygon":C=Math.min(C,Zd(b,!0,k.coordinates,S,C))}if(C===0)return C}return C}(o,this.geometries);if(o.geometryType()==="Polygon")return function(u,f){const g=u.geometry();if(g.length===0||g[0].length===0)return NaN;const b=Wd(g,0).map(k=>k.map(N=>N.map(F=>jm([F.x,F.y],u.canonical)))),S=new Vm(b[0][0][0][1]);let C=1/0;for(const k of f)for(const N of b){switch(k.type){case"Point":C=Math.min(C,Zd([k.coordinates],!1,N,S,C));break;case"LineString":C=Math.min(C,Zd(k.coordinates,!0,N,S,C));break;case"Polygon":C=Math.min(C,X1(N,k.coordinates,S,C))}if(C===0)return C}return C}(o,this.geometries)}return NaN}eachChild(){}outputDefined(){return!0}}class sh{constructor(o){this.type=Nt,this.key=o}static parse(o,u){if(o.length!==2)return u.error(`Expected 1 argument, but found ${o.length-1} instead.`);const f=o[1];return f==null?u.error("Global state property must be defined."):typeof f!="string"?u.error(`Global state property must be string, but found ${typeof o[1]} instead.`):new sh(f)}evaluate(o){var u;const f=(u=o.globals)===null||u===void 0?void 0:u.globalState;return f&&Object.keys(f).length!==0?qu(f,this.key):null}eachChild(){}outputDefined(){return!1}}const Tc={"==":io,"!=":c_,">":$1,"<":$d,">=":V1,"<=":Om,array:Qt,at:Dm,boolean:Qt,case:ii,coalesce:Bd,collator:Vd,format:Ud,image:bc,in:Nd,"index-of":eh,interpolate:Hn,"interpolate-hcl":Hn,"interpolate-lab":Hn,length:Nm,let:vc,literal:Wt,match:Do,number:Qt,"number-format":zm,object:Qt,slice:wl,step:Oa,string:Qt,"to-boolean":Di,"to-color":Di,"to-number":Di,"to-string":Di,var:Ju,within:Sl,distance:Cl,"global-state":sh};class Ns{constructor(o,u,f,g){this.name=o,this.type=u,this._evaluate=f,this.args=g}evaluate(o){return this._evaluate(o,this.args)}eachChild(o){this.args.forEach(o)}outputDefined(){return!1}static parse(o,u){const f=o[0],g=Ns.definitions[f];if(!g)return u.error(`Unknown expression "${f}". If you wanted a literal array, use ["literal", [...]].`,0);const b=Array.isArray(g)?g[0]:g.type,S=Array.isArray(g)?[[g[1],g[2]]]:g.overloads,C=S.filter(([N])=>!Array.isArray(N)||N.length===o.length-1);let k=null;for(const[N,F]of C){k=new Qu(u.registry,Xd,u.path,null,u.scope);const G=[];let Y=!1;for(let J=1;J<o.length;J++){const re=o[J],le=Array.isArray(N)?N[J-1]:N.type,pe=k.parse(re,1+G.length,le);if(!pe){Y=!0;break}G.push(pe)}if(!Y)if(Array.isArray(N)&&N.length!==G.length)k.error(`Expected ${N.length} arguments, but found ${G.length} instead.`);else{for(let J=0;J<G.length;J++){const re=Array.isArray(N)?N[J]:N.type,le=G[J];k.concat(J+1).checkSubtype(re,le.type)}if(k.errors.length===0)return new Ns(f,b,F,G)}}if(C.length===1)u.errors.push(...k.errors);else{const N=(C.length?C:S).map(([G])=>{return Y=G,Array.isArray(Y)?`(${Y.map(wr).join(", ")})`:`(${wr(Y.type)}...)`;var Y}).join(" | "),F=[];for(let G=1;G<o.length;G++){const Y=u.parse(o[G],1+F.length);if(!Y)return null;F.push(wr(Y.type))}u.error(`Expected arguments of type ${N}, but found (${F.join(", ")}) instead.`)}return null}static register(o,u){Ns.definitions=u;for(const f in u)o[f]=Ns}}function C_(h,[o,u,f,g]){o=o.evaluate(h),u=u.evaluate(h),f=f.evaluate(h);const b=g?g.evaluate(h):1,S=Xu(o,u,f,b);if(S)throw new qr(S);return new ar(o/255,u/255,f/255,b,!1)}function P_(h,o){return h in o}function Km(h,o){const u=o[h];return u===void 0?null:u}function Pl(h){return{type:h}}function Xd(h){if(h instanceof Ju)return Xd(h.boundExpression);if(h instanceof Ns&&h.name==="error"||h instanceof Vd||h instanceof Sl||h instanceof Cl||h instanceof sh)return!1;const o=h instanceof Di||h instanceof Qt;let u=!0;return h.eachChild(f=>{u=o?u&&Xd(f):u&&f instanceof Wt}),!!u&&Yd(h)&&Qd(h,["zoom","heatmap-density","elevation","line-progress","accumulated","is-supported-script"])}function Yd(h){if(h instanceof Ns&&(h.name==="get"&&h.args.length===1||h.name==="feature-state"||h.name==="has"&&h.args.length===1||h.name==="properties"||h.name==="geometry-type"||h.name==="id"||/^filter-/.test(h.name))||h instanceof Sl||h instanceof Cl)return!1;let o=!0;return h.eachChild(u=>{o&&!Yd(u)&&(o=!1)}),o}function oh(h){if(h instanceof Ns&&h.name==="feature-state")return!1;let o=!0;return h.eachChild(u=>{o&&!oh(u)&&(o=!1)}),o}function Qd(h,o){if(h instanceof Ns&&o.indexOf(h.name)>=0)return!1;let u=!0;return h.eachChild(f=>{u&&!Qd(f,o)&&(u=!1)}),u}function A_(h){return{result:"success",value:h}}function Ec(h){return{result:"error",value:h}}function Cc(h){return h["property-type"]==="data-driven"||h["property-type"]==="cross-faded-data-driven"}function k_(h){return!!h.expression&&h.expression.parameters.indexOf("zoom")>-1}function ah(h){return!!h.expression&&h.expression.interpolated}function lr(h){return h instanceof Number?"number":h instanceof String?"string":h instanceof Boolean?"boolean":Array.isArray(h)?"array":h===null?"null":typeof h}function Jd(h){return typeof h=="object"&&h!==null&&!Array.isArray(h)&&un(h)===or}function Y1(h){return h}function Xm(h,o){const u=h.stops&&typeof h.stops[0][0]=="object",f=u||!(u||h.property!==void 0),g=h.type||(ah(o)?"exponential":"interval"),b=function(F){switch(F.type){case"color":return ar.parse;case"padding":return wi.parse;case"numberArray":return ni.parse;case"colorArray":return Si.parse;default:return null}}(o);if(b&&((h=Ds({},h)).stops&&(h.stops=h.stops.map(F=>[F[0],b(F[1])])),h.default=b(h.default?h.default:o.default)),h.colorSpace&&(S=h.colorSpace)!=="rgb"&&S!=="hcl"&&S!=="lab")throw new Error(`Unknown color space: "${h.colorSpace}"`);var S;const C=function(F){switch(F){case"exponential":return Ym;case"interval":return ef;case"categorical":return Q1;case"identity":return J1;default:throw new Error(`Unknown function type "${F}"`)}}(g);let k,N;if(g==="categorical"){k=Object.create(null);for(const F of h.stops)k[F[0]]=F[1];N=typeof h.stops[0][0]}if(u){const F={},G=[];for(let re=0;re<h.stops.length;re++){const le=h.stops[re],pe=le[0].zoom;F[pe]===void 0&&(F[pe]={zoom:pe,type:h.type,property:h.property,default:h.default,stops:[]},G.push(pe)),F[pe].stops.push([le[0].value,le[1]])}const Y=[];for(const re of G)Y.push([F[re].zoom,Xm(F[re],o)]);const J={name:"linear"};return{kind:"composite",interpolationType:J,interpolationFactor:Hn.interpolationFactor.bind(void 0,J),zoomStops:Y.map(re=>re[0]),evaluate:({zoom:re},le)=>Ym({stops:Y,base:h.base},o,re).evaluate(re,le)}}if(f){const F=g==="exponential"?{name:"exponential",base:h.base!==void 0?h.base:1}:null;return{kind:"camera",interpolationType:F,interpolationFactor:Hn.interpolationFactor.bind(void 0,F),zoomStops:h.stops.map(G=>G[0]),evaluate:({zoom:G})=>C(h,o,G,k,N)}}return{kind:"source",evaluate(F,G){const Y=G&&G.properties?G.properties[h.property]:void 0;return Y===void 0?lh(h.default,o.default):C(h,o,Y,k,N)}}}function lh(h,o,u){return h!==void 0?h:o!==void 0?o:u!==void 0?u:void 0}function Q1(h,o,u,f,g){return lh(typeof u===g?f[u]:void 0,h.default,o.default)}function ef(h,o,u){if(lr(u)!=="number")return lh(h.default,o.default);const f=h.stops.length;if(f===1||u<=h.stops[0][0])return h.stops[0][1];if(u>=h.stops[f-1][0])return h.stops[f-1][1];const g=th(h.stops.map(b=>b[0]),u);return h.stops[g][1]}function Ym(h,o,u){const f=h.base!==void 0?h.base:1;if(lr(u)!=="number")return lh(h.default,o.default);const g=h.stops.length;if(g===1||u<=h.stops[0][0])return h.stops[0][1];if(u>=h.stops[g-1][0])return h.stops[g-1][1];const b=th(h.stops.map(F=>F[0]),u),S=function(F,G,Y,J){const re=J-Y,le=F-Y;return re===0?0:G===1?le/re:(Math.pow(G,le)-1)/(Math.pow(G,re)-1)}(u,f,h.stops[b][0],h.stops[b+1][0]),C=h.stops[b][1],k=h.stops[b+1][1],N=zs[o.type]||Y1;return typeof C.evaluate=="function"?{evaluate(...F){const G=C.evaluate.apply(void 0,F),Y=k.evaluate.apply(void 0,F);if(G!==void 0&&Y!==void 0)return N(G,Y,S,h.colorSpace)}}:N(C,k,S,h.colorSpace)}function J1(h,o,u){switch(o.type){case"color":u=ar.parse(u);break;case"formatted":u=rs.fromString(u.toString());break;case"resolvedImage":u=_s.fromString(u.toString());break;case"padding":u=wi.parse(u);break;case"colorArray":u=Si.parse(u);break;case"numberArray":u=ni.parse(u);break;default:lr(u)===o.type||o.type==="enum"&&o.values[u]||(u=void 0)}return lh(u,h.default,o.default)}Ns.register(Tc,{error:[{kind:"error"},[er],(h,[o])=>{throw new qr(o.evaluate(h))}],typeof:[er,[Nt],(h,[o])=>wr(un(o.evaluate(h)))],"to-rgba":[bi(dt,4),[Vi],(h,[o])=>{const[u,f,g,b]=o.evaluate(h).rgb;return[255*u,255*f,255*g,b]}],rgb:[Vi,[dt,dt,dt],C_],rgba:[Vi,[dt,dt,dt,dt],C_],has:{type:Yt,overloads:[[[er],(h,[o])=>P_(o.evaluate(h),h.properties())],[[er,or],(h,[o,u])=>P_(o.evaluate(h),u.evaluate(h))]]},get:{type:Nt,overloads:[[[er],(h,[o])=>Km(o.evaluate(h),h.properties())],[[er,or],(h,[o,u])=>Km(o.evaluate(h),u.evaluate(h))]]},"feature-state":[Nt,[er],(h,[o])=>Km(o.evaluate(h),h.featureState||{})],properties:[or,[],h=>h.properties()],"geometry-type":[er,[],h=>h.geometryType()],id:[Nt,[],h=>h.id()],zoom:[dt,[],h=>h.globals.zoom],"heatmap-density":[dt,[],h=>h.globals.heatmapDensity||0],elevation:[dt,[],h=>h.globals.elevation||0],"line-progress":[dt,[],h=>h.globals.lineProgress||0],accumulated:[Nt,[],h=>h.globals.accumulated===void 0?null:h.globals.accumulated],"+":[dt,Pl(dt),(h,o)=>{let u=0;for(const f of o)u+=f.evaluate(h);return u}],"*":[dt,Pl(dt),(h,o)=>{let u=1;for(const f of o)u*=f.evaluate(h);return u}],"-":{type:dt,overloads:[[[dt,dt],(h,[o,u])=>o.evaluate(h)-u.evaluate(h)],[[dt],(h,[o])=>-o.evaluate(h)]]},"/":[dt,[dt,dt],(h,[o,u])=>o.evaluate(h)/u.evaluate(h)],"%":[dt,[dt,dt],(h,[o,u])=>o.evaluate(h)%u.evaluate(h)],ln2:[dt,[],()=>Math.LN2],pi:[dt,[],()=>Math.PI],e:[dt,[],()=>Math.E],"^":[dt,[dt,dt],(h,[o,u])=>Math.pow(o.evaluate(h),u.evaluate(h))],sqrt:[dt,[dt],(h,[o])=>Math.sqrt(o.evaluate(h))],log10:[dt,[dt],(h,[o])=>Math.log(o.evaluate(h))/Math.LN10],ln:[dt,[dt],(h,[o])=>Math.log(o.evaluate(h))],log2:[dt,[dt],(h,[o])=>Math.log(o.evaluate(h))/Math.LN2],sin:[dt,[dt],(h,[o])=>Math.sin(o.evaluate(h))],cos:[dt,[dt],(h,[o])=>Math.cos(o.evaluate(h))],tan:[dt,[dt],(h,[o])=>Math.tan(o.evaluate(h))],asin:[dt,[dt],(h,[o])=>Math.asin(o.evaluate(h))],acos:[dt,[dt],(h,[o])=>Math.acos(o.evaluate(h))],atan:[dt,[dt],(h,[o])=>Math.atan(o.evaluate(h))],min:[dt,Pl(dt),(h,o)=>Math.min(...o.map(u=>u.evaluate(h)))],max:[dt,Pl(dt),(h,o)=>Math.max(...o.map(u=>u.evaluate(h)))],abs:[dt,[dt],(h,[o])=>Math.abs(o.evaluate(h))],round:[dt,[dt],(h,[o])=>{const u=o.evaluate(h);return u<0?-Math.round(-u):Math.round(u)}],floor:[dt,[dt],(h,[o])=>Math.floor(o.evaluate(h))],ceil:[dt,[dt],(h,[o])=>Math.ceil(o.evaluate(h))],"filter-==":[Yt,[er,Nt],(h,[o,u])=>h.properties()[o.value]===u.value],"filter-id-==":[Yt,[Nt],(h,[o])=>h.id()===o.value],"filter-type-==":[Yt,[er],(h,[o])=>h.geometryType()===o.value],"filter-<":[Yt,[er,Nt],(h,[o,u])=>{const f=h.properties()[o.value],g=u.value;return typeof f==typeof g&&f<g}],"filter-id-<":[Yt,[Nt],(h,[o])=>{const u=h.id(),f=o.value;return typeof u==typeof f&&u<f}],"filter->":[Yt,[er,Nt],(h,[o,u])=>{const f=h.properties()[o.value],g=u.value;return typeof f==typeof g&&f>g}],"filter-id->":[Yt,[Nt],(h,[o])=>{const u=h.id(),f=o.value;return typeof u==typeof f&&u>f}],"filter-<=":[Yt,[er,Nt],(h,[o,u])=>{const f=h.properties()[o.value],g=u.value;return typeof f==typeof g&&f<=g}],"filter-id-<=":[Yt,[Nt],(h,[o])=>{const u=h.id(),f=o.value;return typeof u==typeof f&&u<=f}],"filter->=":[Yt,[er,Nt],(h,[o,u])=>{const f=h.properties()[o.value],g=u.value;return typeof f==typeof g&&f>=g}],"filter-id->=":[Yt,[Nt],(h,[o])=>{const u=h.id(),f=o.value;return typeof u==typeof f&&u>=f}],"filter-has":[Yt,[Nt],(h,[o])=>o.value in h.properties()],"filter-has-id":[Yt,[],h=>h.id()!==null&&h.id()!==void 0],"filter-type-in":[Yt,[bi(er)],(h,[o])=>o.value.indexOf(h.geometryType())>=0],"filter-id-in":[Yt,[bi(Nt)],(h,[o])=>o.value.indexOf(h.id())>=0],"filter-in-small":[Yt,[er,bi(Nt)],(h,[o,u])=>u.value.indexOf(h.properties()[o.value])>=0],"filter-in-large":[Yt,[er,bi(Nt)],(h,[o,u])=>function(f,g,b,S){for(;b<=S;){const C=b+S>>1;if(g[C]===f)return!0;g[C]>f?S=C-1:b=C+1}return!1}(h.properties()[o.value],u.value,0,u.value.length-1)],all:{type:Yt,overloads:[[[Yt,Yt],(h,[o,u])=>o.evaluate(h)&&u.evaluate(h)],[Pl(Yt),(h,o)=>{for(const u of o)if(!u.evaluate(h))return!1;return!0}]]},any:{type:Yt,overloads:[[[Yt,Yt],(h,[o,u])=>o.evaluate(h)||u.evaluate(h)],[Pl(Yt),(h,o)=>{for(const u of o)if(u.evaluate(h))return!0;return!1}]]},"!":[Yt,[Yt],(h,[o])=>!o.evaluate(h)],"is-supported-script":[Yt,[er],(h,[o])=>{const u=h.globals&&h.globals.isSupportedScript;return!u||u(o.evaluate(h))}],upcase:[er,[er],(h,[o])=>o.evaluate(h).toUpperCase()],downcase:[er,[er],(h,[o])=>o.evaluate(h).toLowerCase()],concat:[er,Pl(Nt),(h,o)=>o.map(u=>dr(u.evaluate(h))).join("")],"resolved-locale":[er,[En],(h,[o])=>o.evaluate(h).resolvedLocale()]});class Qm{constructor(o,u,f){this.expression=o,this._warningHistory={},this._evaluator=new Yu,this._defaultValue=u?function(g){if(g.type==="color"&&Jd(g.default))return new ar(0,0,0,0);switch(g.type){case"color":return ar.parse(g.default)||null;case"padding":return wi.parse(g.default)||null;case"numberArray":return ni.parse(g.default)||null;case"colorArray":return Si.parse(g.default)||null;case"variableAnchorOffsetCollection":return qi.parse(g.default)||null;case"projectionDefinition":return ns.parse(g.default)||null;default:return g.default===void 0?null:g.default}}(u):null,this._enumValues=u&&u.type==="enum"?u.values:null,this._globalState=f}evaluateWithoutErrorHandling(o,u,f,g,b,S){return this._globalState&&(o=Al(o,this._globalState)),this._evaluator.globals=o,this._evaluator.feature=u,this._evaluator.featureState=f,this._evaluator.canonical=g,this._evaluator.availableImages=b||null,this._evaluator.formattedSection=S,this.expression.evaluate(this._evaluator)}evaluate(o,u,f,g,b,S){this._globalState&&(o=Al(o,this._globalState)),this._evaluator.globals=o,this._evaluator.feature=u||null,this._evaluator.featureState=f||null,this._evaluator.canonical=g,this._evaluator.availableImages=b||null,this._evaluator.formattedSection=S||null;try{const C=this.expression.evaluate(this._evaluator);if(C==null||typeof C=="number"&&C!=C)return this._defaultValue;if(this._enumValues&&!(C in this._enumValues))throw new qr(`Expected value to be one of ${Object.keys(this._enumValues).map(k=>JSON.stringify(k)).join(", ")}, but found ${JSON.stringify(C)} instead.`);return C}catch(C){return this._warningHistory[C.message]||(this._warningHistory[C.message]=!0,typeof console<"u"&&console.warn(C.message)),this._defaultValue}}}function tf(h){return Array.isArray(h)&&h.length>0&&typeof h[0]=="string"&&h[0]in Tc}function rf(h,o,u){const f=new Qu(Tc,Xd,[],o?function(b){const S={color:Vi,string:er,number:dt,enum:er,boolean:Yt,formatted:Wn,padding:ri,numberArray:hr,colorArray:Ri,projectionDefinition:Ze,resolvedImage:ys,variableAnchorOffsetCollection:br};return b.type==="array"?bi(S[b.value]||Nt,b.length):S[b.type]}(o):void 0),g=f.parse(h,void 0,void 0,void 0,o&&o.type==="string"?{typeAnnotation:"coerce"}:void 0);return g?A_(new Qm(g,o,u)):Ec(f.errors)}class nf{constructor(o,u,f){this.kind=o,this._styleExpression=u,this.isStateDependent=o!=="constant"&&!oh(u.expression),this.globalStateRefs=ch(u.expression),this._globalState=f}evaluateWithoutErrorHandling(o,u,f,g,b,S){return this._globalState&&(o=Al(o,this._globalState)),this._styleExpression.evaluateWithoutErrorHandling(o,u,f,g,b,S)}evaluate(o,u,f,g,b,S){return this._globalState&&(o=Al(o,this._globalState)),this._styleExpression.evaluate(o,u,f,g,b,S)}}class sf{constructor(o,u,f,g,b){this.kind=o,this.zoomStops=f,this._styleExpression=u,this.isStateDependent=o!=="camera"&&!oh(u.expression),this.globalStateRefs=ch(u.expression),this.interpolationType=g,this._globalState=b}evaluateWithoutErrorHandling(o,u,f,g,b,S){return this._globalState&&(o=Al(o,this._globalState)),this._styleExpression.evaluateWithoutErrorHandling(o,u,f,g,b,S)}evaluate(o,u,f,g,b,S){return this._globalState&&(o=Al(o,this._globalState)),this._styleExpression.evaluate(o,u,f,g,b,S)}interpolationFactor(o,u,f){return this.interpolationType?Hn.interpolationFactor(this.interpolationType,o,u,f):0}}function Jm(h,o,u){const f=rf(h,o,u);if(f.result==="error")return f;const g=f.value.expression,b=Yd(g);if(!b&&!Cc(o))return Ec([new Bi("","data expressions not supported")]);const S=Qd(g,["zoom"]);if(!S&&!k_(o))return Ec([new Bi("","zoom expressions not supported")]);const C=af(g);return C||S?C instanceof Bi?Ec([C]):C instanceof Hn&&!ah(o)?Ec([new Bi("",'"interpolate" expressions cannot be used with this property')]):A_(C?new sf(b?"camera":"composite",f.value,C.labels,C instanceof Hn?C.interpolation:void 0,u):new nf(b?"constant":"source",f.value,u)):Ec([new Bi("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}class of{constructor(o,u){this._parameters=o,this._specification=u,Ds(this,Xm(this._parameters,this._specification))}static deserialize(o){return new of(o._parameters,o._specification)}static serialize(o){return{_parameters:o._parameters,_specification:o._specification}}}function af(h){let o=null;if(h instanceof vc)o=af(h.result);else if(h instanceof Bd){for(const u of h.args)if(o=af(u),o)break}else(h instanceof Oa||h instanceof Hn)&&h.input instanceof Ns&&h.input.name==="zoom"&&(o=h);return o instanceof Bi||h.eachChild(u=>{const f=af(u);f instanceof Bi?o=f:!o&&f?o=new Bi("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):o&&f&&o!==f&&(o=new Bi("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),o}function ch(h,o=new Set){return h instanceof sh&&o.add(h.key),h.eachChild(u=>{ch(u,o)}),o}function Al(h,o){const{zoom:u,heatmapDensity:f,elevation:g,lineProgress:b,isSupportedScript:S,accumulated:C}=h??{};return{zoom:u,heatmapDensity:f,elevation:g,lineProgress:b,isSupportedScript:S,accumulated:C,globalState:o}}function lf(h){if(h===!0||h===!1)return!0;if(!Array.isArray(h)||h.length===0)return!1;switch(h[0]){case"has":return h.length>=2&&h[1]!=="$id"&&h[1]!=="$type";case"in":return h.length>=3&&(typeof h[1]!="string"||Array.isArray(h[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return h.length!==3||Array.isArray(h[1])||Array.isArray(h[2]);case"any":case"all":for(const o of h.slice(1))if(!lf(o)&&typeof o!="boolean")return!1;return!0;default:return!0}}const ew={type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}};function uh(h,o){if(h==null)return{filter:()=>!0,needGeometry:!1,getGlobalStateRefs:()=>new Set};lf(h)||(h=hh(h));const u=rf(h,ew,o);if(u.result==="error")throw new Error(u.value.map(f=>`${f.key}: ${f.message}`).join(", "));return{filter:(f,g,b)=>u.value.evaluate(f,g,{},b),needGeometry:M_(h),getGlobalStateRefs:()=>ch(u.value.expression)}}function tw(h,o){return h<o?-1:h>o?1:0}function M_(h){if(!Array.isArray(h))return!1;if(h[0]==="within"||h[0]==="distance")return!0;for(let o=1;o<h.length;o++)if(M_(h[o]))return!0;return!1}function hh(h){if(!h)return!0;const o=h[0];return h.length<=1?o!=="any":o==="=="?cf(h[1],h[2],"=="):o==="!="?Pc(cf(h[1],h[2],"==")):o==="<"||o===">"||o==="<="||o===">="?cf(h[1],h[2],o):o==="any"?(u=h.slice(1),["any"].concat(u.map(hh))):o==="all"?["all"].concat(h.slice(1).map(hh)):o==="none"?["all"].concat(h.slice(1).map(hh).map(Pc)):o==="in"?uf(h[1],h.slice(2)):o==="!in"?Pc(uf(h[1],h.slice(2))):o==="has"?hf(h[1]):o!=="!has"||Pc(hf(h[1]));var u}function cf(h,o,u){switch(h){case"$type":return[`filter-type-${u}`,o];case"$id":return[`filter-id-${u}`,o];default:return[`filter-${u}`,h,o]}}function uf(h,o){if(o.length===0)return!1;switch(h){case"$type":return["filter-type-in",["literal",o]];case"$id":return["filter-id-in",["literal",o]];default:return o.length>200&&!o.some(u=>typeof u!=typeof o[0])?["filter-in-large",h,["literal",o.sort(tw)]]:["filter-in-small",h,["literal",o]]}}function hf(h){switch(h){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",h]}}function Pc(h){return["!",h]}function dh(h){const o=typeof h;if(o==="number"||o==="boolean"||o==="string"||h==null)return JSON.stringify(h);if(Array.isArray(h)){let g="[";for(const b of h)g+=`${dh(b)},`;return`${g}]`}const u=Object.keys(h).sort();let f="{";for(let g=0;g<u.length;g++)f+=`${JSON.stringify(u[g])}:${dh(h[u[g]])},`;return`${f}}`}function df(h){let o="";for(const u of Kt)o+=`/${dh(h[u])}`;return o}function I_(h){const o=h.value;return o?[new ot(h.key,o,"constants have been deprecated as of v8")]:[]}function gn(h){return h instanceof Number||h instanceof String||h instanceof Boolean?h.valueOf():h}function kl(h){if(Array.isArray(h))return h.map(kl);if(h instanceof Object&&!(h instanceof Number||h instanceof String||h instanceof Boolean)){const o={};for(const u in h)o[u]=kl(h[u]);return o}return gn(h)}function js(h){const o=h.key,u=h.value,f=h.valueSpec||{},g=h.objectElementValidators||{},b=h.style,S=h.styleSpec,C=h.validateSpec;let k=[];const N=lr(u);if(N!=="object")return[new ot(o,u,`object expected, ${N} found`)];for(const F in u){const G=F.split(".")[0],Y=qu(f,G)||f["*"];let J;if(qu(g,G))J=g[G];else if(qu(f,G))J=C;else if(g["*"])J=g["*"];else{if(!f["*"]){k.push(new ot(o,u[F],`unknown property "${F}"`));continue}J=C}k=k.concat(J({key:(o&&`${o}.`)+F,value:u[F],valueSpec:Y,style:b,styleSpec:S,object:u,objectKey:F,validateSpec:C},u))}for(const F in f)g[F]||f[F].required&&f[F].default===void 0&&u[F]===void 0&&k.push(new ot(o,u,`missing required property "${F}"`));return k}function eg(h){const o=h.value,u=h.valueSpec,f=h.style,g=h.styleSpec,b=h.key,S=h.arrayElementValidator||h.validateSpec;if(lr(o)!=="array")return[new ot(b,o,`array expected, ${lr(o)} found`)];if(u.length&&o.length!==u.length)return[new ot(b,o,`array length ${u.length} expected, length ${o.length} found`)];if(u["min-length"]&&o.length<u["min-length"])return[new ot(b,o,`array length at least ${u["min-length"]} expected, length ${o.length} found`)];let C={type:u.value,values:u.values};g.$version<7&&(C.function=u.function),lr(u.value)==="object"&&(C=u.value);let k=[];for(let N=0;N<o.length;N++)k=k.concat(S({array:o,arrayIndex:N,value:o[N],valueSpec:C,validateSpec:h.validateSpec,style:f,styleSpec:g,key:`${b}[${N}]`}));return k}function ff(h){const o=h.key,u=h.value,f=h.valueSpec;let g=lr(u);return g==="number"&&u!=u&&(g="NaN"),g!=="number"?[new ot(o,u,`number expected, ${g} found`)]:"minimum"in f&&u<f.minimum?[new ot(o,u,`${u} is less than the minimum value ${f.minimum}`)]:"maximum"in f&&u>f.maximum?[new ot(o,u,`${u} is greater than the maximum value ${f.maximum}`)]:[]}function tg(h){const o=h.valueSpec,u=gn(h.value.type);let f,g,b,S={};const C=u!=="categorical"&&h.value.property===void 0,k=!C,N=lr(h.value.stops)==="array"&&lr(h.value.stops[0])==="array"&&lr(h.value.stops[0][0])==="object",F=js({key:h.key,value:h.value,valueSpec:h.styleSpec.function,validateSpec:h.validateSpec,style:h.style,styleSpec:h.styleSpec,objectElementValidators:{stops:function(J){if(u==="identity")return[new ot(J.key,J.value,'identity function may not have a "stops" property')];let re=[];const le=J.value;return re=re.concat(eg({key:J.key,value:le,valueSpec:J.valueSpec,validateSpec:J.validateSpec,style:J.style,styleSpec:J.styleSpec,arrayElementValidator:G})),lr(le)==="array"&&le.length===0&&re.push(new ot(J.key,le,"array must have at least one stop")),re},default:function(J){return J.validateSpec({key:J.key,value:J.value,valueSpec:o,validateSpec:J.validateSpec,style:J.style,styleSpec:J.styleSpec})}}});return u==="identity"&&C&&F.push(new ot(h.key,h.value,'missing required property "property"')),u==="identity"||h.value.stops||F.push(new ot(h.key,h.value,'missing required property "stops"')),u==="exponential"&&h.valueSpec.expression&&!ah(h.valueSpec)&&F.push(new ot(h.key,h.value,"exponential functions not supported")),h.styleSpec.$version>=8&&(k&&!Cc(h.valueSpec)?F.push(new ot(h.key,h.value,"property functions not supported")):C&&!k_(h.valueSpec)&&F.push(new ot(h.key,h.value,"zoom functions not supported"))),u!=="categorical"&&!N||h.value.property!==void 0||F.push(new ot(h.key,h.value,'"property" property is required')),F;function G(J){let re=[];const le=J.value,pe=J.key;if(lr(le)!=="array")return[new ot(pe,le,`array expected, ${lr(le)} found`)];if(le.length!==2)return[new ot(pe,le,`array length 2 expected, length ${le.length} found`)];if(N){if(lr(le[0])!=="object")return[new ot(pe,le,`object expected, ${lr(le[0])} found`)];if(le[0].zoom===void 0)return[new ot(pe,le,"object stop key must have zoom")];if(le[0].value===void 0)return[new ot(pe,le,"object stop key must have value")];if(b&&b>gn(le[0].zoom))return[new ot(pe,le[0].zoom,"stop zoom values must appear in ascending order")];gn(le[0].zoom)!==b&&(b=gn(le[0].zoom),g=void 0,S={}),re=re.concat(js({key:`${pe}[0]`,value:le[0],valueSpec:{zoom:{}},validateSpec:J.validateSpec,style:J.style,styleSpec:J.styleSpec,objectElementValidators:{zoom:ff,value:Y}}))}else re=re.concat(Y({key:`${pe}[0]`,value:le[0],validateSpec:J.validateSpec,style:J.style,styleSpec:J.styleSpec},le));return tf(kl(le[1]))?re.concat([new ot(`${pe}[1]`,le[1],"expressions are not allowed in function stops.")]):re.concat(J.validateSpec({key:`${pe}[1]`,value:le[1],valueSpec:o,validateSpec:J.validateSpec,style:J.style,styleSpec:J.styleSpec}))}function Y(J,re){const le=lr(J.value),pe=gn(J.value),be=J.value!==null?J.value:re;if(f){if(le!==f)return[new ot(J.key,be,`${le} stop domain type must match previous stop domain type ${f}`)]}else f=le;if(le!=="number"&&le!=="string"&&le!=="boolean")return[new ot(J.key,be,"stop domain value must be a number, string, or boolean")];if(le!=="number"&&u!=="categorical"){let Fe=`number expected, ${le} found`;return Cc(o)&&u===void 0&&(Fe+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new ot(J.key,be,Fe)]}return u!=="categorical"||le!=="number"||isFinite(pe)&&Math.floor(pe)===pe?u!=="categorical"&&le==="number"&&g!==void 0&&pe<g?[new ot(J.key,be,"stop domain values must appear in ascending order")]:(g=pe,u==="categorical"&&pe in S?[new ot(J.key,be,"stop domain values must be unique")]:(S[pe]=!0,[])):[new ot(J.key,be,`integer expected, found ${pe}`)]}}function Ml(h){const o=(h.expressionContext==="property"?Jm:rf)(kl(h.value),h.valueSpec);if(o.result==="error")return o.value.map(f=>new ot(`${h.key}${f.key}`,h.value,f.message));const u=o.value.expression||o.value._styleExpression.expression;if(h.expressionContext==="property"&&h.propertyKey==="text-font"&&!u.outputDefined())return[new ot(h.key,h.value,`Invalid data expression for "${h.propertyKey}". Output values must be contained as literals within the expression.`)];if(h.expressionContext==="property"&&h.propertyType==="layout"&&!oh(u))return[new ot(h.key,h.value,'"feature-state" data expressions are not supported with layout properties.')];if(h.expressionContext==="filter"&&!oh(u))return[new ot(h.key,h.value,'"feature-state" data expressions are not supported with filters.')];if(h.expressionContext&&h.expressionContext.indexOf("cluster")===0){if(!Qd(u,["zoom","feature-state"]))return[new ot(h.key,h.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(h.expressionContext==="cluster-initial"&&!Yd(u))return[new ot(h.key,h.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function Ac(h){const o=h.key,u=h.value,f=lr(u);return f!=="string"?[new ot(o,u,`color expected, ${f} found`)]:ar.parse(String(u))?[]:[new ot(o,u,`color expected, "${u}" found`)]}function fh(h){const o=h.key,u=h.value,f=h.valueSpec,g=[];return Array.isArray(f.values)?f.values.indexOf(gn(u))===-1&&g.push(new ot(o,u,`expected one of [${f.values.join(", ")}], ${JSON.stringify(u)} found`)):Object.keys(f.values).indexOf(gn(u))===-1&&g.push(new ot(o,u,`expected one of [${Object.keys(f.values).join(", ")}], ${JSON.stringify(u)} found`)),g}function pf(h){return lf(kl(h.value))?Ml(Ds({},h,{expressionContext:"filter",valueSpec:{value:"boolean"}})):rg(h)}function rg(h){const o=h.value,u=h.key;if(lr(o)!=="array")return[new ot(u,o,`array expected, ${lr(o)} found`)];const f=h.styleSpec;let g,b=[];if(o.length<1)return[new ot(u,o,"filter array must have at least 1 element")];switch(b=b.concat(fh({key:`${u}[0]`,value:o[0],valueSpec:f.filter_operator,style:h.style,styleSpec:h.styleSpec})),gn(o[0])){case"<":case"<=":case">":case">=":o.length>=2&&gn(o[1])==="$type"&&b.push(new ot(u,o,`"$type" cannot be use with operator "${o[0]}"`));case"==":case"!=":o.length!==3&&b.push(new ot(u,o,`filter array for operator "${o[0]}" must have 3 elements`));case"in":case"!in":o.length>=2&&(g=lr(o[1]),g!=="string"&&b.push(new ot(`${u}[1]`,o[1],`string expected, ${g} found`)));for(let S=2;S<o.length;S++)g=lr(o[S]),gn(o[1])==="$type"?b=b.concat(fh({key:`${u}[${S}]`,value:o[S],valueSpec:f.geometry_type,style:h.style,styleSpec:h.styleSpec})):g!=="string"&&g!=="number"&&g!=="boolean"&&b.push(new ot(`${u}[${S}]`,o[S],`string, number, or boolean expected, ${g} found`));break;case"any":case"all":case"none":for(let S=1;S<o.length;S++)b=b.concat(rg({key:`${u}[${S}]`,value:o[S],style:h.style,styleSpec:h.styleSpec}));break;case"has":case"!has":g=lr(o[1]),o.length!==2?b.push(new ot(u,o,`filter array for "${o[0]}" operator must have 2 elements`)):g!=="string"&&b.push(new ot(`${u}[1]`,o[1],`string expected, ${g} found`))}return b}function R_(h,o){const u=h.key,f=h.validateSpec,g=h.style,b=h.styleSpec,S=h.value,C=h.objectKey,k=b[`${o}_${h.layerType}`];if(!k)return[];const N=C.match(/^(.*)-transition$/);if(o==="paint"&&N&&k[N[1]]&&k[N[1]].transition)return f({key:u,value:S,valueSpec:b.transition,style:g,styleSpec:b});const F=h.valueSpec||k[C];if(!F)return[new ot(u,S,`unknown property "${C}"`)];let G;if(lr(S)==="string"&&Cc(F)&&!F.tokens&&(G=/^{([^}]+)}$/.exec(S)))return[new ot(u,S,`"${C}" does not support interpolation syntax
Use an identity property function instead: \`{ "type": "identity", "property": ${JSON.stringify(G[1])} }\`.`)];const Y=[];return h.layerType==="symbol"&&(C==="text-field"&&g&&!g.glyphs&&Y.push(new ot(u,S,'use of "text-field" requires a style "glyphs" property')),C==="text-font"&&Jd(kl(S))&&gn(S.type)==="identity"&&Y.push(new ot(u,S,'"text-font" does not support identity functions'))),Y.concat(f({key:h.key,value:S,valueSpec:F,style:g,styleSpec:b,expressionContext:"property",propertyType:o,propertyKey:C}))}function ng(h){return R_(h,"paint")}function ig(h){return R_(h,"layout")}function kc(h){let o=[];const u=h.value,f=h.key,g=h.style,b=h.styleSpec;if(lr(u)!=="object")return[new ot(f,u,`object expected, ${lr(u)} found`)];u.type||u.ref||o.push(new ot(f,u,'either "type" or "ref" is required'));let S=gn(u.type);const C=gn(u.ref);if(u.id){const k=gn(u.id);for(let N=0;N<h.arrayIndex;N++){const F=g.layers[N];gn(F.id)===k&&o.push(new ot(f,u.id,`duplicate layer id "${u.id}", previously used at line ${F.id.__line__}`))}}if("ref"in u){let k;["type","source","source-layer","filter","layout"].forEach(N=>{N in u&&o.push(new ot(f,u[N],`"${N}" is prohibited for ref layers`))}),g.layers.forEach(N=>{gn(N.id)===C&&(k=N)}),k?k.ref?o.push(new ot(f,u.ref,"ref cannot reference another ref layer")):S=gn(k.type):o.push(new ot(f,u.ref,`ref layer "${C}" not found`))}else if(S!=="background")if(u.source){const k=g.sources&&g.sources[u.source],N=k&&gn(k.type);k?N==="vector"&&S==="raster"?o.push(new ot(f,u.source,`layer "${u.id}" requires a raster source`)):N!=="raster-dem"&&S==="hillshade"||N!=="raster-dem"&&S==="color-relief"?o.push(new ot(f,u.source,`layer "${u.id}" requires a raster-dem source`)):N==="raster"&&S!=="raster"?o.push(new ot(f,u.source,`layer "${u.id}" requires a vector source`)):N!=="vector"||u["source-layer"]?N==="raster-dem"&&S!=="hillshade"&&S!=="color-relief"?o.push(new ot(f,u.source,"raster-dem source can only be used with layer type 'hillshade' or 'color-relief'.")):S!=="line"||!u.paint||!u.paint["line-gradient"]||N==="geojson"&&k.lineMetrics||o.push(new ot(f,u,`layer "${u.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):o.push(new ot(f,u,`layer "${u.id}" must specify a "source-layer"`)):o.push(new ot(f,u.source,`source "${u.source}" not found`))}else o.push(new ot(f,u,'missing required property "source"'));return o=o.concat(js({key:f,value:u,valueSpec:b.layer,style:h.style,styleSpec:h.styleSpec,validateSpec:h.validateSpec,objectElementValidators:{"*":()=>[],type:()=>h.validateSpec({key:`${f}.type`,value:u.type,valueSpec:b.layer.type,style:h.style,styleSpec:h.styleSpec,validateSpec:h.validateSpec,object:u,objectKey:"type"}),filter:pf,layout:k=>js({layer:u,key:k.key,value:k.value,style:k.style,styleSpec:k.styleSpec,validateSpec:k.validateSpec,objectElementValidators:{"*":N=>ig(Ds({layerType:S},N))}}),paint:k=>js({layer:u,key:k.key,value:k.value,style:k.style,styleSpec:k.styleSpec,validateSpec:k.validateSpec,objectElementValidators:{"*":N=>ng(Ds({layerType:S},N))}})}})),o}function Il(h){const o=h.value,u=h.key,f=lr(o);return f!=="string"?[new ot(u,o,`string expected, ${f} found`)]:[]}const D_={promoteId:function({key:h,value:o}){if(lr(o)==="string")return Il({key:h,value:o});{const u=[];for(const f in o)u.push(...Il({key:`${h}.${f}`,value:o[f]}));return u}}};function L_(h){const o=h.value,u=h.key,f=h.styleSpec,g=h.style,b=h.validateSpec;if(!o.type)return[new ot(u,o,'"type" is required')];const S=gn(o.type);let C;switch(S){case"vector":case"raster":return C=js({key:u,value:o,valueSpec:f[`source_${S.replace("-","_")}`],style:h.style,styleSpec:f,objectElementValidators:D_,validateSpec:b}),C;case"raster-dem":return C=function(k){var N;const F=(N=k.sourceName)!==null&&N!==void 0?N:"",G=k.value,Y=k.styleSpec,J=Y.source_raster_dem,re=k.style;let le=[];const pe=lr(G);if(G===void 0)return le;if(pe!=="object")return le.push(new ot("source_raster_dem",G,`object expected, ${pe} found`)),le;const be=gn(G.encoding)==="custom",Fe=["redFactor","greenFactor","blueFactor","baseShift"],ke=k.value.encoding?`"${k.value.encoding}"`:"Default";for(const De in G)!be&&Fe.includes(De)?le.push(new ot(De,G[De],`In "${F}": "${De}" is only valid when "encoding" is set to "custom". ${ke} encoding found`)):J[De]?le=le.concat(k.validateSpec({key:De,value:G[De],valueSpec:J[De],validateSpec:k.validateSpec,style:re,styleSpec:Y})):le.push(new ot(De,G[De],`unknown property "${De}"`));return le}({sourceName:u,value:o,style:h.style,styleSpec:f,validateSpec:b}),C;case"geojson":if(C=js({key:u,value:o,valueSpec:f.source_geojson,style:g,styleSpec:f,validateSpec:b,objectElementValidators:D_}),o.cluster)for(const k in o.clusterProperties){const[N,F]=o.clusterProperties[k],G=typeof N=="string"?[N,["accumulated"],["get",k]]:N;C.push(...Ml({key:`${u}.${k}.map`,value:F,expressionContext:"cluster-map"})),C.push(...Ml({key:`${u}.${k}.reduce`,value:G,expressionContext:"cluster-reduce"}))}return C;case"video":return js({key:u,value:o,valueSpec:f.source_video,style:g,validateSpec:b,styleSpec:f});case"image":return js({key:u,value:o,valueSpec:f.source_image,style:g,validateSpec:b,styleSpec:f});case"canvas":return[new ot(u,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return fh({key:`${u}.type`,value:o.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]}})}}function O_(h){const o=h.value,u=h.styleSpec,f=u.light,g=h.style;let b=[];const S=lr(o);if(o===void 0)return b;if(S!=="object")return b=b.concat([new ot("light",o,`object expected, ${S} found`)]),b;for(const C in o){const k=C.match(/^(.*)-transition$/);b=b.concat(k&&f[k[1]]&&f[k[1]].transition?h.validateSpec({key:C,value:o[C],valueSpec:u.transition,validateSpec:h.validateSpec,style:g,styleSpec:u}):f[C]?h.validateSpec({key:C,value:o[C],valueSpec:f[C],validateSpec:h.validateSpec,style:g,styleSpec:u}):[new ot(C,o[C],`unknown property "${C}"`)])}return b}function z_(h){const o=h.value,u=h.styleSpec,f=u.sky,g=h.style,b=lr(o);if(o===void 0)return[];if(b!=="object")return[new ot("sky",o,`object expected, ${b} found`)];let S=[];for(const C in o)S=S.concat(f[C]?h.validateSpec({key:C,value:o[C],valueSpec:f[C],style:g,styleSpec:u}):[new ot(C,o[C],`unknown property "${C}"`)]);return S}function N_(h){const o=h.value,u=h.styleSpec,f=u.terrain,g=h.style;let b=[];const S=lr(o);if(o===void 0)return b;if(S!=="object")return b=b.concat([new ot("terrain",o,`object expected, ${S} found`)]),b;for(const C in o)b=b.concat(f[C]?h.validateSpec({key:C,value:o[C],valueSpec:f[C],validateSpec:h.validateSpec,style:g,styleSpec:u}):[new ot(C,o[C],`unknown property "${C}"`)]);return b}function Mc(h){let o=[];const u=h.value,f=h.key;if(Array.isArray(u)){const g=[],b=[];for(const S in u)u[S].id&&g.includes(u[S].id)&&o.push(new ot(f,u,`all the sprites' ids must be unique, but ${u[S].id} is duplicated`)),g.push(u[S].id),u[S].url&&b.includes(u[S].url)&&o.push(new ot(f,u,`all the sprites' URLs must be unique, but ${u[S].url} is duplicated`)),b.push(u[S].url),o=o.concat(js({key:`${f}[${S}]`,value:u[S],valueSpec:{id:{type:"string",required:!0},url:{type:"string",required:!0}},validateSpec:h.validateSpec}));return o}return Il({key:f,value:u})}function Ic(h){return o=h.value,o&&o.constructor===Object?[]:[new ot(h.key,h.value,`object expected, ${lr(h.value)} found`)];var o}const is={"*":()=>[],array:eg,boolean:function(h){const o=h.value,u=h.key,f=lr(o);return f!=="boolean"?[new ot(u,o,`boolean expected, ${f} found`)]:[]},number:ff,color:Ac,constants:I_,enum:fh,filter:pf,function:tg,layer:kc,object:js,source:L_,light:O_,sky:z_,terrain:N_,projection:function(h){const o=h.value,u=h.styleSpec,f=u.projection,g=h.style,b=lr(o);if(o===void 0)return[];if(b!=="object")return[new ot("projection",o,`object expected, ${b} found`)];let S=[];for(const C in o)S=S.concat(f[C]?h.validateSpec({key:C,value:o[C],valueSpec:f[C],style:g,styleSpec:u}):[new ot(C,o[C],`unknown property "${C}"`)]);return S},projectionDefinition:function(h){const o=h.key;let u=h.value;u=u instanceof String?u.valueOf():u;const f=lr(u);return f!=="array"||function(g){return Array.isArray(g)&&g.length===3&&typeof g[0]=="string"&&typeof g[1]=="string"&&typeof g[2]=="number"}(u)||function(g){return!!["interpolate","step","literal"].includes(g[0])}(u)?["array","string"].includes(f)?[]:[new ot(o,u,`projection expected, invalid type "${f}" found`)]:[new ot(o,u,`projection expected, invalid array ${JSON.stringify(u)} found`)]},string:Il,formatted:function(h){return Il(h).length===0?[]:Ml(h)},resolvedImage:function(h){return Il(h).length===0?[]:Ml(h)},padding:function(h){const o=h.key,u=h.value;if(lr(u)==="array"){if(u.length<1||u.length>4)return[new ot(o,u,`padding requires 1 to 4 values; ${u.length} values found`)];const f={type:"number"};let g=[];for(let b=0;b<u.length;b++)g=g.concat(h.validateSpec({key:`${o}[${b}]`,value:u[b],validateSpec:h.validateSpec,valueSpec:f}));return g}return ff({key:o,value:u,valueSpec:{}})},numberArray:function(h){const o=h.key,u=h.value;if(lr(u)==="array"){const f={type:"number"};if(u.length<1)return[new ot(o,u,"array length at least 1 expected, length 0 found")];let g=[];for(let b=0;b<u.length;b++)g=g.concat(h.validateSpec({key:`${o}[${b}]`,value:u[b],validateSpec:h.validateSpec,valueSpec:f}));return g}return ff({key:o,value:u,valueSpec:{}})},colorArray:function(h){const o=h.key,u=h.value;if(lr(u)==="array"){if(u.length<1)return[new ot(o,u,"array length at least 1 expected, length 0 found")];let f=[];for(let g=0;g<u.length;g++)f=f.concat(Ac({key:`${o}[${g}]`,value:u[g]}));return f}return Ac({key:o,value:u})},variableAnchorOffsetCollection:function(h){const o=h.key,u=h.value,f=lr(u),g=h.styleSpec;if(f!=="array"||u.length<1||u.length%2!=0)return[new ot(o,u,"variableAnchorOffsetCollection requires a non-empty array of even length")];let b=[];for(let S=0;S<u.length;S+=2)b=b.concat(fh({key:`${o}[${S}]`,value:u[S],valueSpec:g.layout_symbol["text-anchor"]})),b=b.concat(eg({key:`${o}[${S+1}]`,value:u[S+1],valueSpec:{length:2,value:"number"},validateSpec:h.validateSpec,style:h.style,styleSpec:g}));return b},sprite:Mc,state:Ic};function za(h){const o=h.value,u=h.valueSpec,f=h.styleSpec;return h.validateSpec=za,u.expression&&Jd(gn(o))?tg(h):u.expression&&tf(kl(o))?Ml(h):u.type&&is[u.type]?is[u.type](h):js(Ds({},h,{valueSpec:u.type?f[u.type]:u}))}function sg(h){const o=h.value,u=h.key,f=Il(h);return f.length||(o.indexOf("{fontstack}")===-1&&f.push(new ot(u,o,'"glyphs" url must include a "{fontstack}" token')),o.indexOf("{range}")===-1&&f.push(new ot(u,o,'"glyphs" url must include a "{range}" token'))),f}function Fs(h,o=je){let u=[];return u=u.concat(za({key:"",value:h,valueSpec:o.$root,styleSpec:o,style:h,validateSpec:za,objectElementValidators:{glyphs:sg,"*":()=>[]}})),h.constants&&(u=u.concat(I_({key:"constants",value:h.constants}))),Rc(u)}function oo(h){return function(o){return h(Object.assign({},o,{validateSpec:za}))}}function Rc(h){return[].concat(h).sort((o,u)=>o.line-u.line)}function Bs(h){return function(...o){return Rc(h.apply(this,o))}}Fs.source=Bs(oo(L_)),Fs.sprite=Bs(oo(Mc)),Fs.glyphs=Bs(oo(sg)),Fs.light=Bs(oo(O_)),Fs.sky=Bs(oo(z_)),Fs.terrain=Bs(oo(N_)),Fs.state=Bs(oo(Ic)),Fs.layer=Bs(oo(kc)),Fs.filter=Bs(oo(pf)),Fs.paintProperty=Bs(oo(ng)),Fs.layoutProperty=Bs(oo(ig));const Na=Fs,rw=Na.light,og=Na.sky,nw=Na.paintProperty,ph=Na.layoutProperty;function j_(h,o){let u=!1;if(o&&o.length)for(const f of o)h.fire(new Tt(new Error(f.message))),u=!0;return u}class mh{constructor(o,u,f){const g=this.cells=[];if(o instanceof ArrayBuffer){this.arrayBuffer=o;const S=new Int32Array(this.arrayBuffer);o=S[0],this.d=(u=S[1])+2*(f=S[2]);for(let k=0;k<this.d*this.d;k++){const N=S[3+k],F=S[3+k+1];g.push(N===F?null:S.subarray(N,F))}const C=S[3+g.length+1];this.keys=S.subarray(S[3+g.length],C),this.bboxes=S.subarray(C),this.insert=this._insertReadonly}else{this.d=u+2*f;for(let S=0;S<this.d*this.d;S++)g.push([]);this.keys=[],this.bboxes=[]}this.n=u,this.extent=o,this.padding=f,this.scale=u/o,this.uid=0;const b=f/u*o;this.min=-b,this.max=o+b}insert(o,u,f,g,b){this._forEachCell(u,f,g,b,this._insertCell,this.uid++,void 0,void 0),this.keys.push(o),this.bboxes.push(u),this.bboxes.push(f),this.bboxes.push(g),this.bboxes.push(b)}_insertReadonly(){throw new Error("Cannot insert into a GridIndex created from an ArrayBuffer.")}_insertCell(o,u,f,g,b,S){this.cells[b].push(S)}query(o,u,f,g,b){const S=this.min,C=this.max;if(o<=S&&u<=S&&C<=f&&C<=g&&!b)return Array.prototype.slice.call(this.keys);{const k=[];return this._forEachCell(o,u,f,g,this._queryCell,k,{},b),k}}_queryCell(o,u,f,g,b,S,C,k){const N=this.cells[b];if(N!==null){const F=this.keys,G=this.bboxes;for(let Y=0;Y<N.length;Y++){const J=N[Y];if(C[J]===void 0){const re=4*J;(k?k(G[re+0],G[re+1],G[re+2],G[re+3]):o<=G[re+2]&&u<=G[re+3]&&f>=G[re+0]&&g>=G[re+1])?(C[J]=!0,S.push(F[J])):C[J]=!1}}}}_forEachCell(o,u,f,g,b,S,C,k){const N=this._convertToCellCoord(o),F=this._convertToCellCoord(u),G=this._convertToCellCoord(f),Y=this._convertToCellCoord(g);for(let J=N;J<=G;J++)for(let re=F;re<=Y;re++){const le=this.d*re+J;if((!k||k(this._convertFromCellCoord(J),this._convertFromCellCoord(re),this._convertFromCellCoord(J+1),this._convertFromCellCoord(re+1)))&&b.call(this,o,u,f,g,le,S,C,k))return}}_convertFromCellCoord(o){return(o-this.padding)/this.scale}_convertToCellCoord(o){return Math.max(0,Math.min(this.d-1,Math.floor(o*this.scale)+this.padding))}toArrayBuffer(){if(this.arrayBuffer)return this.arrayBuffer;const o=this.cells,u=3+this.cells.length+1+1;let f=0;for(let S=0;S<this.cells.length;S++)f+=this.cells[S].length;const g=new Int32Array(u+f+this.keys.length+this.bboxes.length);g[0]=this.extent,g[1]=this.n,g[2]=this.padding;let b=u;for(let S=0;S<o.length;S++){const C=o[S];g[3+S]=b,g.set(C,b),b+=C.length}return g[3+o.length]=b,g.set(this.keys,b),b+=this.keys.length,g[3+o.length+1]=b,g.set(this.bboxes,b),b+=this.bboxes.length,g.buffer}static serialize(o,u){const f=o.toArrayBuffer();return u&&u.push(f),{buffer:f}}static deserialize(o){return new mh(o.buffer)}}const ia={};function xt(h,o,u={}){if(ia[h])throw new Error(`${h} is already registered.`);Object.defineProperty(o,"_classRegistryKey",{value:h,writeable:!1}),ia[h]={klass:o,omit:u.omit||[],shallow:u.shallow||[]}}xt("Object",Object),xt("Set",Set),xt("TransferableGridIndex",mh),xt("Color",ar),xt("Error",Error),xt("AJAXError",Ae),xt("ResolvedImage",_s),xt("StylePropertyFunction",of),xt("StyleExpression",Qm,{omit:["_evaluator"]}),xt("ZoomDependentExpression",sf),xt("ZoomConstantExpression",nf),xt("CompoundExpression",Ns,{omit:["_evaluate"]});for(const h in Tc)Tc[h]._classRegistryKey||xt(`Expression_${h}`,Tc[h]);function F_(h){return h&&typeof ArrayBuffer<"u"&&(h instanceof ArrayBuffer||h.constructor&&h.constructor.name==="ArrayBuffer")}function ag(h){return h.$name||h.constructor._classRegistryKey}function gh(h){return!function(o){if(o===null||typeof o!="object")return!1;const u=ag(o);return!(!u||u==="Object")}(h)&&(h==null||typeof h=="boolean"||typeof h=="number"||typeof h=="string"||h instanceof Boolean||h instanceof Number||h instanceof String||h instanceof Date||h instanceof RegExp||h instanceof Blob||h instanceof Error||F_(h)||Ar(h)||ArrayBuffer.isView(h)||h instanceof ImageData)}function yh(h,o){if(gh(h))return(F_(h)||Ar(h))&&o&&o.push(h),ArrayBuffer.isView(h)&&o&&o.push(h.buffer),h instanceof ImageData&&o&&o.push(h.data.buffer),h;if(Array.isArray(h)){const b=[];for(const S of h)b.push(yh(S,o));return b}if(typeof h!="object")throw new Error("can't serialize object of type "+typeof h);const u=ag(h);if(!u)throw new Error(`can't serialize object of unregistered class ${h.constructor.name}`);if(!ia[u])throw new Error(`${u} is not registered.`);const{klass:f}=ia[u],g=f.serialize?f.serialize(h,o):{};if(f.serialize){if(o&&g===o[o.length-1])throw new Error("statically serialized object won't survive transfer of $name property")}else{for(const b in h){if(!h.hasOwnProperty(b)||ia[u].omit.indexOf(b)>=0)continue;const S=h[b];g[b]=ia[u].shallow.indexOf(b)>=0?S:yh(S,o)}h instanceof Error&&(g.message=h.message)}if(g.$name)throw new Error("$name property is reserved for worker serialization logic.");return u!=="Object"&&(g.$name=u),g}function Rl(h){if(gh(h))return h;if(Array.isArray(h))return h.map(Rl);if(typeof h!="object")throw new Error("can't deserialize object of type "+typeof h);const o=ag(h)||"Object";if(!ia[o])throw new Error(`can't deserialize unregistered class ${o}`);const{klass:u}=ia[o];if(!u)throw new Error(`can't deserialize unregistered class ${o}`);if(u.deserialize)return u.deserialize(h);const f=Object.create(u.prototype);for(const g of Object.keys(h)){if(g==="$name")continue;const b=h[g];f[g]=ia[o].shallow.indexOf(g)>=0?b:Rl(b)}return f}class Dc{constructor(){this.first=!0}update(o,u){const f=Math.floor(o);return this.first?(this.first=!1,this.lastIntegerZoom=f,this.lastIntegerZoomTime=0,this.lastZoom=o,this.lastFloorZoom=f,!0):(this.lastFloorZoom>f?(this.lastIntegerZoom=f+1,this.lastIntegerZoomTime=u):this.lastFloorZoom<f&&(this.lastIntegerZoom=f,this.lastIntegerZoomTime=u),o!==this.lastZoom&&(this.lastZoom=o,this.lastFloorZoom=f,!0))}}const cr={"Latin-1 Supplement":h=>h>=128&&h<=255,"Hangul Jamo":h=>h>=4352&&h<=4607,Khmer:h=>h>=6016&&h<=6143,"General Punctuation":h=>h>=8192&&h<=8303,"Letterlike Symbols":h=>h>=8448&&h<=8527,"Number Forms":h=>h>=8528&&h<=8591,"Miscellaneous Technical":h=>h>=8960&&h<=9215,"Control Pictures":h=>h>=9216&&h<=9279,"Optical Character Recognition":h=>h>=9280&&h<=9311,"Enclosed Alphanumerics":h=>h>=9312&&h<=9471,"Geometric Shapes":h=>h>=9632&&h<=9727,"Miscellaneous Symbols":h=>h>=9728&&h<=9983,"Miscellaneous Symbols and Arrows":h=>h>=11008&&h<=11263,"Ideographic Description Characters":h=>h>=12272&&h<=12287,"CJK Symbols and Punctuation":h=>h>=12288&&h<=12351,Hiragana:h=>h>=12352&&h<=12447,Katakana:h=>h>=12448&&h<=12543,Kanbun:h=>h>=12688&&h<=12703,"CJK Strokes":h=>h>=12736&&h<=12783,"Enclosed CJK Letters and Months":h=>h>=12800&&h<=13055,"CJK Compatibility":h=>h>=13056&&h<=13311,"Yijing Hexagram Symbols":h=>h>=19904&&h<=19967,"CJK Unified Ideographs":h=>h>=19968&&h<=40959,"Hangul Syllables":h=>h>=44032&&h<=55215,"Private Use Area":h=>h>=57344&&h<=63743,"Vertical Forms":h=>h>=65040&&h<=65055,"CJK Compatibility Forms":h=>h>=65072&&h<=65103,"Small Form Variants":h=>h>=65104&&h<=65135,"Halfwidth and Fullwidth Forms":h=>h>=65280&&h<=65519};function mf(h){for(const o of h)if(yf(o.charCodeAt(0)))return!0;return!1}function B_(h){for(const o of h)if(!$_(o.charCodeAt(0)))return!1;return!0}function gf(h){const o=h.map(u=>{try{return new RegExp(`\\p{sc=${u}}`,"u").source}catch{return null}}).filter(u=>u);return new RegExp(o.join("|"),"u")}const lg=gf(["Arab","Dupl","Mong","Ougr","Syrc"]);function $_(h){return!lg.test(String.fromCodePoint(h))}const V_=gf(["Bopo","Hani","Hira","Kana","Kits","Nshu","Tang","Yiii"]);function yf(h){return!(h!==746&&h!==747&&(h<4352||!(cr["CJK Compatibility Forms"](h)&&!(h>=65097&&h<=65103)||cr["CJK Compatibility"](h)||cr["CJK Strokes"](h)||!(!cr["CJK Symbols and Punctuation"](h)||h>=12296&&h<=12305||h>=12308&&h<=12319||h===12336)||cr["Enclosed CJK Letters and Months"](h)||cr["Ideographic Description Characters"](h)||cr.Kanbun(h)||cr.Katakana(h)&&h!==12540||!(!cr["Halfwidth and Fullwidth Forms"](h)||h===65288||h===65289||h===65293||h>=65306&&h<=65310||h===65339||h===65341||h===65343||h>=65371&&h<=65503||h===65507||h>=65512&&h<=65519)||!(!cr["Small Form Variants"](h)||h>=65112&&h<=65118||h>=65123&&h<=65126)||cr["Vertical Forms"](h)||cr["Yijing Hexagram Symbols"](h)||new RegExp("\\p{sc=Cans}","u").test(String.fromCodePoint(h))||new RegExp("\\p{sc=Hang}","u").test(String.fromCodePoint(h))||V_.test(String.fromCodePoint(h)))))}function U_(h){return!(yf(h)||function(o){return!!(cr["Latin-1 Supplement"](o)&&(o===167||o===169||o===174||o===177||o===188||o===189||o===190||o===215||o===247)||cr["General Punctuation"](o)&&(o===8214||o===8224||o===8225||o===8240||o===8241||o===8251||o===8252||o===8258||o===8263||o===8264||o===8265||o===8273)||cr["Letterlike Symbols"](o)||cr["Number Forms"](o)||cr["Miscellaneous Technical"](o)&&(o>=8960&&o<=8967||o>=8972&&o<=8991||o>=8996&&o<=9e3||o===9003||o>=9085&&o<=9114||o>=9150&&o<=9165||o===9167||o>=9169&&o<=9179||o>=9186&&o<=9215)||cr["Control Pictures"](o)&&o!==9251||cr["Optical Character Recognition"](o)||cr["Enclosed Alphanumerics"](o)||cr["Geometric Shapes"](o)||cr["Miscellaneous Symbols"](o)&&!(o>=9754&&o<=9759)||cr["Miscellaneous Symbols and Arrows"](o)&&(o>=11026&&o<=11055||o>=11088&&o<=11097||o>=11192&&o<=11243)||cr["CJK Symbols and Punctuation"](o)||cr.Katakana(o)||cr["Private Use Area"](o)||cr["CJK Compatibility Forms"](o)||cr["Small Form Variants"](o)||cr["Halfwidth and Fullwidth Forms"](o)||o===8734||o===8756||o===8757||o>=9984&&o<=10087||o>=10102&&o<=10131||o===65532||o===65533)}(h))}const G_=gf(["Adlm","Arab","Armi","Avst","Chrs","Cprt","Egyp","Elym","Gara","Hatr","Hebr","Hung","Khar","Lydi","Mand","Mani","Mend","Merc","Mero","Narb","Nbat","Nkoo","Orkh","Palm","Phli","Phlp","Phnx","Prti","Rohg","Samr","Sarb","Sogo","Syrc","Thaa","Todr","Yezi"]);function W_(h){return G_.test(String.fromCodePoint(h))}function q_(h,o){return!(!o&&W_(h)||h>=2304&&h<=3583||h>=3840&&h<=4255||cr.Khmer(h))}function H_(h){for(const o of h)if(W_(o.charCodeAt(0)))return!0;return!1}const ja=new class{constructor(){this.TIMEOUT=5e3,this.applyArabicShaping=null,this.processBidirectionalText=null,this.processStyledBidirectionalText=null,this.pluginStatus="unavailable",this.pluginURL=null,this.loadScriptResolve=()=>{}}setState(h){this.pluginStatus=h.pluginStatus,this.pluginURL=h.pluginURL}getState(){return{pluginStatus:this.pluginStatus,pluginURL:this.pluginURL}}setMethods(h){if(ja.isParsed())throw new Error("RTL text plugin already registered.");this.applyArabicShaping=h.applyArabicShaping,this.processBidirectionalText=h.processBidirectionalText,this.processStyledBidirectionalText=h.processStyledBidirectionalText,this.loadScriptResolve()}isParsed(){return this.applyArabicShaping!=null&&this.processBidirectionalText!=null&&this.processStyledBidirectionalText!=null}getRTLTextPluginStatus(){return this.pluginStatus}syncState(h,o){return a(this,void 0,void 0,function*(){if(this.isParsed())return this.getState();if(h.pluginStatus!=="loading")return this.setState(h),h;const u=h.pluginURL,f=new Promise(b=>{this.loadScriptResolve=b});o(u);const g=new Promise(b=>setTimeout(()=>b(),this.TIMEOUT));if(yield Promise.race([f,g]),this.isParsed()){const b={pluginStatus:"loaded",pluginURL:u};return this.setState(b),b}throw this.setState({pluginStatus:"error",pluginURL:""}),new Error(`RTL Text Plugin failed to import scripts from ${u}`)})}};class $r{constructor(o,u){this.isSupportedScript=Z_,this.zoom=o,u?(this.now=u.now||0,this.fadeDuration=u.fadeDuration||0,this.zoomHistory=u.zoomHistory||new Dc,this.transition=u.transition||{}):(this.now=0,this.fadeDuration=0,this.zoomHistory=new Dc,this.transition={})}crossFadingFactor(){return this.fadeDuration===0?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)}getCrossfadeParameters(){const o=this.zoom,u=o-Math.floor(o),f=this.crossFadingFactor();return o>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:u+(1-u)*f}:{fromScale:.5,toScale:1,t:1-(1-f)*u}}}function Z_(h){return function(o,u){for(const f of o)if(!q_(f.charCodeAt(0),u))return!1;return!0}(h,ja.getRTLTextPluginStatus()==="loaded")}class _h{constructor(o,u,f){this.property=o,this.value=u,this.expression=function(g,b,S){if(Jd(g))return new of(g,b);if(tf(g)){const C=Jm(g,b,S);if(C.result==="error")throw new Error(C.value.map(k=>`${k.key}: ${k.message}`).join(", "));return C.value}{let C=g;return b.type==="color"&&typeof g=="string"?C=ar.parse(g):b.type!=="padding"||typeof g!="number"&&!Array.isArray(g)?b.type!=="numberArray"||typeof g!="number"&&!Array.isArray(g)?b.type!=="colorArray"||typeof g!="string"&&!Array.isArray(g)?b.type==="variableAnchorOffsetCollection"&&Array.isArray(g)?C=qi.parse(g):b.type==="projectionDefinition"&&typeof g=="string"&&(C=ns.parse(g)):C=Si.parse(g):C=ni.parse(g):C=wi.parse(g),{globalStateRefs:new Set,_globalState:null,kind:"constant",evaluate:()=>C}}}(u===void 0?o.specification.default:u,o.specification,f)}isDataDriven(){return this.expression.kind==="source"||this.expression.kind==="composite"}getGlobalStateRefs(){return this.expression.globalStateRefs||new Set}possiblyEvaluate(o,u,f){return this.property.possiblyEvaluate(this,o,u,f)}}class _f{constructor(o,u){this.property=o,this.value=new _h(o,void 0,u)}transitioned(o,u){return new vh(this.property,this.value,u,Ht({},o.transition,this.transition),o.now)}untransitioned(){return new vh(this.property,this.value,null,{},0)}}class cg{constructor(o,u){this._properties=o,this._values=Object.create(o.defaultTransitionablePropertyValues),this._globalState=u}getValue(o){return vt(this._values[o].value.value)}setValue(o,u){Object.prototype.hasOwnProperty.call(this._values,o)||(this._values[o]=new _f(this._values[o].property,this._globalState)),this._values[o].value=new _h(this._values[o].property,u===null?void 0:vt(u),this._globalState)}getTransition(o){return vt(this._values[o].transition)}setTransition(o,u){Object.prototype.hasOwnProperty.call(this._values,o)||(this._values[o]=new _f(this._values[o].property,this._globalState)),this._values[o].transition=vt(u)||void 0}serialize(){const o={};for(const u of Object.keys(this._values)){const f=this.getValue(u);f!==void 0&&(o[u]=f);const g=this.getTransition(u);g!==void 0&&(o[`${u}-transition`]=g)}return o}transitioned(o,u){const f=new K_(this._properties);for(const g of Object.keys(this._values))f._values[g]=this._values[g].transitioned(o,u._values[g]);return f}untransitioned(){const o=new K_(this._properties);for(const u of Object.keys(this._values))o._values[u]=this._values[u].untransitioned();return o}}class vh{constructor(o,u,f,g,b){this.property=o,this.value=u,this.begin=b+g.delay||0,this.end=this.begin+g.duration||0,o.specification.transition&&(g.delay||g.duration)&&(this.prior=f)}possiblyEvaluate(o,u,f){const g=o.now||0,b=this.value.possiblyEvaluate(o,u,f),S=this.prior;if(S){if(g>this.end)return this.prior=null,b;if(this.value.isDataDriven())return this.prior=null,b;if(g<this.begin)return S.possiblyEvaluate(o,u,f);{const C=(g-this.begin)/(this.end-this.begin);return this.property.interpolate(S.possiblyEvaluate(o,u,f),b,st(C))}}return b}}class K_{constructor(o){this._properties=o,this._values=Object.create(o.defaultTransitioningPropertyValues)}possiblyEvaluate(o,u,f){const g=new vf(this._properties);for(const b of Object.keys(this._values))g._values[b]=this._values[b].possiblyEvaluate(o,u,f);return g}hasTransition(){for(const o of Object.keys(this._values))if(this._values[o].prior)return!0;return!1}}class ug{constructor(o,u){this._properties=o,this._values=Object.create(o.defaultPropertyValues),this._globalState=u}hasValue(o){return this._values[o].value!==void 0}getValue(o){return vt(this._values[o].value)}setValue(o,u){this._values[o]=new _h(this._values[o].property,u===null?void 0:vt(u),this._globalState)}serialize(){const o={};for(const u of Object.keys(this._values)){const f=this.getValue(u);f!==void 0&&(o[u]=f)}return o}possiblyEvaluate(o,u,f){const g=new vf(this._properties);for(const b of Object.keys(this._values))g._values[b]=this._values[b].possiblyEvaluate(o,u,f);return g}}class Lo{constructor(o,u,f){this.property=o,this.value=u,this.parameters=f}isConstant(){return this.value.kind==="constant"}constantOr(o){return this.value.kind==="constant"?this.value.value:o}evaluate(o,u,f,g){return this.property.evaluate(this.value,this.parameters,o,u,f,g)}}class vf{constructor(o){this._properties=o,this._values=Object.create(o.defaultPossiblyEvaluatedValues)}get(o){return this._values[o]}}class kt{constructor(o){this.specification=o}possiblyEvaluate(o,u){if(o.isDataDriven())throw new Error("Value should not be data driven");return o.expression.evaluate(u)}interpolate(o,u,f){const g=zs[this.specification.type];return g?g(o,u,f):o}}class Bt{constructor(o,u){this.specification=o,this.overrides=u}possiblyEvaluate(o,u,f,g){return new Lo(this,o.expression.kind==="constant"||o.expression.kind==="camera"?{kind:"constant",value:o.expression.evaluate(u,null,{},f,g)}:o.expression,u)}interpolate(o,u,f){if(o.value.kind!=="constant"||u.value.kind!=="constant")return o;if(o.value.value===void 0||u.value.value===void 0)return new Lo(this,{kind:"constant",value:void 0},o.parameters);const g=zs[this.specification.type];if(g){const b=g(o.value.value,u.value.value,f);return new Lo(this,{kind:"constant",value:b},o.parameters)}return o}evaluate(o,u,f,g,b,S){return o.kind==="constant"?o.value:o.evaluate(u,f,g,b,S)}}class Lc extends Bt{possiblyEvaluate(o,u,f,g){if(o.value===void 0)return new Lo(this,{kind:"constant",value:void 0},u);if(o.expression.kind==="constant"){const b=o.expression.evaluate(u,null,{},f,g),S=o.property.specification.type==="resolvedImage"&&typeof b!="string"?b.name:b,C=this._calculate(S,S,S,u);return new Lo(this,{kind:"constant",value:C},u)}if(o.expression.kind==="camera"){const b=this._calculate(o.expression.evaluate({zoom:u.zoom-1}),o.expression.evaluate({zoom:u.zoom}),o.expression.evaluate({zoom:u.zoom+1}),u);return new Lo(this,{kind:"constant",value:b},u)}return new Lo(this,o.expression,u)}evaluate(o,u,f,g,b,S){if(o.kind==="source"){const C=o.evaluate(u,f,g,b,S);return this._calculate(C,C,C,u)}return o.kind==="composite"?this._calculate(o.evaluate({zoom:Math.floor(u.zoom)-1},f,g),o.evaluate({zoom:Math.floor(u.zoom)},f,g),o.evaluate({zoom:Math.floor(u.zoom)+1},f,g),u):o.value}_calculate(o,u,f,g){return g.zoom>g.zoomHistory.lastIntegerZoom?{from:o,to:u}:{from:f,to:u}}interpolate(o){return o}}class X_{constructor(o){this.specification=o}possiblyEvaluate(o,u,f,g){if(o.value!==void 0){if(o.expression.kind==="constant"){const b=o.expression.evaluate(u,null,{},f,g);return this._calculate(b,b,b,u)}return this._calculate(o.expression.evaluate(new $r(Math.floor(u.zoom-1),u)),o.expression.evaluate(new $r(Math.floor(u.zoom),u)),o.expression.evaluate(new $r(Math.floor(u.zoom+1),u)),u)}}_calculate(o,u,f,g){return g.zoom>g.zoomHistory.lastIntegerZoom?{from:o,to:u}:{from:f,to:u}}interpolate(o){return o}}class xf{constructor(o){this.specification=o}possiblyEvaluate(o,u,f,g){return!!o.expression.evaluate(u,null,{},f,g)}interpolate(){return!1}}class Hi{constructor(o){this.properties=o,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];for(const u in o){const f=o[u];f.specification.overridable&&this.overridableProperties.push(u);const g=this.defaultPropertyValues[u]=new _h(f,void 0,void 0),b=this.defaultTransitionablePropertyValues[u]=new _f(f,void 0);this.defaultTransitioningPropertyValues[u]=b.untransitioned(),this.defaultPossiblyEvaluatedValues[u]=g.possiblyEvaluate({})}}}xt("DataDrivenProperty",Bt),xt("DataConstantProperty",kt),xt("CrossFadedDataDrivenProperty",Lc),xt("CrossFadedProperty",X_),xt("ColorRampProperty",xf);const Y_="-transition";class ao extends It{constructor(o,u,f){if(super(),this.id=o.id,this.type=o.type,this._globalState=f,this._featureFilter={filter:()=>!0,needGeometry:!1,getGlobalStateRefs:()=>new Set},o.type!=="custom"&&(this.metadata=o.metadata,this.minzoom=o.minzoom,this.maxzoom=o.maxzoom,o.type!=="background"&&(this.source=o.source,this.sourceLayer=o["source-layer"],this.filter=o.filter,this._featureFilter=uh(o.filter,f)),u.layout&&(this._unevaluatedLayout=new ug(u.layout,f)),u.paint)){this._transitionablePaint=new cg(u.paint,f);for(const g in o.paint)this.setPaintProperty(g,o.paint[g],{validate:!1});for(const g in o.layout)this.setLayoutProperty(g,o.layout[g],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new vf(u.paint)}}setFilter(o){this.filter=o,this._featureFilter=uh(o,this._globalState)}getCrossfadeParameters(){return this._crossfadeParameters}getLayoutProperty(o){return o==="visibility"?this.visibility:this._unevaluatedLayout.getValue(o)}getLayoutAffectingGlobalStateRefs(){const o=new Set;if(this._unevaluatedLayout)for(const u in this._unevaluatedLayout._values){const f=this._unevaluatedLayout._values[u];for(const g of f.getGlobalStateRefs())o.add(g)}for(const u of this._featureFilter.getGlobalStateRefs())o.add(u);return o}getPaintAffectingGlobalStateRefs(){var o;const u=new globalThis.Map;if(this._transitionablePaint)for(const f in this._transitionablePaint._values){const g=this._transitionablePaint._values[f].value;for(const b of g.getGlobalStateRefs()){const S=(o=u.get(b))!==null&&o!==void 0?o:[];S.push({name:f,value:g.value}),u.set(b,S)}}return u}setLayoutProperty(o,u,f={}){u!=null&&this._validate(ph,`layers.${this.id}.layout.${o}`,o,u,f)||(o!=="visibility"?this._unevaluatedLayout.setValue(o,u):this.visibility=u)}getPaintProperty(o){return o.endsWith(Y_)?this._transitionablePaint.getTransition(o.slice(0,-11)):this._transitionablePaint.getValue(o)}setPaintProperty(o,u,f={}){if(u!=null&&this._validate(nw,`layers.${this.id}.paint.${o}`,o,u,f))return!1;if(o.endsWith(Y_))return this._transitionablePaint.setTransition(o.slice(0,-11),u||void 0),!1;{const g=this._transitionablePaint._values[o],b=g.property.specification["property-type"]==="cross-faded-data-driven",S=g.value.isDataDriven(),C=g.value;this._transitionablePaint.setValue(o,u),this._handleSpecialPaintPropertyUpdate(o);const k=this._transitionablePaint._values[o].value;return k.isDataDriven()||S||b||this._handleOverridablePaintPropertyUpdate(o,C,k)}}_handleSpecialPaintPropertyUpdate(o){}_handleOverridablePaintPropertyUpdate(o,u,f){return!1}isHidden(o){return!!(this.minzoom&&o<this.minzoom)||!!(this.maxzoom&&o>=this.maxzoom)||this.visibility==="none"}updateTransitions(o){this._transitioningPaint=this._transitionablePaint.transitioned(o,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(o,u){o.getCrossfadeParameters&&(this._crossfadeParameters=o.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(o,void 0,u)),this.paint=this._transitioningPaint.possiblyEvaluate(o,void 0,u)}serialize(){const o={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(o.layout=o.layout||{},o.layout.visibility=this.visibility),$t(o,(u,f)=>!(u===void 0||f==="layout"&&!Object.keys(u).length||f==="paint"&&!Object.keys(u).length))}_validate(o,u,f,g,b={}){return(!b||b.validate!==!1)&&j_(this,o.call(Na,{key:u,layerType:this.type,objectKey:f,value:g,styleSpec:je,style:{glyphs:!0,sprite:!0}}))}is3D(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}resize(){}isStateDependent(){for(const o in this.paint._values){const u=this.paint.get(o);if(u instanceof Lo&&Cc(u.property.specification)&&(u.value.kind==="source"||u.value.kind==="composite")&&u.value.isStateDependent)return!0}return!1}}let Dl;var iw={get paint(){return Dl=Dl||new Hi({"raster-opacity":new kt(je.paint_raster["raster-opacity"]),"raster-hue-rotate":new kt(je.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new kt(je.paint_raster["raster-brightness-min"]),"raster-brightness-max":new kt(je.paint_raster["raster-brightness-max"]),"raster-saturation":new kt(je.paint_raster["raster-saturation"]),"raster-contrast":new kt(je.paint_raster["raster-contrast"]),"raster-resampling":new kt(je.paint_raster["raster-resampling"]),"raster-fade-duration":new kt(je.paint_raster["raster-fade-duration"])})}};class sw extends ao{constructor(o,u){super(o,iw,u)}}const ow={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class Oc{constructor(o,u){this._structArray=o,this._pos1=u*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class nn{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(o,u){return o._trim(),u&&(o.isTransferred=!0,u.push(o.arrayBuffer)),{length:o.length,arrayBuffer:o.arrayBuffer}}static deserialize(o){const u=Object.create(this.prototype);return u.arrayBuffer=o.arrayBuffer,u.length=o.length,u.capacity=o.arrayBuffer.byteLength/u.bytesPerElement,u._refreshViews(),u}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(o){this.reserve(o),this.length=o}reserve(o){if(o>this.capacity){this.capacity=Math.max(o,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const u=this.uint8;this._refreshViews(),u&&this.uint8.set(u)}}_refreshViews(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")}}function yn(h,o=1){let u=0,f=0;return{members:h.map(g=>{const b=ow[g.type].BYTES_PER_ELEMENT,S=u=Fa(u,Math.max(o,b)),C=g.components||1;return f=Math.max(f,b),u+=b*C,{name:g.name,type:g.type,components:C,offset:S}}),size:Fa(u,Math.max(f,o)),alignment:o}}function Fa(h,o){return Math.ceil(h/o)*o}class zc extends nn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(o,u){const f=this.length;return this.resize(f+1),this.emplace(f,o,u)}emplace(o,u,f){const g=2*o;return this.int16[g+0]=u,this.int16[g+1]=f,o}}zc.prototype.bytesPerElement=4,xt("StructArrayLayout2i4",zc);class Nc extends nn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(o,u,f){const g=this.length;return this.resize(g+1),this.emplace(g,o,u,f)}emplace(o,u,f,g){const b=3*o;return this.int16[b+0]=u,this.int16[b+1]=f,this.int16[b+2]=g,o}}Nc.prototype.bytesPerElement=6,xt("StructArrayLayout3i6",Nc);class bf extends nn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(o,u,f,g){const b=this.length;return this.resize(b+1),this.emplace(b,o,u,f,g)}emplace(o,u,f,g,b){const S=4*o;return this.int16[S+0]=u,this.int16[S+1]=f,this.int16[S+2]=g,this.int16[S+3]=b,o}}bf.prototype.bytesPerElement=8,xt("StructArrayLayout4i8",bf);class xh extends nn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(o,u,f,g,b,S){const C=this.length;return this.resize(C+1),this.emplace(C,o,u,f,g,b,S)}emplace(o,u,f,g,b,S,C){const k=6*o;return this.int16[k+0]=u,this.int16[k+1]=f,this.int16[k+2]=g,this.int16[k+3]=b,this.int16[k+4]=S,this.int16[k+5]=C,o}}xh.prototype.bytesPerElement=12,xt("StructArrayLayout2i4i12",xh);class hg extends nn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(o,u,f,g,b,S){const C=this.length;return this.resize(C+1),this.emplace(C,o,u,f,g,b,S)}emplace(o,u,f,g,b,S,C){const k=4*o,N=8*o;return this.int16[k+0]=u,this.int16[k+1]=f,this.uint8[N+4]=g,this.uint8[N+5]=b,this.uint8[N+6]=S,this.uint8[N+7]=C,o}}hg.prototype.bytesPerElement=8,xt("StructArrayLayout2i4ub8",hg);class Ba extends nn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(o,u){const f=this.length;return this.resize(f+1),this.emplace(f,o,u)}emplace(o,u,f){const g=2*o;return this.float32[g+0]=u,this.float32[g+1]=f,o}}Ba.prototype.bytesPerElement=8,xt("StructArrayLayout2f8",Ba);class Ll extends nn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(o,u,f,g,b,S,C,k,N,F){const G=this.length;return this.resize(G+1),this.emplace(G,o,u,f,g,b,S,C,k,N,F)}emplace(o,u,f,g,b,S,C,k,N,F,G){const Y=10*o;return this.uint16[Y+0]=u,this.uint16[Y+1]=f,this.uint16[Y+2]=g,this.uint16[Y+3]=b,this.uint16[Y+4]=S,this.uint16[Y+5]=C,this.uint16[Y+6]=k,this.uint16[Y+7]=N,this.uint16[Y+8]=F,this.uint16[Y+9]=G,o}}Ll.prototype.bytesPerElement=20,xt("StructArrayLayout10ui20",Ll);class dg extends nn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(o,u,f,g,b,S,C,k){const N=this.length;return this.resize(N+1),this.emplace(N,o,u,f,g,b,S,C,k)}emplace(o,u,f,g,b,S,C,k,N){const F=8*o;return this.uint16[F+0]=u,this.uint16[F+1]=f,this.uint16[F+2]=g,this.uint16[F+3]=b,this.uint16[F+4]=S,this.uint16[F+5]=C,this.uint16[F+6]=k,this.uint16[F+7]=N,o}}dg.prototype.bytesPerElement=16,xt("StructArrayLayout8ui16",dg);class wf extends nn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(o,u,f,g,b,S,C,k,N,F,G,Y){const J=this.length;return this.resize(J+1),this.emplace(J,o,u,f,g,b,S,C,k,N,F,G,Y)}emplace(o,u,f,g,b,S,C,k,N,F,G,Y,J){const re=12*o;return this.int16[re+0]=u,this.int16[re+1]=f,this.int16[re+2]=g,this.int16[re+3]=b,this.uint16[re+4]=S,this.uint16[re+5]=C,this.uint16[re+6]=k,this.uint16[re+7]=N,this.int16[re+8]=F,this.int16[re+9]=G,this.int16[re+10]=Y,this.int16[re+11]=J,o}}wf.prototype.bytesPerElement=24,xt("StructArrayLayout4i4ui4i24",wf);class Ol extends nn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(o,u,f){const g=this.length;return this.resize(g+1),this.emplace(g,o,u,f)}emplace(o,u,f,g){const b=3*o;return this.float32[b+0]=u,this.float32[b+1]=f,this.float32[b+2]=g,o}}Ol.prototype.bytesPerElement=12,xt("StructArrayLayout3f12",Ol);class fg extends nn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(o){const u=this.length;return this.resize(u+1),this.emplace(u,o)}emplace(o,u){return this.uint32[1*o+0]=u,o}}fg.prototype.bytesPerElement=4,xt("StructArrayLayout1ul4",fg);class pg extends nn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(o,u,f,g,b,S,C,k,N){const F=this.length;return this.resize(F+1),this.emplace(F,o,u,f,g,b,S,C,k,N)}emplace(o,u,f,g,b,S,C,k,N,F){const G=10*o,Y=5*o;return this.int16[G+0]=u,this.int16[G+1]=f,this.int16[G+2]=g,this.int16[G+3]=b,this.int16[G+4]=S,this.int16[G+5]=C,this.uint32[Y+3]=k,this.uint16[G+8]=N,this.uint16[G+9]=F,o}}pg.prototype.bytesPerElement=20,xt("StructArrayLayout6i1ul2ui20",pg);class Sf extends nn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(o,u,f,g,b,S){const C=this.length;return this.resize(C+1),this.emplace(C,o,u,f,g,b,S)}emplace(o,u,f,g,b,S,C){const k=6*o;return this.int16[k+0]=u,this.int16[k+1]=f,this.int16[k+2]=g,this.int16[k+3]=b,this.int16[k+4]=S,this.int16[k+5]=C,o}}Sf.prototype.bytesPerElement=12,xt("StructArrayLayout2i2i2i12",Sf);class mg extends nn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(o,u,f,g,b){const S=this.length;return this.resize(S+1),this.emplace(S,o,u,f,g,b)}emplace(o,u,f,g,b,S){const C=4*o,k=8*o;return this.float32[C+0]=u,this.float32[C+1]=f,this.float32[C+2]=g,this.int16[k+6]=b,this.int16[k+7]=S,o}}mg.prototype.bytesPerElement=16,xt("StructArrayLayout2f1f2i16",mg);class x extends nn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(o,u,f,g,b,S){const C=this.length;return this.resize(C+1),this.emplace(C,o,u,f,g,b,S)}emplace(o,u,f,g,b,S,C){const k=16*o,N=4*o,F=8*o;return this.uint8[k+0]=u,this.uint8[k+1]=f,this.float32[N+1]=g,this.float32[N+2]=b,this.int16[F+6]=S,this.int16[F+7]=C,o}}x.prototype.bytesPerElement=16,xt("StructArrayLayout2ub2f2i16",x);class i extends nn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(o,u,f){const g=this.length;return this.resize(g+1),this.emplace(g,o,u,f)}emplace(o,u,f,g){const b=3*o;return this.uint16[b+0]=u,this.uint16[b+1]=f,this.uint16[b+2]=g,o}}i.prototype.bytesPerElement=6,xt("StructArrayLayout3ui6",i);class d extends nn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(o,u,f,g,b,S,C,k,N,F,G,Y,J,re,le,pe,be){const Fe=this.length;return this.resize(Fe+1),this.emplace(Fe,o,u,f,g,b,S,C,k,N,F,G,Y,J,re,le,pe,be)}emplace(o,u,f,g,b,S,C,k,N,F,G,Y,J,re,le,pe,be,Fe){const ke=24*o,De=12*o,Ue=48*o;return this.int16[ke+0]=u,this.int16[ke+1]=f,this.uint16[ke+2]=g,this.uint16[ke+3]=b,this.uint32[De+2]=S,this.uint32[De+3]=C,this.uint32[De+4]=k,this.uint16[ke+10]=N,this.uint16[ke+11]=F,this.uint16[ke+12]=G,this.float32[De+7]=Y,this.float32[De+8]=J,this.uint8[Ue+36]=re,this.uint8[Ue+37]=le,this.uint8[Ue+38]=pe,this.uint32[De+10]=be,this.int16[ke+22]=Fe,o}}d.prototype.bytesPerElement=48,xt("StructArrayLayout2i2ui3ul3ui2f3ub1ul1i48",d);class p extends nn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(o,u,f,g,b,S,C,k,N,F,G,Y,J,re,le,pe,be,Fe,ke,De,Ue,Ke,it,yt,ht,pt,Ot,ft){const mt=this.length;return this.resize(mt+1),this.emplace(mt,o,u,f,g,b,S,C,k,N,F,G,Y,J,re,le,pe,be,Fe,ke,De,Ue,Ke,it,yt,ht,pt,Ot,ft)}emplace(o,u,f,g,b,S,C,k,N,F,G,Y,J,re,le,pe,be,Fe,ke,De,Ue,Ke,it,yt,ht,pt,Ot,ft,mt){const et=32*o,Vt=16*o;return this.int16[et+0]=u,this.int16[et+1]=f,this.int16[et+2]=g,this.int16[et+3]=b,this.int16[et+4]=S,this.int16[et+5]=C,this.int16[et+6]=k,this.int16[et+7]=N,this.uint16[et+8]=F,this.uint16[et+9]=G,this.uint16[et+10]=Y,this.uint16[et+11]=J,this.uint16[et+12]=re,this.uint16[et+13]=le,this.uint16[et+14]=pe,this.uint16[et+15]=be,this.uint16[et+16]=Fe,this.uint16[et+17]=ke,this.uint16[et+18]=De,this.uint16[et+19]=Ue,this.uint16[et+20]=Ke,this.uint16[et+21]=it,this.uint16[et+22]=yt,this.uint32[Vt+12]=ht,this.float32[Vt+13]=pt,this.float32[Vt+14]=Ot,this.uint16[et+30]=ft,this.uint16[et+31]=mt,o}}p.prototype.bytesPerElement=64,xt("StructArrayLayout8i15ui1ul2f2ui64",p);class _ extends nn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(o){const u=this.length;return this.resize(u+1),this.emplace(u,o)}emplace(o,u){return this.float32[1*o+0]=u,o}}_.prototype.bytesPerElement=4,xt("StructArrayLayout1f4",_);class w extends nn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(o,u,f){const g=this.length;return this.resize(g+1),this.emplace(g,o,u,f)}emplace(o,u,f,g){const b=3*o;return this.uint16[6*o+0]=u,this.float32[b+1]=f,this.float32[b+2]=g,o}}w.prototype.bytesPerElement=12,xt("StructArrayLayout1ui2f12",w);class E extends nn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(o,u,f){const g=this.length;return this.resize(g+1),this.emplace(g,o,u,f)}emplace(o,u,f,g){const b=4*o;return this.uint32[2*o+0]=u,this.uint16[b+2]=f,this.uint16[b+3]=g,o}}E.prototype.bytesPerElement=8,xt("StructArrayLayout1ul2ui8",E);class M extends nn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(o,u){const f=this.length;return this.resize(f+1),this.emplace(f,o,u)}emplace(o,u,f){const g=2*o;return this.uint16[g+0]=u,this.uint16[g+1]=f,o}}M.prototype.bytesPerElement=4,xt("StructArrayLayout2ui4",M);class D extends nn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(o){const u=this.length;return this.resize(u+1),this.emplace(u,o)}emplace(o,u){return this.uint16[1*o+0]=u,o}}D.prototype.bytesPerElement=2,xt("StructArrayLayout1ui2",D);class $ extends nn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(o,u,f,g){const b=this.length;return this.resize(b+1),this.emplace(b,o,u,f,g)}emplace(o,u,f,g,b){const S=4*o;return this.float32[S+0]=u,this.float32[S+1]=f,this.float32[S+2]=g,this.float32[S+3]=b,o}}$.prototype.bytesPerElement=16,xt("StructArrayLayout4f16",$);class U extends Oc{get anchorPointX(){return this._structArray.int16[this._pos2+0]}get anchorPointY(){return this._structArray.int16[this._pos2+1]}get x1(){return this._structArray.int16[this._pos2+2]}get y1(){return this._structArray.int16[this._pos2+3]}get x2(){return this._structArray.int16[this._pos2+4]}get y2(){return this._structArray.int16[this._pos2+5]}get featureIndex(){return this._structArray.uint32[this._pos4+3]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+8]}get bucketIndex(){return this._structArray.uint16[this._pos2+9]}get anchorPoint(){return new m(this.anchorPointX,this.anchorPointY)}}U.prototype.size=20;class K extends pg{get(o){return new U(this,o)}}xt("CollisionBoxArray",K);class H extends Oc{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+2]}get numGlyphs(){return this._structArray.uint16[this._pos2+3]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+2]}get lineStartIndex(){return this._structArray.uint32[this._pos4+3]}get lineLength(){return this._structArray.uint32[this._pos4+4]}get segment(){return this._structArray.uint16[this._pos2+10]}get lowerSize(){return this._structArray.uint16[this._pos2+11]}get upperSize(){return this._structArray.uint16[this._pos2+12]}get lineOffsetX(){return this._structArray.float32[this._pos4+7]}get lineOffsetY(){return this._structArray.float32[this._pos4+8]}get writingMode(){return this._structArray.uint8[this._pos1+36]}get placedOrientation(){return this._structArray.uint8[this._pos1+37]}set placedOrientation(o){this._structArray.uint8[this._pos1+37]=o}get hidden(){return this._structArray.uint8[this._pos1+38]}set hidden(o){this._structArray.uint8[this._pos1+38]=o}get crossTileID(){return this._structArray.uint32[this._pos4+10]}set crossTileID(o){this._structArray.uint32[this._pos4+10]=o}get associatedIconIndex(){return this._structArray.int16[this._pos2+22]}}H.prototype.size=48;class ee extends d{get(o){return new H(this,o)}}xt("PlacedSymbolArray",ee);class ae extends Oc{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+2]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+3]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+4]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+5]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+6]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+7]}get key(){return this._structArray.uint16[this._pos2+8]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+9]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+10]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+11]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+12]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+13]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+14]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+15]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+16]}get featureIndex(){return this._structArray.uint16[this._pos2+17]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+18]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+19]}get numIconVertices(){return this._structArray.uint16[this._pos2+20]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+21]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+22]}get crossTileID(){return this._structArray.uint32[this._pos4+12]}set crossTileID(o){this._structArray.uint32[this._pos4+12]=o}get textBoxScale(){return this._structArray.float32[this._pos4+13]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+14]}get textAnchorOffsetStartIndex(){return this._structArray.uint16[this._pos2+30]}get textAnchorOffsetEndIndex(){return this._structArray.uint16[this._pos2+31]}}ae.prototype.size=64;class me extends p{get(o){return new ae(this,o)}}xt("SymbolInstanceArray",me);class ge extends _{getoffsetX(o){return this.float32[1*o+0]}}xt("GlyphOffsetArray",ge);class _e extends Nc{getx(o){return this.int16[3*o+0]}gety(o){return this.int16[3*o+1]}gettileUnitDistanceFromAnchor(o){return this.int16[3*o+2]}}xt("SymbolLineVertexArray",_e);class Te extends Oc{get textAnchor(){return this._structArray.uint16[this._pos2+0]}get textOffset0(){return this._structArray.float32[this._pos4+1]}get textOffset1(){return this._structArray.float32[this._pos4+2]}}Te.prototype.size=12;class Ce extends w{get(o){return new Te(this,o)}}xt("TextAnchorOffsetArray",Ce);class Ee extends Oc{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}}Ee.prototype.size=8;class Ie extends E{get(o){return new Ee(this,o)}}xt("FeatureIndexArray",Ie);class Le extends zc{}class Pe extends zc{}class Ne extends zc{}class qe extends xh{}class Ve extends hg{}class Ge extends Ba{}class We extends Ll{}class ct extends dg{}class ut extends wf{}class tt extends Ol{}class At extends fg{}class qt extends Sf{}class Mr extends x{}class Ir extends i{}class Fr extends M{}const sn=yn([{name:"a_pos",components:2,type:"Int16"}],4),{members:Ur}=sn;class gr{constructor(o=[]){this._forceNewSegmentOnNextPrepare=!1,this.segments=o}prepareSegment(o,u,f,g){const b=this.segments[this.segments.length-1];return o>gr.MAX_VERTEX_ARRAY_LENGTH&&Rt(`Max vertices per segment is ${gr.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${o}. Consider using the \`fillLargeMeshArrays\` function if you require meshes with more than ${gr.MAX_VERTEX_ARRAY_LENGTH} vertices.`),this._forceNewSegmentOnNextPrepare||!b||b.vertexLength+o>gr.MAX_VERTEX_ARRAY_LENGTH||b.sortKey!==g?this.createNewSegment(u,f,g):b}createNewSegment(o,u,f){const g={vertexOffset:o.length,primitiveOffset:u.length,vertexLength:0,primitiveLength:0,vaos:{}};return f!==void 0&&(g.sortKey=f),this._forceNewSegmentOnNextPrepare=!1,this.segments.push(g),g}getOrCreateLatestSegment(o,u,f){return this.prepareSegment(0,o,u,f)}forceNewSegmentOnNextPrepare(){this._forceNewSegmentOnNextPrepare=!0}get(){return this.segments}destroy(){for(const o of this.segments)for(const u in o.vaos)o.vaos[u].destroy()}static simpleSegment(o,u,f,g){return new gr([{vertexOffset:o,primitiveOffset:u,vertexLength:f,primitiveLength:g,vaos:{},sortKey:0}])}}function Xr(h,o){return 256*(h=Ct(Math.floor(h),0,255))+Ct(Math.floor(o),0,255)}gr.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,xt("SegmentVector",gr);const Ti=yn([{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint16"},{name:"a_pixel_ratio_to",components:1,type:"Uint16"}]),Cn=yn([{name:"a_dasharray_from",components:4,type:"Uint16"},{name:"a_dasharray_to",components:4,type:"Uint16"}]);var Pn,Zi,$a,lo={exports:{}},Va={exports:{}},zl={exports:{}},Tf=function(){if($a)return lo.exports;$a=1;var h=(Pn||(Pn=1,Va.exports=function(u,f){var g,b,S,C,k,N,F,G;for(b=u.length-(g=3&u.length),S=f,k=3432918353,N=461845907,G=0;G<b;)F=255&u.charCodeAt(G)|(255&u.charCodeAt(++G))<<8|(255&u.charCodeAt(++G))<<16|(255&u.charCodeAt(++G))<<24,++G,S=27492+(65535&(C=5*(65535&(S=(S^=F=(65535&(F=(F=(65535&F)*k+(((F>>>16)*k&65535)<<16)&4294967295)<<15|F>>>17))*N+(((F>>>16)*N&65535)<<16)&4294967295)<<13|S>>>19))+((5*(S>>>16)&65535)<<16)&4294967295))+((58964+(C>>>16)&65535)<<16);switch(F=0,g){case 3:F^=(255&u.charCodeAt(G+2))<<16;case 2:F^=(255&u.charCodeAt(G+1))<<8;case 1:S^=F=(65535&(F=(F=(65535&(F^=255&u.charCodeAt(G)))*k+(((F>>>16)*k&65535)<<16)&4294967295)<<15|F>>>17))*N+(((F>>>16)*N&65535)<<16)&4294967295}return S^=u.length,S=2246822507*(65535&(S^=S>>>16))+((2246822507*(S>>>16)&65535)<<16)&4294967295,S=3266489909*(65535&(S^=S>>>13))+((3266489909*(S>>>16)&65535)<<16)&4294967295,(S^=S>>>16)>>>0}),Va.exports),o=(Zi||(Zi=1,zl.exports=function(u,f){for(var g,b=u.length,S=f^b,C=0;b>=4;)g=1540483477*(65535&(g=255&u.charCodeAt(C)|(255&u.charCodeAt(++C))<<8|(255&u.charCodeAt(++C))<<16|(255&u.charCodeAt(++C))<<24))+((1540483477*(g>>>16)&65535)<<16),S=1540483477*(65535&S)+((1540483477*(S>>>16)&65535)<<16)^(g=1540483477*(65535&(g^=g>>>24))+((1540483477*(g>>>16)&65535)<<16)),b-=4,++C;switch(b){case 3:S^=(255&u.charCodeAt(C+2))<<16;case 2:S^=(255&u.charCodeAt(C+1))<<8;case 1:S=1540483477*(65535&(S^=255&u.charCodeAt(C)))+((1540483477*(S>>>16)&65535)<<16)}return S=1540483477*(65535&(S^=S>>>13))+((1540483477*(S>>>16)&65535)<<16),(S^=S>>>15)>>>0}),zl.exports);return lo.exports=h,lo.exports.murmur3=h,lo.exports.murmur2=o,lo.exports}(),jc=y(Tf);class sa{constructor(){this.ids=[],this.positions=[],this.indexed=!1}add(o,u,f,g){this.ids.push(vs(o)),this.positions.push(u,f,g)}getPositions(o){if(!this.indexed)throw new Error("Trying to get index, but feature positions are not indexed");const u=vs(o);let f=0,g=this.ids.length-1;for(;f<g;){const S=f+g>>1;this.ids[S]>=u?g=S:f=S+1}const b=[];for(;this.ids[f]===u;)b.push({index:this.positions[3*f],start:this.positions[3*f+1],end:this.positions[3*f+2]}),f++;return b}static serialize(o,u){const f=new Float64Array(o.ids),g=new Uint32Array(o.positions);return Oo(f,g,0,f.length-1),u&&u.push(f.buffer,g.buffer),{ids:f,positions:g}}static deserialize(o){const u=new sa;return u.ids=o.ids,u.positions=o.positions,u.indexed=!0,u}}function vs(h){const o=+h;return!isNaN(o)&&o<=Number.MAX_SAFE_INTEGER?o:jc(String(h))}function Oo(h,o,u,f){for(;u<f;){const g=h[u+f>>1];let b=u-1,S=f+1;for(;;){do b++;while(h[b]<g);do S--;while(h[S]>g);if(b>=S)break;zo(h,b,S),zo(o,3*b,3*S),zo(o,3*b+1,3*S+1),zo(o,3*b+2,3*S+2)}S-u<f-S?(Oo(h,o,u,S),u=S+1):(Oo(h,o,S+1,f),f=S)}}function zo(h,o,u){const f=h[o];h[o]=h[u],h[u]=f}xt("FeaturePositionMap",sa);class xs{constructor(o,u){this.gl=o.gl,this.location=u}}class _n extends xs{constructor(o,u){super(o,u),this.current=0}set(o){this.current!==o&&(this.current=o,this.gl.uniform1f(this.location,o))}}class Zn extends xs{constructor(o,u){super(o,u),this.current=[0,0,0,0]}set(o){o[0]===this.current[0]&&o[1]===this.current[1]&&o[2]===this.current[2]&&o[3]===this.current[3]||(this.current=o,this.gl.uniform4f(this.location,o[0],o[1],o[2],o[3]))}}class bs extends xs{constructor(o,u){super(o,u),this.current=ar.transparent}set(o){o.r===this.current.r&&o.g===this.current.g&&o.b===this.current.b&&o.a===this.current.a||(this.current=o,this.gl.uniform4f(this.location,o.r,o.g,o.b,o.a))}}const oi=new Float32Array(16);function gg(h){return[Xr(255*h.r,255*h.g),Xr(255*h.b,255*h.a)]}class bh{constructor(o,u,f){this.value=o,this.uniformNames=u.map(g=>`u_${g}`),this.type=f}setUniform(o,u,f){o.set(f.constantOr(this.value))}getBinding(o,u,f){return this.type==="color"?new bs(o,u):new _n(o,u)}}class Nl{constructor(o,u){this.uniformNames=u.map(f=>`u_${f}`),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1}setConstantPatternPositions(o,u){this.pixelRatioFrom=u.pixelRatio,this.pixelRatioTo=o.pixelRatio,this.patternFrom=u.tlbr,this.patternTo=o.tlbr}setConstantDashPositions(o,u){this.dashTo=[0,o.y,o.height,o.width],this.dashFrom=[0,u.y,u.height,u.width]}setUniform(o,u,f,g){let b=null;g==="u_pattern_to"?b=this.patternTo:g==="u_pattern_from"?b=this.patternFrom:g==="u_dasharray_to"?b=this.dashTo:g==="u_dasharray_from"?b=this.dashFrom:g==="u_pixel_ratio_to"?b=this.pixelRatioTo:g==="u_pixel_ratio_from"&&(b=this.pixelRatioFrom),b!==null&&o.set(b)}getBinding(o,u,f){return f.substr(0,9)==="u_pattern"||f.substr(0,12)==="u_dasharray_"?new Zn(o,u):new _n(o,u)}}class oa{constructor(o,u,f,g){this.expression=o,this.type=f,this.maxValue=0,this.paintVertexAttributes=u.map(b=>({name:`a_${b}`,type:"Float32",components:f==="color"?2:1,offset:0})),this.paintVertexArray=new g}populatePaintArray(o,u,f){const g=this.paintVertexArray.length,b=this.expression.evaluate(new $r(0,f),u,{},f.canonical,[],f.formattedSection);this.paintVertexArray.resize(o),this._setPaintValue(g,o,b)}updatePaintArray(o,u,f,g,b){const S=this.expression.evaluate(new $r(0,b),f,g);this._setPaintValue(o,u,S)}_setPaintValue(o,u,f){if(this.type==="color"){const g=gg(f);for(let b=o;b<u;b++)this.paintVertexArray.emplace(b,g[0],g[1])}else{for(let g=o;g<u;g++)this.paintVertexArray.emplace(g,f);this.maxValue=Math.max(this.maxValue,Math.abs(f))}}upload(o){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=o.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class co{constructor(o,u,f,g,b,S){this.expression=o,this.uniformNames=u.map(C=>`u_${C}_t`),this.type=f,this.useIntegerZoom=g,this.zoom=b,this.maxValue=0,this.paintVertexAttributes=u.map(C=>({name:`a_${C}`,type:"Float32",components:f==="color"?4:2,offset:0})),this.paintVertexArray=new S}populatePaintArray(o,u,f){const g=this.expression.evaluate(new $r(this.zoom,f),u,{},f.canonical,[],f.formattedSection),b=this.expression.evaluate(new $r(this.zoom+1,f),u,{},f.canonical,[],f.formattedSection),S=this.paintVertexArray.length;this.paintVertexArray.resize(o),this._setPaintValue(S,o,g,b)}updatePaintArray(o,u,f,g,b){const S=this.expression.evaluate(new $r(this.zoom,b),f,g),C=this.expression.evaluate(new $r(this.zoom+1,b),f,g);this._setPaintValue(o,u,S,C)}_setPaintValue(o,u,f,g){if(this.type==="color"){const b=gg(f),S=gg(g);for(let C=o;C<u;C++)this.paintVertexArray.emplace(C,b[0],b[1],S[0],S[1])}else{for(let b=o;b<u;b++)this.paintVertexArray.emplace(b,f,g);this.maxValue=Math.max(this.maxValue,Math.abs(f),Math.abs(g))}}upload(o){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=o.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(o,u){const f=this.useIntegerZoom?Math.floor(u.zoom):u.zoom,g=Ct(this.expression.interpolationFactor(f,this.zoom,this.zoom+1),0,1);o.set(g)}getBinding(o,u,f){return new _n(o,u)}}class Ua{constructor(o,u,f,g,b,S){this.expression=o,this.type=u,this.useIntegerZoom=f,this.zoom=g,this.layerId=S,this.zoomInPaintVertexArray=new b,this.zoomOutPaintVertexArray=new b}populatePaintArray(o,u,f){const g=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(o),this.zoomOutPaintVertexArray.resize(o),this._setPaintValues(g,o,this.getPositionIds(u),f)}updatePaintArray(o,u,f,g,b){this._setPaintValues(o,u,this.getPositionIds(f),b)}_setPaintValues(o,u,f,g){const b=this.getPositions(g);if(!b||!f)return;const S=b[f.min],C=b[f.mid],k=b[f.max];if(S&&C&&k)for(let N=o;N<u;N++)this.emplace(this.zoomInPaintVertexArray,N,C,S),this.emplace(this.zoomOutPaintVertexArray,N,C,k)}upload(o){if(this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer){const u=this.getVertexAttributes();this.zoomInPaintVertexBuffer=o.createVertexBuffer(this.zoomInPaintVertexArray,u,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=o.createVertexBuffer(this.zoomOutPaintVertexArray,u,this.expression.isStateDependent)}}destroy(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()}}class Ga extends Ua{getPositions(o){return o.imagePositions}getPositionIds(o){return o.patterns&&o.patterns[this.layerId]}getVertexAttributes(){return Ti.members}emplace(o,u,f,g){o.emplace(u,f.tlbr[0],f.tlbr[1],f.tlbr[2],f.tlbr[3],g.tlbr[0],g.tlbr[1],g.tlbr[2],g.tlbr[3],f.pixelRatio,g.pixelRatio)}}class yg extends Ua{getPositions(o){return o.dashPositions}getPositionIds(o){return o.dashes&&o.dashes[this.layerId]}getVertexAttributes(){return Cn.members}emplace(o,u,f,g){o.emplace(u,0,f.y,f.height,f.width,0,g.y,g.height,g.width)}}class _g{constructor(o,u,f){this.binders={},this._buffers=[];const g=[];for(const b in o.paint._values){if(!f(b))continue;const S=o.paint.get(b);if(!(S instanceof Lo&&Cc(S.property.specification)))continue;const C=vg(b,o.type),k=S.value,N=S.property.specification.type,F=S.property.useIntegerZoom,G=S.property.specification["property-type"],Y=G==="cross-faded"||G==="cross-faded-data-driven";if(k.kind==="constant")this.binders[b]=Y?new Nl(k.value,C):new bh(k.value,C,N),g.push(`/u_${b}`);else if(k.kind==="source"||Y){const J=xg(b,N,"source");this.binders[b]=Y?b==="line-dasharray"?new yg(k,N,F,u,J,o.id):new Ga(k,N,F,u,J,o.id):new oa(k,C,N,J),g.push(`/a_${b}`)}else{const J=xg(b,N,"composite");this.binders[b]=new co(k,C,N,F,u,J),g.push(`/z_${b}`)}}this.cacheKey=g.sort().join("")}getMaxValue(o){const u=this.binders[o];return u instanceof oa||u instanceof co?u.maxValue:0}populatePaintArrays(o,u,f){for(const g in this.binders){const b=this.binders[g];(b instanceof oa||b instanceof co||b instanceof Ua)&&b.populatePaintArray(o,u,f)}}setConstantPatternPositions(o,u){for(const f in this.binders){const g=this.binders[f];g instanceof Nl&&g.setConstantPatternPositions(o,u)}}setConstantDashPositions(o,u){for(const f in this.binders){const g=this.binders[f];g instanceof Nl&&g.setConstantDashPositions(o,u)}}updatePaintArrays(o,u,f,g,b){let S=!1;for(const C in o){const k=u.getPositions(C);for(const N of k){const F=f.feature(N.index);for(const G in this.binders){const Y=this.binders[G];if((Y instanceof oa||Y instanceof co||Y instanceof Ua)&&Y.expression.isStateDependent===!0){const J=g.paint.get(G);Y.expression=J.value,Y.updatePaintArray(N.start,N.end,F,o[C],b),S=!0}}}}return S}defines(){const o=[];for(const u in this.binders){const f=this.binders[u];(f instanceof bh||f instanceof Nl)&&o.push(...f.uniformNames.map(g=>`#define HAS_UNIFORM_${g}`))}return o}getBinderAttributes(){const o=[];for(const u in this.binders){const f=this.binders[u];if(f instanceof oa||f instanceof co)for(let g=0;g<f.paintVertexAttributes.length;g++)o.push(f.paintVertexAttributes[g].name);else if(f instanceof Ua){const g=f.getVertexAttributes();for(const b of g)o.push(b.name)}}return o}getBinderUniforms(){const o=[];for(const u in this.binders){const f=this.binders[u];if(f instanceof bh||f instanceof Nl||f instanceof co)for(const g of f.uniformNames)o.push(g)}return o}getPaintVertexBuffers(){return this._buffers}getUniforms(o,u){const f=[];for(const g in this.binders){const b=this.binders[g];if(b instanceof bh||b instanceof Nl||b instanceof co){for(const S of b.uniformNames)if(u[S]){const C=b.getBinding(o,u[S],S);f.push({name:S,property:g,binding:C})}}}return f}setUniforms(o,u,f,g){for(const{name:b,property:S,binding:C}of u)this.binders[S].setUniform(C,g,f.get(S),b)}updatePaintBuffers(o){this._buffers=[];for(const u in this.binders){const f=this.binders[u];if(o&&f instanceof Ua){const g=o.fromScale===2?f.zoomInPaintVertexBuffer:f.zoomOutPaintVertexBuffer;g&&this._buffers.push(g)}else(f instanceof oa||f instanceof co)&&f.paintVertexBuffer&&this._buffers.push(f.paintVertexBuffer)}}upload(o){for(const u in this.binders){const f=this.binders[u];(f instanceof oa||f instanceof co||f instanceof Ua)&&f.upload(o)}this.updatePaintBuffers()}destroy(){for(const o in this.binders){const u=this.binders[o];(u instanceof oa||u instanceof co||u instanceof Ua)&&u.destroy()}}}class Wa{constructor(o,u,f=()=>!0){this.programConfigurations={};for(const g of o)this.programConfigurations[g.id]=new _g(g,u,f);this.needsUpload=!1,this._featureMap=new sa,this._bufferOffset=0}populatePaintArrays(o,u,f,g){for(const b in this.programConfigurations)this.programConfigurations[b].populatePaintArrays(o,u,g);u.id!==void 0&&this._featureMap.add(u.id,f,this._bufferOffset,o),this._bufferOffset=o,this.needsUpload=!0}updatePaintArrays(o,u,f,g){for(const b of f)this.needsUpload=this.programConfigurations[b.id].updatePaintArrays(o,this._featureMap,u,b,g)||this.needsUpload}get(o){return this.programConfigurations[o]}upload(o){if(this.needsUpload){for(const u in this.programConfigurations)this.programConfigurations[u].upload(o);this.needsUpload=!1}}destroy(){for(const o in this.programConfigurations)this.programConfigurations[o].destroy()}}function vg(h,o){return{"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-dasharray":["dasharray_to","dasharray_from"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"]}[h]||[h.replace(`${o}-`,"").replace(/-/g,"_")]}function xg(h,o,u){const f={color:{source:Ba,composite:$},number:{source:_,composite:Ba}},g=function(b){return{"line-pattern":{source:We,composite:We},"fill-pattern":{source:We,composite:We},"fill-extrusion-pattern":{source:We,composite:We},"line-dasharray":{source:ct,composite:ct}}[b]}(h);return g&&g[u]||f[o][u]}xt("ConstantBinder",bh),xt("CrossFadedConstantBinder",Nl),xt("SourceExpressionBinder",oa),xt("CrossFadedPatternBinder",Ga),xt("CrossFadedDasharrayBinder",yg),xt("CompositeExpressionBinder",co),xt("ProgramConfiguration",_g,{omit:["_buffers"]}),xt("ProgramConfigurationSet",Wa);const wh=Math.pow(2,14)-1,kA=-wh-1;function Sh(h){const o=ve/h.extent,u=h.loadGeometry();for(let f=0;f<u.length;f++){const g=u[f];for(let b=0;b<g.length;b++){const S=g[b],C=Math.round(S.x*o),k=Math.round(S.y*o);S.x=Ct(C,kA,wh),S.y=Ct(k,kA,wh),(C<S.x||C>S.x+1||k<S.y||k>S.y+1)&&Rt("Geometry exceeds allowed extent, reduce your vector tile buffer size")}}return u}function Th(h,o){return{type:h.type,id:h.id,properties:h.properties,geometry:o?Sh(h):[]}}const MA=-32768;function K6(h,o,u,f,g){h.emplaceBack(MA+8*o+f,MA+8*u+g)}class aw{constructor(o){this.zoom=o.zoom,this.overscaling=o.overscaling,this.layers=o.layers,this.layerIds=this.layers.map(u=>u.id),this.index=o.index,this.hasDependencies=!1,this.layoutVertexArray=new Pe,this.indexArray=new Ir,this.segments=new gr,this.programConfigurations=new Wa(o.layers,o.zoom),this.stateDependentLayerIds=this.layers.filter(u=>u.isStateDependent()).map(u=>u.id)}populate(o,u,f){const g=this.layers[0],b=[];let S=null,C=!1,k=g.type==="heatmap";if(g.type==="circle"){const F=g;S=F.layout.get("circle-sort-key"),C=!S.isConstant(),k=k||F.paint.get("circle-pitch-alignment")==="map"}const N=k?u.subdivisionGranularity.circle:1;for(const{feature:F,id:G,index:Y,sourceLayerIndex:J}of o){const re=this.layers[0]._featureFilter.needGeometry,le=Th(F,re);if(!this.layers[0]._featureFilter.filter(new $r(this.zoom),le,f))continue;const pe=C?S.evaluate(le,{},f):void 0,be={id:G,properties:F.properties,type:F.type,sourceLayerIndex:J,index:Y,geometry:re?le.geometry:Sh(F),patterns:{},sortKey:pe};b.push(be)}C&&b.sort((F,G)=>F.sortKey-G.sortKey);for(const F of b){const{geometry:G,index:Y,sourceLayerIndex:J}=F,re=o[Y].feature;this.addFeature(F,G,Y,f,N),u.featureIndex.insert(re,G,Y,J,this.index)}}update(o,u,f){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(o,u,this.stateDependentLayers,{imagePositions:f})}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(o){this.uploaded||(this.layoutVertexBuffer=o.createVertexBuffer(this.layoutVertexArray,Ur),this.indexBuffer=o.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(o),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(o,u,f,g,b=1){let S;switch(b){case 1:S=[0,7];break;case 3:S=[0,2,5,7];break;case 5:S=[0,1,3,4,6,7];break;case 7:S=[0,1,2,3,4,5,6,7];break;default:throw new Error(`Invalid circle bucket granularity: ${b}; valid values are 1, 3, 5, 7.`)}const C=S.length;for(const k of u)for(const N of k){const F=N.x,G=N.y;if(F<0||F>=ve||G<0||G>=ve)continue;const Y=this.segments.prepareSegment(C*C,this.layoutVertexArray,this.indexArray,o.sortKey),J=Y.vertexLength;for(let re=0;re<C;re++)for(let le=0;le<C;le++)K6(this.layoutVertexArray,F,G,S[le],S[re]);for(let re=0;re<C-1;re++)for(let le=0;le<C-1;le++){const pe=J+re*C+le,be=J+(re+1)*C+le;this.indexArray.emplaceBack(pe,be+1,pe+1),this.indexArray.emplaceBack(pe,be,be+1)}Y.vertexLength+=C*C,Y.primitiveLength+=(C-1)*(C-1)*2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,o,f,{imagePositions:{},canonical:g})}}function IA(h,o){for(let u=0;u<h.length;u++)if(Ef(o,h[u]))return!0;for(let u=0;u<o.length;u++)if(Ef(h,o[u]))return!0;return!!lw(h,o)}function Q_(h,o,u){return!!Ef(h,o)||!!cw(o,h,u)}function RA(h,o){if(h.length===1)return LA(o,h[0]);for(let u=0;u<o.length;u++){const f=o[u];for(let g=0;g<f.length;g++)if(Ef(h,f[g]))return!0}for(let u=0;u<h.length;u++)if(LA(o,h[u]))return!0;for(let u=0;u<o.length;u++)if(lw(h,o[u]))return!0;return!1}function X6(h,o,u){if(h.length>1){if(lw(h,o))return!0;for(let f=0;f<o.length;f++)if(cw(o[f],h,u))return!0}for(let f=0;f<h.length;f++)if(cw(h[f],o,u))return!0;return!1}function lw(h,o){if(h.length===0||o.length===0)return!1;for(let u=0;u<h.length-1;u++){const f=h[u],g=h[u+1];for(let b=0;b<o.length-1;b++)if(Y6(f,g,o[b],o[b+1]))return!0}return!1}function Y6(h,o,u,f){return Ft(h,u,f)!==Ft(o,u,f)&&Ft(h,o,u)!==Ft(h,o,f)}function cw(h,o,u){const f=u*u;if(o.length===1)return h.distSqr(o[0])<f;for(let g=1;g<o.length;g++)if(DA(h,o[g-1],o[g])<f)return!0;return!1}function DA(h,o,u){const f=o.distSqr(u);if(f===0)return h.distSqr(o);const g=((h.x-o.x)*(u.x-o.x)+(h.y-o.y)*(u.y-o.y))/f;return h.distSqr(g<0?o:g>1?u:u.sub(o)._mult(g)._add(o))}function LA(h,o){let u,f,g,b=!1;for(let S=0;S<h.length;S++){u=h[S];for(let C=0,k=u.length-1;C<u.length;k=C++)f=u[C],g=u[k],f.y>o.y!=g.y>o.y&&o.x<(g.x-f.x)*(o.y-f.y)/(g.y-f.y)+f.x&&(b=!b)}return b}function Ef(h,o){let u=!1;for(let f=0,g=h.length-1;f<h.length;g=f++){const b=h[f],S=h[g];b.y>o.y!=S.y>o.y&&o.x<(S.x-b.x)*(o.y-b.y)/(S.y-b.y)+b.x&&(u=!u)}return u}function Q6(h,o,u){const f=u[0],g=u[2];if(h.x<f.x&&o.x<f.x||h.x>g.x&&o.x>g.x||h.y<f.y&&o.y<f.y||h.y>g.y&&o.y>g.y)return!1;const b=Ft(h,o,u[0]);return b!==Ft(h,o,u[1])||b!==Ft(h,o,u[2])||b!==Ft(h,o,u[3])}function Cf(h,o,u){const f=o.paint.get(h).value;return f.kind==="constant"?f.value:u.programConfigurations.get(o.id).getMaxValue(h)}function J_(h){return Math.sqrt(h[0]*h[0]+h[1]*h[1])}function ev(h,o,u,f,g){if(!o[0]&&!o[1])return h;const b=m.convert(o)._mult(g);u==="viewport"&&b._rotate(-f);const S=[];for(let C=0;C<h.length;C++)S.push(h[C].sub(b));return S}function J6({queryGeometry:h,size:o},u){return Q_(h,u,o)}function e$({queryGeometry:h,size:o,transform:u,unwrappedTileID:f,getElevation:g},b){return Q_(h,b,o*(u.projectTileCoordinates(b.x,b.y,f,g).signedDistanceFromCamera/u.cameraToCenterDistance))}function t$({queryGeometry:h,size:o,transform:u,unwrappedTileID:f,getElevation:g},b){const S=u.projectTileCoordinates(b.x,b.y,f,g).signedDistanceFromCamera,C=o*(u.cameraToCenterDistance/S);return Q_(h,uw(b,u,f,g),C)}function r$({queryGeometry:h,size:o,transform:u,unwrappedTileID:f,getElevation:g},b){return Q_(h,uw(b,u,f,g),o)}function OA({queryGeometry:h,size:o,transform:u,unwrappedTileID:f,getElevation:g,pitchAlignment:b="map",pitchScale:S="map"},C){const k=b==="map"?S==="map"?J6:e$:S==="map"?t$:r$,N={queryGeometry:h,size:o,transform:u,unwrappedTileID:f,getElevation:g};for(const F of C)for(const G of F)if(k(N,G))return!0;return!1}function uw(h,o,u,f){const g=o.projectTileCoordinates(h.x,h.y,u,f).point;return new m((.5*g.x+.5)*o.width,(.5*-g.y+.5)*o.height)}let zA,NA;xt("CircleBucket",aw,{omit:["layers"]});var n$={get paint(){return NA=NA||new Hi({"circle-radius":new Bt(je.paint_circle["circle-radius"]),"circle-color":new Bt(je.paint_circle["circle-color"]),"circle-blur":new Bt(je.paint_circle["circle-blur"]),"circle-opacity":new Bt(je.paint_circle["circle-opacity"]),"circle-translate":new kt(je.paint_circle["circle-translate"]),"circle-translate-anchor":new kt(je.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new kt(je.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new kt(je.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new Bt(je.paint_circle["circle-stroke-width"]),"circle-stroke-color":new Bt(je.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new Bt(je.paint_circle["circle-stroke-opacity"])})},get layout(){return zA=zA||new Hi({"circle-sort-key":new Bt(je.layout_circle["circle-sort-key"])})}};class i$ extends ao{constructor(o,u){super(o,n$,u)}createBucket(o){return new aw(o)}queryRadius(o){const u=o;return Cf("circle-radius",this,u)+Cf("circle-stroke-width",this,u)+J_(this.paint.get("circle-translate"))}queryIntersectsFeature({queryGeometry:o,feature:u,featureState:f,geometry:g,transform:b,pixelsToTileUnits:S,unwrappedTileID:C,getElevation:k}){const N=ev(o,this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),-b.bearingInRadians,S),F=this.paint.get("circle-radius").evaluate(u,f)+this.paint.get("circle-stroke-width").evaluate(u,f),G=this.paint.get("circle-pitch-scale"),Y=this.paint.get("circle-pitch-alignment");let J,re;return Y==="map"?(J=N,re=F*S):(J=function(le,pe,be,Fe){return le.map(ke=>uw(ke,pe,be,Fe))}(N,b,C,k),re=F),OA({queryGeometry:J,size:re,transform:b,unwrappedTileID:C,getElevation:k,pitchAlignment:Y,pitchScale:G},g)}}class jA extends aw{}let FA;xt("HeatmapBucket",jA,{omit:["layers"]});var s$={get paint(){return FA=FA||new Hi({"heatmap-radius":new Bt(je.paint_heatmap["heatmap-radius"]),"heatmap-weight":new Bt(je.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new kt(je.paint_heatmap["heatmap-intensity"]),"heatmap-color":new xf(je.paint_heatmap["heatmap-color"]),"heatmap-opacity":new kt(je.paint_heatmap["heatmap-opacity"])})}};function hw(h,{width:o,height:u},f,g){if(g){if(g instanceof Uint8ClampedArray)g=new Uint8Array(g.buffer);else if(g.length!==o*u*f)throw new RangeError(`mismatched image size. expected: ${g.length} but got: ${o*u*f}`)}else g=new Uint8Array(o*u*f);return h.width=o,h.height=u,h.data=g,h}function BA(h,{width:o,height:u},f){if(o===h.width&&u===h.height)return;const g=hw({},{width:o,height:u},f);dw(h,g,{x:0,y:0},{x:0,y:0},{width:Math.min(h.width,o),height:Math.min(h.height,u)},f),h.width=o,h.height=u,h.data=g.data}function dw(h,o,u,f,g,b){if(g.width===0||g.height===0)return o;if(g.width>h.width||g.height>h.height||u.x>h.width-g.width||u.y>h.height-g.height)throw new RangeError("out of range source coordinates for image copy");if(g.width>o.width||g.height>o.height||f.x>o.width-g.width||f.y>o.height-g.height)throw new RangeError("out of range destination coordinates for image copy");const S=h.data,C=o.data;if(S===C)throw new Error("srcData equals dstData, so image is already copied");for(let k=0;k<g.height;k++){const N=((u.y+k)*h.width+u.x)*b,F=((f.y+k)*o.width+f.x)*b;for(let G=0;G<g.width*b;G++)C[F+G]=S[N+G]}return o}class bg{constructor(o,u){hw(this,o,1,u)}resize(o){BA(this,o,1)}clone(){return new bg({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(o,u,f,g,b){dw(o,u,f,g,b,1)}}class ws{constructor(o,u){hw(this,o,4,u)}resize(o){BA(this,o,4)}replace(o,u){u?this.data.set(o):this.data=o instanceof Uint8ClampedArray?new Uint8Array(o.buffer):o}clone(){return new ws({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(o,u,f,g,b){dw(o,u,f,g,b,4)}setPixel(o,u,f){const g=4*(o*this.width+u);this.data[g+0]=Math.round(255*f.r/f.a),this.data[g+1]=Math.round(255*f.g/f.a),this.data[g+2]=Math.round(255*f.b/f.a),this.data[g+3]=Math.round(255*f.a)}}function $A(h){const o={},u=h.resolution||256,f=h.clips?h.clips.length:1,g=h.image||new ws({width:u,height:f});if(Math.log(u)/Math.LN2%1!=0)throw new Error(`width is not a power of 2 - ${u}`);const b=(S,C,k)=>{o[h.evaluationKey]=k;const N=h.expression.evaluate(o);g.setPixel(S/4/u,C/4,N)};if(h.clips)for(let S=0,C=0;S<f;++S,C+=4*u)for(let k=0,N=0;k<u;k++,N+=4){const F=k/(u-1),{start:G,end:Y}=h.clips[S];b(C,N,G*(1-F)+Y*F)}else for(let S=0,C=0;S<u;S++,C+=4)b(0,C,S/(u-1));return g}xt("AlphaImage",bg),xt("RGBAImage",ws);const fw="big-fb";class o$ extends ao{createBucket(o){return new jA(o)}constructor(o,u){super(o,s$,u),this.heatmapFbos=new Map,this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(o){o==="heatmap-color"&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=$A({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbos.has(fw)&&this.heatmapFbos.delete(fw)}queryRadius(o){return Cf("heatmap-radius",this,o)}queryIntersectsFeature({queryGeometry:o,feature:u,featureState:f,geometry:g,transform:b,pixelsToTileUnits:S,unwrappedTileID:C,getElevation:k}){return OA({queryGeometry:o,size:this.paint.get("heatmap-radius").evaluate(u,f)*S,transform:b,unwrappedTileID:C,getElevation:k},g)}hasOffscreenPass(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"}}let VA;var a$={get paint(){return VA=VA||new Hi({"hillshade-illumination-direction":new kt(je.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-altitude":new kt(je.paint_hillshade["hillshade-illumination-altitude"]),"hillshade-illumination-anchor":new kt(je.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new kt(je.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new kt(je.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new kt(je.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new kt(je.paint_hillshade["hillshade-accent-color"]),"hillshade-method":new kt(je.paint_hillshade["hillshade-method"])})}};class l$ extends ao{constructor(o,u){super(o,a$,u),this.recalculate({zoom:0,zoomHistory:{}},void 0)}getIlluminationProperties(){let o=this.paint.get("hillshade-illumination-direction").values,u=this.paint.get("hillshade-illumination-altitude").values,f=this.paint.get("hillshade-highlight-color").values,g=this.paint.get("hillshade-shadow-color").values;const b=Math.max(o.length,u.length,f.length,g.length);o=o.concat(Array(b-o.length).fill(o.at(-1))),u=u.concat(Array(b-u.length).fill(u.at(-1))),f=f.concat(Array(b-f.length).fill(f.at(-1))),g=g.concat(Array(b-g.length).fill(g.at(-1)));const S=u.map(Or);return{directionRadians:o.map(Or),altitudeRadians:S,shadowColor:g,highlightColor:f}}hasOffscreenPass(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"}}let UA;var c$={get paint(){return UA=UA||new Hi({"color-relief-opacity":new kt(je["paint_color-relief"]["color-relief-opacity"]),"color-relief-color":new xf(je["paint_color-relief"]["color-relief-color"])})}};class pw{constructor(o,u,f,g){this.context=o,this.format=f,this.texture=o.gl.createTexture(),this.update(u,g)}update(o,u,f){const{width:g,height:b}=o,S=!(this.size&&this.size[0]===g&&this.size[1]===b||f),{context:C}=this,{gl:k}=C;if(this.useMipmap=!!(u&&u.useMipmap),k.bindTexture(k.TEXTURE_2D,this.texture),C.pixelStoreUnpackFlipY.set(!1),C.pixelStoreUnpack.set(1),C.pixelStoreUnpackPremultiplyAlpha.set(this.format===k.RGBA&&(!u||u.premultiply!==!1)),S)this.size=[g,b],o instanceof HTMLImageElement||o instanceof HTMLCanvasElement||o instanceof HTMLVideoElement||o instanceof ImageData||Ar(o)?k.texImage2D(k.TEXTURE_2D,0,this.format,this.format,k.UNSIGNED_BYTE,o):k.texImage2D(k.TEXTURE_2D,0,this.format,g,b,0,this.format,k.UNSIGNED_BYTE,o.data);else{const{x:N,y:F}=f||{x:0,y:0};o instanceof HTMLImageElement||o instanceof HTMLCanvasElement||o instanceof HTMLVideoElement||o instanceof ImageData||Ar(o)?k.texSubImage2D(k.TEXTURE_2D,0,N,F,k.RGBA,k.UNSIGNED_BYTE,o):k.texSubImage2D(k.TEXTURE_2D,0,N,F,g,b,k.RGBA,k.UNSIGNED_BYTE,o.data)}this.useMipmap&&this.isSizePowerOfTwo()&&k.generateMipmap(k.TEXTURE_2D),C.pixelStoreUnpackFlipY.setDefault(),C.pixelStoreUnpack.setDefault(),C.pixelStoreUnpackPremultiplyAlpha.setDefault()}bind(o,u,f){const{context:g}=this,{gl:b}=g;b.bindTexture(b.TEXTURE_2D,this.texture),f!==b.LINEAR_MIPMAP_NEAREST||this.isSizePowerOfTwo()||(f=b.LINEAR),o!==this.filter&&(b.texParameteri(b.TEXTURE_2D,b.TEXTURE_MAG_FILTER,o),b.texParameteri(b.TEXTURE_2D,b.TEXTURE_MIN_FILTER,f||o),this.filter=o),u!==this.wrap&&(b.texParameteri(b.TEXTURE_2D,b.TEXTURE_WRAP_S,u),b.texParameteri(b.TEXTURE_2D,b.TEXTURE_WRAP_T,u),this.wrap=u)}isSizePowerOfTwo(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0}destroy(){const{gl:o}=this.context;o.deleteTexture(this.texture),this.texture=null}}class GA{constructor(o,u,f,g=1,b=1,S=1,C=0){if(this.uid=o,u.height!==u.width)throw new RangeError("DEM tiles must be square");if(f&&!["mapbox","terrarium","custom"].includes(f))return void Rt(`"${f}" is not a valid encoding type. Valid types include "mapbox", "terrarium" and "custom".`);this.stride=u.height;const k=this.dim=u.height-2;switch(this.data=new Uint32Array(u.data.buffer),f){case"terrarium":this.redFactor=256,this.greenFactor=1,this.blueFactor=1/256,this.baseShift=32768;break;case"custom":this.redFactor=g,this.greenFactor=b,this.blueFactor=S,this.baseShift=C;break;default:this.redFactor=6553.6,this.greenFactor=25.6,this.blueFactor=.1,this.baseShift=1e4}for(let N=0;N<k;N++)this.data[this._idx(-1,N)]=this.data[this._idx(0,N)],this.data[this._idx(k,N)]=this.data[this._idx(k-1,N)],this.data[this._idx(N,-1)]=this.data[this._idx(N,0)],this.data[this._idx(N,k)]=this.data[this._idx(N,k-1)];this.data[this._idx(-1,-1)]=this.data[this._idx(0,0)],this.data[this._idx(k,-1)]=this.data[this._idx(k-1,0)],this.data[this._idx(-1,k)]=this.data[this._idx(0,k-1)],this.data[this._idx(k,k)]=this.data[this._idx(k-1,k-1)],this.min=Number.MAX_SAFE_INTEGER,this.max=Number.MIN_SAFE_INTEGER;for(let N=0;N<k;N++)for(let F=0;F<k;F++){const G=this.get(N,F);G>this.max&&(this.max=G),G<this.min&&(this.min=G)}}get(o,u){const f=new Uint8Array(this.data.buffer),g=4*this._idx(o,u);return this.unpack(f[g],f[g+1],f[g+2])}getUnpackVector(){return[this.redFactor,this.greenFactor,this.blueFactor,this.baseShift]}_idx(o,u){if(o<-1||o>=this.dim+1||u<-1||u>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(u+1)*this.stride+(o+1)}unpack(o,u,f){return o*this.redFactor+u*this.greenFactor+f*this.blueFactor-this.baseShift}pack(o){return WA(o,this.getUnpackVector())}getPixels(){return new ws({width:this.stride,height:this.stride},new Uint8Array(this.data.buffer))}backfillBorder(o,u,f){if(this.dim!==o.dim)throw new Error("dem dimension mismatch");let g=u*this.dim,b=u*this.dim+this.dim,S=f*this.dim,C=f*this.dim+this.dim;switch(u){case-1:g=b-1;break;case 1:b=g+1}switch(f){case-1:S=C-1;break;case 1:C=S+1}const k=-u*this.dim,N=-f*this.dim;for(let F=S;F<C;F++)for(let G=g;G<b;G++)this.data[this._idx(G,F)]=o.data[this._idx(G+k,F+N)]}}function WA(h,o){const u=o[0],f=o[1],g=o[2],b=o[3],S=Math.min(u,f,g),C=Math.round((h+b)/S);return{r:Math.floor(C*S/u)%256,g:Math.floor(C*S/f)%256,b:Math.floor(C*S/g)%256}}xt("DEMData",GA);class u$ extends ao{constructor(o,u){super(o,c$,u)}_createColorRamp(o){const u={elevationStops:[],colorStops:[]},f=this._transitionablePaint._values["color-relief-color"].value.expression;if(f instanceof nf&&f._styleExpression.expression instanceof Hn){this.colorRampExpression=f;const S=f._styleExpression.expression;u.elevationStops=S.labels,u.colorStops=[];for(const C of u.elevationStops)u.colorStops.push(S.evaluate({globals:{elevation:C}}))}if(u.elevationStops.length<1&&(u.elevationStops=[0],u.colorStops=[ar.transparent]),u.elevationStops.length<2&&(u.elevationStops.push(u.elevationStops[0]+1),u.colorStops.push(u.colorStops[0])),u.elevationStops.length<=o)return u;const g={elevationStops:[],colorStops:[]},b=(u.elevationStops.length-1)/(o-1);for(let S=0;S<u.elevationStops.length-.5;S+=b)g.elevationStops.push(u.elevationStops[Math.round(S)]),g.colorStops.push(u.colorStops[Math.round(S)]);return Rt(`Too many colors in specification of ${this.id} color-relief layer, may not render properly.`),g}_colorRampChanged(){return this.colorRampExpression!=this._transitionablePaint._values["color-relief-color"].value.expression}getColorRampTextures(o,u,f){if(this.colorRampTextures&&!this._colorRampChanged())return this.colorRampTextures;const g=this._createColorRamp(u),b=new ws({width:g.colorStops.length,height:1}),S=new ws({width:g.colorStops.length,height:1});for(let C=0;C<g.elevationStops.length;C++){const k=WA(g.elevationStops[C],f);S.setPixel(0,C,new ar(k.r/255,k.g/255,k.b/255,1)),b.setPixel(0,C,g.colorStops[C])}return this.colorRampTextures={elevationTexture:new pw(o,S,o.gl.RGBA),colorTexture:new pw(o,b,o.gl.RGBA)},this.colorRampTextures}hasOffscreenPass(){return this.visibility!=="none"&&!!this.colorRampTextures}}const h$=yn([{name:"a_pos",components:2,type:"Int16"}],4),{members:d$}=h$;function tv(h,o,u){const f=u.patternDependencies;let g=!1;for(const b of o){const S=b.paint.get(`${h}-pattern`);S.isConstant()||(g=!0);const C=S.constantOr(null);C&&(g=!0,f[C.to]=!0,f[C.from]=!0)}return g}function mw(h,o,u,f,g){const{zoom:b}=f,S=g.patternDependencies;for(const C of o){const k=C.paint.get(`${h}-pattern`).value;if(k.kind!=="constant"){let N=k.evaluate({zoom:b-1},u,{},g.availableImages),F=k.evaluate({zoom:b},u,{},g.availableImages),G=k.evaluate({zoom:b+1},u,{},g.availableImages);N=N&&N.name?N.name:N,F=F&&F.name?F.name:F,G=G&&G.name?G.name:G,S[N]=!0,S[F]=!0,S[G]=!0,u.patterns[C.id]={min:N,mid:F,max:G}}}return u}function qA(h,o,u,f,g){let b;if(g===function(S,C,k,N){let F=0;for(let G=C,Y=k-N;G<k;G+=N)F+=(S[Y]-S[G])*(S[G+1]+S[Y+1]),Y=G;return F}(h,o,u,f)>0)for(let S=o;S<u;S+=f)b=XA(S/f|0,h[S],h[S+1],b);else for(let S=u-f;S>=o;S-=f)b=XA(S/f|0,h[S],h[S+1],b);return b&&Pf(b,b.next)&&(Eg(b),b=b.next),b}function Eh(h,o){if(!h)return h;o||(o=h);let u,f=h;do if(u=!1,f.steiner||!Pf(f,f.next)&&An(f.prev,f,f.next)!==0)f=f.next;else{if(Eg(f),f=o=f.prev,f===f.next)break;u=!0}while(u||f!==o);return o}function wg(h,o,u,f,g,b,S){if(!h)return;!S&&b&&function(k,N,F,G){let Y=k;do Y.z===0&&(Y.z=gw(Y.x,Y.y,N,F,G)),Y.prevZ=Y.prev,Y.nextZ=Y.next,Y=Y.next;while(Y!==k);Y.prevZ.nextZ=null,Y.prevZ=null,function(J){let re,le=1;do{let pe,be=J;J=null;let Fe=null;for(re=0;be;){re++;let ke=be,De=0;for(let Ke=0;Ke<le&&(De++,ke=ke.nextZ,ke);Ke++);let Ue=le;for(;De>0||Ue>0&&ke;)De!==0&&(Ue===0||!ke||be.z<=ke.z)?(pe=be,be=be.nextZ,De--):(pe=ke,ke=ke.nextZ,Ue--),Fe?Fe.nextZ=pe:J=pe,pe.prevZ=Fe,Fe=pe;be=ke}Fe.nextZ=null,le*=2}while(re>1)}(Y)}(h,f,g,b);let C=h;for(;h.prev!==h.next;){const k=h.prev,N=h.next;if(b?p$(h,f,g,b):f$(h))o.push(k.i,h.i,N.i),Eg(h),h=N.next,C=N.next;else if((h=N)===C){S?S===1?wg(h=m$(Eh(h),o),o,u,f,g,b,2):S===2&&g$(h,o,u,f,g,b):wg(Eh(h),o,u,f,g,b,1);break}}}function f$(h){const o=h.prev,u=h,f=h.next;if(An(o,u,f)>=0)return!1;const g=o.x,b=u.x,S=f.x,C=o.y,k=u.y,N=f.y,F=Math.min(g,b,S),G=Math.min(C,k,N),Y=Math.max(g,b,S),J=Math.max(C,k,N);let re=f.next;for(;re!==o;){if(re.x>=F&&re.x<=Y&&re.y>=G&&re.y<=J&&Sg(g,C,b,k,S,N,re.x,re.y)&&An(re.prev,re,re.next)>=0)return!1;re=re.next}return!0}function p$(h,o,u,f){const g=h.prev,b=h,S=h.next;if(An(g,b,S)>=0)return!1;const C=g.x,k=b.x,N=S.x,F=g.y,G=b.y,Y=S.y,J=Math.min(C,k,N),re=Math.min(F,G,Y),le=Math.max(C,k,N),pe=Math.max(F,G,Y),be=gw(J,re,o,u,f),Fe=gw(le,pe,o,u,f);let ke=h.prevZ,De=h.nextZ;for(;ke&&ke.z>=be&&De&&De.z<=Fe;){if(ke.x>=J&&ke.x<=le&&ke.y>=re&&ke.y<=pe&&ke!==g&&ke!==S&&Sg(C,F,k,G,N,Y,ke.x,ke.y)&&An(ke.prev,ke,ke.next)>=0||(ke=ke.prevZ,De.x>=J&&De.x<=le&&De.y>=re&&De.y<=pe&&De!==g&&De!==S&&Sg(C,F,k,G,N,Y,De.x,De.y)&&An(De.prev,De,De.next)>=0))return!1;De=De.nextZ}for(;ke&&ke.z>=be;){if(ke.x>=J&&ke.x<=le&&ke.y>=re&&ke.y<=pe&&ke!==g&&ke!==S&&Sg(C,F,k,G,N,Y,ke.x,ke.y)&&An(ke.prev,ke,ke.next)>=0)return!1;ke=ke.prevZ}for(;De&&De.z<=Fe;){if(De.x>=J&&De.x<=le&&De.y>=re&&De.y<=pe&&De!==g&&De!==S&&Sg(C,F,k,G,N,Y,De.x,De.y)&&An(De.prev,De,De.next)>=0)return!1;De=De.nextZ}return!0}function m$(h,o){let u=h;do{const f=u.prev,g=u.next.next;!Pf(f,g)&&ZA(f,u,u.next,g)&&Tg(f,g)&&Tg(g,f)&&(o.push(f.i,u.i,g.i),Eg(u),Eg(u.next),u=h=g),u=u.next}while(u!==h);return Eh(u)}function g$(h,o,u,f,g,b){let S=h;do{let C=S.next.next;for(;C!==S.prev;){if(S.i!==C.i&&b$(S,C)){let k=KA(S,C);return S=Eh(S,S.next),k=Eh(k,k.next),wg(S,o,u,f,g,b,0),void wg(k,o,u,f,g,b,0)}C=C.next}S=S.next}while(S!==h)}function y$(h,o){let u=h.x-o.x;return u===0&&(u=h.y-o.y,u===0)&&(u=(h.next.y-h.y)/(h.next.x-h.x)-(o.next.y-o.y)/(o.next.x-o.x)),u}function _$(h,o){const u=function(g,b){let S=b;const C=g.x,k=g.y;let N,F=-1/0;if(Pf(g,S))return S;do{if(Pf(g,S.next))return S.next;if(k<=S.y&&k>=S.next.y&&S.next.y!==S.y){const le=S.x+(k-S.y)*(S.next.x-S.x)/(S.next.y-S.y);if(le<=C&&le>F&&(F=le,N=S.x<S.next.x?S:S.next,le===C))return N}S=S.next}while(S!==b);if(!N)return null;const G=N,Y=N.x,J=N.y;let re=1/0;S=N;do{if(C>=S.x&&S.x>=Y&&C!==S.x&&HA(k<J?C:F,k,Y,J,k<J?F:C,k,S.x,S.y)){const le=Math.abs(k-S.y)/(C-S.x);Tg(S,g)&&(le<re||le===re&&(S.x>N.x||S.x===N.x&&v$(N,S)))&&(N=S,re=le)}S=S.next}while(S!==G);return N}(h,o);if(!u)return o;const f=KA(u,h);return Eh(f,f.next),Eh(u,u.next)}function v$(h,o){return An(h.prev,h,o.prev)<0&&An(o.next,h,h.next)<0}function gw(h,o,u,f,g){return(h=1431655765&((h=858993459&((h=252645135&((h=16711935&((h=(h-u)*g|0)|h<<8))|h<<4))|h<<2))|h<<1))|(o=1431655765&((o=858993459&((o=252645135&((o=16711935&((o=(o-f)*g|0)|o<<8))|o<<4))|o<<2))|o<<1))<<1}function x$(h){let o=h,u=h;do(o.x<u.x||o.x===u.x&&o.y<u.y)&&(u=o),o=o.next;while(o!==h);return u}function HA(h,o,u,f,g,b,S,C){return(g-S)*(o-C)>=(h-S)*(b-C)&&(h-S)*(f-C)>=(u-S)*(o-C)&&(u-S)*(b-C)>=(g-S)*(f-C)}function Sg(h,o,u,f,g,b,S,C){return!(h===S&&o===C)&&HA(h,o,u,f,g,b,S,C)}function b$(h,o){return h.next.i!==o.i&&h.prev.i!==o.i&&!function(u,f){let g=u;do{if(g.i!==u.i&&g.next.i!==u.i&&g.i!==f.i&&g.next.i!==f.i&&ZA(g,g.next,u,f))return!0;g=g.next}while(g!==u);return!1}(h,o)&&(Tg(h,o)&&Tg(o,h)&&function(u,f){let g=u,b=!1;const S=(u.x+f.x)/2,C=(u.y+f.y)/2;do g.y>C!=g.next.y>C&&g.next.y!==g.y&&S<(g.next.x-g.x)*(C-g.y)/(g.next.y-g.y)+g.x&&(b=!b),g=g.next;while(g!==u);return b}(h,o)&&(An(h.prev,h,o.prev)||An(h,o.prev,o))||Pf(h,o)&&An(h.prev,h,h.next)>0&&An(o.prev,o,o.next)>0)}function An(h,o,u){return(o.y-h.y)*(u.x-o.x)-(o.x-h.x)*(u.y-o.y)}function Pf(h,o){return h.x===o.x&&h.y===o.y}function ZA(h,o,u,f){const g=nv(An(h,o,u)),b=nv(An(h,o,f)),S=nv(An(u,f,h)),C=nv(An(u,f,o));return g!==b&&S!==C||!(g!==0||!rv(h,u,o))||!(b!==0||!rv(h,f,o))||!(S!==0||!rv(u,h,f))||!(C!==0||!rv(u,o,f))}function rv(h,o,u){return o.x<=Math.max(h.x,u.x)&&o.x>=Math.min(h.x,u.x)&&o.y<=Math.max(h.y,u.y)&&o.y>=Math.min(h.y,u.y)}function nv(h){return h>0?1:h<0?-1:0}function Tg(h,o){return An(h.prev,h,h.next)<0?An(h,o,h.next)>=0&&An(h,h.prev,o)>=0:An(h,o,h.prev)<0||An(h,h.next,o)<0}function KA(h,o){const u=yw(h.i,h.x,h.y),f=yw(o.i,o.x,o.y),g=h.next,b=o.prev;return h.next=o,o.prev=h,u.next=g,g.prev=u,f.next=u,u.prev=f,b.next=f,f.prev=b,f}function XA(h,o,u,f){const g=yw(h,o,u);return f?(g.next=f.next,g.prev=f,f.next.prev=g,f.next=g):(g.prev=g,g.next=g),g}function Eg(h){h.next.prev=h.prev,h.prev.next=h.next,h.prevZ&&(h.prevZ.nextZ=h.nextZ),h.nextZ&&(h.nextZ.prevZ=h.prevZ)}function yw(h,o,u){return{i:h,x:o,y:u,prev:null,next:null,z:0,prevZ:null,nextZ:null,steiner:!1}}class Af{constructor(o,u){if(u>o)throw new Error("Min granularity must not be greater than base granularity.");this._baseZoomGranularity=o,this._minGranularity=u}getGranularityForZoomLevel(o){return Math.max(Math.floor(this._baseZoomGranularity/(1<<o)),this._minGranularity,1)}}class iv{constructor(o){this.fill=o.fill,this.line=o.line,this.tile=o.tile,this.stencil=o.stencil,this.circle=o.circle}}iv.noSubdivision=new iv({fill:new Af(0,0),line:new Af(0,0),tile:new Af(0,0),stencil:new Af(0,0),circle:1}),xt("SubdivisionGranularityExpression",Af),xt("SubdivisionGranularitySetting",iv);const kf=-32768,Cg=32767;class w${constructor(o,u){this._vertexBuffer=[],this._vertexDictionary=new Map,this._used=!1,this._granularity=o,this._granularityCellSize=ve/o,this._canonical=u}_getKey(o,u){return(o+=32768)<<16|u+32768}_vertexToIndex(o,u){if(o<-32768||u<-32768||o>32767||u>32767)throw new Error("Vertex coordinates are out of signed 16 bit integer range.");const f=0|Math.round(o),g=0|Math.round(u),b=this._getKey(f,g);if(this._vertexDictionary.has(b))return this._vertexDictionary.get(b);const S=this._vertexBuffer.length/2;return this._vertexDictionary.set(b,S),this._vertexBuffer.push(f,g),S}_subdivideTrianglesScanline(o){if(this._granularity<2)return function(g,b){const S=[];for(let C=0;C<b.length;C+=3){const k=b[C],N=b[C+1],F=b[C+2],G=g[2*k],Y=g[2*k+1];(g[2*N]-G)*(g[2*F+1]-Y)-(g[2*N+1]-Y)*(g[2*F]-G)>0?(S.push(k),S.push(F),S.push(N)):(S.push(k),S.push(N),S.push(F))}return S}(this._vertexBuffer,o);const u=[],f=o.length;for(let g=0;g<f;g+=3){const b=[o[g+0],o[g+1],o[g+2]],S=[this._vertexBuffer[2*o[g+0]+0],this._vertexBuffer[2*o[g+0]+1],this._vertexBuffer[2*o[g+1]+0],this._vertexBuffer[2*o[g+1]+1],this._vertexBuffer[2*o[g+2]+0],this._vertexBuffer[2*o[g+2]+1]];let C=1/0,k=1/0,N=-1/0,F=-1/0;for(let le=0;le<3;le++){const pe=S[2*le],be=S[2*le+1];C=Math.min(C,pe),N=Math.max(N,pe),k=Math.min(k,be),F=Math.max(F,be)}if(C===N||k===F)continue;const G=Math.floor(C/this._granularityCellSize),Y=Math.ceil(N/this._granularityCellSize),J=Math.floor(k/this._granularityCellSize),re=Math.ceil(F/this._granularityCellSize);if(G!==Y||J!==re)for(let le=J;le<re;le++){const pe=this._scanlineGenerateVertexRingForCellRow(le,S,b);S$(this._vertexBuffer,pe,u)}else u.push(...b)}return u}_scanlineGenerateVertexRingForCellRow(o,u,f){const g=o*this._granularityCellSize,b=g+this._granularityCellSize,S=[];for(let C=0;C<3;C++){const k=u[2*C],N=u[2*C+1],F=u[2*(C+1)%6],G=u[(2*(C+1)+1)%6],Y=u[2*(C+2)%6],J=u[(2*(C+2)+1)%6],re=F-k,le=G-N,pe=re===0,be=le===0,Fe=(g-N)/le,ke=(b-N)/le,De=Math.min(Fe,ke),Ue=Math.max(Fe,ke);if(!be&&(De>=1||Ue<=0)||be&&(N<g||N>b)){G>=g&&G<=b&&S.push(f[(C+1)%3]);continue}!be&&De>0&&S.push(this._vertexToIndex(k+re*De,N+le*De));const Ke=k+re*Math.max(De,0),it=k+re*Math.min(Ue,1);pe||this._generateIntraEdgeVertices(S,k,N,F,G,Ke,it),!be&&Ue<1&&S.push(this._vertexToIndex(k+re*Ue,N+le*Ue)),(be||G>=g&&G<=b)&&S.push(f[(C+1)%3]),!be&&(G<=g||G>=b)&&this._generateInterEdgeVertices(S,k,N,F,G,Y,J,it,g,b)}return S}_generateIntraEdgeVertices(o,u,f,g,b,S,C){const k=g-u,N=b-f,F=N===0,G=F?Math.min(u,g):Math.min(S,C),Y=F?Math.max(u,g):Math.max(S,C),J=Math.floor(G/this._granularityCellSize)+1,re=Math.ceil(Y/this._granularityCellSize)-1;if(F?u<g:S<C)for(let le=J;le<=re;le++){const pe=le*this._granularityCellSize;o.push(this._vertexToIndex(pe,f+N*(pe-u)/k))}else for(let le=re;le>=J;le--){const pe=le*this._granularityCellSize;o.push(this._vertexToIndex(pe,f+N*(pe-u)/k))}}_generateInterEdgeVertices(o,u,f,g,b,S,C,k,N,F){const G=b-f,Y=S-g,J=C-b,re=(N-b)/J,le=(F-b)/J,pe=Math.min(re,le),be=Math.max(re,le),Fe=g+Y*pe;let ke=Math.floor(Math.min(Fe,k)/this._granularityCellSize)+1,De=Math.ceil(Math.max(Fe,k)/this._granularityCellSize)-1,Ue=k<Fe;const Ke=J===0;if(Ke&&(C===N||C===F))return;if(Ke||pe>=1||be<=0){const yt=f-C,ht=S+(u-S)*Math.min((N-C)/yt,(F-C)/yt);ke=Math.floor(Math.min(ht,k)/this._granularityCellSize)+1,De=Math.ceil(Math.max(ht,k)/this._granularityCellSize)-1,Ue=k<ht}const it=G>0?F:N;if(Ue)for(let yt=ke;yt<=De;yt++)o.push(this._vertexToIndex(yt*this._granularityCellSize,it));else for(let yt=De;yt>=ke;yt--)o.push(this._vertexToIndex(yt*this._granularityCellSize,it))}_generateOutline(o){const u=[];for(const f of o){const g=Ch(f,this._granularity,!0),b=this._pointArrayToIndices(g),S=[];for(let C=1;C<b.length;C++)S.push(b[C-1]),S.push(b[C]);u.push(S)}return u}_handlePoles(o){let u=!1,f=!1;this._canonical&&(this._canonical.y===0&&(u=!0),this._canonical.y===(1<<this._canonical.z)-1&&(f=!0)),(u||f)&&this._fillPoles(o,u,f)}_ensureNoPoleVertices(){const o=this._vertexBuffer;for(let u=0;u<o.length;u+=2){const f=o[u+1];f===kf&&(o[u+1]=-32767),f===Cg&&(o[u+1]=32766)}}_generatePoleQuad(o,u,f,g,b,S){g>b!=(S===kf)?(o.push(u),o.push(f),o.push(this._vertexToIndex(g,S)),o.push(f),o.push(this._vertexToIndex(b,S)),o.push(this._vertexToIndex(g,S))):(o.push(f),o.push(u),o.push(this._vertexToIndex(g,S)),o.push(this._vertexToIndex(b,S)),o.push(f),o.push(this._vertexToIndex(g,S)))}_fillPoles(o,u,f){const g=this._vertexBuffer,b=ve,S=o.length;for(let C=2;C<S;C+=3){const k=o[C-2],N=o[C-1],F=o[C],G=g[2*k],Y=g[2*k+1],J=g[2*N],re=g[2*N+1],le=g[2*F],pe=g[2*F+1];u&&(Y===0&&re===0&&this._generatePoleQuad(o,k,N,G,J,kf),re===0&&pe===0&&this._generatePoleQuad(o,N,F,J,le,kf),pe===0&&Y===0&&this._generatePoleQuad(o,F,k,le,G,kf)),f&&(Y===b&&re===b&&this._generatePoleQuad(o,k,N,G,J,Cg),re===b&&pe===b&&this._generatePoleQuad(o,N,F,J,le,Cg),pe===b&&Y===b&&this._generatePoleQuad(o,F,k,le,G,Cg))}}_initializeVertices(o){for(let u=0;u<o.length;u+=2)this._vertexToIndex(o[u],o[u+1])}subdividePolygonInternal(o,u){if(this._used)throw new Error("Subdivision: multiple use not allowed.");this._used=!0;const{flattened:f,holeIndices:g}=function(C){const k=[],N=[];for(const F of C)if(F.length!==0){F!==C[0]&&k.push(N.length/2);for(let G=0;G<F.length;G++)N.push(F[G].x),N.push(F[G].y)}return{flattened:N,holeIndices:k}}(o);let b;this._initializeVertices(f);try{const C=function(N,F,G=2){const Y=F&&F.length,J=Y?F[0]*G:N.length;let re=qA(N,0,J,G,!0);const le=[];if(!re||re.next===re.prev)return le;let pe,be,Fe;if(Y&&(re=function(ke,De,Ue,Ke){const it=[];for(let yt=0,ht=De.length;yt<ht;yt++){const pt=qA(ke,De[yt]*Ke,yt<ht-1?De[yt+1]*Ke:ke.length,Ke,!1);pt===pt.next&&(pt.steiner=!0),it.push(x$(pt))}it.sort(y$);for(let yt=0;yt<it.length;yt++)Ue=_$(it[yt],Ue);return Ue}(N,F,re,G)),N.length>80*G){pe=N[0],be=N[1];let ke=pe,De=be;for(let Ue=G;Ue<J;Ue+=G){const Ke=N[Ue],it=N[Ue+1];Ke<pe&&(pe=Ke),it<be&&(be=it),Ke>ke&&(ke=Ke),it>De&&(De=it)}Fe=Math.max(ke-pe,De-be),Fe=Fe!==0?32767/Fe:0}return wg(re,le,G,pe,be,Fe,0),le}(f,g),k=this._convertIndices(f,C);b=this._subdivideTrianglesScanline(k)}catch(C){console.error(C)}let S=[];return u&&(S=this._generateOutline(o)),this._ensureNoPoleVertices(),this._handlePoles(b),{verticesFlattened:this._vertexBuffer,indicesTriangles:b,indicesLineList:S}}_convertIndices(o,u){const f=[];for(let g=0;g<u.length;g++)f.push(this._vertexToIndex(o[2*u[g]],o[2*u[g]+1]));return f}_pointArrayToIndices(o){const u=[];for(let f=0;f<o.length;f++){const g=o[f];u.push(this._vertexToIndex(g.x,g.y))}return u}}function YA(h,o,u,f=!0){return new w$(u,o).subdividePolygonInternal(h,f)}function Ch(h,o,u=!1){if(!h||h.length<1)return[];if(h.length<2)return[];const f=h[0],g=h[h.length-1],b=u&&(f.x!==g.x||f.y!==g.y);if(o<2)return b?[...h,h[0]]:[...h];const S=Math.floor(ve/o),C=[];C.push(new m(h[0].x,h[0].y));const k=h.length,N=b?k:k-1;for(let F=0;F<N;F++){const G=h[F],Y=F<k-1?h[F+1]:h[0],J=G.x,re=G.y,le=Y.x,pe=Y.y,be=J!==le,Fe=re!==pe;if(!be&&!Fe)continue;const ke=le-J,De=pe-re,Ue=Math.abs(ke),Ke=Math.abs(De);let it=J,yt=re;for(;;){const pt=ke>0?(Math.floor(it/S)+1)*S:(Math.ceil(it/S)-1)*S,Ot=De>0?(Math.floor(yt/S)+1)*S:(Math.ceil(yt/S)-1)*S,ft=Math.abs(it-pt),mt=Math.abs(yt-Ot),et=Math.abs(it-le),Vt=Math.abs(yt-pe),Ut=be?ft/Ue:Number.POSITIVE_INFINITY,jt=Fe?mt/Ke:Number.POSITIVE_INFINITY;if((et<=ft||!be)&&(Vt<=mt||!Fe))break;if(Ut<jt&&be||!Fe){it=pt,yt+=De*Ut;const Mt=new m(it,Math.round(yt));C[C.length-1].x===Mt.x&&C[C.length-1].y===Mt.y||C.push(Mt)}else{it+=ke*jt,yt=Ot;const Mt=new m(Math.round(it),yt);C[C.length-1].x===Mt.x&&C[C.length-1].y===Mt.y||C.push(Mt)}}const ht=new m(le,pe);C[C.length-1].x===ht.x&&C[C.length-1].y===ht.y||C.push(ht)}return C}function S$(h,o,u){if(o.length===0)throw new Error("Subdivision vertex ring is empty.");let f=0,g=h[2*o[0]];for(let k=1;k<o.length;k++){const N=h[2*o[k]];N<g&&(g=N,f=k)}const b=o.length;let S=f,C=(S+1)%b;for(;;){const k=S-1>=0?S-1:b-1,N=(C+1)%b,F=h[2*o[k]],G=h[2*o[N]],Y=h[2*o[S]],J=h[2*o[S]+1],re=h[2*o[C]+1];let le=!1;if(F<G)le=!0;else if(F>G)le=!1;else{const pe=re-J,be=-(h[2*o[C]]-Y),Fe=J<re?1:-1;((F-Y)*pe+(h[2*o[k]+1]-J)*be)*Fe>((G-Y)*pe+(h[2*o[N]+1]-J)*be)*Fe&&(le=!0)}if(le){const pe=o[k],be=o[S],Fe=o[C];pe!==be&&pe!==Fe&&be!==Fe&&u.push(Fe,be,pe),S--,S<0&&(S=b-1)}else{const pe=o[N],be=o[S],Fe=o[C];pe!==be&&pe!==Fe&&be!==Fe&&u.push(Fe,be,pe),C++,C>=b&&(C=0)}if(k===N)break}}function QA(h,o,u,f,g,b,S,C,k){const N=g.length/2,F=S&&C&&k;if(N<gr.MAX_VERTEX_ARRAY_LENGTH){const G=o.prepareSegment(N,u,f),Y=G.vertexLength;for(let le=0;le<b.length;le+=3)f.emplaceBack(Y+b[le],Y+b[le+1],Y+b[le+2]);let J,re;G.vertexLength+=N,G.primitiveLength+=b.length/3,F&&(re=S.prepareSegment(N,u,C),J=re.vertexLength,re.vertexLength+=N);for(let le=0;le<g.length;le+=2)h(g[le],g[le+1]);if(F)for(let le=0;le<k.length;le++){const pe=k[le];for(let be=1;be<pe.length;be+=2)C.emplaceBack(J+pe[be-1],J+pe[be]);re.primitiveLength+=pe.length/2}}else(function(G,Y,J,re,le,pe){const be=[];for(let Ke=0;Ke<re.length/2;Ke++)be.push(-1);const Fe={count:0};let ke=0,De=G.getOrCreateLatestSegment(Y,J),Ue=De.vertexLength;for(let Ke=2;Ke<le.length;Ke+=3){const it=le[Ke-2],yt=le[Ke-1],ht=le[Ke];let pt=be[it]<ke,Ot=be[yt]<ke,ft=be[ht]<ke;De.vertexLength+((pt?1:0)+(Ot?1:0)+(ft?1:0))>gr.MAX_VERTEX_ARRAY_LENGTH&&(De=G.createNewSegment(Y,J),ke=Fe.count,pt=!0,Ot=!0,ft=!0,Ue=0);const mt=Pg(be,re,pe,Fe,it,pt,De),et=Pg(be,re,pe,Fe,yt,Ot,De),Vt=Pg(be,re,pe,Fe,ht,ft,De);J.emplaceBack(Ue+mt-ke,Ue+et-ke,Ue+Vt-ke),De.primitiveLength++}})(o,u,f,g,b,h),F&&function(G,Y,J,re,le,pe){const be=[];for(let Ke=0;Ke<re.length/2;Ke++)be.push(-1);const Fe={count:0};let ke=0,De=G.getOrCreateLatestSegment(Y,J),Ue=De.vertexLength;for(let Ke=0;Ke<le.length;Ke++){const it=le[Ke];for(let yt=1;yt<le[Ke].length;yt+=2){const ht=it[yt-1],pt=it[yt];let Ot=be[ht]<ke,ft=be[pt]<ke;De.vertexLength+((Ot?1:0)+(ft?1:0))>gr.MAX_VERTEX_ARRAY_LENGTH&&(De=G.createNewSegment(Y,J),ke=Fe.count,Ot=!0,ft=!0,Ue=0);const mt=Pg(be,re,pe,Fe,ht,Ot,De),et=Pg(be,re,pe,Fe,pt,ft,De);J.emplaceBack(Ue+mt-ke,Ue+et-ke),De.primitiveLength++}}}(S,u,C,g,k,h),o.forceNewSegmentOnNextPrepare(),S==null||S.forceNewSegmentOnNextPrepare()}function Pg(h,o,u,f,g,b,S){if(b){const C=f.count;return u(o[2*g],o[2*g+1]),h[g]=f.count,f.count++,S.vertexLength++,C}return h[g]}class _w{constructor(o){this.zoom=o.zoom,this.overscaling=o.overscaling,this.layers=o.layers,this.layerIds=this.layers.map(u=>u.id),this.index=o.index,this.hasDependencies=!1,this.patternFeatures=[],this.layoutVertexArray=new Ne,this.indexArray=new Ir,this.indexArray2=new Fr,this.programConfigurations=new Wa(o.layers,o.zoom),this.segments=new gr,this.segments2=new gr,this.stateDependentLayerIds=this.layers.filter(u=>u.isStateDependent()).map(u=>u.id)}populate(o,u,f){this.hasDependencies=tv("fill",this.layers,u);const g=this.layers[0].layout.get("fill-sort-key"),b=!g.isConstant(),S=[];for(const{feature:C,id:k,index:N,sourceLayerIndex:F}of o){const G=this.layers[0]._featureFilter.needGeometry,Y=Th(C,G);if(!this.layers[0]._featureFilter.filter(new $r(this.zoom),Y,f))continue;const J=b?g.evaluate(Y,{},f,u.availableImages):void 0,re={id:k,properties:C.properties,type:C.type,sourceLayerIndex:F,index:N,geometry:G?Y.geometry:Sh(C),patterns:{},sortKey:J};S.push(re)}b&&S.sort((C,k)=>C.sortKey-k.sortKey);for(const C of S){const{geometry:k,index:N,sourceLayerIndex:F}=C;if(this.hasDependencies){const G=mw("fill",this.layers,C,{zoom:this.zoom},u);this.patternFeatures.push(G)}else this.addFeature(C,k,N,f,{},u.subdivisionGranularity);u.featureIndex.insert(o[N].feature,k,N,F,this.index)}}update(o,u,f){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(o,u,this.stateDependentLayers,{imagePositions:f})}addFeatures(o,u,f){for(const g of this.patternFeatures)this.addFeature(g,g.geometry,g.index,u,f,o.subdivisionGranularity)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(o){this.uploaded||(this.layoutVertexBuffer=o.createVertexBuffer(this.layoutVertexArray,d$),this.indexBuffer=o.createIndexBuffer(this.indexArray),this.indexBuffer2=o.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(o),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(o,u,f,g,b,S){for(const C of Wd(u,500)){const k=YA(C,g,S.fill.getGranularityForZoomLevel(g.z)),N=this.layoutVertexArray;QA((F,G)=>{N.emplaceBack(F,G)},this.segments,this.layoutVertexArray,this.indexArray,k.verticesFlattened,k.indicesTriangles,this.segments2,this.indexArray2,k.indicesLineList)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,o,f,{imagePositions:b,canonical:g})}}let JA,ek;xt("FillBucket",_w,{omit:["layers","patternFeatures"]});var T$={get paint(){return ek=ek||new Hi({"fill-antialias":new kt(je.paint_fill["fill-antialias"]),"fill-opacity":new Bt(je.paint_fill["fill-opacity"]),"fill-color":new Bt(je.paint_fill["fill-color"]),"fill-outline-color":new Bt(je.paint_fill["fill-outline-color"]),"fill-translate":new kt(je.paint_fill["fill-translate"]),"fill-translate-anchor":new kt(je.paint_fill["fill-translate-anchor"]),"fill-pattern":new Lc(je.paint_fill["fill-pattern"])})},get layout(){return JA=JA||new Hi({"fill-sort-key":new Bt(je.layout_fill["fill-sort-key"])})}};class E$ extends ao{constructor(o,u){super(o,T$,u)}recalculate(o,u){super.recalculate(o,u);const f=this.paint._values["fill-outline-color"];f.value.kind==="constant"&&f.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(o){return new _w(o)}queryRadius(){return J_(this.paint.get("fill-translate"))}queryIntersectsFeature({queryGeometry:o,geometry:u,transform:f,pixelsToTileUnits:g}){return RA(ev(o,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),-f.bearingInRadians,g),u)}isTileClipped(){return!0}}const C$=yn([{name:"a_pos",components:2,type:"Int16"},{name:"a_normal_ed",components:4,type:"Int16"}],4),P$=yn([{name:"a_centroid",components:2,type:"Int16"}],4),{members:A$}=C$;class Mf{constructor(o,u,f,g,b){this.properties={},this.extent=f,this.type=0,this.id=void 0,this._pbf=o,this._geometry=-1,this._keys=g,this._values=b,o.readFields(k$,this,u)}loadGeometry(){const o=this._pbf;o.pos=this._geometry;const u=o.readVarint()+o.pos,f=[];let g,b=1,S=0,C=0,k=0;for(;o.pos<u;){if(S<=0){const N=o.readVarint();b=7&N,S=N>>3}if(S--,b===1||b===2)C+=o.readSVarint(),k+=o.readSVarint(),b===1&&(g&&f.push(g),g=[]),g&&g.push(new m(C,k));else{if(b!==7)throw new Error(`unknown command ${b}`);g&&g.push(g[0].clone())}}return g&&f.push(g),f}bbox(){const o=this._pbf;o.pos=this._geometry;const u=o.readVarint()+o.pos;let f=1,g=0,b=0,S=0,C=1/0,k=-1/0,N=1/0,F=-1/0;for(;o.pos<u;){if(g<=0){const G=o.readVarint();f=7&G,g=G>>3}if(g--,f===1||f===2)b+=o.readSVarint(),S+=o.readSVarint(),b<C&&(C=b),b>k&&(k=b),S<N&&(N=S),S>F&&(F=S);else if(f!==7)throw new Error(`unknown command ${f}`)}return[C,N,k,F]}toGeoJSON(o,u,f){const g=this.extent*Math.pow(2,f),b=this.extent*o,S=this.extent*u,C=this.loadGeometry();function k(Y){return[360*(Y.x+b)/g-180,360/Math.PI*Math.atan(Math.exp((1-2*(Y.y+S)/g)*Math.PI))-90]}function N(Y){return Y.map(k)}let F;if(this.type===1){const Y=[];for(const re of C)Y.push(re[0]);const J=N(Y);F=Y.length===1?{type:"Point",coordinates:J[0]}:{type:"MultiPoint",coordinates:J}}else if(this.type===2){const Y=C.map(N);F=Y.length===1?{type:"LineString",coordinates:Y[0]}:{type:"MultiLineString",coordinates:Y}}else{if(this.type!==3)throw new Error("unknown feature type");{const Y=function(re){const le=re.length;if(le<=1)return[re];const pe=[];let be,Fe;for(let ke=0;ke<le;ke++){const De=M$(re[ke]);De!==0&&(Fe===void 0&&(Fe=De<0),Fe===De<0?(be&&pe.push(be),be=[re[ke]]):be&&be.push(re[ke]))}return be&&pe.push(be),pe}(C),J=[];for(const re of Y)J.push(re.map(N));F=J.length===1?{type:"Polygon",coordinates:J[0]}:{type:"MultiPolygon",coordinates:J}}}const G={type:"Feature",geometry:F,properties:this.properties};return this.id!=null&&(G.id=this.id),G}}function k$(h,o,u){h===1?o.id=u.readVarint():h===2?function(f,g){const b=f.readVarint()+f.pos;for(;f.pos<b;){const S=g._keys[f.readVarint()],C=g._values[f.readVarint()];g.properties[S]=C}}(u,o):h===3?o.type=u.readVarint():h===4&&(o._geometry=u.pos)}function M$(h){let o=0;for(let u,f,g=0,b=h.length,S=b-1;g<b;S=g++)u=h[g],f=h[S],o+=(f.x-u.x)*(u.y+f.y);return o}Mf.types=["Unknown","Point","LineString","Polygon"];class tk{constructor(o,u){this.version=1,this.name="",this.extent=4096,this.length=0,this._pbf=o,this._keys=[],this._values=[],this._features=[],o.readFields(I$,this,u),this.length=this._features.length}feature(o){if(o<0||o>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[o];const u=this._pbf.readVarint()+this._pbf.pos;return new Mf(this._pbf,u,this.extent,this._keys,this._values)}}function I$(h,o,u){h===15?o.version=u.readVarint():h===1?o.name=u.readString():h===5?o.extent=u.readVarint():h===2?o._features.push(u.pos):h===3?o._keys.push(u.readString()):h===4&&o._values.push(function(f){let g=null;const b=f.readVarint()+f.pos;for(;f.pos<b;){const S=f.readVarint()>>3;g=S===1?f.readString():S===2?f.readFloat():S===3?f.readDouble():S===4?f.readVarint64():S===5?f.readVarint():S===6?f.readSVarint():S===7?f.readBoolean():null}if(g==null)throw new Error("unknown feature value");return g}(u))}class rk{constructor(o,u){this.layers=o.readFields(R$,{},u)}}function R$(h,o,u){if(h===3){const f=new tk(u,u.readVarint()+u.pos);f.length&&(o[f.name]=f)}}const vw=Math.pow(2,13);function Ag(h,o,u,f,g,b,S,C){h.emplaceBack(o,u,2*Math.floor(f*vw)+S,g*vw*2,b*vw*2,Math.round(C))}class xw{constructor(o){this.zoom=o.zoom,this.overscaling=o.overscaling,this.layers=o.layers,this.layerIds=this.layers.map(u=>u.id),this.index=o.index,this.hasDependencies=!1,this.layoutVertexArray=new qe,this.centroidVertexArray=new Le,this.indexArray=new Ir,this.programConfigurations=new Wa(o.layers,o.zoom),this.segments=new gr,this.stateDependentLayerIds=this.layers.filter(u=>u.isStateDependent()).map(u=>u.id)}populate(o,u,f){this.features=[],this.hasDependencies=tv("fill-extrusion",this.layers,u);for(const{feature:g,id:b,index:S,sourceLayerIndex:C}of o){const k=this.layers[0]._featureFilter.needGeometry,N=Th(g,k);if(!this.layers[0]._featureFilter.filter(new $r(this.zoom),N,f))continue;const F={id:b,sourceLayerIndex:C,index:S,geometry:k?N.geometry:Sh(g),properties:g.properties,type:g.type,patterns:{}};this.hasDependencies?this.features.push(mw("fill-extrusion",this.layers,F,{zoom:this.zoom},u)):this.addFeature(F,F.geometry,S,f,{},u.subdivisionGranularity),u.featureIndex.insert(g,F.geometry,S,C,this.index,!0)}}addFeatures(o,u,f){for(const g of this.features){const{geometry:b}=g;this.addFeature(g,b,g.index,u,f,o.subdivisionGranularity)}}update(o,u,f){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(o,u,this.stateDependentLayers,{imagePositions:f})}isEmpty(){return this.layoutVertexArray.length===0&&this.centroidVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(o){this.uploaded||(this.layoutVertexBuffer=o.createVertexBuffer(this.layoutVertexArray,A$),this.centroidVertexBuffer=o.createVertexBuffer(this.centroidVertexArray,P$.members,!0),this.indexBuffer=o.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(o),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.centroidVertexBuffer.destroy())}addFeature(o,u,f,g,b,S){for(const C of Wd(u,500)){const k={x:0,y:0,sampleCount:0},N=this.layoutVertexArray.length;this.processPolygon(k,g,o,C,S);const F=this.layoutVertexArray.length-N,G=Math.floor(k.x/k.sampleCount),Y=Math.floor(k.y/k.sampleCount);for(let J=0;J<F;J++)this.centroidVertexArray.emplaceBack(G,Y)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,o,f,{imagePositions:b,canonical:g})}processPolygon(o,u,f,g,b){if(g.length<1||nk(g[0]))return;for(const G of g)G.length!==0&&D$(o,G);const S={segment:this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray)},C=b.fill.getGranularityForZoomLevel(u.z),k=Mf.types[f.type]==="Polygon";for(const G of g){if(G.length===0||nk(G))continue;const Y=Ch(G,C,k);this._generateSideFaces(Y,S)}if(!k)return;const N=YA(g,u,C,!1),F=this.layoutVertexArray;QA((G,Y)=>{Ag(F,G,Y,0,0,1,1,0)},this.segments,this.layoutVertexArray,this.indexArray,N.verticesFlattened,N.indicesTriangles)}_generateSideFaces(o,u){let f=0;for(let g=1;g<o.length;g++){const b=o[g],S=o[g-1];if(L$(b,S))continue;u.segment.vertexLength+4>gr.MAX_VERTEX_ARRAY_LENGTH&&(u.segment=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));const C=b.sub(S)._perp()._unit(),k=S.dist(b);f+k>32768&&(f=0),Ag(this.layoutVertexArray,b.x,b.y,C.x,C.y,0,0,f),Ag(this.layoutVertexArray,b.x,b.y,C.x,C.y,0,1,f),f+=k,Ag(this.layoutVertexArray,S.x,S.y,C.x,C.y,0,0,f),Ag(this.layoutVertexArray,S.x,S.y,C.x,C.y,0,1,f);const N=u.segment.vertexLength;this.indexArray.emplaceBack(N,N+2,N+1),this.indexArray.emplaceBack(N+1,N+2,N+3),u.segment.vertexLength+=4,u.segment.primitiveLength+=2}}}function D$(h,o){for(let u=0;u<o.length;u++){const f=o[u];u===o.length-1&&o[0].x===f.x&&o[0].y===f.y||(h.x+=f.x,h.y+=f.y,h.sampleCount++)}}function L$(h,o){return h.x===o.x&&(h.x<0||h.x>ve)||h.y===o.y&&(h.y<0||h.y>ve)}function nk(h){return h.every(o=>o.x<0)||h.every(o=>o.x>ve)||h.every(o=>o.y<0)||h.every(o=>o.y>ve)}let ik;xt("FillExtrusionBucket",xw,{omit:["layers","features"]});var O$={get paint(){return ik=ik||new Hi({"fill-extrusion-opacity":new kt(je["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new Bt(je["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new kt(je["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new kt(je["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new Lc(je["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new Bt(je["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new Bt(je["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new kt(je["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])})}};class z$ extends ao{constructor(o,u){super(o,O$,u)}createBucket(o){return new xw(o)}queryRadius(){return J_(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}queryIntersectsFeature({queryGeometry:o,feature:u,featureState:f,geometry:g,transform:b,pixelsToTileUnits:S,pixelPosMatrix:C}){const k=ev(o,this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),-b.bearingInRadians,S),N=this.paint.get("fill-extrusion-height").evaluate(u,f),F=this.paint.get("fill-extrusion-base").evaluate(u,f),G=function(J,re){const le=[];for(const pe of J){const be=[pe.x,pe.y,0,1];he(be,be,re),le.push(new m(be[0]/be[3],be[1]/be[3]))}return le}(k,C),Y=function(J,re,le,pe){const be=[],Fe=[],ke=pe[8]*re,De=pe[9]*re,Ue=pe[10]*re,Ke=pe[11]*re,it=pe[8]*le,yt=pe[9]*le,ht=pe[10]*le,pt=pe[11]*le;for(const Ot of J){const ft=[],mt=[];for(const et of Ot){const Vt=et.x,Ut=et.y,jt=pe[0]*Vt+pe[4]*Ut+pe[12],Mt=pe[1]*Vt+pe[5]*Ut+pe[13],fr=pe[2]*Vt+pe[6]*Ut+pe[14],hn=pe[3]*Vt+pe[7]*Ut+pe[15],Kn=fr+Ue,Oi=hn+Ke,ho=jt+it,Ss=Mt+yt,Ei=fr+ht,on=hn+pt,li=new m((jt+ke)/Oi,(Mt+De)/Oi);li.z=Kn/Oi,ft.push(li);const Ci=new m(ho/on,Ss/on);Ci.z=Ei/on,mt.push(Ci)}be.push(ft),Fe.push(mt)}return[be,Fe]}(g,F,N,C);return function(J,re,le){let pe=1/0;RA(le,re)&&(pe=sk(le,re[0]));for(let be=0;be<re.length;be++){const Fe=re[be],ke=J[be];for(let De=0;De<Fe.length-1;De++){const Ue=Fe[De],Ke=[Ue,Fe[De+1],ke[De+1],ke[De],Ue];IA(le,Ke)&&(pe=Math.min(pe,sk(le,Ke)))}}return pe!==1/0&&pe}(Y[0],Y[1],G)}}function kg(h,o){return h.x*o.x+h.y*o.y}function sk(h,o){if(h.length===1){let u=0;const f=o[u++];let g;for(;!g||f.equals(g);)if(g=o[u++],!g)return 1/0;for(;u<o.length;u++){const b=o[u],S=h[0],C=g.sub(f),k=b.sub(f),N=S.sub(f),F=kg(C,C),G=kg(C,k),Y=kg(k,k),J=kg(N,C),re=kg(N,k),le=F*Y-G*G,pe=(Y*J-G*re)/le,be=(F*re-G*J)/le,Fe=f.z*(1-pe-be)+g.z*pe+b.z*be;if(isFinite(Fe))return Fe}return 1/0}{let u=1/0;for(const f of o)u=Math.min(u,f.z);return u}}const N$=yn([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}],4),{members:j$}=N$,F$=yn([{name:"a_uv_x",components:1,type:"Float32"},{name:"a_split_index",components:1,type:"Float32"}]),{members:B$}=F$,$$=Math.cos(Math.PI/180*37.5),ok=Math.pow(2,14)/.5;class bw{constructor(o){this.zoom=o.zoom,this.overscaling=o.overscaling,this.layers=o.layers,this.layerIds=this.layers.map(u=>u.id),this.index=o.index,this.hasDependencies=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(u=>{this.gradients[u.id]={}}),this.layoutVertexArray=new Ve,this.layoutVertexArray2=new Ge,this.indexArray=new Ir,this.programConfigurations=new Wa(o.layers,o.zoom),this.segments=new gr,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(u=>u.isStateDependent()).map(u=>u.id)}populate(o,u,f){this.hasDependencies=tv("line",this.layers,u)||this.hasLineDasharray(this.layers);const g=this.layers[0].layout.get("line-sort-key"),b=!g.isConstant(),S=[];for(const{feature:C,id:k,index:N,sourceLayerIndex:F}of o){const G=this.layers[0]._featureFilter.needGeometry,Y=Th(C,G);if(!this.layers[0]._featureFilter.filter(new $r(this.zoom),Y,f))continue;const J=b?g.evaluate(Y,{},f):void 0,re={id:k,properties:C.properties,type:C.type,sourceLayerIndex:F,index:N,geometry:G?Y.geometry:Sh(C),patterns:{},dashes:{},sortKey:J};S.push(re)}b&&S.sort((C,k)=>C.sortKey-k.sortKey);for(const C of S){const{geometry:k,index:N,sourceLayerIndex:F}=C;this.hasDependencies?(tv("line",this.layers,u)?mw("line",this.layers,C,{zoom:this.zoom},u):this.hasLineDasharray(this.layers)&&this.addLineDashDependencies(this.layers,C,this.zoom,u),this.patternFeatures.push(C)):this.addFeature(C,k,N,f,{},{},u.subdivisionGranularity),u.featureIndex.insert(o[N].feature,k,N,F,this.index)}}update(o,u,f,g){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(o,u,this.stateDependentLayers,{imagePositions:f,dashPositions:g})}addFeatures(o,u,f,g){for(const b of this.patternFeatures)this.addFeature(b,b.geometry,b.index,u,f,g,o.subdivisionGranularity)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(o){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=o.createVertexBuffer(this.layoutVertexArray2,B$)),this.layoutVertexBuffer=o.createVertexBuffer(this.layoutVertexArray,j$),this.indexBuffer=o.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(o),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(o){if(o.properties&&Object.prototype.hasOwnProperty.call(o.properties,"mapbox_clip_start")&&Object.prototype.hasOwnProperty.call(o.properties,"mapbox_clip_end"))return{start:+o.properties.mapbox_clip_start,end:+o.properties.mapbox_clip_end}}addFeature(o,u,f,g,b,S,C){const k=this.layers[0].layout,N=k.get("line-join").evaluate(o,{}),F=k.get("line-cap"),G=k.get("line-miter-limit"),Y=k.get("line-round-limit");this.lineClips=this.lineFeatureClips(o);for(const J of u)this.addLine(J,o,N,F,G,Y,g,C);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,o,f,{imagePositions:b,dashPositions:S,canonical:g})}addLine(o,u,f,g,b,S,C,k){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,o=Ch(o,C?k.line.getGranularityForZoomLevel(C.z):1),this.lineClips){this.lineClipsArray.push(this.lineClips);for(let ke=0;ke<o.length-1;ke++)this.totalDistance+=o[ke].dist(o[ke+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}const N=Mf.types[u.type]==="Polygon";let F=o.length;for(;F>=2&&o[F-1].equals(o[F-2]);)F--;let G=0;for(;G<F-1&&o[G].equals(o[G+1]);)G++;if(F<(N?3:2))return;f==="bevel"&&(b=1.05);const Y=this.overscaling<=16?122880/(512*this.overscaling):0,J=this.segments.prepareSegment(10*F,this.layoutVertexArray,this.indexArray);let re,le,pe,be,Fe;this.e1=this.e2=-1,N&&(re=o[F-2],Fe=o[G].sub(re)._unit()._perp());for(let ke=G;ke<F;ke++){if(pe=ke===F-1?N?o[G+1]:void 0:o[ke+1],pe&&o[ke].equals(pe))continue;Fe&&(be=Fe),re&&(le=re),re=o[ke],Fe=pe?pe.sub(re)._unit()._perp():be,be=be||Fe;let De=be.add(Fe);De.x===0&&De.y===0||De._unit();const Ue=be.x*Fe.x+be.y*Fe.y,Ke=De.x*Fe.x+De.y*Fe.y,it=Ke!==0?1/Ke:1/0,yt=2*Math.sqrt(2-2*Ke),ht=Ke<$$&&le&&pe,pt=be.x*Fe.y-be.y*Fe.x>0;if(ht&&ke>G){const mt=re.dist(le);if(mt>2*Y){const et=re.sub(re.sub(le)._mult(Y/mt)._round());this.updateDistance(le,et),this.addCurrentVertex(et,be,0,0,J),le=et}}const Ot=le&&pe;let ft=Ot?f:N?"butt":g;if(Ot&&ft==="round"&&(it<S?ft="miter":it<=2&&(ft="fakeround")),ft==="miter"&&it>b&&(ft="bevel"),ft==="bevel"&&(it>2&&(ft="flipbevel"),it<b&&(ft="miter")),le&&this.updateDistance(le,re),ft==="miter")De._mult(it),this.addCurrentVertex(re,De,0,0,J);else if(ft==="flipbevel"){if(it>100)De=Fe.mult(-1);else{const mt=it*be.add(Fe).mag()/be.sub(Fe).mag();De._perp()._mult(mt*(pt?-1:1))}this.addCurrentVertex(re,De,0,0,J),this.addCurrentVertex(re,De.mult(-1),0,0,J)}else if(ft==="bevel"||ft==="fakeround"){const mt=-Math.sqrt(it*it-1),et=pt?mt:0,Vt=pt?0:mt;if(le&&this.addCurrentVertex(re,be,et,Vt,J),ft==="fakeround"){const Ut=Math.round(180*yt/Math.PI/20);for(let jt=1;jt<Ut;jt++){let Mt=jt/Ut;if(Mt!==.5){const hn=Mt-.5;Mt+=Mt*hn*(Mt-1)*((1.0904+Ue*(Ue*(3.55645-1.43519*Ue)-3.2452))*hn*hn+(.848013+Ue*(.215638*Ue-1.06021)))}const fr=Fe.sub(be)._mult(Mt)._add(be)._unit()._mult(pt?-1:1);this.addHalfVertex(re,fr.x,fr.y,!1,pt,0,J)}}pe&&this.addCurrentVertex(re,Fe,-et,-Vt,J)}else if(ft==="butt")this.addCurrentVertex(re,De,0,0,J);else if(ft==="square"){const mt=le?1:-1;this.addCurrentVertex(re,De,mt,mt,J)}else ft==="round"&&(le&&(this.addCurrentVertex(re,be,0,0,J),this.addCurrentVertex(re,be,1,1,J,!0)),pe&&(this.addCurrentVertex(re,Fe,-1,-1,J,!0),this.addCurrentVertex(re,Fe,0,0,J)));if(ht&&ke<F-1){const mt=re.dist(pe);if(mt>2*Y){const et=re.add(pe.sub(re)._mult(Y/mt)._round());this.updateDistance(re,et),this.addCurrentVertex(et,Fe,0,0,J),re=et}}}}addCurrentVertex(o,u,f,g,b,S=!1){const C=u.y*g-u.x,k=-u.y-u.x*g;this.addHalfVertex(o,u.x+u.y*f,u.y-u.x*f,S,!1,f,b),this.addHalfVertex(o,C,k,S,!0,-g,b),this.distance>ok/2&&this.totalDistance===0&&(this.distance=0,this.updateScaledDistance(),this.addCurrentVertex(o,u,f,g,b,S))}addHalfVertex({x:o,y:u},f,g,b,S,C,k){const N=.5*(this.lineClips?this.scaledDistance*(ok-1):this.scaledDistance);this.layoutVertexArray.emplaceBack((o<<1)+(b?1:0),(u<<1)+(S?1:0),Math.round(63*f)+128,Math.round(63*g)+128,1+(C===0?0:C<0?-1:1)|(63&N)<<2,N>>6),this.lineClips&&this.layoutVertexArray2.emplaceBack((this.scaledDistance-this.lineClips.start)/(this.lineClips.end-this.lineClips.start),this.lineClipsArray.length);const F=k.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,F,this.e2),k.primitiveLength++),S?this.e2=F:this.e1=F}updateScaledDistance(){this.scaledDistance=this.lineClips?this.lineClips.start+(this.lineClips.end-this.lineClips.start)*this.distance/this.totalDistance:this.distance}updateDistance(o,u){this.distance+=o.dist(u),this.updateScaledDistance()}hasLineDasharray(o){for(const u of o){const f=u.paint.get("line-dasharray");if(f&&!f.isConstant())return!0}return!1}addLineDashDependencies(o,u,f,g){for(const b of o){const S=b.paint.get("line-dasharray");if(!S||S.value.kind==="constant")continue;const C=b.layout.get("line-cap")==="round",k={dasharray:S.value.evaluate({zoom:f-1},u,{}),round:C},N={dasharray:S.value.evaluate({zoom:f},u,{}),round:C},F={dasharray:S.value.evaluate({zoom:f+1},u,{}),round:C},G=`${k.dasharray.join(",")},${k.round}`,Y=`${N.dasharray.join(",")},${N.round}`,J=`${F.dasharray.join(",")},${F.round}`;g.dashDependencies[G]=k,g.dashDependencies[Y]=N,g.dashDependencies[J]=F,u.dashes[b.id]={min:G,mid:Y,max:J}}}}let ak,lk;xt("LineBucket",bw,{omit:["layers","patternFeatures"]});var ck={get paint(){return lk=lk||new Hi({"line-opacity":new Bt(je.paint_line["line-opacity"]),"line-color":new Bt(je.paint_line["line-color"]),"line-translate":new kt(je.paint_line["line-translate"]),"line-translate-anchor":new kt(je.paint_line["line-translate-anchor"]),"line-width":new Bt(je.paint_line["line-width"]),"line-gap-width":new Bt(je.paint_line["line-gap-width"]),"line-offset":new Bt(je.paint_line["line-offset"]),"line-blur":new Bt(je.paint_line["line-blur"]),"line-dasharray":new Lc(je.paint_line["line-dasharray"]),"line-pattern":new Lc(je.paint_line["line-pattern"]),"line-gradient":new xf(je.paint_line["line-gradient"])})},get layout(){return ak=ak||new Hi({"line-cap":new kt(je.layout_line["line-cap"]),"line-join":new Bt(je.layout_line["line-join"]),"line-miter-limit":new kt(je.layout_line["line-miter-limit"]),"line-round-limit":new kt(je.layout_line["line-round-limit"]),"line-sort-key":new Bt(je.layout_line["line-sort-key"])})}};class V$ extends Bt{possiblyEvaluate(o,u){return u=new $r(Math.floor(u.zoom),{now:u.now,fadeDuration:u.fadeDuration,zoomHistory:u.zoomHistory,transition:u.transition}),super.possiblyEvaluate(o,u)}evaluate(o,u,f,g){return u=Ht({},u,{zoom:Math.floor(u.zoom)}),super.evaluate(o,u,f,g)}}let sv;class U$ extends ao{constructor(o,u){super(o,ck,u),this.gradientVersion=0,sv||(sv=new V$(ck.paint.properties["line-width"].specification),sv.useIntegerZoom=!0)}_handleSpecialPaintPropertyUpdate(o){if(o==="line-gradient"){const u=this.gradientExpression();this.stepInterpolant=!!function(f){return f._styleExpression!==void 0}(u)&&u._styleExpression.expression instanceof Oa,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}recalculate(o,u){super.recalculate(o,u),this.paint._values["line-floorwidth"]=sv.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,o)}createBucket(o){return new bw(o)}queryRadius(o){const u=o,f=uk(Cf("line-width",this,u),Cf("line-gap-width",this,u)),g=Cf("line-offset",this,u);return f/2+Math.abs(g)+J_(this.paint.get("line-translate"))}queryIntersectsFeature({queryGeometry:o,feature:u,featureState:f,geometry:g,transform:b,pixelsToTileUnits:S}){const C=ev(o,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),-b.bearingInRadians,S),k=S/2*uk(this.paint.get("line-width").evaluate(u,f),this.paint.get("line-gap-width").evaluate(u,f)),N=this.paint.get("line-offset").evaluate(u,f);return N&&(g=function(F,G){const Y=[];for(let J=0;J<F.length;J++){const re=F[J],le=[];for(let pe=0;pe<re.length;pe++){const be=re[pe-1],Fe=re[pe],ke=re[pe+1],De=pe===0?new m(0,0):Fe.sub(be)._unit()._perp(),Ue=pe===re.length-1?new m(0,0):ke.sub(Fe)._unit()._perp(),Ke=De._add(Ue)._unit(),it=Ke.x*Ue.x+Ke.y*Ue.y;it!==0&&Ke._mult(1/it),le.push(Ke._mult(G)._add(Fe))}Y.push(le)}return Y}(g,N*S)),function(F,G,Y){for(let J=0;J<G.length;J++){const re=G[J];if(F.length>=3){for(let le=0;le<re.length;le++)if(Ef(F,re[le]))return!0}if(X6(F,re,Y))return!0}return!1}(C,g,k)}isTileClipped(){return!0}}function uk(h,o){return o>0?o+2*h:h}const G$=yn([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),W$=yn([{name:"a_projected_pos",components:3,type:"Float32"}],4);yn([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const q$=yn([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"},{name:"a_box_real",components:2,type:"Int16"}]);yn([{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Int16",name:"x1"},{type:"Int16",name:"y1"},{type:"Int16",name:"x2"},{type:"Int16",name:"y2"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const hk=yn([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),H$=yn([{name:"a_pos",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);function Z$(h,o,u){return h.sections.forEach(f=>{f.text=function(g,b,S){const C=b.layout.get("text-transform").evaluate(S,{});return C==="uppercase"?g=g.toLocaleUpperCase():C==="lowercase"&&(g=g.toLocaleLowerCase()),ja.applyArabicShaping&&(g=ja.applyArabicShaping(g)),g}(f.text,o,u)}),h}yn([{name:"triangle",components:3,type:"Uint16"}]),yn([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"}]),yn([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",name:"textBoxScale"},{type:"Float32",name:"collisionCircleDiameter"},{type:"Uint16",name:"textAnchorOffsetStartIndex"},{type:"Uint16",name:"textAnchorOffsetEndIndex"}]),yn([{type:"Float32",name:"offsetX"}]),yn([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]),yn([{type:"Uint16",name:"textAnchor"},{type:"Float32",components:2,name:"textOffset"}]);const Mg={"!":"","#":"",$:"","%":"","&":"","(":"",")":"","*":"","+":"",",":"","-":"",".":"","/":"",":":"",";":"","<":"","=":"",">":"","?":"","@":"","[":"","\\":"","]":"","^":"",_:"","`":"","{":"","|":"","}":"","~":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":""};var ai=24;const ww=4294967296,dk=1/ww,fk=typeof TextDecoder>"u"?null:new TextDecoder("utf-8");class Sw{constructor(o=new Uint8Array(16)){this.buf=ArrayBuffer.isView(o)?o:new Uint8Array(o),this.dataView=new DataView(this.buf.buffer),this.pos=0,this.type=0,this.length=this.buf.length}readFields(o,u,f=this.length){for(;this.pos<f;){const g=this.readVarint(),b=g>>3,S=this.pos;this.type=7&g,o(b,u,this),this.pos===S&&this.skip(g)}return u}readMessage(o,u){return this.readFields(o,u,this.readVarint()+this.pos)}readFixed32(){const o=this.dataView.getUint32(this.pos,!0);return this.pos+=4,o}readSFixed32(){const o=this.dataView.getInt32(this.pos,!0);return this.pos+=4,o}readFixed64(){const o=this.dataView.getUint32(this.pos,!0)+this.dataView.getUint32(this.pos+4,!0)*ww;return this.pos+=8,o}readSFixed64(){const o=this.dataView.getUint32(this.pos,!0)+this.dataView.getInt32(this.pos+4,!0)*ww;return this.pos+=8,o}readFloat(){const o=this.dataView.getFloat32(this.pos,!0);return this.pos+=4,o}readDouble(){const o=this.dataView.getFloat64(this.pos,!0);return this.pos+=8,o}readVarint(o){const u=this.buf;let f,g;return g=u[this.pos++],f=127&g,g<128?f:(g=u[this.pos++],f|=(127&g)<<7,g<128?f:(g=u[this.pos++],f|=(127&g)<<14,g<128?f:(g=u[this.pos++],f|=(127&g)<<21,g<128?f:(g=u[this.pos],f|=(15&g)<<28,function(b,S,C){const k=C.buf;let N,F;if(F=k[C.pos++],N=(112&F)>>4,F<128||(F=k[C.pos++],N|=(127&F)<<3,F<128)||(F=k[C.pos++],N|=(127&F)<<10,F<128)||(F=k[C.pos++],N|=(127&F)<<17,F<128)||(F=k[C.pos++],N|=(127&F)<<24,F<128)||(F=k[C.pos++],N|=(1&F)<<31,F<128))return If(b,N,S);throw new Error("Expected varint not more than 10 bytes")}(f,o,this)))))}readVarint64(){return this.readVarint(!0)}readSVarint(){const o=this.readVarint();return o%2==1?(o+1)/-2:o/2}readBoolean(){return!!this.readVarint()}readString(){const o=this.readVarint()+this.pos,u=this.pos;return this.pos=o,o-u>=12&&fk?fk.decode(this.buf.subarray(u,o)):function(f,g,b){let S="",C=g;for(;C<b;){const k=f[C];let N,F,G,Y=null,J=k>239?4:k>223?3:k>191?2:1;if(C+J>b)break;J===1?k<128&&(Y=k):J===2?(N=f[C+1],(192&N)==128&&(Y=(31&k)<<6|63&N,Y<=127&&(Y=null))):J===3?(N=f[C+1],F=f[C+2],(192&N)==128&&(192&F)==128&&(Y=(15&k)<<12|(63&N)<<6|63&F,(Y<=2047||Y>=55296&&Y<=57343)&&(Y=null))):J===4&&(N=f[C+1],F=f[C+2],G=f[C+3],(192&N)==128&&(192&F)==128&&(192&G)==128&&(Y=(15&k)<<18|(63&N)<<12|(63&F)<<6|63&G,(Y<=65535||Y>=1114112)&&(Y=null))),Y===null?(Y=65533,J=1):Y>65535&&(Y-=65536,S+=String.fromCharCode(Y>>>10&1023|55296),Y=56320|1023&Y),S+=String.fromCharCode(Y),C+=J}return S}(this.buf,u,o)}readBytes(){const o=this.readVarint()+this.pos,u=this.buf.subarray(this.pos,o);return this.pos=o,u}readPackedVarint(o=[],u){const f=this.readPackedEnd();for(;this.pos<f;)o.push(this.readVarint(u));return o}readPackedSVarint(o=[]){const u=this.readPackedEnd();for(;this.pos<u;)o.push(this.readSVarint());return o}readPackedBoolean(o=[]){const u=this.readPackedEnd();for(;this.pos<u;)o.push(this.readBoolean());return o}readPackedFloat(o=[]){const u=this.readPackedEnd();for(;this.pos<u;)o.push(this.readFloat());return o}readPackedDouble(o=[]){const u=this.readPackedEnd();for(;this.pos<u;)o.push(this.readDouble());return o}readPackedFixed32(o=[]){const u=this.readPackedEnd();for(;this.pos<u;)o.push(this.readFixed32());return o}readPackedSFixed32(o=[]){const u=this.readPackedEnd();for(;this.pos<u;)o.push(this.readSFixed32());return o}readPackedFixed64(o=[]){const u=this.readPackedEnd();for(;this.pos<u;)o.push(this.readFixed64());return o}readPackedSFixed64(o=[]){const u=this.readPackedEnd();for(;this.pos<u;)o.push(this.readSFixed64());return o}readPackedEnd(){return this.type===2?this.readVarint()+this.pos:this.pos+1}skip(o){const u=7&o;if(u===0)for(;this.buf[this.pos++]>127;);else if(u===2)this.pos=this.readVarint()+this.pos;else if(u===5)this.pos+=4;else{if(u!==1)throw new Error(`Unimplemented type: ${u}`);this.pos+=8}}writeTag(o,u){this.writeVarint(o<<3|u)}realloc(o){let u=this.length||16;for(;u<this.pos+o;)u*=2;if(u!==this.length){const f=new Uint8Array(u);f.set(this.buf),this.buf=f,this.dataView=new DataView(f.buffer),this.length=u}}finish(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)}writeFixed32(o){this.realloc(4),this.dataView.setInt32(this.pos,o,!0),this.pos+=4}writeSFixed32(o){this.realloc(4),this.dataView.setInt32(this.pos,o,!0),this.pos+=4}writeFixed64(o){this.realloc(8),this.dataView.setInt32(this.pos,-1&o,!0),this.dataView.setInt32(this.pos+4,Math.floor(o*dk),!0),this.pos+=8}writeSFixed64(o){this.realloc(8),this.dataView.setInt32(this.pos,-1&o,!0),this.dataView.setInt32(this.pos+4,Math.floor(o*dk),!0),this.pos+=8}writeVarint(o){(o=+o||0)>268435455||o<0?function(u,f){let g,b;if(u>=0?(g=u%4294967296|0,b=u/4294967296|0):(g=~(-u%4294967296),b=~(-u/4294967296),4294967295^g?g=g+1|0:(g=0,b=b+1|0)),u>=18446744073709552e3||u<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");f.realloc(10),function(S,C,k){k.buf[k.pos++]=127&S|128,S>>>=7,k.buf[k.pos++]=127&S|128,S>>>=7,k.buf[k.pos++]=127&S|128,S>>>=7,k.buf[k.pos++]=127&S|128,k.buf[k.pos]=127&(S>>>=7)}(g,0,f),function(S,C){const k=(7&S)<<4;C.buf[C.pos++]|=k|((S>>>=3)?128:0),S&&(C.buf[C.pos++]=127&S|((S>>>=7)?128:0),S&&(C.buf[C.pos++]=127&S|((S>>>=7)?128:0),S&&(C.buf[C.pos++]=127&S|((S>>>=7)?128:0),S&&(C.buf[C.pos++]=127&S|((S>>>=7)?128:0),S&&(C.buf[C.pos++]=127&S)))))}(b,f)}(o,this):(this.realloc(4),this.buf[this.pos++]=127&o|(o>127?128:0),o<=127||(this.buf[this.pos++]=127&(o>>>=7)|(o>127?128:0),o<=127||(this.buf[this.pos++]=127&(o>>>=7)|(o>127?128:0),o<=127||(this.buf[this.pos++]=o>>>7&127))))}writeSVarint(o){this.writeVarint(o<0?2*-o-1:2*o)}writeBoolean(o){this.writeVarint(+o)}writeString(o){o=String(o),this.realloc(4*o.length),this.pos++;const u=this.pos;this.pos=function(g,b,S){for(let C,k,N=0;N<b.length;N++){if(C=b.charCodeAt(N),C>55295&&C<57344){if(!k){C>56319||N+1===b.length?(g[S++]=239,g[S++]=191,g[S++]=189):k=C;continue}if(C<56320){g[S++]=239,g[S++]=191,g[S++]=189,k=C;continue}C=k-55296<<10|C-56320|65536,k=null}else k&&(g[S++]=239,g[S++]=191,g[S++]=189,k=null);C<128?g[S++]=C:(C<2048?g[S++]=C>>6|192:(C<65536?g[S++]=C>>12|224:(g[S++]=C>>18|240,g[S++]=C>>12&63|128),g[S++]=C>>6&63|128),g[S++]=63&C|128)}return S}(this.buf,o,this.pos);const f=this.pos-u;f>=128&&pk(u,f,this),this.pos=u-1,this.writeVarint(f),this.pos+=f}writeFloat(o){this.realloc(4),this.dataView.setFloat32(this.pos,o,!0),this.pos+=4}writeDouble(o){this.realloc(8),this.dataView.setFloat64(this.pos,o,!0),this.pos+=8}writeBytes(o){const u=o.length;this.writeVarint(u),this.realloc(u);for(let f=0;f<u;f++)this.buf[this.pos++]=o[f]}writeRawMessage(o,u){this.pos++;const f=this.pos;o(u,this);const g=this.pos-f;g>=128&&pk(f,g,this),this.pos=f-1,this.writeVarint(g),this.pos+=g}writeMessage(o,u,f){this.writeTag(o,2),this.writeRawMessage(u,f)}writePackedVarint(o,u){u.length&&this.writeMessage(o,K$,u)}writePackedSVarint(o,u){u.length&&this.writeMessage(o,X$,u)}writePackedBoolean(o,u){u.length&&this.writeMessage(o,J$,u)}writePackedFloat(o,u){u.length&&this.writeMessage(o,Y$,u)}writePackedDouble(o,u){u.length&&this.writeMessage(o,Q$,u)}writePackedFixed32(o,u){u.length&&this.writeMessage(o,e8,u)}writePackedSFixed32(o,u){u.length&&this.writeMessage(o,t8,u)}writePackedFixed64(o,u){u.length&&this.writeMessage(o,r8,u)}writePackedSFixed64(o,u){u.length&&this.writeMessage(o,n8,u)}writeBytesField(o,u){this.writeTag(o,2),this.writeBytes(u)}writeFixed32Field(o,u){this.writeTag(o,5),this.writeFixed32(u)}writeSFixed32Field(o,u){this.writeTag(o,5),this.writeSFixed32(u)}writeFixed64Field(o,u){this.writeTag(o,1),this.writeFixed64(u)}writeSFixed64Field(o,u){this.writeTag(o,1),this.writeSFixed64(u)}writeVarintField(o,u){this.writeTag(o,0),this.writeVarint(u)}writeSVarintField(o,u){this.writeTag(o,0),this.writeSVarint(u)}writeStringField(o,u){this.writeTag(o,2),this.writeString(u)}writeFloatField(o,u){this.writeTag(o,5),this.writeFloat(u)}writeDoubleField(o,u){this.writeTag(o,1),this.writeDouble(u)}writeBooleanField(o,u){this.writeVarintField(o,+u)}}function If(h,o,u){return u?4294967296*o+(h>>>0):4294967296*(o>>>0)+(h>>>0)}function pk(h,o,u){const f=o<=16383?1:o<=2097151?2:o<=268435455?3:Math.floor(Math.log(o)/(7*Math.LN2));u.realloc(f);for(let g=u.pos-1;g>=h;g--)u.buf[g+f]=u.buf[g]}function K$(h,o){for(let u=0;u<h.length;u++)o.writeVarint(h[u])}function X$(h,o){for(let u=0;u<h.length;u++)o.writeSVarint(h[u])}function Y$(h,o){for(let u=0;u<h.length;u++)o.writeFloat(h[u])}function Q$(h,o){for(let u=0;u<h.length;u++)o.writeDouble(h[u])}function J$(h,o){for(let u=0;u<h.length;u++)o.writeBoolean(h[u])}function e8(h,o){for(let u=0;u<h.length;u++)o.writeFixed32(h[u])}function t8(h,o){for(let u=0;u<h.length;u++)o.writeSFixed32(h[u])}function r8(h,o){for(let u=0;u<h.length;u++)o.writeFixed64(h[u])}function n8(h,o){for(let u=0;u<h.length;u++)o.writeSFixed64(h[u])}function i8(h,o,u){h===1&&u.readMessage(s8,o)}function s8(h,o,u){if(h===3){const{id:f,bitmap:g,width:b,height:S,left:C,top:k,advance:N}=u.readMessage(o8,{});o.push({id:f,bitmap:new bg({width:b+6,height:S+6},g),metrics:{width:b,height:S,left:C,top:k,advance:N}})}}function o8(h,o,u){h===1?o.id=u.readVarint():h===2?o.bitmap=u.readBytes():h===3?o.width=u.readVarint():h===4?o.height=u.readVarint():h===5?o.left=u.readSVarint():h===6?o.top=u.readSVarint():h===7&&(o.advance=u.readVarint())}function mk(h){let o=0,u=0;for(const S of h)o+=S.w*S.h,u=Math.max(u,S.w);h.sort((S,C)=>C.h-S.h);const f=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(o/.95)),u),h:1/0}];let g=0,b=0;for(const S of h)for(let C=f.length-1;C>=0;C--){const k=f[C];if(!(S.w>k.w||S.h>k.h)){if(S.x=k.x,S.y=k.y,b=Math.max(b,S.y+S.h),g=Math.max(g,S.x+S.w),S.w===k.w&&S.h===k.h){const N=f.pop();N&&C<f.length&&(f[C]=N)}else S.h===k.h?(k.x+=S.w,k.w-=S.w):S.w===k.w?(k.y+=S.h,k.h-=S.h):(f.push({x:k.x+S.w,y:k.y,w:k.w-S.w,h:S.h}),k.y+=S.h,k.h-=S.h);break}}return{w:g,h:b,fill:o/(g*b)||0}}class Tw{constructor(o,{pixelRatio:u,version:f,stretchX:g,stretchY:b,content:S,textFitWidth:C,textFitHeight:k}){this.paddedRect=o,this.pixelRatio=u,this.stretchX=g,this.stretchY=b,this.content=S,this.version=f,this.textFitWidth=C,this.textFitHeight=k}get tl(){return[this.paddedRect.x+1,this.paddedRect.y+1]}get br(){return[this.paddedRect.x+this.paddedRect.w-1,this.paddedRect.y+this.paddedRect.h-1]}get tlbr(){return this.tl.concat(this.br)}get displaySize(){return[(this.paddedRect.w-2)/this.pixelRatio,(this.paddedRect.h-2)/this.pixelRatio]}}class gk{constructor(o,u){const f={},g={};this.haveRenderCallbacks=[];const b=[];this.addImages(o,f,b),this.addImages(u,g,b);const{w:S,h:C}=mk(b),k=new ws({width:S||1,height:C||1});for(const N in o){const F=o[N],G=f[N].paddedRect;ws.copy(F.data,k,{x:0,y:0},{x:G.x+1,y:G.y+1},F.data)}for(const N in u){const F=u[N],G=g[N].paddedRect,Y=G.x+1,J=G.y+1,re=F.data.width,le=F.data.height;ws.copy(F.data,k,{x:0,y:0},{x:Y,y:J},F.data),ws.copy(F.data,k,{x:0,y:le-1},{x:Y,y:J-1},{width:re,height:1}),ws.copy(F.data,k,{x:0,y:0},{x:Y,y:J+le},{width:re,height:1}),ws.copy(F.data,k,{x:re-1,y:0},{x:Y-1,y:J},{width:1,height:le}),ws.copy(F.data,k,{x:0,y:0},{x:Y+re,y:J},{width:1,height:le})}this.image=k,this.iconPositions=f,this.patternPositions=g}addImages(o,u,f){for(const g in o){const b=o[g],S={x:0,y:0,w:b.data.width+2,h:b.data.height+2};f.push(S),u[g]=new Tw(S,b),b.hasRenderCallback&&this.haveRenderCallbacks.push(g)}}patchUpdatedImages(o,u){o.dispatchRenderCallbacks(this.haveRenderCallbacks);for(const f in o.updatedImages)this.patchUpdatedImage(this.iconPositions[f],o.getImage(f),u),this.patchUpdatedImage(this.patternPositions[f],o.getImage(f),u)}patchUpdatedImage(o,u,f){if(!o||!u||o.version===u.version)return;o.version=u.version;const[g,b]=o.tl;f.update(u.data,void 0,{x:g,y:b})}}var Fc;xt("ImagePosition",Tw),xt("ImageAtlas",gk),l.ao=void 0,(Fc=l.ao||(l.ao={}))[Fc.none=0]="none",Fc[Fc.horizontal=1]="horizontal",Fc[Fc.vertical=2]="vertical",Fc[Fc.horizontalOnly=3]="horizontalOnly";class Ig{constructor(){this.scale=1,this.fontStack="",this.imageName=null,this.verticalAlign="bottom"}static forText(o,u,f){const g=new Ig;return g.scale=o||1,g.fontStack=u,g.verticalAlign=f||"bottom",g}static forImage(o,u){const f=new Ig;return f.imageName=o,f.verticalAlign=u||"bottom",f}}class Rf{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(o,u){const f=new Rf;for(let g=0;g<o.sections.length;g++){const b=o.sections[g];b.image?f.addImageSection(b):f.addTextSection(b,u)}return f}length(){return this.text.length}getSection(o){return this.sections[this.sectionIndex[o]]}getSectionIndex(o){return this.sectionIndex[o]}getCharCode(o){return this.text.charCodeAt(o)}verticalizePunctuation(){this.text=function(o){let u="";for(let f=0;f<o.length;f++){const g=o.charCodeAt(f+1)||null,b=o.charCodeAt(f-1)||null;u+=g&&U_(g)&&!Mg[o[f+1]]||b&&U_(b)&&!Mg[o[f-1]]||!Mg[o[f]]?o[f]:Mg[o[f]]}return u}(this.text)}trim(){let o=0;for(let f=0;f<this.text.length&&av[this.text.charCodeAt(f)];f++)o++;let u=this.text.length;for(let f=this.text.length-1;f>=0&&f>=o&&av[this.text.charCodeAt(f)];f--)u--;this.text=this.text.substring(o,u),this.sectionIndex=this.sectionIndex.slice(o,u)}substring(o,u){const f=new Rf;return f.text=this.text.substring(o,u),f.sectionIndex=this.sectionIndex.slice(o,u),f.sections=this.sections,f}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce((o,u)=>Math.max(o,this.sections[u].scale),0)}getMaxImageSize(o){let u=0,f=0;for(let g=0;g<this.length();g++){const b=this.getSection(g);if(b.imageName){const S=o[b.imageName];if(!S)continue;const C=S.displaySize;u=Math.max(u,C[0]),f=Math.max(f,C[1])}}return{maxImageWidth:u,maxImageHeight:f}}addTextSection(o,u){this.text+=o.text,this.sections.push(Ig.forText(o.scale,o.fontStack||u,o.verticalAlign));const f=this.sections.length-1;for(let g=0;g<o.text.length;++g)this.sectionIndex.push(f)}addImageSection(o){const u=o.image?o.image.name:"";if(u.length===0)return void Rt("Can't add FormattedSection with an empty image.");const f=this.getNextImageSectionCharCode();f?(this.text+=String.fromCharCode(f),this.sections.push(Ig.forImage(u,o.verticalAlign)),this.sectionIndex.push(this.sections.length-1)):Rt("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function ov(h,o,u,f,g,b,S,C,k,N,F,G,Y,J,re){const le=Rf.fromFeature(h,g);let pe;G===l.ao.vertical&&le.verticalizePunctuation();const{processBidirectionalText:be,processStyledBidirectionalText:Fe}=ja;if(be&&le.sections.length===1){pe=[];const Ue=be(le.toString(),Ew(le,N,b,o,f,J));for(const Ke of Ue){const it=new Rf;it.text=Ke,it.sections=le.sections;for(let yt=0;yt<Ke.length;yt++)it.sectionIndex.push(0);pe.push(it)}}else if(Fe){pe=[];const Ue=Fe(le.text,le.sectionIndex,Ew(le,N,b,o,f,J));for(const Ke of Ue){const it=new Rf;it.text=Ke[0],it.sectionIndex=Ke[1],it.sections=le.sections,pe.push(it)}}else pe=function(Ue,Ke){const it=[],yt=Ue.text;let ht=0;for(const pt of Ke)it.push(Ue.substring(ht,pt)),ht=pt;return ht<yt.length&&it.push(Ue.substring(ht,yt.length)),it}(le,Ew(le,N,b,o,f,J));const ke=[],De={positionedLines:ke,text:le.toString(),top:F[1],bottom:F[1],left:F[0],right:F[0],writingMode:G,iconsInText:!1,verticalizable:!1};return function(Ue,Ke,it,yt,ht,pt,Ot,ft,mt,et,Vt,Ut){let jt=0,Mt=0,fr=0,hn=0;const Kn=ft==="right"?1:ft==="left"?0:.5,Oi=ai/Ut;let ho=0;for(const on of ht){on.trim();const li=on.getMaxScale(),Ci={positionedGlyphs:[],lineOffset:0};Ue.positionedLines[ho]=Ci;const Pi=Ci.positionedGlyphs;let ss=0;if(!on.length()){Mt+=pt,++ho;continue}const fo=u8(yt,on,Oi);for(let Ts=0;Ts<on.length();Ts++){const Xn=on.getSection(Ts),ui=on.getSectionIndex(Ts),hi=on.getCharCode(Ts),jn=h8(mt,Vt,hi);let Hr;if(Xn.imageName){if(Ue.iconsInText=!0,Xn.scale=Xn.scale*Oi,Hr=f8(Xn,jn,li,fo,yt),!Hr)continue;ss=Math.max(ss,Hr.imageOffset)}else if(Hr=d8(Xn,hi,jn,fo,Ke,it),!Hr)continue;const{rect:aa,metrics:zf,baselineOffset:la}=Hr;Pi.push({glyph:hi,imageName:Xn.imageName,x:jt,y:Mt+la+-17,vertical:jn,scale:Xn.scale,fontStack:Xn.fontStack,sectionIndex:ui,metrics:zf,rect:aa}),jn?(Ue.verticalizable=!0,jt+=(Xn.imageName?zf.advance:ai)*Xn.scale+et):jt+=zf.advance*Xn.scale+et}Pi.length!==0&&(fr=Math.max(jt-et,fr),p8(Pi,0,Pi.length-1,Kn)),jt=0,Ci.lineOffset=Math.max(ss,(li-1)*ai);const ci=pt*li+ss;Mt+=ci,hn=Math.max(ci,hn),++ho}const{horizontalAlign:Ss,verticalAlign:Ei}=Cw(Ot);(function(on,li,Ci,Pi,ss,fo,ci,Ts,Xn){const ui=(li-Ci)*ss;let hi=0;hi=fo!==ci?-Ts*Pi- -17:-Pi*Xn*ci+.5*ci;for(const jn of on)for(const Hr of jn.positionedGlyphs)Hr.x+=ui,Hr.y+=hi})(Ue.positionedLines,Kn,Ss,Ei,fr,hn,pt,Mt,ht.length),Ue.top+=-Ei*Mt,Ue.bottom=Ue.top+Mt,Ue.left+=-Ss*fr,Ue.right=Ue.left+fr}(De,o,u,f,pe,S,C,k,G,N,Y,re),!function(Ue){for(const Ke of Ue)if(Ke.positionedGlyphs.length!==0)return!1;return!0}(ke)&&De}const av={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},a8={10:!0,32:!0,38:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0},l8={40:!0};function yk(h,o,u,f,g,b){if(o.imageName){const S=f[o.imageName];return S?S.displaySize[0]*o.scale*ai/b+g:0}{const S=u[o.fontStack],C=S&&S[h];return C?C.metrics.advance*o.scale+g:0}}function _k(h,o,u,f){const g=Math.pow(h-o,2);return f?h<o?g/2:2*g:g+Math.abs(u)*u}function c8(h,o,u){let f=0;return h===10&&(f-=1e4),u&&(f+=150),h!==40&&h!==65288||(f+=50),o!==41&&o!==65289||(f+=50),f}function vk(h,o,u,f,g,b){let S=null,C=_k(o,u,g,b);for(const k of f){const N=_k(o-k.x,u,g,b)+k.badness;N<=C&&(S=k,C=N)}return{index:h,x:o,priorBreak:S,badness:C}}function xk(h){return h?xk(h.priorBreak).concat(h.index):[]}function Ew(h,o,u,f,g,b){if(!h)return[];const S=[],C=function(G,Y,J,re,le,pe){let be=0;for(let Fe=0;Fe<G.length();Fe++){const ke=G.getSection(Fe);be+=yk(G.getCharCode(Fe),ke,re,le,Y,pe)}return be/Math.max(1,Math.ceil(be/J))}(h,o,u,f,g,b),k=h.text.indexOf("")>=0;let N=0;for(let G=0;G<h.length();G++){const Y=h.getSection(G),J=h.getCharCode(G);if(av[J]||(N+=yk(J,Y,f,g,o,b)),G<h.length()-1){const re=!((F=J)<11904)&&(!!cr["CJK Compatibility Forms"](F)||!!cr["CJK Compatibility"](F)||!!cr["CJK Strokes"](F)||!!cr["CJK Symbols and Punctuation"](F)||!!cr["Enclosed CJK Letters and Months"](F)||!!cr["Halfwidth and Fullwidth Forms"](F)||!!cr["Ideographic Description Characters"](F)||!!cr["Vertical Forms"](F)||V_.test(String.fromCodePoint(F)));(a8[J]||re||Y.imageName||G!==h.length()-2&&l8[h.getCharCode(G+1)])&&S.push(vk(G+1,N,C,S,c8(J,h.getCharCode(G+1),re&&k),!1))}}var F;return xk(vk(h.length(),N,C,S,0,!0))}function Cw(h){let o=.5,u=.5;switch(h){case"right":case"top-right":case"bottom-right":o=1;break;case"left":case"top-left":case"bottom-left":o=0}switch(h){case"bottom":case"bottom-right":case"bottom-left":u=1;break;case"top":case"top-right":case"top-left":u=0}return{horizontalAlign:o,verticalAlign:u}}function u8(h,o,u){const f=o.getMaxScale()*ai,{maxImageWidth:g,maxImageHeight:b}=o.getMaxImageSize(h),S=Math.max(f,b*u);return{verticalLineContentWidth:Math.max(f,g*u),horizontalLineContentHeight:S}}function bk(h){switch(h){case"top":return 0;case"center":return .5;default:return 1}}function h8(h,o,u){return!(h===l.ao.horizontal||!o&&!yf(u)||o&&(av[u]||(f=u,new RegExp("\\p{sc=Arab}","u").test(String.fromCodePoint(f)))));var f}function d8(h,o,u,f,g,b){const S=b[h.fontStack],C=function(N,F,G,Y){if(N&&N.rect)return N;const J=F[G.fontStack],re=J&&J[Y];return re?{rect:null,metrics:re.metrics}:null}(S&&S[o],g,h,o);if(C===null)return null;let k;if(u)k=f.verticalLineContentWidth-h.scale*ai;else{const N=bk(h.verticalAlign);k=(f.horizontalLineContentHeight-h.scale*ai)*N}return{rect:C.rect,metrics:C.metrics,baselineOffset:k}}function f8(h,o,u,f,g){const b=g[h.imageName];if(!b)return null;const S=b.paddedRect,C=b.displaySize,k={width:C[0],height:C[1],left:1,top:-3,advance:o?C[1]:C[0]};let N;if(o)N=f.verticalLineContentWidth-C[1]*h.scale;else{const F=bk(h.verticalAlign);N=(f.horizontalLineContentHeight-C[1]*h.scale)*F}return{rect:S,metrics:k,baselineOffset:N,imageOffset:(o?C[0]:C[1])*h.scale-ai*u}}function p8(h,o,u,f){if(f===0)return;const g=h[u],b=(h[u].x+g.metrics.advance*g.scale)*f;for(let S=o;S<=u;S++)h[S].x-=b}function m8(h,o,u){const{horizontalAlign:f,verticalAlign:g}=Cw(u),b=o[0]-h.displaySize[0]*f,S=o[1]-h.displaySize[1]*g;return{image:h,top:S,bottom:S+h.displaySize[1],left:b,right:b+h.displaySize[0]}}function wk(h){var o,u;let f=h.left,g=h.top,b=h.right-f,S=h.bottom-g;const C=(o=h.image.textFitWidth)!==null&&o!==void 0?o:"stretchOrShrink",k=(u=h.image.textFitHeight)!==null&&u!==void 0?u:"stretchOrShrink",N=(h.image.content[2]-h.image.content[0])/(h.image.content[3]-h.image.content[1]);if(k==="proportional"){if(C==="stretchOnly"&&b/S<N||C==="proportional"){const F=Math.ceil(S*N);f*=F/b,b=F}}else if(C==="proportional"&&k==="stretchOnly"&&N!==0&&b/S>N){const F=Math.ceil(b/N);g*=F/S,S=F}return{x1:f,y1:g,x2:f+b,y2:g+S}}function Sk(h,o,u,f,g,b){const S=h.image;let C;if(S.content){const pe=S.content,be=S.pixelRatio||1;C=[pe[0]/be,pe[1]/be,S.displaySize[0]-pe[2]/be,S.displaySize[1]-pe[3]/be]}const k=o.left*b,N=o.right*b;let F,G,Y,J;u==="width"||u==="both"?(J=g[0]+k-f[3],G=g[0]+N+f[1]):(J=g[0]+(k+N-S.displaySize[0])/2,G=J+S.displaySize[0]);const re=o.top*b,le=o.bottom*b;return u==="height"||u==="both"?(F=g[1]+re-f[0],Y=g[1]+le+f[2]):(F=g[1]+(re+le-S.displaySize[1])/2,Y=F+S.displaySize[1]),{image:S,top:F,right:G,bottom:Y,left:J,collisionPadding:C}}const jl=128,Bc=32640;function Tk(h,o){const{expression:u}=o;if(u.kind==="constant")return{kind:"constant",layoutSize:u.evaluate(new $r(h+1))};if(u.kind==="source")return{kind:"source"};{const{zoomStops:f,interpolationType:g}=u;let b=0;for(;b<f.length&&f[b]<=h;)b++;b=Math.max(0,b-1);let S=b;for(;S<f.length&&f[S]<h+1;)S++;S=Math.min(f.length-1,S);const C=f[b],k=f[S];return u.kind==="composite"?{kind:"composite",minZoom:C,maxZoom:k,interpolationType:g}:{kind:"camera",minZoom:C,maxZoom:k,minSize:u.evaluate(new $r(C)),maxSize:u.evaluate(new $r(k)),interpolationType:g}}}function Pw(h,o,u){let f="never";const g=h.get(o);return g?f=g:h.get(u)&&(f="always"),f}const g8=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function lv(h,o,u,f,g,b,S,C,k,N,F,G,Y){const J=C?Math.min(Bc,Math.round(C[0])):0,re=C?Math.min(Bc,Math.round(C[1])):0;h.emplaceBack(o,u,Math.round(32*f),Math.round(32*g),b,S,(J<<1)+(k?1:0),re,16*N,16*F,256*G,256*Y)}function Aw(h,o,u){h.emplaceBack(o.x,o.y,u),h.emplaceBack(o.x,o.y,u),h.emplaceBack(o.x,o.y,u),h.emplaceBack(o.x,o.y,u)}function y8(h){for(const o of h.sections)if(H_(o.text))return!0;return!1}class kw{constructor(o){this.layoutVertexArray=new ut,this.indexArray=new Ir,this.programConfigurations=o,this.segments=new gr,this.dynamicLayoutVertexArray=new tt,this.opacityVertexArray=new At,this.hasVisibleVertices=!1,this.placedSymbolArray=new ee}isEmpty(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0}upload(o,u,f,g){this.isEmpty()||(f&&(this.layoutVertexBuffer=o.createVertexBuffer(this.layoutVertexArray,G$.members),this.indexBuffer=o.createIndexBuffer(this.indexArray,u),this.dynamicLayoutVertexBuffer=o.createVertexBuffer(this.dynamicLayoutVertexArray,W$.members,!0),this.opacityVertexBuffer=o.createVertexBuffer(this.opacityVertexArray,g8,!0),this.opacityVertexBuffer.itemSize=1),(f||g)&&this.programConfigurations.upload(o))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())}}xt("SymbolBuffers",kw);class Mw{constructor(o,u,f){this.layoutVertexArray=new o,this.layoutAttributes=u,this.indexArray=new f,this.segments=new gr,this.collisionVertexArray=new Mr}upload(o){this.layoutVertexBuffer=o.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=o.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=o.createVertexBuffer(this.collisionVertexArray,q$.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy())}}xt("CollisionBuffers",Mw);class Df{constructor(o){this.collisionBoxArray=o.collisionBoxArray,this.zoom=o.zoom,this.overscaling=Kr(globalThis)?Math.min(o.overscaling,128):o.overscaling,this.layers=o.layers,this.layerIds=this.layers.map(S=>S.id),this.index=o.index,this.pixelRatio=o.pixelRatio,this.sourceLayerIndex=o.sourceLayerIndex,this.hasDependencies=!1,this.hasRTLText=!1,this.sortKeyRanges=[],this.collisionCircleArray=[];const u=this.layers[0]._unevaluatedLayout._values;this.textSizeData=Tk(this.zoom,u["text-size"]),this.iconSizeData=Tk(this.zoom,u["icon-size"]);const f=this.layers[0].layout,g=f.get("symbol-sort-key"),b=f.get("symbol-z-order");this.canOverlap=Pw(f,"text-overlap","text-allow-overlap")!=="never"||Pw(f,"icon-overlap","icon-allow-overlap")!=="never"||f.get("text-ignore-placement")||f.get("icon-ignore-placement"),this.sortFeaturesByKey=b!=="viewport-y"&&!g.isConstant(),this.sortFeaturesByY=(b==="viewport-y"||b==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,f.get("symbol-placement")==="point"&&(this.writingModes=f.get("text-writing-mode").map(S=>l.ao[S])),this.stateDependentLayerIds=this.layers.filter(S=>S.isStateDependent()).map(S=>S.id),this.sourceID=o.sourceID}createArrays(){this.text=new kw(new Wa(this.layers,this.zoom,o=>/^text/.test(o))),this.icon=new kw(new Wa(this.layers,this.zoom,o=>/^icon/.test(o))),this.glyphOffsetArray=new ge,this.lineVertexArray=new _e,this.symbolInstances=new me,this.textAnchorOffsets=new Ce}calculateGlyphDependencies(o,u,f,g,b){for(let S=0;S<o.length;S++)if(u[o.charCodeAt(S)]=!0,(f||g)&&b){const C=Mg[o.charAt(S)];C&&(u[C.charCodeAt(0)]=!0)}}populate(o,u,f){const g=this.layers[0],b=g.layout,S=b.get("text-font"),C=b.get("text-field"),k=b.get("icon-image"),N=(C.value.kind!=="constant"||C.value.value instanceof rs&&!C.value.value.isEmpty()||C.value.value.toString().length>0)&&(S.value.kind!=="constant"||S.value.value.length>0),F=k.value.kind!=="constant"||!!k.value.value||Object.keys(k.parameters).length>0,G=b.get("symbol-sort-key");if(this.features=[],!N&&!F)return;const Y=u.iconDependencies,J=u.glyphDependencies,re=u.availableImages,le=new $r(this.zoom);for(const{feature:pe,id:be,index:Fe,sourceLayerIndex:ke}of o){const De=g._featureFilter.needGeometry,Ue=Th(pe,De);if(!g._featureFilter.filter(le,Ue,f))continue;let Ke,it;if(De||(Ue.geometry=Sh(pe)),N){const ht=g.getValueAndResolveTokens("text-field",Ue,f,re),pt=rs.factory(ht),Ot=this.hasRTLText=this.hasRTLText||y8(pt);(!Ot||ja.getRTLTextPluginStatus()==="unavailable"||Ot&&ja.isParsed())&&(Ke=Z$(pt,g,Ue))}if(F){const ht=g.getValueAndResolveTokens("icon-image",Ue,f,re);it=ht instanceof _s?ht:_s.fromString(ht)}if(!Ke&&!it)continue;const yt=this.sortFeaturesByKey?G.evaluate(Ue,{},f):void 0;if(this.features.push({id:be,text:Ke,icon:it,index:Fe,sourceLayerIndex:ke,geometry:Ue.geometry,properties:pe.properties,type:Mf.types[pe.type],sortKey:yt}),it&&(Y[it.name]=!0),Ke){const ht=S.evaluate(Ue,{},f).join(","),pt=b.get("text-rotation-alignment")!=="viewport"&&b.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(l.ao.vertical)>=0;for(const Ot of Ke.sections)if(Ot.image)Y[Ot.image.name]=!0;else{const ft=mf(Ke.toString()),mt=Ot.fontStack||ht,et=J[mt]=J[mt]||{};this.calculateGlyphDependencies(Ot.text,et,pt,this.allowVerticalPlacement,ft)}}}b.get("symbol-placement")==="line"&&(this.features=function(pe){const be={},Fe={},ke=[];let De=0;function Ue(ht){ke.push(pe[ht]),De++}function Ke(ht,pt,Ot){const ft=Fe[ht];return delete Fe[ht],Fe[pt]=ft,ke[ft].geometry[0].pop(),ke[ft].geometry[0]=ke[ft].geometry[0].concat(Ot[0]),ft}function it(ht,pt,Ot){const ft=be[pt];return delete be[pt],be[ht]=ft,ke[ft].geometry[0].shift(),ke[ft].geometry[0]=Ot[0].concat(ke[ft].geometry[0]),ft}function yt(ht,pt,Ot){const ft=Ot?pt[0][pt[0].length-1]:pt[0][0];return`${ht}:${ft.x}:${ft.y}`}for(let ht=0;ht<pe.length;ht++){const pt=pe[ht],Ot=pt.geometry,ft=pt.text?pt.text.toString():null;if(!ft){Ue(ht);continue}const mt=yt(ft,Ot),et=yt(ft,Ot,!0);if(mt in Fe&&et in be&&Fe[mt]!==be[et]){const Vt=it(mt,et,Ot),Ut=Ke(mt,et,ke[Vt].geometry);delete be[mt],delete Fe[et],Fe[yt(ft,ke[Ut].geometry,!0)]=Ut,ke[Vt].geometry=null}else mt in Fe?Ke(mt,et,Ot):et in be?it(mt,et,Ot):(Ue(ht),be[mt]=De-1,Fe[et]=De-1)}return ke.filter(ht=>ht.geometry)}(this.features)),this.sortFeaturesByKey&&this.features.sort((pe,be)=>pe.sortKey-be.sortKey)}update(o,u,f){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(o,u,this.layers,{imagePositions:f}),this.icon.programConfigurations.updatePaintArrays(o,u,this.layers,{imagePositions:f}))}isEmpty(){return this.symbolInstances.length===0&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(o){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(o),this.iconCollisionBox.upload(o)),this.text.upload(o,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(o,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(o,u){const f=this.lineVertexArray.length;if(o.segment!==void 0){let g=o.dist(u[o.segment+1]),b=o.dist(u[o.segment]);const S={};for(let C=o.segment+1;C<u.length;C++)S[C]={x:u[C].x,y:u[C].y,tileUnitDistanceFromAnchor:g},C<u.length-1&&(g+=u[C+1].dist(u[C]));for(let C=o.segment||0;C>=0;C--)S[C]={x:u[C].x,y:u[C].y,tileUnitDistanceFromAnchor:b},C>0&&(b+=u[C-1].dist(u[C]));for(let C=0;C<u.length;C++){const k=S[C];this.lineVertexArray.emplaceBack(k.x,k.y,k.tileUnitDistanceFromAnchor)}}return{lineStartIndex:f,lineLength:this.lineVertexArray.length-f}}addSymbols(o,u,f,g,b,S,C,k,N,F,G,Y){const J=o.indexArray,re=o.layoutVertexArray,le=o.segments.prepareSegment(4*u.length,re,J,this.canOverlap?S.sortKey:void 0),pe=this.glyphOffsetArray.length,be=le.vertexLength,Fe=this.allowVerticalPlacement&&C===l.ao.vertical?Math.PI/2:0,ke=S.text&&S.text.sections;for(let De=0;De<u.length;De++){const{tl:Ue,tr:Ke,bl:it,br:yt,tex:ht,pixelOffsetTL:pt,pixelOffsetBR:Ot,minFontScaleX:ft,minFontScaleY:mt,glyphOffset:et,isSDF:Vt,sectionIndex:Ut}=u[De],jt=le.vertexLength,Mt=et[1];lv(re,k.x,k.y,Ue.x,Mt+Ue.y,ht.x,ht.y,f,Vt,pt.x,pt.y,ft,mt),lv(re,k.x,k.y,Ke.x,Mt+Ke.y,ht.x+ht.w,ht.y,f,Vt,Ot.x,pt.y,ft,mt),lv(re,k.x,k.y,it.x,Mt+it.y,ht.x,ht.y+ht.h,f,Vt,pt.x,Ot.y,ft,mt),lv(re,k.x,k.y,yt.x,Mt+yt.y,ht.x+ht.w,ht.y+ht.h,f,Vt,Ot.x,Ot.y,ft,mt),Aw(o.dynamicLayoutVertexArray,k,Fe),J.emplaceBack(jt,jt+2,jt+1),J.emplaceBack(jt+1,jt+2,jt+3),le.vertexLength+=4,le.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(et[0]),De!==u.length-1&&Ut===u[De+1].sectionIndex||o.programConfigurations.populatePaintArrays(re.length,S,S.index,{imagePositions:{},canonical:Y,formattedSection:ke&&ke[Ut]})}o.placedSymbolArray.emplaceBack(k.x,k.y,pe,this.glyphOffsetArray.length-pe,be,N,F,k.segment,f?f[0]:0,f?f[1]:0,g[0],g[1],C,0,!1,0,G)}_addCollisionDebugVertex(o,u,f,g,b,S){return u.emplaceBack(0,0),o.emplaceBack(f.x,f.y,g,b,Math.round(S.x),Math.round(S.y))}addCollisionDebugVertices(o,u,f,g,b,S,C){const k=b.segments.prepareSegment(4,b.layoutVertexArray,b.indexArray),N=k.vertexLength,F=b.layoutVertexArray,G=b.collisionVertexArray,Y=C.anchorX,J=C.anchorY;this._addCollisionDebugVertex(F,G,S,Y,J,new m(o,u)),this._addCollisionDebugVertex(F,G,S,Y,J,new m(f,u)),this._addCollisionDebugVertex(F,G,S,Y,J,new m(f,g)),this._addCollisionDebugVertex(F,G,S,Y,J,new m(o,g)),k.vertexLength+=4;const re=b.indexArray;re.emplaceBack(N,N+1),re.emplaceBack(N+1,N+2),re.emplaceBack(N+2,N+3),re.emplaceBack(N+3,N),k.primitiveLength+=4}addDebugCollisionBoxes(o,u,f,g){for(let b=o;b<u;b++){const S=this.collisionBoxArray.get(b);this.addCollisionDebugVertices(S.x1,S.y1,S.x2,S.y2,g?this.textCollisionBox:this.iconCollisionBox,S.anchorPoint,f)}}generateCollisionDebugBuffers(){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new Mw(qt,hk.members,Fr),this.iconCollisionBox=new Mw(qt,hk.members,Fr);for(let o=0;o<this.symbolInstances.length;o++){const u=this.symbolInstances.get(o);this.addDebugCollisionBoxes(u.textBoxStartIndex,u.textBoxEndIndex,u,!0),this.addDebugCollisionBoxes(u.verticalTextBoxStartIndex,u.verticalTextBoxEndIndex,u,!0),this.addDebugCollisionBoxes(u.iconBoxStartIndex,u.iconBoxEndIndex,u,!1),this.addDebugCollisionBoxes(u.verticalIconBoxStartIndex,u.verticalIconBoxEndIndex,u,!1)}}_deserializeCollisionBoxesForSymbol(o,u,f,g,b,S,C,k,N){const F={};for(let G=u;G<f;G++){const Y=o.get(G);F.textBox={x1:Y.x1,y1:Y.y1,x2:Y.x2,y2:Y.y2,anchorPointX:Y.anchorPointX,anchorPointY:Y.anchorPointY},F.textFeatureIndex=Y.featureIndex;break}for(let G=g;G<b;G++){const Y=o.get(G);F.verticalTextBox={x1:Y.x1,y1:Y.y1,x2:Y.x2,y2:Y.y2,anchorPointX:Y.anchorPointX,anchorPointY:Y.anchorPointY},F.verticalTextFeatureIndex=Y.featureIndex;break}for(let G=S;G<C;G++){const Y=o.get(G);F.iconBox={x1:Y.x1,y1:Y.y1,x2:Y.x2,y2:Y.y2,anchorPointX:Y.anchorPointX,anchorPointY:Y.anchorPointY},F.iconFeatureIndex=Y.featureIndex;break}for(let G=k;G<N;G++){const Y=o.get(G);F.verticalIconBox={x1:Y.x1,y1:Y.y1,x2:Y.x2,y2:Y.y2,anchorPointX:Y.anchorPointX,anchorPointY:Y.anchorPointY},F.verticalIconFeatureIndex=Y.featureIndex;break}return F}deserializeCollisionBoxes(o){this.collisionArrays=[];for(let u=0;u<this.symbolInstances.length;u++){const f=this.symbolInstances.get(u);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(o,f.textBoxStartIndex,f.textBoxEndIndex,f.verticalTextBoxStartIndex,f.verticalTextBoxEndIndex,f.iconBoxStartIndex,f.iconBoxEndIndex,f.verticalIconBoxStartIndex,f.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}addIndicesForPlacedSymbol(o,u){const f=o.placedSymbolArray.get(u),g=f.vertexStartIndex+4*f.numGlyphs;for(let b=f.vertexStartIndex;b<g;b+=4)o.indexArray.emplaceBack(b,b+2,b+1),o.indexArray.emplaceBack(b+1,b+2,b+3)}getSortedSymbolIndexes(o){if(this.sortedAngle===o&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;const u=Math.sin(o),f=Math.cos(o),g=[],b=[],S=[];for(let C=0;C<this.symbolInstances.length;++C){S.push(C);const k=this.symbolInstances.get(C);g.push(0|Math.round(u*k.anchorX+f*k.anchorY)),b.push(k.featureIndex)}return S.sort((C,k)=>g[C]-g[k]||b[k]-b[C]),S}addToSortKeyRanges(o,u){const f=this.sortKeyRanges[this.sortKeyRanges.length-1];f&&f.sortKey===u?f.symbolInstanceEnd=o+1:this.sortKeyRanges.push({sortKey:u,symbolInstanceStart:o,symbolInstanceEnd:o+1})}sortFeatures(o){if(this.sortFeaturesByY&&this.sortedAngle!==o&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(o),this.sortedAngle=o,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const u of this.symbolInstanceIndexes){const f=this.symbolInstances.get(u);this.featureSortOrder.push(f.featureIndex),[f.rightJustifiedTextSymbolIndex,f.centerJustifiedTextSymbolIndex,f.leftJustifiedTextSymbolIndex].forEach((g,b,S)=>{g>=0&&S.indexOf(g)===b&&this.addIndicesForPlacedSymbol(this.text,g)}),f.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,f.verticalPlacedTextSymbolIndex),f.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,f.placedIconSymbolIndex),f.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,f.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}let Ek,Ck;xt("SymbolBucket",Df,{omit:["layers","collisionBoxArray","features","compareText"]}),Df.MAX_GLYPHS=65535,Df.addDynamicAttributes=Aw;var Iw={get paint(){return Ck=Ck||new Hi({"icon-opacity":new Bt(je.paint_symbol["icon-opacity"]),"icon-color":new Bt(je.paint_symbol["icon-color"]),"icon-halo-color":new Bt(je.paint_symbol["icon-halo-color"]),"icon-halo-width":new Bt(je.paint_symbol["icon-halo-width"]),"icon-halo-blur":new Bt(je.paint_symbol["icon-halo-blur"]),"icon-translate":new kt(je.paint_symbol["icon-translate"]),"icon-translate-anchor":new kt(je.paint_symbol["icon-translate-anchor"]),"text-opacity":new Bt(je.paint_symbol["text-opacity"]),"text-color":new Bt(je.paint_symbol["text-color"],{runtimeType:Vi,getOverride:h=>h.textColor,hasOverride:h=>!!h.textColor}),"text-halo-color":new Bt(je.paint_symbol["text-halo-color"]),"text-halo-width":new Bt(je.paint_symbol["text-halo-width"]),"text-halo-blur":new Bt(je.paint_symbol["text-halo-blur"]),"text-translate":new kt(je.paint_symbol["text-translate"]),"text-translate-anchor":new kt(je.paint_symbol["text-translate-anchor"])})},get layout(){return Ek=Ek||new Hi({"symbol-placement":new kt(je.layout_symbol["symbol-placement"]),"symbol-spacing":new kt(je.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new kt(je.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new Bt(je.layout_symbol["symbol-sort-key"]),"symbol-z-order":new kt(je.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new kt(je.layout_symbol["icon-allow-overlap"]),"icon-overlap":new kt(je.layout_symbol["icon-overlap"]),"icon-ignore-placement":new kt(je.layout_symbol["icon-ignore-placement"]),"icon-optional":new kt(je.layout_symbol["icon-optional"]),"icon-rotation-alignment":new kt(je.layout_symbol["icon-rotation-alignment"]),"icon-size":new Bt(je.layout_symbol["icon-size"]),"icon-text-fit":new kt(je.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new kt(je.layout_symbol["icon-text-fit-padding"]),"icon-image":new Bt(je.layout_symbol["icon-image"]),"icon-rotate":new Bt(je.layout_symbol["icon-rotate"]),"icon-padding":new Bt(je.layout_symbol["icon-padding"]),"icon-keep-upright":new kt(je.layout_symbol["icon-keep-upright"]),"icon-offset":new Bt(je.layout_symbol["icon-offset"]),"icon-anchor":new Bt(je.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new kt(je.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new kt(je.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new kt(je.layout_symbol["text-rotation-alignment"]),"text-field":new Bt(je.layout_symbol["text-field"]),"text-font":new Bt(je.layout_symbol["text-font"]),"text-size":new Bt(je.layout_symbol["text-size"]),"text-max-width":new Bt(je.layout_symbol["text-max-width"]),"text-line-height":new kt(je.layout_symbol["text-line-height"]),"text-letter-spacing":new Bt(je.layout_symbol["text-letter-spacing"]),"text-justify":new Bt(je.layout_symbol["text-justify"]),"text-radial-offset":new Bt(je.layout_symbol["text-radial-offset"]),"text-variable-anchor":new kt(je.layout_symbol["text-variable-anchor"]),"text-variable-anchor-offset":new Bt(je.layout_symbol["text-variable-anchor-offset"]),"text-anchor":new Bt(je.layout_symbol["text-anchor"]),"text-max-angle":new kt(je.layout_symbol["text-max-angle"]),"text-writing-mode":new kt(je.layout_symbol["text-writing-mode"]),"text-rotate":new Bt(je.layout_symbol["text-rotate"]),"text-padding":new kt(je.layout_symbol["text-padding"]),"text-keep-upright":new kt(je.layout_symbol["text-keep-upright"]),"text-transform":new Bt(je.layout_symbol["text-transform"]),"text-offset":new Bt(je.layout_symbol["text-offset"]),"text-allow-overlap":new kt(je.layout_symbol["text-allow-overlap"]),"text-overlap":new kt(je.layout_symbol["text-overlap"]),"text-ignore-placement":new kt(je.layout_symbol["text-ignore-placement"]),"text-optional":new kt(je.layout_symbol["text-optional"])})}};class Pk{constructor(o){if(o.property.overrides===void 0)throw new Error("overrides must be provided to instantiate FormatSectionOverride class");this.type=o.property.overrides?o.property.overrides.runtimeType:Tn,this.defaultValue=o}evaluate(o){if(o.formattedSection){const u=this.defaultValue.property.overrides;if(u&&u.hasOverride(o.formattedSection))return u.getOverride(o.formattedSection)}return o.feature&&o.featureState?this.defaultValue.evaluate(o.feature,o.featureState):this.defaultValue.property.specification.default}eachChild(o){this.defaultValue.isConstant()||o(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}xt("FormatSectionOverride",Pk,{omit:["defaultValue"]});class cv extends ao{constructor(o,u){super(o,Iw,u)}recalculate(o,u){if(super.recalculate(o,u),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")==="map"?"map":"viewport"),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment")),this.layout.get("symbol-placement")==="point"){const f=this.layout.get("text-writing-mode");if(f){const g=[];for(const b of f)g.indexOf(b)<0&&g.push(b);this.layout._values["text-writing-mode"]=g}else this.layout._values["text-writing-mode"]=["horizontal"]}this._setPaintOverrides()}getValueAndResolveTokens(o,u,f,g){const b=this.layout.get(o).evaluate(u,{},f,g),S=this._unevaluatedLayout._values[o];return S.isDataDriven()||tf(S.value)||!b?b:function(C,k){return k.replace(/{([^{}]+)}/g,(N,F)=>C&&F in C?String(C[F]):"")}(u.properties,b)}createBucket(o){return new Df(o)}queryRadius(){return 0}queryIntersectsFeature(){throw new Error("Should take a different path in FeatureIndex")}_setPaintOverrides(){for(const o of Iw.paint.overridableProperties){if(!cv.hasPaintOverride(this.layout,o))continue;const u=this.paint.get(o),f=new Pk(u),g=new Qm(f,u.property.specification);let b=null;b=u.value.kind==="constant"||u.value.kind==="source"?new nf("source",g):new sf("composite",g,u.value.zoomStops),this.paint._values[o]=new Lo(u.property,b,u.parameters)}}_handleOverridablePaintPropertyUpdate(o,u,f){return!(!this.layout||u.isDataDriven()||f.isDataDriven())&&cv.hasPaintOverride(this.layout,o)}static hasPaintOverride(o,u){const f=o.get("text-field"),g=Iw.paint.properties[u];let b=!1;const S=C=>{for(const k of C)if(g.overrides&&g.overrides.hasOverride(k))return void(b=!0)};if(f.value.kind==="constant"&&f.value.value instanceof rs)S(f.value.value.sections);else if(f.value.kind==="source"||f.value.kind==="composite"){const C=N=>{b||(N instanceof Wt&&un(N.value)===Wn?S(N.value.sections):N instanceof Ud?S(N.sections):N.eachChild(C))},k=f.value;k._styleExpression&&C(k._styleExpression.expression)}return b}}let Ak;var _8={get paint(){return Ak=Ak||new Hi({"background-color":new kt(je.paint_background["background-color"]),"background-pattern":new X_(je.paint_background["background-pattern"]),"background-opacity":new kt(je.paint_background["background-opacity"])})}};class v8 extends ao{constructor(o,u){super(o,_8,u)}}class x8 extends ao{constructor(o,u){super(o,{},u),this.onAdd=f=>{this.implementation.onAdd&&this.implementation.onAdd(f,f.painter.context.gl)},this.onRemove=f=>{this.implementation.onRemove&&this.implementation.onRemove(f,f.painter.context.gl)},this.implementation=o}is3D(){return this.implementation.renderingMode==="3d"}hasOffscreenPass(){return this.implementation.prerender!==void 0}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){throw new Error("Custom layers cannot be serialized")}}class b8{constructor(o){this._methodToThrottle=o,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._methodToThrottle()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(()=>{this._triggered=!1,this._methodToThrottle()},0))}remove(){delete this._channel,this._methodToThrottle=()=>{}}}const w8={once:!0},Rw=63710088e-1;class $c{constructor(o,u){if(isNaN(o)||isNaN(u))throw new Error(`Invalid LngLat object: (${o}, ${u})`);if(this.lng=+o,this.lat=+u,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new $c(Pt(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(o){const u=Math.PI/180,f=this.lat*u,g=o.lat*u,b=Math.sin(f)*Math.sin(g)+Math.cos(f)*Math.cos(g)*Math.cos((o.lng-this.lng)*u);return Rw*Math.acos(Math.min(b,1))}static convert(o){if(o instanceof $c)return o;if(Array.isArray(o)&&(o.length===2||o.length===3))return new $c(Number(o[0]),Number(o[1]));if(!Array.isArray(o)&&typeof o=="object"&&o!==null)return new $c(Number("lng"in o?o.lng:o.lon),Number(o.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}const kk=2*Math.PI*Rw;function Mk(h){return kk*Math.cos(h*Math.PI/180)}function Ik(h){return(180+h)/360}function Rk(h){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+h*Math.PI/360)))/360}function Dk(h,o){return h/Mk(o)}function Dw(h){return 360/Math.PI*Math.atan(Math.exp((180-360*h)*Math.PI/180))-90}function Lk(h,o){return h*Mk(Dw(o))}class Rg{constructor(o,u,f=0){this.x=+o,this.y=+u,this.z=+f}static fromLngLat(o,u=0){const f=$c.convert(o);return new Rg(Ik(f.lng),Rk(f.lat),Dk(u,f.lat))}toLngLat(){return new $c(360*this.x-180,Dw(this.y))}toAltitude(){return Lk(this.z,this.y)}meterInMercatorCoordinateUnits(){return 1/kk*(o=Dw(this.y),1/Math.cos(o*Math.PI/180));var o}}function Ok(h,o,u){var f=2*Math.PI*6378137/256/Math.pow(2,u);return[h*f-2*Math.PI*6378137/2,o*f-2*Math.PI*6378137/2]}class Lw{constructor(o,u,f){if(!function(g,b,S){return!(g<0||g>25||S<0||S>=Math.pow(2,g)||b<0||b>=Math.pow(2,g))}(o,u,f))throw new Error(`x=${u}, y=${f}, z=${o} outside of bounds. 0<=x<${Math.pow(2,o)}, 0<=y<${Math.pow(2,o)} 0<=z<=25 `);this.z=o,this.x=u,this.y=f,this.key=Lf(0,o,o,u,f)}equals(o){return this.z===o.z&&this.x===o.x&&this.y===o.y}url(o,u,f){const g=(S=this.y,C=this.z,k=Ok(256*(b=this.x),256*(S=Math.pow(2,C)-S-1),C),N=Ok(256*(b+1),256*(S+1),C),k[0]+","+k[1]+","+N[0]+","+N[1]);var b,S,C,k,N;const F=function(G,Y,J){let re,le="";for(let pe=G;pe>0;pe--)re=1<<pe-1,le+=(Y&re?1:0)+(J&re?2:0);return le}(this.z,this.x,this.y);return o[(this.x+this.y)%o.length].replace(/{prefix}/g,(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String(f==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace(/{ratio}/g,u>1?"@2x":"").replace(/{quadkey}/g,F).replace(/{bbox-epsg-3857}/g,g)}isChildOf(o){const u=this.z-o.z;return u>0&&o.x===this.x>>u&&o.y===this.y>>u}getTilePoint(o){const u=Math.pow(2,this.z);return new m((o.x*u-this.x)*ve,(o.y*u-this.y)*ve)}toString(){return`${this.z}/${this.x}/${this.y}`}}class zk{constructor(o,u){this.wrap=o,this.canonical=u,this.key=Lf(o,u.z,u.z,u.x,u.y)}}class uo{constructor(o,u,f,g,b){if(this.terrainRttPosMatrix32f=null,o<f)throw new Error(`overscaledZ should be >= z; overscaledZ = ${o}; z = ${f}`);this.overscaledZ=o,this.wrap=u,this.canonical=new Lw(f,+g,+b),this.key=Lf(u,o,f,g,b)}clone(){return new uo(this.overscaledZ,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)}equals(o){return this.overscaledZ===o.overscaledZ&&this.wrap===o.wrap&&this.canonical.equals(o.canonical)}scaledTo(o){if(o>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${o}; overscaledZ = ${this.overscaledZ}`);const u=this.canonical.z-o;return o>this.canonical.z?new uo(o,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new uo(o,this.wrap,o,this.canonical.x>>u,this.canonical.y>>u)}isOverscaled(){return this.overscaledZ>this.canonical.z}calculateScaledKey(o,u){if(o>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${o}; overscaledZ = ${this.overscaledZ}`);const f=this.canonical.z-o;return o>this.canonical.z?Lf(this.wrap*+u,o,this.canonical.z,this.canonical.x,this.canonical.y):Lf(this.wrap*+u,o,o,this.canonical.x>>f,this.canonical.y>>f)}isChildOf(o){if(o.wrap!==this.wrap||this.overscaledZ-o.overscaledZ<=0)return!1;if(o.overscaledZ===0)return this.overscaledZ>0;const u=this.canonical.z-o.canonical.z;return!(u<0)&&o.canonical.x===this.canonical.x>>u&&o.canonical.y===this.canonical.y>>u}children(o){if(this.overscaledZ>=o)return[new uo(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const u=this.canonical.z+1,f=2*this.canonical.x,g=2*this.canonical.y;return[new uo(u,this.wrap,u,f,g),new uo(u,this.wrap,u,f+1,g),new uo(u,this.wrap,u,f,g+1),new uo(u,this.wrap,u,f+1,g+1)]}isLessThan(o){return this.wrap<o.wrap||!(this.wrap>o.wrap)&&(this.overscaledZ<o.overscaledZ||!(this.overscaledZ>o.overscaledZ)&&(this.canonical.x<o.canonical.x||!(this.canonical.x>o.canonical.x)&&this.canonical.y<o.canonical.y))}wrapped(){return new uo(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(o){return new uo(this.overscaledZ,o,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new zk(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}getTilePoint(o){return this.canonical.getTilePoint(new Rg(o.x-this.wrap,o.y))}}function Lf(h,o,u,f,g){(h*=2)<0&&(h=-1*h-1);const b=1<<u;return(b*b*h+b*g+f).toString(36)+u.toString(36)+o.toString(36)}function Dg(h,o){return o?h.properties[o]:h.id}xt("CanonicalTileID",Lw),xt("OverscaledTileID",uo,{omit:["terrainRttPosMatrix32f"]});class Ph{constructor(){this.minX=1/0,this.maxX=-1/0,this.minY=1/0,this.maxY=-1/0}extend(o){return this.minX=Math.min(this.minX,o.x),this.minY=Math.min(this.minY,o.y),this.maxX=Math.max(this.maxX,o.x),this.maxY=Math.max(this.maxY,o.y),this}expandBy(o){return this.minX-=o,this.minY-=o,this.maxX+=o,this.maxY+=o,(this.minX>this.maxX||this.minY>this.maxY)&&(this.minX=1/0,this.maxX=-1/0,this.minY=1/0,this.maxY=-1/0),this}shrinkBy(o){return this.expandBy(-o)}map(o){const u=new Ph;return u.extend(o(new m(this.minX,this.minY))),u.extend(o(new m(this.maxX,this.minY))),u.extend(o(new m(this.minX,this.maxY))),u.extend(o(new m(this.maxX,this.maxY))),u}static fromPoints(o){const u=new Ph;for(const f of o)u.extend(f);return u}contains(o){return o.x>=this.minX&&o.x<=this.maxX&&o.y>=this.minY&&o.y<=this.maxY}empty(){return this.minX>this.maxX}width(){return this.maxX-this.minX}height(){return this.maxY-this.minY}covers(o){return!this.empty()&&!o.empty()&&o.minX>=this.minX&&o.maxX<=this.maxX&&o.minY>=this.minY&&o.maxY<=this.maxY}intersects(o){return!this.empty()&&!o.empty()&&o.minX<=this.maxX&&o.maxX>=this.minX&&o.minY<=this.maxY&&o.maxY>=this.minY}}class Nk{constructor(o){this._stringToNumber={},this._numberToString=[];for(let u=0;u<o.length;u++){const f=o[u];this._stringToNumber[f]=u,this._numberToString[u]=f}}encode(o){return this._stringToNumber[o]}decode(o){if(o>=this._numberToString.length)throw new Error(`Out of bounds. Index requested n=${o} can't be >= this._numberToString.length ${this._numberToString.length}`);return this._numberToString[o]}}class jk{constructor(o,u,f,g,b){this.type="Feature",this._vectorTileFeature=o,o._z=u,o._x=f,o._y=g,this.properties=o.properties,this.id=b}get geometry(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x,this._vectorTileFeature._y,this._vectorTileFeature._z).geometry),this._geometry}set geometry(o){this._geometry=o}toJSON(){const o={geometry:this.geometry};for(const u in this)u!=="_geometry"&&u!=="_vectorTileFeature"&&(o[u]=this[u]);return o}}class Fk{constructor(o,u){this.tileID=o,this.x=o.canonical.x,this.y=o.canonical.y,this.z=o.canonical.z,this.grid=new mh(ve,16,0),this.grid3D=new mh(ve,16,0),this.featureIndexArray=new Ie,this.promoteId=u}insert(o,u,f,g,b,S){const C=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(f,g,b);const k=S?this.grid3D:this.grid;for(let N=0;N<u.length;N++){const F=u[N],G=[1/0,1/0,-1/0,-1/0];for(let Y=0;Y<F.length;Y++){const J=F[Y];G[0]=Math.min(G[0],J.x),G[1]=Math.min(G[1],J.y),G[2]=Math.max(G[2],J.x),G[3]=Math.max(G[3],J.y)}G[0]<ve&&G[1]<ve&&G[2]>=0&&G[3]>=0&&k.insert(C,G[0],G[1],G[2],G[3])}}loadVTLayers(){return this.vtLayers||(this.vtLayers=new rk(new Sw(this.rawTileData)).layers,this.sourceLayerCoder=new Nk(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"])),this.vtLayers}query(o,u,f,g){this.loadVTLayers();const b=o.params,S=ve/o.tileSize/o.scale,C=uh(b.filter,b.globalState),k=o.queryGeometry,N=o.queryPadding*S,F=Ph.fromPoints(k),G=this.grid.query(F.minX-N,F.minY-N,F.maxX+N,F.maxY+N),Y=Ph.fromPoints(o.cameraQueryGeometry).expandBy(N),J=this.grid3D.query(Y.minX,Y.minY,Y.maxX,Y.maxY,(pe,be,Fe,ke)=>function(De,Ue,Ke,it,yt){for(const pt of De)if(Ue<=pt.x&&Ke<=pt.y&&it>=pt.x&&yt>=pt.y)return!0;const ht=[new m(Ue,Ke),new m(Ue,yt),new m(it,yt),new m(it,Ke)];if(De.length>2){for(const pt of ht)if(Ef(De,pt))return!0}for(let pt=0;pt<De.length-1;pt++)if(Q6(De[pt],De[pt+1],ht))return!0;return!1}(o.cameraQueryGeometry,pe-N,be-N,Fe+N,ke+N));for(const pe of J)G.push(pe);G.sort(S8);const re={};let le;for(let pe=0;pe<G.length;pe++){const be=G[pe];if(be===le)continue;le=be;const Fe=this.featureIndexArray.get(be);let ke=null;this.loadMatchingFeature(re,Fe.bucketIndex,Fe.sourceLayerIndex,Fe.featureIndex,C,b.layers,b.availableImages,u,f,g,(De,Ue,Ke)=>(ke||(ke=Sh(De)),Ue.queryIntersectsFeature({queryGeometry:k,feature:De,featureState:Ke,geometry:ke,zoom:this.z,transform:o.transform,pixelsToTileUnits:S,pixelPosMatrix:o.pixelPosMatrix,unwrappedTileID:this.tileID.toUnwrapped(),getElevation:o.getElevation})))}return re}loadMatchingFeature(o,u,f,g,b,S,C,k,N,F,G){const Y=this.bucketLayerIDs[u];if(S&&!Y.some(pe=>S.has(pe)))return;const J=this.sourceLayerCoder.decode(f),re=this.vtLayers[J].feature(g);if(b.needGeometry){const pe=Th(re,!0);if(!b.filter(new $r(this.tileID.overscaledZ),pe,this.tileID.canonical))return}else if(!b.filter(new $r(this.tileID.overscaledZ),re))return;const le=this.getId(re,J);for(let pe=0;pe<Y.length;pe++){const be=Y[pe];if(S&&!S.has(be))continue;const Fe=k[be];if(!Fe)continue;let ke={};le&&F&&(ke=F.getState(Fe.sourceLayer||"_geojsonTileLayer",le));const De=Ht({},N[be]);De.paint=Bk(De.paint,Fe.paint,re,ke,C),De.layout=Bk(De.layout,Fe.layout,re,ke,C);const Ue=!G||G(re,Fe,ke);if(!Ue)continue;const Ke=new jk(re,this.z,this.x,this.y,le);Ke.layer=De;let it=o[be];it===void 0&&(it=o[be]=[]),it.push({featureIndex:g,feature:Ke,intersectionZ:Ue})}}lookupSymbolFeatures(o,u,f,g,b,S,C,k){const N={};this.loadVTLayers();const F=uh(b.filterSpec,b.globalState);for(const G of o)this.loadMatchingFeature(N,f,g,G,F,S,C,k,u);return N}hasLayer(o){for(const u of this.bucketLayerIDs)for(const f of u)if(o===f)return!0;return!1}getId(o,u){var f;let g=o.id;return this.promoteId&&(g=o.properties[typeof this.promoteId=="string"?this.promoteId:this.promoteId[u]],typeof g=="boolean"&&(g=Number(g)),g===void 0&&(!((f=o.properties)===null||f===void 0)&&f.cluster)&&this.promoteId&&(g=Number(o.properties.cluster_id))),g}}function Bk(h,o,u,f,g){return yr(h,(b,S)=>{const C=o instanceof vf?o.get(S):null;return C&&C.evaluate?C.evaluate(u,f,g):C})}function S8(h,o){return o-h}function $k(h,o,u,f,g){const b=[];for(let S=0;S<h.length;S++){const C=h[S];let k;for(let N=0;N<C.length-1;N++){let F=C[N],G=C[N+1];F.x<o&&G.x<o||(F.x<o?F=new m(o,F.y+(o-F.x)/(G.x-F.x)*(G.y-F.y))._round():G.x<o&&(G=new m(o,F.y+(o-F.x)/(G.x-F.x)*(G.y-F.y))._round()),F.y<u&&G.y<u||(F.y<u?F=new m(F.x+(u-F.y)/(G.y-F.y)*(G.x-F.x),u)._round():G.y<u&&(G=new m(F.x+(u-F.y)/(G.y-F.y)*(G.x-F.x),u)._round()),F.x>=f&&G.x>=f||(F.x>=f?F=new m(f,F.y+(f-F.x)/(G.x-F.x)*(G.y-F.y))._round():G.x>=f&&(G=new m(f,F.y+(f-F.x)/(G.x-F.x)*(G.y-F.y))._round()),F.y>=g&&G.y>=g||(F.y>=g?F=new m(F.x+(g-F.y)/(G.y-F.y)*(G.x-F.x),g)._round():G.y>=g&&(G=new m(F.x+(g-F.y)/(G.y-F.y)*(G.x-F.x),g)._round()),k&&F.equals(k[k.length-1])||(k=[F],b.push(k)),k.push(G)))))}}return b}xt("FeatureIndex",Fk,{omit:["rawTileData","sourceLayerCoder"]});class Vc extends m{constructor(o,u,f,g){super(o,u),this.angle=f,g!==void 0&&(this.segment=g)}clone(){return new Vc(this.x,this.y,this.angle,this.segment)}}function Vk(h,o,u,f,g){if(o.segment===void 0||u===0)return!0;let b=o,S=o.segment+1,C=0;for(;C>-u/2;){if(S--,S<0)return!1;C-=h[S].dist(b),b=h[S]}C+=h[S].dist(h[S+1]),S++;const k=[];let N=0;for(;C<u/2;){const F=h[S],G=h[S+1];if(!G)return!1;let Y=h[S-1].angleTo(F)-F.angleTo(G);for(Y=Math.abs((Y+3*Math.PI)%(2*Math.PI)-Math.PI),k.push({distance:C,angleDelta:Y}),N+=Y;C-k[0].distance>f;)N-=k.shift().angleDelta;if(N>g)return!1;S++,C+=F.dist(G)}return!0}function Uk(h){let o=0;for(let u=0;u<h.length-1;u++)o+=h[u].dist(h[u+1]);return o}function Gk(h,o,u){return h?.6*o*u:0}function Wk(h,o){return Math.max(h?h.right-h.left:0,o?o.right-o.left:0)}function T8(h,o,u,f,g,b){const S=Gk(u,g,b),C=Wk(u,f)*b;let k=0;const N=Uk(h)/2;for(let F=0;F<h.length-1;F++){const G=h[F],Y=h[F+1],J=G.dist(Y);if(k+J>N){const re=(N-k)/J,le=zs.number(G.x,Y.x,re),pe=zs.number(G.y,Y.y,re),be=new Vc(le,pe,Y.angleTo(G),F);return be._round(),!S||Vk(h,be,C,S,o)?be:void 0}k+=J}}function E8(h,o,u,f,g,b,S,C,k){const N=Gk(f,b,S),F=Wk(f,g),G=F*S,Y=h[0].x===0||h[0].x===k||h[0].y===0||h[0].y===k;return o-G<o/4&&(o=G+o/4),qk(h,Y?o/2*C%o:(F/2+2*b)*S*C%o,o,N,u,G,Y,!1,k)}function qk(h,o,u,f,g,b,S,C,k){const N=b/2,F=Uk(h);let G=0,Y=o-u,J=[];for(let re=0;re<h.length-1;re++){const le=h[re],pe=h[re+1],be=le.dist(pe),Fe=pe.angleTo(le);for(;Y+u<G+be;){Y+=u;const ke=(Y-G)/be,De=zs.number(le.x,pe.x,ke),Ue=zs.number(le.y,pe.y,ke);if(De>=0&&De<k&&Ue>=0&&Ue<k&&Y-N>=0&&Y+N<=F){const Ke=new Vc(De,Ue,Fe,re);Ke._round(),f&&!Vk(h,Ke,b,f,g)||J.push(Ke)}}G+=be}return C||J.length||S||(J=qk(h,G/2,u,f,g,b,S,!0,k)),J}function Hk(h,o,u,f){const g=[],b=h.image,S=b.pixelRatio,C=b.paddedRect.w-2,k=b.paddedRect.h-2;let N={x1:h.left,y1:h.top,x2:h.right,y2:h.bottom};const F=b.stretchX||[[0,C]],G=b.stretchY||[[0,k]],Y=(et,Vt)=>et+Vt[1]-Vt[0],J=F.reduce(Y,0),re=G.reduce(Y,0),le=C-J,pe=k-re;let be=0,Fe=J,ke=0,De=re,Ue=0,Ke=le,it=0,yt=pe;if(b.content&&f){const et=b.content,Vt=et[2]-et[0],Ut=et[3]-et[1];(b.textFitWidth||b.textFitHeight)&&(N=wk(h)),be=uv(F,0,et[0]),ke=uv(G,0,et[1]),Fe=uv(F,et[0],et[2]),De=uv(G,et[1],et[3]),Ue=et[0]-be,it=et[1]-ke,Ke=Vt-Fe,yt=Ut-De}const ht=N.x1,pt=N.y1,Ot=N.x2-ht,ft=N.y2-pt,mt=(et,Vt,Ut,jt)=>{const Mt=hv(et.stretch-be,Fe,Ot,ht),fr=dv(et.fixed-Ue,Ke,et.stretch,J),hn=hv(Vt.stretch-ke,De,ft,pt),Kn=dv(Vt.fixed-it,yt,Vt.stretch,re),Oi=hv(Ut.stretch-be,Fe,Ot,ht),ho=dv(Ut.fixed-Ue,Ke,Ut.stretch,J),Ss=hv(jt.stretch-ke,De,ft,pt),Ei=dv(jt.fixed-it,yt,jt.stretch,re),on=new m(Mt,hn),li=new m(Oi,hn),Ci=new m(Oi,Ss),Pi=new m(Mt,Ss),ss=new m(fr/S,Kn/S),fo=new m(ho/S,Ei/S),ci=o*Math.PI/180;if(ci){const ui=Math.sin(ci),hi=Math.cos(ci),jn=[hi,-ui,ui,hi];on._matMult(jn),li._matMult(jn),Pi._matMult(jn),Ci._matMult(jn)}const Ts=et.stretch+et.fixed,Xn=Vt.stretch+Vt.fixed;return{tl:on,tr:li,bl:Pi,br:Ci,tex:{x:b.paddedRect.x+1+Ts,y:b.paddedRect.y+1+Xn,w:Ut.stretch+Ut.fixed-Ts,h:jt.stretch+jt.fixed-Xn},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:ss,pixelOffsetBR:fo,minFontScaleX:Ke/S/Ot,minFontScaleY:yt/S/ft,isSDF:u}};if(f&&(b.stretchX||b.stretchY)){const et=Zk(F,le,J),Vt=Zk(G,pe,re);for(let Ut=0;Ut<et.length-1;Ut++){const jt=et[Ut],Mt=et[Ut+1];for(let fr=0;fr<Vt.length-1;fr++)g.push(mt(jt,Vt[fr],Mt,Vt[fr+1]))}}else g.push(mt({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:C+1},{fixed:0,stretch:k+1}));return g}function uv(h,o,u){let f=0;for(const g of h)f+=Math.max(o,Math.min(u,g[1]))-Math.max(o,Math.min(u,g[0]));return f}function Zk(h,o,u){const f=[{fixed:-1,stretch:0}];for(const[g,b]of h){const S=f[f.length-1];f.push({fixed:g-S.stretch,stretch:S.stretch}),f.push({fixed:g-S.stretch,stretch:S.stretch+(b-g)})}return f.push({fixed:o+1,stretch:u}),f}function hv(h,o,u,f){return h/o*u+f}function dv(h,o,u,f){return h-o*u/f}xt("Anchor",Vc);class fv{constructor(o,u,f,g,b,S,C,k,N,F){var G;if(this.boxStartIndex=o.length,N){let Y=S.top,J=S.bottom;const re=S.collisionPadding;re&&(Y-=re[1],J+=re[3]);let le=J-Y;le>0&&(le=Math.max(10,le),this.circleDiameter=le)}else{const Y=!((G=S.image)===null||G===void 0)&&G.content&&(S.image.textFitWidth||S.image.textFitHeight)?wk(S):{x1:S.left,y1:S.top,x2:S.right,y2:S.bottom};Y.y1=Y.y1*C-k[0],Y.y2=Y.y2*C+k[2],Y.x1=Y.x1*C-k[3],Y.x2=Y.x2*C+k[1];const J=S.collisionPadding;if(J&&(Y.x1-=J[0]*C,Y.y1-=J[1]*C,Y.x2+=J[2]*C,Y.y2+=J[3]*C),F){const re=new m(Y.x1,Y.y1),le=new m(Y.x2,Y.y1),pe=new m(Y.x1,Y.y2),be=new m(Y.x2,Y.y2),Fe=F*Math.PI/180;re._rotate(Fe),le._rotate(Fe),pe._rotate(Fe),be._rotate(Fe),Y.x1=Math.min(re.x,le.x,pe.x,be.x),Y.x2=Math.max(re.x,le.x,pe.x,be.x),Y.y1=Math.min(re.y,le.y,pe.y,be.y),Y.y2=Math.max(re.y,le.y,pe.y,be.y)}o.emplaceBack(u.x,u.y,Y.x1,Y.y1,Y.x2,Y.y2,f,g,b)}this.boxEndIndex=o.length}}class C8{constructor(o=[],u=(f,g)=>f<g?-1:f>g?1:0){if(this.data=o,this.length=this.data.length,this.compare=u,this.length>0)for(let f=(this.length>>1)-1;f>=0;f--)this._down(f)}push(o){this.data.push(o),this._up(this.length++)}pop(){if(this.length===0)return;const o=this.data[0],u=this.data.pop();return--this.length>0&&(this.data[0]=u,this._down(0)),o}peek(){return this.data[0]}_up(o){const{data:u,compare:f}=this,g=u[o];for(;o>0;){const b=o-1>>1,S=u[b];if(f(g,S)>=0)break;u[o]=S,o=b}u[o]=g}_down(o){const{data:u,compare:f}=this,g=this.length>>1,b=u[o];for(;o<g;){let S=1+(o<<1);const C=S+1;if(C<this.length&&f(u[C],u[S])<0&&(S=C),f(u[S],b)>=0)break;u[o]=u[S],o=S}u[o]=b}}function P8(h,o=1,u=!1){const f=Ph.fromPoints(h[0]),g=Math.min(f.width(),f.height());let b=g/2;const S=new C8([],A8),{minX:C,minY:k,maxX:N,maxY:F}=f;if(g===0)return new m(C,k);for(let J=C;J<N;J+=g)for(let re=k;re<F;re+=g)S.push(new Of(J+b,re+b,b,h));let G=function(J){let re=0,le=0,pe=0;const be=J[0];for(let Fe=0,ke=be.length,De=ke-1;Fe<ke;De=Fe++){const Ue=be[Fe],Ke=be[De],it=Ue.x*Ke.y-Ke.x*Ue.y;le+=(Ue.x+Ke.x)*it,pe+=(Ue.y+Ke.y)*it,re+=3*it}return new Of(le/re,pe/re,0,J)}(h),Y=S.length;for(;S.length;){const J=S.pop();(J.d>G.d||!G.d)&&(G=J,u&&console.log("found best %d after %d probes",Math.round(1e4*J.d)/1e4,Y)),J.max-G.d<=o||(b=J.h/2,S.push(new Of(J.p.x-b,J.p.y-b,b,h)),S.push(new Of(J.p.x+b,J.p.y-b,b,h)),S.push(new Of(J.p.x-b,J.p.y+b,b,h)),S.push(new Of(J.p.x+b,J.p.y+b,b,h)),Y+=4)}return u&&(console.log(`num probes: ${Y}`),console.log(`best distance: ${G.d}`)),G.p}function A8(h,o){return o.max-h.max}function Of(h,o,u,f){this.p=new m(h,o),this.h=u,this.d=function(g,b){let S=!1,C=1/0;for(let k=0;k<b.length;k++){const N=b[k];for(let F=0,G=N.length,Y=G-1;F<G;Y=F++){const J=N[F],re=N[Y];J.y>g.y!=re.y>g.y&&g.x<(re.x-J.x)*(g.y-J.y)/(re.y-J.y)+J.x&&(S=!S),C=Math.min(C,DA(g,J,re))}}return(S?1:-1)*Math.sqrt(C)}(this.p,f),this.max=this.d+this.h*Math.SQRT2}var Li;l.aE=void 0,(Li=l.aE||(l.aE={}))[Li.center=1]="center",Li[Li.left=2]="left",Li[Li.right=3]="right",Li[Li.top=4]="top",Li[Li.bottom=5]="bottom",Li[Li["top-left"]=6]="top-left",Li[Li["top-right"]=7]="top-right",Li[Li["bottom-left"]=8]="bottom-left",Li[Li["bottom-right"]=9]="bottom-right";const Ow=Number.POSITIVE_INFINITY;function Kk(h,o){return o[1]!==Ow?function(u,f,g){let b=0,S=0;switch(f=Math.abs(f),g=Math.abs(g),u){case"top-right":case"top-left":case"top":S=g-7;break;case"bottom-right":case"bottom-left":case"bottom":S=7-g}switch(u){case"top-right":case"bottom-right":case"right":b=-f;break;case"top-left":case"bottom-left":case"left":b=f}return[b,S]}(h,o[0],o[1]):function(u,f){let g=0,b=0;f<0&&(f=0);const S=f/Math.SQRT2;switch(u){case"top-right":case"top-left":b=S-7;break;case"bottom-right":case"bottom-left":b=7-S;break;case"bottom":b=7-f;break;case"top":b=f-7}switch(u){case"top-right":case"bottom-right":g=-S;break;case"top-left":case"bottom-left":g=S;break;case"left":g=f;break;case"right":g=-f}return[g,b]}(h,o[0])}function Xk(h,o,u){var f;const g=h.layout,b=(f=g.get("text-variable-anchor-offset"))===null||f===void 0?void 0:f.evaluate(o,{},u);if(b){const C=b.values,k=[];for(let N=0;N<C.length;N+=2){const F=k[N]=C[N],G=C[N+1].map(Y=>Y*ai);F.startsWith("top")?G[1]-=7:F.startsWith("bottom")&&(G[1]+=7),k[N+1]=G}return new qi(k)}const S=g.get("text-variable-anchor");if(S){let C;C=h._unevaluatedLayout.getValue("text-radial-offset")!==void 0?[g.get("text-radial-offset").evaluate(o,{},u)*ai,Ow]:g.get("text-offset").evaluate(o,{},u).map(N=>N*ai);const k=[];for(const N of S)k.push(N,Kk(N,C));return new qi(k)}return null}function zw(h){switch(h){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function k8(h,o,u,f,g,b,S,C,k,N,F,G){let Y=b.textMaxSize.evaluate(o,{});Y===void 0&&(Y=S);const J=h.layers[0].layout,re=J.get("icon-offset").evaluate(o,{},F),le=Qk(u.horizontal),pe=S/24,be=h.tilePixelRatio*pe,Fe=h.tilePixelRatio*Y/24,ke=h.tilePixelRatio*C,De=h.tilePixelRatio*J.get("symbol-spacing"),Ue=J.get("text-padding")*h.tilePixelRatio,Ke=function(Ut,jt,Mt,fr=1){const hn=Ut.get("icon-padding").evaluate(jt,{},Mt),Kn=hn&&hn.values;return[Kn[0]*fr,Kn[1]*fr,Kn[2]*fr,Kn[3]*fr]}(J,o,F,h.tilePixelRatio),it=J.get("text-max-angle")/180*Math.PI,yt=J.get("text-rotation-alignment")!=="viewport"&&J.get("symbol-placement")!=="point",ht=J.get("icon-rotation-alignment")==="map"&&J.get("symbol-placement")!=="point",pt=J.get("symbol-placement"),Ot=De/2,ft=J.get("icon-text-fit");let mt;f&&ft!=="none"&&(h.allowVerticalPlacement&&u.vertical&&(mt=Sk(f,u.vertical,ft,J.get("icon-text-fit-padding"),re,pe)),le&&(f=Sk(f,le,ft,J.get("icon-text-fit-padding"),re,pe)));const et=F?G.line.getGranularityForZoomLevel(F.z):1,Vt=(Ut,jt)=>{jt.x<0||jt.x>=ve||jt.y<0||jt.y>=ve||function(Mt,fr,hn,Kn,Oi,ho,Ss,Ei,on,li,Ci,Pi,ss,fo,ci,Ts,Xn,ui,hi,jn,Hr,aa,zf,la,R8){const Nf=Mt.addToLineVertexArray(fr,hn);let Ah,jf,Ff,Bf,rM=0,nM=0,iM=0,sM=0,Gw=-1,Ww=-1;const Fl={};let oM=jc("");if(Mt.allowVerticalPlacement&&Kn.vertical){const Ki=Ei.layout.get("text-rotate").evaluate(Hr,{},la)+90;Ff=new fv(on,fr,li,Ci,Pi,Kn.vertical,ss,fo,ci,Ki),Ss&&(Bf=new fv(on,fr,li,Ci,Pi,Ss,Xn,ui,ci,Ki))}if(Oi){const Ki=Ei.layout.get("icon-rotate").evaluate(Hr,{}),po=Ei.layout.get("icon-text-fit")!=="none",kh=Hk(Oi,Ki,zf,po),ua=Ss?Hk(Ss,Ki,zf,po):void 0;jf=new fv(on,fr,li,Ci,Pi,Oi,Xn,ui,!1,Ki),rM=4*kh.length;const Mh=Mt.iconSizeData;let qa=null;Mh.kind==="source"?(qa=[jl*Ei.layout.get("icon-size").evaluate(Hr,{})],qa[0]>Bc&&Rt(`${Mt.layerIds[0]}: Value for "icon-size" is >= 255. Reduce your "icon-size".`)):Mh.kind==="composite"&&(qa=[jl*aa.compositeIconSizes[0].evaluate(Hr,{},la),jl*aa.compositeIconSizes[1].evaluate(Hr,{},la)],(qa[0]>Bc||qa[1]>Bc)&&Rt(`${Mt.layerIds[0]}: Value for "icon-size" is >= 255. Reduce your "icon-size".`)),Mt.addSymbols(Mt.icon,kh,qa,jn,hi,Hr,l.ao.none,fr,Nf.lineStartIndex,Nf.lineLength,-1,la),Gw=Mt.icon.placedSymbolArray.length-1,ua&&(nM=4*ua.length,Mt.addSymbols(Mt.icon,ua,qa,jn,hi,Hr,l.ao.vertical,fr,Nf.lineStartIndex,Nf.lineLength,-1,la),Ww=Mt.icon.placedSymbolArray.length-1)}const aM=Object.keys(Kn.horizontal);for(const Ki of aM){const po=Kn.horizontal[Ki];if(!Ah){oM=jc(po.text);const ua=Ei.layout.get("text-rotate").evaluate(Hr,{},la);Ah=new fv(on,fr,li,Ci,Pi,po,ss,fo,ci,ua)}const kh=po.positionedLines.length===1;if(iM+=Yk(Mt,fr,po,ho,Ei,ci,Hr,Ts,Nf,Kn.vertical?l.ao.horizontal:l.ao.horizontalOnly,kh?aM:[Ki],Fl,Gw,aa,la),kh)break}Kn.vertical&&(sM+=Yk(Mt,fr,Kn.vertical,ho,Ei,ci,Hr,Ts,Nf,l.ao.vertical,["vertical"],Fl,Ww,aa,la));const D8=Ah?Ah.boxStartIndex:Mt.collisionBoxArray.length,L8=Ah?Ah.boxEndIndex:Mt.collisionBoxArray.length,O8=Ff?Ff.boxStartIndex:Mt.collisionBoxArray.length,z8=Ff?Ff.boxEndIndex:Mt.collisionBoxArray.length,N8=jf?jf.boxStartIndex:Mt.collisionBoxArray.length,j8=jf?jf.boxEndIndex:Mt.collisionBoxArray.length,F8=Bf?Bf.boxStartIndex:Mt.collisionBoxArray.length,B8=Bf?Bf.boxEndIndex:Mt.collisionBoxArray.length;let ca=-1;const mv=(Ki,po)=>Ki&&Ki.circleDiameter?Math.max(Ki.circleDiameter,po):po;ca=mv(Ah,ca),ca=mv(Ff,ca),ca=mv(jf,ca),ca=mv(Bf,ca);const lM=ca>-1?1:0;lM&&(ca*=R8/ai),Mt.glyphOffsetArray.length>=Df.MAX_GLYPHS&&Rt("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),Hr.sortKey!==void 0&&Mt.addToSortKeyRanges(Mt.symbolInstances.length,Hr.sortKey);const $8=Xk(Ei,Hr,la),[V8,U8]=function(Ki,po){const kh=Ki.length,ua=po==null?void 0:po.values;if((ua==null?void 0:ua.length)>0)for(let Mh=0;Mh<ua.length;Mh+=2){const qa=ua[Mh+1];Ki.emplaceBack(l.aE[ua[Mh]],qa[0],qa[1])}return[kh,Ki.length]}(Mt.textAnchorOffsets,$8);Mt.symbolInstances.emplaceBack(fr.x,fr.y,Fl.right>=0?Fl.right:-1,Fl.center>=0?Fl.center:-1,Fl.left>=0?Fl.left:-1,Fl.vertical||-1,Gw,Ww,oM,D8,L8,O8,z8,N8,j8,F8,B8,li,iM,sM,rM,nM,lM,0,ss,ca,V8,U8)}(h,jt,Ut,u,f,g,mt,h.layers[0],h.collisionBoxArray,o.index,o.sourceLayerIndex,h.index,be,[Ue,Ue,Ue,Ue],yt,k,ke,Ke,ht,re,o,b,N,F,S)};if(pt==="line")for(const Ut of $k(o.geometry,0,0,ve,ve)){const jt=Ch(Ut,et),Mt=E8(jt,De,it,u.vertical||le,f,24,Fe,h.overscaling,ve);for(const fr of Mt)le&&M8(h,le.text,Ot,fr)||Vt(jt,fr)}else if(pt==="line-center"){for(const Ut of o.geometry)if(Ut.length>1){const jt=Ch(Ut,et),Mt=T8(jt,it,u.vertical||le,f,24,Fe);Mt&&Vt(jt,Mt)}}else if(o.type==="Polygon")for(const Ut of Wd(o.geometry,0)){const jt=P8(Ut,16);Vt(Ch(Ut[0],et,!0),new Vc(jt.x,jt.y,0))}else if(o.type==="LineString")for(const Ut of o.geometry){const jt=Ch(Ut,et);Vt(jt,new Vc(jt[0].x,jt[0].y,0))}else if(o.type==="Point")for(const Ut of o.geometry)for(const jt of Ut)Vt([jt],new Vc(jt.x,jt.y,0))}function Yk(h,o,u,f,g,b,S,C,k,N,F,G,Y,J,re){const le=function(Fe,ke,De,Ue,Ke,it,yt,ht){const pt=Ue.layout.get("text-rotate").evaluate(it,{})*Math.PI/180,Ot=[];for(const ft of ke.positionedLines)for(const mt of ft.positionedGlyphs){if(!mt.rect)continue;const et=mt.rect||{};let Vt=4,Ut=!0,jt=1,Mt=0;const fr=(Ke||ht)&&mt.vertical,hn=mt.metrics.advance*mt.scale/2;if(ht&&ke.verticalizable&&(Mt=ft.lineOffset/2-(mt.imageName?-(ai-mt.metrics.width*mt.scale)/2:(mt.scale-1)*ai)),mt.imageName){const ui=yt[mt.imageName];Ut=ui.sdf,jt=ui.pixelRatio,Vt=1/jt}const Kn=Ke?[mt.x+hn,mt.y]:[0,0];let Oi=Ke?[0,0]:[mt.x+hn+De[0],mt.y+De[1]-Mt],ho=[0,0];fr&&(ho=Oi,Oi=[0,0]);const Ss=mt.metrics.isDoubleResolution?2:1,Ei=(mt.metrics.left-Vt)*mt.scale-hn+Oi[0],on=(-mt.metrics.top-Vt)*mt.scale+Oi[1],li=Ei+et.w/Ss*mt.scale/jt,Ci=on+et.h/Ss*mt.scale/jt,Pi=new m(Ei,on),ss=new m(li,on),fo=new m(Ei,Ci),ci=new m(li,Ci);if(fr){const ui=new m(-hn,hn- -17),hi=-Math.PI/2,jn=12-hn,Hr=new m(22-jn,-(mt.imageName?jn:0)),aa=new m(...ho);Pi._rotateAround(hi,ui)._add(Hr)._add(aa),ss._rotateAround(hi,ui)._add(Hr)._add(aa),fo._rotateAround(hi,ui)._add(Hr)._add(aa),ci._rotateAround(hi,ui)._add(Hr)._add(aa)}if(pt){const ui=Math.sin(pt),hi=Math.cos(pt),jn=[hi,-ui,ui,hi];Pi._matMult(jn),ss._matMult(jn),fo._matMult(jn),ci._matMult(jn)}const Ts=new m(0,0),Xn=new m(0,0);Ot.push({tl:Pi,tr:ss,bl:fo,br:ci,tex:et,writingMode:ke.writingMode,glyphOffset:Kn,sectionIndex:mt.sectionIndex,isSDF:Ut,pixelOffsetTL:Ts,pixelOffsetBR:Xn,minFontScaleX:0,minFontScaleY:0})}return Ot}(0,u,C,g,b,S,f,h.allowVerticalPlacement),pe=h.textSizeData;let be=null;pe.kind==="source"?(be=[jl*g.layout.get("text-size").evaluate(S,{})],be[0]>Bc&&Rt(`${h.layerIds[0]}: Value for "text-size" is >= 255. Reduce your "text-size".`)):pe.kind==="composite"&&(be=[jl*J.compositeTextSizes[0].evaluate(S,{},re),jl*J.compositeTextSizes[1].evaluate(S,{},re)],(be[0]>Bc||be[1]>Bc)&&Rt(`${h.layerIds[0]}: Value for "text-size" is >= 255. Reduce your "text-size".`)),h.addSymbols(h.text,le,be,C,b,S,N,o,k.lineStartIndex,k.lineLength,Y,re);for(const Fe of F)G[Fe]=h.text.placedSymbolArray.length-1;return 4*le.length}function Qk(h){for(const o in h)return h[o];return null}function M8(h,o,u,f){const g=h.compareText;if(o in g){const b=g[o];for(let S=b.length-1;S>=0;S--)if(f.dist(b[S])<u)return!0}else g[o]=[];return g[o].push(f),!1}const Jk=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array];class Nw{static from(o){if(!(o instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");const[u,f]=new Uint8Array(o,0,2);if(u!==219)throw new Error("Data does not appear to be in a KDBush format.");const g=f>>4;if(g!==1)throw new Error(`Got v${g} data when expected v1.`);const b=Jk[15&f];if(!b)throw new Error("Unrecognized array type.");const[S]=new Uint16Array(o,2,1),[C]=new Uint32Array(o,4,1);return new Nw(C,S,b,o)}constructor(o,u=64,f=Float64Array,g){if(isNaN(o)||o<0)throw new Error(`Unpexpected numItems value: ${o}.`);this.numItems=+o,this.nodeSize=Math.min(Math.max(+u,2),65535),this.ArrayType=f,this.IndexArrayType=o<65536?Uint16Array:Uint32Array;const b=Jk.indexOf(this.ArrayType),S=2*o*this.ArrayType.BYTES_PER_ELEMENT,C=o*this.IndexArrayType.BYTES_PER_ELEMENT,k=(8-C%8)%8;if(b<0)throw new Error(`Unexpected typed array class: ${f}.`);g&&g instanceof ArrayBuffer?(this.data=g,this.ids=new this.IndexArrayType(this.data,8,o),this.coords=new this.ArrayType(this.data,8+C+k,2*o),this._pos=2*o,this._finished=!0):(this.data=new ArrayBuffer(8+S+C+k),this.ids=new this.IndexArrayType(this.data,8,o),this.coords=new this.ArrayType(this.data,8+C+k,2*o),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,16+b]),new Uint16Array(this.data,2,1)[0]=u,new Uint32Array(this.data,4,1)[0]=o)}add(o,u){const f=this._pos>>1;return this.ids[f]=f,this.coords[this._pos++]=o,this.coords[this._pos++]=u,f}finish(){const o=this._pos>>1;if(o!==this.numItems)throw new Error(`Added ${o} items when expected ${this.numItems}.`);return jw(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(o,u,f,g){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:b,coords:S,nodeSize:C}=this,k=[0,b.length-1,0],N=[];for(;k.length;){const F=k.pop()||0,G=k.pop()||0,Y=k.pop()||0;if(G-Y<=C){for(let pe=Y;pe<=G;pe++){const be=S[2*pe],Fe=S[2*pe+1];be>=o&&be<=f&&Fe>=u&&Fe<=g&&N.push(b[pe])}continue}const J=Y+G>>1,re=S[2*J],le=S[2*J+1];re>=o&&re<=f&&le>=u&&le<=g&&N.push(b[J]),(F===0?o<=re:u<=le)&&(k.push(Y),k.push(J-1),k.push(1-F)),(F===0?f>=re:g>=le)&&(k.push(J+1),k.push(G),k.push(1-F))}return N}within(o,u,f){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:g,coords:b,nodeSize:S}=this,C=[0,g.length-1,0],k=[],N=f*f;for(;C.length;){const F=C.pop()||0,G=C.pop()||0,Y=C.pop()||0;if(G-Y<=S){for(let pe=Y;pe<=G;pe++)tM(b[2*pe],b[2*pe+1],o,u)<=N&&k.push(g[pe]);continue}const J=Y+G>>1,re=b[2*J],le=b[2*J+1];tM(re,le,o,u)<=N&&k.push(g[J]),(F===0?o-f<=re:u-f<=le)&&(C.push(Y),C.push(J-1),C.push(1-F)),(F===0?o+f>=re:u+f>=le)&&(C.push(J+1),C.push(G),C.push(1-F))}return k}}function jw(h,o,u,f,g,b){if(g-f<=u)return;const S=f+g>>1;eM(h,o,S,f,g,b),jw(h,o,u,f,S-1,1-b),jw(h,o,u,S+1,g,1-b)}function eM(h,o,u,f,g,b){for(;g>f;){if(g-f>600){const N=g-f+1,F=u-f+1,G=Math.log(N),Y=.5*Math.exp(2*G/3),J=.5*Math.sqrt(G*Y*(N-Y)/N)*(F-N/2<0?-1:1);eM(h,o,u,Math.max(f,Math.floor(u-F*Y/N+J)),Math.min(g,Math.floor(u+(N-F)*Y/N+J)),b)}const S=o[2*u+b];let C=f,k=g;for(Lg(h,o,f,u),o[2*g+b]>S&&Lg(h,o,f,g);C<k;){for(Lg(h,o,C,k),C++,k--;o[2*C+b]<S;)C++;for(;o[2*k+b]>S;)k--}o[2*f+b]===S?Lg(h,o,f,k):(k++,Lg(h,o,k,g)),k<=u&&(f=k+1),u<=k&&(g=k-1)}}function Lg(h,o,u,f){Fw(h,u,f),Fw(o,2*u,2*f),Fw(o,2*u+1,2*f+1)}function Fw(h,o,u){const f=h[o];h[o]=h[u],h[u]=f}function tM(h,o,u,f){const g=h-u,b=o-f;return g*g+b*b}var Bw;l.cx=void 0,(Bw=l.cx||(l.cx={})).create="create",Bw.load="load",Bw.fullLoad="fullLoad";let pv=null,Og=[];const $w=1e3/60,Vw="loadTime",Uw="fullLoadTime",I8={mark(h){performance.mark(h)},frame(h){const o=h;pv!=null&&Og.push(o-pv),pv=o},clearMetrics(){pv=null,Og=[],performance.clearMeasures(Vw),performance.clearMeasures(Uw);for(const h in l.cx)performance.clearMarks(l.cx[h])},getPerformanceMetrics(){performance.measure(Vw,l.cx.create,l.cx.load),performance.measure(Uw,l.cx.create,l.cx.fullLoad);const h=performance.getEntriesByName(Vw)[0].duration,o=performance.getEntriesByName(Uw)[0].duration,u=Og.length,f=1/(Og.reduce((b,S)=>b+S,0)/u/1e3),g=Og.filter(b=>b>$w).reduce((b,S)=>b+(S-$w)/$w,0);return{loadTime:h,fullLoadTime:o,fps:f,percentDroppedFrames:g/(u+g)*100,totalFrames:u}}};l.$=ve,l.A=j,l.B=function([h,o,u]){return o+=90,o*=Math.PI/180,u*=Math.PI/180,{x:h*Math.cos(o)*Math.sin(u),y:h*Math.sin(o)*Math.sin(u),z:h*Math.cos(u)}},l.C=zs,l.D=kt,l.E=It,l.F=$r,l.G=og,l.H=Kr,l.I=Tw,l.J=class{constructor(h,o){this.target=h,this.mapId=o,this.resolveRejects={},this.tasks={},this.taskQueue=[],this.abortControllers={},this.messageHandlers={},this.invoker=new b8(()=>this.process()),this.subscription=Zt(this.target,"message",u=>this.receive(u),!1),this.globalScope=Nr(self)?h:window}registerMessageHandler(h,o){this.messageHandlers[h]=o}sendAsync(h,o){return new Promise((u,f)=>{const g=Math.round(1e18*Math.random()).toString(36).substring(0,10),b=o?Zt(o.signal,"abort",()=>{b==null||b.unsubscribe(),delete this.resolveRejects[g];const k={id:g,type:"<cancel>",origin:location.origin,targetMapId:h.targetMapId,sourceMapId:this.mapId};this.target.postMessage(k)},w8):null;this.resolveRejects[g]={resolve:k=>{b==null||b.unsubscribe(),u(k)},reject:k=>{b==null||b.unsubscribe(),f(k)}};const S=[],C=Object.assign(Object.assign({},h),{id:g,sourceMapId:this.mapId,origin:location.origin,data:yh(h.data,S)});this.target.postMessage(C,{transfer:S})})}receive(h){const o=h.data,u=o.id;if(!(o.origin!=="file://"&&location.origin!=="file://"&&o.origin!=="resource://android"&&location.origin!=="resource://android"&&o.origin!==location.origin||o.targetMapId&&this.mapId!==o.targetMapId)){if(o.type==="<cancel>"){delete this.tasks[u];const f=this.abortControllers[u];return delete this.abortControllers[u],void(f&&f.abort())}if(Nr(self)||o.mustQueue)return this.tasks[u]=o,this.taskQueue.push(u),void this.invoker.trigger();this.processTask(u,o)}}process(){if(this.taskQueue.length===0)return;const h=this.taskQueue.shift(),o=this.tasks[h];delete this.tasks[h],this.taskQueue.length>0&&this.invoker.trigger(),o&&this.processTask(h,o)}processTask(h,o){return a(this,void 0,void 0,function*(){if(o.type==="<response>"){const g=this.resolveRejects[h];return delete this.resolveRejects[h],g?void(o.error?g.reject(Rl(o.error)):g.resolve(Rl(o.data))):void 0}if(!this.messageHandlers[o.type])return void this.completeTask(h,new Error(`Could not find a registered handler for ${o.type}, map ID: ${this.mapId}, available handlers: ${Object.keys(this.messageHandlers).join(", ")}`));const u=Rl(o.data),f=new AbortController;this.abortControllers[h]=f;try{const g=yield this.messageHandlers[o.type](o.sourceMapId,u,f);this.completeTask(h,null,g)}catch(g){this.completeTask(h,g)}})}completeTask(h,o,u){const f=[];delete this.abortControllers[h];const g={id:h,type:"<response>",sourceMapId:this.mapId,origin:location.origin,error:o?yh(o):null,data:yh(u,f)};this.target.postMessage(g,{transfer:f})}remove(){this.invoker.remove(),this.subscription.unsubscribe()}},l.K=we,l.L=function(){var h=new j(16);return j!=Float32Array&&(h[1]=0,h[2]=0,h[3]=0,h[4]=0,h[6]=0,h[7]=0,h[8]=0,h[9]=0,h[11]=0,h[12]=0,h[13]=0,h[14]=0),h[0]=1,h[5]=1,h[10]=1,h[15]=1,h},l.M=function(h,o,u){var f,g,b,S,C,k,N,F,G,Y,J,re,le=u[0],pe=u[1],be=u[2];return o===h?(h[12]=o[0]*le+o[4]*pe+o[8]*be+o[12],h[13]=o[1]*le+o[5]*pe+o[9]*be+o[13],h[14]=o[2]*le+o[6]*pe+o[10]*be+o[14],h[15]=o[3]*le+o[7]*pe+o[11]*be+o[15]):(g=o[1],b=o[2],S=o[3],C=o[4],k=o[5],N=o[6],F=o[7],G=o[8],Y=o[9],J=o[10],re=o[11],h[0]=f=o[0],h[1]=g,h[2]=b,h[3]=S,h[4]=C,h[5]=k,h[6]=N,h[7]=F,h[8]=G,h[9]=Y,h[10]=J,h[11]=re,h[12]=f*le+C*pe+G*be+o[12],h[13]=g*le+k*pe+Y*be+o[13],h[14]=b*le+N*pe+J*be+o[14],h[15]=S*le+F*pe+re*be+o[15]),h},l.N=function(h,o,u){var f=u[0],g=u[1],b=u[2];return h[0]=o[0]*f,h[1]=o[1]*f,h[2]=o[2]*f,h[3]=o[3]*f,h[4]=o[4]*g,h[5]=o[5]*g,h[6]=o[6]*g,h[7]=o[7]*g,h[8]=o[8]*b,h[9]=o[9]*b,h[10]=o[10]*b,h[11]=o[11]*b,h[12]=o[12],h[13]=o[13],h[14]=o[14],h[15]=o[15],h},l.O=function(h,o,u){var f=o[0],g=o[1],b=o[2],S=o[3],C=o[4],k=o[5],N=o[6],F=o[7],G=o[8],Y=o[9],J=o[10],re=o[11],le=o[12],pe=o[13],be=o[14],Fe=o[15],ke=u[0],De=u[1],Ue=u[2],Ke=u[3];return h[0]=ke*f+De*C+Ue*G+Ke*le,h[1]=ke*g+De*k+Ue*Y+Ke*pe,h[2]=ke*b+De*N+Ue*J+Ke*be,h[3]=ke*S+De*F+Ue*re+Ke*Fe,h[4]=(ke=u[4])*f+(De=u[5])*C+(Ue=u[6])*G+(Ke=u[7])*le,h[5]=ke*g+De*k+Ue*Y+Ke*pe,h[6]=ke*b+De*N+Ue*J+Ke*be,h[7]=ke*S+De*F+Ue*re+Ke*Fe,h[8]=(ke=u[8])*f+(De=u[9])*C+(Ue=u[10])*G+(Ke=u[11])*le,h[9]=ke*g+De*k+Ue*Y+Ke*pe,h[10]=ke*b+De*N+Ue*J+Ke*be,h[11]=ke*S+De*F+Ue*re+Ke*Fe,h[12]=(ke=u[12])*f+(De=u[13])*C+(Ue=u[14])*G+(Ke=u[15])*le,h[13]=ke*g+De*k+Ue*Y+Ke*pe,h[14]=ke*b+De*N+Ue*J+Ke*be,h[15]=ke*S+De*F+Ue*re+Ke*Fe,h},l.P=m,l.Q=function(h,o){const u={};for(let f=0;f<o.length;f++){const g=o[f];g in h&&(u[g]=h[g])}return u},l.R=ws,l.S=$c,l.T=pw,l.U=Rk,l.V=Ik,l.W=L,l.X=R,l.Y=Nn,l.Z=uo,l._=a,l.a=oe,l.a$=ue,l.a0=function(h,o){var u,f,g,b,S;if(!h)return o??{};if(!o)return h;let C=Object.assign({},h);if(o.removeAll&&(C={removeAll:!0}),o.remove){const k=new Set(o.remove);C.add&&(C.add=C.add.filter(F=>!k.has(F.id))),C.update&&(C.update=C.update.filter(F=>!k.has(F.id)));const N=new Set(((u=h.add)!==null&&u!==void 0?u:[]).map(F=>F.id));o.remove=o.remove.filter(F=>!N.has(F))}if(o.remove){const k=new Set(C.remove?C.remove.concat(o.remove):o.remove);C.remove=Array.from(k.values())}if(o.add){const k=C.add?C.add.concat(o.add):o.add,N=new Map(k.map(F=>[F.id,F]));C.add=Array.from(N.values())}if(o.update){const k=new Map((f=C.update)===null||f===void 0?void 0:f.map(N=>[N.id,N]));for(const N of o.update){const F=(g=k.get(N.id))!==null&&g!==void 0?g:{id:N.id};N.newGeometry&&(F.newGeometry=N.newGeometry),N.addOrUpdateProperties&&(F.addOrUpdateProperties=((b=F.addOrUpdateProperties)!==null&&b!==void 0?b:[]).concat(N.addOrUpdateProperties)),N.removeProperties&&(F.removeProperties=((S=F.removeProperties)!==null&&S!==void 0?S:[]).concat(N.removeProperties)),N.removeAllProperties&&(F.removeAllProperties=!0),k.set(N.id,F)}C.update=Array.from(k.values())}return C.remove&&C.add&&(C.remove=C.remove.filter(k=>C.add.findIndex(N=>N.id===k)===-1)),C},l.a1=Rg,l.a2=Ph,l.a3=25,l.a4=Lw,l.a5=h=>{const o=window.document.createElement("video");return o.muted=!0,new Promise(u=>{o.onloadstart=()=>{u(o)};for(const f of h){const g=window.document.createElement("source");ze(f)||(o.crossOrigin="Anonymous"),g.src=f,o.appendChild(g)}})},l.a6=ot,l.a7=function(){return ir++},l.a8=K,l.a9=Df,l.aA=function(h){let o=1/0,u=1/0,f=-1/0,g=-1/0;for(const b of h)o=Math.min(o,b.x),u=Math.min(u,b.y),f=Math.max(f,b.x),g=Math.max(g,b.y);return[o,u,f,g]},l.aB=ai,l.aC=Re,l.aD=function(h,o,u,f,g=!1){if(!u[0]&&!u[1])return[0,0];const b=g?f==="map"?-h.bearingInRadians:0:f==="viewport"?h.bearingInRadians:0;if(b){const S=Math.sin(b),C=Math.cos(b);u=[u[0]*C-u[1]*S,u[0]*S+u[1]*C]}return[g?u[0]:Re(o,u[0],h.zoom),g?u[1]:Re(o,u[1],h.zoom)]},l.aF=Pw,l.aG=zw,l.aH=Cw,l.aI=Nw,l.aJ=yn,l.aK=iv,l.aL=Le,l.aM=gr,l.aN=Ir,l.aO=Pt,l.aP=St,l.aQ=Lk,l.aR=Q,l.aS=q,l.aT=function(h){var o=new j(3);return o[0]=h[0],o[1]=h[1],o[2]=h[2],o},l.aU=function(h,o,u){return h[0]=o[0]-u[0],h[1]=o[1]-u[1],h[2]=o[2]-u[2],h},l.aV=function(h,o){var u=o[0],f=o[1],g=o[2],b=u*u+f*f+g*g;return b>0&&(b=1/Math.sqrt(b)),h[0]=o[0]*b,h[1]=o[1]*b,h[2]=o[2]*b,h},l.aW=ce,l.aX=function(h,o){return h[0]*o[0]+h[1]*o[1]+h[2]*o[2]},l.aY=function(h,o,u){return h[0]=o[0]*u[0],h[1]=o[1]*u[1],h[2]=o[2]*u[2],h[3]=o[3]*u[3],h},l.aZ=ie,l.a_=function(h,o,u){const f=o[0]*u[0]+o[1]*u[1]+o[2]*u[2];return f===0?null:(-(h[0]*u[0]+h[1]*u[1]+h[2]*u[2])-u[3])/f},l.aa=uh,l.ab=Th,l.ac=jk,l.ad=function(h){const o={};if(h.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,(u,f,g,b)=>{const S=g||b;return o[f]=!S||S.toLowerCase(),""}),o["max-age"]){const u=parseInt(o["max-age"],10);isNaN(u)?delete o["max-age"]:o["max-age"]=u}return o},l.ae=Or,l.af=function(h){return Math.pow(2,h)},l.ag=Z,l.ah=Ct,l.ai=85.051129,l.aj=Dk,l.ak=function(h){return Math.log(h)/Math.LN2},l.al=function(h){var o=h[0],u=h[1];return o*o+u*u},l.am=function(h){if(!h.length)return new Set;const o=Math.max(...h.map(k=>k.canonical.z));let u=1/0,f=-1/0,g=1/0,b=-1/0;const S=[];for(const k of h){const{x:N,y:F,z:G}=k.canonical,Y=Math.pow(2,o-G),J=N*Y,re=F*Y;S.push({id:k,x:J,y:re}),J<u&&(u=J),J>f&&(f=J),re<g&&(g=re),re>b&&(b=re)}const C=new Set;for(const k of S)k.x!==u&&k.x!==f&&k.y!==g&&k.y!==b||C.add(k.id);return C},l.an=function(h,o){let u=0,f=0;if(h.kind==="constant")f=h.layoutSize;else if(h.kind!=="source"){const{interpolationType:g,minZoom:b,maxZoom:S}=h,C=g?Ct(Hn.interpolationFactor(g,o,b,S),0,1):0;h.kind==="camera"?f=zs.number(h.minSize,h.maxSize,C):u=C}return{uSizeT:u,uSize:f}},l.ap=function(h,{uSize:o,uSizeT:u},{lowerSize:f,upperSize:g}){return h.kind==="source"?f/jl:h.kind==="composite"?zs.number(f/jl,g/jl,u):o},l.aq=function(h,o){var u=o[0],f=o[1],g=o[2],b=o[3],S=o[4],C=o[5],k=o[6],N=o[7],F=o[8],G=o[9],Y=o[10],J=o[11],re=o[12],le=o[13],pe=o[14],be=o[15],Fe=u*C-f*S,ke=u*k-g*S,De=u*N-b*S,Ue=f*k-g*C,Ke=f*N-b*C,it=g*N-b*k,yt=F*le-G*re,ht=F*pe-Y*re,pt=F*be-J*re,Ot=G*pe-Y*le,ft=G*be-J*le,mt=Y*be-J*pe,et=Fe*mt-ke*ft+De*Ot+Ue*pt-Ke*ht+it*yt;return et?(h[0]=(C*mt-k*ft+N*Ot)*(et=1/et),h[1]=(g*ft-f*mt-b*Ot)*et,h[2]=(le*it-pe*Ke+be*Ue)*et,h[3]=(Y*Ke-G*it-J*Ue)*et,h[4]=(k*pt-S*mt-N*ht)*et,h[5]=(u*mt-g*pt+b*ht)*et,h[6]=(pe*De-re*it-be*ke)*et,h[7]=(F*it-Y*De+J*ke)*et,h[8]=(S*ft-C*pt+N*yt)*et,h[9]=(f*pt-u*ft-b*yt)*et,h[10]=(re*Ke-le*De+be*Fe)*et,h[11]=(G*De-F*Ke-J*Fe)*et,h[12]=(C*ht-S*Ot-k*yt)*et,h[13]=(u*Ot-f*ht+g*yt)*et,h[14]=(le*ke-re*Ue-pe*Fe)*et,h[15]=(F*Ue-G*ke+Y*Fe)*et,h):null},l.ar=Se,l.as=function(h){var o=h[0],u=h[1];return Math.sqrt(o*o+u*u)},l.at=function(h){return h[0]=0,h[1]=0,h},l.au=function(h,o,u){return h[0]=o[0]*u,h[1]=o[1]*u,h},l.av=Aw,l.aw=he,l.ax=function(h,o,u,f){const g=o.y-h.y,b=o.x-h.x,S=f.y-u.y,C=f.x-u.x,k=S*b-C*g;if(k===0)return null;const N=(C*(h.y-u.y)-S*(h.x-u.x))/k;return new m(h.x+N*b,h.y+N*g)},l.ay=$k,l.az=IA,l.b=Ar,l.b$=class extends xs{constructor(h,o){super(h,o),this.current=new Array}set(h){if(h!=this.current){this.current=h;const o=new Float32Array(h);this.gl.uniform1fv(this.location,o)}}},l.b0=function(h,o,u){return h[0]=o[0]*u,h[1]=o[1]*u,h[2]=o[2]*u,h[3]=o[3]*u,h},l.b1=function(h,o){return h[0]*o[0]+h[1]*o[1]+h[2]*o[2]+h[3]},l.b2=zk,l.b3=Lf,l.b4=function(h,o,u,f,g){var b=1/Math.tan(o/2);if(h[0]=b/u,h[1]=0,h[2]=0,h[3]=0,h[4]=0,h[5]=b,h[6]=0,h[7]=0,h[8]=0,h[9]=0,h[11]=-1,h[12]=0,h[13]=0,h[15]=0,g!=null&&g!==1/0){var S=1/(f-g);h[10]=(g+f)*S,h[14]=2*g*f*S}else h[10]=-1,h[14]=-2*f;return h},l.b5=function(h){var o=new j(16);return o[0]=h[0],o[1]=h[1],o[2]=h[2],o[3]=h[3],o[4]=h[4],o[5]=h[5],o[6]=h[6],o[7]=h[7],o[8]=h[8],o[9]=h[9],o[10]=h[10],o[11]=h[11],o[12]=h[12],o[13]=h[13],o[14]=h[14],o[15]=h[15],o},l.b6=function(h,o,u){var f=Math.sin(u),g=Math.cos(u),b=o[0],S=o[1],C=o[2],k=o[3],N=o[4],F=o[5],G=o[6],Y=o[7];return o!==h&&(h[8]=o[8],h[9]=o[9],h[10]=o[10],h[11]=o[11],h[12]=o[12],h[13]=o[13],h[14]=o[14],h[15]=o[15]),h[0]=b*g+N*f,h[1]=S*g+F*f,h[2]=C*g+G*f,h[3]=k*g+Y*f,h[4]=N*g-b*f,h[5]=F*g-S*f,h[6]=G*g-C*f,h[7]=Y*g-k*f,h},l.b7=function(h,o,u){var f=Math.sin(u),g=Math.cos(u),b=o[4],S=o[5],C=o[6],k=o[7],N=o[8],F=o[9],G=o[10],Y=o[11];return o!==h&&(h[0]=o[0],h[1]=o[1],h[2]=o[2],h[3]=o[3],h[12]=o[12],h[13]=o[13],h[14]=o[14],h[15]=o[15]),h[4]=b*g+N*f,h[5]=S*g+F*f,h[6]=C*g+G*f,h[7]=k*g+Y*f,h[8]=N*g-b*f,h[9]=F*g-S*f,h[10]=G*g-C*f,h[11]=Y*g-k*f,h},l.b8=function(){const h=new Float32Array(16);return Z(h),h},l.b9=function(){const h=new Float64Array(16);return Z(h),h},l.bA=function(h,o){const u=$e(h,360),f=$e(o,360),g=f-u,b=f>u?g-360:g+360;return Math.abs(g)<Math.abs(b)?g:b},l.bB=function(h){return h[0]=0,h[1]=0,h[2]=0,h},l.bC=function(h,o,u,f){const g=Math.sqrt(h*h+o*o),b=Math.sqrt(u*u+f*f);h/=g,o/=g,u/=b,f/=b;const S=Math.acos(h*u+o*f);return-o*u+h*f>0?S:-S},l.bD=function(h,o){const u=$e(h,2*Math.PI),f=$e(o,2*Math.PI);return Math.min(Math.abs(u-f),Math.abs(u-f+2*Math.PI),Math.abs(u-f-2*Math.PI))},l.bE=function(){const h={},o=je.$version;for(const u in je.$root){const f=je.$root[u];if(f.required){let g=null;g=u==="version"?o:f.type==="array"?[]:{},g!=null&&(h[u]=g)}}return h},l.bF=Dc,l.bG=Oe,l.bH=function h(o,u){if(Array.isArray(o)){if(!Array.isArray(u)||o.length!==u.length)return!1;for(let f=0;f<o.length;f++)if(!h(o[f],u[f]))return!1;return!0}if(typeof o=="object"&&o!==null&&u!==null){if(typeof u!="object"||Object.keys(o).length!==Object.keys(u).length)return!1;for(const f in o)if(!h(o[f],u[f]))return!1;return!0}return o===u},l.bI=function(h){h=h.slice();const o=Object.create(null);for(let u=0;u<h.length;u++)o[h[u].id]=h[u];for(let u=0;u<h.length;u++)"ref"in h[u]&&(h[u]=wt(h[u],o[h[u].ref]));return h},l.bJ=function(h,o){if(h.type==="custom")return new x8(h,o);switch(h.type){case"background":return new v8(h,o);case"circle":return new i$(h,o);case"color-relief":return new u$(h,o);case"fill":return new E$(h,o);case"fill-extrusion":return new z$(h,o);case"heatmap":return new o$(h,o);case"hillshade":return new l$(h,o);case"line":return new U$(h,o);case"raster":return new sw(h,o);case"symbol":return new cv(h,o)}},l.bK=h=>h.type==="raster",l.bL=vt,l.bM=function(h,o){if(!h)return[{command:"setStyle",args:[o]}];let u=[];try{if(!lt(h.version,o.version))return[{command:"setStyle",args:[o]}];lt(h.center,o.center)||u.push({command:"setCenter",args:[o.center]}),lt(h.state,o.state)||u.push({command:"setGlobalState",args:[o.state]}),lt(h.centerAltitude,o.centerAltitude)||u.push({command:"setCenterAltitude",args:[o.centerAltitude]}),lt(h.zoom,o.zoom)||u.push({command:"setZoom",args:[o.zoom]}),lt(h.bearing,o.bearing)||u.push({command:"setBearing",args:[o.bearing]}),lt(h.pitch,o.pitch)||u.push({command:"setPitch",args:[o.pitch]}),lt(h.roll,o.roll)||u.push({command:"setRoll",args:[o.roll]}),lt(h.sprite,o.sprite)||u.push({command:"setSprite",args:[o.sprite]}),lt(h.glyphs,o.glyphs)||u.push({command:"setGlyphs",args:[o.glyphs]}),lt(h.transition,o.transition)||u.push({command:"setTransition",args:[o.transition]}),lt(h.light,o.light)||u.push({command:"setLight",args:[o.light]}),lt(h.terrain,o.terrain)||u.push({command:"setTerrain",args:[o.terrain]}),lt(h.sky,o.sky)||u.push({command:"setSky",args:[o.sky]}),lt(h.projection,o.projection)||u.push({command:"setProjection",args:[o.projection]});const f={},g=[];(function(S,C,k,N){let F;for(F in C=C||{},S=S||{})Object.prototype.hasOwnProperty.call(S,F)&&(Object.prototype.hasOwnProperty.call(C,F)||xr(F,k,N));for(F in C)Object.prototype.hasOwnProperty.call(C,F)&&(Object.prototype.hasOwnProperty.call(S,F)?lt(S[F],C[F])||(S[F].type==="geojson"&&C[F].type==="geojson"&&Vr(S,C,F)?Dt(k,{command:"setGeoJSONSourceData",args:[F,C[F].data]}):kr(F,C,k,N)):_r(F,C,k))})(h.sources,o.sources,g,f);const b=[];h.layers&&h.layers.forEach(S=>{"source"in S&&f[S.source]?u.push({command:"removeLayer",args:[S.id]}):b.push(S)}),u=u.concat(g),function(S,C,k){C=C||[];const N=(S=S||[]).map(zr),F=C.map(zr),G=S.reduce(Tr,{}),Y=C.reduce(Tr,{}),J=N.slice(),re=Object.create(null);let le,pe,be,Fe,ke;for(let De=0,Ue=0;De<N.length;De++)le=N[De],Object.prototype.hasOwnProperty.call(Y,le)?Ue++:(Dt(k,{command:"removeLayer",args:[le]}),J.splice(J.indexOf(le,Ue),1));for(let De=0,Ue=0;De<F.length;De++)le=F[F.length-1-De],J[J.length-1-De]!==le&&(Object.prototype.hasOwnProperty.call(G,le)?(Dt(k,{command:"removeLayer",args:[le]}),J.splice(J.lastIndexOf(le,J.length-Ue),1)):Ue++,Fe=J[J.length-De],Dt(k,{command:"addLayer",args:[Y[le],Fe]}),J.splice(J.length-De,0,le),re[le]=!0);for(let De=0;De<F.length;De++)if(le=F[De],pe=G[le],be=Y[le],!re[le]&&!lt(pe,be))if(lt(pe.source,be.source)&&lt(pe["source-layer"],be["source-layer"])&&lt(pe.type,be.type)){for(ke in tr(pe.layout,be.layout,k,le,null,"setLayoutProperty"),tr(pe.paint,be.paint,k,le,null,"setPaintProperty"),lt(pe.filter,be.filter)||Dt(k,{command:"setFilter",args:[le,be.filter]}),lt(pe.minzoom,be.minzoom)&&lt(pe.maxzoom,be.maxzoom)||Dt(k,{command:"setLayerZoomRange",args:[le,be.minzoom,be.maxzoom]}),pe)Object.prototype.hasOwnProperty.call(pe,ke)&&ke!=="layout"&&ke!=="paint"&&ke!=="filter"&&ke!=="metadata"&&ke!=="minzoom"&&ke!=="maxzoom"&&(ke.indexOf("paint.")===0?tr(pe[ke],be[ke],k,le,ke.slice(6),"setPaintProperty"):lt(pe[ke],be[ke])||Dt(k,{command:"setLayerProperty",args:[le,ke,be[ke]]}));for(ke in be)Object.prototype.hasOwnProperty.call(be,ke)&&!Object.prototype.hasOwnProperty.call(pe,ke)&&ke!=="layout"&&ke!=="paint"&&ke!=="filter"&&ke!=="metadata"&&ke!=="minzoom"&&ke!=="maxzoom"&&(ke.indexOf("paint.")===0?tr(pe[ke],be[ke],k,le,ke.slice(6),"setPaintProperty"):lt(pe[ke],be[ke])||Dt(k,{command:"setLayerProperty",args:[le,ke,be[ke]]}))}else Dt(k,{command:"removeLayer",args:[le]}),Fe=J[J.lastIndexOf(le)+1],Dt(k,{command:"addLayer",args:[be,Fe]})}(b,o.layers,u)}catch(f){console.warn("Unable to compute style diff:",f),u=[{command:"setStyle",args:[o]}]}return u},l.bN=function(h){const o=[],u=h.id;return u===void 0&&o.push({message:`layers.${u}: missing required property "id"`}),h.render===void 0&&o.push({message:`layers.${u}: missing required method "render"`}),h.renderingMode&&h.renderingMode!=="2d"&&h.renderingMode!=="3d"&&o.push({message:`layers.${u}: property "renderingMode" must be either "2d" or "3d"`}),o},l.bO=yr,l.bP=$t,l.bQ=class extends xs{constructor(h,o){super(h,o),this.current=0}set(h){this.current!==h&&(this.current=h,this.gl.uniform1i(this.location,h))}},l.bR=bs,l.bS=class extends xs{constructor(h,o){super(h,o),this.current=oi}set(h){if(h[12]!==this.current[12]||h[0]!==this.current[0])return this.current=h,void this.gl.uniformMatrix4fv(this.location,!1,h);for(let o=1;o<16;o++)if(h[o]!==this.current[o]){this.current=h,this.gl.uniformMatrix4fv(this.location,!1,h);break}}},l.bT=Zn,l.bU=class extends xs{constructor(h,o){super(h,o),this.current=[0,0,0]}set(h){h[0]===this.current[0]&&h[1]===this.current[1]&&h[2]===this.current[2]||(this.current=h,this.gl.uniform3f(this.location,h[0],h[1],h[2]))}},l.bV=class extends xs{constructor(h,o){super(h,o),this.current=[0,0]}set(h){h[0]===this.current[0]&&h[1]===this.current[1]||(this.current=h,this.gl.uniform2f(this.location,h[0],h[1]))}},l.bW=W,l.bX=function(h,o){var u=Math.sin(o),f=Math.cos(o);return h[0]=f,h[1]=u,h[2]=0,h[3]=-u,h[4]=f,h[5]=0,h[6]=0,h[7]=0,h[8]=1,h},l.bY=function(h,o,u){var f=o[0],g=o[1],b=o[2];return h[0]=f*u[0]+g*u[3]+b*u[6],h[1]=f*u[1]+g*u[4]+b*u[7],h[2]=f*u[2]+g*u[5]+b*u[8],h},l.bZ=function(h,o,u,f,g,b,S){var C=1/(o-u),k=1/(f-g),N=1/(b-S);return h[0]=-2*C,h[1]=0,h[2]=0,h[3]=0,h[4]=0,h[5]=-2*k,h[6]=0,h[7]=0,h[8]=0,h[9]=0,h[10]=2*N,h[11]=0,h[12]=(o+u)*C,h[13]=(g+f)*k,h[14]=(S+b)*N,h[15]=1,h},l.b_=class extends xs{constructor(h,o){super(h,o),this.current=new Array}set(h){if(h!=this.current){this.current=h;const o=new Float32Array(4*h.length);for(let u=0;u<h.length;u++)o[4*u]=h[u].r,o[4*u+1]=h[u].g,o[4*u+2]=h[u].b,o[4*u+3]=h[u].a;this.gl.uniform4fv(this.location,o)}}},l.ba=function(){return new Float64Array(16)},l.bb=function(h,o,u){const f=new Float64Array(4);return xe(f,h,o-90,u),f},l.bc=function(h,o,u,f){var g,b,S,C,k,N=o[0],F=o[1],G=o[2],Y=o[3],J=u[0],re=u[1],le=u[2],pe=u[3];return(b=N*J+F*re+G*le+Y*pe)<0&&(b=-b,J=-J,re=-re,le=-le,pe=-pe),1-b>z?(g=Math.acos(b),S=Math.sin(g),C=Math.sin((1-f)*g)/S,k=Math.sin(f*g)/S):(C=1-f,k=f),h[0]=C*N+k*J,h[1]=C*F+k*re,h[2]=C*G+k*le,h[3]=C*Y+k*pe,h},l.bd=function(h){const o=new Float64Array(9);var u,f,g,b,S,C,k,N,F,G,Y,J,re,le,pe,be,Fe,ke;G=(g=(f=h)[0])*(k=g+g),Y=(b=f[1])*k,re=(S=f[2])*k,le=S*(N=b+b),be=(C=f[3])*k,Fe=C*N,ke=C*(F=S+S),(u=o)[0]=1-(J=b*N)-(pe=S*F),u[3]=Y-ke,u[6]=re+Fe,u[1]=Y+ke,u[4]=1-G-pe,u[7]=le-be,u[2]=re-Fe,u[5]=le+be,u[8]=1-G-J;const De=St(-Math.asin(Ct(o[2],-1,1)));let Ue,Ke;return Math.hypot(o[5],o[8])<.001?(Ue=0,Ke=-St(Math.atan2(o[3],o[4]))):(Ue=St(o[5]===0&&o[8]===0?0:Math.atan2(o[5],o[8])),Ke=St(o[1]===0&&o[0]===0?0:Math.atan2(o[1],o[0]))),{roll:Ue,pitch:De+90,bearing:Ke}},l.be=function(h,o){return h.roll==o.roll&&h.pitch==o.pitch&&h.bearing==o.bearing},l.bf=ar,l.bg=_n,l.bh=kf,l.bi=Cg,l.bj=Af,l.bk=Xe,l.bl=st,l.bm=ns,l.bn=function(h,o,u,f,g){return Xe(f,g,Ct((h-o)/(u-o),0,1))},l.bo=$e,l.bp=function(){return new Float64Array(3)},l.bq=function(h,o,u,f){return h[0]=o[0]+u[0]*f,h[1]=o[1]+u[1]*f,h[2]=o[2]+u[2]*f,h},l.br=xe,l.bs=function(h,o,u){var f=u[0],g=u[1],b=u[2],S=u[3],C=o[0],k=o[1],N=o[2],F=g*N-b*k,G=b*C-f*N,Y=f*k-g*C;return h[0]=C+S*(F+=F)+g*(Y+=Y)-b*(G+=G),h[1]=k+S*G+b*F-f*Y,h[2]=N+S*Y+f*G-g*F,h},l.bt=function(h,o,u){const f=(g=[h[0],h[1],h[2],o[0],o[1],o[2],u[0],u[1],u[2]])[0]*((F=g[8])*(S=g[4])-(C=g[5])*(N=g[7]))+g[1]*(-F*(b=g[3])+C*(k=g[6]))+g[2]*(N*b-S*k);var g,b,S,C,k,N,F;if(f===0)return null;const G=ce([],[o[0],o[1],o[2]],[u[0],u[1],u[2]]),Y=ce([],[u[0],u[1],u[2]],[h[0],h[1],h[2]]),J=ce([],[h[0],h[1],h[2]],[o[0],o[1],o[2]]),re=Q([],G,-h[3]);return q(re,re,Q([],Y,-o[3])),q(re,re,Q([],J,-u[3])),Q(re,re,1/f),re},l.bu=Rw,l.bv=function(){return new Float64Array(4)},l.bw=function(h,o,u,f){var g=[],b=[];return g[0]=o[0]-u[0],g[1]=o[1]-u[1],g[2]=o[2]-u[2],b[0]=g[0]*Math.cos(f)-g[1]*Math.sin(f),b[1]=g[0]*Math.sin(f)+g[1]*Math.cos(f),b[2]=g[2],h[0]=b[0]+u[0],h[1]=b[1]+u[1],h[2]=b[2]+u[2],h},l.bx=function(h,o,u,f){var g=[],b=[];return g[0]=o[0]-u[0],g[1]=o[1]-u[1],g[2]=o[2]-u[2],b[0]=g[0],b[1]=g[1]*Math.cos(f)-g[2]*Math.sin(f),b[2]=g[1]*Math.sin(f)+g[2]*Math.cos(f),h[0]=b[0]+u[0],h[1]=b[1]+u[1],h[2]=b[2]+u[2],h},l.by=function(h,o,u,f){var g=[],b=[];return g[0]=o[0]-u[0],g[1]=o[1]-u[1],g[2]=o[2]-u[2],b[0]=g[2]*Math.sin(f)+g[0]*Math.cos(f),b[1]=g[1],b[2]=g[2]*Math.cos(f)-g[0]*Math.sin(f),h[0]=b[0]+u[0],h[1]=b[1]+u[1],h[2]=b[2]+u[2],h},l.bz=function(h,o,u){var f=Math.sin(u),g=Math.cos(u),b=o[0],S=o[1],C=o[2],k=o[3],N=o[8],F=o[9],G=o[10],Y=o[11];return o!==h&&(h[4]=o[4],h[5]=o[5],h[6]=o[6],h[7]=o[7],h[12]=o[12],h[13]=o[13],h[14]=o[14],h[15]=o[15]),h[0]=b*g-N*f,h[1]=S*g-F*f,h[2]=C*g-G*f,h[3]=k*g-Y*f,h[8]=b*f+N*g,h[9]=S*f+F*g,h[10]=C*f+G*g,h[11]=k*f+Y*g,h},l.c=ne,l.c0=class extends mg{},l.c1=H$,l.c2=class extends i{},l.c3=fw,l.c4=function(h){return h<=1?1:Math.pow(2,Math.ceil(Math.log(h)/Math.LN2))},l.c5=$A,l.c6=function(h,o,u){var f=o[0],g=o[1],b=o[2],S=u[3]*f+u[7]*g+u[11]*b+u[15];return h[0]=(u[0]*f+u[4]*g+u[8]*b+u[12])/(S=S||1),h[1]=(u[1]*f+u[5]*g+u[9]*b+u[13])/S,h[2]=(u[2]*f+u[6]*g+u[10]*b+u[14])/S,h},l.c7=class extends bf{},l.c8=class extends D{},l.c9=function(h,o){return h[0]===o[0]&&h[1]===o[1]&&h[2]===o[2]&&h[3]===o[3]&&h[4]===o[4]&&h[5]===o[5]&&h[6]===o[6]&&h[7]===o[7]&&h[8]===o[8]&&h[9]===o[9]&&h[10]===o[10]&&h[11]===o[11]&&h[12]===o[12]&&h[13]===o[13]&&h[14]===o[14]&&h[15]===o[15]},l.cA=function(h,o){oe.REGISTERED_PROTOCOLS[h]=o},l.cB=function(h){delete oe.REGISTERED_PROTOCOLS[h]},l.cC=function(h,o){const u={};for(let g=0;g<h.length;g++){const b=o&&o[h[g].id]||df(h[g]);o&&(o[h[g].id]=b);let S=u[b];S||(S=u[b]=[]),S.push(h[g])}const f=[];for(const g in u)f.push(u[g]);return f},l.cD=xt,l.cE=Nk,l.cF=Fk,l.cG=gk,l.cH=function(h){h.bucket.createArrays(),h.bucket.tilePixelRatio=ve/(512*h.bucket.overscaling),h.bucket.compareText={},h.bucket.iconsNeedLinear=!1;const o=h.bucket.layers[0],u=o.layout,f=o._unevaluatedLayout._values,g={layoutIconSize:f["icon-size"].possiblyEvaluate(new $r(h.bucket.zoom+1),h.canonical),layoutTextSize:f["text-size"].possiblyEvaluate(new $r(h.bucket.zoom+1),h.canonical),textMaxSize:f["text-size"].possiblyEvaluate(new $r(18))};if(h.bucket.textSizeData.kind==="composite"){const{minZoom:N,maxZoom:F}=h.bucket.textSizeData;g.compositeTextSizes=[f["text-size"].possiblyEvaluate(new $r(N),h.canonical),f["text-size"].possiblyEvaluate(new $r(F),h.canonical)]}if(h.bucket.iconSizeData.kind==="composite"){const{minZoom:N,maxZoom:F}=h.bucket.iconSizeData;g.compositeIconSizes=[f["icon-size"].possiblyEvaluate(new $r(N),h.canonical),f["icon-size"].possiblyEvaluate(new $r(F),h.canonical)]}const b=u.get("text-line-height")*ai,S=u.get("text-rotation-alignment")!=="viewport"&&u.get("symbol-placement")!=="point",C=u.get("text-keep-upright"),k=u.get("text-size");for(const N of h.bucket.features){const F=u.get("text-font").evaluate(N,{},h.canonical).join(","),G=k.evaluate(N,{},h.canonical),Y=g.layoutTextSize.evaluate(N,{},h.canonical),J=g.layoutIconSize.evaluate(N,{},h.canonical),re={horizontal:{},vertical:void 0},le=N.text;let pe,be=[0,0];if(le){const De=le.toString(),Ue=u.get("text-letter-spacing").evaluate(N,{},h.canonical)*ai,Ke=B_(De)?Ue:0,it=u.get("text-anchor").evaluate(N,{},h.canonical),yt=Xk(o,N,h.canonical);if(!yt){const ft=u.get("text-radial-offset").evaluate(N,{},h.canonical);be=ft?Kk(it,[ft*ai,Ow]):u.get("text-offset").evaluate(N,{},h.canonical).map(mt=>mt*ai)}let ht=S?"center":u.get("text-justify").evaluate(N,{},h.canonical);const pt=u.get("symbol-placement")==="point"?u.get("text-max-width").evaluate(N,{},h.canonical)*ai:1/0,Ot=()=>{h.bucket.allowVerticalPlacement&&mf(De)&&(re.vertical=ov(le,h.glyphMap,h.glyphPositions,h.imagePositions,F,pt,b,it,"left",Ke,be,l.ao.vertical,!0,Y,G))};if(!S&&yt){const ft=new Set;if(ht==="auto")for(let et=0;et<yt.values.length;et+=2)ft.add(zw(yt.values[et]));else ft.add(ht);let mt=!1;for(const et of ft)if(!re.horizontal[et])if(mt)re.horizontal[et]=re.horizontal[0];else{const Vt=ov(le,h.glyphMap,h.glyphPositions,h.imagePositions,F,pt,b,"center",et,Ke,be,l.ao.horizontal,!1,Y,G);Vt&&(re.horizontal[et]=Vt,mt=Vt.positionedLines.length===1)}Ot()}else{ht==="auto"&&(ht=zw(it));const ft=ov(le,h.glyphMap,h.glyphPositions,h.imagePositions,F,pt,b,it,ht,Ke,be,l.ao.horizontal,!1,Y,G);ft&&(re.horizontal[ht]=ft),Ot(),mf(De)&&S&&C&&(re.vertical=ov(le,h.glyphMap,h.glyphPositions,h.imagePositions,F,pt,b,it,ht,Ke,be,l.ao.vertical,!1,Y,G))}}let Fe=!1;if(N.icon&&N.icon.name){const De=h.imageMap[N.icon.name];De&&(pe=m8(h.imagePositions[N.icon.name],u.get("icon-offset").evaluate(N,{},h.canonical),u.get("icon-anchor").evaluate(N,{},h.canonical)),Fe=!!De.sdf,h.bucket.sdfIcons===void 0?h.bucket.sdfIcons=Fe:h.bucket.sdfIcons!==Fe&&Rt("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(De.pixelRatio!==h.bucket.pixelRatio||u.get("icon-rotate").constantOr(1)!==0)&&(h.bucket.iconsNeedLinear=!0))}const ke=Qk(re.horizontal)||re.vertical;h.bucket.iconsInText=!!ke&&ke.iconsInText,(ke||pe)&&k8(h.bucket,N,re,pe,h.imageMap,g,Y,J,be,Fe,h.canonical,h.subdivisionGranularity)}h.showCollisionBoxes&&h.bucket.generateCollisionDebugBuffers()},l.cI=_w,l.cJ=xw,l.cK=bw,l.cL=rk,l.cM=Sw,l.cN=class{constructor(h){this._marks={start:[h.url,"start"].join("#"),end:[h.url,"end"].join("#"),measure:h.url.toString()},performance.mark(this._marks.start)}finish(){performance.mark(this._marks.end);let h=performance.getEntriesByName(this._marks.measure);return h.length===0&&(performance.measure(this._marks.measure,this._marks.start,this._marks.end),h=performance.getEntriesByName(this._marks.measure),performance.clearMarks(this._marks.start),performance.clearMarks(this._marks.end),performance.clearMeasures(this._marks.measure)),h}},l.cO=function(h,o,u,f,g){return a(this,void 0,void 0,function*(){if(R())try{return yield Nn(h,o,u,f,g)}catch{}return function(b,S,C,k,N){const F=b.width,G=b.height;xi&&rn||(xi=new OffscreenCanvas(F,G),rn=xi.getContext("2d",{willReadFrequently:!0})),xi.width=F,xi.height=G,rn.drawImage(b,0,0,F,G);const Y=rn.getImageData(S,C,k,N);return rn.clearRect(0,0,F,G),Y.data}(h,o,u,f,g)})},l.cP=GA,l.cQ=y,l.cR=tk,l.cS=Mf,l.cT=rf,l.cU=function(h,o){const u=new Map;if(h!=null)if(h.type==="Feature")u.set(Dg(h,o),h);else for(const f of h.features)u.set(Dg(f,o),f);return u},l.cV=function(h,o){if(h==null)return!0;if(h.type==="Feature")return Dg(h,o)!=null;if(h.type==="FeatureCollection"){const u=new Set;for(const f of h.features){const g=Dg(f,o);if(g==null||u.has(g))return!1;u.add(g)}return!0}return!1},l.cW=function(h,o,u){var f,g,b,S;if(o.removeAll&&h.clear(),o.remove)for(const C of o.remove)h.delete(C);if(o.add)for(const C of o.add){const k=Dg(C,u);k!=null&&h.set(k,C)}if(o.update)for(const C of o.update){let k=h.get(C.id);if(k==null)continue;const N=!C.removeAllProperties&&(((f=C.removeProperties)===null||f===void 0?void 0:f.length)>0||((g=C.addOrUpdateProperties)===null||g===void 0?void 0:g.length)>0);if((C.newGeometry||C.removeAllProperties||N)&&(k=Object.assign({},k),h.set(C.id,k),N&&(k.properties=Object.assign({},k.properties))),C.newGeometry&&(k.geometry=C.newGeometry),C.removeAllProperties)k.properties={};else if(((b=C.removeProperties)===null||b===void 0?void 0:b.length)>0)for(const F of C.removeProperties)Object.prototype.hasOwnProperty.call(k.properties,F)&&delete k.properties[F];if(((S=C.addOrUpdateProperties)===null||S===void 0?void 0:S.length)>0)for(const{key:F,value:G}of C.addOrUpdateProperties)k.properties[F]=G}},l.cX=ja,l.ca=function(h,o){var u=h[0],f=h[1],g=h[2],b=h[3],S=h[4],C=h[5],k=h[6],N=h[7],F=h[8],G=h[9],Y=h[10],J=h[11],re=h[12],le=h[13],pe=h[14],be=h[15],Fe=o[0],ke=o[1],De=o[2],Ue=o[3],Ke=o[4],it=o[5],yt=o[6],ht=o[7],pt=o[8],Ot=o[9],ft=o[10],mt=o[11],et=o[12],Vt=o[13],Ut=o[14],jt=o[15];return Math.abs(u-Fe)<=z*Math.max(1,Math.abs(u),Math.abs(Fe))&&Math.abs(f-ke)<=z*Math.max(1,Math.abs(f),Math.abs(ke))&&Math.abs(g-De)<=z*Math.max(1,Math.abs(g),Math.abs(De))&&Math.abs(b-Ue)<=z*Math.max(1,Math.abs(b),Math.abs(Ue))&&Math.abs(S-Ke)<=z*Math.max(1,Math.abs(S),Math.abs(Ke))&&Math.abs(C-it)<=z*Math.max(1,Math.abs(C),Math.abs(it))&&Math.abs(k-yt)<=z*Math.max(1,Math.abs(k),Math.abs(yt))&&Math.abs(N-ht)<=z*Math.max(1,Math.abs(N),Math.abs(ht))&&Math.abs(F-pt)<=z*Math.max(1,Math.abs(F),Math.abs(pt))&&Math.abs(G-Ot)<=z*Math.max(1,Math.abs(G),Math.abs(Ot))&&Math.abs(Y-ft)<=z*Math.max(1,Math.abs(Y),Math.abs(ft))&&Math.abs(J-mt)<=z*Math.max(1,Math.abs(J),Math.abs(mt))&&Math.abs(re-et)<=z*Math.max(1,Math.abs(re),Math.abs(et))&&Math.abs(le-Vt)<=z*Math.max(1,Math.abs(le),Math.abs(Vt))&&Math.abs(pe-Ut)<=z*Math.max(1,Math.abs(pe),Math.abs(Ut))&&Math.abs(be-jt)<=z*Math.max(1,Math.abs(be),Math.abs(jt))},l.cb=function(h,o){return h[0]=o[0],h[1]=o[1],h[2]=o[2],h[3]=o[3],h[4]=o[4],h[5]=o[5],h[6]=o[6],h[7]=o[7],h[8]=o[8],h[9]=o[9],h[10]=o[10],h[11]=o[11],h[12]=o[12],h[13]=o[13],h[14]=o[14],h[15]=o[15],h},l.cc=h=>h.type==="symbol",l.cd=h=>h.type==="circle",l.ce=h=>h.type==="heatmap",l.cf=h=>h.type==="line",l.cg=h=>h.type==="fill",l.ch=h=>h.type==="fill-extrusion",l.ci=h=>h.type==="hillshade",l.cj=h=>h.type==="color-relief",l.ck=h=>h.type==="background",l.cl=h=>h.type==="custom",l.cm=at,l.cn=function(h,o,u){const f=fe(o.x-u.x,o.y-u.y),g=fe(h.x-u.x,h.y-u.y);var b,S;return St(Math.atan2(f[0]*g[1]-f[1]*g[0],(b=f)[0]*(S=g)[0]+b[1]*S[1]))},l.co=_t,l.cp=function(h,o){return Br[o]&&(h instanceof MouseEvent||h instanceof WheelEvent)},l.cq=function(h,o){return Sn[o]&&"touches"in h},l.cr=function(h){return Sn[h]||Br[h]},l.cs=function(h,o,u){var f=o[0],g=o[1];return h[0]=u[0]*f+u[4]*g+u[12],h[1]=u[1]*f+u[5]*g+u[13],h},l.ct=function(h,o){const{x:u,y:f}=Rg.fromLngLat(o);return!(h<0||h>25||f<0||f>=1||u<0||u>=1)},l.cu=function(h,o){return h[0]=o[0],h[1]=0,h[2]=0,h[3]=0,h[4]=0,h[5]=o[1],h[6]=0,h[7]=0,h[8]=0,h[9]=0,h[10]=o[2],h[11]=0,h[12]=0,h[13]=0,h[14]=0,h[15]=1,h},l.cv=class extends Nc{},l.cw=I8,l.cy=function(h){return h.message===Me},l.cz=Ae,l.d=ze,l.e=Ht,l.f=h=>a(void 0,void 0,void 0,function*(){if(h.byteLength===0)return createImageBitmap(new ImageData(1,1));const o=new Blob([new Uint8Array(h)],{type:"image/png"});try{return createImageBitmap(o)}catch(u){throw new Error(`Could not load image because of ${u.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`)}}),l.g=de,l.h=h=>new Promise((o,u)=>{const f=new Image;f.onload=()=>{o(f),URL.revokeObjectURL(f.src),f.onload=null,window.requestAnimationFrame(()=>{f.src=Gn})},f.onerror=()=>u(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const g=new Blob([new Uint8Array(h)],{type:"image/png"});f.src=h.byteLength?URL.createObjectURL(g):Gn}),l.i=Nr,l.j=(h,o)=>Be(Ht(h,{type:"json"}),o),l.k=Tt,l.l=Qe,l.m=Be,l.n=(h,o)=>Be(Ht(h,{type:"arrayBuffer"}),o),l.o=function(h){return new Sw(h).readFields(i8,[])},l.p=mk,l.q=bg,l.r=Hi,l.s=Zt,l.t=cg,l.u=cr,l.v=je,l.w=Rt,l.x=rw,l.y=j_,l.z=Na}),s("worker",["./shared"],function(l){class a{constructor(ne,oe){this.keyCache={},ne&&this.replace(ne,oe)}replace(ne,oe){this._layerConfigs={},this._layers={},this.update(ne,[],oe)}update(ne,oe,de){for(const Ae of ne){this._layerConfigs[Ae.id]=Ae;const Oe=this._layers[Ae.id]=l.bJ(Ae,de);Oe._featureFilter=l.aa(Oe.filter,de),this.keyCache[Ae.id]&&delete this.keyCache[Ae.id]}for(const Ae of oe)delete this.keyCache[Ae],delete this._layerConfigs[Ae],delete this._layers[Ae];this.familiesBySource={};const we=l.cC(Object.values(this._layerConfigs),this.keyCache);for(const Ae of we){const Oe=Ae.map(Tt=>this._layers[Tt.id]),Be=Oe[0];if(Be.visibility==="none")continue;const ze=Be.source||"";let He=this.familiesBySource[ze];He||(He=this.familiesBySource[ze]={});const nt=Be.sourceLayer||"_geojsonTileLayer";let Qe=He[nt];Qe||(Qe=He[nt]=[]),Qe.push(Oe)}}}class m{constructor(ne){const oe={},de=[];for(const Be in ne){const ze=ne[Be],He=oe[Be]={};for(const nt in ze){const Qe=ze[+nt];if(!Qe||Qe.bitmap.width===0||Qe.bitmap.height===0)continue;const Tt={x:0,y:0,w:Qe.bitmap.width+2,h:Qe.bitmap.height+2};de.push(Tt),He[nt]={rect:Tt,metrics:Qe.metrics}}}const{w:we,h:Ae}=l.p(de),Oe=new l.q({width:we||1,height:Ae||1});for(const Be in ne){const ze=ne[Be];for(const He in ze){const nt=ze[+He];if(!nt||nt.bitmap.width===0||nt.bitmap.height===0)continue;const Qe=oe[Be][He].rect;l.q.copy(nt.bitmap,Oe,{x:0,y:0},{x:Qe.x+1,y:Qe.y+1},nt.bitmap)}}this.image=Oe,this.positions=oe}}l.cD("GlyphAtlas",m);class y{constructor(ne){this.tileID=new l.Z(ne.tileID.overscaledZ,ne.tileID.wrap,ne.tileID.canonical.z,ne.tileID.canonical.x,ne.tileID.canonical.y),this.uid=ne.uid,this.zoom=ne.zoom,this.pixelRatio=ne.pixelRatio,this.tileSize=ne.tileSize,this.source=ne.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=ne.showCollisionBoxes,this.collectResourceTiming=!!ne.collectResourceTiming,this.returnDependencies=!!ne.returnDependencies,this.promoteId=ne.promoteId,this.inFlightDependencies=[]}parse(ne,oe,de,we,Ae){return l._(this,void 0,void 0,function*(){this.status="parsing",this.data=ne,this.collisionBoxArray=new l.a8;const Oe=new l.cE(Object.keys(ne.layers).sort()),Be=new l.cF(this.tileID,this.promoteId);Be.bucketLayerIDs=[];const ze={},He={featureIndex:Be,iconDependencies:{},patternDependencies:{},glyphDependencies:{},dashDependencies:{},availableImages:de,subdivisionGranularity:Ae},nt=oe.familiesBySource[this.source];for(const Tr in nt){const ot=ne.layers[Tr];if(!ot)continue;ot.version===1&&l.w(`Vector tile source "${this.source}" layer "${Tr}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const Ds=Oe.encode(Tr),Bi=[];for(let $i=0;$i<ot.length;$i++){const Tn=ot.feature($i),dt=Be.getId(Tn,Tr);Bi.push({feature:Tn,id:dt,index:$i,sourceLayerIndex:Ds})}for(const $i of nt[Tr]){const Tn=$i[0];Tn.source!==this.source&&l.w(`layer.source = ${Tn.source} does not equal this.source = ${this.source}`),Tn.minzoom&&this.zoom<Math.floor(Tn.minzoom)||Tn.maxzoom&&this.zoom>=Tn.maxzoom||Tn.visibility!=="none"&&(v($i,this.zoom,de),(ze[Tn.id]=Tn.createBucket({index:Be.bucketLayerIDs.length,layers:$i,zoom:this.zoom,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:Ds,sourceID:this.source})).populate(Bi,He,this.tileID.canonical),Be.bucketLayerIDs.push($i.map(dt=>dt.id)))}}const Qe=l.bO(He.glyphDependencies,Tr=>Object.keys(Tr).map(Number));this.inFlightDependencies.forEach(Tr=>Tr==null?void 0:Tr.abort()),this.inFlightDependencies=[];let Tt=Promise.resolve({});if(Object.keys(Qe).length){const Tr=new AbortController;this.inFlightDependencies.push(Tr),Tt=we.sendAsync({type:"GG",data:{stacks:Qe,source:this.source,tileID:this.tileID,type:"glyphs"}},Tr)}const It=Object.keys(He.iconDependencies);let je=Promise.resolve({});if(It.length){const Tr=new AbortController;this.inFlightDependencies.push(Tr),je=we.sendAsync({type:"GI",data:{icons:It,source:this.source,tileID:this.tileID,type:"icons"}},Tr)}const Kt=Object.keys(He.patternDependencies);let wt=Promise.resolve({});if(Kt.length){const Tr=new AbortController;this.inFlightDependencies.push(Tr),wt=we.sendAsync({type:"GI",data:{icons:Kt,source:this.source,tileID:this.tileID,type:"patterns"}},Tr)}const lt=He.dashDependencies;let Dt=Promise.resolve({});if(Object.keys(lt).length){const Tr=new AbortController;this.inFlightDependencies.push(Tr),Dt=we.sendAsync({type:"GDA",data:{dashes:lt}},Tr)}const[_r,xr,kr,Vr]=yield Promise.all([Tt,je,wt,Dt]),tr=new m(_r),zr=new l.cG(xr,kr);for(const Tr in ze){const ot=ze[Tr];ot instanceof l.a9?(v(ot.layers,this.zoom,de),l.cH({bucket:ot,glyphMap:_r,glyphPositions:tr.positions,imageMap:xr,imagePositions:zr.iconPositions,showCollisionBoxes:this.showCollisionBoxes,canonical:this.tileID.canonical,subdivisionGranularity:He.subdivisionGranularity})):ot.hasDependencies&&(ot instanceof l.cI||ot instanceof l.cJ||ot instanceof l.cK)&&(v(ot.layers,this.zoom,de),ot.addFeatures(He,this.tileID.canonical,zr.patternPositions,Vr))}return this.status="done",{buckets:Object.values(ze).filter(Tr=>!Tr.isEmpty()),featureIndex:Be,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:tr.image,imageAtlas:zr,dashPositions:Vr,glyphMap:this.returnDependencies?_r:null,iconMap:this.returnDependencies?xr:null,glyphPositions:this.returnDependencies?tr.positions:null}})}}function v(Me,ne,oe){const de=new l.F(ne);for(const we of Me)we.recalculate(de,oe)}class T{constructor(ne,oe,de){this.actor=ne,this.layerIndex=oe,this.availableImages=de,this.fetching={},this.loading={},this.loaded={}}loadVectorTile(ne,oe){return l._(this,void 0,void 0,function*(){const de=yield l.n(ne.request,oe);try{return{vectorTile:new l.cL(new l.cM(de.data)),rawData:de.data,cacheControl:de.cacheControl,expires:de.expires}}catch(we){const Ae=new Uint8Array(de.data);let Oe=`Unable to parse the tile at ${ne.request.url}, `;throw Oe+=Ae[0]===31&&Ae[1]===139?"please make sure the data is not gzipped and that you have configured the relevant header in the server":`got error: ${we.message}`,new Error(Oe)}})}loadTile(ne){return l._(this,void 0,void 0,function*(){const oe=ne.uid,de=!!(ne&&ne.request&&ne.request.collectResourceTiming)&&new l.cN(ne.request),we=new y(ne);this.loading[oe]=we;const Ae=new AbortController;we.abort=Ae;try{const Oe=yield this.loadVectorTile(ne,Ae);if(delete this.loading[oe],!Oe)return null;const Be=Oe.rawData,ze={};Oe.expires&&(ze.expires=Oe.expires),Oe.cacheControl&&(ze.cacheControl=Oe.cacheControl);const He={};if(de){const Qe=de.finish();Qe&&(He.resourceTiming=JSON.parse(JSON.stringify(Qe)))}we.vectorTile=Oe.vectorTile;const nt=we.parse(Oe.vectorTile,this.layerIndex,this.availableImages,this.actor,ne.subdivisionGranularity);this.loaded[oe]=we,this.fetching[oe]={rawTileData:Be,cacheControl:ze,resourceTiming:He};try{const Qe=yield nt;return l.e({rawTileData:Be.slice(0)},Qe,ze,He)}finally{delete this.fetching[oe]}}catch(Oe){throw delete this.loading[oe],we.status="done",this.loaded[oe]=we,Oe}})}reloadTile(ne){return l._(this,void 0,void 0,function*(){const oe=ne.uid;if(!this.loaded||!this.loaded[oe])throw new Error("Should not be trying to reload a tile that was never loaded or has been removed");const de=this.loaded[oe];if(de.showCollisionBoxes=ne.showCollisionBoxes,de.status==="parsing"){const we=yield de.parse(de.vectorTile,this.layerIndex,this.availableImages,this.actor,ne.subdivisionGranularity);let Ae;if(this.fetching[oe]){const{rawTileData:Oe,cacheControl:Be,resourceTiming:ze}=this.fetching[oe];delete this.fetching[oe],Ae=l.e({rawTileData:Oe.slice(0)},we,Be,ze)}else Ae=we;return Ae}if(de.status==="done"&&de.vectorTile)return de.parse(de.vectorTile,this.layerIndex,this.availableImages,this.actor,ne.subdivisionGranularity)})}abortTile(ne){return l._(this,void 0,void 0,function*(){const oe=this.loading,de=ne.uid;oe&&oe[de]&&oe[de].abort&&(oe[de].abort.abort(),delete oe[de])})}removeTile(ne){return l._(this,void 0,void 0,function*(){this.loaded&&this.loaded[ne.uid]&&delete this.loaded[ne.uid]})}}class P{constructor(){this.loaded={}}loadTile(ne){return l._(this,void 0,void 0,function*(){const{uid:oe,encoding:de,rawImageData:we,redFactor:Ae,greenFactor:Oe,blueFactor:Be,baseShift:ze}=ne,He=we.width+2,nt=we.height+2,Qe=l.b(we)?new l.R({width:He,height:nt},yield l.cO(we,-1,-1,He,nt)):we,Tt=new l.cP(oe,Qe,de,Ae,Oe,Be,ze);return this.loaded=this.loaded||{},this.loaded[oe]=Tt,Tt})}removeTile(ne){const oe=this.loaded,de=ne.uid;oe&&oe[de]&&delete oe[de]}}var A,O,I=function(){if(O)return A;function Me(oe,de){if(oe.length!==0){ne(oe[0],de);for(var we=1;we<oe.length;we++)ne(oe[we],!de)}}function ne(oe,de){for(var we=0,Ae=0,Oe=0,Be=oe.length,ze=Be-1;Oe<Be;ze=Oe++){var He=(oe[Oe][0]-oe[ze][0])*(oe[ze][1]+oe[Oe][1]),nt=we+He;Ae+=Math.abs(we)>=Math.abs(He)?we-nt+He:He-nt+we,we=nt}we+Ae>=0!=!!de&&oe.reverse()}return O=1,A=function oe(de,we){var Ae,Oe=de&&de.type;if(Oe==="FeatureCollection")for(Ae=0;Ae<de.features.length;Ae++)oe(de.features[Ae],we);else if(Oe==="GeometryCollection")for(Ae=0;Ae<de.geometries.length;Ae++)oe(de.geometries[Ae],we);else if(Oe==="Feature")oe(de.geometry,we);else if(Oe==="Polygon")Me(de.coordinates,we);else if(Oe==="MultiPolygon")for(Ae=0;Ae<de.coordinates.length;Ae++)Me(de.coordinates[Ae],we);return de}}(),L=l.cQ(I);class R extends l.cS{constructor(ne,oe){super(new l.cM,0,oe,[],[]),this.feature=ne,this.type=ne.type,this.properties=ne.tags?ne.tags:{},"id"in ne&&(typeof ne.id=="string"?this.id=parseInt(ne.id,10):typeof ne.id!="number"||isNaN(ne.id)||(this.id=ne.id))}loadGeometry(){const ne=[],oe=this.feature.type===1?[this.feature.geometry]:this.feature.geometry;for(const de of oe){const we=[];for(const Ae of de)we.push(new l.P(Ae[0],Ae[1]));ne.push(we)}return ne}}class z extends l.cR{constructor(ne,oe){super(new l.cM),this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.version=oe?oe.version:1,this.extent=oe?oe.extent:4096,this.length=ne.length,this.features=ne}feature(ne){return new R(this.features[ne],this.extent)}}function j(Me,ne){ne.writeVarintField(15,Me.version||1),ne.writeStringField(1,Me.name||""),ne.writeVarintField(5,Me.extent||4096);const oe={keys:[],values:[],keycache:{},valuecache:{}};for(let Ae=0;Ae<Me.length;Ae++)oe.feature=Me.feature(Ae),ne.writeMessage(2,W,oe);const de=oe.keys;for(const Ae of de)ne.writeStringField(3,Ae);const we=oe.values;for(const Ae of we)ne.writeMessage(4,q,Ae)}function W(Me,ne){if(!Me.feature)return;const oe=Me.feature;oe.id!==void 0&&ne.writeVarintField(1,oe.id),ne.writeMessage(2,Z,Me),ne.writeVarintField(3,oe.type),ne.writeMessage(4,V,oe)}function Z(Me,ne){var oe;for(const de in(oe=Me.feature)==null?void 0:oe.properties){let we=Me.feature.properties[de],Ae=Me.keycache[de];if(we===null)continue;Ae===void 0&&(Me.keys.push(de),Ae=Me.keys.length-1,Me.keycache[de]=Ae),ne.writeVarint(Ae),typeof we!="string"&&typeof we!="boolean"&&typeof we!="number"&&(we=JSON.stringify(we));const Oe=typeof we+":"+we;let Be=Me.valuecache[Oe];Be===void 0&&(Me.values.push(we),Be=Me.values.length-1,Me.valuecache[Oe]=Be),ne.writeVarint(Be)}}function te(Me,ne){return(ne<<3)+(7&Me)}function ie(Me){return Me<<1^Me>>31}function V(Me,ne){const oe=Me.loadGeometry(),de=Me.type;let we=0,Ae=0;for(const Oe of oe){let Be=1;de===1&&(Be=Oe.length),ne.writeVarint(te(1,Be));const ze=de===3?Oe.length-1:Oe.length;for(let He=0;He<ze;He++){He===1&&de!==1&&ne.writeVarint(te(2,ze-1));const nt=Oe[He].x-we,Qe=Oe[He].y-Ae;ne.writeVarint(ie(nt)),ne.writeVarint(ie(Qe)),we+=nt,Ae+=Qe}Me.type===3&&ne.writeVarint(te(7,1))}}function q(Me,ne){const oe=typeof Me;oe==="string"?ne.writeStringField(1,Me):oe==="boolean"?ne.writeBooleanField(7,Me):oe==="number"&&(Me%1!=0?ne.writeDoubleField(3,Me):Me<0?ne.writeSVarintField(6,Me):ne.writeVarintField(5,Me))}const Q={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:Me=>Me},ce=Math.fround||(se=new Float32Array(1),Me=>(se[0]=+Me,se[0]));var se;class ue{constructor(ne){this.options=Object.assign(Object.create(Q),ne),this.trees=new Array(this.options.maxZoom+1),this.stride=this.options.reduce?7:6,this.clusterProps=[]}load(ne){const{log:oe,minZoom:de,maxZoom:we}=this.options;oe&&console.time("total time");const Ae=`prepare ${ne.length} points`;oe&&console.time(Ae),this.points=ne;const Oe=[];for(let ze=0;ze<ne.length;ze++){const He=ne[ze];if(!He.geometry)continue;const[nt,Qe]=He.geometry.coordinates,Tt=ce(xe(nt)),It=ce(Se(Qe));Oe.push(Tt,It,1/0,ze,-1,1),this.options.reduce&&Oe.push(0)}let Be=this.trees[we+1]=this._createTree(Oe);oe&&console.timeEnd(Ae);for(let ze=we;ze>=de;ze--){const He=+Date.now();Be=this.trees[ze]=this._createTree(this._cluster(Be,ze)),oe&&console.log("z%d: %d clusters in %dms",ze,Be.numItems,+Date.now()-He)}return oe&&console.timeEnd("total time"),this}getClusters(ne,oe){let de=((ne[0]+180)%360+360)%360-180;const we=Math.max(-90,Math.min(90,ne[1]));let Ae=ne[2]===180?180:((ne[2]+180)%360+360)%360-180;const Oe=Math.max(-90,Math.min(90,ne[3]));if(ne[2]-ne[0]>=360)de=-180,Ae=180;else if(de>Ae){const Qe=this.getClusters([de,we,180,Oe],oe),Tt=this.getClusters([-180,we,Ae,Oe],oe);return Qe.concat(Tt)}const Be=this.trees[this._limitZoom(oe)],ze=Be.range(xe(de),Se(Oe),xe(Ae),Se(we)),He=Be.data,nt=[];for(const Qe of ze){const Tt=this.stride*Qe;nt.push(He[Tt+5]>1?he(He,Tt,this.clusterProps):this.points[He[Tt+3]])}return nt}getChildren(ne){const oe=this._getOriginId(ne),de=this._getOriginZoom(ne),we="No cluster with the specified id.",Ae=this.trees[de];if(!Ae)throw new Error(we);const Oe=Ae.data;if(oe*this.stride>=Oe.length)throw new Error(we);const Be=this.options.radius/(this.options.extent*Math.pow(2,de-1)),ze=Ae.within(Oe[oe*this.stride],Oe[oe*this.stride+1],Be),He=[];for(const nt of ze){const Qe=nt*this.stride;Oe[Qe+4]===ne&&He.push(Oe[Qe+5]>1?he(Oe,Qe,this.clusterProps):this.points[Oe[Qe+3]])}if(He.length===0)throw new Error(we);return He}getLeaves(ne,oe,de){const we=[];return this._appendLeaves(we,ne,oe=oe||10,de=de||0,0),we}getTile(ne,oe,de){const we=this.trees[this._limitZoom(ne)],Ae=Math.pow(2,ne),{extent:Oe,radius:Be}=this.options,ze=Be/Oe,He=(de-ze)/Ae,nt=(de+1+ze)/Ae,Qe={features:[]};return this._addTileFeatures(we.range((oe-ze)/Ae,He,(oe+1+ze)/Ae,nt),we.data,oe,de,Ae,Qe),oe===0&&this._addTileFeatures(we.range(1-ze/Ae,He,1,nt),we.data,Ae,de,Ae,Qe),oe===Ae-1&&this._addTileFeatures(we.range(0,He,ze/Ae,nt),we.data,-1,de,Ae,Qe),Qe.features.length?Qe:null}getClusterExpansionZoom(ne){let oe=this._getOriginZoom(ne)-1;for(;oe<=this.options.maxZoom;){const de=this.getChildren(ne);if(oe++,de.length!==1)break;ne=de[0].properties.cluster_id}return oe}_appendLeaves(ne,oe,de,we,Ae){const Oe=this.getChildren(oe);for(const Be of Oe){const ze=Be.properties;if(ze&&ze.cluster?Ae+ze.point_count<=we?Ae+=ze.point_count:Ae=this._appendLeaves(ne,ze.cluster_id,de,we,Ae):Ae<we?Ae++:ne.push(Be),ne.length===de)break}return Ae}_createTree(ne){const oe=new l.aI(ne.length/this.stride|0,this.options.nodeSize,Float32Array);for(let de=0;de<ne.length;de+=this.stride)oe.add(ne[de],ne[de+1]);return oe.finish(),oe.data=ne,oe}_addTileFeatures(ne,oe,de,we,Ae,Oe){for(const Be of ne){const ze=Be*this.stride,He=oe[ze+5]>1;let nt,Qe,Tt;if(He)nt=ye(oe,ze,this.clusterProps),Qe=oe[ze],Tt=oe[ze+1];else{const Kt=this.points[oe[ze+3]];nt=Kt.properties;const[wt,lt]=Kt.geometry.coordinates;Qe=xe(wt),Tt=Se(lt)}const It={type:1,geometry:[[Math.round(this.options.extent*(Qe*Ae-de)),Math.round(this.options.extent*(Tt*Ae-we))]],tags:nt};let je;je=He||this.options.generateId?oe[ze+3]:this.points[oe[ze+3]].id,je!==void 0&&(It.id=je),Oe.features.push(It)}}_limitZoom(ne){return Math.max(this.options.minZoom,Math.min(Math.floor(+ne),this.options.maxZoom+1))}_cluster(ne,oe){const{radius:de,extent:we,reduce:Ae,minPoints:Oe}=this.options,Be=de/(we*Math.pow(2,oe)),ze=ne.data,He=[],nt=this.stride;for(let Qe=0;Qe<ze.length;Qe+=nt){if(ze[Qe+2]<=oe)continue;ze[Qe+2]=oe;const Tt=ze[Qe],It=ze[Qe+1],je=ne.within(ze[Qe],ze[Qe+1],Be),Kt=ze[Qe+5];let wt=Kt;for(const lt of je){const Dt=lt*nt;ze[Dt+2]>oe&&(wt+=ze[Dt+5])}if(wt>Kt&&wt>=Oe){let lt,Dt=Tt*Kt,_r=It*Kt,xr=-1;const kr=(Qe/nt<<5)+(oe+1)+this.points.length;for(const Vr of je){const tr=Vr*nt;if(ze[tr+2]<=oe)continue;ze[tr+2]=oe;const zr=ze[tr+5];Dt+=ze[tr]*zr,_r+=ze[tr+1]*zr,ze[tr+4]=kr,Ae&&(lt||(lt=this._map(ze,Qe,!0),xr=this.clusterProps.length,this.clusterProps.push(lt)),Ae(lt,this._map(ze,tr)))}ze[Qe+4]=kr,He.push(Dt/wt,_r/wt,1/0,kr,-1,wt),Ae&&He.push(xr)}else{for(let lt=0;lt<nt;lt++)He.push(ze[Qe+lt]);if(wt>1)for(const lt of je){const Dt=lt*nt;if(!(ze[Dt+2]<=oe)){ze[Dt+2]=oe;for(let _r=0;_r<nt;_r++)He.push(ze[Dt+_r])}}}}return He}_getOriginId(ne){return ne-this.points.length>>5}_getOriginZoom(ne){return(ne-this.points.length)%32}_map(ne,oe,de){if(ne[oe+5]>1){const Oe=this.clusterProps[ne[oe+6]];return de?Object.assign({},Oe):Oe}const we=this.points[ne[oe+3]].properties,Ae=this.options.map(we);return de&&Ae===we?Object.assign({},Ae):Ae}}function he(Me,ne,oe){return{type:"Feature",id:Me[ne+3],properties:ye(Me,ne,oe),geometry:{type:"Point",coordinates:[(de=Me[ne],360*(de-.5)),fe(Me[ne+1])]}};var de}function ye(Me,ne,oe){const de=Me[ne+5],we=de>=1e4?`${Math.round(de/1e3)}k`:de>=1e3?Math.round(de/100)/10+"k":de,Ae=Me[ne+6],Oe=Ae===-1?{}:Object.assign({},oe[Ae]);return Object.assign(Oe,{cluster:!0,cluster_id:Me[ne+3],point_count:de,point_count_abbreviated:we})}function xe(Me){return Me/360+.5}function Se(Me){const ne=Math.sin(Me*Math.PI/180),oe=.5-.25*Math.log((1+ne)/(1-ne))/Math.PI;return oe<0?0:oe>1?1:oe}function fe(Me){const ne=(180-360*Me)*Math.PI/180;return 360*Math.atan(Math.exp(ne))/Math.PI-90}function ve(Me,ne,oe,de){let we=de;const Ae=ne+(oe-ne>>1);let Oe,Be=oe-ne;const ze=Me[ne],He=Me[ne+1],nt=Me[oe],Qe=Me[oe+1];for(let Tt=ne+3;Tt<oe;Tt+=3){const It=Re(Me[Tt],Me[Tt+1],ze,He,nt,Qe);if(It>we)Oe=Tt,we=It;else if(It===we){const je=Math.abs(Tt-Ae);je<Be&&(Oe=Tt,Be=je)}}we>de&&(Oe-ne>3&&ve(Me,ne,Oe,de),Me[Oe+2]=we,oe-Oe>3&&ve(Me,Oe,oe,de))}function Re(Me,ne,oe,de,we,Ae){let Oe=we-oe,Be=Ae-de;if(Oe!==0||Be!==0){const ze=((Me-oe)*Oe+(ne-de)*Be)/(Oe*Oe+Be*Be);ze>1?(oe=we,de=Ae):ze>0&&(oe+=Oe*ze,de+=Be*ze)}return Oe=Me-oe,Be=ne-de,Oe*Oe+Be*Be}function $e(Me,ne,oe,de){const we={id:Me??null,type:ne,geometry:oe,tags:de,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};if(ne==="Point"||ne==="MultiPoint"||ne==="LineString")Xe(we,oe);else if(ne==="Polygon")Xe(we,oe[0]);else if(ne==="MultiLineString")for(const Ae of oe)Xe(we,Ae);else if(ne==="MultiPolygon")for(const Ae of oe)Xe(we,Ae[0]);return we}function Xe(Me,ne){for(let oe=0;oe<ne.length;oe+=3)Me.minX=Math.min(Me.minX,ne[oe]),Me.minY=Math.min(Me.minY,ne[oe+1]),Me.maxX=Math.max(Me.maxX,ne[oe]),Me.maxY=Math.max(Me.maxY,ne[oe+1])}function st(Me,ne,oe,de){if(!ne.geometry)return;const we=ne.geometry.coordinates;if(we&&we.length===0)return;const Ae=ne.geometry.type,Oe=Math.pow(oe.tolerance/((1<<oe.maxZoom)*oe.extent),2);let Be=[],ze=ne.id;if(oe.promoteId?ze=ne.properties[oe.promoteId]:oe.generateId&&(ze=de||0),Ae==="Point")at(we,Be);else if(Ae==="MultiPoint")for(const He of we)at(He,Be);else if(Ae==="LineString")_t(we,Be,Oe,!1);else if(Ae==="MultiLineString"){if(oe.lineMetrics){for(const He of we)Be=[],_t(He,Be,Oe,!1),Me.push($e(ze,"LineString",Be,ne.properties));return}Ct(we,Be,Oe,!1)}else if(Ae==="Polygon")Ct(we,Be,Oe,!0);else{if(Ae!=="MultiPolygon"){if(Ae==="GeometryCollection"){for(const He of ne.geometry.geometries)st(Me,{id:ze,geometry:He,properties:ne.properties},oe,de);return}throw new Error("Input data is not a valid GeoJSON object.")}for(const He of we){const nt=[];Ct(He,nt,Oe,!0),Be.push(nt)}}Me.push($e(ze,Ae,Be,ne.properties))}function at(Me,ne){ne.push(Pt(Me[0]),Ht(Me[1]),0)}function _t(Me,ne,oe,de){let we,Ae,Oe=0;for(let ze=0;ze<Me.length;ze++){const He=Pt(Me[ze][0]),nt=Ht(Me[ze][1]);ne.push(He,nt,0),ze>0&&(Oe+=de?(we*nt-He*Ae)/2:Math.sqrt(Math.pow(He-we,2)+Math.pow(nt-Ae,2))),we=He,Ae=nt}const Be=ne.length-3;ne[2]=1,ve(ne,0,Be,oe),ne[Be+2]=1,ne.size=Math.abs(Oe),ne.start=0,ne.end=ne.size}function Ct(Me,ne,oe,de){for(let we=0;we<Me.length;we++){const Ae=[];_t(Me[we],Ae,oe,de),ne.push(Ae)}}function Pt(Me){return Me/360+.5}function Ht(Me){const ne=Math.sin(Me*Math.PI/180),oe=.5-.25*Math.log((1+ne)/(1-ne))/Math.PI;return oe<0?0:oe>1?1:oe}function ir(Me,ne,oe,de,we,Ae,Oe,Be){if(de/=ne,Ae>=(oe/=ne)&&Oe<de)return Me;if(Oe<oe||Ae>=de)return null;const ze=[];for(const He of Me){const nt=He.geometry;let Qe=He.type;const Tt=we===0?He.minX:He.minY,It=we===0?He.maxX:He.maxY;if(Tt>=oe&&It<de){ze.push(He);continue}if(It<oe||Tt>=de)continue;let je=[];if(Qe==="Point"||Qe==="MultiPoint")yr(nt,je,oe,de,we);else if(Qe==="LineString")$t(nt,je,oe,de,we,!1,Be.lineMetrics);else if(Qe==="MultiLineString")Et(nt,je,oe,de,we,!1);else if(Qe==="Polygon")Et(nt,je,oe,de,we,!0);else if(Qe==="MultiPolygon")for(const Kt of nt){const wt=[];Et(Kt,wt,oe,de,we,!0),wt.length&&je.push(wt)}if(je.length){if(Be.lineMetrics&&Qe==="LineString"){for(const Kt of je)ze.push($e(He.id,Qe,Kt,He.tags));continue}Qe!=="LineString"&&Qe!=="MultiLineString"||(je.length===1?(Qe="LineString",je=je[0]):Qe="MultiLineString"),Qe!=="Point"&&Qe!=="MultiPoint"||(Qe=je.length===3?"Point":"MultiPoint"),ze.push($e(He.id,Qe,je,He.tags))}}return ze.length?ze:null}function yr(Me,ne,oe,de,we){for(let Ae=0;Ae<Me.length;Ae+=3){const Oe=Me[Ae+we];Oe>=oe&&Oe<=de&&Rt(ne,Me[Ae],Me[Ae+1],Me[Ae+2])}}function $t(Me,ne,oe,de,we,Ae,Oe){let Be=vt(Me);const ze=we===0?Ft:Nr;let He,nt,Qe=Me.start;for(let wt=0;wt<Me.length-3;wt+=3){const lt=Me[wt],Dt=Me[wt+1],_r=Me[wt+2],xr=Me[wt+3],kr=Me[wt+4],Vr=we===0?lt:Dt,tr=we===0?xr:kr;let zr=!1;Oe&&(He=Math.sqrt(Math.pow(lt-xr,2)+Math.pow(Dt-kr,2))),Vr<oe?tr>oe&&(nt=ze(Be,lt,Dt,xr,kr,oe),Oe&&(Be.start=Qe+He*nt)):Vr>de?tr<de&&(nt=ze(Be,lt,Dt,xr,kr,de),Oe&&(Be.start=Qe+He*nt)):Rt(Be,lt,Dt,_r),tr<oe&&Vr>=oe&&(nt=ze(Be,lt,Dt,xr,kr,oe),zr=!0),tr>de&&Vr<=de&&(nt=ze(Be,lt,Dt,xr,kr,de),zr=!0),!Ae&&zr&&(Oe&&(Be.end=Qe+He*nt),ne.push(Be),Be=vt(Me)),Oe&&(Qe+=He)}let Tt=Me.length-3;const It=Me[Tt],je=Me[Tt+1],Kt=we===0?It:je;Kt>=oe&&Kt<=de&&Rt(Be,It,je,Me[Tt+2]),Tt=Be.length-3,Ae&&Tt>=3&&(Be[Tt]!==Be[0]||Be[Tt+1]!==Be[1])&&Rt(Be,Be[0],Be[1],Be[2]),Be.length&&ne.push(Be)}function vt(Me){const ne=[];return ne.size=Me.size,ne.start=Me.start,ne.end=Me.end,ne}function Et(Me,ne,oe,de,we,Ae){for(const Oe of Me)$t(Oe,ne,oe,de,we,Ae,!1)}function Rt(Me,ne,oe,de){Me.push(ne,oe,de)}function Ft(Me,ne,oe,de,we,Ae){const Oe=(Ae-ne)/(de-ne);return Rt(Me,Ae,oe+(we-oe)*Oe,1),Oe}function Nr(Me,ne,oe,de,we,Ae){const Oe=(Ae-oe)/(we-oe);return Rt(Me,ne+(de-ne)*Oe,Ae,1),Oe}function Zr(Me,ne){const oe=[];for(let de=0;de<Me.length;de++){const we=Me[de],Ae=we.type;let Oe;if(Ae==="Point"||Ae==="MultiPoint"||Ae==="LineString")Oe=Kr(we.geometry,ne);else if(Ae==="MultiLineString"||Ae==="Polygon"){Oe=[];for(const Be of we.geometry)Oe.push(Kr(Be,ne))}else if(Ae==="MultiPolygon"){Oe=[];for(const Be of we.geometry){const ze=[];for(const He of Be)ze.push(Kr(He,ne));Oe.push(ze)}}oe.push($e(we.id,Ae,Oe,we.tags))}return oe}function Kr(Me,ne){const oe=[];oe.size=Me.size,Me.start!==void 0&&(oe.start=Me.start,oe.end=Me.end);for(let de=0;de<Me.length;de+=3)oe.push(Me[de]+ne,Me[de+1],Me[de+2]);return oe}function Ar(Me,ne){if(Me.transformed)return Me;const oe=1<<Me.z,de=Me.x,we=Me.y;for(const Ae of Me.features){const Oe=Ae.geometry,Be=Ae.type;if(Ae.geometry=[],Be===1)for(let ze=0;ze<Oe.length;ze+=2)Ae.geometry.push(Gn(Oe[ze],Oe[ze+1],ne,oe,de,we));else for(let ze=0;ze<Oe.length;ze++){const He=[];for(let nt=0;nt<Oe[ze].length;nt+=2)He.push(Gn(Oe[ze][nt],Oe[ze][nt+1],ne,oe,de,we));Ae.geometry.push(He)}}return Me.transformed=!0,Me}function Gn(Me,ne,oe,de,we,Ae){return[Math.round(oe*(Me*de-we)),Math.round(oe*(ne*de-Ae))]}function Nn(Me,ne,oe,de,we){const Ae=ne===we.maxZoom?0:we.tolerance/((1<<ne)*we.extent),Oe={features:[],numPoints:0,numSimplified:0,numFeatures:Me.length,source:null,x:oe,y:de,z:ne,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0};for(const Be of Me)xi(Oe,Be,Ae,we);return Oe}function xi(Me,ne,oe,de){const we=ne.geometry,Ae=ne.type,Oe=[];if(Me.minX=Math.min(Me.minX,ne.minX),Me.minY=Math.min(Me.minY,ne.minY),Me.maxX=Math.max(Me.maxX,ne.maxX),Me.maxY=Math.max(Me.maxY,ne.maxY),Ae==="Point"||Ae==="MultiPoint")for(let Be=0;Be<we.length;Be+=3)Oe.push(we[Be],we[Be+1]),Me.numPoints++,Me.numSimplified++;else if(Ae==="LineString")rn(Oe,we,Me,oe,!1,!1);else if(Ae==="MultiLineString"||Ae==="Polygon")for(let Be=0;Be<we.length;Be++)rn(Oe,we[Be],Me,oe,Ae==="Polygon",Be===0);else if(Ae==="MultiPolygon")for(let Be=0;Be<we.length;Be++){const ze=we[Be];for(let He=0;He<ze.length;He++)rn(Oe,ze[He],Me,oe,!0,He===0)}if(Oe.length){let Be=ne.tags||null;if(Ae==="LineString"&&de.lineMetrics){Be={};for(const He in ne.tags)Be[He]=ne.tags[He];Be.mapbox_clip_start=we.start/we.size,Be.mapbox_clip_end=we.end/we.size}const ze={geometry:Oe,type:Ae==="Polygon"||Ae==="MultiPolygon"?3:Ae==="LineString"||Ae==="MultiLineString"?2:1,tags:Be};ne.id!==null&&(ze.id=ne.id),Me.features.push(ze)}}function rn(Me,ne,oe,de,we,Ae){const Oe=de*de;if(de>0&&ne.size<(we?Oe:de))return void(oe.numPoints+=ne.length/3);const Be=[];for(let ze=0;ze<ne.length;ze+=3)(de===0||ne[ze+2]>Oe)&&(oe.numSimplified++,Be.push(ne[ze],ne[ze+1])),oe.numPoints++;we&&function(ze,He){let nt=0;for(let Qe=0,Tt=ze.length,It=Tt-2;Qe<Tt;It=Qe,Qe+=2)nt+=(ze[Qe]-ze[It])*(ze[Qe+1]+ze[It+1]);if(nt>0===He)for(let Qe=0,Tt=ze.length;Qe<Tt/2;Qe+=2){const It=ze[Qe],je=ze[Qe+1];ze[Qe]=ze[Tt-2-Qe],ze[Qe+1]=ze[Tt-1-Qe],ze[Tt-2-Qe]=It,ze[Tt-1-Qe]=je}}(Be,Ae),Me.push(Be)}const Zt={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0};class Or{constructor(ne,oe){const de=(oe=this.options=function(Ae,Oe){for(const Be in Oe)Ae[Be]=Oe[Be];return Ae}(Object.create(Zt),oe)).debug;if(de&&console.time("preprocess data"),oe.maxZoom<0||oe.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(oe.promoteId&&oe.generateId)throw new Error("promoteId and generateId cannot be used together.");let we=function(Ae,Oe){const Be=[];if(Ae.type==="FeatureCollection")for(let ze=0;ze<Ae.features.length;ze++)st(Be,Ae.features[ze],Oe,ze);else st(Be,Ae.type==="Feature"?Ae:{geometry:Ae},Oe);return Be}(ne,oe);this.tiles={},this.tileCoords=[],de&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",oe.indexMaxZoom,oe.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),we=function(Ae,Oe){const Be=Oe.buffer/Oe.extent;let ze=Ae;const He=ir(Ae,1,-1-Be,Be,0,-1,2,Oe),nt=ir(Ae,1,1-Be,2+Be,0,-1,2,Oe);return(He||nt)&&(ze=ir(Ae,1,-Be,1+Be,0,-1,2,Oe)||[],He&&(ze=Zr(He,1).concat(ze)),nt&&(ze=ze.concat(Zr(nt,-1)))),ze}(we,oe),we.length&&this.splitTile(we,0,0,0),de&&(we.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}splitTile(ne,oe,de,we,Ae,Oe,Be){const ze=[ne,oe,de,we],He=this.options,nt=He.debug;for(;ze.length;){we=ze.pop(),de=ze.pop(),oe=ze.pop(),ne=ze.pop();const Qe=1<<oe,Tt=St(oe,de,we);let It=this.tiles[Tt];if(!It&&(nt>1&&console.time("creation"),It=this.tiles[Tt]=Nn(ne,oe,de,we,He),this.tileCoords.push({z:oe,x:de,y:we}),nt)){nt>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",oe,de,we,It.numFeatures,It.numPoints,It.numSimplified),console.timeEnd("creation"));const zr=`z${oe}`;this.stats[zr]=(this.stats[zr]||0)+1,this.total++}if(It.source=ne,Ae==null){if(oe===He.indexMaxZoom||It.numPoints<=He.indexMaxPoints)continue}else{if(oe===He.maxZoom||oe===Ae)continue;if(Ae!=null){const zr=Ae-oe;if(de!==Oe>>zr||we!==Be>>zr)continue}}if(It.source=null,ne.length===0)continue;nt>1&&console.time("clipping");const je=.5*He.buffer/He.extent,Kt=.5-je,wt=.5+je,lt=1+je;let Dt=null,_r=null,xr=null,kr=null,Vr=ir(ne,Qe,de-je,de+wt,0,It.minX,It.maxX,He),tr=ir(ne,Qe,de+Kt,de+lt,0,It.minX,It.maxX,He);ne=null,Vr&&(Dt=ir(Vr,Qe,we-je,we+wt,1,It.minY,It.maxY,He),_r=ir(Vr,Qe,we+Kt,we+lt,1,It.minY,It.maxY,He),Vr=null),tr&&(xr=ir(tr,Qe,we-je,we+wt,1,It.minY,It.maxY,He),kr=ir(tr,Qe,we+Kt,we+lt,1,It.minY,It.maxY,He),tr=null),nt>1&&console.timeEnd("clipping"),ze.push(Dt||[],oe+1,2*de,2*we),ze.push(_r||[],oe+1,2*de,2*we+1),ze.push(xr||[],oe+1,2*de+1,2*we),ze.push(kr||[],oe+1,2*de+1,2*we+1)}}getTile(ne,oe,de){ne=+ne,oe=+oe,de=+de;const we=this.options,{extent:Ae,debug:Oe}=we;if(ne<0||ne>24)return null;const Be=1<<ne,ze=St(ne,oe=oe+Be&Be-1,de);if(this.tiles[ze])return Ar(this.tiles[ze],Ae);Oe>1&&console.log("drilling down to z%d-%d-%d",ne,oe,de);let He,nt=ne,Qe=oe,Tt=de;for(;!He&&nt>0;)nt--,Qe>>=1,Tt>>=1,He=this.tiles[St(nt,Qe,Tt)];return He&&He.source?(Oe>1&&(console.log("found parent tile z%d-%d-%d",nt,Qe,Tt),console.time("drilling down")),this.splitTile(He.source,nt,Qe,Tt,ne,oe,de),Oe>1&&console.timeEnd("drilling down"),this.tiles[ze]?Ar(this.tiles[ze],Ae):null):null}}function St(Me,ne,oe){return 32*((1<<Me)*oe+ne)+Me}class Sn extends T{constructor(){super(...arguments),this._dataUpdateable=new Map}loadVectorTile(ne,oe){return l._(this,void 0,void 0,function*(){const de=ne.tileID.canonical;if(!this._geoJSONIndex)throw new Error("Unable to parse the data into a cluster or geojson");const we=this._geoJSONIndex.getTile(de.z,de.x,de.y);if(!we)return null;const Ae=new z(we.features,{version:2,extent:l.$});let Oe=function(Be){const ze=new l.cM;return function(He,nt){for(const Qe in He.layers)nt.writeMessage(3,j,He.layers[Qe])}(Be,ze),ze.finish()}(Ae);return Oe.byteOffset===0&&Oe.byteLength===Oe.buffer.byteLength||(Oe=new Uint8Array(Oe)),{vectorTile:Ae,rawData:Oe.buffer}})}loadData(ne){return l._(this,void 0,void 0,function*(){var oe;(oe=this._pendingRequest)===null||oe===void 0||oe.abort();const de=!!(ne&&ne.request&&ne.request.collectResourceTiming)&&new l.cN(ne.request);this._pendingRequest=new AbortController;try{this._pendingData=this.loadAndProcessGeoJSON(ne,this._pendingRequest);const we=yield this._pendingData;this._geoJSONIndex=ne.cluster?new ue(function({superclusterOptions:Oe,clusterProperties:Be}){if(!Be||!Oe)return Oe;const ze={},He={},nt={accumulated:null,zoom:0},Qe={properties:null},Tt=Object.keys(Be);for(const It of Tt){const[je,Kt]=Be[It],wt=l.cT(Kt),lt=l.cT(typeof je=="string"?[je,["accumulated"],["get",It]]:je);ze[It]=wt.value,He[It]=lt.value}return Oe.map=It=>{Qe.properties=It;const je={};for(const Kt of Tt)je[Kt]=ze[Kt].evaluate(nt,Qe);return je},Oe.reduce=(It,je)=>{Qe.properties=je;for(const Kt of Tt)nt.accumulated=It[Kt],It[Kt]=He[Kt].evaluate(nt,Qe)},Oe}(ne)).load(we.features):function(Oe,Be){return new Or(Oe,Be)}(we,ne.geojsonVtOptions),this.loaded={};const Ae={data:we};if(de){const Oe=de.finish();Oe&&(Ae.resourceTiming={},Ae.resourceTiming[ne.source]=JSON.parse(JSON.stringify(Oe)))}return Ae}catch(we){if(delete this._pendingRequest,l.cy(we))return{abandoned:!0};throw we}})}getData(){return l._(this,void 0,void 0,function*(){return this._pendingData})}reloadTile(ne){const oe=this.loaded;return oe&&oe[ne.uid]?super.reloadTile(ne):this.loadTile(ne)}loadAndProcessGeoJSON(ne,oe){return l._(this,void 0,void 0,function*(){let de=yield this.loadGeoJSON(ne,oe);if(delete this._pendingRequest,typeof de!="object")throw new Error(`Input data given to '${ne.source}' is not a valid GeoJSON object.`);if(L(de,!0),ne.filter){const we=l.cT(ne.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(we.result==="error")throw new Error(we.value.map(Oe=>`${Oe.key}: ${Oe.message}`).join(", "));de={type:"FeatureCollection",features:de.features.filter(Oe=>we.value.evaluate({zoom:0},Oe))}}return de})}loadGeoJSON(ne,oe){return l._(this,void 0,void 0,function*(){const{promoteId:de}=ne;if(ne.request){const we=yield l.j(ne.request,oe);return this._dataUpdateable=l.cV(we.data,de)?l.cU(we.data,de):void 0,we.data}if(typeof ne.data=="string")try{const we=JSON.parse(ne.data);return this._dataUpdateable=l.cV(we,de)?l.cU(we,de):void 0,we}catch{throw new Error(`Input data given to '${ne.source}' is not a valid GeoJSON object.`)}if(!ne.dataDiff)throw new Error(`Input data given to '${ne.source}' is not a valid GeoJSON object.`);if(!this._dataUpdateable)throw new Error(`Cannot update existing geojson data in ${ne.source}`);return l.cW(this._dataUpdateable,ne.dataDiff,de),{type:"FeatureCollection",features:Array.from(this._dataUpdateable.values())}})}removeSource(ne){return l._(this,void 0,void 0,function*(){this._pendingRequest&&this._pendingRequest.abort()})}getClusterExpansionZoom(ne){return this._geoJSONIndex.getClusterExpansionZoom(ne.clusterId)}getClusterChildren(ne){return this._geoJSONIndex.getChildren(ne.clusterId)}getClusterLeaves(ne){return this._geoJSONIndex.getLeaves(ne.clusterId,ne.limit,ne.offset)}}class Br{constructor(ne){this.self=ne,this.actor=new l.J(ne),this.layerIndexes={},this.availableImages={},this.workerSources={},this.demWorkerSources={},this.externalWorkerSourceTypes={},this.globalStates=new Map,this.self.registerWorkerSource=(oe,de)=>{if(this.externalWorkerSourceTypes[oe])throw new Error(`Worker source with name "${oe}" already registered.`);this.externalWorkerSourceTypes[oe]=de},this.self.addProtocol=l.cA,this.self.removeProtocol=l.cB,this.self.registerRTLTextPlugin=oe=>{l.cX.setMethods(oe)},this.actor.registerMessageHandler("LDT",(oe,de)=>this._getDEMWorkerSource(oe,de.source).loadTile(de)),this.actor.registerMessageHandler("RDT",(oe,de)=>l._(this,void 0,void 0,function*(){this._getDEMWorkerSource(oe,de.source).removeTile(de)})),this.actor.registerMessageHandler("GCEZ",(oe,de)=>l._(this,void 0,void 0,function*(){return this._getWorkerSource(oe,de.type,de.source).getClusterExpansionZoom(de)})),this.actor.registerMessageHandler("GCC",(oe,de)=>l._(this,void 0,void 0,function*(){return this._getWorkerSource(oe,de.type,de.source).getClusterChildren(de)})),this.actor.registerMessageHandler("GCL",(oe,de)=>l._(this,void 0,void 0,function*(){return this._getWorkerSource(oe,de.type,de.source).getClusterLeaves(de)})),this.actor.registerMessageHandler("LD",(oe,de)=>this._getWorkerSource(oe,de.type,de.source).loadData(de)),this.actor.registerMessageHandler("GD",(oe,de)=>this._getWorkerSource(oe,de.type,de.source).getData()),this.actor.registerMessageHandler("LT",(oe,de)=>this._getWorkerSource(oe,de.type,de.source).loadTile(de)),this.actor.registerMessageHandler("RT",(oe,de)=>this._getWorkerSource(oe,de.type,de.source).reloadTile(de)),this.actor.registerMessageHandler("AT",(oe,de)=>this._getWorkerSource(oe,de.type,de.source).abortTile(de)),this.actor.registerMessageHandler("RMT",(oe,de)=>this._getWorkerSource(oe,de.type,de.source).removeTile(de)),this.actor.registerMessageHandler("RS",(oe,de)=>l._(this,void 0,void 0,function*(){if(!this.workerSources[oe]||!this.workerSources[oe][de.type]||!this.workerSources[oe][de.type][de.source])return;const we=this.workerSources[oe][de.type][de.source];delete this.workerSources[oe][de.type][de.source],we.removeSource!==void 0&&we.removeSource(de)})),this.actor.registerMessageHandler("RM",oe=>l._(this,void 0,void 0,function*(){delete this.layerIndexes[oe],delete this.availableImages[oe],delete this.workerSources[oe],delete this.demWorkerSources[oe],this.globalStates.delete(oe)})),this.actor.registerMessageHandler("SR",(oe,de)=>l._(this,void 0,void 0,function*(){this.referrer=de})),this.actor.registerMessageHandler("SRPS",(oe,de)=>this._syncRTLPluginState(oe,de)),this.actor.registerMessageHandler("IS",(oe,de)=>l._(this,void 0,void 0,function*(){this.self.importScripts(de)})),this.actor.registerMessageHandler("SI",(oe,de)=>this._setImages(oe,de)),this.actor.registerMessageHandler("UL",(oe,de)=>l._(this,void 0,void 0,function*(){this._getLayerIndex(oe).update(de.layers,de.removedIds,this._getGlobalState(oe))})),this.actor.registerMessageHandler("UGS",(oe,de)=>l._(this,void 0,void 0,function*(){const we=this._getGlobalState(oe);for(const Ae in de)we[Ae]=de[Ae]})),this.actor.registerMessageHandler("SL",(oe,de)=>l._(this,void 0,void 0,function*(){this._getLayerIndex(oe).replace(de,this._getGlobalState(oe))}))}_getGlobalState(ne){let oe=this.globalStates.get(ne);return oe||(oe={},this.globalStates.set(ne,oe)),oe}_setImages(ne,oe){return l._(this,void 0,void 0,function*(){this.availableImages[ne]=oe;for(const de in this.workerSources[ne]){const we=this.workerSources[ne][de];for(const Ae in we)we[Ae].availableImages=oe}})}_syncRTLPluginState(ne,oe){return l._(this,void 0,void 0,function*(){return yield l.cX.syncState(oe,this.self.importScripts)})}_getAvailableImages(ne){let oe=this.availableImages[ne];return oe||(oe=[]),oe}_getLayerIndex(ne){let oe=this.layerIndexes[ne];return oe||(oe=this.layerIndexes[ne]=new a),oe}_getWorkerSource(ne,oe,de){if(this.workerSources[ne]||(this.workerSources[ne]={}),this.workerSources[ne][oe]||(this.workerSources[ne][oe]={}),!this.workerSources[ne][oe][de]){const we={sendAsync:(Ae,Oe)=>(Ae.targetMapId=ne,this.actor.sendAsync(Ae,Oe))};switch(oe){case"vector":this.workerSources[ne][oe][de]=new T(we,this._getLayerIndex(ne),this._getAvailableImages(ne));break;case"geojson":this.workerSources[ne][oe][de]=new Sn(we,this._getLayerIndex(ne),this._getAvailableImages(ne));break;default:this.workerSources[ne][oe][de]=new this.externalWorkerSourceTypes[oe](we,this._getLayerIndex(ne),this._getAvailableImages(ne))}}return this.workerSources[ne][oe][de]}_getDEMWorkerSource(ne,oe){return this.demWorkerSources[ne]||(this.demWorkerSources[ne]={}),this.demWorkerSources[ne][oe]||(this.demWorkerSources[ne][oe]=new P),this.demWorkerSources[ne][oe]}}return l.i(self)&&(self.worker=new Br(self)),Br}),s("index",["exports","./shared"],function(l,a){var m="5.9.0";function y(){var x=new a.A(4);return a.A!=Float32Array&&(x[1]=0,x[2]=0),x[0]=1,x[3]=1,x}let v,T;const P={now:typeof performance<"u"&&performance&&performance.now?performance.now.bind(performance):Date.now.bind(Date),frame(x,i,d){const p=requestAnimationFrame(w=>{_(),i(w)}),{unsubscribe:_}=a.s(x.signal,"abort",()=>{_(),cancelAnimationFrame(p),d(a.c())},!1)},frameAsync(x){return new Promise((i,d)=>{this.frame(x,i,d)})},getImageData(x,i=0){return this.getImageCanvasContext(x).getImageData(-i,-i,x.width+2*i,x.height+2*i)},getImageCanvasContext(x){const i=window.document.createElement("canvas"),d=i.getContext("2d",{willReadFrequently:!0});if(!d)throw new Error("failed to create canvas 2d context");return i.width=x.width,i.height=x.height,d.drawImage(x,0,0,x.width,x.height),d},resolveURL:x=>(v||(v=document.createElement("a")),v.href=x,v.href),hardwareConcurrency:typeof navigator<"u"&&navigator.hardwareConcurrency||4,get prefersReducedMotion(){return!!matchMedia&&(T==null&&(T=matchMedia("(prefers-reduced-motion: reduce)")),T.matches)}};class A{static testProp(i){if(!A.docStyle)return i[0];for(let d=0;d<i.length;d++)if(i[d]in A.docStyle)return i[d];return i[0]}static create(i,d,p){const _=window.document.createElement(i);return d!==void 0&&(_.className=d),p&&p.appendChild(_),_}static createNS(i,d){return window.document.createElementNS(i,d)}static disableDrag(){A.docStyle&&A.selectProp&&(A.userSelect=A.docStyle[A.selectProp],A.docStyle[A.selectProp]="none")}static enableDrag(){A.docStyle&&A.selectProp&&(A.docStyle[A.selectProp]=A.userSelect)}static setTransform(i,d){i.style[A.transformProp]=d}static addEventListener(i,d,p,_={}){i.addEventListener(d,p,"passive"in _?_:_.capture)}static removeEventListener(i,d,p,_={}){i.removeEventListener(d,p,"passive"in _?_:_.capture)}static suppressClickInternal(i){i.preventDefault(),i.stopPropagation(),window.removeEventListener("click",A.suppressClickInternal,!0)}static suppressClick(){window.addEventListener("click",A.suppressClickInternal,!0),window.setTimeout(()=>{window.removeEventListener("click",A.suppressClickInternal,!0)},0)}static getScale(i){const d=i.getBoundingClientRect();return{x:d.width/i.offsetWidth||1,y:d.height/i.offsetHeight||1,boundingClientRect:d}}static getPoint(i,d,p){const _=d.boundingClientRect;return new a.P((p.clientX-_.left)/d.x-i.clientLeft,(p.clientY-_.top)/d.y-i.clientTop)}static mousePos(i,d){const p=A.getScale(i);return A.getPoint(i,p,d)}static touchPos(i,d){const p=[],_=A.getScale(i);for(let w=0;w<d.length;w++)p.push(A.getPoint(i,_,d[w]));return p}static mouseButton(i){return i.button}static remove(i){i.parentNode&&i.parentNode.removeChild(i)}static sanitize(i){const d=new DOMParser().parseFromString(i,"text/html").body||document.createElement("body"),p=d.querySelectorAll("script");for(const _ of p)_.remove();return A.clean(d),d.innerHTML}static isPossiblyDangerous(i,d){const p=d.replace(/\s+/g,"").toLowerCase();return!(!["src","href","xlink:href"].includes(i)||!p.includes("javascript:")&&!p.includes("data:"))||!!i.startsWith("on")||void 0}static clean(i){const d=i.children;for(const p of d)A.removeAttributes(p),A.clean(p)}static removeAttributes(i){for(const{name:d,value:p}of i.attributes)A.isPossiblyDangerous(d,p)&&i.removeAttribute(d)}}A.docStyle=typeof window<"u"&&window.document&&window.document.documentElement.style,A.selectProp=A.testProp(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]),A.transformProp=A.testProp(["transform","WebkitTransform"]);const O={supported:!1,testSupport:function(x){!R&&L&&(z?j(x):I=x)}};let I,L,R=!1,z=!1;function j(x){const i=x.createTexture();x.bindTexture(x.TEXTURE_2D,i);try{if(x.texImage2D(x.TEXTURE_2D,0,x.RGBA,x.RGBA,x.UNSIGNED_BYTE,L),x.isContextLost())return;O.supported=!0}catch{}x.deleteTexture(i),R=!0}var W;typeof document<"u"&&(L=document.createElement("img"),L.onload=()=>{I&&j(I),I=null,z=!0},L.onerror=()=>{R=!0,I=null},L.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA="),function(x){let i,d,p,_;x.resetRequestQueue=()=>{i=[],d=0,p=0,_={}},x.addThrottleControl=D=>{const $=p++;return _[$]=D,$},x.removeThrottleControl=D=>{delete _[D],E()},x.getImage=(D,$,U=!0)=>new Promise((K,H)=>{O.supported&&(D.headers||(D.headers={}),D.headers.accept="image/webp,*/*"),a.e(D,{type:"image"}),i.push({abortController:$,requestParameters:D,supportImageRefresh:U,state:"queued",onError:ee=>{H(ee)},onSuccess:ee=>{K(ee)}}),E()});const w=D=>a._(this,void 0,void 0,function*(){D.state="running";const{requestParameters:$,supportImageRefresh:U,onError:K,onSuccess:H,abortController:ee}=D,ae=U===!1&&!a.i(self)&&!a.g($.url)&&(!$.headers||Object.keys($.headers).reduce((_e,Te)=>_e&&Te==="accept",!0));d++;const me=ae?M($,ee):a.m($,ee);try{const _e=yield me;delete D.abortController,D.state="completed",_e.data instanceof HTMLImageElement||a.b(_e.data)?H(_e):_e.data&&H({data:yield(ge=_e.data,typeof createImageBitmap=="function"?a.f(ge):a.h(ge)),cacheControl:_e.cacheControl,expires:_e.expires})}catch(_e){delete D.abortController,K(_e)}finally{d--,E()}var ge}),E=()=>{const D=(()=>{for(const $ of Object.keys(_))if(_[$]())return!0;return!1})()?a.a.MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:a.a.MAX_PARALLEL_IMAGE_REQUESTS;for(let $=d;$<D&&i.length>0;$++){const U=i.shift();U.abortController.signal.aborted?$--:w(U)}},M=(D,$)=>new Promise((U,K)=>{const H=new Image,ee=D.url,ae=D.credentials;ae&&ae==="include"?H.crossOrigin="use-credentials":(ae&&ae==="same-origin"||!a.d(ee))&&(H.crossOrigin="anonymous"),$.signal.addEventListener("abort",()=>{H.src="",K(a.c())}),H.fetchPriority="high",H.onload=()=>{H.onerror=H.onload=null,U({data:H})},H.onerror=()=>{H.onerror=H.onload=null,$.signal.aborted||K(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))},H.src=ee})}(W||(W={})),W.resetRequestQueue();class Z{constructor(i){this._transformRequestFn=i??null}transformRequest(i,d){return this._transformRequestFn&&this._transformRequestFn(i,d)||{url:i}}setTransformRequest(i){this._transformRequestFn=i}}function te(x){const i=[];if(typeof x=="string")i.push({id:"default",url:x});else if(x&&x.length>0){const d=[];for(const{id:p,url:_}of x){const w=`${p}${_}`;d.indexOf(w)===-1&&(d.push(w),i.push({id:p,url:_}))}}return i}function ie(x,i,d){try{const p=new URL(x);return p.pathname+=`${i}${d}`,p.toString()}catch{throw new Error(`Invalid sprite URL "${x}", must be absolute. Modify style specification directly or use TransformStyleFunction to correct the issue dynamically`)}}function V(x){const{userImage:i}=x;return!!(i&&i.render&&i.render())&&(x.data.replace(new Uint8Array(i.data.buffer)),!0)}class q extends a.E{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new a.R({width:1,height:1}),this.dirty=!0}isLoaded(){return this.loaded}setLoaded(i){if(this.loaded!==i&&(this.loaded=i,i)){for(const{ids:d,promiseResolve:p}of this.requestors)p(this._getImagesForIds(d));this.requestors=[]}}getImage(i){const d=this.images[i];if(d&&!d.data&&d.spriteData){const p=d.spriteData;d.data=new a.R({width:p.width,height:p.height},p.context.getImageData(p.x,p.y,p.width,p.height).data),d.spriteData=null}return d}addImage(i,d){if(this.images[i])throw new Error(`Image id ${i} already exist, use updateImage instead`);this._validate(i,d)&&(this.images[i]=d)}_validate(i,d){let p=!0;const _=d.data||d.spriteData;return this._validateStretch(d.stretchX,_&&_.width)||(this.fire(new a.k(new Error(`Image "${i}" has invalid "stretchX" value`))),p=!1),this._validateStretch(d.stretchY,_&&_.height)||(this.fire(new a.k(new Error(`Image "${i}" has invalid "stretchY" value`))),p=!1),this._validateContent(d.content,d)||(this.fire(new a.k(new Error(`Image "${i}" has invalid "content" value`))),p=!1),p}_validateStretch(i,d){if(!i)return!0;let p=0;for(const _ of i){if(_[0]<p||_[1]<_[0]||d<_[1])return!1;p=_[1]}return!0}_validateContent(i,d){if(!i)return!0;if(i.length!==4)return!1;const p=d.spriteData,_=p&&p.width||d.data.width,w=p&&p.height||d.data.height;return!(i[0]<0||_<i[0]||i[1]<0||w<i[1]||i[2]<0||_<i[2]||i[3]<0||w<i[3]||i[2]<i[0]||i[3]<i[1])}updateImage(i,d,p=!0){const _=this.getImage(i);if(p&&(_.data.width!==d.data.width||_.data.height!==d.data.height))throw new Error(`size mismatch between old image (${_.data.width}x${_.data.height}) and new image (${d.data.width}x${d.data.height}).`);d.version=_.version+1,this.images[i]=d,this.updatedImages[i]=!0}removeImage(i){const d=this.images[i];delete this.images[i],delete this.patterns[i],d.userImage&&d.userImage.onRemove&&d.userImage.onRemove()}listImages(){return Object.keys(this.images)}getImages(i){return new Promise((d,p)=>{let _=!0;if(!this.isLoaded())for(const w of i)this.images[w]||(_=!1);this.isLoaded()||_?d(this._getImagesForIds(i)):this.requestors.push({ids:i,promiseResolve:d})})}_getImagesForIds(i){const d={};for(const p of i){let _=this.getImage(p);_||(this.fire(new a.l("styleimagemissing",{id:p})),_=this.getImage(p)),_?d[p]={data:_.data.clone(),pixelRatio:_.pixelRatio,sdf:_.sdf,version:_.version,stretchX:_.stretchX,stretchY:_.stretchY,content:_.content,textFitWidth:_.textFitWidth,textFitHeight:_.textFitHeight,hasRenderCallback:!!(_.userImage&&_.userImage.render)}:a.w(`Image "${p}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}return d}getPixelSize(){const{width:i,height:d}=this.atlasImage;return{width:i,height:d}}getPattern(i){const d=this.patterns[i],p=this.getImage(i);if(!p)return null;if(d&&d.position.version===p.version)return d.position;if(d)d.position.version=p.version;else{const _={w:p.data.width+2,h:p.data.height+2,x:0,y:0},w=new a.I(_,p);this.patterns[i]={bin:_,position:w}}return this._updatePatternAtlas(),this.patterns[i].position}bind(i){const d=i.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new a.T(i,this.atlasImage,d.RGBA),this.atlasTexture.bind(d.LINEAR,d.CLAMP_TO_EDGE)}_updatePatternAtlas(){const i=[];for(const w in this.patterns)i.push(this.patterns[w].bin);const{w:d,h:p}=a.p(i),_=this.atlasImage;_.resize({width:d||1,height:p||1});for(const w in this.patterns){const{bin:E}=this.patterns[w],M=E.x+1,D=E.y+1,$=this.getImage(w).data,U=$.width,K=$.height;a.R.copy($,_,{x:0,y:0},{x:M,y:D},{width:U,height:K}),a.R.copy($,_,{x:0,y:K-1},{x:M,y:D-1},{width:U,height:1}),a.R.copy($,_,{x:0,y:0},{x:M,y:D+K},{width:U,height:1}),a.R.copy($,_,{x:U-1,y:0},{x:M-1,y:D},{width:1,height:K}),a.R.copy($,_,{x:0,y:0},{x:M+U,y:D},{width:1,height:K})}this.dirty=!0}beginFrame(){this.callbackDispatchedThisFrame={}}dispatchRenderCallbacks(i){for(const d of i){if(this.callbackDispatchedThisFrame[d])continue;this.callbackDispatchedThisFrame[d]=!0;const p=this.getImage(d);p||a.w(`Image with ID: "${d}" was not found`),V(p)&&this.updateImage(d,p)}}}const Q=1e20;function ce(x,i,d,p,_,w,E,M,D){for(let $=i;$<i+p;$++)se(x,d*w+$,w,_,E,M,D);for(let $=d;$<d+_;$++)se(x,$*w+i,1,p,E,M,D)}function se(x,i,d,p,_,w,E){w[0]=0,E[0]=-Q,E[1]=Q,_[0]=x[i];for(let M=1,D=0,$=0;M<p;M++){_[M]=x[i+M*d];const U=M*M;do{const K=w[D];$=(_[M]-_[K]+U-K*K)/(M-K)/2}while($<=E[D]&&--D>-1);D++,w[D]=M,E[D]=$,E[D+1]=Q}for(let M=0,D=0;M<p;M++){for(;E[D+1]<M;)D++;const $=w[D],U=M-$;x[i+M*d]=_[$]+U*U}}class ue{constructor(i,d,p){this.requestManager=i,this.localIdeographFontFamily=d,this.entries={},this.lang=p}setURL(i){this.url=i}getGlyphs(i){return a._(this,void 0,void 0,function*(){const d=[];for(const w in i)for(const E of i[w])d.push(this._getAndCacheGlyphsPromise(w,E));const p=yield Promise.all(d),_={};for(const{stack:w,id:E,glyph:M}of p)_[w]||(_[w]={}),_[w][E]=M&&{id:M.id,bitmap:M.bitmap.clone(),metrics:M.metrics};return _})}_getAndCacheGlyphsPromise(i,d){return a._(this,void 0,void 0,function*(){let p=this.entries[i];p||(p=this.entries[i]={glyphs:{},requests:{},ranges:{}});let _=p.glyphs[d];if(_!==void 0)return{stack:i,id:d,glyph:_};if(_=this._tinySDF(p,i,d),_)return p.glyphs[d]=_,{stack:i,id:d,glyph:_};const w=Math.floor(d/256);if(256*w>65535)throw new Error("glyphs > 65535 not supported");if(p.ranges[w])return{stack:i,id:d,glyph:_};if(!this.url)throw new Error("glyphsUrl is not set");if(!p.requests[w]){const M=ue.loadGlyphRange(i,w,this.url,this.requestManager);p.requests[w]=M}const E=yield p.requests[w];for(const M in E)this._doesCharSupportLocalGlyph(+M)||(p.glyphs[+M]=E[+M]);return p.ranges[w]=!0,{stack:i,id:d,glyph:E[d]||null}})}_doesCharSupportLocalGlyph(i){return!!this.localIdeographFontFamily&&(new RegExp("\\p{Ideo}|\\p{sc=Hang}|\\p{sc=Hira}|\\p{sc=Kana}","u").test(String.fromCodePoint(i))||a.u["CJK Unified Ideographs"](i)||a.u["Hangul Syllables"](i)||a.u.Hiragana(i)||a.u.Katakana(i)||a.u["CJK Symbols and Punctuation"](i)||a.u["Halfwidth and Fullwidth Forms"](i))}_tinySDF(i,d,p){const _=this.localIdeographFontFamily;if(!_||!this._doesCharSupportLocalGlyph(p))return;let w=i.tinySDF;if(!w){let M="400";/bold/i.test(d)?M="900":/medium/i.test(d)?M="500":/light/i.test(d)&&(M="200"),w=i.tinySDF=new ue.TinySDF({fontSize:48,buffer:6,radius:16,cutoff:.25,lang:this.lang,fontFamily:_,fontWeight:M})}const E=w.draw(String.fromCharCode(p));return{id:p,bitmap:new a.q({width:E.width||60,height:E.height||60},E.data),metrics:{width:E.glyphWidth/2||24,height:E.glyphHeight/2||24,left:E.glyphLeft/2+.5||0,top:E.glyphTop/2-27.5||-8,advance:E.glyphAdvance/2||24,isDoubleResolution:!0}}}}ue.loadGlyphRange=function(x,i,d,p){return a._(this,void 0,void 0,function*(){const _=256*i,w=_+255,E=p.transformRequest(d.replace("{fontstack}",x).replace("{range}",`${_}-${w}`),"Glyphs"),M=yield a.n(E,new AbortController);if(!M||!M.data)throw new Error(`Could not load glyph range. range: ${i}, ${_}-${w}`);const D={};for(const $ of a.o(M.data))D[$.id]=$;return D})},ue.TinySDF=class{constructor({fontSize:x=24,buffer:i=3,radius:d=8,cutoff:p=.25,fontFamily:_="sans-serif",fontWeight:w="normal",fontStyle:E="normal",lang:M=null}={}){this.buffer=i,this.cutoff=p,this.radius=d,this.lang=M;const D=this.size=x+4*i,$=this._createCanvas(D),U=this.ctx=$.getContext("2d",{willReadFrequently:!0});U.font=`${E} ${w} ${x}px ${_}`,U.textBaseline="alphabetic",U.textAlign="left",U.fillStyle="black",this.gridOuter=new Float64Array(D*D),this.gridInner=new Float64Array(D*D),this.f=new Float64Array(D),this.z=new Float64Array(D+1),this.v=new Uint16Array(D)}_createCanvas(x){const i=document.createElement("canvas");return i.width=i.height=x,i}draw(x){const{width:i,actualBoundingBoxAscent:d,actualBoundingBoxDescent:p,actualBoundingBoxLeft:_,actualBoundingBoxRight:w}=this.ctx.measureText(x),E=Math.ceil(d),M=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(w-_))),D=Math.min(this.size-this.buffer,E+Math.ceil(p)),$=M+2*this.buffer,U=D+2*this.buffer,K=Math.max($*U,0),H=new Uint8ClampedArray(K),ee={data:H,width:$,height:U,glyphWidth:M,glyphHeight:D,glyphTop:E,glyphLeft:0,glyphAdvance:i};if(M===0||D===0)return ee;const{ctx:ae,buffer:me,gridInner:ge,gridOuter:_e}=this;this.lang&&(ae.lang=this.lang),ae.clearRect(me,me,M,D),ae.fillText(x,me,me+E);const Te=ae.getImageData(me,me,M,D);_e.fill(Q,0,K),ge.fill(0,0,K);for(let Ce=0;Ce<D;Ce++)for(let Ee=0;Ee<M;Ee++){const Ie=Te.data[4*(Ce*M+Ee)+3]/255;if(Ie===0)continue;const Le=(Ce+me)*$+Ee+me;if(Ie===1)_e[Le]=0,ge[Le]=Q;else{const Pe=.5-Ie;_e[Le]=Pe>0?Pe*Pe:0,ge[Le]=Pe<0?Pe*Pe:0}}ce(_e,0,0,$,U,$,this.f,this.v,this.z),ce(ge,me,me,M,D,$,this.f,this.v,this.z);for(let Ce=0;Ce<K;Ce++){const Ee=Math.sqrt(_e[Ce])-Math.sqrt(ge[Ce]);H[Ce]=Math.round(255-255*(Ee/this.radius+this.cutoff))}return ee}};class he{constructor(){this.specification=a.v.light.position}possiblyEvaluate(i,d){return a.B(i.expression.evaluate(d))}interpolate(i,d,p){return{x:a.C.number(i.x,d.x,p),y:a.C.number(i.y,d.y,p),z:a.C.number(i.z,d.z,p)}}}let ye;class xe extends a.E{constructor(i){super(),ye=ye||new a.r({anchor:new a.D(a.v.light.anchor),position:new he,color:new a.D(a.v.light.color),intensity:new a.D(a.v.light.intensity)}),this._transitionable=new a.t(ye,void 0),this.setLight(i),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(i,d={}){if(!this._validate(a.x,i,d))for(const p in i){const _=i[p];p.endsWith("-transition")?this._transitionable.setTransition(p.slice(0,-11),_):this._transitionable.setValue(p,_)}}updateTransitions(i){this._transitioning=this._transitionable.transitioned(i,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(i){this.properties=this._transitioning.possiblyEvaluate(i)}_validate(i,d,p){return(!p||p.validate!==!1)&&a.y(this,i.call(a.z,{value:d,style:{glyphs:!0,sprite:!0},styleSpec:a.v}))}}const Se=new a.r({"sky-color":new a.D(a.v.sky["sky-color"]),"horizon-color":new a.D(a.v.sky["horizon-color"]),"fog-color":new a.D(a.v.sky["fog-color"]),"fog-ground-blend":new a.D(a.v.sky["fog-ground-blend"]),"horizon-fog-blend":new a.D(a.v.sky["horizon-fog-blend"]),"sky-horizon-blend":new a.D(a.v.sky["sky-horizon-blend"]),"atmosphere-blend":new a.D(a.v.sky["atmosphere-blend"])});class fe extends a.E{constructor(i){super(),this._transitionable=new a.t(Se,void 0),this.setSky(i),this._transitioning=this._transitionable.untransitioned(),this.recalculate(new a.F(0))}setSky(i,d={}){if(!this._validate(a.G,i,d)){i||(i={"sky-color":"transparent","horizon-color":"transparent","fog-color":"transparent","fog-ground-blend":1,"atmosphere-blend":0});for(const p in i){const _=i[p];p.endsWith("-transition")?this._transitionable.setTransition(p.slice(0,-11),_):this._transitionable.setValue(p,_)}}}getSky(){return this._transitionable.serialize()}updateTransitions(i){this._transitioning=this._transitionable.transitioned(i,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(i){this.properties=this._transitioning.possiblyEvaluate(i)}_validate(i,d,p={}){return(p==null?void 0:p.validate)!==!1&&a.y(this,i.call(a.z,a.e({value:d,style:{glyphs:!0,sprite:!0},styleSpec:a.v})))}calculateFogBlendOpacity(i){return i<60?0:i<70?(i-60)/10:1}}class ve{constructor(i,d){this.width=i,this.height=d,this.nextRow=0,this.data=new Uint8Array(this.width*this.height),this.dashEntry={}}getDash(i,d){const p=i.join(",")+String(d);return this.dashEntry[p]||(this.dashEntry[p]=this.addDash(i,d)),this.dashEntry[p]}getDashRanges(i,d,p){const _=[];let w=i.length%2==1?-i[i.length-1]*p:0,E=i[0]*p,M=!0;_.push({left:w,right:E,isDash:M,zeroLength:i[0]===0});let D=i[0];for(let $=1;$<i.length;$++){M=!M;const U=i[$];w=D*p,D+=U,E=D*p,_.push({left:w,right:E,isDash:M,zeroLength:U===0})}return _}addRoundDash(i,d,p){const _=d/2;for(let w=-p;w<=p;w++){const E=this.width*(this.nextRow+p+w);let M=0,D=i[M];for(let $=0;$<this.width;$++){$/D.right>1&&(D=i[++M]);const U=Math.abs($-D.left),K=Math.abs($-D.right),H=Math.min(U,K);let ee;const ae=w/p*(_+1);if(D.isDash){const me=_-Math.abs(ae);ee=Math.sqrt(H*H+me*me)}else ee=_-Math.sqrt(H*H+ae*ae);this.data[E+$]=Math.max(0,Math.min(255,ee+128))}}}addRegularDash(i){for(let M=i.length-1;M>=0;--M){const D=i[M],$=i[M+1];D.zeroLength?i.splice(M,1):$&&$.isDash===D.isDash&&($.left=D.left,i.splice(M,1))}const d=i[0],p=i[i.length-1];d.isDash===p.isDash&&(d.left=p.left-this.width,p.right=d.right+this.width);const _=this.width*this.nextRow;let w=0,E=i[w];for(let M=0;M<this.width;M++){M/E.right>1&&(E=i[++w]);const D=Math.abs(M-E.left),$=Math.abs(M-E.right),U=Math.min(D,$);this.data[_+M]=Math.max(0,Math.min(255,(E.isDash?U:-U)+128))}}addDash(i,d){const p=d?7:0,_=2*p+1;if(this.nextRow+_>this.height)return a.w("LineAtlas out of space"),null;let w=0;for(let M=0;M<i.length;M++)w+=i[M];if(w!==0){const M=this.width/w,D=this.getDashRanges(i,this.width,M);d?this.addRoundDash(D,M,p):this.addRegularDash(D)}const E={y:this.nextRow+p,height:2*p,width:w};return this.nextRow+=_,this.dirty=!0,E}bind(i){const d=i.gl;this.texture?(d.bindTexture(d.TEXTURE_2D,this.texture),this.dirty&&(this.dirty=!1,d.texSubImage2D(d.TEXTURE_2D,0,0,0,this.width,this.height,d.ALPHA,d.UNSIGNED_BYTE,this.data))):(this.texture=d.createTexture(),d.bindTexture(d.TEXTURE_2D,this.texture),d.texParameteri(d.TEXTURE_2D,d.TEXTURE_WRAP_S,d.REPEAT),d.texParameteri(d.TEXTURE_2D,d.TEXTURE_WRAP_T,d.REPEAT),d.texParameteri(d.TEXTURE_2D,d.TEXTURE_MIN_FILTER,d.LINEAR),d.texParameteri(d.TEXTURE_2D,d.TEXTURE_MAG_FILTER,d.LINEAR),d.texImage2D(d.TEXTURE_2D,0,d.ALPHA,this.width,this.height,0,d.ALPHA,d.UNSIGNED_BYTE,this.data))}}const Re="maplibre_preloaded_worker_pool";class $e{constructor(){this.active={}}acquire(i){if(!this.workers)for(this.workers=[];this.workers.length<$e.workerCount;)this.workers.push(new Worker(a.a.WORKER_URL));return this.active[i]=!0,this.workers.slice()}release(i){delete this.active[i],this.numActive()===0&&(this.workers.forEach(d=>{d.terminate()}),this.workers=null)}isPreloaded(){return!!this.active[Re]}numActive(){return Object.keys(this.active).length}}const Xe=Math.floor(P.hardwareConcurrency/2);let st,at;function _t(){return st||(st=new $e),st}$e.workerCount=a.H(globalThis)?Math.max(Math.min(Xe,3),1):1;class Ct{constructor(i,d){this.workerPool=i,this.actors=[],this.currentActor=0,this.id=d;const p=this.workerPool.acquire(d);for(let _=0;_<p.length;_++){const w=new a.J(p[_],d);w.name=`Worker ${_}`,this.actors.push(w)}if(!this.actors.length)throw new Error("No actors found")}broadcast(i,d){const p=[];for(const _ of this.actors)p.push(_.sendAsync({type:i,data:d}));return Promise.all(p)}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(i=!0){this.actors.forEach(d=>{d.remove()}),this.actors=[],i&&this.workerPool.release(this.id)}registerMessageHandler(i,d){for(const p of this.actors)p.registerMessageHandler(i,d)}}function Pt(){return at||(at=new Ct(_t(),a.K),at.registerMessageHandler("GR",(x,i,d)=>a.m(i,d))),at}function Ht(x,i){const d=a.L();return a.M(d,d,[1,1,0]),a.N(d,d,[.5*x.width,.5*x.height,1]),x.calculatePosMatrix?a.O(d,d,x.calculatePosMatrix(i.toUnwrapped())):d}function ir(x,i,d,p,_,w,E){var M;const D=function(H,ee,ae){if(H)for(const me of H){const ge=ee[me];if(ge&&ge.source===ae&&ge.type==="fill-extrusion")return!0}else for(const me in ee){const ge=ee[me];if(ge.source===ae&&ge.type==="fill-extrusion")return!0}return!1}((M=_==null?void 0:_.layers)!==null&&M!==void 0?M:null,i,x.id),$=w.maxPitchScaleFactor(),U=x.tilesIn(p,$,D);U.sort(yr);const K=[];for(const H of U)K.push({wrappedTileID:H.tileID.wrapped().key,queryResults:H.tile.queryRenderedFeatures(i,d,x._state,H.queryGeometry,H.cameraQueryGeometry,H.scale,_,w,$,Ht(x.transform,H.tileID),E?(ee,ae)=>E(H.tileID,ee,ae):void 0)});return function(H,ee){for(const ae in H)for(const me of H[ae])$t(me,ee);return H}(function(H){const ee={},ae={};for(const me of H){const ge=me.queryResults,_e=me.wrappedTileID,Te=ae[_e]=ae[_e]||{};for(const Ce in ge){const Ee=ge[Ce],Ie=Te[Ce]=Te[Ce]||{},Le=ee[Ce]=ee[Ce]||[];for(const Pe of Ee)Ie[Pe.featureIndex]||(Ie[Pe.featureIndex]=!0,Le.push(Pe))}}return ee}(K),x)}function yr(x,i){const d=x.tileID,p=i.tileID;return d.overscaledZ-p.overscaledZ||d.canonical.y-p.canonical.y||d.wrap-p.wrap||d.canonical.x-p.canonical.x}function $t(x,i){const d=x.feature,p=i.getFeatureState(d.layer["source-layer"],d.id);d.source=d.layer.source,d.layer["source-layer"]&&(d.sourceLayer=d.layer["source-layer"]),d.state=p}function vt(x,i,d){return a._(this,void 0,void 0,function*(){let p=x;if(x.url?p=(yield a.j(i.transformRequest(x.url,"Source"),d)).data:yield P.frameAsync(d),!p)return null;const _=a.Q(a.e(p,x),["tiles","minzoom","maxzoom","attribution","bounds","scheme","tileSize","encoding"]);return"vector_layers"in p&&p.vector_layers&&(_.vectorLayerIds=p.vector_layers.map(w=>w.id)),_})}class Et{constructor(i,d){i&&(d?this.setSouthWest(i).setNorthEast(d):Array.isArray(i)&&(i.length===4?this.setSouthWest([i[0],i[1]]).setNorthEast([i[2],i[3]]):this.setSouthWest(i[0]).setNorthEast(i[1])))}setNorthEast(i){return this._ne=i instanceof a.S?new a.S(i.lng,i.lat):a.S.convert(i),this}setSouthWest(i){return this._sw=i instanceof a.S?new a.S(i.lng,i.lat):a.S.convert(i),this}extend(i){const d=this._sw,p=this._ne;let _,w;if(i instanceof a.S)_=i,w=i;else{if(!(i instanceof Et))return Array.isArray(i)?i.length===4||i.every(Array.isArray)?this.extend(Et.convert(i)):this.extend(a.S.convert(i)):i&&("lng"in i||"lon"in i)&&"lat"in i?this.extend(a.S.convert(i)):this;if(_=i._sw,w=i._ne,!_||!w)return this}return d||p?(d.lng=Math.min(_.lng,d.lng),d.lat=Math.min(_.lat,d.lat),p.lng=Math.max(w.lng,p.lng),p.lat=Math.max(w.lat,p.lat)):(this._sw=new a.S(_.lng,_.lat),this._ne=new a.S(w.lng,w.lat)),this}getCenter(){return new a.S((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new a.S(this.getWest(),this.getNorth())}getSouthEast(){return new a.S(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(i){const{lng:d,lat:p}=a.S.convert(i);let _=this._sw.lng<=d&&d<=this._ne.lng;return this._sw.lng>this._ne.lng&&(_=this._sw.lng>=d&&d>=this._ne.lng),this._sw.lat<=p&&p<=this._ne.lat&&_}static convert(i){return i instanceof Et?i:i&&new Et(i)}static fromLngLat(i,d=0){const p=360*d/40075017,_=p/Math.cos(Math.PI/180*i.lat);return new Et(new a.S(i.lng-_,i.lat-p),new a.S(i.lng+_,i.lat+p))}adjustAntiMeridian(){const i=new a.S(this._sw.lng,this._sw.lat),d=new a.S(this._ne.lng,this._ne.lat);return new Et(i,i.lng>d.lng?new a.S(d.lng+360,d.lat):d)}}class Rt{constructor(i,d,p){this.bounds=Et.convert(this.validateBounds(i)),this.minzoom=d||0,this.maxzoom=p||24}validateBounds(i){return Array.isArray(i)&&i.length===4?[Math.max(-180,i[0]),Math.max(-90,i[1]),Math.min(180,i[2]),Math.min(90,i[3])]:[-180,-90,180,90]}contains(i){const d=Math.pow(2,i.z),p=Math.floor(a.V(this.bounds.getWest())*d),_=Math.floor(a.U(this.bounds.getNorth())*d),w=Math.ceil(a.V(this.bounds.getEast())*d),E=Math.ceil(a.U(this.bounds.getSouth())*d);return i.x>=p&&i.x<w&&i.y>=_&&i.y<E}}class Ft extends a.E{constructor(i,d,p,_){if(super(),this.id=i,this.dispatcher=p,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,a.e(this,a.Q(d,["url","scheme","tileSize","promoteId"])),this._options=a.e({type:"vector"},d),this._collectResourceTiming=d.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(_)}load(){return a._(this,void 0,void 0,function*(){this._loaded=!1,this.fire(new a.l("dataloading",{dataType:"source"})),this._tileJSONRequest=new AbortController;try{const i=yield vt(this._options,this.map._requestManager,this._tileJSONRequest);this._tileJSONRequest=null,this._loaded=!0,this.map.style.sourceCaches[this.id].clearTiles(),i&&(a.e(this,i),i.bounds&&(this.tileBounds=new Rt(i.bounds,this.minzoom,this.maxzoom)),this.fire(new a.l("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new a.l("data",{dataType:"source",sourceDataType:"content"})))}catch(i){this._tileJSONRequest=null,this._loaded=!0,this.fire(new a.k(i))}})}loaded(){return this._loaded}hasTile(i){return!this.tileBounds||this.tileBounds.contains(i.canonical)}onAdd(i){this.map=i,this.load()}setSourceProperty(i){this._tileJSONRequest&&this._tileJSONRequest.abort(),i(),this.load()}setTiles(i){return this.setSourceProperty(()=>{this._options.tiles=i}),this}setUrl(i){return this.setSourceProperty(()=>{this.url=i,this._options.url=i}),this}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null)}serialize(){return a.e({},this._options)}loadTile(i){return a._(this,void 0,void 0,function*(){const d=i.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),p={request:this.map._requestManager.transformRequest(d,"Tile"),uid:i.uid,tileID:i.tileID,zoom:i.tileID.overscaledZ,tileSize:this.tileSize*i.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,subdivisionGranularity:this.map.style.projection.subdivisionGranularity};p.request.collectResourceTiming=this._collectResourceTiming;let _="RT";if(i.actor&&i.state!=="expired"){if(i.state==="loading")return new Promise((w,E)=>{i.reloadPromise={resolve:w,reject:E}})}else i.actor=this.dispatcher.getActor(),_="LT";i.abortController=new AbortController;try{const w=yield i.actor.sendAsync({type:_,data:p},i.abortController);if(delete i.abortController,i.aborted)return;this._afterTileLoadWorkerResponse(i,w)}catch(w){if(delete i.abortController,i.aborted)return;if(w&&w.status!==404)throw w;this._afterTileLoadWorkerResponse(i,null)}})}_afterTileLoadWorkerResponse(i,d){if(d&&d.resourceTiming&&(i.resourceTiming=d.resourceTiming),d&&this.map._refreshExpiredTiles&&i.setExpiryData(d),i.loadVectorData(d,this.map.painter),i.reloadPromise){const p=i.reloadPromise;i.reloadPromise=null,this.loadTile(i).then(p.resolve).catch(p.reject)}}abortTile(i){return a._(this,void 0,void 0,function*(){i.abortController&&(i.abortController.abort(),delete i.abortController),i.actor&&(yield i.actor.sendAsync({type:"AT",data:{uid:i.uid,type:this.type,source:this.id}}))})}unloadTile(i){return a._(this,void 0,void 0,function*(){i.unloadVectorData(),i.actor&&(yield i.actor.sendAsync({type:"RMT",data:{uid:i.uid,type:this.type,source:this.id}}))})}hasTransition(){return!1}}class Nr extends a.E{constructor(i,d,p,_){super(),this.id=i,this.dispatcher=p,this.setEventedParent(_),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=a.e({type:"raster"},d),a.e(this,a.Q(d,["url","scheme","tileSize"]))}load(){return a._(this,arguments,void 0,function*(i=!1){this._loaded=!1,this.fire(new a.l("dataloading",{dataType:"source"})),this._tileJSONRequest=new AbortController;try{const d=yield vt(this._options,this.map._requestManager,this._tileJSONRequest);this._tileJSONRequest=null,this._loaded=!0,d&&(a.e(this,d),d.bounds&&(this.tileBounds=new Rt(d.bounds,this.minzoom,this.maxzoom)),this.fire(new a.l("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new a.l("data",{dataType:"source",sourceDataType:"content",sourceDataChanged:i})))}catch(d){this._tileJSONRequest=null,this._loaded=!0,this.fire(new a.k(d))}})}loaded(){return this._loaded}onAdd(i){this.map=i,this.load()}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null)}setSourceProperty(i){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null),i(),this.load(!0)}setTiles(i){return this.setSourceProperty(()=>{this._options.tiles=i}),this}setUrl(i){return this.setSourceProperty(()=>{this.url=i,this._options.url=i}),this}serialize(){return a.e({},this._options)}hasTile(i){return!this.tileBounds||this.tileBounds.contains(i.canonical)}loadTile(i){return a._(this,void 0,void 0,function*(){const d=i.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme);i.abortController=new AbortController;try{const p=yield W.getImage(this.map._requestManager.transformRequest(d,"Tile"),i.abortController,this.map._refreshExpiredTiles);if(delete i.abortController,i.aborted)return void(i.state="unloaded");if(p&&p.data){this.map._refreshExpiredTiles&&(p.cacheControl||p.expires)&&i.setExpiryData({cacheControl:p.cacheControl,expires:p.expires});const _=this.map.painter.context,w=_.gl,E=p.data;i.texture=this.map.painter.getTileTexture(E.width),i.texture?i.texture.update(E,{useMipmap:!0}):(i.texture=new a.T(_,E,w.RGBA,{useMipmap:!0}),i.texture.bind(w.LINEAR,w.CLAMP_TO_EDGE,w.LINEAR_MIPMAP_NEAREST)),i.state="loaded"}}catch(p){if(delete i.abortController,i.aborted)i.state="unloaded";else if(p)throw i.state="errored",p}})}abortTile(i){return a._(this,void 0,void 0,function*(){i.abortController&&(i.abortController.abort(),delete i.abortController)})}unloadTile(i){return a._(this,void 0,void 0,function*(){i.texture&&this.map.painter.saveTileTexture(i.texture)})}hasTransition(){return!1}}class Zr extends Nr{constructor(i,d,p,_){super(i,d,p,_),this.type="raster-dem",this.maxzoom=22,this._options=a.e({type:"raster-dem"},d),this.encoding=d.encoding||"mapbox",this.redFactor=d.redFactor,this.greenFactor=d.greenFactor,this.blueFactor=d.blueFactor,this.baseShift=d.baseShift}loadTile(i){return a._(this,void 0,void 0,function*(){const d=i.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),p=this.map._requestManager.transformRequest(d,"Tile");i.neighboringTiles=this._getNeighboringTiles(i.tileID),i.abortController=new AbortController;try{const _=yield W.getImage(p,i.abortController,this.map._refreshExpiredTiles);if(delete i.abortController,i.aborted)return void(i.state="unloaded");if(_&&_.data){const w=_.data;this.map._refreshExpiredTiles&&(_.cacheControl||_.expires)&&i.setExpiryData({cacheControl:_.cacheControl,expires:_.expires});const E=a.b(w)&&a.W()?w:yield this.readImageNow(w),M={type:this.type,uid:i.uid,source:this.id,rawImageData:E,encoding:this.encoding,redFactor:this.redFactor,greenFactor:this.greenFactor,blueFactor:this.blueFactor,baseShift:this.baseShift};if(!i.actor||i.state==="expired"){i.actor=this.dispatcher.getActor();const D=yield i.actor.sendAsync({type:"LDT",data:M});i.dem=D,i.needsHillshadePrepare=!0,i.needsTerrainPrepare=!0,i.state="loaded"}}}catch(_){if(delete i.abortController,i.aborted)i.state="unloaded";else if(_)throw i.state="errored",_}})}readImageNow(i){return a._(this,void 0,void 0,function*(){if(typeof VideoFrame<"u"&&a.X()){const d=i.width+2,p=i.height+2;try{return new a.R({width:d,height:p},yield a.Y(i,-1,-1,d,p))}catch{}}return P.getImageData(i,1)})}_getNeighboringTiles(i){const d=i.canonical,p=Math.pow(2,d.z),_=(d.x-1+p)%p,w=d.x===0?i.wrap-1:i.wrap,E=(d.x+1+p)%p,M=d.x+1===p?i.wrap+1:i.wrap,D={};return D[new a.Z(i.overscaledZ,w,d.z,_,d.y).key]={backfilled:!1},D[new a.Z(i.overscaledZ,M,d.z,E,d.y).key]={backfilled:!1},d.y>0&&(D[new a.Z(i.overscaledZ,w,d.z,_,d.y-1).key]={backfilled:!1},D[new a.Z(i.overscaledZ,i.wrap,d.z,d.x,d.y-1).key]={backfilled:!1},D[new a.Z(i.overscaledZ,M,d.z,E,d.y-1).key]={backfilled:!1}),d.y+1<p&&(D[new a.Z(i.overscaledZ,w,d.z,_,d.y+1).key]={backfilled:!1},D[new a.Z(i.overscaledZ,i.wrap,d.z,d.x,d.y+1).key]={backfilled:!1},D[new a.Z(i.overscaledZ,M,d.z,E,d.y+1).key]={backfilled:!1}),D}unloadTile(i){return a._(this,void 0,void 0,function*(){i.demTexture&&this.map.painter.saveTileTexture(i.demTexture),i.fbo&&(i.fbo.destroy(),delete i.fbo),i.dem&&delete i.dem,delete i.neighboringTiles,i.state="unloaded",i.actor&&(yield i.actor.sendAsync({type:"RDT",data:{type:this.type,uid:i.uid,source:this.id}}))})}}class Kr extends a.E{constructor(i,d,p,_){super(),this.id=i,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._removed=!1,this._isUpdatingWorker=!1,this._pendingWorkerUpdate={data:d.data},this.actor=p.getActor(),this.setEventedParent(_),this._data=d.data,this._options=a.e({},d),this._collectResourceTiming=d.collectResourceTiming,d.maxzoom!==void 0&&(this.maxzoom=d.maxzoom),d.type&&(this.type=d.type),d.attribution&&(this.attribution=d.attribution),this.promoteId=d.promoteId,d.clusterMaxZoom!==void 0&&this.maxzoom<=d.clusterMaxZoom&&a.w(`The maxzoom value "${this.maxzoom}" is expected to be greater than the clusterMaxZoom value "${d.clusterMaxZoom}".`),this.workerOptions=a.e({source:this.id,cluster:d.cluster||!1,geojsonVtOptions:{buffer:this._pixelsToTileUnits(d.buffer!==void 0?d.buffer:128),tolerance:this._pixelsToTileUnits(d.tolerance!==void 0?d.tolerance:.375),extent:a.$,maxZoom:this.maxzoom,lineMetrics:d.lineMetrics||!1,generateId:d.generateId||!1},superclusterOptions:{maxZoom:this._getClusterMaxZoom(d.clusterMaxZoom),minPoints:Math.max(2,d.clusterMinPoints||2),extent:a.$,radius:this._pixelsToTileUnits(d.clusterRadius||50),log:!1,generateId:d.generateId||!1},clusterProperties:d.clusterProperties,filter:d.filter},d.workerOptions),typeof this.promoteId=="string"&&(this.workerOptions.promoteId=this.promoteId)}_pixelsToTileUnits(i){return i*(a.$/this.tileSize)}_getClusterMaxZoom(i){const d=i?Math.round(i):this.maxzoom-1;return Number.isInteger(i)||i===void 0||a.w(`Integer expected for option 'clusterMaxZoom': provided value "${i}" rounded to "${d}"`),d}load(){return a._(this,void 0,void 0,function*(){yield this._updateWorkerData()})}onAdd(i){this.map=i,this.load()}setData(i){return this._data=i,this._pendingWorkerUpdate={data:i},this._updateWorkerData(),this}updateData(i){return this._pendingWorkerUpdate.diff=a.a0(this._pendingWorkerUpdate.diff,i),this._updateWorkerData(),this}getData(){return a._(this,void 0,void 0,function*(){const i=a.e({type:this.type},this.workerOptions);return this.actor.sendAsync({type:"GD",data:i})})}getCoordinatesFromGeometry(i){return i.type==="GeometryCollection"?i.geometries.map(d=>d.coordinates).flat(1/0):i.coordinates.flat(1/0)}getBounds(){return a._(this,void 0,void 0,function*(){const i=new Et,d=yield this.getData();let p;switch(d.type){case"FeatureCollection":p=d.features.map(_=>this.getCoordinatesFromGeometry(_.geometry)).flat(1/0);break;case"Feature":p=this.getCoordinatesFromGeometry(d.geometry);break;default:p=this.getCoordinatesFromGeometry(d)}if(p.length==0)return i;for(let _=0;_<p.length-1;_+=2)i.extend([p[_],p[_+1]]);return i})}setClusterOptions(i){return this.workerOptions.cluster=i.cluster,i&&(i.clusterRadius!==void 0&&(this.workerOptions.superclusterOptions.radius=this._pixelsToTileUnits(i.clusterRadius)),i.clusterMaxZoom!==void 0&&(this.workerOptions.superclusterOptions.maxZoom=this._getClusterMaxZoom(i.clusterMaxZoom))),this._updateWorkerData(),this}getClusterExpansionZoom(i){return this.actor.sendAsync({type:"GCEZ",data:{type:this.type,clusterId:i,source:this.id}})}getClusterChildren(i){return this.actor.sendAsync({type:"GCC",data:{type:this.type,clusterId:i,source:this.id}})}getClusterLeaves(i,d,p){return this.actor.sendAsync({type:"GCL",data:{type:this.type,source:this.id,clusterId:i,limit:d,offset:p}})}_updateWorkerData(){return a._(this,void 0,void 0,function*(){if(this._isUpdatingWorker)return;const{data:i,diff:d}=this._pendingWorkerUpdate;if(!i&&!d)return void a.w(`No data or diff provided to GeoJSONSource ${this.id}.`);const p=a.e({type:this.type},this.workerOptions);i?(typeof i=="string"?(p.request=this.map._requestManager.transformRequest(P.resolveURL(i),"Source"),p.request.collectResourceTiming=this._collectResourceTiming):p.data=JSON.stringify(i),this._pendingWorkerUpdate.data=void 0):d&&(p.dataDiff=d,this._pendingWorkerUpdate.diff=void 0),this._isUpdatingWorker=!0,this.fire(new a.l("dataloading",{dataType:"source"}));try{const _=yield this.actor.sendAsync({type:"LD",data:p});if(this._isUpdatingWorker=!1,this._removed||_.abandoned)return void this.fire(new a.l("dataabort",{dataType:"source"}));this._data=_.data;let w=null;_.resourceTiming&&_.resourceTiming[this.id]&&(w=_.resourceTiming[this.id].slice(0));const E={dataType:"source"};this._collectResourceTiming&&w&&w.length>0&&a.e(E,{resourceTiming:w}),this.fire(new a.l("data",Object.assign(Object.assign({},E),{sourceDataType:"metadata"}))),this.fire(new a.l("data",Object.assign(Object.assign({},E),{sourceDataType:"content"})))}catch(_){if(this._isUpdatingWorker=!1,this._removed)return void this.fire(new a.l("dataabort",{dataType:"source"}));this.fire(new a.k(_))}finally{(this._pendingWorkerUpdate.data||this._pendingWorkerUpdate.diff)&&this._updateWorkerData()}})}loaded(){return!this._isUpdatingWorker&&this._pendingWorkerUpdate.data===void 0&&this._pendingWorkerUpdate.diff===void 0}loadTile(i){return a._(this,void 0,void 0,function*(){const d=i.actor?"RT":"LT";i.actor=this.actor;const p={type:this.type,uid:i.uid,tileID:i.tileID,zoom:i.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,subdivisionGranularity:this.map.style.projection.subdivisionGranularity};i.abortController=new AbortController;const _=yield this.actor.sendAsync({type:d,data:p},i.abortController);delete i.abortController,i.unloadVectorData(),i.aborted||i.loadVectorData(_,this.map.painter,d==="RT")})}abortTile(i){return a._(this,void 0,void 0,function*(){i.abortController&&(i.abortController.abort(),delete i.abortController),i.aborted=!0})}unloadTile(i){return a._(this,void 0,void 0,function*(){i.unloadVectorData(),yield this.actor.sendAsync({type:"RMT",data:{uid:i.uid,type:this.type,source:this.id}})})}onRemove(){this._removed=!0,this.actor.sendAsync({type:"RS",data:{type:this.type,source:this.id}})}serialize(){return a.e({},this._options,{type:this.type,data:this._data})}hasTransition(){return!1}}class Ar extends a.E{constructor(i,d,p,_){super(),this.flippedWindingOrder=!1,this.id=i,this.dispatcher=p,this.coordinates=d.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(_),this.options=d}load(i){return a._(this,void 0,void 0,function*(){this._loaded=!1,this.fire(new a.l("dataloading",{dataType:"source"})),this.url=this.options.url,this._request=new AbortController;try{const d=yield W.getImage(this.map._requestManager.transformRequest(this.url,"Image"),this._request);this._request=null,this._loaded=!0,d&&d.data&&(this.image=d.data,i&&(this.coordinates=i),this._finishLoading())}catch(d){this._request=null,this._loaded=!0,this.fire(new a.k(d))}})}loaded(){return this._loaded}updateImage(i){return i.url?(this._request&&(this._request.abort(),this._request=null),this.options.url=i.url,this.load(i.coordinates).finally(()=>{this.texture=null}),this):this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new a.l("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(i){this.map=i,this.load()}onRemove(){this._request&&(this._request.abort(),this._request=null)}setCoordinates(i){this.coordinates=i;const d=i.map(a.a1.fromLngLat);var p;return this.tileID=function(_){const w=a.a2.fromPoints(_),E=w.width(),M=w.height(),D=Math.max(E,M),$=Math.max(0,Math.floor(-Math.log(D)/Math.LN2)),U=Math.pow(2,$);return new a.a4($,Math.floor((w.minX+w.maxX)/2*U),Math.floor((w.minY+w.maxY)/2*U))}(d),this.terrainTileRanges=this._getOverlappingTileRanges(d),this.minzoom=this.maxzoom=this.tileID.z,this.tileCoords=d.map(_=>this.tileID.getTilePoint(_)._round()),this.flippedWindingOrder=((p=this.tileCoords)[1].x-p[0].x)*(p[2].y-p[0].y)-(p[1].y-p[0].y)*(p[2].x-p[0].x)<0,this.fire(new a.l("data",{dataType:"source",sourceDataType:"content"})),this}prepare(){if(Object.keys(this.tiles).length===0||!this.image)return;const i=this.map.painter.context,d=i.gl;this.texture||(this.texture=new a.T(i,this.image,d.RGBA),this.texture.bind(d.LINEAR,d.CLAMP_TO_EDGE));let p=!1;for(const _ in this.tiles){const w=this.tiles[_];w.state!=="loaded"&&(w.state="loaded",w.texture=this.texture,p=!0)}p&&this.fire(new a.l("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}loadTile(i){return a._(this,void 0,void 0,function*(){this.tileID&&this.tileID.equals(i.tileID.canonical)?(this.tiles[String(i.tileID.wrap)]=i,i.buckets={}):i.state="errored"})}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}_getOverlappingTileRanges(i){const{minX:d,minY:p,maxX:_,maxY:w}=a.a2.fromPoints(i),E={};for(let M=0;M<=a.a3;M++){const D=Math.pow(2,M),$=Math.floor(d*D),U=Math.floor(p*D),K=Math.floor(_*D),H=Math.floor(w*D);E[M]={minTileX:$,minTileY:U,maxTileX:K,maxTileY:H}}return E}}class Gn extends Ar{constructor(i,d,p,_){super(i,d,p,_),this.roundZoom=!0,this.type="video",this.options=d}load(){return a._(this,void 0,void 0,function*(){this._loaded=!1;const i=this.options;this.urls=[];for(const d of i.urls)this.urls.push(this.map._requestManager.transformRequest(d,"Source").url);try{const d=yield a.a5(this.urls);if(this._loaded=!0,!d)return;this.video=d,this.video.loop=!0,this.video.addEventListener("playing",()=>{this.map.triggerRepaint()}),this.map&&this.video.play(),this._finishLoading()}catch(d){this.fire(new a.k(d))}})}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(i){if(this.video){const d=this.video.seekable;i<d.start(0)||i>d.end(0)?this.fire(new a.k(new a.a6(`sources.${this.id}`,null,`Playback for this video can be set only between the ${d.start(0)} and ${d.end(0)}-second mark.`))):this.video.currentTime=i}}getVideo(){return this.video}onAdd(i){this.map||(this.map=i,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(Object.keys(this.tiles).length===0||this.video.readyState<2)return;const i=this.map.painter.context,d=i.gl;this.texture?this.video.paused||(this.texture.bind(d.LINEAR,d.CLAMP_TO_EDGE),d.texSubImage2D(d.TEXTURE_2D,0,0,0,d.RGBA,d.UNSIGNED_BYTE,this.video)):(this.texture=new a.T(i,this.video,d.RGBA),this.texture.bind(d.LINEAR,d.CLAMP_TO_EDGE));let p=!1;for(const _ in this.tiles){const w=this.tiles[_];w.state!=="loaded"&&(w.state="loaded",w.texture=this.texture,p=!0)}p&&this.fire(new a.l("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}}class Nn extends Ar{constructor(i,d,p,_){super(i,d,p,_),d.coordinates?Array.isArray(d.coordinates)&&d.coordinates.length===4&&!d.coordinates.some(w=>!Array.isArray(w)||w.length!==2||w.some(E=>typeof E!="number"))||this.fire(new a.k(new a.a6(`sources.${i}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new a.k(new a.a6(`sources.${i}`,null,'missing required property "coordinates"'))),d.animate&&typeof d.animate!="boolean"&&this.fire(new a.k(new a.a6(`sources.${i}`,null,'optional "animate" property must be a boolean value'))),d.canvas?typeof d.canvas=="string"||d.canvas instanceof HTMLCanvasElement||this.fire(new a.k(new a.a6(`sources.${i}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new a.k(new a.a6(`sources.${i}`,null,'missing required property "canvas"'))),this.options=d,this.animate=d.animate===void 0||d.animate}load(){return a._(this,void 0,void 0,function*(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof HTMLCanvasElement?this.options.canvas:document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new a.k(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())})}getCanvas(){return this.canvas}onAdd(i){this.map=i,this.load(),this.canvas&&this.animate&&this.play()}onRemove(){this.pause()}prepare(){let i=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,i=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,i=!0),this._hasInvalidDimensions()||Object.keys(this.tiles).length===0)return;const d=this.map.painter.context,p=d.gl;this.texture?(i||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new a.T(d,this.canvas,p.RGBA,{premultiply:!0});let _=!1;for(const w in this.tiles){const E=this.tiles[w];E.state!=="loaded"&&(E.state="loaded",E.texture=this.texture,_=!0)}_&&this.fire(new a.l("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}serialize(){return{type:"canvas",coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const i of[this.canvas.width,this.canvas.height])if(isNaN(i)||i<=0)return!0;return!1}}const xi={},rn=x=>{switch(x){case"geojson":return Kr;case"image":return Ar;case"raster":return Nr;case"raster-dem":return Zr;case"vector":return Ft;case"video":return Gn;case"canvas":return Nn}return xi[x]},Zt="RTLPluginLoaded";class Or extends a.E{constructor(){super(...arguments),this.status="unavailable",this.url=null,this.dispatcher=Pt()}_syncState(i){return this.status=i,this.dispatcher.broadcast("SRPS",{pluginStatus:i,pluginURL:this.url}).catch(d=>{throw this.status="error",d})}getRTLTextPluginStatus(){return this.status}clearRTLTextPlugin(){this.status="unavailable",this.url=null}setRTLTextPlugin(i){return a._(this,arguments,void 0,function*(d,p=!1){if(this.url)throw new Error("setRTLTextPlugin cannot be called multiple times.");if(this.url=P.resolveURL(d),!this.url)throw new Error(`requested url ${d} is invalid`);if(this.status==="unavailable"){if(!p)return this._requestImport();this.status="deferred",this._syncState(this.status)}else if(this.status==="requested")return this._requestImport()})}_requestImport(){return a._(this,void 0,void 0,function*(){yield this._syncState("loading"),this.status="loaded",this.fire(new a.l(Zt))})}lazyLoad(){this.status==="unavailable"?this.status="requested":this.status==="deferred"&&this._requestImport()}}let St=null;function Sn(){return St||(St=new Or),St}var Br,Me;(function(x){x[x.Base=0]="Base",x[x.Parent=1]="Parent"})(Br||(Br={})),function(x){x[x.Departing=0]="Departing",x[x.Incoming=1]="Incoming"}(Me||(Me={}));class ne{constructor(i,d){this.timeAdded=0,this.fadeEndTime=0,this.fadeOpacity=1,this.tileID=i,this.uid=a.a7(),this.uses=0,this.tileSize=d,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.rtt=[],this.rttCoords={},this.expiredRequestCount=0,this.state="loading"}isRenderable(i){return this.hasData()&&(!this.fadeEndTime||this.fadeOpacity>0)&&(i||!this.holdingForSymbolFade())}setCrossFadeLogic({fadingRole:i,fadingDirection:d,fadingParentID:p,fadeEndTime:_}){this.resetFadeLogic(),this.fadingRole=i,this.fadingDirection=d,this.fadingParentID=p,this.fadeEndTime=_}setSelfFadeLogic(i){this.resetFadeLogic(),this.selfFading=!0,this.fadeEndTime=i}resetFadeLogic(){this.fadingRole=null,this.fadingDirection=null,this.fadingParentID=null,this.selfFading=!1,this.timeAdded=P.now(),this.fadeEndTime=0,this.fadeOpacity=1}wasRequested(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"}clearTextures(i){this.demTexture&&i.saveTileTexture(this.demTexture),this.demTexture=null}loadVectorData(i,d,p){if(this.hasData()&&this.unloadVectorData(),this.state="loaded",i){i.featureIndex&&(this.latestFeatureIndex=i.featureIndex,i.rawTileData?(this.latestRawTileData=i.rawTileData,this.latestFeatureIndex.rawTileData=i.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=i.collisionBoxArray,this.buckets=function(_,w){const E={};if(!w)return E;for(const M of _){const D=M.layerIds.map($=>w.getLayer($)).filter(Boolean);if(D.length!==0){M.layers=D,M.stateDependentLayerIds&&(M.stateDependentLayers=M.stateDependentLayerIds.map($=>D.filter(U=>U.id===$)[0]));for(const $ of D)E[$.id]=M}}return E}(i.buckets,d==null?void 0:d.style),this.hasSymbolBuckets=!1;for(const _ in this.buckets){const w=this.buckets[_];if(w instanceof a.a9){if(this.hasSymbolBuckets=!0,!p)break;w.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const _ in this.buckets){const w=this.buckets[_];if(w instanceof a.a9&&w.hasRTLText){this.hasRTLText=!0,Sn().lazyLoad();break}}this.queryPadding=0;for(const _ in this.buckets){const w=this.buckets[_];this.queryPadding=Math.max(this.queryPadding,d.style.getLayer(_).queryRadius(w))}i.imageAtlas&&(this.imageAtlas=i.imageAtlas),i.glyphAtlasImage&&(this.glyphAtlasImage=i.glyphAtlasImage),this.dashPositions=i.dashPositions}else this.collisionBoxArray=new a.a8}unloadVectorData(){for(const i in this.buckets)this.buckets[i].destroy();this.buckets={},this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.imageAtlas&&(this.imageAtlas=null),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.dashPositions&&(this.dashPositions=null),this.latestFeatureIndex=null,this.state="unloaded"}getBucket(i){return this.buckets[i.id]}upload(i){for(const p in this.buckets){const _=this.buckets[p];_.uploadPending()&&_.upload(i)}const d=i.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new a.T(i,this.imageAtlas.image,d.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new a.T(i,this.glyphAtlasImage,d.ALPHA),this.glyphAtlasImage=null)}prepare(i){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(i,this.imageAtlasTexture)}queryRenderedFeatures(i,d,p,_,w,E,M,D,$,U,K){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({queryGeometry:_,cameraQueryGeometry:w,scale:E,tileSize:this.tileSize,pixelPosMatrix:U,transform:D,params:M,queryPadding:this.queryPadding*$,getElevation:K},i,d,p):{}}querySourceFeatures(i,d){const p=this.latestFeatureIndex;if(!p||!p.rawTileData)return;const _=p.loadVTLayers(),w=d&&d.sourceLayer?d.sourceLayer:"",E=_._geojsonTileLayer||_[w];if(!E)return;const M=a.aa(d==null?void 0:d.filter,d==null?void 0:d.globalState),{z:D,x:$,y:U}=this.tileID.canonical,K={z:D,x:$,y:U};for(let H=0;H<E.length;H++){const ee=E.feature(H);if(M.needGeometry){const ge=a.ab(ee,!0);if(!M.filter(new a.F(this.tileID.overscaledZ),ge,this.tileID.canonical))continue}else if(!M.filter(new a.F(this.tileID.overscaledZ),ee))continue;const ae=p.getId(ee,w),me=new a.ac(ee,D,$,U,ae);me.tile=K,i.push(me)}}hasData(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"}patternsLoaded(){return this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(i){const d=this.expirationTime;if(i.cacheControl){const p=a.ad(i.cacheControl);p["max-age"]&&(this.expirationTime=Date.now()+1e3*p["max-age"])}else i.expires&&(this.expirationTime=new Date(i.expires).getTime());if(this.expirationTime){const p=Date.now();let _=!1;if(this.expirationTime>p)_=!1;else if(d)if(this.expirationTime<d)_=!0;else{const w=this.expirationTime-d;w?this.expirationTime=p+Math.max(w,3e4):_=!0}else _=!0;_?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)}setFeatureState(i,d){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData||Object.keys(i).length===0)return;const p=this.latestFeatureIndex.loadVTLayers();for(const _ in this.buckets){if(!d.style.hasLayer(_))continue;const w=this.buckets[_],E=w.layers[0].sourceLayer||"_geojsonTileLayer",M=p[E],D=i[E];if(!M||!D||Object.keys(D).length===0)continue;w.update(D,M,this.imageAtlas&&this.imageAtlas.patternPositions||{},this.dashPositions||{});const $=d&&d.style&&d.style.getLayer(_);$&&(this.queryPadding=Math.max(this.queryPadding,$.queryRadius(w)))}}holdingForSymbolFade(){return this.symbolFadeHoldUntil!==void 0}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<P.now()}clearSymbolFadeHold(){this.symbolFadeHoldUntil=void 0}setSymbolHoldDuration(i){this.symbolFadeHoldUntil=P.now()+i}setDependencies(i,d){const p={};for(const _ of d)p[_]=!0;this.dependencies[i]=p}hasDependency(i,d){for(const p of i){const _=this.dependencies[p];if(_){for(const w of d)if(_[w])return!0}}return!1}}class oe{constructor(i,d){this.max=i,this.onRemove=d,this.reset()}reset(){for(const i in this.data)for(const d of this.data[i])d.timeout&&clearTimeout(d.timeout),this.onRemove(d.value);return this.data={},this.order=[],this}add(i,d,p){const _=i.wrapped().key;this.data[_]===void 0&&(this.data[_]=[]);const w={value:d,timeout:void 0};if(p!==void 0&&(w.timeout=setTimeout(()=>{this.remove(i,w)},p)),this.data[_].push(w),this.order.push(_),this.order.length>this.max){const E=this._getAndRemoveByKey(this.order[0]);E&&this.onRemove(E)}return this}has(i){return i.wrapped().key in this.data}getAndRemove(i){return this.has(i)?this._getAndRemoveByKey(i.wrapped().key):null}_getAndRemoveByKey(i){const d=this.data[i].shift();return d.timeout&&clearTimeout(d.timeout),this.data[i].length===0&&delete this.data[i],this.order.splice(this.order.indexOf(i),1),d.value}getByKey(i){const d=this.data[i];return d?d[0].value:null}get(i){return this.has(i)?this.data[i.wrapped().key][0].value:null}remove(i,d){if(!this.has(i))return this;const p=i.wrapped().key,_=d===void 0?0:this.data[p].indexOf(d),w=this.data[p][_];return this.data[p].splice(_,1),w.timeout&&clearTimeout(w.timeout),this.data[p].length===0&&delete this.data[p],this.onRemove(w.value),this.order.splice(this.order.indexOf(p),1),this}setMaxSize(i){for(this.max=i;this.order.length>this.max;){const d=this._getAndRemoveByKey(this.order[0]);d&&this.onRemove(d)}return this}filter(i){const d=[];for(const p in this.data)for(const _ of this.data[p])i(_.value)||d.push(_);for(const p of d)this.remove(p.value.tileID,p)}}class de{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(i,d,p){const _=String(d);if(this.stateChanges[i]=this.stateChanges[i]||{},this.stateChanges[i][_]=this.stateChanges[i][_]||{},a.e(this.stateChanges[i][_],p),this.deletedStates[i]===null){this.deletedStates[i]={};for(const w in this.state[i])w!==_&&(this.deletedStates[i][w]=null)}else if(this.deletedStates[i]&&this.deletedStates[i][_]===null){this.deletedStates[i][_]={};for(const w in this.state[i][_])p[w]||(this.deletedStates[i][_][w]=null)}else for(const w in p)this.deletedStates[i]&&this.deletedStates[i][_]&&this.deletedStates[i][_][w]===null&&delete this.deletedStates[i][_][w]}removeFeatureState(i,d,p){if(this.deletedStates[i]===null)return;const _=String(d);if(this.deletedStates[i]=this.deletedStates[i]||{},p&&d!==void 0)this.deletedStates[i][_]!==null&&(this.deletedStates[i][_]=this.deletedStates[i][_]||{},this.deletedStates[i][_][p]=null);else if(d!==void 0)if(this.stateChanges[i]&&this.stateChanges[i][_])for(p in this.deletedStates[i][_]={},this.stateChanges[i][_])this.deletedStates[i][_][p]=null;else this.deletedStates[i][_]=null;else this.deletedStates[i]=null}getState(i,d){const p=String(d),_=a.e({},(this.state[i]||{})[p],(this.stateChanges[i]||{})[p]);if(this.deletedStates[i]===null)return{};if(this.deletedStates[i]){const w=this.deletedStates[i][d];if(w===null)return{};for(const E in w)delete _[E]}return _}initializeTileState(i,d){i.setFeatureState(this.state,d)}coalesceChanges(i,d){const p={};for(const _ in this.stateChanges){this.state[_]=this.state[_]||{};const w={};for(const E in this.stateChanges[_])this.state[_][E]||(this.state[_][E]={}),a.e(this.state[_][E],this.stateChanges[_][E]),w[E]=this.state[_][E];p[_]=w}for(const _ in this.deletedStates){this.state[_]=this.state[_]||{};const w={};if(this.deletedStates[_]===null)for(const E in this.state[_])w[E]={},this.state[_][E]={};else for(const E in this.deletedStates[_]){if(this.deletedStates[_][E]===null)this.state[_][E]={};else for(const M of Object.keys(this.deletedStates[_][E]))delete this.state[_][E][M];w[E]=this.state[_][E]}p[_]=p[_]||{},a.e(p[_],w)}if(this.stateChanges={},this.deletedStates={},Object.keys(p).length!==0)for(const _ in i)i[_].setFeatureState(p,d)}}const we=89.25;function Ae(x,i){const d=a.ah(i.lat,-a.ai,a.ai);return new a.P(a.V(i.lng)*x,a.U(d)*x)}function Oe(x,i){return new a.a1(i.x/x,i.y/x).toLngLat()}function Be(x){return x.cameraToCenterDistance*Math.min(.85*Math.tan(a.ae(90-x.pitch)),Math.tan(a.ae(we-x.pitch)))}function ze(x,i){const d=x.canonical,p=i/a.af(d.z),_=d.x+Math.pow(2,d.z)*x.wrap,w=a.ag(new Float64Array(16));return a.M(w,w,[_*p,d.y*p,0]),a.N(w,w,[p/a.$,p/a.$,1]),w}function He(x,i,d,p,_){const w=a.a1.fromLngLat(x,i),E=_*a.aj(1,x.lat),M=E*Math.cos(a.ae(d)),D=Math.sqrt(E*E-M*M),$=D*Math.sin(a.ae(-p)),U=D*Math.cos(a.ae(-p));return new a.a1(w.x+$,w.y+U,w.z+M)}function nt(x,i,d){const p=i.intersectsFrustum(x);if(!d||p===0)return p;const _=i.intersectsPlane(d);return _===0?0:p===2&&_===2?2:1}function Qe(x,i,d){let p=0;const _=(d-i)/10;for(let w=0;w<10;w++)p+=_*Math.pow(Math.cos(i+(w+.5)/10*(d-i)),x);return p}function Tt(x,i){return function(d,p,_,w,E){const M=2*((x-1)/a.ak(Math.cos(a.ae(we-E))/Math.cos(a.ae(we)))-1),D=Math.acos(_/w),$=2*Qe(M-1,0,a.ae(E/2)),U=Math.min(a.ae(we),D+a.ae(E/2)),K=Qe(M-1,Math.min(U,D-a.ae(E/2)),U),H=Math.atan(p/_),ee=Math.hypot(p,_);let ae=d;return ae+=a.ak(w/ee/Math.max(.5,Math.cos(a.ae(E/2)))),ae+=M*a.ak(Math.cos(H))/2,ae-=a.ak(Math.max(1,K/$/i))/2,ae}}const It=Tt(9.314,3);function je(x,i){const d=(i.roundZoom?Math.round:Math.floor)(x.zoom+a.ak(x.tileSize/i.tileSize));return Math.max(0,d)}function Kt(x,i){const d=x.getCameraFrustum(),p=x.getClippingPlane(),_=x.screenPointToMercatorCoordinate(x.getCameraPoint()),w=a.a1.fromLngLat(x.center,x.elevation);_.z=w.z+Math.cos(x.pitchInRadians)*x.cameraToCenterDistance/x.worldSize;const E=x.getCoveringTilesDetailsProvider(),M=E.allowVariableZoom(x,i),D=je(x,i),$=i.minzoom||0,U=i.maxzoom!==void 0?i.maxzoom:x.maxZoom,K=Math.min(Math.max(0,D),U),H=Math.pow(2,K),ee=[H*_.x,H*_.y,0],ae=[H*w.x,H*w.y,0],me=Math.hypot(w.x-_.x,w.y-_.y),ge=Math.abs(w.z-_.z),_e=Math.hypot(me,ge),Te=Ie=>({zoom:0,x:0,y:0,wrap:Ie,fullyVisible:!1}),Ce=[],Ee=[];if(x.renderWorldCopies&&E.allowWorldCopies())for(let Ie=1;Ie<=3;Ie++)Ce.push(Te(-Ie)),Ce.push(Te(Ie));for(Ce.push(Te(0));Ce.length>0;){const Ie=Ce.pop(),Le=Ie.x,Pe=Ie.y;let Ne=Ie.fullyVisible;const qe={x:Le,y:Pe,z:Ie.zoom},Ve=E.getTileBoundingVolume(qe,Ie.wrap,x.elevation,i);if(!Ne){const ut=nt(d,Ve,p);if(ut===0)continue;Ne=ut===2}const Ge=E.distanceToTile2d(_.x,_.y,qe,Ve);let We=D;M&&(We=(i.calculateTileZoom||It)(x.zoom+a.ak(x.tileSize/i.tileSize),Ge,ge,_e,x.fov)),We=(i.roundZoom?Math.round:Math.floor)(We),We=Math.max(0,We);const ct=Math.min(We,U);if(Ie.wrap=E.getWrap(w,qe,Ie.wrap),Ie.zoom>=ct){if(Ie.zoom<$)continue;const ut=K-Ie.zoom,tt=ee[0]-.5-(Le<<ut),At=ee[1]-.5-(Pe<<ut),qt=i.reparseOverscaled?Math.max(Ie.zoom,We):Ie.zoom;Ee.push({tileID:new a.Z(Ie.zoom===U?qt:Ie.zoom,Ie.wrap,Ie.zoom,Le,Pe),distanceSq:a.al([ae[0]-.5-Le,ae[1]-.5-Pe]),tileDistanceToCamera:Math.sqrt(tt*tt+At*At)})}else for(let ut=0;ut<4;ut++)Ce.push({zoom:Ie.zoom+1,x:(Le<<1)+ut%2,y:(Pe<<1)+(ut>>1),wrap:Ie.wrap,fullyVisible:Ne})}return Ee.sort((Ie,Le)=>Ie.distanceSq-Le.distanceSq).map(Ie=>Ie.tileID)}const wt=a.a2.fromPoints([new a.P(0,0),new a.P(a.$,a.$)]);class lt extends a.E{constructor(i,d,p){super(),this.id=i,this.dispatcher=p,this.on("data",_=>this._dataHandler(_)),this.on("dataloading",()=>{this._sourceErrored=!1}),this.on("error",()=>{this._sourceErrored=this._source.loaded()}),this._source=((_,w,E,M)=>{const D=new(rn(w.type))(_,w,E,M);if(D.id!==_)throw new Error(`Expected Source id to be ${_} instead of ${D.id}`);return D})(i,d,p,this),this._tiles={},this._cache=new oe(0,_=>this._unloadTile(_)),this._timers={},this._cacheTimers={},this._maxTileCacheSize=null,this._maxTileCacheZoomLevels=null,this._rasterFadeDuration=0,this._maxFadingAncestorLevels=5,this._state=new de,this._didEmitContent=!1,this._updated=!1}onAdd(i){this.map=i,this._maxTileCacheSize=i?i._maxTileCacheSize:null,this._maxTileCacheZoomLevels=i?i._maxTileCacheZoomLevels:null,this._source&&this._source.onAdd&&this._source.onAdd(i)}onRemove(i){this.clearTiles(),this._source&&this._source.onRemove&&this._source.onRemove(i)}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;if(!(this.used===void 0&&this.usedForTerrain===void 0||this.used||this.usedForTerrain))return!0;if(!this._updated)return!1;for(const i in this._tiles){const d=this._tiles[i];if(d.state!=="loaded"&&d.state!=="errored")return!1}return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;const i=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,i&&this.reload(),this.transform&&this.update(this.transform,this.terrain)}_loadTile(i,d,p){return a._(this,void 0,void 0,function*(){try{yield this._source.loadTile(i),this._tileLoaded(i,d,p)}catch(_){i.state="errored",_.status!==404?this._source.fire(new a.k(_,{tile:i})):this.update(this.transform,this.terrain)}})}_unloadTile(i){this._source.unloadTile&&this._source.unloadTile(i)}_abortTile(i){this._source.abortTile&&this._source.abortTile(i),this._source.fire(new a.l("dataabort",{tile:i,coord:i.tileID,dataType:"source"}))}serialize(){return this._source.serialize()}prepare(i){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(const d in this._tiles){const p=this._tiles[d];p.upload(i),p.prepare(this.map.style.imageManager)}}getIds(){return Object.values(this._tiles).map(i=>i.tileID).sort(Dt).map(i=>i.key)}getRenderableIds(i){const d=[];for(const p in this._tiles)this._isIdRenderable(p,i)&&d.push(this._tiles[p]);return i?d.sort((p,_)=>{const w=p.tileID,E=_.tileID,M=new a.P(w.canonical.x,w.canonical.y)._rotate(-this.transform.bearingInRadians),D=new a.P(E.canonical.x,E.canonical.y)._rotate(-this.transform.bearingInRadians);return w.overscaledZ-E.overscaledZ||D.y-M.y||D.x-M.x}).map(p=>p.tileID.key):d.map(p=>p.tileID).sort(Dt).map(p=>p.key)}hasRenderableParent(i){const d=i.overscaledZ-1;if(d>=this._source.minzoom){const p=this._getLoadedTile(i.scaledTo(d));if(p)return this._isIdRenderable(p.tileID.key)}return!1}_isIdRenderable(i,d=!1){var p;return(p=this._tiles[i])===null||p===void 0?void 0:p.isRenderable(d)}reload(i){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const d in this._tiles)i?this._reloadTile(d,"expired"):this._tiles[d].state!=="errored"&&this._reloadTile(d,"reloading")}}_reloadTile(i,d){return a._(this,void 0,void 0,function*(){const p=this._tiles[i];p&&(p.state!=="loading"&&(p.state=d),yield this._loadTile(p,i,d))})}_tileLoaded(i,d,p){i.timeAdded=P.now(),p==="expired"&&(i.refreshedUponExpiration=!0),this._setTileReloadTimer(d,i),this.getSource().type==="raster-dem"&&i.dem&&this._backfillDEM(i),this._state.initializeTileState(i,this.map?this.map.painter:null),i.aborted||this._source.fire(new a.l("data",{dataType:"source",tile:i,coord:i.tileID}))}_backfillDEM(i){const d=this.getRenderableIds();for(let _=0;_<d.length;_++){const w=d[_];if(i.neighboringTiles&&i.neighboringTiles[w]){const E=this.getTileByID(w);p(i,E),p(E,i)}}function p(_,w){_.needsHillshadePrepare=!0,_.needsTerrainPrepare=!0;let E=w.tileID.canonical.x-_.tileID.canonical.x;const M=w.tileID.canonical.y-_.tileID.canonical.y,D=Math.pow(2,_.tileID.canonical.z),$=w.tileID.key;E===0&&M===0||Math.abs(M)>1||(Math.abs(E)>1&&(Math.abs(E+D)===1?E+=D:Math.abs(E-D)===1&&(E-=D)),w.dem&&_.dem&&(_.dem.backfillBorder(w.dem,E,M),_.neighboringTiles&&_.neighboringTiles[$]&&(_.neighboringTiles[$].backfilled=!0)))}}getTile(i){return this.getTileByID(i.key)}getTileByID(i){return this._tiles[i]}_retainLoadedChildren(i,d){const p=Object.values(i),_=this._getLoadedDescendents(p),w={};for(const E of p){const M=_[E.key];if(!(M!=null&&M.length)){w[E.key]=E;continue}const D=E.overscaledZ+lt.maxUnderzooming,$=M.filter(H=>H.tileID.overscaledZ<=D);if(!$.length){w[E.key]=E;continue}const U=Math.min(...$.map(H=>H.tileID.overscaledZ)),K=$.filter(H=>H.tileID.overscaledZ===U).map(H=>H.tileID);for(const H of K)d[H.key]=H;this._areDescendentsComplete(K,U,E.overscaledZ)||(w[E.key]=E)}return w}_getLoadedDescendents(i){var d;const p={};for(const _ in this._tiles){const w=this._tiles[_];if(w.hasData())for(const E of i)w.tileID.isChildOf(E)&&(p[d=E.key]||(p[d]=[])).push(w)}return p}_areDescendentsComplete(i,d,p){return i.length===1&&i[0].isOverscaled()?i[0].overscaledZ===d:Math.pow(4,d-p)===i.length}_getLoadedTile(i){const d=this._tiles[i.key];return d!=null&&d.hasData()?d:null}updateCacheSize(i){const d=Math.ceil(i.width/this._source.tileSize)+1,p=Math.ceil(i.height/this._source.tileSize)+1,_=Math.floor(d*p*(this._maxTileCacheZoomLevels===null?a.a.MAX_TILE_CACHE_ZOOM_LEVELS:this._maxTileCacheZoomLevels)),w=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,_):_;this._cache.setMaxSize(w)}handleWrapJump(i){const d=Math.round((i-(this._prevLng===void 0?i:this._prevLng))/360);if(this._prevLng=i,d){const p={};for(const _ in this._tiles){const w=this._tiles[_];w.tileID=w.tileID.unwrapTo(w.tileID.wrap+d),p[w.tileID.key]=w}this._tiles=p;for(const _ in this._timers)clearTimeout(this._timers[_]),delete this._timers[_];for(const _ in this._tiles)this._setTileReloadTimer(_,this._tiles[_])}}update(i,d){if(!this._sourceLoaded||this._paused)return;let p;this.transform=i,this.terrain=d,this.updateCacheSize(i),this.handleWrapJump(this.transform.center.lng),this.used||this.usedForTerrain?this._source.tileID?p=i.getVisibleUnwrappedCoordinates(this._source.tileID).map(D=>new a.Z(D.canonical.z,D.wrap,D.canonical.z,D.canonical.x,D.canonical.y)):(p=Kt(i,{tileSize:this.usedForTerrain?this.tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:!this.usedForTerrain&&this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled,terrain:d,calculateTileZoom:this._source.calculateTileZoom}),this._source.hasTile&&(p=p.filter(D=>this._source.hasTile(D)))):p=[],this.usedForTerrain&&(p=this._addTerrainIdealTiles(p));const _=p.length===0&&!this._updated&&this._didEmitContent;this._updated=!0,_&&this.fire(new a.l("data",{sourceDataType:"idle",dataType:"source",sourceId:this.id}));const w=je(i,this._source),E=this._updateRetainedTiles(p,w),M=_r(this._source.type);M&&this._rasterFadeDuration>0&&!d&&this._updateFadingTiles(p,E),M?this._cleanUpRasterTiles(E):this._cleanUpVectorTiles(E)}_cleanUpRasterTiles(i){for(const d in this._tiles)i[d]||this._removeTile(d)}_cleanUpVectorTiles(i){for(const d in this._tiles){const p=this._tiles[d];i[d]?p.clearSymbolFadeHold():p.hasSymbolBuckets?p.holdingForSymbolFade()?p.symbolFadeFinished()&&this._removeTile(d):p.setSymbolHoldDuration(this.map._fadeDuration):this._removeTile(d)}}_addTerrainIdealTiles(i){const d=[];for(const p of i)if(p.canonical.z>this._source.minzoom){const _=p.scaledTo(p.canonical.z-1);d.push(_);const w=p.scaledTo(Math.max(this._source.minzoom,Math.min(p.canonical.z,5)));d.push(w)}return i.concat(d)}releaseSymbolFadeTiles(){for(const i in this._tiles)this._tiles[i].holdingForSymbolFade()&&this._removeTile(i)}_updateRetainedTiles(i,d){var p;const _={},w={},E=Math.max(d-lt.maxOverzooming,this._source.minzoom);let M={};for(const D of i){const $=this._addTile(D);_[D.key]=D,$.hasData()||(M[D.key]=D)}M=this._retainLoadedChildren(M,_);for(const D in M){const $=M[D];let U=this._tiles[D],K=U==null?void 0:U.wasRequested();for(let H=$.overscaledZ-1;H>=E;--H){const ee=$.scaledTo(H);if(w[ee.key])break;if(w[ee.key]=!0,U=this.getTile(ee),!U&&K&&(U=this._addTile(ee)),U){const ae=U.hasData();if((ae||!(!((p=this.map)===null||p===void 0)&&p.cancelPendingTileRequestsWhileZooming)||K)&&(_[ee.key]=ee),K=U.wasRequested(),ae)break}}}return _}_updateFadingTiles(i,d){const p=P.now(),_=a.am(i);for(const w of i){const E=this._tiles[w.key];E.fadingDirection!==Me.Departing&&E.fadeOpacity!==0||E.resetFadeLogic(),this._updateFadingAncestor(E,d,p)||this._updateFadingDescendents(E,d,p)||this._updateFadingEdge(E,_,p)||E.resetFadeLogic()}}_updateFadingAncestor(i,d,p){if(!i.hasData())return!1;const{tileID:_,fadingRole:w,fadingDirection:E,fadingParentID:M}=i;if(w===Br.Base&&E===Me.Incoming&&M)return d[M.key]=M,!0;const D=Math.max(_.overscaledZ-this._maxFadingAncestorLevels,this._source.minzoom);for(let $=_.overscaledZ-1;$>=D;$--){const U=_.scaledTo($),K=this._getLoadedTile(U);if(K)return i.setCrossFadeLogic({fadingRole:Br.Base,fadingDirection:Me.Incoming,fadingParentID:K.tileID,fadeEndTime:p+this._rasterFadeDuration}),K.setCrossFadeLogic({fadingRole:Br.Parent,fadingDirection:Me.Departing,fadeEndTime:p+this._rasterFadeDuration}),d[U.key]=U,!0}return!1}_updateFadingDescendents(i,d,p){if(!i.hasData())return!1;const _=i.tileID.children(this._source.maxzoom);let w=this._updateFadingChildren(i,_,d,p);if(w)return!0;for(const E of _){const M=E.children(this._source.maxzoom);this._updateFadingChildren(i,M,d,p)&&(w=!0)}return w}_updateFadingChildren(i,d,p,_){if(d[0].overscaledZ>=this._source.maxzoom)return!1;let w=!1;for(const E of d){const M=this._getLoadedTile(E);if(!M)continue;const{fadingRole:D,fadingDirection:$,fadingParentID:U}=M;D===Br.Base&&$===Me.Departing&&U||(M.setCrossFadeLogic({fadingRole:Br.Base,fadingDirection:Me.Departing,fadingParentID:i.tileID,fadeEndTime:_+this._rasterFadeDuration}),i.setCrossFadeLogic({fadingRole:Br.Parent,fadingDirection:Me.Incoming,fadeEndTime:_+this._rasterFadeDuration})),p[E.key]=E,w=!0}return w}_updateFadingEdge(i,d,p){const _=i.tileID;return!!i.selfFading||!i.hasData()&&!!d.has(_)&&(i.setSelfFadeLogic(p+this._rasterFadeDuration),!0)}_addTile(i){let d=this._tiles[i.key];if(d)return d;d=this._cache.getAndRemove(i),d&&(d.resetFadeLogic(),this._setTileReloadTimer(i.key,d),d.tileID=i,this._state.initializeTileState(d,this.map?this.map.painter:null),this._cacheTimers[i.key]&&(clearTimeout(this._cacheTimers[i.key]),delete this._cacheTimers[i.key],this._setTileReloadTimer(i.key,d)));const p=d;return d||(d=new ne(i,this._source.tileSize*i.overscaleFactor()),this._loadTile(d,i.key,d.state)),d.uses++,this._tiles[i.key]=d,p||this._source.fire(new a.l("dataloading",{tile:d,coord:d.tileID,dataType:"source"})),d}_setTileReloadTimer(i,d){i in this._timers&&(clearTimeout(this._timers[i]),delete this._timers[i]);const p=d.getExpiryTimeout();p&&(this._timers[i]=setTimeout(()=>{this._reloadTile(i,"expired"),delete this._timers[i]},p))}refreshTiles(i){for(const d in this._tiles)(this._isIdRenderable(d)||this._tiles[d].state=="errored")&&i.some(p=>p.equals(this._tiles[d].tileID.canonical))&&this._reloadTile(d,"expired")}_removeTile(i){const d=this._tiles[i];d&&(d.uses--,delete this._tiles[i],this._timers[i]&&(clearTimeout(this._timers[i]),delete this._timers[i]),d.uses>0||(d.hasData()&&d.state!=="reloading"?this._cache.add(d.tileID,d,d.getExpiryTimeout()):(d.aborted=!0,this._abortTile(d),this._unloadTile(d))))}_dataHandler(i){i.dataType==="source"&&(i.sourceDataType!=="metadata"?i.sourceDataType==="content"&&this._sourceLoaded&&!this._paused&&(this.reload(i.sourceDataChanged),this.transform&&this.update(this.transform,this.terrain),this._didEmitContent=!0):this._sourceLoaded=!0)}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const i in this._tiles)this._removeTile(i);this._cache.reset()}tilesIn(i,d,p){const _=[],w=this.transform;if(!w)return _;const E=w.getCoveringTilesDetailsProvider().allowWorldCopies(),M=p?w.getCameraQueryGeometry(i):i,D=ee=>w.screenPointToMercatorCoordinate(ee,this.terrain),$=this.transformBbox(i,D,!E),U=this.transformBbox(M,D,!E),K=this.getIds(),H=a.a2.fromPoints(U);for(let ee=0;ee<K.length;ee++){const ae=this._tiles[K[ee]];if(ae.holdingForSymbolFade())continue;const me=E?[ae.tileID]:[ae.tileID.unwrapTo(-1),ae.tileID.unwrapTo(0)],ge=Math.pow(2,w.zoom-ae.tileID.overscaledZ),_e=d*ae.queryPadding*a.$/ae.tileSize/ge;for(const Te of me){const Ce=H.map(Ee=>Te.getTilePoint(new a.a1(Ee.x,Ee.y)));if(Ce.expandBy(_e),Ce.intersects(wt)){const Ee=$.map(Le=>Te.getTilePoint(Le)),Ie=U.map(Le=>Te.getTilePoint(Le));_.push({tile:ae,tileID:E?Te:Te.unwrapTo(0),queryGeometry:Ee,cameraQueryGeometry:Ie,scale:ge})}}}return _}transformBbox(i,d,p){let _=i.map(d);if(p){const w=a.a2.fromPoints(i);w.shrinkBy(.001*Math.min(w.width(),w.height()));const E=w.map(d);a.a2.fromPoints(_).covers(E)||(_=_.map(M=>M.x>.5?new a.a1(M.x-1,M.y,M.z):M))}return _}getVisibleCoordinates(i){const d=this.getRenderableIds(i).map(p=>this._tiles[p].tileID);return this.transform&&this.transform.populateCache(d),d}hasTransition(){if(this._source.hasTransition())return!0;if(_r(this._source.type)&&this._rasterFadeDuration>0){const i=P.now();for(const d in this._tiles)if(this._tiles[d].fadeEndTime>=i)return!0}return!1}setRasterFadeDuration(i){this._rasterFadeDuration=i}setFeatureState(i,d,p){this._state.updateState(i=i||"_geojsonTileLayer",d,p)}removeFeatureState(i,d,p){this._state.removeFeatureState(i=i||"_geojsonTileLayer",d,p)}getFeatureState(i,d){return this._state.getState(i=i||"_geojsonTileLayer",d)}setDependencies(i,d,p){const _=this._tiles[i];_&&_.setDependencies(d,p)}reloadTilesForDependencies(i,d){for(const p in this._tiles)this._tiles[p].hasDependency(i,d)&&this._reloadTile(p,"reloading");this._cache.filter(p=>!p.hasDependency(i,d))}}function Dt(x,i){const d=Math.abs(2*x.wrap)-+(x.wrap<0),p=Math.abs(2*i.wrap)-+(i.wrap<0);return x.overscaledZ-i.overscaledZ||p-d||i.canonical.y-x.canonical.y||i.canonical.x-x.canonical.x}function _r(x){return x==="raster"||x==="image"||x==="video"}lt.maxOverzooming=10,lt.maxUnderzooming=3;class xr{constructor(i,d){this.reset(i,d)}reset(i,d){this.points=i||[],this._distances=[0];for(let p=1;p<this.points.length;p++)this._distances[p]=this._distances[p-1]+this.points[p].dist(this.points[p-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(d||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(i){if(this.points.length===1)return this.points[0];i=a.ah(i,0,1);let d=1,p=this._distances[d];const _=i*this.paddedLength+this.padding;for(;p<_&&d<this._distances.length;)p=this._distances[++d];const w=d-1,E=this._distances[w],M=p-E,D=M>0?(_-E)/M:0;return this.points[w].mult(1-D).add(this.points[d].mult(D))}}function kr(x,i){let d=!0;return x==="always"||x!=="never"&&i!=="never"||(d=!1),d}class Vr{constructor(i,d,p){const _=this.boxCells=[],w=this.circleCells=[];this.xCellCount=Math.ceil(i/p),this.yCellCount=Math.ceil(d/p);for(let E=0;E<this.xCellCount*this.yCellCount;E++)_.push([]),w.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=i,this.height=d,this.xScale=this.xCellCount/i,this.yScale=this.yCellCount/d,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(i,d,p,_,w){this._forEachCell(d,p,_,w,this._insertBoxCell,this.boxUid++),this.boxKeys.push(i),this.bboxes.push(d),this.bboxes.push(p),this.bboxes.push(_),this.bboxes.push(w)}insertCircle(i,d,p,_){this._forEachCell(d-_,p-_,d+_,p+_,this._insertCircleCell,this.circleUid++),this.circleKeys.push(i),this.circles.push(d),this.circles.push(p),this.circles.push(_)}_insertBoxCell(i,d,p,_,w,E){this.boxCells[w].push(E)}_insertCircleCell(i,d,p,_,w,E){this.circleCells[w].push(E)}_query(i,d,p,_,w,E,M){if(p<0||i>this.width||_<0||d>this.height)return[];const D=[];if(i<=0&&d<=0&&this.width<=p&&this.height<=_){if(w)return[{key:null,x1:i,y1:d,x2:p,y2:_}];for(let $=0;$<this.boxKeys.length;$++)D.push({key:this.boxKeys[$],x1:this.bboxes[4*$],y1:this.bboxes[4*$+1],x2:this.bboxes[4*$+2],y2:this.bboxes[4*$+3]});for(let $=0;$<this.circleKeys.length;$++){const U=this.circles[3*$],K=this.circles[3*$+1],H=this.circles[3*$+2];D.push({key:this.circleKeys[$],x1:U-H,y1:K-H,x2:U+H,y2:K+H})}}else this._forEachCell(i,d,p,_,this._queryCell,D,{hitTest:w,overlapMode:E,seenUids:{box:{},circle:{}}},M);return D}query(i,d,p,_){return this._query(i,d,p,_,!1,null)}hitTest(i,d,p,_,w,E){return this._query(i,d,p,_,!0,w,E).length>0}hitTestCircle(i,d,p,_,w){const E=i-p,M=i+p,D=d-p,$=d+p;if(M<0||E>this.width||$<0||D>this.height)return!1;const U=[];return this._forEachCell(E,D,M,$,this._queryCellCircle,U,{hitTest:!0,overlapMode:_,circle:{x:i,y:d,radius:p},seenUids:{box:{},circle:{}}},w),U.length>0}_queryCell(i,d,p,_,w,E,M,D){const{seenUids:$,hitTest:U,overlapMode:K}=M,H=this.boxCells[w];if(H!==null){const ae=this.bboxes;for(const me of H)if(!$.box[me]){$.box[me]=!0;const ge=4*me,_e=this.boxKeys[me];if(i<=ae[ge+2]&&d<=ae[ge+3]&&p>=ae[ge+0]&&_>=ae[ge+1]&&(!D||D(_e))&&(!U||!kr(K,_e.overlapMode))&&(E.push({key:_e,x1:ae[ge],y1:ae[ge+1],x2:ae[ge+2],y2:ae[ge+3]}),U))return!0}}const ee=this.circleCells[w];if(ee!==null){const ae=this.circles;for(const me of ee)if(!$.circle[me]){$.circle[me]=!0;const ge=3*me,_e=this.circleKeys[me];if(this._circleAndRectCollide(ae[ge],ae[ge+1],ae[ge+2],i,d,p,_)&&(!D||D(_e))&&(!U||!kr(K,_e.overlapMode))){const Te=ae[ge],Ce=ae[ge+1],Ee=ae[ge+2];if(E.push({key:_e,x1:Te-Ee,y1:Ce-Ee,x2:Te+Ee,y2:Ce+Ee}),U)return!0}}}return!1}_queryCellCircle(i,d,p,_,w,E,M,D){const{circle:$,seenUids:U,overlapMode:K}=M,H=this.boxCells[w];if(H!==null){const ae=this.bboxes;for(const me of H)if(!U.box[me]){U.box[me]=!0;const ge=4*me,_e=this.boxKeys[me];if(this._circleAndRectCollide($.x,$.y,$.radius,ae[ge+0],ae[ge+1],ae[ge+2],ae[ge+3])&&(!D||D(_e))&&!kr(K,_e.overlapMode))return E.push(!0),!0}}const ee=this.circleCells[w];if(ee!==null){const ae=this.circles;for(const me of ee)if(!U.circle[me]){U.circle[me]=!0;const ge=3*me,_e=this.circleKeys[me];if(this._circlesCollide(ae[ge],ae[ge+1],ae[ge+2],$.x,$.y,$.radius)&&(!D||D(_e))&&!kr(K,_e.overlapMode))return E.push(!0),!0}}}_forEachCell(i,d,p,_,w,E,M,D){const $=this._convertToXCellCoord(i),U=this._convertToYCellCoord(d),K=this._convertToXCellCoord(p),H=this._convertToYCellCoord(_);for(let ee=$;ee<=K;ee++)for(let ae=U;ae<=H;ae++)if(w.call(this,i,d,p,_,this.xCellCount*ae+ee,E,M,D))return}_convertToXCellCoord(i){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(i*this.xScale)))}_convertToYCellCoord(i){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(i*this.yScale)))}_circlesCollide(i,d,p,_,w,E){const M=_-i,D=w-d,$=p+E;return $*$>M*M+D*D}_circleAndRectCollide(i,d,p,_,w,E,M){const D=(E-_)/2,$=Math.abs(i-(_+D));if($>D+p)return!1;const U=(M-w)/2,K=Math.abs(d-(w+U));if(K>U+p)return!1;if($<=D||K<=U)return!0;const H=$-D,ee=K-U;return H*H+ee*ee<=p*p}}function tr(x,i,d){const p=a.L();if(!x){const{vecSouth:K,vecEast:H}=Tr(i),ee=y();ee[0]=H[0],ee[1]=H[1],ee[2]=K[0],ee[3]=K[1],_=ee,(U=(E=(w=ee)[0])*($=w[3])-(D=w[2])*(M=w[1]))&&(_[0]=$*(U=1/U),_[1]=-M*U,_[2]=-D*U,_[3]=E*U),p[0]=ee[0],p[1]=ee[1],p[4]=ee[2],p[5]=ee[3]}var _,w,E,M,D,$,U;return a.N(p,p,[1/d,1/d,1]),p}function zr(x,i,d,p){if(x){const _=a.L();if(!i){const{vecSouth:w,vecEast:E}=Tr(d);_[0]=E[0],_[1]=E[1],_[4]=w[0],_[5]=w[1]}return a.N(_,_,[p,p,1]),_}return d.pixelsToClipSpaceMatrix}function Tr(x){const i=Math.cos(x.rollInRadians),d=Math.sin(x.rollInRadians),p=Math.cos(x.pitchInRadians),_=Math.cos(x.bearingInRadians),w=Math.sin(x.bearingInRadians),E=a.ar();E[0]=-_*p*d-w*i,E[1]=-w*p*d+_*i;const M=a.as(E);M<1e-9?a.at(E):a.au(E,E,1/M);const D=a.ar();D[0]=_*p*i-w*d,D[1]=w*p*i+_*d;const $=a.as(D);return $<1e-9?a.at(D):a.au(D,D,1/$),{vecEast:D,vecSouth:E}}function ot(x,i,d,p){let _;p?(_=[x,i,p(x,i),1],a.aw(_,_,d)):(_=[x,i,0,1],ys(_,_,d));const w=_[3];return{point:new a.P(_[0]/w,_[1]/w),signedDistanceFromCamera:w,isOccluded:!1}}function Ds(x,i){return .5+x/i*.5}function Bi(x,i){return x.x>=-i[0]&&x.x<=i[0]&&x.y>=-i[1]&&x.y<=i[1]}function $i(x,i,d,p,_,w,E,M,D,$,U,K,H){const ee=d?x.textSizeData:x.iconSizeData,ae=a.an(ee,i.transform.zoom),me=[256/i.width*2+1,256/i.height*2+1],ge=d?x.text.dynamicLayoutVertexArray:x.icon.dynamicLayoutVertexArray;ge.clear();const _e=x.lineVertexArray,Te=d?x.text.placedSymbolArray:x.icon.placedSymbolArray,Ce=i.transform.width/i.transform.height;let Ee=!1;for(let Ie=0;Ie<Te.length;Ie++){const Le=Te.get(Ie);if(Le.hidden||Le.writingMode===a.ao.vertical&&!Ee){hr(Le.numGlyphs,ge);continue}Ee=!1;const Pe=new a.P(Le.anchorX,Le.anchorY),Ne={getElevation:H,pitchedLabelPlaneMatrix:p,lineVertexArray:_e,pitchWithMap:w,projectionCache:{projections:{},offsets:{},cachedAnchorPoint:void 0,anyProjectionOccluded:!1},transform:i.transform,tileAnchorPoint:Pe,unwrappedTileID:D,width:$,height:U,translation:K},qe=Nt(Le.anchorX,Le.anchorY,Ne);if(!Bi(qe.point,me)){hr(Le.numGlyphs,ge);continue}const Ve=Ds(i.transform.cameraToCenterDistance,qe.signedDistanceFromCamera),Ge=a.ap(ee,ae,Le),We=w?Ge*i.transform.getPitchedTextCorrection(Le.anchorX,Le.anchorY,D)/Ve:Ge*Ve,ct=er({projectionContext:Ne,pitchedLabelPlaneMatrixInverse:_,symbol:Le,fontSize:We,flip:!1,keepUpright:E,glyphOffsetArray:x.glyphOffsetArray,dynamicLayoutVertexArray:ge,aspectRatio:Ce,rotateToLine:M});Ee=ct.useVertical,(ct.notEnoughRoom||Ee||ct.needsFlipping&&er({projectionContext:Ne,pitchedLabelPlaneMatrixInverse:_,symbol:Le,fontSize:We,flip:!0,keepUpright:E,glyphOffsetArray:x.glyphOffsetArray,dynamicLayoutVertexArray:ge,aspectRatio:Ce,rotateToLine:M}).notEnoughRoom)&&hr(Le.numGlyphs,ge)}d?x.text.dynamicLayoutVertexBuffer.updateData(ge):x.icon.dynamicLayoutVertexBuffer.updateData(ge)}function Tn(x,i,d,p,_,w,E,M){const D=w.glyphStartIndex+w.numGlyphs,$=w.lineStartIndex,U=w.lineStartIndex+w.lineLength,K=i.getoffsetX(w.glyphStartIndex),H=i.getoffsetX(D-1),ee=ri(x*K,d,p,_,w.segment,$,U,M,E);if(!ee)return null;const ae=ri(x*H,d,p,_,w.segment,$,U,M,E);return ae?M.projectionCache.anyProjectionOccluded?null:{first:ee,last:ae}:null}function dt(x,i,d,p){return x===a.ao.horizontal&&Math.abs(d.y-i.y)>Math.abs(d.x-i.x)*p?{useVertical:!0}:(x===a.ao.vertical?i.y<d.y:i.x>d.x)?{needsFlipping:!0}:null}function er(x){const{projectionContext:i,pitchedLabelPlaneMatrixInverse:d,symbol:p,fontSize:_,flip:w,keepUpright:E,glyphOffsetArray:M,dynamicLayoutVertexArray:D,aspectRatio:$,rotateToLine:U}=x,K=_/24,H=p.lineOffsetX*K,ee=p.lineOffsetY*K;let ae;if(p.numGlyphs>1){const me=p.glyphStartIndex+p.numGlyphs,ge=p.lineStartIndex,_e=p.lineStartIndex+p.lineLength,Te=Tn(K,M,H,ee,w,p,U,i);if(!Te)return{notEnoughRoom:!0};const Ce=or(Te.first.point.x,Te.first.point.y,i,d),Ee=or(Te.last.point.x,Te.last.point.y,i,d);if(E&&!w){const Ie=dt(p.writingMode,Ce,Ee,$);if(Ie)return Ie}ae=[Te.first];for(let Ie=p.glyphStartIndex+1;Ie<me-1;Ie++){const Le=ri(K*M.getoffsetX(Ie),H,ee,w,p.segment,ge,_e,i,U);if(!Le)return{notEnoughRoom:!0};ae.push(Le)}ae.push(Te.last)}else{if(E&&!w){const ge=Ze(i.tileAnchorPoint.x,i.tileAnchorPoint.y,i).point,_e=p.lineStartIndex+p.segment+1,Te=new a.P(i.lineVertexArray.getx(_e),i.lineVertexArray.gety(_e)),Ce=Ze(Te.x,Te.y,i),Ee=Ce.signedDistanceFromCamera>0?Ce.point:Yt(i.tileAnchorPoint,Te,ge,1,i),Ie=or(ge.x,ge.y,i,d),Le=or(Ee.x,Ee.y,i,d),Pe=dt(p.writingMode,Ie,Le,$);if(Pe)return Pe}const me=ri(K*M.getoffsetX(p.glyphStartIndex),H,ee,w,p.segment,p.lineStartIndex,p.lineStartIndex+p.lineLength,i,U);if(!me||i.projectionCache.anyProjectionOccluded)return{notEnoughRoom:!0};ae=[me]}for(const me of ae)a.av(D,me.point,me.angle);return{}}function Yt(x,i,d,p,_){const w=x.add(x.sub(i)._unit()),E=Ze(w.x,w.y,_).point,M=d.sub(E);return d.add(M._mult(p/M.mag()))}function Vi(x,i,d){const p=i.projectionCache;if(p.projections[x])return p.projections[x];const _=new a.P(i.lineVertexArray.getx(x),i.lineVertexArray.gety(x)),w=Ze(_.x,_.y,i);if(w.signedDistanceFromCamera>0)return p.projections[x]=w.point,p.anyProjectionOccluded=p.anyProjectionOccluded||w.isOccluded,w.point;const E=x-d.direction;return Yt(d.distanceFromAnchor===0?i.tileAnchorPoint:new a.P(i.lineVertexArray.getx(E),i.lineVertexArray.gety(E)),_,d.previousVertex,d.absOffsetX-d.distanceFromAnchor+1,i)}function Ze(x,i,d){const p=x+d.translation[0],_=i+d.translation[1];let w;return d.pitchWithMap?(w=ot(p,_,d.pitchedLabelPlaneMatrix,d.getElevation),w.isOccluded=!1):(w=d.transform.projectTileCoordinates(p,_,d.unwrappedTileID,d.getElevation),w.point.x=(.5*w.point.x+.5)*d.width,w.point.y=(.5*-w.point.y+.5)*d.height),w}function or(x,i,d,p){if(d.pitchWithMap){const _=[x,i,0,1];return a.aw(_,_,p),d.transform.projectTileCoordinates(_[0]/_[3],_[1]/_[3],d.unwrappedTileID,d.getElevation).point}return{x:x/d.width*2-1,y:1-i/d.height*2}}function Nt(x,i,d){return d.transform.projectTileCoordinates(x,i,d.unwrappedTileID,d.getElevation)}function En(x,i,d){return x._unit()._perp()._mult(i*d)}function Wn(x,i,d,p,_,w,E,M,D){if(M.projectionCache.offsets[x])return M.projectionCache.offsets[x];const $=d.add(i);if(x+D.direction<p||x+D.direction>=_)return M.projectionCache.offsets[x]=$,$;const U=Vi(x+D.direction,M,D),K=En(U.sub(d),E,D.direction),H=d.add(K),ee=U.add(K);return M.projectionCache.offsets[x]=a.ax(w,$,H,ee)||$,M.projectionCache.offsets[x]}function ri(x,i,d,p,_,w,E,M,D){const $=p?x-i:x+i;let U=$>0?1:-1,K=0;p&&(U*=-1,K=Math.PI),U<0&&(K+=Math.PI);let H,ee=U>0?w+_:w+_+1;M.projectionCache.cachedAnchorPoint?H=M.projectionCache.cachedAnchorPoint:(H=Ze(M.tileAnchorPoint.x,M.tileAnchorPoint.y,M).point,M.projectionCache.cachedAnchorPoint=H);let ae,me,ge=H,_e=H,Te=0,Ce=0;const Ee=Math.abs($),Ie=[];let Le;for(;Te+Ce<=Ee;){if(ee+=U,ee<w||ee>=E)return null;Te+=Ce,_e=ge,me=ae;const qe={absOffsetX:Ee,direction:U,distanceFromAnchor:Te,previousVertex:_e};if(ge=Vi(ee,M,qe),d===0)Ie.push(_e),Le=ge.sub(_e);else{let Ve;const Ge=ge.sub(_e);Ve=Ge.mag()===0?En(Vi(ee+U,M,qe).sub(ge),d,U):En(Ge,d,U),me||(me=_e.add(Ve)),ae=Wn(ee,Ve,ge,w,E,me,d,M,qe),Ie.push(me),Le=ae.sub(me)}Ce=Le.mag()}const Pe=Le._mult((Ee-Te)/Ce)._add(me||_e),Ne=K+Math.atan2(ge.y-_e.y,ge.x-_e.x);return Ie.push(Pe),{point:Pe,angle:D?Ne:0,path:Ie}}const Ri=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function hr(x,i){for(let d=0;d<x;d++){const p=i.length;i.resize(p+4),i.float32.set(Ri,3*p)}}function ys(x,i,d){const p=i[0],_=i[1];return x[0]=d[0]*p+d[4]*_+d[12],x[1]=d[1]*p+d[5]*_+d[13],x[3]=d[3]*p+d[7]*_+d[15],x}const br=100;class bi{constructor(i,d=new Vr(i.width+200,i.height+200,25),p=new Vr(i.width+200,i.height+200,25)){this.transform=i,this.grid=d,this.ignoredGrid=p,this.pitchFactor=Math.cos(i.pitch*Math.PI/180)*i.cameraToCenterDistance,this.screenRightBoundary=i.width+br,this.screenBottomBoundary=i.height+br,this.gridRightBoundary=i.width+200,this.gridBottomBoundary=i.height+200,this.perspectiveRatioCutoff=.6}placeCollisionBox(i,d,p,_,w,E,M,D,$,U,K,H){const ee=this.projectAndGetPerspectiveRatio(i.anchorPointX+D[0],i.anchorPointY+D[1],w,U,H),ae=p*ee.perspectiveRatio;let me;if(E||M)me=this._projectCollisionBox(i,ae,_,w,E,M,D,ee,U,K,H);else{const Le=ee.x+(K?K.x*ae:0),Pe=ee.y+(K?K.y*ae:0);me={allPointsOccluded:!1,box:[Le+i.x1*ae,Pe+i.y1*ae,Le+i.x2*ae,Pe+i.y2*ae]}}const[ge,_e,Te,Ce]=me.box,Ee=E?me.allPointsOccluded:ee.isOccluded;let Ie=Ee;return Ie||(Ie=ee.perspectiveRatio<this.perspectiveRatioCutoff),Ie||(Ie=!this.isInsideGrid(ge,_e,Te,Ce)),Ie||d!=="always"&&this.grid.hitTest(ge,_e,Te,Ce,d,$)?{box:[ge,_e,Te,Ce],placeable:!1,offscreen:!1,occluded:Ee}:{box:[ge,_e,Te,Ce],placeable:!0,offscreen:this.isOffscreen(ge,_e,Te,Ce),occluded:Ee}}placeCollisionCircles(i,d,p,_,w,E,M,D,$,U,K,H,ee,ae){const me=[],ge=new a.P(d.anchorX,d.anchorY),_e=this.getPerspectiveRatio(ge.x,ge.y,E,ae),Te=($?w*this.transform.getPitchedTextCorrection(d.anchorX,d.anchorY,E)/_e:w*_e)/a.aB,Ce={getElevation:ae,pitchedLabelPlaneMatrix:M,lineVertexArray:p,pitchWithMap:$,projectionCache:{projections:{},offsets:{},cachedAnchorPoint:void 0,anyProjectionOccluded:!1},transform:this.transform,tileAnchorPoint:ge,unwrappedTileID:E,width:this.transform.width,height:this.transform.height,translation:ee},Ee=Tn(Te,_,d.lineOffsetX*Te,d.lineOffsetY*Te,!1,d,!1,Ce);let Ie=!1,Le=!1,Pe=!0;if(Ee){const Ne=.5*K*_e+H,qe=new a.P(-100,-100),Ve=new a.P(this.screenRightBoundary,this.screenBottomBoundary),Ge=new xr,We=Ee.first,ct=Ee.last;let ut=[];for(let qt=We.path.length-1;qt>=1;qt--)ut.push(We.path[qt]);for(let qt=1;qt<ct.path.length;qt++)ut.push(ct.path[qt]);const tt=2.5*Ne;if($){const qt=this.projectPathToScreenSpace(ut,Ce);ut=qt.some(Mr=>Mr.signedDistanceFromCamera<=0)?[]:qt.map(Mr=>Mr.point)}let At=[];if(ut.length>0){const qt=ut[0].clone(),Mr=ut[0].clone();for(let Ir=1;Ir<ut.length;Ir++)qt.x=Math.min(qt.x,ut[Ir].x),qt.y=Math.min(qt.y,ut[Ir].y),Mr.x=Math.max(Mr.x,ut[Ir].x),Mr.y=Math.max(Mr.y,ut[Ir].y);At=qt.x>=qe.x&&Mr.x<=Ve.x&&qt.y>=qe.y&&Mr.y<=Ve.y?[ut]:Mr.x<qe.x||qt.x>Ve.x||Mr.y<qe.y||qt.y>Ve.y?[]:a.ay([ut],qe.x,qe.y,Ve.x,Ve.y)}for(const qt of At){Ge.reset(qt,.25*Ne);let Mr=0;Mr=Ge.length<=.5*Ne?1:Math.ceil(Ge.paddedLength/tt)+1;for(let Ir=0;Ir<Mr;Ir++){const Fr=Ir/Math.max(Mr-1,1),sn=Ge.lerp(Fr),Ur=sn.x+br,gr=sn.y+br;me.push(Ur,gr,Ne,0);const Xr=Ur-Ne,Ti=gr-Ne,Cn=Ur+Ne,Pn=gr+Ne;if(Pe=Pe&&this.isOffscreen(Xr,Ti,Cn,Pn),Le=Le||this.isInsideGrid(Xr,Ti,Cn,Pn),i!=="always"&&this.grid.hitTestCircle(Ur,gr,Ne,i,U)&&(Ie=!0,!D))return{circles:[],offscreen:!1,collisionDetected:Ie}}}}return{circles:!D&&Ie||!Le||_e<this.perspectiveRatioCutoff?[]:me,offscreen:Pe,collisionDetected:Ie}}projectPathToScreenSpace(i,d){const p=function(_,w){const E=a.L();return a.aq(E,w.pitchedLabelPlaneMatrix),_.map(M=>{const D=ot(M.x,M.y,E,w.getElevation),$=w.transform.projectTileCoordinates(D.point.x,D.point.y,w.unwrappedTileID,w.getElevation);return $.point.x=(.5*$.point.x+.5)*w.width,$.point.y=(.5*-$.point.y+.5)*w.height,$})}(i,d);return function(_){let w=0,E=0,M=0,D=0;for(let $=0;$<_.length;$++)_[$].isOccluded?(M=$+1,D=0):(D++,D>E&&(E=D,w=M));return _.slice(w,w+E)}(p)}queryRenderedSymbols(i){if(i.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};const d=[],p=new a.a2;for(const K of i){const H=new a.P(K.x+br,K.y+br);p.extend(H),d.push(H)}const{minX:_,minY:w,maxX:E,maxY:M}=p,D=this.grid.query(_,w,E,M).concat(this.ignoredGrid.query(_,w,E,M)),$={},U={};for(const K of D){const H=K.key;if($[H.bucketInstanceId]===void 0&&($[H.bucketInstanceId]={}),$[H.bucketInstanceId][H.featureIndex])continue;const ee=[new a.P(K.x1,K.y1),new a.P(K.x2,K.y1),new a.P(K.x2,K.y2),new a.P(K.x1,K.y2)];a.az(d,ee)&&($[H.bucketInstanceId][H.featureIndex]=!0,U[H.bucketInstanceId]===void 0&&(U[H.bucketInstanceId]=[]),U[H.bucketInstanceId].push(H.featureIndex))}return U}insertCollisionBox(i,d,p,_,w,E){(p?this.ignoredGrid:this.grid).insert({bucketInstanceId:_,featureIndex:w,collisionGroupID:E,overlapMode:d},i[0],i[1],i[2],i[3])}insertCollisionCircles(i,d,p,_,w,E){const M=p?this.ignoredGrid:this.grid,D={bucketInstanceId:_,featureIndex:w,collisionGroupID:E,overlapMode:d};for(let $=0;$<i.length;$+=4)M.insertCircle(D,i[$],i[$+1],i[$+2])}projectAndGetPerspectiveRatio(i,d,p,_,w){if(w){let E;_?(E=[i,d,_(i,d),1],a.aw(E,E,w)):(E=[i,d,0,1],ys(E,E,w));const M=E[3];return{x:(E[0]/M+1)/2*this.transform.width+br,y:(-E[1]/M+1)/2*this.transform.height+br,perspectiveRatio:.5+this.transform.cameraToCenterDistance/M*.5,isOccluded:!1,signedDistanceFromCamera:M}}{const E=this.transform.projectTileCoordinates(i,d,p,_);return{x:(E.point.x+1)/2*this.transform.width+br,y:(1-E.point.y)/2*this.transform.height+br,perspectiveRatio:.5+this.transform.cameraToCenterDistance/E.signedDistanceFromCamera*.5,isOccluded:E.isOccluded,signedDistanceFromCamera:E.signedDistanceFromCamera}}}getPerspectiveRatio(i,d,p,_){const w=this.transform.projectTileCoordinates(i,d,p,_);return .5+this.transform.cameraToCenterDistance/w.signedDistanceFromCamera*.5}isOffscreen(i,d,p,_){return p<br||i>=this.screenRightBoundary||_<br||d>this.screenBottomBoundary}isInsideGrid(i,d,p,_){return p>=0&&i<this.gridRightBoundary&&_>=0&&d<this.gridBottomBoundary}getViewportMatrix(){const i=a.ag([]);return a.M(i,i,[-100,-100,0]),i}_projectCollisionBox(i,d,p,_,w,E,M,D,$,U,K){let H=1,ee=0,ae=0,me=1;const ge=i.anchorPointX+M[0],_e=i.anchorPointY+M[1];if(E&&!w){const ut=this.projectAndGetPerspectiveRatio(ge+1,_e,_,$,K),tt=ut.x-D.x,At=Math.atan((ut.y-D.y)/tt)+(tt<0?Math.PI:0),qt=Math.sin(At),Mr=Math.cos(At);H=Mr,ee=qt,ae=-qt,me=Mr}else if(!E&&w){const ut=Tr(this.transform);H=ut.vecEast[0],ee=ut.vecEast[1],ae=ut.vecSouth[0],me=ut.vecSouth[1]}let Te=D.x,Ce=D.y,Ee=d;w&&(Te=ge,Ce=_e,Ee=Math.pow(2,-(this.transform.zoom-p.overscaledZ)),Ee*=this.transform.getPitchedTextCorrection(ge,_e,_),U||(Ee*=a.ah(.5+D.signedDistanceFromCamera/this.transform.cameraToCenterDistance*.5,0,4))),U&&(Te+=H*U.x*Ee+ae*U.y*Ee,Ce+=ee*U.x*Ee+me*U.y*Ee);const Ie=i.x1*Ee,Le=i.x2*Ee,Pe=(Ie+Le)/2,Ne=i.y1*Ee,qe=i.y2*Ee,Ve=(Ne+qe)/2,Ge=[{offsetX:Ie,offsetY:Ne},{offsetX:Pe,offsetY:Ne},{offsetX:Le,offsetY:Ne},{offsetX:Le,offsetY:Ve},{offsetX:Le,offsetY:qe},{offsetX:Pe,offsetY:qe},{offsetX:Ie,offsetY:qe},{offsetX:Ie,offsetY:Ve}];let We=[];for(const{offsetX:ut,offsetY:tt}of Ge)We.push(new a.P(Te+H*ut+ae*tt,Ce+ee*ut+me*tt));let ct=!1;if(w){const ut=We.map(tt=>this.projectAndGetPerspectiveRatio(tt.x,tt.y,_,$,K));ct=ut.some(tt=>!tt.isOccluded),We=ut.map(tt=>new a.P(tt.x,tt.y))}else ct=!0;return{box:a.aA(We),allPointsOccluded:!ct}}}class wr{constructor(i,d,p,_){this.opacity=i?Math.max(0,Math.min(1,i.opacity+(i.placed?d:-d))):_&&p?1:0,this.placed=p}isHidden(){return this.opacity===0&&!this.placed}}class La{constructor(i,d,p,_,w){this.text=new wr(i?i.text:null,d,p,w),this.icon=new wr(i?i.icon:null,d,_,w)}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class Ls{constructor(i,d,p){this.text=i,this.icon=d,this.skipFade=p}}class Wu{constructor(i,d,p,_,w){this.bucketInstanceId=i,this.featureIndex=d,this.sourceLayerIndex=p,this.bucketIndex=_,this.tileID=w}}class Os{constructor(i){this.crossSourceCollisions=i,this.maxGroupID=0,this.collisionGroups={}}get(i){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[i]){const d=++this.maxGroupID;this.collisionGroups[i]={ID:d,predicate:p=>p.collisionGroupID===d}}return this.collisionGroups[i]}}function Ui(x,i,d,p,_){const{horizontalAlign:w,verticalAlign:E}=a.aH(x);return new a.P(-(w-.5)*i+p[0]*_,-(E-.5)*d+p[1]*_)}class qn{constructor(i,d,p,_,w){this.transform=i.clone(),this.terrain=d,this.collisionIndex=new bi(this.transform),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=p,this.retainedQueryData={},this.collisionGroups=new Os(_),this.collisionCircleArrays={},this.collisionBoxArrays=new Map,this.prevPlacement=w,w&&(w.prevPlacement=void 0),this.placedOrientations={}}_getTerrainElevationFunc(i){const d=this.terrain;return d?(p,_)=>d.getElevation(i,p,_):null}getBucketParts(i,d,p,_){const w=p.getBucket(d),E=p.latestFeatureIndex;if(!w||!E||d.id!==w.layerIds[0])return;const M=p.collisionBoxArray,D=w.layers[0].layout,$=w.layers[0].paint,U=Math.pow(2,this.transform.zoom-p.tileID.overscaledZ),K=p.tileSize/a.$,H=p.tileID.toUnwrapped(),ee=D.get("text-rotation-alignment")==="map",ae=a.aC(p,1,this.transform.zoom),me=a.aD(this.collisionIndex.transform,p,$.get("text-translate"),$.get("text-translate-anchor")),ge=a.aD(this.collisionIndex.transform,p,$.get("icon-translate"),$.get("icon-translate-anchor")),_e=tr(ee,this.transform,ae);this.retainedQueryData[w.bucketInstanceId]=new Wu(w.bucketInstanceId,E,w.sourceLayerIndex,w.index,p.tileID);const Te={bucket:w,layout:D,translationText:me,translationIcon:ge,unwrappedTileID:H,pitchedLabelPlaneMatrix:_e,scale:U,textPixelRatio:K,holdingForFade:p.holdingForSymbolFade(),collisionBoxArray:M,partiallyEvaluatedTextSize:a.an(w.textSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(w.sourceID)};if(_)for(const Ce of w.sortKeyRanges){const{sortKey:Ee,symbolInstanceStart:Ie,symbolInstanceEnd:Le}=Ce;i.push({sortKey:Ee,symbolInstanceStart:Ie,symbolInstanceEnd:Le,parameters:Te})}else i.push({symbolInstanceStart:0,symbolInstanceEnd:w.symbolInstances.length,parameters:Te})}attemptAnchorPlacement(i,d,p,_,w,E,M,D,$,U,K,H,ee,ae,me,ge,_e,Te,Ce,Ee){const Ie=a.aE[i.textAnchor],Le=[i.textOffset0,i.textOffset1],Pe=Ui(Ie,p,_,Le,w),Ne=this.collisionIndex.placeCollisionBox(d,H,D,$,U,M,E,ge,K.predicate,Ce,Pe,Ee);if((!Te||this.collisionIndex.placeCollisionBox(Te,H,D,$,U,M,E,_e,K.predicate,Ce,Pe,Ee).placeable)&&Ne.placeable){let qe;if(this.prevPlacement&&this.prevPlacement.variableOffsets[ee.crossTileID]&&this.prevPlacement.placements[ee.crossTileID]&&this.prevPlacement.placements[ee.crossTileID].text&&(qe=this.prevPlacement.variableOffsets[ee.crossTileID].anchor),ee.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");return this.variableOffsets[ee.crossTileID]={textOffset:Le,width:p,height:_,anchor:Ie,textBoxScale:w,prevAnchor:qe},this.markUsedJustification(ae,Ie,ee,me),ae.allowVerticalPlacement&&(this.markUsedOrientation(ae,me,ee),this.placedOrientations[ee.crossTileID]=me),{shift:Pe,placedGlyphBoxes:Ne}}}placeLayerBucketPart(i,d,p){const{bucket:_,layout:w,translationText:E,translationIcon:M,unwrappedTileID:D,pitchedLabelPlaneMatrix:$,textPixelRatio:U,holdingForFade:K,collisionBoxArray:H,partiallyEvaluatedTextSize:ee,collisionGroup:ae}=i.parameters,me=w.get("text-optional"),ge=w.get("icon-optional"),_e=a.aF(w,"text-overlap","text-allow-overlap"),Te=_e==="always",Ce=a.aF(w,"icon-overlap","icon-allow-overlap"),Ee=Ce==="always",Ie=w.get("text-rotation-alignment")==="map",Le=w.get("text-pitch-alignment")==="map",Pe=w.get("icon-text-fit")!=="none",Ne=w.get("symbol-z-order")==="viewport-y",qe=Te&&(Ee||!_.hasIconData()||ge),Ve=Ee&&(Te||!_.hasTextData()||me);!_.collisionArrays&&H&&_.deserializeCollisionBoxes(H);const Ge=this.retainedQueryData[_.bucketInstanceId].tileID,We=this._getTerrainElevationFunc(Ge),ct=this.transform.getFastPathSimpleProjectionMatrix(Ge),ut=(tt,At,qt)=>{var Mr,Ir;if(d[tt.crossTileID])return;if(K)return void(this.placements[tt.crossTileID]=new Ls(!1,!1,!1));let Fr=!1,sn=!1,Ur=!0,gr=null,Xr={box:null,placeable:!1,offscreen:null,occluded:!1},Ti={placeable:!1},Cn=null,Pn=null,Zi=null,$a=0,lo=0,Va=0;At.textFeatureIndex?$a=At.textFeatureIndex:tt.useRuntimeCollisionCircles&&($a=tt.featureIndex),At.verticalTextFeatureIndex&&(lo=At.verticalTextFeatureIndex);const zl=At.textBox;if(zl){const vs=_n=>{let Zn=a.ao.horizontal;if(_.allowVerticalPlacement&&!_n&&this.prevPlacement){const bs=this.prevPlacement.placedOrientations[tt.crossTileID];bs&&(this.placedOrientations[tt.crossTileID]=bs,Zn=bs,this.markUsedOrientation(_,Zn,tt))}return Zn},Oo=(_n,Zn)=>{if(_.allowVerticalPlacement&&tt.numVerticalGlyphVertices>0&&At.verticalTextBox){for(const bs of _.writingModes)if(bs===a.ao.vertical?(Xr=Zn(),Ti=Xr):Xr=_n(),Xr&&Xr.placeable)break}else Xr=_n()},zo=tt.textAnchorOffsetStartIndex,xs=tt.textAnchorOffsetEndIndex;if(xs===zo){const _n=(Zn,bs)=>{const oi=this.collisionIndex.placeCollisionBox(Zn,_e,U,Ge,D,Le,Ie,E,ae.predicate,We,void 0,ct);return oi&&oi.placeable&&(this.markUsedOrientation(_,bs,tt),this.placedOrientations[tt.crossTileID]=bs),oi};Oo(()=>_n(zl,a.ao.horizontal),()=>{const Zn=At.verticalTextBox;return _.allowVerticalPlacement&&tt.numVerticalGlyphVertices>0&&Zn?_n(Zn,a.ao.vertical):{box:null,offscreen:null}}),vs(Xr&&Xr.placeable)}else{let _n=a.aE[(Ir=(Mr=this.prevPlacement)===null||Mr===void 0?void 0:Mr.variableOffsets[tt.crossTileID])===null||Ir===void 0?void 0:Ir.anchor];const Zn=(oi,gg,bh)=>{const Nl=oi.x2-oi.x1,oa=oi.y2-oi.y1,co=tt.textBoxScale,Ua=Pe&&Ce==="never"?gg:null;let Ga=null,yg=_e==="never"?1:2,_g="never";_n&&yg++;for(let Wa=0;Wa<yg;Wa++){for(let vg=zo;vg<xs;vg++){const xg=_.textAnchorOffsets.get(vg);if(_n&&xg.textAnchor!==_n)continue;const wh=this.attemptAnchorPlacement(xg,oi,Nl,oa,co,Ie,Le,U,Ge,D,ae,_g,tt,_,bh,E,M,Ua,We);if(wh&&(Ga=wh.placedGlyphBoxes,Ga&&Ga.placeable))return Fr=!0,gr=wh.shift,Ga}_n?_n=null:_g=_e}return p&&!Ga&&(Ga={box:this.collisionIndex.placeCollisionBox(zl,"always",U,Ge,D,Le,Ie,E,ae.predicate,We,void 0,ct).box,offscreen:!1,placeable:!1,occluded:!1}),Ga};Oo(()=>Zn(zl,At.iconBox,a.ao.horizontal),()=>{const oi=At.verticalTextBox;return _.allowVerticalPlacement&&(!Xr||!Xr.placeable)&&tt.numVerticalGlyphVertices>0&&oi?Zn(oi,At.verticalIconBox,a.ao.vertical):{box:null,occluded:!0,offscreen:null}}),Xr&&(Fr=Xr.placeable,Ur=Xr.offscreen);const bs=vs(Xr&&Xr.placeable);if(!Fr&&this.prevPlacement){const oi=this.prevPlacement.variableOffsets[tt.crossTileID];oi&&(this.variableOffsets[tt.crossTileID]=oi,this.markUsedJustification(_,oi.anchor,tt,bs))}}}if(Cn=Xr,Fr=Cn&&Cn.placeable,Ur=Cn&&Cn.offscreen,tt.useRuntimeCollisionCircles&&tt.centerJustifiedTextSymbolIndex>=0){const vs=_.text.placedSymbolArray.get(tt.centerJustifiedTextSymbolIndex),Oo=a.ap(_.textSizeData,ee,vs),zo=w.get("text-padding");Pn=this.collisionIndex.placeCollisionCircles(_e,vs,_.lineVertexArray,_.glyphOffsetArray,Oo,D,$,p,Le,ae.predicate,tt.collisionCircleDiameter,zo,E,We),Pn.circles.length&&Pn.collisionDetected&&!p&&a.w("Collisions detected, but collision boxes are not shown"),Fr=Te||Pn.circles.length>0&&!Pn.collisionDetected,Ur=Ur&&Pn.offscreen}if(At.iconFeatureIndex&&(Va=At.iconFeatureIndex),At.iconBox){const vs=Oo=>this.collisionIndex.placeCollisionBox(Oo,Ce,U,Ge,D,Le,Ie,M,ae.predicate,We,Pe&&gr?gr:void 0,ct);Ti&&Ti.placeable&&At.verticalIconBox?(Zi=vs(At.verticalIconBox),sn=Zi.placeable):(Zi=vs(At.iconBox),sn=Zi.placeable),Ur=Ur&&Zi.offscreen}const Tf=me||tt.numHorizontalGlyphVertices===0&&tt.numVerticalGlyphVertices===0,jc=ge||tt.numIconVertices===0;Tf||jc?jc?Tf||(sn=sn&&Fr):Fr=sn&&Fr:sn=Fr=sn&&Fr;const sa=sn&&Zi.placeable;if(Fr&&Cn.placeable&&this.collisionIndex.insertCollisionBox(Cn.box,_e,w.get("text-ignore-placement"),_.bucketInstanceId,Ti&&Ti.placeable&&lo?lo:$a,ae.ID),sa&&this.collisionIndex.insertCollisionBox(Zi.box,Ce,w.get("icon-ignore-placement"),_.bucketInstanceId,Va,ae.ID),Pn&&Fr&&this.collisionIndex.insertCollisionCircles(Pn.circles,_e,w.get("text-ignore-placement"),_.bucketInstanceId,$a,ae.ID),p&&this.storeCollisionData(_.bucketInstanceId,qt,At,Cn,Zi,Pn),tt.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");if(_.bucketInstanceId===0)throw new Error("bucket.bucketInstanceId can't be 0");this.placements[tt.crossTileID]=new Ls((Fr||qe)&&!(Cn!=null&&Cn.occluded),(sn||Ve)&&!(Zi!=null&&Zi.occluded),Ur||_.justReloaded),d[tt.crossTileID]=!0};if(Ne){if(i.symbolInstanceStart!==0)throw new Error("bucket.bucketInstanceId should be 0");const tt=_.getSortedSymbolIndexes(-this.transform.bearingInRadians);for(let At=tt.length-1;At>=0;--At){const qt=tt[At];ut(_.symbolInstances.get(qt),_.collisionArrays[qt],qt)}}else for(let tt=i.symbolInstanceStart;tt<i.symbolInstanceEnd;tt++)ut(_.symbolInstances.get(tt),_.collisionArrays[tt],tt);_.justReloaded=!1}storeCollisionData(i,d,p,_,w,E){if(p.textBox||p.iconBox){let M,D;this.collisionBoxArrays.has(i)?M=this.collisionBoxArrays.get(i):(M=new Map,this.collisionBoxArrays.set(i,M)),M.has(d)?D=M.get(d):(D={text:null,icon:null},M.set(d,D)),p.textBox&&(D.text=_.box),p.iconBox&&(D.icon=w.box)}if(E){let M=this.collisionCircleArrays[i];M===void 0&&(M=this.collisionCircleArrays[i]=[]);for(let D=0;D<E.circles.length;D+=4)M.push(E.circles[D+0]-br),M.push(E.circles[D+1]-br),M.push(E.circles[D+2]),M.push(E.collisionDetected?1:0)}}markUsedJustification(i,d,p,_){let w;w=_===a.ao.vertical?p.verticalPlacedTextSymbolIndex:{left:p.leftJustifiedTextSymbolIndex,center:p.centerJustifiedTextSymbolIndex,right:p.rightJustifiedTextSymbolIndex}[a.aG(d)];const E=[p.leftJustifiedTextSymbolIndex,p.centerJustifiedTextSymbolIndex,p.rightJustifiedTextSymbolIndex,p.verticalPlacedTextSymbolIndex];for(const M of E)M>=0&&(i.text.placedSymbolArray.get(M).crossTileID=w>=0&&M!==w?0:p.crossTileID)}markUsedOrientation(i,d,p){const _=d===a.ao.horizontal||d===a.ao.horizontalOnly?d:0,w=d===a.ao.vertical?d:0,E=[p.leftJustifiedTextSymbolIndex,p.centerJustifiedTextSymbolIndex,p.rightJustifiedTextSymbolIndex];for(const M of E)i.text.placedSymbolArray.get(M).placedOrientation=_;p.verticalPlacedTextSymbolIndex&&(i.text.placedSymbolArray.get(p.verticalPlacedTextSymbolIndex).placedOrientation=w)}commit(i){this.commitTime=i,this.zoomAtLastRecencyCheck=this.transform.zoom;const d=this.prevPlacement;let p=!1;this.prevZoomAdjustment=d?d.zoomAdjustment(this.transform.zoom):0;const _=d?d.symbolFadeChange(i):1,w=d?d.opacities:{},E=d?d.variableOffsets:{},M=d?d.placedOrientations:{};for(const D in this.placements){const $=this.placements[D],U=w[D];U?(this.opacities[D]=new La(U,_,$.text,$.icon),p=p||$.text!==U.text.placed||$.icon!==U.icon.placed):(this.opacities[D]=new La(null,_,$.text,$.icon,$.skipFade),p=p||$.text||$.icon)}for(const D in w){const $=w[D];if(!this.opacities[D]){const U=new La($,_,!1,!1);U.isHidden()||(this.opacities[D]=U,p=p||$.text.placed||$.icon.placed)}}for(const D in E)this.variableOffsets[D]||!this.opacities[D]||this.opacities[D].isHidden()||(this.variableOffsets[D]=E[D]);for(const D in M)this.placedOrientations[D]||!this.opacities[D]||this.opacities[D].isHidden()||(this.placedOrientations[D]=M[D]);if(d&&d.lastPlacementChangeTime===void 0)throw new Error("Last placement time for previous placement is not defined");p?this.lastPlacementChangeTime=i:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=d?d.lastPlacementChangeTime:i)}updateLayerOpacities(i,d){const p={};for(const _ of d){const w=_.getBucket(i);w&&_.latestFeatureIndex&&i.id===w.layerIds[0]&&this.updateBucketOpacities(w,_.tileID,p,_.collisionBoxArray)}}updateBucketOpacities(i,d,p,_){i.hasTextData()&&(i.text.opacityVertexArray.clear(),i.text.hasVisibleVertices=!1),i.hasIconData()&&(i.icon.opacityVertexArray.clear(),i.icon.hasVisibleVertices=!1),i.hasIconCollisionBoxData()&&i.iconCollisionBox.collisionVertexArray.clear(),i.hasTextCollisionBoxData()&&i.textCollisionBox.collisionVertexArray.clear();const w=i.layers[0],E=w.layout,M=new La(null,0,!1,!1,!0),D=E.get("text-allow-overlap"),$=E.get("icon-allow-overlap"),U=w._unevaluatedLayout.hasValue("text-variable-anchor")||w._unevaluatedLayout.hasValue("text-variable-anchor-offset"),K=E.get("text-rotation-alignment")==="map",H=E.get("text-pitch-alignment")==="map",ee=E.get("icon-text-fit")!=="none",ae=new La(null,0,D&&($||!i.hasIconData()||E.get("icon-optional")),$&&(D||!i.hasTextData()||E.get("text-optional")),!0);!i.collisionArrays&&_&&(i.hasIconCollisionBoxData()||i.hasTextCollisionBoxData())&&i.deserializeCollisionBoxes(_);const me=(_e,Te,Ce)=>{for(let Ee=0;Ee<Te/4;Ee++)_e.opacityVertexArray.emplaceBack(Ce);_e.hasVisibleVertices=_e.hasVisibleVertices||Ce!==vl},ge=this.collisionBoxArrays.get(i.bucketInstanceId);for(let _e=0;_e<i.symbolInstances.length;_e++){const Te=i.symbolInstances.get(_e),{numHorizontalGlyphVertices:Ce,numVerticalGlyphVertices:Ee,crossTileID:Ie}=Te;let Le=this.opacities[Ie];p[Ie]?Le=M:Le||(Le=ae,this.opacities[Ie]=Le),p[Ie]=!0;const Pe=Te.numIconVertices>0,Ne=this.placedOrientations[Te.crossTileID],qe=Ne===a.ao.vertical,Ve=Ne===a.ao.horizontal||Ne===a.ao.horizontalOnly;if(Ce>0||Ee>0){const We=Am(Le.text);me(i.text,Ce,qe?vl:We),me(i.text,Ee,Ve?vl:We);const ct=Le.text.isHidden();[Te.rightJustifiedTextSymbolIndex,Te.centerJustifiedTextSymbolIndex,Te.leftJustifiedTextSymbolIndex].forEach(At=>{At>=0&&(i.text.placedSymbolArray.get(At).hidden=ct||qe?1:0)}),Te.verticalPlacedTextSymbolIndex>=0&&(i.text.placedSymbolArray.get(Te.verticalPlacedTextSymbolIndex).hidden=ct||Ve?1:0);const ut=this.variableOffsets[Te.crossTileID];ut&&this.markUsedJustification(i,ut.anchor,Te,Ne);const tt=this.placedOrientations[Te.crossTileID];tt&&(this.markUsedJustification(i,"left",Te,tt),this.markUsedOrientation(i,tt,Te))}if(Pe){const We=Am(Le.icon),ct=!(ee&&Te.verticalPlacedIconSymbolIndex&&qe);Te.placedIconSymbolIndex>=0&&(me(i.icon,Te.numIconVertices,ct?We:vl),i.icon.placedSymbolArray.get(Te.placedIconSymbolIndex).hidden=Le.icon.isHidden()),Te.verticalPlacedIconSymbolIndex>=0&&(me(i.icon,Te.numVerticalIconVertices,ct?vl:We),i.icon.placedSymbolArray.get(Te.verticalPlacedIconSymbolIndex).hidden=Le.icon.isHidden())}const Ge=ge&&ge.has(_e)?ge.get(_e):{text:null,icon:null};if(i.hasIconCollisionBoxData()||i.hasTextCollisionBoxData()){const We=i.collisionArrays[_e];if(We){let ct=new a.P(0,0);if(We.textBox||We.verticalTextBox){let ut=!0;if(U){const tt=this.variableOffsets[Ie];tt?(ct=Ui(tt.anchor,tt.width,tt.height,tt.textOffset,tt.textBoxScale),K&&ct._rotate(H?-this.transform.bearingInRadians:this.transform.bearingInRadians)):ut=!1}if(We.textBox||We.verticalTextBox){let tt;We.textBox&&(tt=qe),We.verticalTextBox&&(tt=Ve),Pm(i.textCollisionBox.collisionVertexArray,Le.text.placed,!ut||tt,Ge.text,ct.x,ct.y)}}if(We.iconBox||We.verticalIconBox){const ut=!!(!Ve&&We.verticalIconBox);let tt;We.iconBox&&(tt=ut),We.verticalIconBox&&(tt=!ut),Pm(i.iconCollisionBox.collisionVertexArray,Le.icon.placed,tt,Ge.icon,ee?ct.x:0,ee?ct.y:0)}}}}if(i.sortFeatures(-this.transform.bearingInRadians),this.retainedQueryData[i.bucketInstanceId]&&(this.retainedQueryData[i.bucketInstanceId].featureSortOrder=i.featureSortOrder),i.hasTextData()&&i.text.opacityVertexBuffer&&i.text.opacityVertexBuffer.updateData(i.text.opacityVertexArray),i.hasIconData()&&i.icon.opacityVertexBuffer&&i.icon.opacityVertexBuffer.updateData(i.icon.opacityVertexArray),i.hasIconCollisionBoxData()&&i.iconCollisionBox.collisionVertexBuffer&&i.iconCollisionBox.collisionVertexBuffer.updateData(i.iconCollisionBox.collisionVertexArray),i.hasTextCollisionBoxData()&&i.textCollisionBox.collisionVertexBuffer&&i.textCollisionBox.collisionVertexBuffer.updateData(i.textCollisionBox.collisionVertexArray),i.text.opacityVertexArray.length!==i.text.layoutVertexArray.length/4)throw new Error(`bucket.text.opacityVertexArray.length (= ${i.text.opacityVertexArray.length}) !== bucket.text.layoutVertexArray.length (= ${i.text.layoutVertexArray.length}) / 4`);if(i.icon.opacityVertexArray.length!==i.icon.layoutVertexArray.length/4)throw new Error(`bucket.icon.opacityVertexArray.length (= ${i.icon.opacityVertexArray.length}) !== bucket.icon.layoutVertexArray.length (= ${i.icon.layoutVertexArray.length}) / 4`);i.bucketInstanceId in this.collisionCircleArrays&&(i.collisionCircleArray=this.collisionCircleArrays[i.bucketInstanceId],delete this.collisionCircleArrays[i.bucketInstanceId])}symbolFadeChange(i){return this.fadeDuration===0?1:(i-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(i){return Math.max(0,(this.transform.zoom-i)/1.5)}hasTransitions(i){return this.stale||i-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(i,d){const p=this.zoomAtLastRecencyCheck===d?1-this.zoomAdjustment(d):1;return this.zoomAtLastRecencyCheck=d,this.commitTime+this.fadeDuration*p>i}setStale(){this.stale=!0}}function Pm(x,i,d,p,_,w){p&&p.length!==0||(p=[0,0,0,0]);const E=p[0]-br,M=p[1]-br,D=p[2]-br,$=p[3]-br;x.emplaceBack(i?1:0,d?1:0,_||0,w||0,E,M),x.emplaceBack(i?1:0,d?1:0,_||0,w||0,D,M),x.emplaceBack(i?1:0,d?1:0,_||0,w||0,D,$),x.emplaceBack(i?1:0,d?1:0,_||0,w||0,E,$)}const i_=Math.pow(2,25),pc=Math.pow(2,24),s_=Math.pow(2,17),z1=Math.pow(2,16),N1=Math.pow(2,9),j1=Math.pow(2,8),o_=Math.pow(2,1);function Am(x){if(x.opacity===0&&!x.placed)return 0;if(x.opacity===1&&x.placed)return 4294967295;const i=x.placed?1:0,d=Math.floor(127*x.opacity);return d*i_+i*pc+d*s_+i*z1+d*N1+i*j1+d*o_+i}const vl=0;class km{constructor(i){this._sortAcrossTiles=i.layout.get("symbol-z-order")!=="viewport-y"&&!i.layout.get("symbol-sort-key").isConstant(),this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]}continuePlacement(i,d,p,_,w){const E=this._bucketParts;for(;this._currentTileIndex<i.length;)if(d.getBucketParts(E,_,i[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,w())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,E.sort((M,D)=>M.sortKey-D.sortKey));this._currentPartIndex<E.length;)if(d.placeLayerBucketPart(E[this._currentPartIndex],this._seenCrossTileIDs,p),this._currentPartIndex++,w())return!0;return!1}}class a_{constructor(i,d,p,_,w,E,M,D){this.placement=new qn(i,d,E,M,D),this._currentPlacementIndex=p.length-1,this._forceFullPlacement=_,this._showCollisionBoxes=w,this._done=!1}isDone(){return this._done}continuePlacement(i,d,p){const _=P.now(),w=()=>!this._forceFullPlacement&&P.now()-_>2;for(;this._currentPlacementIndex>=0;){const E=d[i[this._currentPlacementIndex]],M=this.placement.collisionIndex.transform.zoom;if(E.type==="symbol"&&(!E.minzoom||E.minzoom<=M)&&(!E.maxzoom||E.maxzoom>M)){if(this._inProgressLayer||(this._inProgressLayer=new km(E)),this._inProgressLayer.continuePlacement(p[E.source],this.placement,this._showCollisionBoxes,E,w))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(i){return this.placement.commit(i),this.placement}}const xl=512/a.$/2;class Mm{constructor(i,d,p){this.tileID=i,this.bucketInstanceId=p,this._symbolsByKey={};const _=new Map;for(let w=0;w<d.length;w++){const E=d.get(w),M=E.key,D=_.get(M);D?D.push(E):_.set(M,[E])}for(const[w,E]of _){const M={positions:E.map(D=>({x:Math.floor(D.anchorX*xl),y:Math.floor(D.anchorY*xl)})),crossTileIDs:E.map(D=>D.crossTileID)};if(M.positions.length>128){const D=new a.aI(M.positions.length,16,Uint16Array);for(const{x:$,y:U}of M.positions)D.add($,U);D.finish(),delete M.positions,M.index=D}this._symbolsByKey[w]=M}}getScaledCoordinates(i,d){const{x:p,y:_,z:w}=this.tileID.canonical,{x:E,y:M,z:D}=d.canonical,$=xl/Math.pow(2,D-w),U=(M*a.$+i.anchorY)*$,K=_*a.$*xl;return{x:Math.floor((E*a.$+i.anchorX)*$-p*a.$*xl),y:Math.floor(U-K)}}findMatches(i,d,p){const _=this.tileID.canonical.z<d.canonical.z?1:Math.pow(2,this.tileID.canonical.z-d.canonical.z);for(let w=0;w<i.length;w++){const E=i.get(w);if(E.crossTileID)continue;const M=this._symbolsByKey[E.key];if(!M)continue;const D=this.getScaledCoordinates(E,d);if(M.index){const $=M.index.range(D.x-_,D.y-_,D.x+_,D.y+_).sort();for(const U of $){const K=M.crossTileIDs[U];if(!p[K]){p[K]=!0,E.crossTileID=K;break}}}else if(M.positions)for(let $=0;$<M.positions.length;$++){const U=M.positions[$],K=M.crossTileIDs[$];if(Math.abs(U.x-D.x)<=_&&Math.abs(U.y-D.y)<=_&&!p[K]){p[K]=!0,E.crossTileID=K;break}}}}getCrossTileIDsLists(){return Object.values(this._symbolsByKey).map(({crossTileIDs:i})=>i)}}class F1{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class qu{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(i){const d=Math.round((i-this.lng)/360);if(d!==0)for(const p in this.indexes){const _=this.indexes[p],w={};for(const E in _){const M=_[E];M.tileID=M.tileID.unwrapTo(M.tileID.wrap+d),w[M.tileID.key]=M}this.indexes[p]=w}this.lng=i}addBucket(i,d,p){if(this.indexes[i.overscaledZ]&&this.indexes[i.overscaledZ][i.key]){if(this.indexes[i.overscaledZ][i.key].bucketInstanceId===d.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(i.overscaledZ,this.indexes[i.overscaledZ][i.key])}for(let w=0;w<d.symbolInstances.length;w++)d.symbolInstances.get(w).crossTileID=0;this.usedCrossTileIDs[i.overscaledZ]||(this.usedCrossTileIDs[i.overscaledZ]={});const _=this.usedCrossTileIDs[i.overscaledZ];for(const w in this.indexes){const E=this.indexes[w];if(Number(w)>i.overscaledZ)for(const M in E){const D=E[M];D.tileID.isChildOf(i)&&D.findMatches(d.symbolInstances,i,_)}else{const M=E[i.scaledTo(Number(w)).key];M&&M.findMatches(d.symbolInstances,i,_)}}for(let w=0;w<d.symbolInstances.length;w++){const E=d.symbolInstances.get(w);E.crossTileID||(E.crossTileID=p.generate(),_[E.crossTileID]=!0)}return this.indexes[i.overscaledZ]===void 0&&(this.indexes[i.overscaledZ]={}),this.indexes[i.overscaledZ][i.key]=new Mm(i,d.symbolInstances,d.bucketInstanceId),!0}removeBucketCrossTileIDs(i,d){for(const p of d.getCrossTileIDsLists())for(const _ of p)delete this.usedCrossTileIDs[i][_]}removeStaleBuckets(i){let d=!1;for(const p in this.indexes){const _=this.indexes[p];for(const w in _)i[_[w].bucketInstanceId]||(this.removeBucketCrossTileIDs(p,_[w]),delete _[w],d=!0)}return d}}class Hu{constructor(){this.layerIndexes={},this.crossTileIDs=new F1,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(i,d,p){let _=this.layerIndexes[i.id];_===void 0&&(_=this.layerIndexes[i.id]=new qu);let w=!1;const E={};_.handleWrapJump(p);for(const M of d){const D=M.getBucket(i);D&&i.id===D.layerIds[0]&&(D.bucketInstanceId||(D.bucketInstanceId=++this.maxBucketInstanceId),_.addBucket(M.tileID,D,this.crossTileIDs)&&(w=!0),E[D.bucketInstanceId]=!0)}return _.removeStaleBuckets(E)&&(w=!0),w}pruneUnusedLayers(i){const d={};i.forEach(p=>{d[p]=!0});for(const p in this.layerIndexes)d[p]||delete this.layerIndexes[p]}}var Im="void main() {fragColor=vec4(1.0);}";const Gi={prelude:mr(`#ifdef GL_ES
precision mediump float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
out highp vec4 fragColor;`,`#ifdef GL_ES
precision highp float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}mat3 rotationMatrixFromAxisAngle(vec3 u,float angle) {float c=cos(angle);float s=sin(angle);float c2=1.0-c;return mat3(u.x*u.x*c2+      c,u.x*u.y*c2-u.z*s,u.x*u.z*c2+u.y*s,u.y*u.x*c2+u.z*s,u.y*u.y*c2+    c,u.y*u.z*c2-u.x*s,u.z*u.x*c2-u.y*s,u.z*u.y*c2+u.x*s,u.z*u.z*c2+    c
);}
#ifdef TERRAIN3D
uniform sampler2D u_terrain;uniform float u_terrain_dim;uniform mat4 u_terrain_matrix;uniform vec4 u_terrain_unpack;uniform float u_terrain_exaggeration;uniform highp sampler2D u_depth;
#endif
const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitShifts=vec4(1.)/bitSh;highp float unpack(highp vec4 color) {return dot(color,bitShifts);}highp float depthOpacity(vec3 frag) {
#ifdef TERRAIN3D
highp float d=unpack(texture(u_depth,frag.xy*0.5+0.5))+0.0001-frag.z;return 1.0-max(0.0,min(1.0,-d*500.0));
#else
return 1.0;
#endif
}float calculate_visibility(vec4 pos) {
#ifdef TERRAIN3D
vec3 frag=pos.xyz/pos.w;highp float d=depthOpacity(frag);if (d > 0.95) return 1.0;return (d+depthOpacity(frag+vec3(0.0,0.01,0.0)))/2.0;
#else
return 1.0;
#endif
}float ele(vec2 pos) {
#ifdef TERRAIN3D
vec4 rgb=(texture(u_terrain,pos)*255.0)*u_terrain_unpack;return rgb.r+rgb.g+rgb.b-u_terrain_unpack.a;
#else
return 0.0;
#endif
}float get_elevation(vec2 pos) {
#ifdef TERRAIN3D
#ifdef GLOBE
if ((pos.y <-32767.5) || (pos.y > 32766.5)) {return 0.0;}
#endif
vec2 coord=(u_terrain_matrix*vec4(pos,0.0,1.0)).xy*u_terrain_dim+1.0;vec2 f=fract(coord);vec2 c=(floor(coord)+0.5)/(u_terrain_dim+2.0);float d=1.0/(u_terrain_dim+2.0);float tl=ele(c);float tr=ele(c+vec2(d,0.0));float bl=ele(c+vec2(0.0,d));float br=ele(c+vec2(d,d));float elevation=mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);return elevation*u_terrain_exaggeration;
#else
return 0.0;
#endif
}const float PI=3.141592653589793;uniform mat4 u_projection_matrix;`),projectionMercator:mr("","float projectLineThickness(float tileY) {return 1.0;}float projectCircleRadius(float tileY) {return 1.0;}vec4 projectTile(vec2 p) {vec4 result=u_projection_matrix*vec4(p,0.0,1.0);return result;}vec4 projectTile(vec2 p,vec2 rawPos) {vec4 result=u_projection_matrix*vec4(p,0.0,1.0);if (rawPos.y <-32767.5 || rawPos.y > 32766.5) {result.z=-10000000.0;}return result;}vec4 projectTileWithElevation(vec2 posInTile,float elevation) {return u_projection_matrix*vec4(posInTile,elevation,1.0);}vec4 projectTileFor3D(vec2 posInTile,float elevation) {return projectTileWithElevation(posInTile,elevation);}"),projectionGlobe:mr("",`#define GLOBE_RADIUS 6371008.8
uniform highp vec4 u_projection_tile_mercator_coords;uniform highp vec4 u_projection_clipping_plane;uniform highp float u_projection_transition;uniform mat4 u_projection_fallback_matrix;vec3 globeRotateVector(vec3 vec,vec2 angles) {vec3 axisRight=vec3(vec.z,0.0,-vec.x);vec3 axisUp=cross(axisRight,vec);axisRight=normalize(axisRight);axisUp=normalize(axisUp);vec2 t=tan(angles);return normalize(vec+axisRight*t.x+axisUp*t.y);}mat3 globeGetRotationMatrix(vec3 spherePos) {vec3 axisRight=vec3(spherePos.z,0.0,-spherePos.x);vec3 axisDown=cross(axisRight,spherePos);axisRight=normalize(axisRight);axisDown=normalize(axisDown);return mat3(axisRight,axisDown,spherePos
);}float circumferenceRatioAtTileY(float tileY) {float mercator_pos_y=u_projection_tile_mercator_coords.y+u_projection_tile_mercator_coords.w*tileY;float spherical_y=2.0*atan(exp(PI-(mercator_pos_y*PI*2.0)))-PI*0.5;return cos(spherical_y);}float projectLineThickness(float tileY) {float thickness=1.0/circumferenceRatioAtTileY(tileY); 
if (u_projection_transition < 0.999) {return mix(1.0,thickness,u_projection_transition);} else {return thickness;}}vec3 projectToSphere(vec2 translatedPos,vec2 rawPos) {vec2 mercator_pos=u_projection_tile_mercator_coords.xy+u_projection_tile_mercator_coords.zw*translatedPos;vec2 spherical;spherical.x=mercator_pos.x*PI*2.0+PI;spherical.y=2.0*atan(exp(PI-(mercator_pos.y*PI*2.0)))-PI*0.5;float len=cos(spherical.y);vec3 pos=vec3(sin(spherical.x)*len,sin(spherical.y),cos(spherical.x)*len
);if (rawPos.y <-32767.5) {pos=vec3(0.0,1.0,0.0);}if (rawPos.y > 32766.5) {pos=vec3(0.0,-1.0,0.0);}return pos;}vec3 projectToSphere(vec2 posInTile) {return projectToSphere(posInTile,vec2(0.0,0.0));}float globeComputeClippingZ(vec3 spherePos) {return (1.0-(dot(spherePos,u_projection_clipping_plane.xyz)+u_projection_clipping_plane.w));}vec4 interpolateProjection(vec2 posInTile,vec3 spherePos,float elevation) {vec3 elevatedPos=spherePos*(1.0+elevation/GLOBE_RADIUS);vec4 globePosition=u_projection_matrix*vec4(elevatedPos,1.0);globePosition.z=globeComputeClippingZ(elevatedPos)*globePosition.w;if (u_projection_transition > 0.999) {return globePosition;}vec4 flatPosition=u_projection_fallback_matrix*vec4(posInTile,elevation,1.0);const float z_globeness_threshold=0.2;vec4 result=globePosition;result.z=mix(0.0,globePosition.z,clamp((u_projection_transition-z_globeness_threshold)/(1.0-z_globeness_threshold),0.0,1.0));result.xyw=mix(flatPosition.xyw,globePosition.xyw,u_projection_transition);if ((posInTile.y <-32767.5) || (posInTile.y > 32766.5)) {result=globePosition;const float poles_hidden_anim_percentage=0.02;result.z=mix(globePosition.z,100.0,pow(max((1.0-u_projection_transition)/poles_hidden_anim_percentage,0.0),8.0));}return result;}vec4 interpolateProjectionFor3D(vec2 posInTile,vec3 spherePos,float elevation) {vec3 elevatedPos=spherePos*(1.0+elevation/GLOBE_RADIUS);vec4 globePosition=u_projection_matrix*vec4(elevatedPos,1.0);if (u_projection_transition > 0.999) {return globePosition;}vec4 fallbackPosition=u_projection_fallback_matrix*vec4(posInTile,elevation,1.0);return mix(fallbackPosition,globePosition,u_projection_transition);}vec4 projectTile(vec2 posInTile) {return interpolateProjection(posInTile,projectToSphere(posInTile),0.0);}vec4 projectTile(vec2 posInTile,vec2 rawPos) {return interpolateProjection(posInTile,projectToSphere(posInTile,rawPos),0.0);}vec4 projectTileWithElevation(vec2 posInTile,float elevation) {return interpolateProjection(posInTile,projectToSphere(posInTile),elevation);}vec4 projectTileFor3D(vec2 posInTile,float elevation) {vec3 spherePos=projectToSphere(posInTile,posInTile);return interpolateProjectionFor3D(posInTile,spherePos,elevation);}`),background:mr(`uniform vec4 u_color;uniform float u_opacity;void main() {fragColor=u_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"in vec2 a_pos;void main() {gl_Position=projectTile(a_pos);}"),backgroundPattern:mr(`uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;in vec2 v_pos_a;in vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);fragColor=mix(color1,color2,u_mix)*u_opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;in vec2 a_pos;out vec2 v_pos_a;out vec2 v_pos_b;void main() {gl_Position=projectTile(a_pos);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);}"),circle:mr(`in vec3 v_data;in float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float extrude_length=length(extrude);float antialiased_blur=v_data.z;float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width));fragColor=v_visibility*opacity_t*mix(color*opacity,stroke_color*stroke_opacity,color_t);const float epsilon=0.5/255.0;if (fragColor.r < epsilon && fragColor.g < epsilon && fragColor.b < epsilon && fragColor.a < epsilon) {discard;}
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform bool u_scale_with_map;uniform bool u_pitch_with_map;uniform vec2 u_extrude_scale;uniform highp float u_globe_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;uniform vec2 u_translate;in vec2 a_pos;out vec3 v_data;out float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 pos_raw=a_pos+32768.0;vec2 extrude=vec2(mod(pos_raw,8.0)/7.0*2.0-1.0);vec2 circle_center=floor(pos_raw/8.0)+u_translate;float ele=get_elevation(circle_center);v_visibility=calculate_visibility(projectTileWithElevation(circle_center,ele));if (u_pitch_with_map) {
#ifdef GLOBE
vec3 center_vector=projectToSphere(circle_center);
#endif
float angle_scale=u_globe_extrude_scale;vec2 corner_position=circle_center;if (u_scale_with_map) {angle_scale*=(radius+stroke_width);corner_position+=extrude*u_extrude_scale*(radius+stroke_width);} else {
#ifdef GLOBE
vec4 projected_center=interpolateProjection(circle_center,center_vector,ele);
#else
vec4 projected_center=projectTileWithElevation(circle_center,ele);
#endif
corner_position+=extrude*u_extrude_scale*(radius+stroke_width)*(projected_center.w/u_camera_to_center_distance);angle_scale*=(radius+stroke_width)*(projected_center.w/u_camera_to_center_distance);}
#ifdef GLOBE
vec2 angles=extrude*angle_scale;vec3 corner_vector=globeRotateVector(center_vector,angles);gl_Position=interpolateProjection(corner_position,corner_vector,ele);
#else
gl_Position=projectTileWithElevation(corner_position,ele);
#endif
} else {gl_Position=projectTileWithElevation(circle_center,ele);if (gl_Position.z/gl_Position.w > 1.0) {gl_Position.xy=vec2(10000.0);}if (u_scale_with_map) {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*u_camera_to_center_distance;} else {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*gl_Position.w;}}float antialiasblur=-max(1.0/u_device_pixel_ratio/(radius+stroke_width),blur);v_data=vec3(extrude.x,extrude.y,antialiasblur);}`),clippingMask:mr(Im,"in vec2 a_pos;void main() {gl_Position=projectTile(a_pos);}"),heatmap:mr(`uniform highp float u_intensity;in vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);fragColor=vec4(val,1.0,1.0,1.0);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;uniform highp float u_globe_extrude_scale;in vec2 a_pos;out vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 pos_raw=a_pos+32768.0;vec2 unscaled_extrude=vec2(mod(pos_raw,8.0)/7.0*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec2 circle_center=floor(pos_raw/8.0);
#ifdef GLOBE
vec2 angles=v_extrude*radius*u_globe_extrude_scale;vec3 center_vector=projectToSphere(circle_center);vec3 corner_vector=globeRotateVector(center_vector,angles);gl_Position=interpolateProjection(circle_center+extrude,corner_vector,0.0);
#else
gl_Position=projectTileFor3D(circle_center+extrude,get_elevation(circle_center));
#endif
}`),heatmapTexture:mr(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;in vec2 v_pos;void main() {float t=texture(u_image,v_pos).r;vec4 color=texture(u_color_ramp,vec2(t,0.5));fragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(0.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_world;in vec2 a_pos;out vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos*u_world,0,1);v_pos.x=a_pos.x;v_pos.y=1.0-a_pos.y;}"),collisionBox:mr("in float v_placed;in float v_notUsed;void main() {float alpha=0.5;fragColor=vec4(1.0,0.0,0.0,1.0)*alpha;if (v_placed > 0.5) {fragColor=vec4(0.0,0.0,1.0,0.5)*alpha;}if (v_notUsed > 0.5) {fragColor*=.1;}}","in vec2 a_anchor_pos;in vec2 a_placed;in vec2 a_box_real;uniform vec2 u_pixel_extrude_scale;out float v_placed;out float v_notUsed;void main() {gl_Position=projectTileWithElevation(a_anchor_pos,get_elevation(a_anchor_pos));gl_Position.xy=((a_box_real+0.5)*u_pixel_extrude_scale*2.0-1.0)*vec2(1.0,-1.0)*gl_Position.w;if (gl_Position.z/gl_Position.w < 1.1) {gl_Position.z=0.5;}v_placed=a_placed.x;v_notUsed=a_placed.y;}"),collisionCircle:mr("in float v_radius;in vec2 v_extrude;in float v_collision;void main() {float alpha=0.5;float stroke_radius=0.9;float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);fragColor=color*alpha*opacity_t;}","in vec2 a_pos;in float a_radius;in vec2 a_flags;uniform vec2 u_viewport_size;out float v_radius;out vec2 v_extrude;out float v_collision;void main() {float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_collision=collision;gl_Position=vec4((a_pos/u_viewport_size*2.0-1.0)*vec2(1.0,-1.0),0.0,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),colorRelief:mr(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;uniform vec4 u_unpack;uniform sampler2D u_elevation_stops;uniform sampler2D u_color_stops;uniform int u_color_ramp_size;uniform float u_opacity;in vec2 v_pos;float getElevation(vec2 coord) {vec4 data=texture(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack);}float getElevationStop(int stop) {float x=(float(stop)+0.5)/float(u_color_ramp_size);vec4 data=texture(u_elevation_stops,vec2(x,0))*255.0;data.a=-1.0;return dot(data,u_unpack);}void main() {float el=getElevation(v_pos);int r=(u_color_ramp_size-1);int l=0;float el_l=getElevationStop(l);float el_r=getElevationStop(r);while(r-l > 1){int m=(r+l)/2;float el_m=getElevationStop(m);if(el < el_m){r=m;el_r=el_m;}else
{l=m;el_l=el_m;}}float x=(float(l)+(el-el_l)/(el_r-el_l)+0.5)/float(u_color_ramp_size);fragColor=u_opacity*texture(u_color_stops,vec2(x,0));
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"uniform vec2 u_dimension;in vec2 a_pos;out vec2 v_pos;void main() {gl_Position=projectTile(a_pos,a_pos);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_pos/8192.0)*scale+epsilon;if (a_pos.y <-32767.5) {v_pos.y=0.0;}if (a_pos.y > 32766.5) {v_pos.y=1.0;}}"),debug:mr("uniform highp vec4 u_color;uniform sampler2D u_overlay;in vec2 v_uv;void main() {vec4 overlay_color=texture(u_overlay,v_uv);fragColor=mix(u_color,overlay_color,overlay_color.a);}","in vec2 a_pos;out vec2 v_uv;uniform float u_overlay_scale;void main() {v_uv=a_pos/8192.0;gl_Position=projectTileWithElevation(a_pos*u_overlay_scale,get_elevation(a_pos));}"),depth:mr(Im,`in vec2 a_pos;void main() {
#ifdef GLOBE
gl_Position=projectTileFor3D(a_pos,0.0);
#else
gl_Position=u_projection_matrix*vec4(a_pos,0.0,1.0);
#endif
}`),fill:mr(`#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
fragColor=color*opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_fill_translate;in vec2 a_pos;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_Position=projectTile(a_pos+u_fill_translate,a_pos);}`),fillOutline:mr(`in vec2 v_pos;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);fragColor=outline_color*(alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_world;uniform vec2 u_fill_translate;in vec2 a_pos;out vec2 v_pos;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
gl_Position=projectTile(a_pos+u_fill_translate,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
}`),fillOutlinePattern:mr(`uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;in vec2 v_pos_a;in vec2 v_pos_b;in vec2 v_pos;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);fragColor=mix(color1,color2,u_fade)*alpha*opacity;
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;uniform vec2 u_fill_translate;in vec2 a_pos;out vec2 v_pos_a;out vec2 v_pos_b;out vec2 v_pos;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=projectTile(a_pos+u_fill_translate,a_pos);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
}`),fillPattern:mr(`#ifdef GL_ES
precision highp float;
#endif
uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;in vec2 v_pos_a;in vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);fragColor=mix(color1,color2,u_fade)*opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;uniform vec2 u_fill_translate;in vec2 a_pos;out vec2 v_pos_a;out vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=projectTile(a_pos+u_fill_translate,a_pos);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);}`),fillExtrusion:mr(`in vec4 v_color;void main() {fragColor=v_color;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp vec3 u_lightpos_globe;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec2 u_fill_translate;in vec2 a_pos;in vec4 a_normal_ed;
#ifdef TERRAIN3D
in vec2 a_centroid;
#endif
out vec4 v_color;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
vec3 normal=a_normal_ed.xyz;
#ifdef TERRAIN3D
float height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);
#else
float height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;
#endif
base=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);float elevation=t > 0.0 ? height : base;vec2 posInTile=a_pos+u_fill_translate;
#ifdef GLOBE
vec3 spherePos=projectToSphere(posInTile,a_pos);gl_Position=interpolateProjectionFor3D(posInTile,spherePos,elevation);
#else
gl_Position=u_projection_matrix*vec4(posInTile,elevation,1.0);
#endif
float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;vec3 normalForLighting=normal/16384.0;float directional=clamp(dot(normalForLighting,u_lightpos),0.0,1.0);
#ifdef GLOBE
mat3 rotMatrix=globeGetRotationMatrix(spherePos);normalForLighting=rotMatrix*normalForLighting;directional=mix(directional,clamp(dot(normalForLighting,u_lightpos_globe),0.0,1.0),u_projection_transition);
#endif
directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.r+=clamp(color.r*directional*u_lightcolor.r,mix(0.0,0.3,1.0-u_lightcolor.r),1.0);v_color.g+=clamp(color.g*directional*u_lightcolor.g,mix(0.0,0.3,1.0-u_lightcolor.g),1.0);v_color.b+=clamp(color.b*directional*u_lightcolor.b,mix(0.0,0.3,1.0-u_lightcolor.b),1.0);v_color*=u_opacity;}`),fillExtrusionPattern:mr(`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;in vec2 v_pos_a;in vec2 v_pos_b;in vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);vec4 mixedColor=mix(color1,color2,u_fade);fragColor=mixedColor*v_lighting;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec2 u_fill_translate;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp vec3 u_lightpos_globe;uniform lowp float u_lightintensity;in vec2 a_pos;in vec4 a_normal_ed;
#ifdef TERRAIN3D
in vec2 a_centroid;
#endif
#ifdef GLOBE
out vec3 v_sphere_pos;
#endif
out vec2 v_pos_a;out vec2 v_pos_b;out vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 normal=a_normal_ed.xyz;float edgedistance=a_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;
#ifdef TERRAIN3D
float height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);
#else
float height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;
#endif
base=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);float elevation=t > 0.0 ? height : base;vec2 posInTile=a_pos+u_fill_translate;
#ifdef GLOBE
vec3 spherePos=projectToSphere(posInTile,a_pos);vec3 elevatedPos=spherePos*(1.0+elevation/GLOBE_RADIUS);v_sphere_pos=elevatedPos;gl_Position=interpolateProjectionFor3D(posInTile,spherePos,elevation);
#else
gl_Position=u_projection_matrix*vec4(posInTile,elevation,1.0);
#endif
vec2 pos=normal.x==1.0 && normal.y==0.0 && normal.z==16384.0
? a_pos
: vec2(edgedistance,elevation*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal/16383.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;}`),hillshadePrepare:mr(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;in vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord,float bias) {vec4 data=texture(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack);}void main() {vec2 epsilon=1.0/u_dimension;float tileSize=u_dimension.x-2.0;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y),0.0);float b=getElevation(v_pos+vec2(0,-epsilon.y),0.0);float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y),0.0);float d=getElevation(v_pos+vec2(-epsilon.x,0),0.0);float e=getElevation(v_pos,0.0);float f=getElevation(v_pos+vec2(epsilon.x,0),0.0);float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y),0.0);float h=getElevation(v_pos+vec2(0,epsilon.y),0.0);float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y),0.0);float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2((c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c))*tileSize/pow(2.0,exaggeration+(28.2562-u_zoom));fragColor=clamp(vec4(deriv.x/8.0+0.5,deriv.y/8.0+0.5,1.0,1.0),0.0,1.0);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;in vec2 a_pos;in vec2 a_texture_pos;out vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:mr(`uniform sampler2D u_image;in vec2 v_pos;uniform vec2 u_latrange;uniform float u_exaggeration;uniform vec4 u_accent;uniform int u_method;uniform float u_altitudes[NUM_ILLUMINATION_SOURCES];uniform float u_azimuths[NUM_ILLUMINATION_SOURCES];uniform vec4 u_shadows[NUM_ILLUMINATION_SOURCES];uniform vec4 u_highlights[NUM_ILLUMINATION_SOURCES];
#define PI 3.141592653589793
#define STANDARD 0
#define COMBINED 1
#define IGOR 2
#define MULTIDIRECTIONAL 3
#define BASIC 4
float get_aspect(vec2 deriv){return deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);}void igor_hillshade(vec2 deriv){deriv=deriv*u_exaggeration*2.0;float aspect=get_aspect(deriv);float azimuth=u_azimuths[0]+PI;float slope_stength=atan(length(deriv))*2.0/PI;float aspect_strength=1.0-abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);float shadow_strength=slope_stength*aspect_strength;float highlight_strength=slope_stength*(1.0-aspect_strength);fragColor=u_shadows[0]*shadow_strength+u_highlights[0]*highlight_strength;}void standard_hillshade(vec2 deriv){float azimuth=u_azimuths[0]+PI;float slope=atan(0.625*length(deriv));float aspect=get_aspect(deriv);float intensity=u_exaggeration;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadows[0],u_highlights[0],shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);fragColor=accent_color*(1.0-shade_color.a)+shade_color;}void basic_hillshade(vec2 deriv){deriv=deriv*u_exaggeration*2.0;float azimuth=u_azimuths[0]+PI;float cos_az=cos(azimuth);float sin_az=sin(azimuth);float cos_alt=cos(u_altitudes[0]);float sin_alt=sin(u_altitudes[0]);float cang=(sin_alt-(deriv.y*cos_az*cos_alt-deriv.x*sin_az*cos_alt))/sqrt(1.0+dot(deriv,deriv));float shade=clamp(cang,0.0,1.0);if(shade > 0.5){fragColor=u_highlights[0]*(2.0*shade-1.0);}else
{fragColor=u_shadows[0]*(1.0-2.0*shade);}}void multidirectional_hillshade(vec2 deriv){deriv=deriv*u_exaggeration*2.0;fragColor=vec4(0,0,0,0);for(int i=0; i < NUM_ILLUMINATION_SOURCES; i++){float cos_alt=cos(u_altitudes[i]);float sin_alt=sin(u_altitudes[i]);float cos_az=-cos(u_azimuths[i]);float sin_az=-sin(u_azimuths[i]);float cang=(sin_alt-(deriv.y*cos_az*cos_alt-deriv.x*sin_az*cos_alt))/sqrt(1.0+dot(deriv,deriv));float shade=clamp(cang,0.0,1.0);if(shade > 0.5){fragColor+=u_highlights[i]*(2.0*shade-1.0)/float(NUM_ILLUMINATION_SOURCES);}else
{fragColor+=u_shadows[i]*(1.0-2.0*shade)/float(NUM_ILLUMINATION_SOURCES);}}}void combined_hillshade(vec2 deriv){deriv=deriv*u_exaggeration*2.0;float azimuth=u_azimuths[0]+PI;float cos_az=cos(azimuth);float sin_az=sin(azimuth);float cos_alt=cos(u_altitudes[0]);float sin_alt=sin(u_altitudes[0]);float cang=acos((sin_alt-(deriv.y*cos_az*cos_alt-deriv.x*sin_az*cos_alt))/sqrt(1.0+dot(deriv,deriv)));cang=clamp(cang,0.0,PI/2.0);float shade=cang*atan(length(deriv))*4.0/PI/PI;float highlight=(PI/2.0-cang)*atan(length(deriv))*4.0/PI/PI;fragColor=u_shadows[0]*shade+u_highlights[0]*highlight;}void main() {vec4 pixel=texture(u_image,v_pos);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));vec2 deriv=((pixel.rg*8.0)-4.0)/scaleFactor;if (u_method==BASIC) {basic_hillshade(deriv);} else if (u_method==COMBINED) {combined_hillshade(deriv);} else if (u_method==IGOR) {igor_hillshade(deriv);} else if (u_method==MULTIDIRECTIONAL) {multidirectional_hillshade(deriv);} else if (u_method==STANDARD) {standard_hillshade(deriv);} else {standard_hillshade(deriv);}
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;in vec2 a_pos;out vec2 v_pos;void main() {gl_Position=projectTile(a_pos,a_pos);v_pos=a_pos/8192.0;if (a_pos.y <-32767.5) {v_pos.y=0.0;}if (a_pos.y > 32766.5) {v_pos.y=1.0;}}"),line:mr(`uniform lowp float u_device_pixel_ratio;in vec2 v_width2;in vec2 v_normal;in float v_gamma_scale;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);fragColor=color*(alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
in vec2 a_pos_normal;in vec4 a_data;uniform vec2 u_translation;uniform mediump float u_ratio;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;out vec2 v_normal;out vec2 v_width2;out float v_gamma_scale;out highp float v_linesofar;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),lineGradient:mr(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;in vec2 v_width2;in vec2 v_normal;in float v_gamma_scale;in highp vec2 v_uv;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture(u_image,v_uv);fragColor=color*(alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
in vec2 a_pos_normal;in vec4 a_data;in float a_uv_x;in float a_split_index;uniform vec2 u_translation;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_image_height;out vec2 v_normal;out vec2 v_width2;out float v_gamma_scale;out highp vec2 v_uv;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec2(a_uv_x,a_split_index*texel_height-half_texel_height);vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),linePattern:mr(`#ifdef GL_ES
precision highp float;
#endif
uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;in vec2 v_normal;in vec2 v_width2;in float v_linesofar;in float v_gamma_scale;in float v_width;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture(u_image,pos_a),texture(u_image,pos_b),u_fade);fragColor=color*alpha*opacity;
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
in vec2 a_pos_normal;in vec4 a_data;uniform vec2 u_translation;uniform vec2 u_units_to_pixels;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;out vec2 v_normal;out vec2 v_width2;out float v_linesofar;out float v_gamma_scale;out float v_width;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;}`),lineSDF:mr(`uniform lowp float u_device_pixel_ratio;uniform lowp float u_lineatlas_width;uniform sampler2D u_image;uniform float u_mix;in vec2 v_normal;in vec2 v_width2;in vec2 v_tex_a;in vec2 v_tex_b;in float v_gamma_scale;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define mediump vec4 dasharray_from
#pragma mapbox: define mediump vec4 dasharray_to
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 dasharray_from
#pragma mapbox: initialize mediump vec4 dasharray_to
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float sdfdist_a=texture(u_image,v_tex_a).a;float sdfdist_b=texture(u_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);float sdfgamma=(u_lineatlas_width/256.0)/min(dasharray_from.w,dasharray_to.w);alpha*=smoothstep(0.5-sdfgamma/floorwidth,0.5+sdfgamma/floorwidth,sdfdist);fragColor=color*(alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
in vec2 a_pos_normal;in vec4 a_data;uniform vec2 u_translation;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_tileratio;uniform float u_crossfade_from;uniform float u_crossfade_to;uniform float u_lineatlas_height;out vec2 v_normal;out vec2 v_width2;out vec2 v_tex_a;out vec2 v_tex_b;out float v_gamma_scale;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define mediump vec4 dasharray_from
#pragma mapbox: define mediump vec4 dasharray_to
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 dasharray_from
#pragma mapbox: initialize mediump vec4 dasharray_to
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
float u_patternscale_a_x=u_tileratio/dasharray_from.w/u_crossfade_from;float u_patternscale_a_y=-dasharray_from.z/2.0/u_lineatlas_height;float u_patternscale_b_x=u_tileratio/dasharray_to.w/u_crossfade_to;float u_patternscale_b_y=-dasharray_to.z/2.0/u_lineatlas_height;v_tex_a=vec2(a_linesofar*u_patternscale_a_x/floorwidth,normal.y*u_patternscale_a_y+(float(dasharray_from.y)+0.5)/u_lineatlas_height);v_tex_b=vec2(a_linesofar*u_patternscale_b_x/floorwidth,normal.y*u_patternscale_b_y+(float(dasharray_to.y)+0.5)/u_lineatlas_height);v_width2=vec2(outset,inset);}`),lineGradientSDF:mr(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;uniform sampler2D u_image_dash;uniform float u_mix;uniform lowp float u_lineatlas_width;in vec2 v_normal;in vec2 v_width2;in vec2 v_tex_a;in vec2 v_tex_b;in float v_gamma_scale;in highp vec2 v_uv;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define mediump vec4 dasharray_from
#pragma mapbox: define mediump vec4 dasharray_to
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 dasharray_from
#pragma mapbox: initialize mediump vec4 dasharray_to
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture(u_image,v_uv);float sdfdist_a=texture(u_image_dash,v_tex_a).a;float sdfdist_b=texture(u_image_dash,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);float sdfgamma=(u_lineatlas_width/256.0)/min(dasharray_from.w,dasharray_to.w);float dash_alpha=smoothstep(0.5-sdfgamma/floorwidth,0.5+sdfgamma/floorwidth,sdfdist);fragColor=color*(alpha*dash_alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
in vec2 a_pos_normal;in vec4 a_data;in float a_uv_x;in float a_split_index;uniform vec2 u_translation;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_image_height;uniform float u_tileratio;uniform float u_crossfade_from;uniform float u_crossfade_to;uniform float u_lineatlas_height;out vec2 v_normal;out vec2 v_width2;out float v_gamma_scale;out highp vec2 v_uv;out vec2 v_tex_a;out vec2 v_tex_b;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define mediump vec4 dasharray_from
#pragma mapbox: define mediump vec4 dasharray_to
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 dasharray_from
#pragma mapbox: initialize mediump vec4 dasharray_to
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;float texel_height=1.0/u_image_height;float half_texel_height=0.5*texel_height;v_uv=vec2(a_uv_x,a_split_index*texel_height-half_texel_height);vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
float u_patternscale_a_x=u_tileratio/dasharray_from.w/u_crossfade_from;float u_patternscale_a_y=-dasharray_from.z/2.0/u_lineatlas_height;float u_patternscale_b_x=u_tileratio/dasharray_to.w/u_crossfade_to;float u_patternscale_b_y=-dasharray_to.z/2.0/u_lineatlas_height;v_tex_a=vec2(a_linesofar*u_patternscale_a_x/floorwidth,normal.y*u_patternscale_a_y+(float(dasharray_from.y)+0.5)/u_lineatlas_height);v_tex_b=vec2(a_linesofar*u_patternscale_b_x/floorwidth,normal.y*u_patternscale_b_y+(float(dasharray_to.y)+0.5)/u_lineatlas_height);v_width2=vec2(outset,inset);}`),raster:mr(`uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;in vec2 v_pos0;in vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture(u_image0,v_pos0);vec4 color1=texture(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);fragColor=vec4(mix(u_high_vec,u_low_vec,rgb)*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_buffer_scale;uniform vec4 u_coords_top;uniform vec4 u_coords_bottom;in vec2 a_pos;out vec2 v_pos0;out vec2 v_pos1;void main() {vec2 fractionalPos=a_pos/8192.0;vec2 position=mix(mix(u_coords_top.xy,u_coords_top.zw,fractionalPos.x),mix(u_coords_bottom.xy,u_coords_bottom.zw,fractionalPos.x),fractionalPos.y);gl_Position=projectTile(position,position);v_pos0=((fractionalPos-0.5)/u_buffer_scale)+0.5;
#ifdef GLOBE
if (a_pos.y <-32767.5) {v_pos0.y=0.0;}if (a_pos.y > 32766.5) {v_pos0.y=1.0;}
#endif
v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}`),symbolIcon:mr(`uniform sampler2D u_texture;in vec2 v_tex;in float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
lowp float alpha=opacity*v_fade_opacity;fragColor=texture(u_texture,v_tex)*alpha;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`in vec4 a_pos_offset;in vec4 a_data;in vec4 a_pixeloffset;in vec3 a_projected_pos;in float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform vec2 u_translation;uniform float u_pitched_scale;out vec2 v_tex;out float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_minFontScale=a_pixeloffset.zw/256.0;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;
#ifdef GLOBE
if(u_pitch_with_map) {float anchor_pos_tile_y=(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w,z,1.0)).y;projectionScaling=mix(projectionScaling,1.0/circumferenceRatioAtTileY(anchor_pos_tile_y)*u_pitched_scale,u_projection_transition);}
#endif
vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*max(a_minFontScale,fontScale)+a_pxoffset/16.0)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}gl_Position=finalPos;v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float visibility=calculate_visibility(projectedPoint);v_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));}`),symbolSDF:mr(`#define SDF_PX 8.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;in vec2 v_data0;in vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float inner_edge=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);inner_edge=inner_edge+gamma*gamma_scale;}lowp float dist=texture(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(inner_edge-gamma_scaled,inner_edge+gamma_scaled,dist);if (u_is_halo) {lowp float halo_edge=(6.0-halo_width/fontScale)/SDF_PX;alpha=min(smoothstep(halo_edge-gamma_scaled,halo_edge+gamma_scaled,dist),1.0-alpha);}fragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`in vec4 a_pos_offset;in vec4 a_data;in vec4 a_pixeloffset;in vec3 a_projected_pos;in float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_translation;uniform float u_pitched_scale;out vec2 v_data0;out vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;
#ifdef GLOBE
if(u_pitch_with_map) {float anchor_pos_tile_y=(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w,z,1.0)).y;projectionScaling=mix(projectionScaling,1.0/circumferenceRatioAtTileY(anchor_pos_tile_y)*u_pitched_scale,u_projection_transition);}
#endif
vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}float gamma_scale=finalPos.w;gl_Position=finalPos;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity);}`),symbolTextAndIcon:mr(`#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;in vec4 v_data0;in vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;fragColor=texture(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
return;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);fragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`in vec4 a_pos_offset;in vec4 a_data;in vec3 a_projected_pos;in float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_texsize_icon;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform vec2 u_translation;uniform float u_pitched_scale;out vec4 v_data0;out vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;
#ifdef GLOBE
if(u_pitch_with_map && !u_is_along_line) {float anchor_pos_tile_y=(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w,z,1.0)).y;projectionScaling=mix(projectionScaling,1.0/circumferenceRatioAtTileY(anchor_pos_tile_y)*u_pitched_scale,u_projection_transition);}
#endif
vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}float gamma_scale=finalPos.w;gl_Position=finalPos;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity,is_sdf);}`),terrain:mr("uniform sampler2D u_texture;uniform vec4 u_fog_color;uniform vec4 u_horizon_color;uniform float u_fog_ground_blend;uniform float u_fog_ground_blend_opacity;uniform float u_horizon_fog_blend;uniform bool u_is_globe_mode;in vec2 v_texture_pos;in float v_fog_depth;const float gamma=2.2;vec4 gammaToLinear(vec4 color) {return pow(color,vec4(gamma));}vec4 linearToGamma(vec4 color) {return pow(color,vec4(1.0/gamma));}void main() {vec4 surface_color=texture(u_texture,vec2(v_texture_pos.x,1.0-v_texture_pos.y));if (!u_is_globe_mode && v_fog_depth > u_fog_ground_blend) {vec4 surface_color_linear=gammaToLinear(surface_color);float blend_color=smoothstep(0.0,1.0,max((v_fog_depth-u_horizon_fog_blend)/(1.0-u_horizon_fog_blend),0.0));vec4 fog_horizon_color_linear=mix(gammaToLinear(u_fog_color),gammaToLinear(u_horizon_color),blend_color);float factor_fog=max(v_fog_depth-u_fog_ground_blend,0.0)/(1.0-u_fog_ground_blend);fragColor=linearToGamma(mix(surface_color_linear,fog_horizon_color_linear,pow(factor_fog,2.0)*u_fog_ground_blend_opacity));} else {fragColor=surface_color;}}","in vec3 a_pos3d;uniform mat4 u_fog_matrix;uniform float u_ele_delta;out vec2 v_texture_pos;out float v_fog_depth;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;v_texture_pos=a_pos3d.xy/8192.0;gl_Position=projectTileFor3D(a_pos3d.xy,get_elevation(a_pos3d.xy)-ele_delta);vec4 pos=u_fog_matrix*vec4(a_pos3d.xy,ele,1.0);v_fog_depth=pos.z/pos.w*0.5+0.5;}"),terrainDepth:mr("in float v_depth;const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitMsk=vec4(0.,vec3(1./256.0));highp vec4 pack(highp float value) {highp vec4 comp=fract(value*bitSh);comp-=comp.xxyz*bitMsk;return comp;}void main() {fragColor=pack(v_depth);}","in vec3 a_pos3d;uniform float u_ele_delta;out float v_depth;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;gl_Position=projectTileFor3D(a_pos3d.xy,ele-ele_delta);v_depth=gl_Position.z/gl_Position.w;}"),terrainCoords:mr("precision mediump float;uniform sampler2D u_texture;uniform float u_terrain_coords_id;in vec2 v_texture_pos;void main() {vec4 rgba=texture(u_texture,v_texture_pos);fragColor=vec4(rgba.r,rgba.g,rgba.b,u_terrain_coords_id);}","in vec3 a_pos3d;uniform float u_ele_delta;out vec2 v_texture_pos;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;v_texture_pos=a_pos3d.xy/8192.0;gl_Position=projectTileFor3D(a_pos3d.xy,ele-ele_delta);}"),projectionErrorMeasurement:mr("in vec4 v_output_error_encoded;void main() {fragColor=v_output_error_encoded;}","in vec2 a_pos;uniform highp float u_input;uniform highp float u_output_expected;out vec4 v_output_error_encoded;void main() {float real_output=2.0*atan(exp(PI-(u_input*PI*2.0)))-PI*0.5;float error=real_output-u_output_expected;float abs_error=abs(error)*128.0;v_output_error_encoded.x=min(floor(abs_error*256.0),255.0)/255.0;abs_error-=v_output_error_encoded.x;v_output_error_encoded.y=min(floor(abs_error*65536.0),255.0)/255.0;abs_error-=v_output_error_encoded.x/255.0;v_output_error_encoded.z=min(floor(abs_error*16777216.0),255.0)/255.0;v_output_error_encoded.w=error >=0.0 ? 1.0 : 0.0;gl_Position=vec4(a_pos,0.0,1.0);}"),atmosphere:mr(`in vec3 view_direction;uniform vec3 u_sun_pos;uniform vec3 u_globe_position;uniform float u_globe_radius;uniform float u_atmosphere_blend;/**Shader use from https:*Made some change to adapt to MapLibre Globe geometry*/const float PI=3.141592653589793;const int iSteps=5;const int jSteps=3;/*radius of the planet*/const float EARTH_RADIUS=6371e3;/*radius of the atmosphere*/const float ATMOS_RADIUS=6471e3;vec2 rsi(vec3 r0,vec3 rd,float sr) {float a=dot(rd,rd);float b=2.0*dot(rd,r0);float c=dot(r0,r0)-(sr*sr);float d=(b*b)-4.0*a*c;if (d < 0.0) return vec2(1e5,-1e5);return vec2((-b-sqrt(d))/(2.0*a),(-b+sqrt(d))/(2.0*a));}vec4 atmosphere(vec3 r,vec3 r0,vec3 pSun,float iSun,float rPlanet,float rAtmos,vec3 kRlh,float kMie,float shRlh,float shMie,float g) {pSun=normalize(pSun);r=normalize(r);vec2 p=rsi(r0,r,rAtmos);if (p.x > p.y) {return vec4(0.0,0.0,0.0,1.0);}if (p.x < 0.0) {p.x=0.0;}vec3 pos=r0+r*p.x;vec2 p2=rsi(r0,r,rPlanet);if (p2.x <=p2.y && p2.x > 0.0) {p.y=min(p.y,p2.x);}float iStepSize=(p.y-p.x)/float(iSteps);float iTime=p.x+iStepSize*0.5;vec3 totalRlh=vec3(0,0,0);vec3 totalMie=vec3(0,0,0);float iOdRlh=0.0;float iOdMie=0.0;float mu=dot(r,pSun);float mumu=mu*mu;float gg=g*g;float pRlh=3.0/(16.0*PI)*(1.0+mumu);float pMie=3.0/(8.0*PI)*((1.0-gg)*(mumu+1.0))/(pow(1.0+gg-2.0*mu*g,1.5)*(2.0+gg));for (int i=0; i < iSteps; i++) {vec3 iPos=r0+r*iTime;float iHeight=length(iPos)-rPlanet;float odStepRlh=exp(-iHeight/shRlh)*iStepSize;float odStepMie=exp(-iHeight/shMie)*iStepSize;iOdRlh+=odStepRlh;iOdMie+=odStepMie;float jStepSize=rsi(iPos,pSun,rAtmos).y/float(jSteps);float jTime=jStepSize*0.5;float jOdRlh=0.0;float jOdMie=0.0;for (int j=0; j < jSteps; j++) {vec3 jPos=iPos+pSun*jTime;float jHeight=length(jPos)-rPlanet;jOdRlh+=exp(-jHeight/shRlh)*jStepSize;jOdMie+=exp(-jHeight/shMie)*jStepSize;jTime+=jStepSize;}vec3 attn=exp(-(kMie*(iOdMie+jOdMie)+kRlh*(iOdRlh+jOdRlh)));totalRlh+=odStepRlh*attn;totalMie+=odStepMie*attn;iTime+=iStepSize;}float opacity=exp(-(length(kRlh)*length(totalRlh)+kMie*length(totalMie)));vec3 color=iSun*(pRlh*kRlh*totalRlh+pMie*kMie*totalMie);return vec4(color,opacity);}void main() {vec3 scale_camera_pos=-u_globe_position*EARTH_RADIUS/u_globe_radius;vec4 color=atmosphere(normalize(view_direction),scale_camera_pos,u_sun_pos,22.0,EARTH_RADIUS,ATMOS_RADIUS,vec3(5.5e-6,13.0e-6,22.4e-6),21e-6,8e3,1.2e3,0.758
);color.rgb=1.0-exp(-1.0*color.rgb);color=pow(color,vec4(1.0/2.2));fragColor=vec4(color.rgb,1.0-color.a)*u_atmosphere_blend;}`,"in vec2 a_pos;uniform mat4 u_inv_proj_matrix;out vec3 view_direction;void main() {view_direction=(u_inv_proj_matrix*vec4(a_pos,0.0,1.0)).xyz;gl_Position=vec4(a_pos,0.0,1.0);}"),sky:mr("uniform vec4 u_sky_color;uniform vec4 u_horizon_color;uniform vec2 u_horizon;uniform vec2 u_horizon_normal;uniform float u_sky_horizon_blend;uniform float u_sky_blend;void main() {float x=gl_FragCoord.x;float y=gl_FragCoord.y;float blend=(y-u_horizon.y)*u_horizon_normal.y+(x-u_horizon.x)*u_horizon_normal.x;if (blend > 0.0) {if (blend < u_sky_horizon_blend) {fragColor=mix(u_sky_color,u_horizon_color,pow(1.0-blend/u_sky_horizon_blend,2.0));} else {fragColor=u_sky_color;}}fragColor=mix(fragColor,vec4(vec3(0.0),0.0),u_sky_blend);}","in vec2 a_pos;void main() {gl_Position=vec4(a_pos,1.0,1.0);}")};function mr(x,i){const d=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,p=i.match(/in ([\w]+) ([\w]+)/g),_=x.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),w=i.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),E=w?w.concat(_):_,M={};return{fragmentSource:x=x.replace(d,(D,$,U,K,H)=>(M[H]=!0,$==="define"?`
#ifndef HAS_UNIFORM_u_${H}
in ${U} ${K} ${H};
#else
uniform ${U} ${K} u_${H};
#endif
`:`
#ifdef HAS_UNIFORM_u_${H}
    ${U} ${K} ${H} = u_${H};
#endif
`)),vertexSource:i=i.replace(d,(D,$,U,K,H)=>{const ee=K==="float"?"vec2":"vec4",ae=H.match(/color/)?"color":ee;return M[H]?$==="define"?`
#ifndef HAS_UNIFORM_u_${H}
uniform lowp float u_${H}_t;
in ${U} ${ee} a_${H};
out ${U} ${K} ${H};
#else
uniform ${U} ${K} u_${H};
#endif
`:ae==="vec4"?`
#ifndef HAS_UNIFORM_u_${H}
    ${H} = a_${H};
#else
    ${U} ${K} ${H} = u_${H};
#endif
`:`
#ifndef HAS_UNIFORM_u_${H}
    ${H} = unpack_mix_${ae}(a_${H}, u_${H}_t);
#else
    ${U} ${K} ${H} = u_${H};
#endif
`:$==="define"?`
#ifndef HAS_UNIFORM_u_${H}
uniform lowp float u_${H}_t;
in ${U} ${ee} a_${H};
#else
uniform ${U} ${K} u_${H};
#endif
`:ae==="vec4"?`
#ifndef HAS_UNIFORM_u_${H}
    ${U} ${K} ${H} = a_${H};
#else
    ${U} ${K} ${H} = u_${H};
#endif
`:`
#ifndef HAS_UNIFORM_u_${H}
    ${U} ${K} ${H} = unpack_mix_${ae}(a_${H}, u_${H}_t);
#else
    ${U} ${K} ${H} = u_${H};
#endif
`}),staticAttributes:p,staticUniforms:E}}class mc{constructor(i,d,p){this.vertexBuffer=i,this.indexBuffer=d,this.segments=p}destroy(){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.vertexBuffer=null,this.indexBuffer=null,this.segments=null}}var Wi=a.aJ([{name:"a_pos",type:"Int16",components:2}]);const bl="#define PROJECTION_MERCATOR",ar="mercator";class Zu{constructor(){this._cachedMesh=null}get name(){return"mercator"}get useSubdivision(){return!1}get shaderVariantName(){return ar}get shaderDefine(){return bl}get shaderPreludeCode(){return Gi.projectionMercator}get vertexShaderPreludeCode(){return Gi.projectionMercator.vertexSource}get subdivisionGranularity(){return a.aK.noSubdivision}get useGlobeControls(){return!1}get transitionState(){return 0}get latitudeErrorCorrectionRadians(){return 0}destroy(){}updateGPUdependent(i){}getMeshFromTileID(i,d,p,_,w){if(this._cachedMesh)return this._cachedMesh;const E=new a.aL;E.emplaceBack(0,0),E.emplaceBack(a.$,0),E.emplaceBack(0,a.$),E.emplaceBack(a.$,a.$);const M=i.createVertexBuffer(E,Wi.members),D=a.aM.simpleSegment(0,0,4,2),$=new a.aN;$.emplaceBack(1,0,2),$.emplaceBack(1,2,3);const U=i.createIndexBuffer($);return this._cachedMesh=new mc(M,U,D),this._cachedMesh}recalculate(){}hasTransition(){return!1}setErrorQueryLatitudeDegrees(i){}}class Ku{constructor(i=0,d=0,p=0,_=0){if(isNaN(i)||i<0||isNaN(d)||d<0||isNaN(p)||p<0||isNaN(_)||_<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=i,this.bottom=d,this.left=p,this.right=_}interpolate(i,d,p){return d.top!=null&&i.top!=null&&(this.top=a.C.number(i.top,d.top,p)),d.bottom!=null&&i.bottom!=null&&(this.bottom=a.C.number(i.bottom,d.bottom,p)),d.left!=null&&i.left!=null&&(this.left=a.C.number(i.left,d.left,p)),d.right!=null&&i.right!=null&&(this.right=a.C.number(i.right,d.right,p)),this}getCenter(i,d){const p=a.ah((this.left+i-this.right)/2,0,i),_=a.ah((this.top+d-this.bottom)/2,0,d);return new a.P(p,_)}equals(i){return this.top===i.top&&this.bottom===i.bottom&&this.left===i.left&&this.right===i.right}clone(){return new Ku(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}function gc(x,i){if(!x.renderWorldCopies||x.lngRange)return;const d=i.lng-x.center.lng;i.lng+=d>180?-360:d<-180?360:0}function rs(x){return Math.max(0,Math.floor(x))}class wi{constructor(i,d,p,_,w,E){this._callbacks=i,this._tileSize=512,this._renderWorldCopies=E===void 0||!!E,this._minZoom=d||0,this._maxZoom=p||22,this._minPitch=_??0,this._maxPitch=w??60,this.setMaxBounds(),this._width=0,this._height=0,this._center=new a.S(0,0),this._elevation=0,this._zoom=0,this._tileZoom=rs(this._zoom),this._scale=a.af(this._zoom),this._bearingInRadians=0,this._fovInRadians=.6435011087932844,this._pitchInRadians=0,this._rollInRadians=0,this._unmodified=!0,this._edgeInsets=new Ku,this._minElevationForCurrentTile=0,this._autoCalculateNearFarZ=!0}apply(i,d,p){this._latRange=i.latRange,this._lngRange=i.lngRange,this._width=i.width,this._height=i.height,this._center=i.center,this._elevation=i.elevation,this._minElevationForCurrentTile=i.minElevationForCurrentTile,this._zoom=i.zoom,this._tileZoom=rs(this._zoom),this._scale=a.af(this._zoom),this._bearingInRadians=i.bearingInRadians,this._fovInRadians=i.fovInRadians,this._pitchInRadians=i.pitchInRadians,this._rollInRadians=i.rollInRadians,this._unmodified=i.unmodified,this._edgeInsets=new Ku(i.padding.top,i.padding.bottom,i.padding.left,i.padding.right),this._minZoom=i.minZoom,this._maxZoom=i.maxZoom,this._minPitch=i.minPitch,this._maxPitch=i.maxPitch,this._renderWorldCopies=i.renderWorldCopies,this._cameraToCenterDistance=i.cameraToCenterDistance,this._nearZ=i.nearZ,this._farZ=i.farZ,this._autoCalculateNearFarZ=!p&&i.autoCalculateNearFarZ,d&&this._constrain(),this._calcMatrices()}get pixelsToClipSpaceMatrix(){return this._pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._clipSpaceToPixelsMatrix}get minElevationForCurrentTile(){return this._minElevationForCurrentTile}setMinElevationForCurrentTile(i){this._minElevationForCurrentTile=i}get tileSize(){return this._tileSize}get tileZoom(){return this._tileZoom}get scale(){return this._scale}get width(){return this._width}get height(){return this._height}get bearingInRadians(){return this._bearingInRadians}get lngRange(){return this._lngRange}get latRange(){return this._latRange}get pixelsToGLUnits(){return this._pixelsToGLUnits}get minZoom(){return this._minZoom}setMinZoom(i){this._minZoom!==i&&(this._minZoom=i,this.setZoom(this.getConstrained(this._center,this.zoom).zoom))}get maxZoom(){return this._maxZoom}setMaxZoom(i){this._maxZoom!==i&&(this._maxZoom=i,this.setZoom(this.getConstrained(this._center,this.zoom).zoom))}get minPitch(){return this._minPitch}setMinPitch(i){this._minPitch!==i&&(this._minPitch=i,this.setPitch(Math.max(this.pitch,i)))}get maxPitch(){return this._maxPitch}setMaxPitch(i){this._maxPitch!==i&&(this._maxPitch=i,this.setPitch(Math.min(this.pitch,i)))}get renderWorldCopies(){return this._renderWorldCopies}setRenderWorldCopies(i){i===void 0?i=!0:i===null&&(i=!1),this._renderWorldCopies=i}get worldSize(){return this._tileSize*this._scale}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new a.P(this._width,this._height)}get bearing(){return this._bearingInRadians/Math.PI*180}setBearing(i){const d=a.aO(i,-180,180)*Math.PI/180;var p,_,w,E,M,D,$,U,K;this._bearingInRadians!==d&&(this._unmodified=!1,this._bearingInRadians=d,this._calcMatrices(),this._rotationMatrix=y(),p=this._rotationMatrix,w=-this._bearingInRadians,E=(_=this._rotationMatrix)[0],M=_[1],D=_[2],$=_[3],U=Math.sin(w),K=Math.cos(w),p[0]=E*K+D*U,p[1]=M*K+$*U,p[2]=E*-U+D*K,p[3]=M*-U+$*K)}get rotationMatrix(){return this._rotationMatrix}get pitchInRadians(){return this._pitchInRadians}get pitch(){return this._pitchInRadians/Math.PI*180}setPitch(i){const d=a.ah(i,this.minPitch,this.maxPitch)/180*Math.PI;this._pitchInRadians!==d&&(this._unmodified=!1,this._pitchInRadians=d,this._calcMatrices())}get rollInRadians(){return this._rollInRadians}get roll(){return this._rollInRadians/Math.PI*180}setRoll(i){const d=i/180*Math.PI;this._rollInRadians!==d&&(this._unmodified=!1,this._rollInRadians=d,this._calcMatrices())}get fovInRadians(){return this._fovInRadians}get fov(){return a.aP(this._fovInRadians)}setFov(i){i=a.ah(i,.1,150),this.fov!==i&&(this._unmodified=!1,this._fovInRadians=a.ae(i),this._calcMatrices())}get zoom(){return this._zoom}setZoom(i){const d=this.getConstrained(this._center,i).zoom;this._zoom!==d&&(this._unmodified=!1,this._zoom=d,this._tileZoom=Math.max(0,Math.floor(d)),this._scale=a.af(d),this._constrain(),this._calcMatrices())}get center(){return this._center}setCenter(i){i.lat===this._center.lat&&i.lng===this._center.lng||(this._unmodified=!1,this._center=i,this._constrain(),this._calcMatrices())}get elevation(){return this._elevation}setElevation(i){i!==this._elevation&&(this._elevation=i,this._constrain(),this._calcMatrices())}get padding(){return this._edgeInsets.toJSON()}setPadding(i){this._edgeInsets.equals(i)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,i,1),this._calcMatrices())}get centerPoint(){return this._edgeInsets.getCenter(this._width,this._height)}get pixelsPerMeter(){return this._pixelPerMeter}get unmodified(){return this._unmodified}get cameraToCenterDistance(){return this._cameraToCenterDistance}get nearZ(){return this._nearZ}get farZ(){return this._farZ}get autoCalculateNearFarZ(){return this._autoCalculateNearFarZ}overrideNearFarZ(i,d){this._autoCalculateNearFarZ=!1,this._nearZ=i,this._farZ=d,this._calcMatrices()}clearNearFarZOverride(){this._autoCalculateNearFarZ=!0,this._calcMatrices()}isPaddingEqual(i){return this._edgeInsets.equals(i)}interpolatePadding(i,d,p){this._unmodified=!1,this._edgeInsets.interpolate(i,d,p),this._constrain(),this._calcMatrices()}resize(i,d,p=!0){this._width=i,this._height=d,p&&this._constrain(),this._calcMatrices()}getMaxBounds(){return this._latRange&&this._latRange.length===2&&this._lngRange&&this._lngRange.length===2?new Et([this._lngRange[0],this._latRange[0]],[this._lngRange[1],this._latRange[1]]):null}setMaxBounds(i){i?(this._lngRange=[i.getWest(),i.getEast()],this._latRange=[i.getSouth(),i.getNorth()],this._constrain()):(this._lngRange=null,this._latRange=[-a.ai,a.ai])}getConstrained(i,d){return this._callbacks.getConstrained(i,d)}getCameraQueryGeometry(i,d){if(d.length===1)return[d[0],i];{const{minX:p,minY:_,maxX:w,maxY:E}=a.a2.fromPoints(d).extend(i);return[new a.P(p,_),new a.P(w,_),new a.P(w,E),new a.P(p,E),new a.P(p,_)]}}_constrain(){if(!this.center||!this._width||!this._height||this._constraining)return;this._constraining=!0;const i=this._unmodified,{center:d,zoom:p}=this.getConstrained(this.center,this.zoom);this.setCenter(d),this.setZoom(p),this._unmodified=i,this._constraining=!1}_calcMatrices(){if(this._width&&this._height){this._pixelsToGLUnits=[2/this._width,-2/this._height];let i=a.ag(new Float64Array(16));a.N(i,i,[this._width/2,-this._height/2,1]),a.M(i,i,[1,-1,0]),this._clipSpaceToPixelsMatrix=i,i=a.ag(new Float64Array(16)),a.N(i,i,[1,-1,1]),a.M(i,i,[-1,-1,0]),a.N(i,i,[2/this._width,2/this._height,1]),this._pixelsToClipSpaceMatrix=i,this._cameraToCenterDistance=.5/Math.tan(this.fovInRadians/2)*this._height}this._callbacks.calcMatrices()}calculateCenterFromCameraLngLatAlt(i,d,p,_){const w=p!==void 0?p:this.bearing,E=_=_!==void 0?_:this.pitch,M=a.a1.fromLngLat(i,d),D=-Math.cos(a.ae(E)),$=Math.sin(a.ae(E)),U=$*Math.sin(a.ae(w)),K=-$*Math.cos(a.ae(w));let H=this.elevation;const ee=d-H;let ae;D*ee>=0||Math.abs(D)<.1?(ae=1e4,H=d+ae*D):ae=-ee/D;let me,ge,_e=a.aQ(1,M.y),Te=0;do{if(Te+=1,Te>10)break;ge=ae/_e,me=new a.a1(M.x+U*ge,M.y+K*ge),_e=1/me.meterInMercatorCoordinateUnits()}while(Math.abs(ae-ge*_e)>1e-12);return{center:me.toLngLat(),elevation:H,zoom:a.ak(this.height/2/Math.tan(this.fovInRadians/2)/ge/this.tileSize)}}recalculateZoomAndCenter(i){if(this.elevation-i==0)return;const d=a.aj(1,this.center.lat)*this.worldSize,p=this.cameraToCenterDistance/d,_=a.a1.fromLngLat(this.center,this.elevation),w=He(this.center,this.elevation,this.pitch,this.bearing,p);this._elevation=i;const E=this.calculateCenterFromCameraLngLatAlt(w.toLngLat(),a.aQ(w.z,_.y),this.bearing,this.pitch);this._elevation=E.elevation,this._center=E.center,this.setZoom(E.zoom)}getCameraPoint(){const i=Math.tan(this.pitchInRadians)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new a.P(i*Math.sin(this.rollInRadians),i*Math.cos(this.rollInRadians)))}getCameraAltitude(){return Math.cos(this.pitchInRadians)*this._cameraToCenterDistance/this._pixelPerMeter+this.elevation}getCameraLngLat(){const i=a.aj(1,this.center.lat)*this.worldSize;return He(this.center,this.elevation,this.pitch,this.bearing,this.cameraToCenterDistance/i).toLngLat()}getMercatorTileCoordinates(i){if(!i)return[0,0,1,1];const d=i.canonical.z>=0?1<<i.canonical.z:Math.pow(2,i.canonical.z);return[i.canonical.x/d,i.canonical.y/d,1/d/a.$,1/d/a.$]}}class ni{constructor(i,d){this.min=i,this.max=d,this.center=a.aR([],a.aS([],this.min,this.max),.5)}quadrant(i){const d=[i%2==0,i<2],p=a.aT(this.min),_=a.aT(this.max);for(let w=0;w<d.length;w++)p[w]=d[w]?this.min[w]:this.center[w],_[w]=d[w]?this.center[w]:this.max[w];return _[2]=this.max[2],new ni(p,_)}distanceX(i){return Math.max(Math.min(this.max[0],i[0]),this.min[0])-i[0]}distanceY(i){return Math.max(Math.min(this.max[1],i[1]),this.min[1])-i[1]}intersectsFrustum(i){let d=!0;for(let p=0;p<i.planes.length;p++){const _=this.intersectsPlane(i.planes[p]);if(_===0)return 0;_===1&&(d=!1)}return d?2:i.aabb.min[0]>this.max[0]||i.aabb.min[1]>this.max[1]||i.aabb.min[2]>this.max[2]||i.aabb.max[0]<this.min[0]||i.aabb.max[1]<this.min[1]||i.aabb.max[2]<this.min[2]?0:1}intersectsPlane(i){let d=i[3],p=i[3];for(let _=0;_<3;_++)i[_]>0?(d+=i[_]*this.min[_],p+=i[_]*this.max[_]):(p+=i[_]*this.min[_],d+=i[_]*this.max[_]);return d>=0?2:p<0?0:1}}class Si{distanceToTile2d(i,d,p,_){const w=_.distanceX([i,d]),E=_.distanceY([i,d]);return Math.hypot(w,E)}getWrap(i,d,p){return p}getTileBoundingVolume(i,d,p,_){var w,E;let M=0,D=0;if(_!=null&&_.terrain){const U=new a.Z(i.z,d,i.z,i.x,i.y),K=_.terrain.getMinMaxElevation(U);M=(w=K.minElevation)!==null&&w!==void 0?w:Math.min(0,p),D=(E=K.maxElevation)!==null&&E!==void 0?E:Math.max(0,p)}const $=1<<i.z;return new ni([d+i.x/$,i.y/$,M],[d+(i.x+1)/$,(i.y+1)/$,D])}allowVariableZoom(i,d){const p=i.fov*(Math.abs(Math.cos(i.rollInRadians))*i.height+Math.abs(Math.sin(i.rollInRadians))*i.width)/i.height,_=a.ah(78.5-p/2,0,60);return!!d.terrain||i.pitch>_}allowWorldCopies(){return!0}prepareNextFrame(){}}class qr{constructor(i,d,p){this.points=i,this.planes=d,this.aabb=p}static fromInvProjectionMatrix(i,d=1,p=0,_,w){const E=w?[[6,5,4],[0,1,2],[0,3,7],[2,1,5],[3,2,6],[0,4,5]]:[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]],M=Math.pow(2,p),D=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(H=>function(ee,ae,me,ge){const _e=a.aw([],ee,ae),Te=1/_e[3]/me*ge;return a.aY(_e,_e,[Te,Te,1/_e[3],Te])}(H,i,d,M));_&&function(H,ee,ae,me){const ge=me?4:0,_e=me?0:4;let Te=0;const Ce=[],Ee=[];for(let Pe=0;Pe<4;Pe++){const Ne=a.aU([],H[Pe+_e],H[Pe+ge]),qe=a.aZ(Ne);a.aR(Ne,Ne,1/qe),Ce.push(qe),Ee.push(Ne)}for(let Pe=0;Pe<4;Pe++){const Ne=a.a_(H[Pe+ge],Ee[Pe],ae);Te=Ne!==null&&Ne>=0?Math.max(Te,Ne):Math.max(Te,Ce[Pe])}const Ie=function(Pe,Ne){const qe=a.aU([],Pe[Ne[0]],Pe[Ne[1]]),Ve=a.aU([],Pe[Ne[2]],Pe[Ne[1]]),Ge=[0,0,0,0];return a.aV(Ge,a.aW([],qe,Ve)),Ge[3]=-a.aX(Ge,Pe[Ne[0]]),Ge}(H,ee),Le=function(Pe,Ne){const qe=a.a$(Pe),Ve=a.b0([],Pe,1/qe),Ge=a.aU([],Ne,a.aR([],Ve,a.aX(Ne,Ve))),We=a.a$(Ge);if(We>0){const ct=Math.sqrt(1-Ve[3]*Ve[3]),ut=a.aR([],Ve,-Ve[3]),tt=a.aS([],ut,a.aR([],Ge,ct/We));return a.b1(Ne,tt)}return null}(ae,Ie);if(Le!==null){const Pe=Le/a.aX(Ee[0],Ie);Te=Math.min(Te,Pe)}for(let Pe=0;Pe<4;Pe++){const Ne=Math.min(Te,Ce[Pe]);H[Pe+_e]=[H[Pe+ge][0]+Ee[Pe][0]*Ne,H[Pe+ge][1]+Ee[Pe][1]*Ne,H[Pe+ge][2]+Ee[Pe][2]*Ne,1]}}(D,E[0],_,w);const $=E.map(H=>{const ee=a.aU([],D[H[0]],D[H[1]]),ae=a.aU([],D[H[2]],D[H[1]]),me=a.aV([],a.aW([],ee,ae)),ge=-a.aX(me,D[H[1]]);return me.concat(ge)}),U=[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY],K=[Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY];for(const H of D)for(let ee=0;ee<3;ee++)U[ee]=Math.min(U[ee],H[ee]),K[ee]=Math.max(K[ee],H[ee]);return new qr(D,$,new ni(U,K))}}class yc{get pixelsToClipSpaceMatrix(){return this._helper.pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._helper.clipSpaceToPixelsMatrix}get pixelsToGLUnits(){return this._helper.pixelsToGLUnits}get centerOffset(){return this._helper.centerOffset}get size(){return this._helper.size}get rotationMatrix(){return this._helper.rotationMatrix}get centerPoint(){return this._helper.centerPoint}get pixelsPerMeter(){return this._helper.pixelsPerMeter}setMinZoom(i){this._helper.setMinZoom(i)}setMaxZoom(i){this._helper.setMaxZoom(i)}setMinPitch(i){this._helper.setMinPitch(i)}setMaxPitch(i){this._helper.setMaxPitch(i)}setRenderWorldCopies(i){this._helper.setRenderWorldCopies(i)}setBearing(i){this._helper.setBearing(i)}setPitch(i){this._helper.setPitch(i)}setRoll(i){this._helper.setRoll(i)}setFov(i){this._helper.setFov(i)}setZoom(i){this._helper.setZoom(i)}setCenter(i){this._helper.setCenter(i)}setElevation(i){this._helper.setElevation(i)}setMinElevationForCurrentTile(i){this._helper.setMinElevationForCurrentTile(i)}setPadding(i){this._helper.setPadding(i)}interpolatePadding(i,d,p){return this._helper.interpolatePadding(i,d,p)}isPaddingEqual(i){return this._helper.isPaddingEqual(i)}resize(i,d,p=!0){this._helper.resize(i,d,p)}getMaxBounds(){return this._helper.getMaxBounds()}setMaxBounds(i){this._helper.setMaxBounds(i)}overrideNearFarZ(i,d){this._helper.overrideNearFarZ(i,d)}clearNearFarZOverride(){this._helper.clearNearFarZOverride()}getCameraQueryGeometry(i){return this._helper.getCameraQueryGeometry(this.getCameraPoint(),i)}get tileSize(){return this._helper.tileSize}get tileZoom(){return this._helper.tileZoom}get scale(){return this._helper.scale}get worldSize(){return this._helper.worldSize}get width(){return this._helper.width}get height(){return this._helper.height}get lngRange(){return this._helper.lngRange}get latRange(){return this._helper.latRange}get minZoom(){return this._helper.minZoom}get maxZoom(){return this._helper.maxZoom}get zoom(){return this._helper.zoom}get center(){return this._helper.center}get minPitch(){return this._helper.minPitch}get maxPitch(){return this._helper.maxPitch}get pitch(){return this._helper.pitch}get pitchInRadians(){return this._helper.pitchInRadians}get roll(){return this._helper.roll}get rollInRadians(){return this._helper.rollInRadians}get bearing(){return this._helper.bearing}get bearingInRadians(){return this._helper.bearingInRadians}get fov(){return this._helper.fov}get fovInRadians(){return this._helper.fovInRadians}get elevation(){return this._helper.elevation}get minElevationForCurrentTile(){return this._helper.minElevationForCurrentTile}get padding(){return this._helper.padding}get unmodified(){return this._helper.unmodified}get renderWorldCopies(){return this._helper.renderWorldCopies}get cameraToCenterDistance(){return this._helper.cameraToCenterDistance}get nearZ(){return this._helper.nearZ}get farZ(){return this._helper.farZ}get autoCalculateNearFarZ(){return this._helper.autoCalculateNearFarZ}setTransitionState(i,d){}constructor(i,d,p,_,w){this._posMatrixCache=new Map,this._alignedPosMatrixCache=new Map,this._fogMatrixCacheF32=new Map,this._helper=new wi({calcMatrices:()=>{this._calcMatrices()},getConstrained:(E,M)=>this.getConstrained(E,M)},i,d,p,_,w),this._coveringTilesDetailsProvider=new Si}clone(){const i=new yc;return i.apply(this),i}apply(i,d,p){this._helper.apply(i,d,p)}get cameraPosition(){return this._cameraPosition}get projectionMatrix(){return this._projectionMatrix}get modelViewProjectionMatrix(){return this._viewProjMatrix}get inverseProjectionMatrix(){return this._invProjMatrix}get mercatorMatrix(){return this._mercatorMatrix}getVisibleUnwrappedCoordinates(i){const d=[new a.b2(0,i)];if(this._helper._renderWorldCopies){const p=this.screenPointToMercatorCoordinate(new a.P(0,0)),_=this.screenPointToMercatorCoordinate(new a.P(this._helper._width,0)),w=this.screenPointToMercatorCoordinate(new a.P(this._helper._width,this._helper._height)),E=this.screenPointToMercatorCoordinate(new a.P(0,this._helper._height)),M=Math.floor(Math.min(p.x,_.x,w.x,E.x)),D=Math.floor(Math.max(p.x,_.x,w.x,E.x)),$=1;for(let U=M-$;U<=D+$;U++)U!==0&&d.push(new a.b2(U,i))}return d}getCameraFrustum(){return qr.fromInvProjectionMatrix(this._invViewProjMatrix,this.worldSize)}getClippingPlane(){return null}getCoveringTilesDetailsProvider(){return this._coveringTilesDetailsProvider}recalculateZoomAndCenter(i){const d=this.screenPointToLocation(this.centerPoint,i),p=i?i.getElevationForLngLatZoom(d,this._helper._tileZoom):0;this._helper.recalculateZoomAndCenter(p)}setLocationAtPoint(i,d){const p=a.aj(this.elevation,this.center.lat),_=this.screenPointToMercatorCoordinateAtZ(d,p),w=this.screenPointToMercatorCoordinateAtZ(this.centerPoint,p),E=a.a1.fromLngLat(i),M=new a.a1(E.x-(_.x-w.x),E.y-(_.y-w.y));this.setCenter(M==null?void 0:M.toLngLat()),this._helper._renderWorldCopies&&this.setCenter(this.center.wrap())}locationToScreenPoint(i,d){return d?this.coordinatePoint(a.a1.fromLngLat(i),d.getElevationForLngLatZoom(i,this._helper._tileZoom),this._pixelMatrix3D):this.coordinatePoint(a.a1.fromLngLat(i))}screenPointToLocation(i,d){var p;return(p=this.screenPointToMercatorCoordinate(i,d))===null||p===void 0?void 0:p.toLngLat()}screenPointToMercatorCoordinate(i,d){if(d){const p=d.pointCoordinate(i);if(p!=null)return p}return this.screenPointToMercatorCoordinateAtZ(i)}screenPointToMercatorCoordinateAtZ(i,d){const p=d||0,_=[i.x,i.y,0,1],w=[i.x,i.y,1,1];a.aw(_,_,this._pixelMatrixInverse),a.aw(w,w,this._pixelMatrixInverse);const E=_[3],M=w[3],D=_[1]/E,$=w[1]/M,U=_[2]/E,K=w[2]/M,H=U===K?0:(p-U)/(K-U);return new a.a1(a.C.number(_[0]/E,w[0]/M,H)/this.worldSize,a.C.number(D,$,H)/this.worldSize,p)}coordinatePoint(i,d=0,p=this._pixelMatrix){const _=[i.x*this.worldSize,i.y*this.worldSize,d,1];return a.aw(_,_,p),new a.P(_[0]/_[3],_[1]/_[3])}getBounds(){const i=Math.max(0,this._helper._height/2-Be(this));return new Et().extend(this.screenPointToLocation(new a.P(0,i))).extend(this.screenPointToLocation(new a.P(this._helper._width,i))).extend(this.screenPointToLocation(new a.P(this._helper._width,this._helper._height))).extend(this.screenPointToLocation(new a.P(0,this._helper._height)))}isPointOnMapSurface(i,d){return d?d.pointCoordinate(i)!=null:i.y>this.height/2-Be(this)}calculatePosMatrix(i,d=!1,p){var _;const w=(_=i.key)!==null&&_!==void 0?_:a.b3(i.wrap,i.canonical.z,i.canonical.z,i.canonical.x,i.canonical.y),E=d?this._alignedPosMatrixCache:this._posMatrixCache;if(E.has(w)){const $=E.get(w);return p?$.f32:$.f64}const M=ze(i,this.worldSize);a.O(M,d?this._alignedProjMatrix:this._viewProjMatrix,M);const D={f64:M,f32:new Float32Array(M)};return E.set(w,D),p?D.f32:D.f64}calculateFogMatrix(i){const d=i.key,p=this._fogMatrixCacheF32;if(p.has(d))return p.get(d);const _=ze(i,this.worldSize);return a.O(_,this._fogMatrix,_),p.set(d,new Float32Array(_)),p.get(d)}getConstrained(i,d){d=a.ah(+d,this.minZoom,this.maxZoom);const p={center:new a.S(i.lng,i.lat),zoom:d};let _=this._helper._lngRange;if(!this._helper._renderWorldCopies&&_===null){const Ce=179.9999999999;_=[-Ce,Ce]}const w=this.tileSize*a.af(p.zoom);let E=0,M=w,D=0,$=w,U=0,K=0;const{x:H,y:ee}=this.size;if(this._helper._latRange){const Ce=this._helper._latRange;E=a.U(Ce[1])*w,M=a.U(Ce[0])*w,M-E<ee&&(U=ee/(M-E))}_&&(D=a.aO(a.V(_[0])*w,0,w),$=a.aO(a.V(_[1])*w,0,w),$<D&&($+=w),$-D<H&&(K=H/($-D)));const{x:ae,y:me}=Ae(w,i);let ge,_e;const Te=Math.max(K||0,U||0);if(Te){const Ce=new a.P(K?($+D)/2:ae,U?(M+E)/2:me);return p.center=Oe(w,Ce).wrap(),p.zoom+=a.ak(Te),p}if(this._helper._latRange){const Ce=ee/2;me-Ce<E&&(_e=E+Ce),me+Ce>M&&(_e=M-Ce)}if(_){const Ce=(D+$)/2;let Ee=ae;this._helper._renderWorldCopies&&(Ee=a.aO(ae,Ce-w/2,Ce+w/2));const Ie=H/2;Ee-Ie<D&&(ge=D+Ie),Ee+Ie>$&&(ge=$-Ie)}if(ge!==void 0||_e!==void 0){const Ce=new a.P(ge??ae,_e??me);p.center=Oe(w,Ce).wrap()}return p}calculateCenterFromCameraLngLatAlt(i,d,p,_){return this._helper.calculateCenterFromCameraLngLatAlt(i,d,p,_)}_calculateNearFarZIfNeeded(i,d,p){if(!this._helper.autoCalculateNearFarZ)return;const _=Math.min(this.elevation,this.minElevationForCurrentTile,this.getCameraAltitude()-100),w=i-_*this._helper._pixelPerMeter/Math.cos(d),E=_<0?w:i,M=Math.PI/2+this.pitchInRadians,D=a.ae(this.fov)*(Math.abs(Math.cos(a.ae(this.roll)))*this.height+Math.abs(Math.sin(a.ae(this.roll)))*this.width)/this.height*(.5+p.y/this.height),$=Math.sin(D)*E/Math.sin(a.ah(Math.PI-M-D,.01,Math.PI-.01)),U=Be(this),K=Math.atan(U/this._helper.cameraToCenterDistance),H=a.ae(.75),ee=K>H?2*K*(.5+p.y/(2*U)):H,ae=Math.sin(ee)*E/Math.sin(a.ah(Math.PI-M-ee,.01,Math.PI-.01)),me=Math.min($,ae);this._helper._farZ=1.01*(Math.cos(Math.PI/2-d)*me+E),this._helper._nearZ=this._helper._height/50}_calcMatrices(){if(!this._helper._height)return;const i=this.centerOffset,d=Ae(this.worldSize,this.center),p=d.x,_=d.y;this._helper._pixelPerMeter=a.aj(1,this.center.lat)*this.worldSize;const w=a.ae(Math.min(this.pitch,we)),E=Math.max(this._helper.cameraToCenterDistance/2,this._helper.cameraToCenterDistance+this._helper._elevation*this._helper._pixelPerMeter/Math.cos(w));let M;this._calculateNearFarZIfNeeded(E,w,i),M=new Float64Array(16),a.b4(M,this.fovInRadians,this._helper._width/this._helper._height,this._helper._nearZ,this._helper._farZ),this._invProjMatrix=new Float64Array(16),a.aq(this._invProjMatrix,M),M[8]=2*-i.x/this._helper._width,M[9]=2*i.y/this._helper._height,this._projectionMatrix=a.b5(M),a.N(M,M,[1,-1,1]),a.M(M,M,[0,0,-this._helper.cameraToCenterDistance]),a.b6(M,M,-this.rollInRadians),a.b7(M,M,this.pitchInRadians),a.b6(M,M,-this.bearingInRadians),a.M(M,M,[-p,-_,0]),this._mercatorMatrix=a.N([],M,[this.worldSize,this.worldSize,this.worldSize]),a.N(M,M,[1,1,this._helper._pixelPerMeter]),this._pixelMatrix=a.O(new Float64Array(16),this.clipSpaceToPixelsMatrix,M),a.M(M,M,[0,0,-this.elevation]),this._viewProjMatrix=M,this._invViewProjMatrix=a.aq([],M);const D=[0,0,-1,1];a.aw(D,D,this._invViewProjMatrix),this._cameraPosition=[D[0]/D[3],D[1]/D[3],D[2]/D[3]],this._fogMatrix=new Float64Array(16),a.b4(this._fogMatrix,this.fovInRadians,this.width/this.height,E,this._helper._farZ),this._fogMatrix[8]=2*-i.x/this.width,this._fogMatrix[9]=2*i.y/this.height,a.N(this._fogMatrix,this._fogMatrix,[1,-1,1]),a.M(this._fogMatrix,this._fogMatrix,[0,0,-this.cameraToCenterDistance]),a.b6(this._fogMatrix,this._fogMatrix,-this.rollInRadians),a.b7(this._fogMatrix,this._fogMatrix,this.pitchInRadians),a.b6(this._fogMatrix,this._fogMatrix,-this.bearingInRadians),a.M(this._fogMatrix,this._fogMatrix,[-p,-_,0]),a.N(this._fogMatrix,this._fogMatrix,[1,1,this._helper._pixelPerMeter]),a.M(this._fogMatrix,this._fogMatrix,[0,0,-this.elevation]),this._pixelMatrix3D=a.O(new Float64Array(16),this.clipSpaceToPixelsMatrix,M);const $=this._helper._width%2/2,U=this._helper._height%2/2,K=Math.cos(this.bearingInRadians),H=Math.sin(-this.bearingInRadians),ee=p-Math.round(p)+K*$+H*U,ae=_-Math.round(_)+K*U+H*$,me=new Float64Array(M);if(a.M(me,me,[ee>.5?ee-1:ee,ae>.5?ae-1:ae,0]),this._alignedProjMatrix=me,M=a.aq(new Float64Array(16),this._pixelMatrix),!M)throw new Error("failed to invert matrix");this._pixelMatrixInverse=M,this._clearMatrixCaches()}_clearMatrixCaches(){this._posMatrixCache.clear(),this._alignedPosMatrixCache.clear(),this._fogMatrixCacheF32.clear()}maxPitchScaleFactor(){if(!this._pixelMatrixInverse)return 1;const i=this.screenPointToMercatorCoordinate(new a.P(0,0)),d=[i.x*this.worldSize,i.y*this.worldSize,0,1];return a.aw(d,d,this._pixelMatrix)[3]/this._helper.cameraToCenterDistance}getCameraPoint(){return this._helper.getCameraPoint()}getCameraAltitude(){return this._helper.getCameraAltitude()}getCameraLngLat(){const i=a.aj(1,this.center.lat)*this.worldSize;return He(this.center,this.elevation,this.pitch,this.bearing,this._helper.cameraToCenterDistance/i).toLngLat()}lngLatToCameraDepth(i,d){const p=a.a1.fromLngLat(i),_=[p.x*this.worldSize,p.y*this.worldSize,d,1];return a.aw(_,_,this._viewProjMatrix),_[2]/_[3]}getProjectionData(i){const{overscaledTileID:d,aligned:p,applyTerrainMatrix:_}=i,w=this._helper.getMercatorTileCoordinates(d),E=d?this.calculatePosMatrix(d,p,!0):null;let M;return M=d&&d.terrainRttPosMatrix32f&&_?d.terrainRttPosMatrix32f:E||a.b8(),{mainMatrix:M,tileMercatorCoords:w,clippingPlane:[0,0,0,0],projectionTransition:0,fallbackMatrix:M}}isLocationOccluded(i){return!1}getPixelScale(){return 1}getCircleRadiusCorrection(){return 1}getPitchedTextCorrection(i,d,p){return 1}transformLightDirection(i){return a.aT(i)}getRayDirectionFromPixel(i){throw new Error("Not implemented.")}projectTileCoordinates(i,d,p,_){const w=this.calculatePosMatrix(p);let E;_?(E=[i,d,_(i,d),1],a.aw(E,E,w)):(E=[i,d,0,1],ys(E,E,w));const M=E[3];return{point:new a.P(E[0]/M,E[1]/M),signedDistanceFromCamera:M,isOccluded:!1}}populateCache(i){for(const d of i)this.calculatePosMatrix(d)}getMatrixForModel(i,d){const p=a.a1.fromLngLat(i,d),_=p.meterInMercatorCoordinateUnits(),w=a.b9();return a.M(w,w,[p.x,p.y,p.z]),a.b6(w,w,Math.PI),a.b7(w,w,Math.PI/2),a.N(w,w,[-_,_,_]),w}getProjectionDataForCustomLayer(i=!0){const d=new a.Z(0,0,0,0,0),p=this.getProjectionData({overscaledTileID:d,applyGlobeMatrix:i}),_=ze(d,this.worldSize);a.O(_,this._viewProjMatrix,_),p.tileMercatorCoords=[0,0,1,1];const w=[a.$,a.$,this.worldSize/this._helper.pixelsPerMeter],E=a.ba();return a.N(E,_,w),p.fallbackMatrix=E,p.mainMatrix=E,p}getFastPathSimpleProjectionMatrix(i){return this.calculatePosMatrix(i)}}function qi(){a.w("Map cannot fit within canvas with the given bounds, padding, and/or offset.")}function _s(x){if(x.useSlerp)if(x.k<1){const i=a.bb(x.startEulerAngles.roll,x.startEulerAngles.pitch,x.startEulerAngles.bearing),d=a.bb(x.endEulerAngles.roll,x.endEulerAngles.pitch,x.endEulerAngles.bearing),p=new Float64Array(4);a.bc(p,i,d,x.k);const _=a.bd(p);x.tr.setRoll(_.roll),x.tr.setPitch(_.pitch),x.tr.setBearing(_.bearing)}else x.tr.setRoll(x.endEulerAngles.roll),x.tr.setPitch(x.endEulerAngles.pitch),x.tr.setBearing(x.endEulerAngles.bearing);else x.tr.setRoll(a.C.number(x.startEulerAngles.roll,x.endEulerAngles.roll,x.k)),x.tr.setPitch(a.C.number(x.startEulerAngles.pitch,x.endEulerAngles.pitch,x.k)),x.tr.setBearing(a.C.number(x.startEulerAngles.bearing,x.endEulerAngles.bearing,x.k))}function ns(x,i,d,p,_){const w=_.padding,E=Ae(_.worldSize,d.getNorthWest()),M=Ae(_.worldSize,d.getNorthEast()),D=Ae(_.worldSize,d.getSouthEast()),$=Ae(_.worldSize,d.getSouthWest()),U=a.ae(-p),K=E.rotate(U),H=M.rotate(U),ee=D.rotate(U),ae=$.rotate(U),me=new a.P(Math.max(K.x,H.x,ae.x,ee.x),Math.max(K.y,H.y,ae.y,ee.y)),ge=new a.P(Math.min(K.x,H.x,ae.x,ee.x),Math.min(K.y,H.y,ae.y,ee.y)),_e=me.sub(ge),Te=(_.width-(w.left+w.right+i.left+i.right))/_e.x,Ce=(_.height-(w.top+w.bottom+i.top+i.bottom))/_e.y;if(Ce<0||Te<0)return void qi();const Ee=Math.min(a.ak(_.scale*Math.min(Te,Ce)),x.maxZoom),Ie=a.P.convert(x.offset),Le=new a.P((i.left-i.right)/2,(i.top-i.bottom)/2).rotate(a.ae(p)),Pe=Ie.add(Le).mult(_.scale/a.af(Ee));return{center:Oe(_.worldSize,E.add(D).div(2).sub(Pe)),zoom:Ee,bearing:p}}class Xu{get useGlobeControls(){return!1}handlePanInertia(i,d){const p=i.mag(),_=Math.abs(Be(d));return{easingOffset:i.mult(Math.min(.75*_/p,1)),easingCenter:d.center}}handleMapControlsRollPitchBearingZoom(i,d){i.bearingDelta&&d.setBearing(d.bearing+i.bearingDelta),i.pitchDelta&&d.setPitch(d.pitch+i.pitchDelta),i.rollDelta&&d.setRoll(d.roll+i.rollDelta),i.zoomDelta&&d.setZoom(d.zoom+i.zoomDelta)}handleMapControlsPan(i,d,p){i.around.distSqr(d.centerPoint)<.01||d.setLocationAtPoint(p,i.around)}cameraForBoxAndBearing(i,d,p,_,w){return ns(i,d,p,_,w)}handleJumpToCenterZoom(i,d){i.zoom!==(d.zoom!==void 0?+d.zoom:i.zoom)&&i.setZoom(+d.zoom),d.center!==void 0&&i.setCenter(a.S.convert(d.center))}handleEaseTo(i,d){const p=i.zoom,_=i.padding,w={roll:i.roll,pitch:i.pitch,bearing:i.bearing},E={roll:d.roll===void 0?i.roll:d.roll,pitch:d.pitch===void 0?i.pitch:d.pitch,bearing:d.bearing===void 0?i.bearing:d.bearing},M=d.zoom!==void 0,D=!i.isPaddingEqual(d.padding);let $=!1;const U=M?+d.zoom:i.zoom;let K=i.centerPoint.add(d.offsetAsPoint);const H=i.screenPointToLocation(K),{center:ee,zoom:ae}=i.getConstrained(a.S.convert(d.center||H),U??p);gc(i,ee);const me=Ae(i.worldSize,H),ge=Ae(i.worldSize,ee).sub(me),_e=a.af(ae-p);return $=ae!==p,{easeFunc:Te=>{if($&&i.setZoom(a.C.number(p,ae,Te)),a.be(w,E)||_s({startEulerAngles:w,endEulerAngles:E,tr:i,k:Te,useSlerp:w.roll!=E.roll}),D&&(i.interpolatePadding(_,d.padding,Te),K=i.centerPoint.add(d.offsetAsPoint)),d.around)i.setLocationAtPoint(d.around,d.aroundPoint);else{const Ce=a.af(i.zoom-p),Ee=ae>p?Math.min(2,_e):Math.max(.5,_e),Ie=Math.pow(Ee,1-Te),Le=Oe(i.worldSize,me.add(ge.mult(Te*Ie)).mult(Ce));i.setLocationAtPoint(i.renderWorldCopies?Le.wrap():Le,K)}},isZooming:$,elevationCenter:ee}}handleFlyTo(i,d){const p=d.zoom!==void 0,_=i.zoom,w=i.getConstrained(a.S.convert(d.center||d.locationAtOffset),p?+d.zoom:_),E=w.center,M=w.zoom;gc(i,E);const D=Ae(i.worldSize,d.locationAtOffset),$=Ae(i.worldSize,E).sub(D),U=$.mag(),K=a.af(M-_);let H;if(d.minZoom!==void 0){const ee=Math.min(+d.minZoom,_,M),ae=i.getConstrained(E,ee).zoom;H=a.af(ae-_)}return{easeFunc:(ee,ae,me,ge)=>{i.setZoom(ee===1?M:_+a.ak(ae));const _e=ee===1?E:Oe(i.worldSize,D.add($.mult(me)).mult(ae));i.setLocationAtPoint(i.renderWorldCopies?_e.wrap():_e,ge)},scaleOfZoom:K,targetCenter:E,scaleOfMinZoom:H,pixelPathLength:U}}}class jr{constructor(i,d,p){this.blendFunction=i,this.blendColor=d,this.mask=p}}jr.Replace=[1,0],jr.disabled=new jr(jr.Replace,a.bf.transparent,[!1,!1,!1,!1]),jr.unblended=new jr(jr.Replace,a.bf.transparent,[!0,!0,!0,!0]),jr.alphaBlended=new jr([1,771],a.bf.transparent,[!0,!0,!0,!0]);const un=2305;class dr{constructor(i,d,p){this.enable=i,this.mode=d,this.frontFace=p}}dr.disabled=new dr(!1,1029,un),dr.backCCW=new dr(!0,1029,un),dr.frontCCW=new dr(!0,1028,un);class Wt{constructor(i,d,p){this.func=i,this.mask=d,this.range=p}}Wt.ReadOnly=!1,Wt.ReadWrite=!0,Wt.disabled=new Wt(519,Wt.ReadOnly,[0,1]);const _c=7680;class Qt{constructor(i,d,p,_,w,E){this.test=i,this.ref=d,this.mask=p,this.fail=_,this.depthFail=w,this.pass=E}}Qt.disabled=new Qt({func:519,mask:0},0,0,_c,_c,_c);const zd=new WeakMap;function Di(x){var i;if(zd.has(x))return zd.get(x);{const d=(i=x.getParameter(x.VERSION))===null||i===void 0?void 0:i.startsWith("WebGL 2.0");return zd.set(x,d),d}}class Rm{get awaitingQuery(){return!!this._readbackQueue}constructor(i){this._readbackWaitFrames=4,this._measureWaitFrames=6,this._texWidth=1,this._texHeight=1,this._measuredError=0,this._updateCount=0,this._lastReadbackFrame=-1e3,this._readbackQueue=null,this._cachedRenderContext=i;const d=i.context,p=d.gl;this._texFormat=p.RGBA,this._texType=p.UNSIGNED_BYTE;const _=new a.aL;_.emplaceBack(-1,-1),_.emplaceBack(2,-1),_.emplaceBack(-1,2);const w=new a.aN;w.emplaceBack(0,1,2),this._fullscreenTriangle=new mc(d.createVertexBuffer(_,Wi.members),d.createIndexBuffer(w),a.aM.simpleSegment(0,0,_.length,w.length)),this._resultBuffer=new Uint8Array(4),d.activeTexture.set(p.TEXTURE1);const E=p.createTexture();p.bindTexture(p.TEXTURE_2D,E),p.texParameteri(p.TEXTURE_2D,p.TEXTURE_WRAP_S,p.CLAMP_TO_EDGE),p.texParameteri(p.TEXTURE_2D,p.TEXTURE_WRAP_T,p.CLAMP_TO_EDGE),p.texParameteri(p.TEXTURE_2D,p.TEXTURE_MIN_FILTER,p.NEAREST),p.texParameteri(p.TEXTURE_2D,p.TEXTURE_MAG_FILTER,p.NEAREST),p.texImage2D(p.TEXTURE_2D,0,this._texFormat,this._texWidth,this._texHeight,0,this._texFormat,this._texType,null),this._fbo=d.createFramebuffer(this._texWidth,this._texHeight,!1,!1),this._fbo.colorAttachment.set(E),Di(p)&&(this._pbo=p.createBuffer(),p.bindBuffer(p.PIXEL_PACK_BUFFER,this._pbo),p.bufferData(p.PIXEL_PACK_BUFFER,4,p.STREAM_READ),p.bindBuffer(p.PIXEL_PACK_BUFFER,null))}destroy(){const i=this._cachedRenderContext.context.gl;this._fullscreenTriangle.destroy(),this._fbo.destroy(),i.deleteBuffer(this._pbo),this._fullscreenTriangle=null,this._fbo=null,this._pbo=null,this._resultBuffer=null}updateErrorLoop(i,d){const p=this._updateCount;return this._readbackQueue?p>=this._readbackQueue.frameNumberIssued+this._readbackWaitFrames&&this._tryReadback():p>=this._lastReadbackFrame+this._measureWaitFrames&&this._renderErrorTexture(i,d),this._updateCount++,this._measuredError}_bindFramebuffer(){const i=this._cachedRenderContext.context,d=i.gl;i.activeTexture.set(d.TEXTURE1),d.bindTexture(d.TEXTURE_2D,this._fbo.colorAttachment.get()),i.bindFramebuffer.set(this._fbo.framebuffer)}_renderErrorTexture(i,d){const p=this._cachedRenderContext.context,_=p.gl;if(this._bindFramebuffer(),p.viewport.set([0,0,this._texWidth,this._texHeight]),p.clear({color:a.bf.transparent}),this._cachedRenderContext.useProgram("projectionErrorMeasurement").draw(p,_.TRIANGLES,Wt.disabled,Qt.disabled,jr.unblended,dr.disabled,((w,E)=>({u_input:w,u_output_expected:E}))(i,d),null,null,"$clipping",this._fullscreenTriangle.vertexBuffer,this._fullscreenTriangle.indexBuffer,this._fullscreenTriangle.segments),this._pbo&&Di(_)){_.bindBuffer(_.PIXEL_PACK_BUFFER,this._pbo),_.readBuffer(_.COLOR_ATTACHMENT0),_.readPixels(0,0,this._texWidth,this._texHeight,this._texFormat,this._texType,0),_.bindBuffer(_.PIXEL_PACK_BUFFER,null);const w=_.fenceSync(_.SYNC_GPU_COMMANDS_COMPLETE,0);_.flush(),this._readbackQueue={frameNumberIssued:this._updateCount,sync:w}}else this._readbackQueue={frameNumberIssued:this._updateCount,sync:null}}_tryReadback(){const i=this._cachedRenderContext.context.gl;if(this._pbo&&this._readbackQueue&&Di(i)){const d=i.clientWaitSync(this._readbackQueue.sync,0,0);if(d===i.WAIT_FAILED)return a.w("WebGL2 clientWaitSync failed."),this._readbackQueue=null,void(this._lastReadbackFrame=this._updateCount);if(d===i.TIMEOUT_EXPIRED)return;i.bindBuffer(i.PIXEL_PACK_BUFFER,this._pbo),i.getBufferSubData(i.PIXEL_PACK_BUFFER,0,this._resultBuffer,0,4),i.bindBuffer(i.PIXEL_PACK_BUFFER,null)}else this._bindFramebuffer(),i.readPixels(0,0,this._texWidth,this._texHeight,this._texFormat,this._texType,this._resultBuffer);this._readbackQueue=null,this._measuredError=Rm._parseRGBA8float(this._resultBuffer),this._lastReadbackFrame=this._updateCount}static _parseRGBA8float(i){let d=0;return d+=i[0]/256,d+=i[1]/65536,d+=i[2]/16777216,i[3]<127&&(d=-d),d/128}}const Yu=a.$/128;function Qu(x,i){const d=x.granularity!==void 0?Math.max(x.granularity,1):1,p=d+(x.generateBorders?2:0),_=d+(x.extendToNorthPole||x.generateBorders?1:0)+(x.extendToSouthPole||x.generateBorders?1:0),w=p+1,E=_+1,M=x.generateBorders?-1:0,D=x.generateBorders||x.extendToNorthPole?-1:0,$=d+(x.generateBorders?1:0),U=d+(x.generateBorders||x.extendToSouthPole?1:0),K=w*E,H=p*_*6,ee=w*E>65536;if(ee&&i==="16bit")throw new Error("Granularity is too large and meshes would not fit inside 16 bit vertex indices.");const ae=ee||i==="32bit",me=new Int16Array(2*K);let ge=0;for(let Ce=D;Ce<=U;Ce++)for(let Ee=M;Ee<=$;Ee++){let Ie=Ee/d*a.$;Ee===-1&&(Ie=-Yu),Ee===d+1&&(Ie=a.$+Yu);let Le=Ce/d*a.$;Ce===-1&&(Le=x.extendToNorthPole?a.bh:-Yu),Ce===d+1&&(Le=x.extendToSouthPole?a.bi:a.$+Yu),me[ge++]=Ie,me[ge++]=Le}const _e=ae?new Uint32Array(H):new Uint16Array(H);let Te=0;for(let Ce=0;Ce<_;Ce++)for(let Ee=0;Ee<p;Ee++){const Ie=Ee+1+Ce*w,Le=Ee+(Ce+1)*w,Pe=Ee+1+(Ce+1)*w;_e[Te++]=Ee+Ce*w,_e[Te++]=Le,_e[Te++]=Ie,_e[Te++]=Ie,_e[Te++]=Le,_e[Te++]=Pe}return{vertices:me.buffer.slice(0),indices:_e.buffer.slice(0),uses32bitIndices:ae}}const vc=new a.aK({fill:new a.bj(128,2),line:new a.bj(512,0),tile:new a.bj(128,32),stencil:new a.bj(128,1),circle:3});class Ju{constructor(){this._tileMeshCache={},this._errorCorrectionUsable=0,this._errorMeasurementLastValue=0,this._errorCorrectionPreviousValue=0,this._errorMeasurementLastChangeTime=-1e3}get name(){return"vertical-perspective"}get transitionState(){return 1}get useSubdivision(){return!0}get shaderVariantName(){return"globe"}get shaderDefine(){return"#define GLOBE"}get shaderPreludeCode(){return Gi.projectionGlobe}get vertexShaderPreludeCode(){return Gi.projectionMercator.vertexSource}get subdivisionGranularity(){return vc}get useGlobeControls(){return!0}get latitudeErrorCorrectionRadians(){return this._errorCorrectionUsable}destroy(){this._errorMeasurement&&this._errorMeasurement.destroy()}updateGPUdependent(i){this._errorMeasurement||(this._errorMeasurement=new Rm(i));const d=a.U(this._errorQueryLatitudeDegrees),p=2*Math.atan(Math.exp(Math.PI-d*Math.PI*2))-.5*Math.PI,_=this._errorMeasurement.updateErrorLoop(d,p),w=P.now();_!==this._errorMeasurementLastValue&&(this._errorCorrectionPreviousValue=this._errorCorrectionUsable,this._errorMeasurementLastValue=_,this._errorMeasurementLastChangeTime=w);const E=Math.min(Math.max((w-this._errorMeasurementLastChangeTime)/1e3/.5,0),1);this._errorCorrectionUsable=a.bk(this._errorCorrectionPreviousValue,-this._errorMeasurementLastValue,a.bl(E))}_getMeshKey(i){return`${i.granularity.toString(36)}_${i.generateBorders?"b":""}${i.extendToNorthPole?"n":""}${i.extendToSouthPole?"s":""}`}getMeshFromTileID(i,d,p,_,w){const E=(w==="stencil"?vc.stencil:vc.tile).getGranularityForZoomLevel(d.z);return this._getMesh(i,{granularity:E,generateBorders:p,extendToNorthPole:d.y===0&&_,extendToSouthPole:d.y===(1<<d.z)-1&&_})}_getMesh(i,d){const p=this._getMeshKey(d);if(p in this._tileMeshCache)return this._tileMeshCache[p];const _=function(w,E){const M=Qu(E,"16bit"),D=a.aL.deserialize({arrayBuffer:M.vertices,length:M.vertices.byteLength/2/2}),$=a.aN.deserialize({arrayBuffer:M.indices,length:M.indices.byteLength/2/3});return new mc(w.createVertexBuffer(D,Wi.members),w.createIndexBuffer($),a.aM.simpleSegment(0,0,D.length,$.length))}(i,d);return this._tileMeshCache[p]=_,_}recalculate(i){}hasTransition(){const i=P.now();let d=!1;return d=d||(i-this._errorMeasurementLastChangeTime)/1e3<.7,d=d||this._errorMeasurement&&this._errorMeasurement.awaitingQuery,d}setErrorQueryLatitudeDegrees(i){this._errorQueryLatitudeDegrees=i}}const Dm=new a.r({type:new a.D(a.v.projection.type)});class Nd extends a.E{constructor(i){super(),this._transitionable=new a.t(Dm,void 0),this.setProjection(i),this._transitioning=this._transitionable.untransitioned(),this.recalculate(new a.F(0)),this._mercatorProjection=new Zu,this._verticalPerspectiveProjection=new Ju}get transitionState(){const i=this.properties.get("type");if(typeof i=="string"&&i==="mercator")return 0;if(typeof i=="string"&&i==="vertical-perspective")return 1;if(i instanceof a.bm){if(i.from==="vertical-perspective"&&i.to==="mercator")return 1-i.transition;if(i.from==="mercator"&&i.to==="vertical-perspective")return i.transition}return 1}get useGlobeRendering(){return this.transitionState>0}get latitudeErrorCorrectionRadians(){return this._verticalPerspectiveProjection.latitudeErrorCorrectionRadians}get currentProjection(){return this.useGlobeRendering?this._verticalPerspectiveProjection:this._mercatorProjection}get name(){return"globe"}get useSubdivision(){return this.currentProjection.useSubdivision}get shaderVariantName(){return this.currentProjection.shaderVariantName}get shaderDefine(){return this.currentProjection.shaderDefine}get shaderPreludeCode(){return this.currentProjection.shaderPreludeCode}get vertexShaderPreludeCode(){return this.currentProjection.vertexShaderPreludeCode}get subdivisionGranularity(){return this.currentProjection.subdivisionGranularity}get useGlobeControls(){return this.transitionState>0}destroy(){this._mercatorProjection.destroy(),this._verticalPerspectiveProjection.destroy()}updateGPUdependent(i){this._mercatorProjection.updateGPUdependent(i),this._verticalPerspectiveProjection.updateGPUdependent(i)}getMeshFromTileID(i,d,p,_,w){return this.currentProjection.getMeshFromTileID(i,d,p,_,w)}setProjection(i){this._transitionable.setValue("type",(i==null?void 0:i.type)||"mercator")}updateTransitions(i){this._transitioning=this._transitionable.transitioned(i,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()||this.currentProjection.hasTransition()}recalculate(i){this.properties=this._transitioning.possiblyEvaluate(i)}setErrorQueryLatitudeDegrees(i){this._verticalPerspectiveProjection.setErrorQueryLatitudeDegrees(i),this._mercatorProjection.setErrorQueryLatitudeDegrees(i)}}function eh(x){const i=wl(x.worldSize,x.center.lat);return 2*Math.PI*i}function Do(x,i,d,p,_){const w=1/(1<<_),E=i/a.$*w+p*w,M=a.bo((x/a.$*w+d*w)*Math.PI*2+Math.PI,2*Math.PI),D=2*Math.atan(Math.exp(Math.PI-E*Math.PI*2))-.5*Math.PI,$=Math.cos(D),U=new Float64Array(3);return U[0]=Math.sin(M)*$,U[1]=Math.sin(D),U[2]=Math.cos(M)*$,U}function ii(x){return function(i,d){const p=Math.cos(d),_=new Float64Array(3);return _[0]=Math.sin(i)*p,_[1]=Math.sin(d),_[2]=Math.cos(i)*p,_}(x.lng*Math.PI/180,x.lat*Math.PI/180)}function wl(x,i){return x/(2*Math.PI)/Math.cos(i*Math.PI/180)}function th(x){const i=Math.asin(x[1])/Math.PI*180,d=Math.sqrt(x[0]*x[0]+x[2]*x[2]);if(d>1e-6){const p=x[0]/d,_=Math.acos(x[2]/d),w=(p>0?_:-_)/Math.PI*180;return new a.S(a.aO(w,-180,180),i)}return new a.S(0,i)}function Oa(x){return Math.cos(x*Math.PI/180)}function si(x,i){const d=Oa(x),p=Oa(i);return a.ak(p/d)}function jd(x,i){const d=x.rotate(i.bearingInRadians),p=i.zoom+si(i.center.lat,0),_=a.bk(1/Oa(i.center.lat),1/Oa(Math.min(Math.abs(i.center.lat),60)),a.bn(p,7,3,0,1)),w=360/eh({worldSize:i.worldSize,center:{lat:i.center.lat}});return new a.S(i.center.lng-d.x*w*_,a.ah(i.center.lat+d.y*w,-a.ai,a.ai))}function Fd(x){const i=.5*x,d=Math.sin(i),p=Math.cos(i);return Math.log(d+p)-Math.log(p-d)}function l_(x,i,d,p){const _=x.lat+d*p;if(Math.abs(d)>1){const w=(Math.sign(x.lat+d)!==Math.sign(x.lat)?-Math.abs(x.lat):Math.abs(x.lat))*Math.PI/180,E=Math.abs(x.lat+d)*Math.PI/180,M=Fd(w+p*(E-w)),D=Fd(w),$=Fd(E);return new a.S(x.lng+i*((M-D)/($-D)),_)}return new a.S(x.lng+i*p,_)}class B1{constructor(i){this._cachePrevious=new Map,this._cache=new Map,this._hadAnyChanges=!1,this._boundingVolumeFactory=i}swapBuffers(){if(!this._hadAnyChanges)return;const i=this._cachePrevious;this._cachePrevious=this._cache,this._cache=i,this._cache.clear(),this._hadAnyChanges=!1}getTileBoundingVolume(i,d,p,_){const w=`${i.z}_${i.x}_${i.y}_${_!=null&&_.terrain?"t":""}`,E=this._cache.get(w);if(E)return E;const M=this._cachePrevious.get(w);if(M)return this._cache.set(w,M),M;const D=this._boundingVolumeFactory(i,d,p,_);return this._cache.set(w,D),this._hadAnyChanges=!0,D}}class Hn{constructor(i,d,p,_){this.min=p,this.max=_,this.points=i,this.planes=d}static fromAabb(i,d){const p=[];for(let _=0;_<8;_++)p.push([1&~_?i[0]:d[0],(_>>1&1)==1?d[1]:i[1],(_>>2&1)==1?d[2]:i[2]]);return new Hn(p,[[-1,0,0,d[0]],[1,0,0,-i[0]],[0,-1,0,d[1]],[0,1,0,-i[1]],[0,0,-1,d[2]],[0,0,1,-i[2]]],i,d)}static fromCenterSizeAngles(i,d,p){const _=a.br([],p[0],p[1],p[2]),w=a.bs([],[d[0],0,0],_),E=a.bs([],[0,d[1],0],_),M=a.bs([],[0,0,d[2]],_),D=[...i],$=[...i];for(let K=0;K<8;K++)for(let H=0;H<3;H++){const ee=i[H]+w[H]*(1&~K?-1:1)+E[H]*((K>>1&1)==1?1:-1)+M[H]*((K>>2&1)==1?1:-1);D[H]=Math.min(D[H],ee),$[H]=Math.max($[H],ee)}const U=[];for(let K=0;K<8;K++){const H=[...i];a.aS(H,H,a.aR([],w,1&~K?-1:1)),a.aS(H,H,a.aR([],E,(K>>1&1)==1?1:-1)),a.aS(H,H,a.aR([],M,(K>>2&1)==1?1:-1)),U.push(H)}return new Hn(U,[[...w,-a.aX(w,U[0])],[...E,-a.aX(E,U[0])],[...M,-a.aX(M,U[0])],[-w[0],-w[1],-w[2],-a.aX(w,U[7])],[-E[0],-E[1],-E[2],-a.aX(E,U[7])],[-M[0],-M[1],-M[2],-a.aX(M,U[7])]],D,$)}intersectsFrustum(i){let d=!0;const p=this.points.length,_=this.planes.length,w=i.planes.length,E=i.points.length;for(let M=0;M<w;M++){const D=i.planes[M];let $=0;for(let U=0;U<p;U++){const K=this.points[U];D[0]*K[0]+D[1]*K[1]+D[2]*K[2]+D[3]>=0&&$++}if($===0)return 0;$<p&&(d=!1)}if(d)return 2;for(let M=0;M<_;M++){const D=this.planes[M];let $=0;for(let U=0;U<E;U++){const K=i.points[U];D[0]*K[0]+D[1]*K[1]+D[2]*K[2]+D[3]>=0&&$++}if($===0)return 0}return 1}intersectsPlane(i){const d=this.points.length;let p=0;for(let _=0;_<d;_++){const w=this.points[_];i[0]*w[0]+i[1]*w[1]+i[2]*w[2]+i[3]>=0&&p++}return p===d?2:p===0?0:1}}function xc(x,i,d){const p=x-i;return p<0?-p:Math.max(0,p-d)}function zs(x,i,d,p,_){const w=x-d;let E;return E=w<0?Math.min(-w,1+w-_):w>1?Math.min(Math.max(w-_,0),1-w):0,Math.max(E,xc(i,p,_))}class Bd{constructor(){this._boundingVolumeCache=new B1(this._computeTileBoundingVolume)}prepareNextFrame(){this._boundingVolumeCache.swapBuffers()}distanceToTile2d(i,d,p,_){const w=1<<p.z,E=1/w,M=p.x/w,D=p.y/w;let $=2;return $=Math.min($,zs(i,d,M,D,E)),$=Math.min($,zs(i,d,M+.5,-D-E,E)),$=Math.min($,zs(i,d,M+.5,2-D-E,E)),$}getWrap(i,d,p){const _=1<<d.z,w=1/_,E=d.x/_,M=xc(i.x,E,w),D=xc(i.x,E-1,w),$=xc(i.x,E+1,w),U=Math.min(M,D,$);return U===$?1:U===D?-1:0}allowVariableZoom(i,d){return je(i,d)>4}allowWorldCopies(){return!1}getTileBoundingVolume(i,d,p,_){return this._boundingVolumeCache.getTileBoundingVolume(i,d,p,_)}_computeTileBoundingVolume(i,d,p,_){var w,E;let M=0,D=0;if(_!=null&&_.terrain){const $=new a.Z(i.z,d,i.z,i.x,i.y),U=_.terrain.getMinMaxElevation($);M=(w=U.minElevation)!==null&&w!==void 0?w:Math.min(0,p),D=(E=U.maxElevation)!==null&&E!==void 0?E:Math.max(0,p)}if(M/=a.bu,D/=a.bu,M+=1,D+=1,i.z<=0)return Hn.fromAabb([-D,-D,-D],[D,D,D]);if(i.z===1)return Hn.fromAabb([i.x===0?-D:0,i.y===0?0:-D,-D],[i.x===0?0:D,i.y===0?D:0,D]);{const $=[Do(0,0,i.x,i.y,i.z),Do(a.$,0,i.x,i.y,i.z),Do(a.$,a.$,i.x,i.y,i.z),Do(0,a.$,i.x,i.y,i.z)],U=[];for(const Ge of $)U.push(a.aR([],Ge,D));if(D!==M)for(const Ge of $)U.push(a.aR([],Ge,M));i.y===0&&U.push([0,1,0]),i.y===(1<<i.z)-1&&U.push([0,-1,0]);const K=[1,1,1],H=[-1,-1,-1];for(const Ge of U)for(let We=0;We<3;We++)K[We]=Math.min(K[We],Ge[We]),H[We]=Math.max(H[We],Ge[We]);const ee=Do(a.$/2,a.$/2,i.x,i.y,i.z),ae=a.aW([],[0,1,0],ee);a.aV(ae,ae);const me=a.aW([],ee,ae);a.aV(me,me);const ge=a.aW([],$[2],$[1]);a.aV(ge,ge);const _e=a.aW([],$[0],$[3]);a.aV(_e,_e),U.push(a.aR([],ee,D)),i.y>=(1<<i.z)/2&&U.push(a.aR([],Do(a.$/2,0,i.x,i.y,i.z),D)),i.y<(1<<i.z)/2&&U.push(a.aR([],Do(a.$/2,a.$,i.x,i.y,i.z),D));const Te=Lm(ee,U),Ce=Lm(me,U),Ee=[-ee[0],-ee[1],-ee[2],Te.max],Ie=[ee[0],ee[1],ee[2],-Te.min],Le=[-me[0],-me[1],-me[2],Ce.max],Pe=[me[0],me[1],me[2],-Ce.min],Ne=[...ge,0],qe=[..._e,0],Ve=[];return i.y===0?Ve.push(a.bt(qe,Ne,Ee),a.bt(qe,Ne,Ie)):Ve.push(a.bt(Le,Ne,Ee),a.bt(Le,Ne,Ie),a.bt(Le,qe,Ee),a.bt(Le,qe,Ie)),i.y===(1<<i.z)-1?Ve.push(a.bt(qe,Ne,Ee),a.bt(qe,Ne,Ie)):Ve.push(a.bt(Pe,Ne,Ee),a.bt(Pe,Ne,Ie),a.bt(Pe,qe,Ee),a.bt(Pe,qe,Ie)),new Hn(Ve,[Ee,Ie,Le,Pe,Ne,qe],K,H)}}}function Lm(x,i){let d=1/0,p=-1/0;for(const _ of i){const w=a.aX(x,_);d=Math.min(d,w),p=Math.max(p,w)}return{min:d,max:p}}class rh{get pixelsToClipSpaceMatrix(){return this._helper.pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._helper.clipSpaceToPixelsMatrix}get pixelsToGLUnits(){return this._helper.pixelsToGLUnits}get centerOffset(){return this._helper.centerOffset}get size(){return this._helper.size}get rotationMatrix(){return this._helper.rotationMatrix}get centerPoint(){return this._helper.centerPoint}get pixelsPerMeter(){return this._helper.pixelsPerMeter}setMinZoom(i){this._helper.setMinZoom(i)}setMaxZoom(i){this._helper.setMaxZoom(i)}setMinPitch(i){this._helper.setMinPitch(i)}setMaxPitch(i){this._helper.setMaxPitch(i)}setRenderWorldCopies(i){this._helper.setRenderWorldCopies(i)}setBearing(i){this._helper.setBearing(i)}setPitch(i){this._helper.setPitch(i)}setRoll(i){this._helper.setRoll(i)}setFov(i){this._helper.setFov(i)}setZoom(i){this._helper.setZoom(i)}setCenter(i){this._helper.setCenter(i)}setElevation(i){this._helper.setElevation(i)}setMinElevationForCurrentTile(i){this._helper.setMinElevationForCurrentTile(i)}setPadding(i){this._helper.setPadding(i)}interpolatePadding(i,d,p){return this._helper.interpolatePadding(i,d,p)}isPaddingEqual(i){return this._helper.isPaddingEqual(i)}resize(i,d){this._helper.resize(i,d)}getMaxBounds(){return this._helper.getMaxBounds()}setMaxBounds(i){this._helper.setMaxBounds(i)}overrideNearFarZ(i,d){this._helper.overrideNearFarZ(i,d)}clearNearFarZOverride(){this._helper.clearNearFarZOverride()}getCameraQueryGeometry(i){return this._helper.getCameraQueryGeometry(this.getCameraPoint(),i)}get tileSize(){return this._helper.tileSize}get tileZoom(){return this._helper.tileZoom}get scale(){return this._helper.scale}get worldSize(){return this._helper.worldSize}get width(){return this._helper.width}get height(){return this._helper.height}get lngRange(){return this._helper.lngRange}get latRange(){return this._helper.latRange}get minZoom(){return this._helper.minZoom}get maxZoom(){return this._helper.maxZoom}get zoom(){return this._helper.zoom}get center(){return this._helper.center}get minPitch(){return this._helper.minPitch}get maxPitch(){return this._helper.maxPitch}get pitch(){return this._helper.pitch}get pitchInRadians(){return this._helper.pitchInRadians}get roll(){return this._helper.roll}get rollInRadians(){return this._helper.rollInRadians}get bearing(){return this._helper.bearing}get bearingInRadians(){return this._helper.bearingInRadians}get fov(){return this._helper.fov}get fovInRadians(){return this._helper.fovInRadians}get elevation(){return this._helper.elevation}get minElevationForCurrentTile(){return this._helper.minElevationForCurrentTile}get padding(){return this._helper.padding}get unmodified(){return this._helper.unmodified}get renderWorldCopies(){return this._helper.renderWorldCopies}get nearZ(){return this._helper.nearZ}get farZ(){return this._helper.farZ}get autoCalculateNearFarZ(){return this._helper.autoCalculateNearFarZ}setTransitionState(i){}constructor(){this._cachedClippingPlane=a.bv(),this._projectionMatrix=a.b9(),this._globeViewProjMatrix32f=a.b8(),this._globeViewProjMatrixNoCorrection=a.b9(),this._globeViewProjMatrixNoCorrectionInverted=a.b9(),this._globeProjMatrixInverted=a.b9(),this._cameraPosition=a.bp(),this._globeLatitudeErrorCorrectionRadians=0,this._helper=new wi({calcMatrices:()=>{this._calcMatrices()},getConstrained:(i,d)=>this.getConstrained(i,d)}),this._coveringTilesDetailsProvider=new Bd}clone(){const i=new rh;return i.apply(this),i}apply(i,d){this._globeLatitudeErrorCorrectionRadians=d||0,this._helper.apply(i)}get projectionMatrix(){return this._projectionMatrix}get modelViewProjectionMatrix(){return this._globeViewProjMatrixNoCorrection}get inverseProjectionMatrix(){return this._globeProjMatrixInverted}get cameraPosition(){const i=a.bp();return i[0]=this._cameraPosition[0],i[1]=this._cameraPosition[1],i[2]=this._cameraPosition[2],i}get cameraToCenterDistance(){return this._helper.cameraToCenterDistance}getProjectionData(i){const{overscaledTileID:d,applyGlobeMatrix:p}=i,_=this._helper.getMercatorTileCoordinates(d);return{mainMatrix:this._globeViewProjMatrix32f,tileMercatorCoords:_,clippingPlane:this._cachedClippingPlane,projectionTransition:p?1:0,fallbackMatrix:this._globeViewProjMatrix32f}}_computeClippingPlane(i){const d=this.pitchInRadians,p=this.cameraToCenterDistance/i,_=Math.sin(d)*p,w=Math.cos(d)*p+1,E=1/Math.sqrt(_*_+w*w)*1;let M=-_,D=w;const $=Math.sqrt(M*M+D*D);M/=$,D/=$;const U=[0,M,D];a.bw(U,U,[0,0,0],-this.bearingInRadians),a.bx(U,U,[0,0,0],-1*this.center.lat*Math.PI/180),a.by(U,U,[0,0,0],this.center.lng*Math.PI/180);const K=1/a.aZ(U);return a.aR(U,U,K),[...U,-E*K]}isLocationOccluded(i){return!this.isSurfacePointVisible(ii(i))}transformLightDirection(i){const d=this._helper._center.lng*Math.PI/180,p=this._helper._center.lat*Math.PI/180,_=Math.cos(p),w=[Math.sin(d)*_,Math.sin(p),Math.cos(d)*_],E=[w[2],0,-w[0]],M=[0,0,0];a.aW(M,E,w),a.aV(E,E),a.aV(M,M);const D=[0,0,0];return a.aV(D,[E[0]*i[0]+M[0]*i[1]+w[0]*i[2],E[1]*i[0]+M[1]*i[1]+w[1]*i[2],E[2]*i[0]+M[2]*i[1]+w[2]*i[2]]),D}getPixelScale(){return 1/Math.cos(this._helper._center.lat*Math.PI/180)}getCircleRadiusCorrection(){return Math.cos(this._helper._center.lat*Math.PI/180)}getPitchedTextCorrection(i,d,p){const _=function(M,D,$){const U=1/(1<<$.z);return new a.a1(M/a.$*U+$.x*U,D/a.$*U+$.y*U)}(i,d,p.canonical),w=(E=_.y,[a.bo(_.x*Math.PI*2+Math.PI,2*Math.PI),2*Math.atan(Math.exp(Math.PI-E*Math.PI*2))-.5*Math.PI]);var E;return this.getCircleRadiusCorrection()/Math.cos(w[1])}projectTileCoordinates(i,d,p,_){const w=p.canonical,E=Do(i,d,w.x,w.y,w.z),M=1+(_?_(i,d):0)/a.bu,D=[E[0]*M,E[1]*M,E[2]*M,1];a.aw(D,D,this._globeViewProjMatrixNoCorrection);const $=this._cachedClippingPlane,U=$[0]*E[0]+$[1]*E[1]+$[2]*E[2]+$[3]<0;return{point:new a.P(D[0]/D[3],D[1]/D[3]),signedDistanceFromCamera:D[3],isOccluded:U}}_calcMatrices(){if(!this._helper._width||!this._helper._height)return;const i=wl(this.worldSize,this.center.lat),d=a.ba(),p=a.ba();this._helper.autoCalculateNearFarZ&&(this._helper._nearZ=.5,this._helper._farZ=this.cameraToCenterDistance+2*i),a.b4(d,this.fovInRadians,this.width/this.height,this._helper._nearZ,this._helper._farZ);const _=this.centerOffset;d[8]=2*-_.x/this._helper._width,d[9]=2*_.y/this._helper._height,this._projectionMatrix=a.b5(d),this._globeProjMatrixInverted=a.ba(),a.aq(this._globeProjMatrixInverted,d),a.M(d,d,[0,0,-this.cameraToCenterDistance]),a.b6(d,d,this.rollInRadians),a.b7(d,d,-this.pitchInRadians),a.b6(d,d,this.bearingInRadians),a.M(d,d,[0,0,-i]);const w=a.bp();w[0]=i,w[1]=i,w[2]=i,a.b7(p,d,this.center.lat*Math.PI/180),a.bz(p,p,-this.center.lng*Math.PI/180),a.N(p,p,w),this._globeViewProjMatrixNoCorrection=p,a.b7(d,d,this.center.lat*Math.PI/180-this._globeLatitudeErrorCorrectionRadians),a.bz(d,d,-this.center.lng*Math.PI/180),a.N(d,d,w),this._globeViewProjMatrix32f=new Float32Array(d),this._globeViewProjMatrixNoCorrectionInverted=a.ba(),a.aq(this._globeViewProjMatrixNoCorrectionInverted,p);const E=a.bp();this._cameraPosition=a.bp(),this._cameraPosition[2]=this.cameraToCenterDistance/i,a.bw(this._cameraPosition,this._cameraPosition,E,-this.rollInRadians),a.bx(this._cameraPosition,this._cameraPosition,E,this.pitchInRadians),a.bw(this._cameraPosition,this._cameraPosition,E,-this.bearingInRadians),a.aS(this._cameraPosition,this._cameraPosition,[0,0,1]),a.bx(this._cameraPosition,this._cameraPosition,E,-this.center.lat*Math.PI/180),a.by(this._cameraPosition,this._cameraPosition,E,this.center.lng*Math.PI/180),this._cachedClippingPlane=this._computeClippingPlane(i);const M=a.b5(this._globeViewProjMatrixNoCorrectionInverted);a.N(M,M,[1,1,-1]),this._cachedFrustum=qr.fromInvProjectionMatrix(M,1,0,this._cachedClippingPlane,!0)}calculateFogMatrix(i){a.w("calculateFogMatrix is not supported on globe projection.");const d=a.ba();return a.ag(d),d}getVisibleUnwrappedCoordinates(i){return[new a.b2(0,i)]}getCameraFrustum(){return this._cachedFrustum}getClippingPlane(){return this._cachedClippingPlane}getCoveringTilesDetailsProvider(){return this._coveringTilesDetailsProvider}recalculateZoomAndCenter(i){i&&a.w("terrain is not fully supported on vertical perspective projection."),this._helper.recalculateZoomAndCenter(0)}maxPitchScaleFactor(){return 1}getCameraPoint(){return this._helper.getCameraPoint()}getCameraAltitude(){return this._helper.getCameraAltitude()}getCameraLngLat(){return this._helper.getCameraLngLat()}lngLatToCameraDepth(i,d){if(!this._globeViewProjMatrixNoCorrection)return 1;const p=ii(i);a.aR(p,p,1+d/a.bu);const _=a.bv();return a.aw(_,[p[0],p[1],p[2],1],this._globeViewProjMatrixNoCorrection),_[2]/_[3]}populateCache(i){}getBounds(){const i=.5*this.width,d=.5*this.height,p=[new a.P(0,0),new a.P(i,0),new a.P(this.width,0),new a.P(this.width,d),new a.P(this.width,this.height),new a.P(i,this.height),new a.P(0,this.height),new a.P(0,d)],_=[];for(const K of p)_.push(this.unprojectScreenPoint(K));let w=0,E=0,M=0,D=0;const $=this.center;for(const K of _){const H=a.bA($.lng,K.lng),ee=a.bA($.lat,K.lat);H<E&&(E=H),H>w&&(w=H),ee<D&&(D=ee),ee>M&&(M=ee)}const U=[$.lng+E,$.lat+D,$.lng+w,$.lat+M];return this.isSurfacePointOnScreen([0,1,0])&&(U[3]=90,U[0]=-180,U[2]=180),this.isSurfacePointOnScreen([0,-1,0])&&(U[1]=-90,U[0]=-180,U[2]=180),new Et(U)}getConstrained(i,d){const p=a.ah(i.lat,-a.ai,a.ai),_=a.ah(+d,this.minZoom+si(0,p),this.maxZoom);return{center:new a.S(i.lng,p),zoom:_}}calculateCenterFromCameraLngLatAlt(i,d,p,_){return this._helper.calculateCenterFromCameraLngLatAlt(i,d,p,_)}setLocationAtPoint(i,d){const p=ii(this.unprojectScreenPoint(d)),_=ii(i),w=a.bp();a.bB(w);const E=a.bp();a.by(E,p,w,-this.center.lng*Math.PI/180),a.bx(E,E,w,this.center.lat*Math.PI/180);const M=_[0]*_[0]+_[2]*_[2],D=E[0]*E[0];if(M<D)return;const $=Math.sqrt(M-D),U=-$,K=a.bC(_[0],_[2],E[0],$),H=a.bC(_[0],_[2],E[0],U),ee=a.bp();a.by(ee,_,w,-K);const ae=a.bC(ee[1],ee[2],E[1],E[2]),me=a.bp();a.by(me,_,w,-H);const ge=a.bC(me[1],me[2],E[1],E[2]),_e=.5*Math.PI,Te=ae>=-_e&&ae<=_e,Ce=ge>=-_e&&ge<=_e;let Ee,Ie;if(Te&&Ce){const qe=this.center.lng*Math.PI/180,Ve=this.center.lat*Math.PI/180;a.bD(K,qe)+a.bD(ae,Ve)<a.bD(H,qe)+a.bD(ge,Ve)?(Ee=K,Ie=ae):(Ee=H,Ie=ge)}else if(Te)Ee=K,Ie=ae;else{if(!Ce)return;Ee=H,Ie=ge}const Le=Ee/Math.PI*180,Pe=Ie/Math.PI*180,Ne=this.center.lat;this.setCenter(new a.S(Le,a.ah(Pe,-90,90))),this.setZoom(this.zoom+si(Ne,this.center.lat))}locationToScreenPoint(i,d){const p=ii(i);if(d){const _=d.getElevationForLngLatZoom(i,this._helper._tileZoom);a.aR(p,p,1+_/a.bu)}return this._projectSurfacePointToScreen(p)}_projectSurfacePointToScreen(i){const d=a.bv();return a.aw(d,[...i,1],this._globeViewProjMatrixNoCorrection),d[0]/=d[3],d[1]/=d[3],new a.P((.5*d[0]+.5)*this.width,(.5*-d[1]+.5)*this.height)}screenPointToMercatorCoordinate(i,d){if(d){const p=d.pointCoordinate(i);if(p)return p}return a.a1.fromLngLat(this.unprojectScreenPoint(i))}screenPointToLocation(i,d){var p;return(p=this.screenPointToMercatorCoordinate(i,d))===null||p===void 0?void 0:p.toLngLat()}isPointOnMapSurface(i,d){const p=this._cameraPosition,_=this.getRayDirectionFromPixel(i);return!!this.rayPlanetIntersection(p,_)}getRayDirectionFromPixel(i){const d=a.bv();d[0]=i.x/this.width*2-1,d[1]=-1*(i.y/this.height*2-1),d[2]=1,d[3]=1,a.aw(d,d,this._globeViewProjMatrixNoCorrectionInverted),d[0]/=d[3],d[1]/=d[3],d[2]/=d[3];const p=a.bp();p[0]=d[0]-this._cameraPosition[0],p[1]=d[1]-this._cameraPosition[1],p[2]=d[2]-this._cameraPosition[2];const _=a.bp();return a.aV(_,p),_}isSurfacePointVisible(i){const d=this._cachedClippingPlane;return d[0]*i[0]+d[1]*i[1]+d[2]*i[2]+d[3]>=0}isSurfacePointOnScreen(i){if(!this.isSurfacePointVisible(i))return!1;const d=a.bv();return a.aw(d,[...i,1],this._globeViewProjMatrixNoCorrection),d[0]/=d[3],d[1]/=d[3],d[2]/=d[3],d[0]>-1&&d[0]<1&&d[1]>-1&&d[1]<1&&d[2]>-1&&d[2]<1}rayPlanetIntersection(i,d){const p=a.aX(i,d),_=a.bp(),w=a.bp();a.aR(w,d,p),a.aU(_,i,w);const E=1-a.aX(_,_);if(E<0)return null;const M=a.aX(i,i)-1,D=-p+(p<0?1:-1)*Math.sqrt(E),$=M/D,U=D;return{tMin:Math.min($,U),tMax:Math.max($,U)}}unprojectScreenPoint(i){const d=this._cameraPosition,p=this.getRayDirectionFromPixel(i),_=this.rayPlanetIntersection(d,p);if(_){const U=a.bp();a.aS(U,d,[p[0]*_.tMin,p[1]*_.tMin,p[2]*_.tMin]);const K=a.bp();return a.aV(K,U),th(K)}const w=this._cachedClippingPlane,E=w[0]*p[0]+w[1]*p[1]+w[2]*p[2],M=-a.b1(w,d)/E,D=a.bp();if(M>0)a.aS(D,d,[p[0]*M,p[1]*M,p[2]*M]);else{const U=a.bp();a.aS(U,d,[2*p[0],2*p[1],2*p[2]]);const K=a.b1(this._cachedClippingPlane,U);a.aU(D,U,[this._cachedClippingPlane[0]*K,this._cachedClippingPlane[1]*K,this._cachedClippingPlane[2]*K])}const $=function(U){const K=a.bp();return K[0]=U[0]*-U[3],K[1]=U[1]*-U[3],K[2]=U[2]*-U[3],{center:K,radius:Math.sqrt(1-U[3]*U[3])}}(w);return th(function(U,K,H){const ee=a.bp();a.aU(ee,H,U);const ae=a.bp();return a.bq(ae,U,ee,K/a.a$(ee)),ae}($.center,$.radius,D))}getMatrixForModel(i,d){const p=a.S.convert(i),_=1/a.bu,w=a.b9();return a.bz(w,w,p.lng/180*Math.PI),a.b7(w,w,-p.lat/180*Math.PI),a.M(w,w,[0,0,1+d/a.bu]),a.b7(w,w,.5*Math.PI),a.N(w,w,[_,_,_]),w}getProjectionDataForCustomLayer(i=!0){const d=this.getProjectionData({overscaledTileID:new a.Z(0,0,0,0,0),applyGlobeMatrix:i});return d.tileMercatorCoords=[0,0,1,1],d}getFastPathSimpleProjectionMatrix(i){}}class ra{get pixelsToClipSpaceMatrix(){return this._helper.pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._helper.clipSpaceToPixelsMatrix}get pixelsToGLUnits(){return this._helper.pixelsToGLUnits}get centerOffset(){return this._helper.centerOffset}get size(){return this._helper.size}get rotationMatrix(){return this._helper.rotationMatrix}get centerPoint(){return this._helper.centerPoint}get pixelsPerMeter(){return this._helper.pixelsPerMeter}setMinZoom(i){this._helper.setMinZoom(i)}setMaxZoom(i){this._helper.setMaxZoom(i)}setMinPitch(i){this._helper.setMinPitch(i)}setMaxPitch(i){this._helper.setMaxPitch(i)}setRenderWorldCopies(i){this._helper.setRenderWorldCopies(i)}setBearing(i){this._helper.setBearing(i)}setPitch(i){this._helper.setPitch(i)}setRoll(i){this._helper.setRoll(i)}setFov(i){this._helper.setFov(i)}setZoom(i){this._helper.setZoom(i)}setCenter(i){this._helper.setCenter(i)}setElevation(i){this._helper.setElevation(i)}setMinElevationForCurrentTile(i){this._helper.setMinElevationForCurrentTile(i)}setPadding(i){this._helper.setPadding(i)}interpolatePadding(i,d,p){return this._helper.interpolatePadding(i,d,p)}isPaddingEqual(i){return this._helper.isPaddingEqual(i)}resize(i,d,p=!0){this._helper.resize(i,d,p)}getMaxBounds(){return this._helper.getMaxBounds()}setMaxBounds(i){this._helper.setMaxBounds(i)}overrideNearFarZ(i,d){this._helper.overrideNearFarZ(i,d)}clearNearFarZOverride(){this._helper.clearNearFarZOverride()}getCameraQueryGeometry(i){return this._helper.getCameraQueryGeometry(this.getCameraPoint(),i)}get tileSize(){return this._helper.tileSize}get tileZoom(){return this._helper.tileZoom}get scale(){return this._helper.scale}get worldSize(){return this._helper.worldSize}get width(){return this._helper.width}get height(){return this._helper.height}get lngRange(){return this._helper.lngRange}get latRange(){return this._helper.latRange}get minZoom(){return this._helper.minZoom}get maxZoom(){return this._helper.maxZoom}get zoom(){return this._helper.zoom}get center(){return this._helper.center}get minPitch(){return this._helper.minPitch}get maxPitch(){return this._helper.maxPitch}get pitch(){return this._helper.pitch}get pitchInRadians(){return this._helper.pitchInRadians}get roll(){return this._helper.roll}get rollInRadians(){return this._helper.rollInRadians}get bearing(){return this._helper.bearing}get bearingInRadians(){return this._helper.bearingInRadians}get fov(){return this._helper.fov}get fovInRadians(){return this._helper.fovInRadians}get elevation(){return this._helper.elevation}get minElevationForCurrentTile(){return this._helper.minElevationForCurrentTile}get padding(){return this._helper.padding}get unmodified(){return this._helper.unmodified}get renderWorldCopies(){return this._helper.renderWorldCopies}get cameraToCenterDistance(){return this._helper.cameraToCenterDistance}get nearZ(){return this._helper.nearZ}get farZ(){return this._helper.farZ}get autoCalculateNearFarZ(){return this._helper.autoCalculateNearFarZ}get isGlobeRendering(){return this._globeness>0}setTransitionState(i,d){this._globeness=i,this._globeLatitudeErrorCorrectionRadians=d,this._calcMatrices(),this._verticalPerspectiveTransform.getCoveringTilesDetailsProvider().prepareNextFrame(),this._mercatorTransform.getCoveringTilesDetailsProvider().prepareNextFrame()}get currentTransform(){return this.isGlobeRendering?this._verticalPerspectiveTransform:this._mercatorTransform}constructor(){this._globeLatitudeErrorCorrectionRadians=0,this._globeness=1,this._helper=new wi({calcMatrices:()=>{this._calcMatrices()},getConstrained:(i,d)=>this.getConstrained(i,d)}),this._globeness=1,this._mercatorTransform=new yc,this._verticalPerspectiveTransform=new rh}clone(){const i=new ra;return i._globeness=this._globeness,i._globeLatitudeErrorCorrectionRadians=this._globeLatitudeErrorCorrectionRadians,i.apply(this),i}apply(i){this._helper.apply(i),this._mercatorTransform.apply(this),this._verticalPerspectiveTransform.apply(this,this._globeLatitudeErrorCorrectionRadians)}get projectionMatrix(){return this.currentTransform.projectionMatrix}get modelViewProjectionMatrix(){return this.currentTransform.modelViewProjectionMatrix}get inverseProjectionMatrix(){return this.currentTransform.inverseProjectionMatrix}get cameraPosition(){return this.currentTransform.cameraPosition}getProjectionData(i){const d=this._mercatorTransform.getProjectionData(i),p=this._verticalPerspectiveTransform.getProjectionData(i);return{mainMatrix:this.isGlobeRendering?p.mainMatrix:d.mainMatrix,clippingPlane:p.clippingPlane,tileMercatorCoords:p.tileMercatorCoords,projectionTransition:i.applyGlobeMatrix?this._globeness:0,fallbackMatrix:d.fallbackMatrix}}isLocationOccluded(i){return this.currentTransform.isLocationOccluded(i)}transformLightDirection(i){return this.currentTransform.transformLightDirection(i)}getPixelScale(){return a.bk(this._mercatorTransform.getPixelScale(),this._verticalPerspectiveTransform.getPixelScale(),this._globeness)}getCircleRadiusCorrection(){return a.bk(this._mercatorTransform.getCircleRadiusCorrection(),this._verticalPerspectiveTransform.getCircleRadiusCorrection(),this._globeness)}getPitchedTextCorrection(i,d,p){const _=this._mercatorTransform.getPitchedTextCorrection(i,d,p),w=this._verticalPerspectiveTransform.getPitchedTextCorrection(i,d,p);return a.bk(_,w,this._globeness)}projectTileCoordinates(i,d,p,_){return this.currentTransform.projectTileCoordinates(i,d,p,_)}_calcMatrices(){this._helper._width&&this._helper._height&&(this._verticalPerspectiveTransform.apply(this,this._globeLatitudeErrorCorrectionRadians),this._helper._nearZ=this._verticalPerspectiveTransform.nearZ,this._helper._farZ=this._verticalPerspectiveTransform.farZ,this._mercatorTransform.apply(this,!0,this.isGlobeRendering),this._helper._nearZ=this._mercatorTransform.nearZ,this._helper._farZ=this._mercatorTransform.farZ)}calculateFogMatrix(i){return this.currentTransform.calculateFogMatrix(i)}getVisibleUnwrappedCoordinates(i){return this.currentTransform.getVisibleUnwrappedCoordinates(i)}getCameraFrustum(){return this.currentTransform.getCameraFrustum()}getClippingPlane(){return this.currentTransform.getClippingPlane()}getCoveringTilesDetailsProvider(){return this.currentTransform.getCoveringTilesDetailsProvider()}recalculateZoomAndCenter(i){this._mercatorTransform.recalculateZoomAndCenter(i),this._verticalPerspectiveTransform.recalculateZoomAndCenter(i)}maxPitchScaleFactor(){return this._mercatorTransform.maxPitchScaleFactor()}getCameraPoint(){return this._helper.getCameraPoint()}getCameraAltitude(){return this._helper.getCameraAltitude()}getCameraLngLat(){return this._helper.getCameraLngLat()}lngLatToCameraDepth(i,d){return this.currentTransform.lngLatToCameraDepth(i,d)}populateCache(i){this._mercatorTransform.populateCache(i),this._verticalPerspectiveTransform.populateCache(i)}getBounds(){return this.currentTransform.getBounds()}getConstrained(i,d){return this.currentTransform.getConstrained(i,d)}calculateCenterFromCameraLngLatAlt(i,d,p,_){return this._helper.calculateCenterFromCameraLngLatAlt(i,d,p,_)}setLocationAtPoint(i,d){if(!this.isGlobeRendering)return this._mercatorTransform.setLocationAtPoint(i,d),void this.apply(this._mercatorTransform);this._verticalPerspectiveTransform.setLocationAtPoint(i,d),this.apply(this._verticalPerspectiveTransform)}locationToScreenPoint(i,d){return this.currentTransform.locationToScreenPoint(i,d)}screenPointToMercatorCoordinate(i,d){return this.currentTransform.screenPointToMercatorCoordinate(i,d)}screenPointToLocation(i,d){return this.currentTransform.screenPointToLocation(i,d)}isPointOnMapSurface(i,d){return this.currentTransform.isPointOnMapSurface(i,d)}getRayDirectionFromPixel(i){return this._verticalPerspectiveTransform.getRayDirectionFromPixel(i)}getMatrixForModel(i,d){return this.currentTransform.getMatrixForModel(i,d)}getProjectionDataForCustomLayer(i=!0){const d=this._mercatorTransform.getProjectionDataForCustomLayer(i);if(!this.isGlobeRendering)return d;const p=this._verticalPerspectiveTransform.getProjectionDataForCustomLayer(i);return p.fallbackMatrix=d.mainMatrix,p}getFastPathSimpleProjectionMatrix(i){return this.currentTransform.getFastPathSimpleProjectionMatrix(i)}}class io{get useGlobeControls(){return!0}handlePanInertia(i,d){const p=jd(i,d);return Math.abs(p.lng-d.center.lng)>180&&(p.lng=d.center.lng+179.5*Math.sign(p.lng-d.center.lng)),{easingCenter:p,easingOffset:new a.P(0,0)}}handleMapControlsRollPitchBearingZoom(i,d){const p=i.around,_=d.screenPointToLocation(p);i.bearingDelta&&d.setBearing(d.bearing+i.bearingDelta),i.pitchDelta&&d.setPitch(d.pitch+i.pitchDelta),i.rollDelta&&d.setRoll(d.roll+i.rollDelta);const w=d.zoom;i.zoomDelta&&d.setZoom(d.zoom+i.zoomDelta);const E=d.zoom-w;if(E===0)return;const M=a.bA(d.center.lng,_.lng),D=M/(Math.abs(M/180)+1),$=a.bA(d.center.lat,_.lat),U=d.getRayDirectionFromPixel(p),K=d.cameraPosition,H=-1*a.aX(K,U),ee=a.bp();a.aS(ee,K,[U[0]*H,U[1]*H,U[2]*H]);const ae=a.aZ(ee)-1,me=Math.exp(.5*-Math.max(ae-.3,0)),ge=wl(d.worldSize,d.center.lat)/Math.min(d.width,d.height),_e=a.bn(ge,.9,.5,1,.25),Te=(1-a.af(-E))*Math.min(me,_e),Ce=d.center.lat,Ee=d.zoom,Ie=new a.S(d.center.lng+D*Te,a.ah(d.center.lat+$*Te,-a.ai,a.ai));d.setLocationAtPoint(_,p);const Le=d.center,Pe=a.bn(Math.abs(M),45,85,0,1),Ne=a.bn(ge,.75,.35,0,1),qe=Math.pow(Math.max(Pe,Ne),.25),Ve=a.bA(Le.lng,Ie.lng),Ge=a.bA(Le.lat,Ie.lat);d.setCenter(new a.S(Le.lng+Ve*qe,Le.lat+Ge*qe).wrap()),d.setZoom(Ee+si(Ce,d.center.lat))}handleMapControlsPan(i,d,p){if(!i.panDelta)return;const _=d.center.lat,w=d.zoom;d.setCenter(jd(i.panDelta,d).wrap()),d.setZoom(w+si(_,d.center.lat))}cameraForBoxAndBearing(i,d,p,_,w){const E=ns(i,d,p,_,w),M=d.left/w.width*2-1,D=(w.width-d.right)/w.width*2-1,$=d.top/w.height*-2+1,U=(w.height-d.bottom)/w.height*-2+1,K=a.bA(p.getWest(),p.getEast())<0,H=K?p.getEast():p.getWest(),ee=K?p.getWest():p.getEast(),ae=Math.max(p.getNorth(),p.getSouth()),me=Math.min(p.getNorth(),p.getSouth()),ge=H+.5*a.bA(H,ee),_e=ae+.5*a.bA(ae,me),Te=w.clone();Te.setCenter(E.center),Te.setBearing(E.bearing),Te.setPitch(0),Te.setRoll(0),Te.setZoom(E.zoom);const Ce=Te.modelViewProjectionMatrix,Ee=[ii(p.getNorthWest()),ii(p.getNorthEast()),ii(p.getSouthWest()),ii(p.getSouthEast()),ii(new a.S(ee,_e)),ii(new a.S(H,_e)),ii(new a.S(ge,ae)),ii(new a.S(ge,me))],Ie=ii(E.center);let Le=Number.POSITIVE_INFINITY;for(const Pe of Ee)M<0&&(Le=io.getLesserNonNegativeNonNull(Le,io.solveVectorScale(Pe,Ie,Ce,"x",M))),D>0&&(Le=io.getLesserNonNegativeNonNull(Le,io.solveVectorScale(Pe,Ie,Ce,"x",D))),$>0&&(Le=io.getLesserNonNegativeNonNull(Le,io.solveVectorScale(Pe,Ie,Ce,"y",$))),U<0&&(Le=io.getLesserNonNegativeNonNull(Le,io.solveVectorScale(Pe,Ie,Ce,"y",U)));if(Number.isFinite(Le)&&Le!==0)return E.zoom=Te.zoom+a.ak(Le),E;qi()}handleJumpToCenterZoom(i,d){const p=i.center.lat,_=i.getConstrained(d.center?a.S.convert(d.center):i.center,i.zoom).center;i.setCenter(_.wrap());const w=d.zoom!==void 0?+d.zoom:i.zoom+si(p,_.lat);i.zoom!==w&&i.setZoom(w)}handleEaseTo(i,d){const p=i.zoom,_=i.center,w=i.padding,E={roll:i.roll,pitch:i.pitch,bearing:i.bearing},M={roll:d.roll===void 0?i.roll:d.roll,pitch:d.pitch===void 0?i.pitch:d.pitch,bearing:d.bearing===void 0?i.bearing:d.bearing},D=d.zoom!==void 0,$=!i.isPaddingEqual(d.padding);let U=!1;const K=d.center?a.S.convert(d.center):_,H=i.getConstrained(K,p).center;gc(i,H);const ee=i.clone();ee.setCenter(H),ee.setZoom(D?+d.zoom:p+si(_.lat,K.lat)),ee.setBearing(d.bearing);const ae=new a.P(a.ah(i.centerPoint.x+d.offsetAsPoint.x,0,i.width),a.ah(i.centerPoint.y+d.offsetAsPoint.y,0,i.height));ee.setLocationAtPoint(H,ae);const me=(d.offset&&d.offsetAsPoint.mag())>0?ee.center:H,ge=D?+d.zoom:p+si(_.lat,me.lat),_e=p+si(_.lat,0),Te=ge+si(me.lat,0),Ce=a.bA(_.lng,me.lng),Ee=a.bA(_.lat,me.lat),Ie=a.af(Te-_e);return U=ge!==p,{easeFunc:Le=>{if(a.be(E,M)||_s({startEulerAngles:E,endEulerAngles:M,tr:i,k:Le,useSlerp:E.roll!=M.roll}),$&&i.interpolatePadding(w,d.padding,Le),d.around)a.w("Easing around a point is not supported under globe projection."),i.setLocationAtPoint(d.around,d.aroundPoint);else{const Pe=Te>_e?Math.min(2,Ie):Math.max(.5,Ie),Ne=Math.pow(Pe,1-Le),qe=l_(_,Ce,Ee,Le*Ne);i.setCenter(qe.wrap())}if(U){const Pe=a.C.number(_e,Te,Le)+si(0,i.center.lat);i.setZoom(Pe)}},isZooming:U,elevationCenter:me}}handleFlyTo(i,d){const p=d.zoom!==void 0,_=i.center,w=i.zoom,E=i.padding,M=!i.isPaddingEqual(d.padding),D=i.getConstrained(a.S.convert(d.center||d.locationAtOffset),w).center,$=p?+d.zoom:i.zoom+si(i.center.lat,D.lat),U=i.clone();U.setCenter(D),U.setZoom($),U.setBearing(d.bearing);const K=new a.P(a.ah(i.centerPoint.x+d.offsetAsPoint.x,0,i.width),a.ah(i.centerPoint.y+d.offsetAsPoint.y,0,i.height));U.setLocationAtPoint(D,K);const H=U.center;gc(i,H);const ee=function(Ee,Ie,Le){const Pe=ii(Ie),Ne=ii(Le),qe=a.aX(Pe,Ne),Ve=Math.acos(qe),Ge=eh(Ee);return Ve/(2*Math.PI)*Ge}(i,_,H),ae=w+si(_.lat,0),me=$+si(H.lat,0),ge=a.af(me-ae);let _e;if(typeof d.minZoom=="number"){const Ee=+d.minZoom+si(H.lat,0),Ie=Math.min(Ee,ae,me)+si(0,H.lat),Le=i.getConstrained(H,Ie).zoom+si(H.lat,0);_e=a.af(Le-ae)}const Te=a.bA(_.lng,H.lng),Ce=a.bA(_.lat,H.lat);return{easeFunc:(Ee,Ie,Le,Pe)=>{const Ne=l_(_,Te,Ce,Le);M&&i.interpolatePadding(E,d.padding,Ee);const qe=Ee===1?H:Ne;i.setCenter(qe.wrap());const Ve=ae+a.ak(Ie);i.setZoom(Ee===1?$:Ve+si(0,qe.lat))},scaleOfZoom:ge,targetCenter:H,scaleOfMinZoom:_e,pixelPathLength:ee}}static solveVectorScale(i,d,p,_,w){const E=_==="x"?[p[0],p[4],p[8],p[12]]:[p[1],p[5],p[9],p[13]],M=[p[3],p[7],p[11],p[15]],D=i[0]*E[0]+i[1]*E[1]+i[2]*E[2],$=i[0]*M[0]+i[1]*M[1]+i[2]*M[2],U=d[0]*E[0]+d[1]*E[1]+d[2]*E[2],K=d[0]*M[0]+d[1]*M[1]+d[2]*M[2];return U+w*$===D+w*K||M[3]*(D-U)+E[3]*(K-$)+D*K==U*$?null:(U+E[3]-w*K-w*M[3])/(U-D-w*K+w*$)}static getLesserNonNegativeNonNull(i,d){return d!==null&&d>=0&&d<i?d:i}}class c_{constructor(i){this._globe=i,this._mercatorCameraHelper=new Xu,this._verticalPerspectiveCameraHelper=new io}get useGlobeControls(){return this._globe.useGlobeRendering}get currentHelper(){return this.useGlobeControls?this._verticalPerspectiveCameraHelper:this._mercatorCameraHelper}handlePanInertia(i,d){return this.currentHelper.handlePanInertia(i,d)}handleMapControlsRollPitchBearingZoom(i,d){return this.currentHelper.handleMapControlsRollPitchBearingZoom(i,d)}handleMapControlsPan(i,d,p){this.currentHelper.handleMapControlsPan(i,d,p)}cameraForBoxAndBearing(i,d,p,_,w){return this.currentHelper.cameraForBoxAndBearing(i,d,p,_,w)}handleJumpToCenterZoom(i,d){this.currentHelper.handleJumpToCenterZoom(i,d)}handleEaseTo(i,d){return this.currentHelper.handleEaseTo(i,d)}handleFlyTo(i,d){return this.currentHelper.handleFlyTo(i,d)}}const $d=(x,i)=>a.y(x,i&&i.filter(d=>d.identifier!=="source.canvas")),$1=a.bE();class Om extends a.E{constructor(i,d={}){var p,_;super(),this._rtlPluginLoaded=()=>{for(const E in this.sourceCaches){const M=this.sourceCaches[E].getSource().type;M!=="vector"&&M!=="geojson"||this.sourceCaches[E].reload()}},this.map=i,this.dispatcher=new Ct(_t(),i._getMapId()),this.dispatcher.registerMessageHandler("GG",(E,M)=>this.getGlyphs(E,M)),this.dispatcher.registerMessageHandler("GI",(E,M)=>this.getImages(E,M)),this.dispatcher.registerMessageHandler("GDA",(E,M)=>this.getDashes(E,M)),this.imageManager=new q,this.imageManager.setEventedParent(this);const w=((p=i._container)===null||p===void 0?void 0:p.lang)||typeof document<"u"&&((_=document.documentElement)===null||_===void 0?void 0:_.lang)||void 0;this.glyphManager=new ue(i._requestManager,d.localIdeographFontFamily,w),this.lineAtlas=new ve(256,512),this.crossTileSymbolIndex=new Hu,this._spritesImagesIds={},this._layers={},this._order=[],this.sourceCaches={},this.zoomHistory=new a.bF,this._loaded=!1,this._availableImages=[],this._globalState={},this._resetUpdates(),this.dispatcher.broadcast("SR",a.bG()),Sn().on(Zt,this._rtlPluginLoaded),this.on("data",E=>{if(E.dataType!=="source"||E.sourceDataType!=="metadata")return;const M=this.sourceCaches[E.sourceId];if(!M)return;const D=M.getSource();if(D&&D.vectorLayerIds)for(const $ in this._layers){const U=this._layers[$];U.source===D.id&&this._validateLayer(U)}})}setGlobalStateProperty(i,d){var p,_,w;this._checkLoaded();const E=d===null?(w=(_=(p=this.stylesheet.state)===null||p===void 0?void 0:p[i])===null||_===void 0?void 0:_.default)!==null&&w!==void 0?w:null:d;if(a.bH(E,this._globalState[i]))return this;this._globalState[i]=E,this._applyGlobalStateChanges([i])}getGlobalState(){return this._globalState}setGlobalState(i){this._checkLoaded();const d=[];for(const p in i)!a.bH(this._globalState[p],i[p].default)&&(d.push(p),this._globalState[p]=i[p].default);this._applyGlobalStateChanges(d)}_applyGlobalStateChanges(i){if(i.length===0)return;const d=new Set,p={};for(const _ of i){p[_]=this._globalState[_];for(const w in this._layers){const E=this._layers[w],M=E.getLayoutAffectingGlobalStateRefs(),D=E.getPaintAffectingGlobalStateRefs();if(M.has(_)&&d.add(E.source),D.has(_))for(const{name:$,value:U}of D.get(_))this._updatePaintProperty(E,$,U)}}this.dispatcher.broadcast("UGS",p);for(const _ in this.sourceCaches)d.has(_)&&(this._reloadSource(_),this._changed=!0)}loadURL(i,d={},p){this.fire(new a.l("dataloading",{dataType:"style"})),d.validate=typeof d.validate!="boolean"||d.validate;const _=this.map._requestManager.transformRequest(i,"Style");this._loadStyleRequest=new AbortController;const w=this._loadStyleRequest;a.j(_,this._loadStyleRequest).then(E=>{this._loadStyleRequest=null,this._load(E.data,d,p)}).catch(E=>{this._loadStyleRequest=null,E&&!w.signal.aborted&&this.fire(new a.k(E))})}loadJSON(i,d={},p){this.fire(new a.l("dataloading",{dataType:"style"})),this._frameRequest=new AbortController,P.frameAsync(this._frameRequest).then(()=>{this._frameRequest=null,d.validate=d.validate!==!1,this._load(i,d,p)}).catch(()=>{})}loadEmpty(){this.fire(new a.l("dataloading",{dataType:"style"})),this._load($1,{validate:!1})}_load(i,d,p){var _,w;let E=d.transformStyle?d.transformStyle(p,i):i;if(!d.validate||!$d(this,a.z(E))){E=Object.assign({},E),this._loaded=!0,this.stylesheet=E;for(const M in E.sources)this.addSource(M,E.sources[M],{validate:!1});E.sprite?this._loadSprite(E.sprite):this.imageManager.setLoaded(!0),this.glyphManager.setURL(E.glyphs),this._createLayers(),this.light=new xe(this.stylesheet.light),this._setProjectionInternal(((_=this.stylesheet.projection)===null||_===void 0?void 0:_.type)||"mercator"),this.sky=new fe(this.stylesheet.sky),this.map.setTerrain((w=this.stylesheet.terrain)!==null&&w!==void 0?w:null),this.fire(new a.l("data",{dataType:"style"})),this.fire(new a.l("style.load"))}}_createLayers(){var i,d,p;const _=a.bI(this.stylesheet.layers);this.setGlobalState((i=this.stylesheet.state)!==null&&i!==void 0?i:null),this.dispatcher.broadcast("SL",_),this._order=_.map(w=>w.id),this._layers={},this._serializedLayers=null;for(const w of _){const E=a.bJ(w,this._globalState);if(E.setEventedParent(this,{layer:{id:w.id}}),this._layers[w.id]=E,a.bK(E)&&this.sourceCaches[E.source]){const M=(p=(d=w.paint)===null||d===void 0?void 0:d["raster-fade-duration"])!==null&&p!==void 0?p:E.paint.get("raster-fade-duration");this.sourceCaches[E.source].setRasterFadeDuration(M)}}}_loadSprite(i,d=!1,p=void 0){let _;this.imageManager.setLoaded(!1),this._spriteRequest=new AbortController,function(w,E,M,D){return a._(this,void 0,void 0,function*(){const $=te(w),U=M>1?"@2x":"",K={},H={};for(const{id:ee,url:ae}of $){const me=E.transformRequest(ie(ae,U,".json"),"SpriteJSON");K[ee]=a.j(me,D);const ge=E.transformRequest(ie(ae,U,".png"),"SpriteImage");H[ee]=W.getImage(ge,D)}return yield Promise.all([...Object.values(K),...Object.values(H)]),function(ee,ae){return a._(this,void 0,void 0,function*(){const me={};for(const ge in ee){me[ge]={};const _e=P.getImageCanvasContext((yield ae[ge]).data),Te=(yield ee[ge]).data;for(const Ce in Te){const{width:Ee,height:Ie,x:Le,y:Pe,sdf:Ne,pixelRatio:qe,stretchX:Ve,stretchY:Ge,content:We,textFitWidth:ct,textFitHeight:ut}=Te[Ce];me[ge][Ce]={data:null,pixelRatio:qe,sdf:Ne,stretchX:Ve,stretchY:Ge,content:We,textFitWidth:ct,textFitHeight:ut,spriteData:{width:Ee,height:Ie,x:Le,y:Pe,context:_e}}}}return me})}(K,H)})}(i,this.map._requestManager,this.map.getPixelRatio(),this._spriteRequest).then(w=>{if(this._spriteRequest=null,w)for(const E in w){this._spritesImagesIds[E]=[];const M=this._spritesImagesIds[E]?this._spritesImagesIds[E].filter(D=>!(D in w)):[];for(const D of M)this.imageManager.removeImage(D),this._changedImages[D]=!0;for(const D in w[E]){const $=E==="default"?D:`${E}:${D}`;this._spritesImagesIds[E].push($),$ in this.imageManager.images?this.imageManager.updateImage($,w[E][D],!1):this.imageManager.addImage($,w[E][D]),d&&(this._changedImages[$]=!0)}}}).catch(w=>{this._spriteRequest=null,_=w,this.fire(new a.k(_))}).finally(()=>{this.imageManager.setLoaded(!0),this._availableImages=this.imageManager.listImages(),d&&(this._changed=!0),this.dispatcher.broadcast("SI",this._availableImages),this.fire(new a.l("data",{dataType:"style"})),p&&p(_)})}_unloadSprite(){for(const i of Object.values(this._spritesImagesIds).flat())this.imageManager.removeImage(i),this._changedImages[i]=!0;this._spritesImagesIds={},this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new a.l("data",{dataType:"style"}))}_validateLayer(i){const d=this.sourceCaches[i.source];if(!d)return;const p=i.sourceLayer;if(!p)return;const _=d.getSource();(_.type==="geojson"||_.vectorLayerIds&&_.vectorLayerIds.indexOf(p)===-1)&&this.fire(new a.k(new Error(`Source layer "${p}" does not exist on source "${_.id}" as specified by style layer "${i.id}".`)))}loaded(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(const i in this.sourceCaches)if(!this.sourceCaches[i].loaded())return!1;return!!this.imageManager.isLoaded()}_serializeByIds(i,d=!1){const p=this._serializedAllLayers();if(!i||i.length===0)return Object.values(d?a.bL(p):p);const _=[];for(const w of i)if(p[w]){const E=d?a.bL(p[w]):p[w];_.push(E)}return _}_serializedAllLayers(){let i=this._serializedLayers;if(i)return i;i=this._serializedLayers={};const d=Object.keys(this._layers);for(const p of d){const _=this._layers[p];_.type!=="custom"&&(i[p]=_.serialize())}return i}hasTransitions(){var i,d,p;if(!((i=this.light)===null||i===void 0)&&i.hasTransition()||!((d=this.sky)===null||d===void 0)&&d.hasTransition()||!((p=this.projection)===null||p===void 0)&&p.hasTransition())return!0;for(const _ in this.sourceCaches)if(this.sourceCaches[_].hasTransition())return!0;for(const _ in this._layers)if(this._layers[_].hasTransition())return!0;return!1}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading.")}update(i){if(!this._loaded)return;const d=this._changed;if(d){const _=Object.keys(this._updatedLayers),w=Object.keys(this._removedLayers);(_.length||w.length)&&this._updateWorkerLayers(_,w);for(const E in this._updatedSources){const M=this._updatedSources[E];if(M==="reload")this._reloadSource(E);else{if(M!=="clear")throw new Error(`Invalid action ${M}`);this._clearSource(E)}}this._updateTilesForChangedImages(),this._updateTilesForChangedGlyphs();for(const E in this._updatedPaintProps)this._layers[E].updateTransitions(i);this.light.updateTransitions(i),this.sky.updateTransitions(i),this._resetUpdates()}const p={};for(const _ in this.sourceCaches){const w=this.sourceCaches[_];p[_]=w.used,w.used=!1}for(const _ of this._order){const w=this._layers[_];w.recalculate(i,this._availableImages),!w.isHidden(i.zoom)&&w.source&&(this.sourceCaches[w.source].used=!0)}for(const _ in p){const w=this.sourceCaches[_];!!p[_]!=!!w.used&&w.fire(new a.l("data",{sourceDataType:"visibility",dataType:"source",sourceId:_}))}this.light.recalculate(i),this.sky.recalculate(i),this.projection.recalculate(i),this.z=i.zoom,d&&this.fire(new a.l("data",{dataType:"style"}))}_updateTilesForChangedImages(){const i=Object.keys(this._changedImages);if(i.length){for(const d in this.sourceCaches)this.sourceCaches[d].reloadTilesForDependencies(["icons","patterns"],i);this._changedImages={}}}_updateTilesForChangedGlyphs(){if(this._glyphsDidChange){for(const i in this.sourceCaches)this.sourceCaches[i].reloadTilesForDependencies(["glyphs"],[""]);this._glyphsDidChange=!1}}_updateWorkerLayers(i,d){this.dispatcher.broadcast("UL",{layers:this._serializeByIds(i,!1),removedIds:d})}_resetUpdates(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={},this._glyphsDidChange=!1}setState(i,d={}){var p;this._checkLoaded();const _=this.serialize();if(i=d.transformStyle?d.transformStyle(_,i):i,((p=d.validate)===null||p===void 0||p)&&$d(this,a.z(i)))return!1;(i=a.bL(i)).layers=a.bI(i.layers);const w=a.bM(_,i),E=this._getOperationsToPerform(w);if(E.unimplemented.length>0)throw new Error(`Unimplemented: ${E.unimplemented.join(", ")}.`);if(E.operations.length===0)return!1;for(const M of E.operations)M();return this.stylesheet=i,this._serializedLayers=null,!0}_getOperationsToPerform(i){const d=[],p=[];for(const _ of i)switch(_.command){case"setCenter":case"setZoom":case"setBearing":case"setPitch":case"setRoll":continue;case"addLayer":d.push(()=>this.addLayer.apply(this,_.args));break;case"removeLayer":d.push(()=>this.removeLayer.apply(this,_.args));break;case"setPaintProperty":d.push(()=>this.setPaintProperty.apply(this,_.args));break;case"setLayoutProperty":d.push(()=>this.setLayoutProperty.apply(this,_.args));break;case"setFilter":d.push(()=>this.setFilter.apply(this,_.args));break;case"addSource":d.push(()=>this.addSource.apply(this,_.args));break;case"removeSource":d.push(()=>this.removeSource.apply(this,_.args));break;case"setLayerZoomRange":d.push(()=>this.setLayerZoomRange.apply(this,_.args));break;case"setLight":d.push(()=>this.setLight.apply(this,_.args));break;case"setGeoJSONSourceData":d.push(()=>this.setGeoJSONSourceData.apply(this,_.args));break;case"setGlyphs":d.push(()=>this.setGlyphs.apply(this,_.args));break;case"setSprite":d.push(()=>this.setSprite.apply(this,_.args));break;case"setTerrain":d.push(()=>this.map.setTerrain.apply(this,_.args));break;case"setSky":d.push(()=>this.setSky.apply(this,_.args));break;case"setProjection":this.setProjection.apply(this,_.args);break;case"setGlobalState":d.push(()=>this.setGlobalState.apply(this,_.args));break;case"setTransition":d.push(()=>{});break;default:p.push(_.command)}return{operations:d,unimplemented:p}}addImage(i,d){if(this.getImage(i))return this.fire(new a.k(new Error(`An image named "${i}" already exists.`)));this.imageManager.addImage(i,d),this._afterImageUpdated(i)}updateImage(i,d){this.imageManager.updateImage(i,d)}getImage(i){return this.imageManager.getImage(i)}removeImage(i){if(!this.getImage(i))return this.fire(new a.k(new Error(`An image named "${i}" does not exist.`)));this.imageManager.removeImage(i),this._afterImageUpdated(i)}_afterImageUpdated(i){this._availableImages=this.imageManager.listImages(),this._changedImages[i]=!0,this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new a.l("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this.imageManager.listImages()}addSource(i,d,p={}){if(this._checkLoaded(),this.sourceCaches[i]!==void 0)throw new Error(`Source "${i}" already exists.`);if(!d.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(d).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(d.type)>=0&&this._validate(a.z.source,`sources.${i}`,d,null,p))return;this.map&&this.map._collectResourceTiming&&(d.collectResourceTiming=!0);const _=this.sourceCaches[i]=new lt(i,d,this.dispatcher);_.style=this,_.setEventedParent(this,()=>({isSourceLoaded:_.loaded(),source:_.serialize(),sourceId:i})),_.onAdd(this.map),this._changed=!0}removeSource(i){if(this._checkLoaded(),this.sourceCaches[i]===void 0)throw new Error("There is no source with this ID");for(const p in this._layers)if(this._layers[p].source===i)return this.fire(new a.k(new Error(`Source "${i}" cannot be removed while layer "${p}" is using it.`)));const d=this.sourceCaches[i];delete this.sourceCaches[i],delete this._updatedSources[i],d.fire(new a.l("data",{sourceDataType:"metadata",dataType:"source",sourceId:i})),d.setEventedParent(null),d.onRemove(this.map),this._changed=!0}setGeoJSONSourceData(i,d){if(this._checkLoaded(),this.sourceCaches[i]===void 0)throw new Error(`There is no source with this ID=${i}`);const p=this.sourceCaches[i].getSource();if(p.type!=="geojson")throw new Error(`geojsonSource.type is ${p.type}, which is !== 'geojson`);p.setData(d),this._changed=!0}getSource(i){return this.sourceCaches[i]&&this.sourceCaches[i].getSource()}addLayer(i,d,p={}){this._checkLoaded();const _=i.id;if(this.getLayer(_))return void this.fire(new a.k(new Error(`Layer "${_}" already exists on this map.`)));let w;if(i.type==="custom"){if($d(this,a.bN(i)))return;w=a.bJ(i,this._globalState)}else{if("source"in i&&typeof i.source=="object"&&(this.addSource(_,i.source),i=a.bL(i),i=a.e(i,{source:_})),this._validate(a.z.layer,`layers.${_}`,i,{arrayIndex:-1},p))return;w=a.bJ(i,this._globalState),this._validateLayer(w),w.setEventedParent(this,{layer:{id:_}})}const E=d?this._order.indexOf(d):this._order.length;if(d&&E===-1)this.fire(new a.k(new Error(`Cannot add layer "${_}" before non-existing layer "${d}".`)));else{if(this._order.splice(E,0,_),this._layerOrderChanged=!0,this._layers[_]=w,this._removedLayers[_]&&w.source&&w.type!=="custom"){const M=this._removedLayers[_];delete this._removedLayers[_],M.type!==w.type?this._updatedSources[w.source]="clear":(this._updatedSources[w.source]="reload",this.sourceCaches[w.source].pause())}this._updateLayer(w),w.onAdd&&w.onAdd(this.map)}}moveLayer(i,d){if(this._checkLoaded(),this._changed=!0,!this._layers[i])return void this.fire(new a.k(new Error(`The layer '${i}' does not exist in the map's style and cannot be moved.`)));if(i===d)return;const p=this._order.indexOf(i);this._order.splice(p,1);const _=d?this._order.indexOf(d):this._order.length;d&&_===-1?this.fire(new a.k(new Error(`Cannot move layer "${i}" before non-existing layer "${d}".`))):(this._order.splice(_,0,i),this._layerOrderChanged=!0)}removeLayer(i){this._checkLoaded();const d=this._layers[i];if(!d)return void this.fire(new a.k(new Error(`Cannot remove non-existing layer "${i}".`)));d.setEventedParent(null);const p=this._order.indexOf(i);this._order.splice(p,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[i]=d,delete this._layers[i],this._serializedLayers&&delete this._serializedLayers[i],delete this._updatedLayers[i],delete this._updatedPaintProps[i],d.onRemove&&d.onRemove(this.map)}getLayer(i){return this._layers[i]}getLayersOrder(){return[...this._order]}hasLayer(i){return i in this._layers}setLayerZoomRange(i,d,p){this._checkLoaded();const _=this.getLayer(i);_?_.minzoom===d&&_.maxzoom===p||(d!=null&&(_.minzoom=d),p!=null&&(_.maxzoom=p),this._updateLayer(_)):this.fire(new a.k(new Error(`Cannot set the zoom range of non-existing layer "${i}".`)))}setFilter(i,d,p={}){this._checkLoaded();const _=this.getLayer(i);if(_){if(!a.bH(_.filter,d))return d==null?(_.setFilter(void 0),void this._updateLayer(_)):void(this._validate(a.z.filter,`layers.${_.id}.filter`,d,null,p)||(_.setFilter(a.bL(d)),this._updateLayer(_)))}else this.fire(new a.k(new Error(`Cannot filter non-existing layer "${i}".`)))}getFilter(i){return a.bL(this.getLayer(i).filter)}setLayoutProperty(i,d,p,_={}){this._checkLoaded();const w=this.getLayer(i);w?a.bH(w.getLayoutProperty(d),p)||(w.setLayoutProperty(d,p,_),this._updateLayer(w)):this.fire(new a.k(new Error(`Cannot style non-existing layer "${i}".`)))}getLayoutProperty(i,d){const p=this.getLayer(i);if(p)return p.getLayoutProperty(d);this.fire(new a.k(new Error(`Cannot get style of non-existing layer "${i}".`)))}setPaintProperty(i,d,p,_={}){this._checkLoaded();const w=this.getLayer(i);w?a.bH(w.getPaintProperty(d),p)||this._updatePaintProperty(w,d,p,_):this.fire(new a.k(new Error(`Cannot style non-existing layer "${i}".`)))}_updatePaintProperty(i,d,p,_={}){i.setPaintProperty(d,p,_)&&this._updateLayer(i),a.bK(i)&&d==="raster-fade-duration"&&this.sourceCaches[i.source].setRasterFadeDuration(p),this._changed=!0,this._updatedPaintProps[i.id]=!0,this._serializedLayers=null}getPaintProperty(i,d){return this.getLayer(i).getPaintProperty(d)}setFeatureState(i,d){this._checkLoaded();const p=i.source,_=i.sourceLayer,w=this.sourceCaches[p];if(w===void 0)return void this.fire(new a.k(new Error(`The source '${p}' does not exist in the map's style.`)));const E=w.getSource().type;E==="geojson"&&_?this.fire(new a.k(new Error("GeoJSON sources cannot have a sourceLayer parameter."))):E!=="vector"||_?(i.id===void 0&&this.fire(new a.k(new Error("The feature id parameter must be provided."))),w.setFeatureState(_,i.id,d)):this.fire(new a.k(new Error("The sourceLayer parameter must be provided for vector source types.")))}removeFeatureState(i,d){this._checkLoaded();const p=i.source,_=this.sourceCaches[p];if(_===void 0)return void this.fire(new a.k(new Error(`The source '${p}' does not exist in the map's style.`)));const w=_.getSource().type,E=w==="vector"?i.sourceLayer:void 0;w!=="vector"||E?d&&typeof i.id!="string"&&typeof i.id!="number"?this.fire(new a.k(new Error("A feature id is required to remove its specific state property."))):_.removeFeatureState(E,i.id,d):this.fire(new a.k(new Error("The sourceLayer parameter must be provided for vector source types.")))}getFeatureState(i){this._checkLoaded();const d=i.source,p=i.sourceLayer,_=this.sourceCaches[d];if(_!==void 0)return _.getSource().type!=="vector"||p?(i.id===void 0&&this.fire(new a.k(new Error("The feature id parameter must be provided."))),_.getFeatureState(p,i.id)):void this.fire(new a.k(new Error("The sourceLayer parameter must be provided for vector source types.")));this.fire(new a.k(new Error(`The source '${d}' does not exist in the map's style.`)))}getTransition(){return a.e({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)}serialize(){if(!this._loaded)return;const i=a.bO(this.sourceCaches,w=>w.serialize()),d=this._serializeByIds(this._order,!0),p=this.map.getTerrain()||void 0,_=this.stylesheet;return a.bP({version:_.version,name:_.name,metadata:_.metadata,light:_.light,sky:_.sky,center:_.center,zoom:_.zoom,bearing:_.bearing,pitch:_.pitch,sprite:_.sprite,glyphs:_.glyphs,transition:_.transition,projection:_.projection,sources:i,layers:d,terrain:p},w=>w!==void 0)}_updateLayer(i){this._updatedLayers[i.id]=!0,i.source&&!this._updatedSources[i.source]&&this.sourceCaches[i.source].getSource().type!=="raster"&&(this._updatedSources[i.source]="reload",this.sourceCaches[i.source].pause()),this._serializedLayers=null,this._changed=!0}_flattenAndSortRenderedFeatures(i){const d=E=>this._layers[E].type==="fill-extrusion",p={},_=[];for(let E=this._order.length-1;E>=0;E--){const M=this._order[E];if(d(M)){p[M]=E;for(const D of i){const $=D[M];if($)for(const U of $)_.push(U)}}}_.sort((E,M)=>M.intersectionZ-E.intersectionZ);const w=[];for(let E=this._order.length-1;E>=0;E--){const M=this._order[E];if(d(M))for(let D=_.length-1;D>=0;D--){const $=_[D].feature;if(p[$.layer.id]<E)break;w.push($),_.pop()}else for(const D of i){const $=D[M];if($)for(const U of $)w.push(U.feature)}}return w}queryRenderedFeatures(i,d,p){d&&d.filter&&this._validate(a.z.filter,"queryRenderedFeatures.filter",d.filter,null,d);const _={};if(d&&d.layers){if(!(Array.isArray(d.layers)||d.layers instanceof Set))return this.fire(new a.k(new Error("parameters.layers must be an Array or a Set of strings"))),[];for(const $ of d.layers){const U=this._layers[$];if(!U)return this.fire(new a.k(new Error(`The layer '${$}' does not exist in the map's style and cannot be queried for features.`))),[];_[U.source]=!0}}const w=[];d.availableImages=this._availableImages;const E=this._serializedAllLayers(),M=d.layers instanceof Set?d.layers:Array.isArray(d.layers)?new Set(d.layers):null,D=Object.assign(Object.assign({},d),{layers:M,globalState:this._globalState});for(const $ in this.sourceCaches)d.layers&&!_[$]||w.push(ir(this.sourceCaches[$],this._layers,E,i,D,p,this.map.terrain?(U,K,H)=>this.map.terrain.getElevation(U,K,H):void 0));return this.placement&&w.push(function($,U,K,H,ee,ae,me){const ge={},_e=ae.queryRenderedSymbols(H),Te=[];for(const Ce of Object.keys(_e).map(Number))Te.push(me[Ce]);Te.sort(yr);for(const Ce of Te){const Ee=Ce.featureIndex.lookupSymbolFeatures(_e[Ce.bucketInstanceId],U,Ce.bucketIndex,Ce.sourceLayerIndex,{filterSpec:ee.filter,globalState:ee.globalState},ee.layers,ee.availableImages,$);for(const Ie in Ee){const Le=ge[Ie]=ge[Ie]||[],Pe=Ee[Ie];Pe.sort((Ne,qe)=>{const Ve=Ce.featureSortOrder;if(Ve){const Ge=Ve.indexOf(Ne.featureIndex);return Ve.indexOf(qe.featureIndex)-Ge}return qe.featureIndex-Ne.featureIndex});for(const Ne of Pe)Le.push(Ne)}}return function(Ce,Ee,Ie){for(const Le in Ce)for(const Pe of Ce[Le])$t(Pe,Ie[Ee[Le].source]);return Ce}(ge,$,K)}(this._layers,E,this.sourceCaches,i,D,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(w)}querySourceFeatures(i,d){d!=null&&d.filter&&this._validate(a.z.filter,"querySourceFeatures.filter",d.filter,null,d);const p=this.sourceCaches[i];return p?function(_,w){const E=_.getRenderableIds().map($=>_.getTileByID($)),M=[],D={};for(let $=0;$<E.length;$++){const U=E[$],K=U.tileID.canonical.key;D[K]||(D[K]=!0,U.querySourceFeatures(M,w))}return M}(p,d?Object.assign(Object.assign({},d),{globalState:this._globalState}):{globalState:this._globalState}):[]}getLight(){return this.light.getLight()}setLight(i,d={}){this._checkLoaded();const p=this.light.getLight();let _=!1;for(const E in i)if(!a.bH(i[E],p[E])){_=!0;break}if(!_)return;const w={now:P.now(),transition:a.e({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(i,d),this.light.updateTransitions(w)}getProjection(){var i;return(i=this.stylesheet)===null||i===void 0?void 0:i.projection}setProjection(i){if(this._checkLoaded(),this.projection){if(this.projection.name===i.type)return;this.projection.destroy(),delete this.projection}this.stylesheet.projection=i,this._setProjectionInternal(i.type)}getSky(){var i;return(i=this.stylesheet)===null||i===void 0?void 0:i.sky}setSky(i,d={}){this._checkLoaded();const p=this.getSky();let _=!1;if(!i&&!p)return;if(i&&!p)_=!0;else if(!i&&p)_=!0;else for(const E in i)if(!a.bH(i[E],p[E])){_=!0;break}if(!_)return;const w={now:P.now(),transition:a.e({duration:300,delay:0},this.stylesheet.transition)};this.stylesheet.sky=i,this.sky.setSky(i,d),this.sky.updateTransitions(w)}_setProjectionInternal(i){const d=function(p){if(Array.isArray(p)){const _=new Nd({type:p});return{projection:_,transform:new ra,cameraHelper:new c_(_)}}switch(p){case"mercator":return{projection:new Zu,transform:new yc,cameraHelper:new Xu};case"globe":{const _=new Nd({type:["interpolate",["linear"],["zoom"],11,"vertical-perspective",12,"mercator"]});return{projection:_,transform:new ra,cameraHelper:new c_(_)}}case"vertical-perspective":return{projection:new Ju,transform:new rh,cameraHelper:new io};default:return a.w(`Unknown projection name: ${p}. Falling back to mercator projection.`),{projection:new Zu,transform:new yc,cameraHelper:new Xu}}}(i);this.projection=d.projection,this.map.migrateProjection(d.transform,d.cameraHelper);for(const p in this.sourceCaches)this.sourceCaches[p].reload()}_validate(i,d,p,_,w={}){return(!w||w.validate!==!1)&&$d(this,i.call(a.z,a.e({key:d,style:this.serialize(),value:p,styleSpec:a.v},_)))}_remove(i=!0){this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._loadStyleRequest&&(this._loadStyleRequest.abort(),this._loadStyleRequest=null),this._spriteRequest&&(this._spriteRequest.abort(),this._spriteRequest=null),Sn().off(Zt,this._rtlPluginLoaded);for(const d in this._layers)this._layers[d].setEventedParent(null);for(const d in this.sourceCaches){const p=this.sourceCaches[d];p.setEventedParent(null),p.onRemove(this.map)}this.imageManager.setEventedParent(null),this.setEventedParent(null),i&&this.dispatcher.broadcast("RM",void 0),this.dispatcher.remove(i)}_clearSource(i){this.sourceCaches[i].clearTiles()}_reloadSource(i){this.sourceCaches[i].resume(),this.sourceCaches[i].reload()}_updateSources(i){for(const d in this.sourceCaches)this.sourceCaches[d].update(i,this.map.terrain)}_generateCollisionBoxes(){for(const i in this.sourceCaches)this._reloadSource(i)}_updatePlacement(i,d,p,_,w=!1){let E=!1,M=!1;const D={};for(const $ of this._order){const U=this._layers[$];if(U.type!=="symbol")continue;if(!D[U.source]){const H=this.sourceCaches[U.source];D[U.source]=H.getRenderableIds(!0).map(ee=>H.getTileByID(ee)).sort((ee,ae)=>ae.tileID.overscaledZ-ee.tileID.overscaledZ||(ee.tileID.isLessThan(ae.tileID)?-1:1))}const K=this.crossTileSymbolIndex.addLayer(U,D[U.source],i.center.lng);E=E||K}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),((w=w||this._layerOrderChanged||p===0)||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(P.now(),i.zoom))&&(this.pauseablePlacement=new a_(i,this.map.terrain,this._order,w,d,p,_,this.placement),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,D),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(P.now()),M=!0),E&&this.pauseablePlacement.placement.setStale()),M||E)for(const $ of this._order){const U=this._layers[$];U.type==="symbol"&&this.placement.updateLayerOpacities(U,D[U.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(P.now())}_releaseSymbolFadeTiles(){for(const i in this.sourceCaches)this.sourceCaches[i].releaseSymbolFadeTiles()}getImages(i,d){return a._(this,void 0,void 0,function*(){const p=yield this.imageManager.getImages(d.icons);this._updateTilesForChangedImages();const _=this.sourceCaches[d.source];return _&&_.setDependencies(d.tileID.key,d.type,d.icons),p})}getGlyphs(i,d){return a._(this,void 0,void 0,function*(){const p=yield this.glyphManager.getGlyphs(d.stacks),_=this.sourceCaches[d.source];return _&&_.setDependencies(d.tileID.key,d.type,[""]),p})}getGlyphsUrl(){return this.stylesheet.glyphs||null}setGlyphs(i,d={}){this._checkLoaded(),i&&this._validate(a.z.glyphs,"glyphs",i,null,d)||(this._glyphsDidChange=!0,this.stylesheet.glyphs=i,this.glyphManager.entries={},this.glyphManager.setURL(i))}getDashes(i,d){return a._(this,void 0,void 0,function*(){const p={};for(const[_,w]of Object.entries(d.dashes))p[_]=this.lineAtlas.getDash(w.dasharray,w.round);return p})}addSprite(i,d,p={},_){this._checkLoaded();const w=[{id:i,url:d}],E=[...te(this.stylesheet.sprite),...w];this._validate(a.z.sprite,"sprite",E,null,p)||(this.stylesheet.sprite=E,this._loadSprite(w,!0,_))}removeSprite(i){this._checkLoaded();const d=te(this.stylesheet.sprite);if(d.find(p=>p.id===i)){if(this._spritesImagesIds[i])for(const p of this._spritesImagesIds[i])this.imageManager.removeImage(p),this._changedImages[p]=!0;d.splice(d.findIndex(p=>p.id===i),1),this.stylesheet.sprite=d.length>0?d:void 0,delete this._spritesImagesIds[i],this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new a.l("data",{dataType:"style"}))}else this.fire(new a.k(new Error(`Sprite "${i}" doesn't exists on this map.`)))}getSprite(){return te(this.stylesheet.sprite)}setSprite(i,d={},p){this._checkLoaded(),i&&this._validate(a.z.sprite,"sprite",i,null,d)||(this.stylesheet.sprite=i,i?this._loadSprite(i,!0,p):(this._unloadSprite(),p&&p(null)))}}var V1=a.aJ([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);class Vd{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null}bind(i,d,p,_,w,E,M,D,$){this.context=i;let U=this.boundPaintVertexBuffers.length!==_.length;for(let K=0;!U&&K<_.length;K++)this.boundPaintVertexBuffers[K]!==_[K]&&(U=!0);!this.vao||this.boundProgram!==d||this.boundLayoutVertexBuffer!==p||U||this.boundIndexBuffer!==w||this.boundVertexOffset!==E||this.boundDynamicVertexBuffer!==M||this.boundDynamicVertexBuffer2!==D||this.boundDynamicVertexBuffer3!==$?this.freshBind(d,p,_,w,E,M,D,$):(i.bindVertexArray.set(this.vao),M&&M.bind(),w&&w.dynamicDraw&&w.bind(),D&&D.bind(),$&&$.bind())}freshBind(i,d,p,_,w,E,M,D){const $=i.numAttributes,U=this.context,K=U.gl;this.vao&&this.destroy(),this.vao=U.createVertexArray(),U.bindVertexArray.set(this.vao),this.boundProgram=i,this.boundLayoutVertexBuffer=d,this.boundPaintVertexBuffers=p,this.boundIndexBuffer=_,this.boundVertexOffset=w,this.boundDynamicVertexBuffer=E,this.boundDynamicVertexBuffer2=M,this.boundDynamicVertexBuffer3=D,d.enableAttributes(K,i);for(const H of p)H.enableAttributes(K,i);E&&E.enableAttributes(K,i),M&&M.enableAttributes(K,i),D&&D.enableAttributes(K,i),d.bind(),d.setVertexAttribPointers(K,i,w);for(const H of p)H.bind(),H.setVertexAttribPointers(K,i,w);E&&(E.bind(),E.setVertexAttribPointers(K,i,w)),_&&_.bind(),M&&(M.bind(),M.setVertexAttribPointers(K,i,w)),D&&(D.bind(),D.setVertexAttribPointers(K,i,w)),U.currentNumAttributes=$}destroy(){this.vao&&(this.context.deleteVertexArray(this.vao),this.vao=null)}}const zm=(x,i,d,p,_)=>({u_texture:0,u_ele_delta:x,u_fog_matrix:i,u_fog_color:d?d.properties.get("fog-color"):a.bf.white,u_fog_ground_blend:d?d.properties.get("fog-ground-blend"):1,u_fog_ground_blend_opacity:_?0:d?d.calculateFogBlendOpacity(p):0,u_horizon_color:d?d.properties.get("horizon-color"):a.bf.white,u_horizon_fog_blend:d?d.properties.get("horizon-fog-blend"):1,u_is_globe_mode:_?1:0}),Ud={mainMatrix:"u_projection_matrix",tileMercatorCoords:"u_projection_tile_mercator_coords",clippingPlane:"u_projection_clipping_plane",projectionTransition:"u_projection_transition",fallbackMatrix:"u_projection_fallback_matrix"};function bc(x){const i=[];for(let d=0;d<x.length;d++){if(x[d]===null)continue;const p=x[d].split(" ");i.push(p.pop())}return i}class Nm{constructor(i,d,p,_,w,E,M,D,$=[]){const U=i.gl;this.program=U.createProgram();const K=bc(d.staticAttributes),H=p?p.getBinderAttributes():[],ee=K.concat(H),ae=Gi.prelude.staticUniforms?bc(Gi.prelude.staticUniforms):[],me=M.staticUniforms?bc(M.staticUniforms):[],ge=d.staticUniforms?bc(d.staticUniforms):[],_e=p?p.getBinderUniforms():[],Te=ae.concat(me).concat(ge).concat(_e),Ce=[];for(const Ve of Te)Ce.indexOf(Ve)<0&&Ce.push(Ve);const Ee=p?p.defines():[];Di(U)&&Ee.unshift("#version 300 es"),w&&Ee.push("#define OVERDRAW_INSPECTOR;"),E&&Ee.push("#define TERRAIN3D;"),D&&Ee.push(D),$&&Ee.push(...$);let Ie=Ee.concat(Gi.prelude.fragmentSource,M.fragmentSource,d.fragmentSource).join(`
`),Le=Ee.concat(Gi.prelude.vertexSource,M.vertexSource,d.vertexSource).join(`
`);Di(U)||(Ie=function(Ve){return Ve.replace(/\bin\s/g,"varying ").replace("out highp vec4 fragColor;","").replace(/fragColor/g,"gl_FragColor").replace(/texture\(/g,"texture2D(")}(Ie),Le=function(Ve){return Ve.replace(/\bin\s/g,"attribute ").replace(/\bout\s/g,"varying ").replace(/texture\(/g,"texture2D(")}(Le));const Pe=U.createShader(U.FRAGMENT_SHADER);if(U.isContextLost())return void(this.failedToCreate=!0);if(U.shaderSource(Pe,Ie),U.compileShader(Pe),!U.getShaderParameter(Pe,U.COMPILE_STATUS))throw new Error(`Could not compile fragment shader: ${U.getShaderInfoLog(Pe)}`);U.attachShader(this.program,Pe);const Ne=U.createShader(U.VERTEX_SHADER);if(U.isContextLost())return void(this.failedToCreate=!0);if(U.shaderSource(Ne,Le),U.compileShader(Ne),!U.getShaderParameter(Ne,U.COMPILE_STATUS))throw new Error(`Could not compile vertex shader: ${U.getShaderInfoLog(Ne)}`);U.attachShader(this.program,Ne),this.attributes={};const qe={};this.numAttributes=ee.length;for(let Ve=0;Ve<this.numAttributes;Ve++)ee[Ve]&&(U.bindAttribLocation(this.program,Ve,ee[Ve]),this.attributes[ee[Ve]]=Ve);if(U.linkProgram(this.program),!U.getProgramParameter(this.program,U.LINK_STATUS))throw new Error(`Program failed to link: ${U.getProgramInfoLog(this.program)}`);U.deleteShader(Ne),U.deleteShader(Pe);for(let Ve=0;Ve<Ce.length;Ve++){const Ge=Ce[Ve];if(Ge&&!qe[Ge]){const We=U.getUniformLocation(this.program,Ge);We&&(qe[Ge]=We)}}this.fixedUniforms=_(i,qe),this.terrainUniforms=((Ve,Ge)=>({u_depth:new a.bQ(Ve,Ge.u_depth),u_terrain:new a.bQ(Ve,Ge.u_terrain),u_terrain_dim:new a.bg(Ve,Ge.u_terrain_dim),u_terrain_matrix:new a.bS(Ve,Ge.u_terrain_matrix),u_terrain_unpack:new a.bT(Ve,Ge.u_terrain_unpack),u_terrain_exaggeration:new a.bg(Ve,Ge.u_terrain_exaggeration)}))(i,qe),this.projectionUniforms=((Ve,Ge)=>({u_projection_matrix:new a.bS(Ve,Ge.u_projection_matrix),u_projection_tile_mercator_coords:new a.bT(Ve,Ge.u_projection_tile_mercator_coords),u_projection_clipping_plane:new a.bT(Ve,Ge.u_projection_clipping_plane),u_projection_transition:new a.bg(Ve,Ge.u_projection_transition),u_projection_fallback_matrix:new a.bS(Ve,Ge.u_projection_fallback_matrix)}))(i,qe),this.binderUniforms=p?p.getUniforms(i,qe):[]}draw(i,d,p,_,w,E,M,D,$,U,K,H,ee,ae,me,ge,_e,Te,Ce){const Ee=i.gl;if(this.failedToCreate)return;if(i.program.set(this.program),i.setDepthMode(p),i.setStencilMode(_),i.setColorMode(w),i.setCullFace(E),D){i.activeTexture.set(Ee.TEXTURE2),Ee.bindTexture(Ee.TEXTURE_2D,D.depthTexture),i.activeTexture.set(Ee.TEXTURE3),Ee.bindTexture(Ee.TEXTURE_2D,D.texture);for(const Le in this.terrainUniforms)this.terrainUniforms[Le].set(D[Le])}if($)for(const Le in $)this.projectionUniforms[Ud[Le]].set($[Le]);if(M)for(const Le in this.fixedUniforms)this.fixedUniforms[Le].set(M[Le]);ge&&ge.setUniforms(i,this.binderUniforms,ae,{zoom:me});let Ie=0;switch(d){case Ee.LINES:Ie=2;break;case Ee.TRIANGLES:Ie=3;break;case Ee.LINE_STRIP:Ie=1}for(const Le of ee.get()){const Pe=Le.vaos||(Le.vaos={});(Pe[U]||(Pe[U]=new Vd)).bind(i,this,K,ge?ge.getPaintVertexBuffers():[],H,Le.vertexOffset,_e,Te,Ce),Ee.drawElements(d,Le.primitiveLength*Ie,Ee.UNSIGNED_SHORT,Le.primitiveOffset*Ie*2)}}}function so(x,i,d){const p=1/a.aC(d,1,i.transform.tileZoom),_=Math.pow(2,d.tileID.overscaledZ),w=d.tileSize*Math.pow(2,i.transform.tileZoom)/_,E=w*(d.tileID.canonical.x+d.tileID.wrap*_),M=w*d.tileID.canonical.y;return{u_image:0,u_texsize:d.imageAtlasTexture.size,u_scale:[p,x.fromScale,x.toScale],u_fade:x.t,u_pixel_coord_upper:[E>>16,M>>16],u_pixel_coord_lower:[65535&E,65535&M]}}const u_=(x,i,d,p)=>{const _=x.style.light,w=_.properties.get("position"),E=[w.x,w.y,w.z],M=a.bW();_.properties.get("anchor")==="viewport"&&a.bX(M,x.transform.bearingInRadians),a.bY(E,E,M);const D=x.transform.transformLightDirection(E),$=_.properties.get("color");return{u_lightpos:E,u_lightpos_globe:D,u_lightintensity:_.properties.get("intensity"),u_lightcolor:[$.r,$.g,$.b],u_vertical_gradient:+i,u_opacity:d,u_fill_translate:p}},jm=(x,i,d,p,_,w,E)=>a.e(u_(x,i,d,p),so(w,x,E),{u_height_factor:-Math.pow(2,_.overscaledZ)/E.tileSize/8}),wc=(x,i,d,p)=>a.e(so(i,x,d),{u_fill_translate:p}),nh=(x,i)=>({u_world:x,u_fill_translate:i}),U1=(x,i,d,p,_)=>a.e(wc(x,i,d,_),{u_world:p}),Gd=(x,i,d,p,_)=>{const w=x.transform;let E,M,D=0;if(d.paint.get("circle-pitch-alignment")==="map"){const $=a.aC(i,1,w.zoom);E=!0,M=[$,$],D=$/(a.$*Math.pow(2,i.tileID.overscaledZ))*2*Math.PI*_}else E=!1,M=w.pixelsToGLUnits;return{u_camera_to_center_distance:w.cameraToCenterDistance,u_scale_with_map:+(d.paint.get("circle-pitch-scale")==="map"),u_pitch_with_map:+E,u_device_pixel_ratio:x.pixelRatio,u_extrude_scale:M,u_globe_extrude_scale:D,u_translate:p}},G1=x=>({u_pixel_extrude_scale:[1/x.width,1/x.height]}),Sc=x=>({u_viewport_size:[x.width,x.height]}),h_=(x,i=1)=>({u_color:x,u_overlay:0,u_overlay_scale:i}),Fm=(x,i,d,p)=>{const _=a.aC(x,1,i)/(a.$*Math.pow(2,x.tileID.overscaledZ))*2*Math.PI*p;return{u_extrude_scale:a.aC(x,1,i),u_intensity:d,u_globe_extrude_scale:_}},d_=(x,i,d,p)=>{const _=a.L();a.bZ(_,0,x.width,x.height,0,0,1);const w=x.context.gl;return{u_matrix:_,u_world:[w.drawingBufferWidth,w.drawingBufferHeight],u_image:d,u_color_ramp:p,u_opacity:i.paint.get("heatmap-opacity")}},f_=(x,i,d)=>{const p=d.paint.get("hillshade-accent-color");let _;switch(d.paint.get("hillshade-method")){case"basic":_=4;break;case"combined":_=1;break;case"igor":_=2;break;case"multidirectional":_=3;break;default:_=0}const w=d.getIlluminationProperties();for(let E=0;E<w.directionRadians.length;E++)d.paint.get("hillshade-illumination-anchor")==="viewport"&&(w.directionRadians[E]+=x.transform.bearingInRadians);return{u_image:0,u_latrange:p_(0,i.tileID),u_exaggeration:d.paint.get("hillshade-exaggeration"),u_altitudes:w.altitudeRadians,u_azimuths:w.directionRadians,u_accent:p,u_method:_,u_highlights:w.highlightColor,u_shadows:w.shadowColor}},Bm=(x,i)=>{const d=i.stride,p=a.L();return a.bZ(p,0,a.$,-a.$,0,0,1),a.M(p,p,[0,-a.$,0]),{u_matrix:p,u_image:1,u_dimension:[d,d],u_zoom:x.overscaledZ,u_unpack:i.getUnpackVector()}};function p_(x,i){const d=Math.pow(2,i.canonical.z),p=i.canonical.y;return[new a.a1(0,p/d).toLngLat().lat,new a.a1(0,(p+1)/d).toLngLat().lat]}const m_=(x,i,d=0)=>({u_image:0,u_unpack:i.getUnpackVector(),u_dimension:[i.stride,i.stride],u_elevation_stops:1,u_color_stops:4,u_color_ramp_size:d,u_opacity:x.paint.get("color-relief-opacity")}),ih=(x,i,d,p)=>{const _=x.transform;return{u_translation:v_(x,i,d),u_ratio:p/a.aC(i,1,_.zoom),u_device_pixel_ratio:x.pixelRatio,u_units_to_pixels:[1/_.pixelsToGLUnits[0],1/_.pixelsToGLUnits[1]]}},g_=(x,i,d,p,_)=>a.e(ih(x,i,d,p),{u_image:0,u_image_height:_}),Sl=(x,i,d,p,_)=>{const w=x.transform,E=Tl(i,w);return{u_translation:v_(x,i,d),u_texsize:i.imageAtlasTexture.size,u_ratio:p/a.aC(i,1,w.zoom),u_device_pixel_ratio:x.pixelRatio,u_image:0,u_scale:[E,_.fromScale,_.toScale],u_fade:_.t,u_units_to_pixels:[1/w.pixelsToGLUnits[0],1/w.pixelsToGLUnits[1]]}},y_=(x,i,d,p,_)=>{const w=Tl(i,x.transform);return a.e(ih(x,i,d,p),{u_tileratio:w,u_crossfade_from:_.fromScale,u_crossfade_to:_.toScale,u_image:0,u_mix:_.t,u_lineatlas_width:x.lineAtlas.width,u_lineatlas_height:x.lineAtlas.height})},__=(x,i,d,p,_,w)=>{const E=Tl(i,x.transform);return a.e(ih(x,i,d,p),{u_image:0,u_image_height:w,u_tileratio:E,u_crossfade_from:_.fromScale,u_crossfade_to:_.toScale,u_image_dash:1,u_mix:_.t,u_lineatlas_width:x.lineAtlas.width,u_lineatlas_height:x.lineAtlas.height})};function Tl(x,i){return 1/a.aC(x,1,i.tileZoom)}function v_(x,i,d){return a.aD(x.transform,i,d.paint.get("line-translate"),d.paint.get("line-translate-anchor"))}const Wd=(x,i,d,p,_)=>{return{u_tl_parent:x,u_scale_parent:i,u_buffer_scale:1,u_fade_t:d.mix,u_opacity:d.opacity*p.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:p.paint.get("raster-brightness-min"),u_brightness_high:p.paint.get("raster-brightness-max"),u_saturation_factor:(E=p.paint.get("raster-saturation"),E>0?1-1/(1.001-E):-E),u_contrast_factor:(w=p.paint.get("raster-contrast"),w>0?1/(1-w):1+w),u_spin_weights:W1(p.paint.get("raster-hue-rotate")),u_coords_top:[_[0].x,_[0].y,_[1].x,_[1].y],u_coords_bottom:[_[3].x,_[3].y,_[2].x,_[2].y]};var w,E};function W1(x){x*=Math.PI/180;const i=Math.sin(x),d=Math.cos(x);return[(2*d+1)/3,(-Math.sqrt(3)*i-d+1)/3,(Math.sqrt(3)*i-d+1)/3]}const x_=(x,i,d,p,_,w,E,M,D,$,U,K,H)=>{const ee=E.transform;return{u_is_size_zoom_constant:+(x==="constant"||x==="source"),u_is_size_feature_constant:+(x==="constant"||x==="camera"),u_size_t:i?i.uSizeT:0,u_size:i?i.uSize:0,u_camera_to_center_distance:ee.cameraToCenterDistance,u_pitch:ee.pitch/360*2*Math.PI,u_rotate_symbol:+d,u_aspect_ratio:ee.width/ee.height,u_fade_change:E.options.fadeDuration?E.symbolFadeChange:1,u_label_plane_matrix:M,u_coord_matrix:D,u_is_text:+U,u_pitch_with_map:+p,u_is_along_line:_,u_is_variable_anchor:w,u_texsize:K,u_texture:0,u_translation:$,u_pitched_scale:H}},$m=(x,i,d,p,_,w,E,M,D,$,U,K,H,ee)=>{const ae=E.transform;return a.e(x_(x,i,d,p,_,w,E,M,D,$,U,K,ee),{u_gamma_scale:p?Math.cos(ae.pitch*Math.PI/180)*ae.cameraToCenterDistance:1,u_device_pixel_ratio:E.pixelRatio,u_is_halo:1})},b_=(x,i,d,p,_,w,E,M,D,$,U,K,H)=>a.e($m(x,i,d,p,_,w,E,M,D,$,!0,U,0,H),{u_texsize_icon:K,u_texture_icon:1}),w_=(x,i)=>({u_opacity:x,u_color:i}),Vm=(x,i,d,p,_)=>a.e(function(w,E,M,D){const $=M.imageManager.getPattern(w.from.toString()),U=M.imageManager.getPattern(w.to.toString()),{width:K,height:H}=M.imageManager.getPixelSize(),ee=Math.pow(2,D.tileID.overscaledZ),ae=D.tileSize*Math.pow(2,M.transform.tileZoom)/ee,me=ae*(D.tileID.canonical.x+D.tileID.wrap*ee),ge=ae*D.tileID.canonical.y;return{u_image:0,u_pattern_tl_a:$.tl,u_pattern_br_a:$.br,u_pattern_tl_b:U.tl,u_pattern_br_b:U.br,u_texsize:[K,H],u_mix:E.t,u_pattern_size_a:$.displaySize,u_pattern_size_b:U.displaySize,u_scale_a:E.fromScale,u_scale_b:E.toScale,u_tile_units_to_pixels:1/a.aC(D,1,M.transform.tileZoom),u_pixel_coord_upper:[me>>16,ge>>16],u_pixel_coord_lower:[65535&me,65535&ge]}}(d,_,i,p),{u_opacity:x}),Um=(x,i)=>{},qd={fillExtrusion:(x,i)=>({u_lightpos:new a.bU(x,i.u_lightpos),u_lightpos_globe:new a.bU(x,i.u_lightpos_globe),u_lightintensity:new a.bg(x,i.u_lightintensity),u_lightcolor:new a.bU(x,i.u_lightcolor),u_vertical_gradient:new a.bg(x,i.u_vertical_gradient),u_opacity:new a.bg(x,i.u_opacity),u_fill_translate:new a.bV(x,i.u_fill_translate)}),fillExtrusionPattern:(x,i)=>({u_lightpos:new a.bU(x,i.u_lightpos),u_lightpos_globe:new a.bU(x,i.u_lightpos_globe),u_lightintensity:new a.bg(x,i.u_lightintensity),u_lightcolor:new a.bU(x,i.u_lightcolor),u_vertical_gradient:new a.bg(x,i.u_vertical_gradient),u_height_factor:new a.bg(x,i.u_height_factor),u_opacity:new a.bg(x,i.u_opacity),u_fill_translate:new a.bV(x,i.u_fill_translate),u_image:new a.bQ(x,i.u_image),u_texsize:new a.bV(x,i.u_texsize),u_pixel_coord_upper:new a.bV(x,i.u_pixel_coord_upper),u_pixel_coord_lower:new a.bV(x,i.u_pixel_coord_lower),u_scale:new a.bU(x,i.u_scale),u_fade:new a.bg(x,i.u_fade)}),fill:(x,i)=>({u_fill_translate:new a.bV(x,i.u_fill_translate)}),fillPattern:(x,i)=>({u_image:new a.bQ(x,i.u_image),u_texsize:new a.bV(x,i.u_texsize),u_pixel_coord_upper:new a.bV(x,i.u_pixel_coord_upper),u_pixel_coord_lower:new a.bV(x,i.u_pixel_coord_lower),u_scale:new a.bU(x,i.u_scale),u_fade:new a.bg(x,i.u_fade),u_fill_translate:new a.bV(x,i.u_fill_translate)}),fillOutline:(x,i)=>({u_world:new a.bV(x,i.u_world),u_fill_translate:new a.bV(x,i.u_fill_translate)}),fillOutlinePattern:(x,i)=>({u_world:new a.bV(x,i.u_world),u_image:new a.bQ(x,i.u_image),u_texsize:new a.bV(x,i.u_texsize),u_pixel_coord_upper:new a.bV(x,i.u_pixel_coord_upper),u_pixel_coord_lower:new a.bV(x,i.u_pixel_coord_lower),u_scale:new a.bU(x,i.u_scale),u_fade:new a.bg(x,i.u_fade),u_fill_translate:new a.bV(x,i.u_fill_translate)}),circle:(x,i)=>({u_camera_to_center_distance:new a.bg(x,i.u_camera_to_center_distance),u_scale_with_map:new a.bQ(x,i.u_scale_with_map),u_pitch_with_map:new a.bQ(x,i.u_pitch_with_map),u_extrude_scale:new a.bV(x,i.u_extrude_scale),u_device_pixel_ratio:new a.bg(x,i.u_device_pixel_ratio),u_globe_extrude_scale:new a.bg(x,i.u_globe_extrude_scale),u_translate:new a.bV(x,i.u_translate)}),collisionBox:(x,i)=>({u_pixel_extrude_scale:new a.bV(x,i.u_pixel_extrude_scale)}),collisionCircle:(x,i)=>({u_viewport_size:new a.bV(x,i.u_viewport_size)}),debug:(x,i)=>({u_color:new a.bR(x,i.u_color),u_overlay:new a.bQ(x,i.u_overlay),u_overlay_scale:new a.bg(x,i.u_overlay_scale)}),depth:Um,clippingMask:Um,heatmap:(x,i)=>({u_extrude_scale:new a.bg(x,i.u_extrude_scale),u_intensity:new a.bg(x,i.u_intensity),u_globe_extrude_scale:new a.bg(x,i.u_globe_extrude_scale)}),heatmapTexture:(x,i)=>({u_matrix:new a.bS(x,i.u_matrix),u_world:new a.bV(x,i.u_world),u_image:new a.bQ(x,i.u_image),u_color_ramp:new a.bQ(x,i.u_color_ramp),u_opacity:new a.bg(x,i.u_opacity)}),hillshade:(x,i)=>({u_image:new a.bQ(x,i.u_image),u_latrange:new a.bV(x,i.u_latrange),u_exaggeration:new a.bg(x,i.u_exaggeration),u_altitudes:new a.b$(x,i.u_altitudes),u_azimuths:new a.b$(x,i.u_azimuths),u_accent:new a.bR(x,i.u_accent),u_method:new a.bQ(x,i.u_method),u_shadows:new a.b_(x,i.u_shadows),u_highlights:new a.b_(x,i.u_highlights)}),hillshadePrepare:(x,i)=>({u_matrix:new a.bS(x,i.u_matrix),u_image:new a.bQ(x,i.u_image),u_dimension:new a.bV(x,i.u_dimension),u_zoom:new a.bg(x,i.u_zoom),u_unpack:new a.bT(x,i.u_unpack)}),colorRelief:(x,i)=>({u_image:new a.bQ(x,i.u_image),u_unpack:new a.bT(x,i.u_unpack),u_dimension:new a.bV(x,i.u_dimension),u_elevation_stops:new a.bQ(x,i.u_elevation_stops),u_color_stops:new a.bQ(x,i.u_color_stops),u_color_ramp_size:new a.bQ(x,i.u_color_ramp_size),u_opacity:new a.bg(x,i.u_opacity)}),line:(x,i)=>({u_translation:new a.bV(x,i.u_translation),u_ratio:new a.bg(x,i.u_ratio),u_device_pixel_ratio:new a.bg(x,i.u_device_pixel_ratio),u_units_to_pixels:new a.bV(x,i.u_units_to_pixels)}),lineGradient:(x,i)=>({u_translation:new a.bV(x,i.u_translation),u_ratio:new a.bg(x,i.u_ratio),u_device_pixel_ratio:new a.bg(x,i.u_device_pixel_ratio),u_units_to_pixels:new a.bV(x,i.u_units_to_pixels),u_image:new a.bQ(x,i.u_image),u_image_height:new a.bg(x,i.u_image_height)}),linePattern:(x,i)=>({u_translation:new a.bV(x,i.u_translation),u_texsize:new a.bV(x,i.u_texsize),u_ratio:new a.bg(x,i.u_ratio),u_device_pixel_ratio:new a.bg(x,i.u_device_pixel_ratio),u_image:new a.bQ(x,i.u_image),u_units_to_pixels:new a.bV(x,i.u_units_to_pixels),u_scale:new a.bU(x,i.u_scale),u_fade:new a.bg(x,i.u_fade)}),lineSDF:(x,i)=>({u_translation:new a.bV(x,i.u_translation),u_ratio:new a.bg(x,i.u_ratio),u_device_pixel_ratio:new a.bg(x,i.u_device_pixel_ratio),u_units_to_pixels:new a.bV(x,i.u_units_to_pixels),u_image:new a.bQ(x,i.u_image),u_mix:new a.bg(x,i.u_mix),u_tileratio:new a.bg(x,i.u_tileratio),u_crossfade_from:new a.bg(x,i.u_crossfade_from),u_crossfade_to:new a.bg(x,i.u_crossfade_to),u_lineatlas_width:new a.bg(x,i.u_lineatlas_width),u_lineatlas_height:new a.bg(x,i.u_lineatlas_height)}),lineGradientSDF:(x,i)=>({u_translation:new a.bV(x,i.u_translation),u_ratio:new a.bg(x,i.u_ratio),u_device_pixel_ratio:new a.bg(x,i.u_device_pixel_ratio),u_units_to_pixels:new a.bV(x,i.u_units_to_pixels),u_image:new a.bQ(x,i.u_image),u_image_height:new a.bg(x,i.u_image_height),u_tileratio:new a.bg(x,i.u_tileratio),u_crossfade_from:new a.bg(x,i.u_crossfade_from),u_crossfade_to:new a.bg(x,i.u_crossfade_to),u_image_dash:new a.bQ(x,i.u_image_dash),u_mix:new a.bg(x,i.u_mix),u_lineatlas_width:new a.bg(x,i.u_lineatlas_width),u_lineatlas_height:new a.bg(x,i.u_lineatlas_height)}),raster:(x,i)=>({u_tl_parent:new a.bV(x,i.u_tl_parent),u_scale_parent:new a.bg(x,i.u_scale_parent),u_buffer_scale:new a.bg(x,i.u_buffer_scale),u_fade_t:new a.bg(x,i.u_fade_t),u_opacity:new a.bg(x,i.u_opacity),u_image0:new a.bQ(x,i.u_image0),u_image1:new a.bQ(x,i.u_image1),u_brightness_low:new a.bg(x,i.u_brightness_low),u_brightness_high:new a.bg(x,i.u_brightness_high),u_saturation_factor:new a.bg(x,i.u_saturation_factor),u_contrast_factor:new a.bg(x,i.u_contrast_factor),u_spin_weights:new a.bU(x,i.u_spin_weights),u_coords_top:new a.bT(x,i.u_coords_top),u_coords_bottom:new a.bT(x,i.u_coords_bottom)}),symbolIcon:(x,i)=>({u_is_size_zoom_constant:new a.bQ(x,i.u_is_size_zoom_constant),u_is_size_feature_constant:new a.bQ(x,i.u_is_size_feature_constant),u_size_t:new a.bg(x,i.u_size_t),u_size:new a.bg(x,i.u_size),u_camera_to_center_distance:new a.bg(x,i.u_camera_to_center_distance),u_pitch:new a.bg(x,i.u_pitch),u_rotate_symbol:new a.bQ(x,i.u_rotate_symbol),u_aspect_ratio:new a.bg(x,i.u_aspect_ratio),u_fade_change:new a.bg(x,i.u_fade_change),u_label_plane_matrix:new a.bS(x,i.u_label_plane_matrix),u_coord_matrix:new a.bS(x,i.u_coord_matrix),u_is_text:new a.bQ(x,i.u_is_text),u_pitch_with_map:new a.bQ(x,i.u_pitch_with_map),u_is_along_line:new a.bQ(x,i.u_is_along_line),u_is_variable_anchor:new a.bQ(x,i.u_is_variable_anchor),u_texsize:new a.bV(x,i.u_texsize),u_texture:new a.bQ(x,i.u_texture),u_translation:new a.bV(x,i.u_translation),u_pitched_scale:new a.bg(x,i.u_pitched_scale)}),symbolSDF:(x,i)=>({u_is_size_zoom_constant:new a.bQ(x,i.u_is_size_zoom_constant),u_is_size_feature_constant:new a.bQ(x,i.u_is_size_feature_constant),u_size_t:new a.bg(x,i.u_size_t),u_size:new a.bg(x,i.u_size),u_camera_to_center_distance:new a.bg(x,i.u_camera_to_center_distance),u_pitch:new a.bg(x,i.u_pitch),u_rotate_symbol:new a.bQ(x,i.u_rotate_symbol),u_aspect_ratio:new a.bg(x,i.u_aspect_ratio),u_fade_change:new a.bg(x,i.u_fade_change),u_label_plane_matrix:new a.bS(x,i.u_label_plane_matrix),u_coord_matrix:new a.bS(x,i.u_coord_matrix),u_is_text:new a.bQ(x,i.u_is_text),u_pitch_with_map:new a.bQ(x,i.u_pitch_with_map),u_is_along_line:new a.bQ(x,i.u_is_along_line),u_is_variable_anchor:new a.bQ(x,i.u_is_variable_anchor),u_texsize:new a.bV(x,i.u_texsize),u_texture:new a.bQ(x,i.u_texture),u_gamma_scale:new a.bg(x,i.u_gamma_scale),u_device_pixel_ratio:new a.bg(x,i.u_device_pixel_ratio),u_is_halo:new a.bQ(x,i.u_is_halo),u_translation:new a.bV(x,i.u_translation),u_pitched_scale:new a.bg(x,i.u_pitched_scale)}),symbolTextAndIcon:(x,i)=>({u_is_size_zoom_constant:new a.bQ(x,i.u_is_size_zoom_constant),u_is_size_feature_constant:new a.bQ(x,i.u_is_size_feature_constant),u_size_t:new a.bg(x,i.u_size_t),u_size:new a.bg(x,i.u_size),u_camera_to_center_distance:new a.bg(x,i.u_camera_to_center_distance),u_pitch:new a.bg(x,i.u_pitch),u_rotate_symbol:new a.bQ(x,i.u_rotate_symbol),u_aspect_ratio:new a.bg(x,i.u_aspect_ratio),u_fade_change:new a.bg(x,i.u_fade_change),u_label_plane_matrix:new a.bS(x,i.u_label_plane_matrix),u_coord_matrix:new a.bS(x,i.u_coord_matrix),u_is_text:new a.bQ(x,i.u_is_text),u_pitch_with_map:new a.bQ(x,i.u_pitch_with_map),u_is_along_line:new a.bQ(x,i.u_is_along_line),u_is_variable_anchor:new a.bQ(x,i.u_is_variable_anchor),u_texsize:new a.bV(x,i.u_texsize),u_texsize_icon:new a.bV(x,i.u_texsize_icon),u_texture:new a.bQ(x,i.u_texture),u_texture_icon:new a.bQ(x,i.u_texture_icon),u_gamma_scale:new a.bg(x,i.u_gamma_scale),u_device_pixel_ratio:new a.bg(x,i.u_device_pixel_ratio),u_is_halo:new a.bQ(x,i.u_is_halo),u_translation:new a.bV(x,i.u_translation),u_pitched_scale:new a.bg(x,i.u_pitched_scale)}),background:(x,i)=>({u_opacity:new a.bg(x,i.u_opacity),u_color:new a.bR(x,i.u_color)}),backgroundPattern:(x,i)=>({u_opacity:new a.bg(x,i.u_opacity),u_image:new a.bQ(x,i.u_image),u_pattern_tl_a:new a.bV(x,i.u_pattern_tl_a),u_pattern_br_a:new a.bV(x,i.u_pattern_br_a),u_pattern_tl_b:new a.bV(x,i.u_pattern_tl_b),u_pattern_br_b:new a.bV(x,i.u_pattern_br_b),u_texsize:new a.bV(x,i.u_texsize),u_mix:new a.bg(x,i.u_mix),u_pattern_size_a:new a.bV(x,i.u_pattern_size_a),u_pattern_size_b:new a.bV(x,i.u_pattern_size_b),u_scale_a:new a.bg(x,i.u_scale_a),u_scale_b:new a.bg(x,i.u_scale_b),u_pixel_coord_upper:new a.bV(x,i.u_pixel_coord_upper),u_pixel_coord_lower:new a.bV(x,i.u_pixel_coord_lower),u_tile_units_to_pixels:new a.bg(x,i.u_tile_units_to_pixels)}),terrain:(x,i)=>({u_texture:new a.bQ(x,i.u_texture),u_ele_delta:new a.bg(x,i.u_ele_delta),u_fog_matrix:new a.bS(x,i.u_fog_matrix),u_fog_color:new a.bR(x,i.u_fog_color),u_fog_ground_blend:new a.bg(x,i.u_fog_ground_blend),u_fog_ground_blend_opacity:new a.bg(x,i.u_fog_ground_blend_opacity),u_horizon_color:new a.bR(x,i.u_horizon_color),u_horizon_fog_blend:new a.bg(x,i.u_horizon_fog_blend),u_is_globe_mode:new a.bg(x,i.u_is_globe_mode)}),terrainDepth:(x,i)=>({u_ele_delta:new a.bg(x,i.u_ele_delta)}),terrainCoords:(x,i)=>({u_texture:new a.bQ(x,i.u_texture),u_terrain_coords_id:new a.bg(x,i.u_terrain_coords_id),u_ele_delta:new a.bg(x,i.u_ele_delta)}),projectionErrorMeasurement:(x,i)=>({u_input:new a.bg(x,i.u_input),u_output_expected:new a.bg(x,i.u_output_expected)}),atmosphere:(x,i)=>({u_sun_pos:new a.bU(x,i.u_sun_pos),u_atmosphere_blend:new a.bg(x,i.u_atmosphere_blend),u_globe_position:new a.bU(x,i.u_globe_position),u_globe_radius:new a.bg(x,i.u_globe_radius),u_inv_proj_matrix:new a.bS(x,i.u_inv_proj_matrix)}),sky:(x,i)=>({u_sky_color:new a.bR(x,i.u_sky_color),u_horizon_color:new a.bR(x,i.u_horizon_color),u_horizon:new a.bV(x,i.u_horizon),u_horizon_normal:new a.bV(x,i.u_horizon_normal),u_sky_horizon_blend:new a.bg(x,i.u_sky_horizon_blend),u_sky_blend:new a.bg(x,i.u_sky_blend)})};class na{constructor(i,d,p){this.context=i;const _=i.gl;this.buffer=_.createBuffer(),this.dynamicDraw=!!p,this.context.unbindVAO(),i.bindElementBuffer.set(this.buffer),_.bufferData(_.ELEMENT_ARRAY_BUFFER,d.arrayBuffer,this.dynamicDraw?_.DYNAMIC_DRAW:_.STATIC_DRAW),this.dynamicDraw||delete d.arrayBuffer}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(i){const d=this.context.gl;if(!this.dynamicDraw)throw new Error("Attempted to update data while not in dynamic mode.");this.context.unbindVAO(),this.bind(),d.bufferSubData(d.ELEMENT_ARRAY_BUFFER,0,i.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const Gm={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class Wm{constructor(i,d,p,_){this.length=d.length,this.attributes=p,this.itemSize=d.bytesPerElement,this.dynamicDraw=_,this.context=i;const w=i.gl;this.buffer=w.createBuffer(),i.bindVertexBuffer.set(this.buffer),w.bufferData(w.ARRAY_BUFFER,d.arrayBuffer,this.dynamicDraw?w.DYNAMIC_DRAW:w.STATIC_DRAW),this.dynamicDraw||delete d.arrayBuffer}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(i){if(i.length!==this.length)throw new Error(`Length of new data is ${i.length}, which doesn't match current length of ${this.length}`);const d=this.context.gl;this.bind(),d.bufferSubData(d.ARRAY_BUFFER,0,i.arrayBuffer)}enableAttributes(i,d){for(let p=0;p<this.attributes.length;p++){const _=d.attributes[this.attributes[p].name];_!==void 0&&i.enableVertexAttribArray(_)}}setVertexAttribPointers(i,d,p){for(let _=0;_<this.attributes.length;_++){const w=this.attributes[_],E=d.attributes[w.name];E!==void 0&&i.vertexAttribPointer(E,w.components,i[Gm[w.type]],!1,this.itemSize,w.offset+this.itemSize*(p||0))}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}class Sr{constructor(i){this.gl=i.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(i){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class S_ extends Sr{getDefault(){return a.bf.transparent}set(i){const d=this.current;(i.r!==d.r||i.g!==d.g||i.b!==d.b||i.a!==d.a||this.dirty)&&(this.gl.clearColor(i.r,i.g,i.b,i.a),this.current=i,this.dirty=!1)}}class qm extends Sr{getDefault(){return 1}set(i){(i!==this.current||this.dirty)&&(this.gl.clearDepth(i),this.current=i,this.dirty=!1)}}class El extends Sr{getDefault(){return 0}set(i){(i!==this.current||this.dirty)&&(this.gl.clearStencil(i),this.current=i,this.dirty=!1)}}class Hm extends Sr{getDefault(){return[!0,!0,!0,!0]}set(i){const d=this.current;(i[0]!==d[0]||i[1]!==d[1]||i[2]!==d[2]||i[3]!==d[3]||this.dirty)&&(this.gl.colorMask(i[0],i[1],i[2],i[3]),this.current=i,this.dirty=!1)}}class q1 extends Sr{getDefault(){return!0}set(i){(i!==this.current||this.dirty)&&(this.gl.depthMask(i),this.current=i,this.dirty=!1)}}class H1 extends Sr{getDefault(){return 255}set(i){(i!==this.current||this.dirty)&&(this.gl.stencilMask(i),this.current=i,this.dirty=!1)}}class Z1 extends Sr{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(i){const d=this.current;(i.func!==d.func||i.ref!==d.ref||i.mask!==d.mask||this.dirty)&&(this.gl.stencilFunc(i.func,i.ref,i.mask),this.current=i,this.dirty=!1)}}class K1 extends Sr{getDefault(){const i=this.gl;return[i.KEEP,i.KEEP,i.KEEP]}set(i){const d=this.current;(i[0]!==d[0]||i[1]!==d[1]||i[2]!==d[2]||this.dirty)&&(this.gl.stencilOp(i[0],i[1],i[2]),this.current=i,this.dirty=!1)}}class T_ extends Sr{getDefault(){return!1}set(i){if(i===this.current&&!this.dirty)return;const d=this.gl;i?d.enable(d.STENCIL_TEST):d.disable(d.STENCIL_TEST),this.current=i,this.dirty=!1}}class X1 extends Sr{getDefault(){return[0,1]}set(i){const d=this.current;(i[0]!==d[0]||i[1]!==d[1]||this.dirty)&&(this.gl.depthRange(i[0],i[1]),this.current=i,this.dirty=!1)}}class E_ extends Sr{getDefault(){return!1}set(i){if(i===this.current&&!this.dirty)return;const d=this.gl;i?d.enable(d.DEPTH_TEST):d.disable(d.DEPTH_TEST),this.current=i,this.dirty=!1}}class Hd extends Sr{getDefault(){return this.gl.LESS}set(i){(i!==this.current||this.dirty)&&(this.gl.depthFunc(i),this.current=i,this.dirty=!1)}}class Zd extends Sr{getDefault(){return!1}set(i){if(i===this.current&&!this.dirty)return;const d=this.gl;i?d.enable(d.BLEND):d.disable(d.BLEND),this.current=i,this.dirty=!1}}class Kd extends Sr{getDefault(){const i=this.gl;return[i.ONE,i.ZERO]}set(i){const d=this.current;(i[0]!==d[0]||i[1]!==d[1]||this.dirty)&&(this.gl.blendFunc(i[0],i[1]),this.current=i,this.dirty=!1)}}class Zm extends Sr{getDefault(){return a.bf.transparent}set(i){const d=this.current;(i.r!==d.r||i.g!==d.g||i.b!==d.b||i.a!==d.a||this.dirty)&&(this.gl.blendColor(i.r,i.g,i.b,i.a),this.current=i,this.dirty=!1)}}class Cl extends Sr{getDefault(){return this.gl.FUNC_ADD}set(i){(i!==this.current||this.dirty)&&(this.gl.blendEquation(i),this.current=i,this.dirty=!1)}}class sh extends Sr{getDefault(){return!1}set(i){if(i===this.current&&!this.dirty)return;const d=this.gl;i?d.enable(d.CULL_FACE):d.disable(d.CULL_FACE),this.current=i,this.dirty=!1}}class Tc extends Sr{getDefault(){return this.gl.BACK}set(i){(i!==this.current||this.dirty)&&(this.gl.cullFace(i),this.current=i,this.dirty=!1)}}class Ns extends Sr{getDefault(){return this.gl.CCW}set(i){(i!==this.current||this.dirty)&&(this.gl.frontFace(i),this.current=i,this.dirty=!1)}}class C_ extends Sr{getDefault(){return null}set(i){(i!==this.current||this.dirty)&&(this.gl.useProgram(i),this.current=i,this.dirty=!1)}}class P_ extends Sr{getDefault(){return this.gl.TEXTURE0}set(i){(i!==this.current||this.dirty)&&(this.gl.activeTexture(i),this.current=i,this.dirty=!1)}}class Km extends Sr{getDefault(){const i=this.gl;return[0,0,i.drawingBufferWidth,i.drawingBufferHeight]}set(i){const d=this.current;(i[0]!==d[0]||i[1]!==d[1]||i[2]!==d[2]||i[3]!==d[3]||this.dirty)&&(this.gl.viewport(i[0],i[1],i[2],i[3]),this.current=i,this.dirty=!1)}}class Pl extends Sr{getDefault(){return null}set(i){if(i===this.current&&!this.dirty)return;const d=this.gl;d.bindFramebuffer(d.FRAMEBUFFER,i),this.current=i,this.dirty=!1}}class Xd extends Sr{getDefault(){return null}set(i){if(i===this.current&&!this.dirty)return;const d=this.gl;d.bindRenderbuffer(d.RENDERBUFFER,i),this.current=i,this.dirty=!1}}class Yd extends Sr{getDefault(){return null}set(i){if(i===this.current&&!this.dirty)return;const d=this.gl;d.bindTexture(d.TEXTURE_2D,i),this.current=i,this.dirty=!1}}class oh extends Sr{getDefault(){return null}set(i){if(i===this.current&&!this.dirty)return;const d=this.gl;d.bindBuffer(d.ARRAY_BUFFER,i),this.current=i,this.dirty=!1}}class Qd extends Sr{getDefault(){return null}set(i){const d=this.gl;d.bindBuffer(d.ELEMENT_ARRAY_BUFFER,i),this.current=i,this.dirty=!1}}class A_ extends Sr{getDefault(){return null}set(i){var d;if(i===this.current&&!this.dirty)return;const p=this.gl;Di(p)?p.bindVertexArray(i):(d=p.getExtension("OES_vertex_array_object"))===null||d===void 0||d.bindVertexArrayOES(i),this.current=i,this.dirty=!1}}class Ec extends Sr{getDefault(){return 4}set(i){if(i===this.current&&!this.dirty)return;const d=this.gl;d.pixelStorei(d.UNPACK_ALIGNMENT,i),this.current=i,this.dirty=!1}}class Cc extends Sr{getDefault(){return!1}set(i){if(i===this.current&&!this.dirty)return;const d=this.gl;d.pixelStorei(d.UNPACK_PREMULTIPLY_ALPHA_WEBGL,i),this.current=i,this.dirty=!1}}class k_ extends Sr{getDefault(){return!1}set(i){if(i===this.current&&!this.dirty)return;const d=this.gl;d.pixelStorei(d.UNPACK_FLIP_Y_WEBGL,i),this.current=i,this.dirty=!1}}class ah extends Sr{constructor(i,d){super(i),this.context=i,this.parent=d}getDefault(){return null}}class lr extends ah{setDirty(){this.dirty=!0}set(i){if(i===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const d=this.gl;d.framebufferTexture2D(d.FRAMEBUFFER,d.COLOR_ATTACHMENT0,d.TEXTURE_2D,i,0),this.current=i,this.dirty=!1}}class Jd extends ah{set(i){if(i===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const d=this.gl;d.framebufferRenderbuffer(d.FRAMEBUFFER,d.DEPTH_ATTACHMENT,d.RENDERBUFFER,i),this.current=i,this.dirty=!1}}class Y1 extends ah{set(i){if(i===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const d=this.gl;d.framebufferRenderbuffer(d.FRAMEBUFFER,d.DEPTH_STENCIL_ATTACHMENT,d.RENDERBUFFER,i),this.current=i,this.dirty=!1}}const Xm="Framebuffer is not complete";class lh{constructor(i,d,p,_,w){this.context=i,this.width=d,this.height=p;const E=i.gl,M=this.framebuffer=E.createFramebuffer();if(this.colorAttachment=new lr(i,M),_)this.depthAttachment=w?new Y1(i,M):new Jd(i,M);else if(w)throw new Error("Stencil cannot be set without depth");if(E.checkFramebufferStatus(E.FRAMEBUFFER)!==E.FRAMEBUFFER_COMPLETE)throw new Error(Xm)}destroy(){const i=this.context.gl,d=this.colorAttachment.get();if(d&&i.deleteTexture(d),this.depthAttachment){const p=this.depthAttachment.get();p&&i.deleteRenderbuffer(p)}i.deleteFramebuffer(this.framebuffer)}}class Q1{constructor(i){var d,p;if(this.gl=i,this.clearColor=new S_(this),this.clearDepth=new qm(this),this.clearStencil=new El(this),this.colorMask=new Hm(this),this.depthMask=new q1(this),this.stencilMask=new H1(this),this.stencilFunc=new Z1(this),this.stencilOp=new K1(this),this.stencilTest=new T_(this),this.depthRange=new X1(this),this.depthTest=new E_(this),this.depthFunc=new Hd(this),this.blend=new Zd(this),this.blendFunc=new Kd(this),this.blendColor=new Zm(this),this.blendEquation=new Cl(this),this.cullFace=new sh(this),this.cullFaceSide=new Tc(this),this.frontFace=new Ns(this),this.program=new C_(this),this.activeTexture=new P_(this),this.viewport=new Km(this),this.bindFramebuffer=new Pl(this),this.bindRenderbuffer=new Xd(this),this.bindTexture=new Yd(this),this.bindVertexBuffer=new oh(this),this.bindElementBuffer=new Qd(this),this.bindVertexArray=new A_(this),this.pixelStoreUnpack=new Ec(this),this.pixelStoreUnpackPremultiplyAlpha=new Cc(this),this.pixelStoreUnpackFlipY=new k_(this),this.extTextureFilterAnisotropic=i.getExtension("EXT_texture_filter_anisotropic")||i.getExtension("MOZ_EXT_texture_filter_anisotropic")||i.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=i.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.maxTextureSize=i.getParameter(i.MAX_TEXTURE_SIZE),Di(i)){this.HALF_FLOAT=i.HALF_FLOAT;const _=i.getExtension("EXT_color_buffer_half_float");this.RGBA16F=(d=i.RGBA16F)!==null&&d!==void 0?d:_==null?void 0:_.RGBA16F_EXT,this.RGB16F=(p=i.RGB16F)!==null&&p!==void 0?p:_==null?void 0:_.RGB16F_EXT,i.getExtension("EXT_color_buffer_float")}else{i.getExtension("EXT_color_buffer_half_float"),i.getExtension("OES_texture_half_float_linear");const _=i.getExtension("OES_texture_half_float");this.HALF_FLOAT=_==null?void 0:_.HALF_FLOAT_OES}}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.bindVertexArray.dirty=!0,this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(i,d){return new na(this,i,d)}createVertexBuffer(i,d,p){return new Wm(this,i,d,p)}createRenderbuffer(i,d,p){const _=this.gl,w=_.createRenderbuffer();return this.bindRenderbuffer.set(w),_.renderbufferStorage(_.RENDERBUFFER,i,d,p),this.bindRenderbuffer.set(null),w}createFramebuffer(i,d,p,_){return new lh(this,i,d,p,_)}clear({color:i,depth:d,stencil:p}){const _=this.gl;let w=0;i&&(w|=_.COLOR_BUFFER_BIT,this.clearColor.set(i),this.colorMask.set([!0,!0,!0,!0])),d!==void 0&&(w|=_.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(d),this.depthMask.set(!0)),p!==void 0&&(w|=_.STENCIL_BUFFER_BIT,this.clearStencil.set(p),this.stencilMask.set(255)),_.clear(w)}setCullFace(i){i.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(i.mode),this.frontFace.set(i.frontFace))}setDepthMode(i){i.func!==this.gl.ALWAYS||i.mask?(this.depthTest.set(!0),this.depthFunc.set(i.func),this.depthMask.set(i.mask),this.depthRange.set(i.range)):this.depthTest.set(!1)}setStencilMode(i){i.test.func!==this.gl.ALWAYS||i.mask?(this.stencilTest.set(!0),this.stencilMask.set(i.mask),this.stencilOp.set([i.fail,i.depthFail,i.pass]),this.stencilFunc.set({func:i.test.func,ref:i.ref,mask:i.test.mask})):this.stencilTest.set(!1)}setColorMode(i){a.bH(i.blendFunction,jr.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(i.blendFunction),this.blendColor.set(i.blendColor)),this.colorMask.set(i.mask)}createVertexArray(){var i;return Di(this.gl)?this.gl.createVertexArray():(i=this.gl.getExtension("OES_vertex_array_object"))===null||i===void 0?void 0:i.createVertexArrayOES()}deleteVertexArray(i){var d;return Di(this.gl)?this.gl.deleteVertexArray(i):(d=this.gl.getExtension("OES_vertex_array_object"))===null||d===void 0?void 0:d.deleteVertexArrayOES(i)}unbindVAO(){this.bindVertexArray.set(null)}}let ef;function Ym(x,i,d,p,_){const w=x.context,E=x.transform,M=w.gl,D=x.useProgram("collisionBox"),$=[];let U=0,K=0;for(let _e=0;_e<p.length;_e++){const Te=p[_e],Ce=i.getTile(Te).getBucket(d);if(!Ce)continue;const Ee=_?Ce.textCollisionBox:Ce.iconCollisionBox,Ie=Ce.collisionCircleArray;Ie.length>0&&($.push({circleArray:Ie,circleOffset:K,coord:Te}),U+=Ie.length/4,K=U),Ee&&D.draw(w,M.LINES,Wt.disabled,Qt.disabled,x.colorModeForRenderPass(),dr.disabled,G1(x.transform),x.style.map.terrain&&x.style.map.terrain.getTerrainData(Te),E.getProjectionData({overscaledTileID:Te,applyGlobeMatrix:!0,applyTerrainMatrix:!0}),d.id,Ee.layoutVertexBuffer,Ee.indexBuffer,Ee.segments,null,x.transform.zoom,null,null,Ee.collisionVertexBuffer)}if(!_||!$.length)return;const H=x.useProgram("collisionCircle"),ee=new a.c0;ee.resize(4*U),ee._trim();let ae=0;for(const _e of $)for(let Te=0;Te<_e.circleArray.length/4;Te++){const Ce=4*Te,Ee=_e.circleArray[Ce+0],Ie=_e.circleArray[Ce+1],Le=_e.circleArray[Ce+2],Pe=_e.circleArray[Ce+3];ee.emplace(ae++,Ee,Ie,Le,Pe,0),ee.emplace(ae++,Ee,Ie,Le,Pe,1),ee.emplace(ae++,Ee,Ie,Le,Pe,2),ee.emplace(ae++,Ee,Ie,Le,Pe,3)}(!ef||ef.length<2*U)&&(ef=function(_e){const Te=2*_e,Ce=new a.c2;Ce.resize(Te),Ce._trim();for(let Ee=0;Ee<Te;Ee++){const Ie=6*Ee;Ce.uint16[Ie+0]=4*Ee+0,Ce.uint16[Ie+1]=4*Ee+1,Ce.uint16[Ie+2]=4*Ee+2,Ce.uint16[Ie+3]=4*Ee+2,Ce.uint16[Ie+4]=4*Ee+3,Ce.uint16[Ie+5]=4*Ee+0}return Ce}(U));const me=w.createIndexBuffer(ef,!0),ge=w.createVertexBuffer(ee,a.c1.members,!0);for(const _e of $){const Te=Sc(x.transform);H.draw(w,M.TRIANGLES,Wt.disabled,Qt.disabled,x.colorModeForRenderPass(),dr.disabled,Te,x.style.map.terrain&&x.style.map.terrain.getTerrainData(_e.coord),null,d.id,ge,me,a.aM.simpleSegment(0,2*_e.circleOffset,_e.circleArray.length,_e.circleArray.length/2),null,x.transform.zoom,null,null,null)}ge.destroy(),me.destroy()}const J1=a.ag(new Float32Array(16));function Qm(x,i,d,p,_,w){const{horizontalAlign:E,verticalAlign:M}=a.aH(x);return new a.P((-(E-.5)*i/_+p[0])*w,(-(M-.5)*d/_+p[1])*w)}function tf(x,i,d,p,_,w){const E=i.tileAnchorPoint.add(new a.P(i.translation[0],i.translation[1]));if(i.pitchWithMap){let M=p.mult(w);d||(M=M.rotate(-_));const D=E.add(M);return ot(D.x,D.y,i.pitchedLabelPlaneMatrix,i.getElevation).point}if(d){const M=Ze(i.tileAnchorPoint.x+1,i.tileAnchorPoint.y,i).point.sub(x),D=Math.atan(M.y/M.x)+(M.x<0?Math.PI:0);return x.add(p.rotate(D))}return x.add(p)}function rf(x,i,d,p,_,w,E,M,D,$,U,K){const H=x.text.placedSymbolArray,ee=x.text.dynamicLayoutVertexArray,ae=x.icon.dynamicLayoutVertexArray,me={};ee.clear();for(let ge=0;ge<H.length;ge++){const _e=H.get(ge),Te=_e.hidden||!_e.crossTileID||x.allowVerticalPlacement&&!_e.placedOrientation?null:p[_e.crossTileID];if(Te){const Ce=new a.P(_e.anchorX,_e.anchorY),Ee={getElevation:K,width:_.width,height:_.height,pitchedLabelPlaneMatrix:w,pitchWithMap:d,transform:_,tileAnchorPoint:Ce,translation:$,unwrappedTileID:U},Ie=d?Nt(Ce.x,Ce.y,Ee):Ze(Ce.x,Ce.y,Ee),Le=Ds(_.cameraToCenterDistance,Ie.signedDistanceFromCamera);let Pe=a.ap(x.textSizeData,M,_e)*Le/a.aB;d&&(Pe*=x.tilePixelRatio/E);const{width:Ne,height:qe,anchor:Ve,textOffset:Ge,textBoxScale:We}=Te,ct=Qm(Ve,Ne,qe,Ge,We,Pe),ut=_.getPitchedTextCorrection(Ce.x+$[0],Ce.y+$[1],U),tt=tf(Ie.point,Ee,i,ct,-_.bearingInRadians,ut),At=x.allowVerticalPlacement&&_e.placedOrientation===a.ao.vertical?Math.PI/2:0;for(let qt=0;qt<_e.numGlyphs;qt++)a.av(ee,tt,At);D&&_e.associatedIconIndex>=0&&(me[_e.associatedIconIndex]={shiftedAnchor:tt,angle:At})}else hr(_e.numGlyphs,ee)}if(D){ae.clear();const ge=x.icon.placedSymbolArray;for(let _e=0;_e<ge.length;_e++){const Te=ge.get(_e);if(Te.hidden)hr(Te.numGlyphs,ae);else{const Ce=me[_e];if(Ce)for(let Ee=0;Ee<Te.numGlyphs;Ee++)a.av(ae,Ce.shiftedAnchor,Ce.angle);else hr(Te.numGlyphs,ae)}}x.icon.dynamicLayoutVertexBuffer.updateData(ae)}x.text.dynamicLayoutVertexBuffer.updateData(ee)}function nf(x,i,d){return d.iconsInText&&i?"symbolTextAndIcon":x?"symbolSDF":"symbolIcon"}function sf(x,i,d,p,_,w,E,M,D,$,U,K,H){const ee=x.context,ae=ee.gl,me=x.transform,ge=M==="map",_e=D==="map",Te=M!=="viewport"&&d.layout.get("symbol-placement")!=="point",Ce=ge&&!_e&&!Te,Ee=!d.layout.get("symbol-sort-key").isConstant();let Ie=!1;const Le=x.getDepthModeForSublayer(0,Wt.ReadOnly),Pe=d._unevaluatedLayout.hasValue("text-variable-anchor")||d._unevaluatedLayout.hasValue("text-variable-anchor-offset"),Ne=[],qe=me.getCircleRadiusCorrection();for(const Ve of p){const Ge=i.getTile(Ve),We=Ge.getBucket(d);if(!We)continue;const ct=_?We.text:We.icon;if(!ct||!ct.segments.get().length||!ct.hasVisibleVertices)continue;const ut=ct.programConfigurations.get(d.id),tt=_||We.sdfIcons,At=_?We.textSizeData:We.iconSizeData,qt=_e||me.pitch!==0,Mr=x.useProgram(nf(tt,_,We),ut),Ir=a.an(At,me.zoom),Fr=x.style.map.terrain&&x.style.map.terrain.getTerrainData(Ve);let sn,Ur,gr,Xr,Ti=[0,0],Cn=null;if(_)Ur=Ge.glyphAtlasTexture,gr=ae.LINEAR,sn=Ge.glyphAtlasTexture.size,We.iconsInText&&(Ti=Ge.imageAtlasTexture.size,Cn=Ge.imageAtlasTexture,Xr=qt||x.options.rotating||x.options.zooming||At.kind==="composite"||At.kind==="camera"?ae.LINEAR:ae.NEAREST);else{const _n=d.layout.get("icon-size").constantOr(0)!==1||We.iconsNeedLinear;Ur=Ge.imageAtlasTexture,gr=tt||x.options.rotating||x.options.zooming||_n||qt?ae.LINEAR:ae.NEAREST,sn=Ge.imageAtlasTexture.size}const Pn=a.aC(Ge,1,x.transform.zoom),Zi=tr(ge,x.transform,Pn),$a=a.L();a.aq($a,Zi);const lo=zr(_e,ge,x.transform,Pn),Va=a.aD(me,Ge,w,E),zl=me.getProjectionData({overscaledTileID:Ve,applyGlobeMatrix:!H,applyTerrainMatrix:!0}),Tf=Pe&&We.hasTextData(),jc=d.layout.get("icon-text-fit")!=="none"&&Tf&&We.hasIconData();if(Te){const _n=x.style.map.terrain?(bs,oi)=>x.style.map.terrain.getElevation(Ve,bs,oi):null,Zn=d.layout.get("text-rotation-alignment")==="map";$i(We,x,_,Zi,$a,_e,$,Zn,Ve.toUnwrapped(),me.width,me.height,Va,_n)}const sa=_&&Pe||jc,vs=Te||sa?J1:_e?Zi:x.transform.clipSpaceToPixelsMatrix,Oo=tt&&d.paint.get(_?"text-halo-width":"icon-halo-width").constantOr(1)!==0;let zo;zo=tt?We.iconsInText?b_(At.kind,Ir,Ce,_e,Te,sa,x,vs,lo,Va,sn,Ti,qe):$m(At.kind,Ir,Ce,_e,Te,sa,x,vs,lo,Va,_,sn,0,qe):x_(At.kind,Ir,Ce,_e,Te,sa,x,vs,lo,Va,_,sn,qe);const xs={program:Mr,buffers:ct,uniformValues:zo,projectionData:zl,atlasTexture:Ur,atlasTextureIcon:Cn,atlasInterpolation:gr,atlasInterpolationIcon:Xr,isSDF:tt,hasHalo:Oo};if(Ee&&We.canOverlap){Ie=!0;const _n=ct.segments.get();for(const Zn of _n)Ne.push({segments:new a.aM([Zn]),sortKey:Zn.sortKey,state:xs,terrainData:Fr})}else Ne.push({segments:ct.segments,sortKey:0,state:xs,terrainData:Fr})}Ie&&Ne.sort((Ve,Ge)=>Ve.sortKey-Ge.sortKey);for(const Ve of Ne){const Ge=Ve.state;if(ee.activeTexture.set(ae.TEXTURE0),Ge.atlasTexture.bind(Ge.atlasInterpolation,ae.CLAMP_TO_EDGE),Ge.atlasTextureIcon&&(ee.activeTexture.set(ae.TEXTURE1),Ge.atlasTextureIcon&&Ge.atlasTextureIcon.bind(Ge.atlasInterpolationIcon,ae.CLAMP_TO_EDGE)),Ge.isSDF){const We=Ge.uniformValues;Ge.hasHalo&&(We.u_is_halo=1,Jm(Ge.buffers,Ve.segments,d,x,Ge.program,Le,U,K,We,Ge.projectionData,Ve.terrainData)),We.u_is_halo=0}Jm(Ge.buffers,Ve.segments,d,x,Ge.program,Le,U,K,Ge.uniformValues,Ge.projectionData,Ve.terrainData)}}function Jm(x,i,d,p,_,w,E,M,D,$,U){const K=p.context;_.draw(K,K.gl.TRIANGLES,w,E,M,dr.backCCW,D,U,$,d.id,x.layoutVertexBuffer,x.indexBuffer,i,d.paint,p.transform.zoom,x.programConfigurations.get(d.id),x.dynamicLayoutVertexBuffer,x.opacityVertexBuffer)}function of(x,i,d,p,_){const w=x.context,E=w.gl,M=Qt.disabled,D=new jr([E.ONE,E.ONE],a.bf.transparent,[!0,!0,!0,!0]),$=i.getBucket(d);if(!$)return;const U=p.key;let K=d.heatmapFbos.get(U);K||(K=ch(w,i.tileSize,i.tileSize),d.heatmapFbos.set(U,K)),w.bindFramebuffer.set(K.framebuffer),w.viewport.set([0,0,i.tileSize,i.tileSize]),w.clear({color:a.bf.transparent});const H=$.programConfigurations.get(d.id),ee=x.useProgram("heatmap",H,!_),ae=x.transform.getProjectionData({overscaledTileID:i.tileID,applyGlobeMatrix:!0,applyTerrainMatrix:!0}),me=x.style.map.terrain.getTerrainData(p);ee.draw(w,E.TRIANGLES,Wt.disabled,M,D,dr.disabled,Fm(i,x.transform.zoom,d.paint.get("heatmap-intensity"),1),me,ae,d.id,$.layoutVertexBuffer,$.indexBuffer,$.segments,d.paint,x.transform.zoom,H)}function af(x,i,d,p,_){const w=x.context,E=w.gl,M=x.transform;w.setColorMode(x.colorModeForRenderPass());const D=Al(w,i),$=d.key,U=i.heatmapFbos.get($);if(!U)return;w.activeTexture.set(E.TEXTURE0),E.bindTexture(E.TEXTURE_2D,U.colorAttachment.get()),w.activeTexture.set(E.TEXTURE1),D.bind(E.LINEAR,E.CLAMP_TO_EDGE);const K=M.getProjectionData({overscaledTileID:d,applyTerrainMatrix:_,applyGlobeMatrix:!p});x.useProgram("heatmapTexture").draw(w,E.TRIANGLES,Wt.disabled,Qt.disabled,x.colorModeForRenderPass(),dr.disabled,d_(x,i,0,1),null,K,i.id,x.rasterBoundsBuffer,x.quadTriangleIndexBuffer,x.rasterBoundsSegments,i.paint,M.zoom),U.destroy(),i.heatmapFbos.delete($)}function ch(x,i,d){var p,_;const w=x.gl,E=w.createTexture();w.bindTexture(w.TEXTURE_2D,E),w.texParameteri(w.TEXTURE_2D,w.TEXTURE_WRAP_S,w.CLAMP_TO_EDGE),w.texParameteri(w.TEXTURE_2D,w.TEXTURE_WRAP_T,w.CLAMP_TO_EDGE),w.texParameteri(w.TEXTURE_2D,w.TEXTURE_MIN_FILTER,w.LINEAR),w.texParameteri(w.TEXTURE_2D,w.TEXTURE_MAG_FILTER,w.LINEAR);const M=(p=x.HALF_FLOAT)!==null&&p!==void 0?p:w.UNSIGNED_BYTE,D=(_=x.RGBA16F)!==null&&_!==void 0?_:w.RGBA;w.texImage2D(w.TEXTURE_2D,0,D,i,d,0,w.RGBA,M,null);const $=x.createFramebuffer(i,d,!1,!1);return $.colorAttachment.set(E),$}function Al(x,i){return i.colorRampTexture||(i.colorRampTexture=new a.T(x,i.colorRamp,x.gl.RGBA)),i.colorRampTexture}function lf(x,i,d,p,_,w,E,M){let D=256;if(_.stepInterpolant){const $=i.getSource().maxzoom,U=E.canonical.z===$?Math.ceil(1<<x.transform.maxZoom-E.canonical.z):1;D=a.ah(a.c4(w.maxLineLength/a.$*1024*U),256,d.maxTextureSize)}return M.gradient=a.c5({expression:_.gradientExpression(),evaluationKey:"lineProgress",resolution:D,image:M.gradient||void 0,clips:w.lineClipsArray}),M.texture?M.texture.update(M.gradient):M.texture=new a.T(d,M.gradient,p.RGBA),M.version=_.gradientVersion,M.texture}function ew(x,i,d,p,_){x.activeTexture.set(i.TEXTURE0),d.imageAtlasTexture.bind(i.LINEAR,i.CLAMP_TO_EDGE),p.updatePaintBuffers(_)}function uh(x,i,d,p,_,w){(_||x.lineAtlas.dirty)&&(i.activeTexture.set(d.TEXTURE0),x.lineAtlas.bind(i)),p.updatePaintBuffers(w)}function tw(x,i,d,p,_,w,E){const M=w.gradients[_.id];let D=M.texture;_.gradientVersion!==M.version&&(D=lf(x,i,d,p,_,w,E,M)),d.activeTexture.set(p.TEXTURE0),D.bind(_.stepInterpolant?p.NEAREST:p.LINEAR,p.CLAMP_TO_EDGE)}function M_(x,i,d,p,_,w,E,M,D){const $=w.gradients[_.id];let U=$.texture;_.gradientVersion!==$.version&&(U=lf(x,i,d,p,_,w,E,$)),d.activeTexture.set(p.TEXTURE0),U.bind(_.stepInterpolant?p.NEAREST:p.LINEAR,p.CLAMP_TO_EDGE),d.activeTexture.set(p.TEXTURE1),x.lineAtlas.bind(d),M.updatePaintBuffers(D)}function hh(x,i,d,p,_){if(!d||!p||!p.imageAtlas)return;const w=p.imageAtlas.patternPositions;let E=w[d.to.toString()],M=w[d.from.toString()];if(!E&&M&&(E=M),!M&&E&&(M=E),!E||!M){const D=_.getPaintProperty(i);E=w[D],M=w[D]}E&&M&&x.setConstantPatternPositions(E,M)}function cf(x,i,d,p,_,w,E,M){const D=x.context.gl,$="fill-pattern",U=d.paint.get($),K=U&&U.constantOr(1),H=d.getCrossfadeParameters();let ee,ae,me,ge,_e;const Te=x.transform,Ce=d.paint.get("fill-translate"),Ee=d.paint.get("fill-translate-anchor");E?(ae=K&&!d.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",ee=D.LINES):(ae=K?"fillPattern":"fill",ee=D.TRIANGLES);const Ie=U.constantOr(null);for(const Le of p){const Pe=i.getTile(Le);if(K&&!Pe.patternsLoaded())continue;const Ne=Pe.getBucket(d);if(!Ne)continue;const qe=Ne.programConfigurations.get(d.id),Ve=x.useProgram(ae,qe),Ge=x.style.map.terrain&&x.style.map.terrain.getTerrainData(Le);K&&(x.context.activeTexture.set(D.TEXTURE0),Pe.imageAtlasTexture.bind(D.LINEAR,D.CLAMP_TO_EDGE),qe.updatePaintBuffers(H)),hh(qe,$,Ie,Pe,d);const We=Te.getProjectionData({overscaledTileID:Le,applyGlobeMatrix:!M,applyTerrainMatrix:!0}),ct=a.aD(Te,Pe,Ce,Ee);if(E){ge=Ne.indexBuffer2,_e=Ne.segments2;const tt=[D.drawingBufferWidth,D.drawingBufferHeight];me=ae==="fillOutlinePattern"&&K?U1(x,H,Pe,tt,ct):nh(tt,ct)}else ge=Ne.indexBuffer,_e=Ne.segments,me=K?wc(x,H,Pe,ct):{u_fill_translate:ct};const ut=x.stencilModeForClipping(Le);Ve.draw(x.context,ee,_,ut,w,dr.backCCW,me,Ge,We,d.id,Ne.layoutVertexBuffer,ge,_e,d.paint,x.transform.zoom,qe)}}function uf(x,i,d,p,_,w,E,M){const D=x.context,$=D.gl,U="fill-extrusion-pattern",K=d.paint.get(U),H=K.constantOr(1),ee=d.getCrossfadeParameters(),ae=d.paint.get("fill-extrusion-opacity"),me=K.constantOr(null),ge=x.transform;for(const _e of p){const Te=i.getTile(_e),Ce=Te.getBucket(d);if(!Ce)continue;const Ee=x.style.map.terrain&&x.style.map.terrain.getTerrainData(_e),Ie=Ce.programConfigurations.get(d.id),Le=x.useProgram(H?"fillExtrusionPattern":"fillExtrusion",Ie);H&&(x.context.activeTexture.set($.TEXTURE0),Te.imageAtlasTexture.bind($.LINEAR,$.CLAMP_TO_EDGE),Ie.updatePaintBuffers(ee));const Pe=ge.getProjectionData({overscaledTileID:_e,applyGlobeMatrix:!M,applyTerrainMatrix:!0});hh(Ie,U,me,Te,d);const Ne=a.aD(ge,Te,d.paint.get("fill-extrusion-translate"),d.paint.get("fill-extrusion-translate-anchor")),qe=d.paint.get("fill-extrusion-vertical-gradient"),Ve=H?jm(x,qe,ae,Ne,_e,ee,Te):u_(x,qe,ae,Ne);Le.draw(D,D.gl.TRIANGLES,_,w,E,dr.backCCW,Ve,Ee,Pe,d.id,Ce.layoutVertexBuffer,Ce.indexBuffer,Ce.segments,d.paint,x.transform.zoom,Ie,x.style.map.terrain&&Ce.centroidVertexBuffer)}}function hf(x,i,d,p,_,w,E,M,D){var $;const U=x.style.projection,K=x.context,H=x.transform,ee=K.gl,ae=[`#define NUM_ILLUMINATION_SOURCES ${d.paint.get("hillshade-highlight-color").values.length}`],me=x.useProgram("hillshade",null,!1,ae),ge=!x.options.moving;for(const _e of p){const Te=i.getTile(_e),Ce=Te.fbo;if(!Ce)continue;const Ee=U.getMeshFromTileID(K,_e.canonical,M,!0,"raster"),Ie=($=x.style.map.terrain)===null||$===void 0?void 0:$.getTerrainData(_e);K.activeTexture.set(ee.TEXTURE0),ee.bindTexture(ee.TEXTURE_2D,Ce.colorAttachment.get());const Le=H.getProjectionData({overscaledTileID:_e,aligned:ge,applyGlobeMatrix:!D,applyTerrainMatrix:!0});me.draw(K,ee.TRIANGLES,w,_[_e.overscaledZ],E,dr.backCCW,f_(x,Te,d),Ie,Le,d.id,Ee.vertexBuffer,Ee.indexBuffer,Ee.segments)}}function Pc(x,i,d,p,_,w,E,M,D){var $;const U=x.style.projection,K=x.context,H=x.transform,ee=K.gl,ae=x.useProgram("colorRelief"),me=!x.options.moving;let ge=!0,_e=0;for(const Te of p){const Ce=i.getTile(Te),Ee=Ce.dem;if(ge){const Ve=ee.getParameter(ee.MAX_TEXTURE_SIZE),{elevationTexture:Ge,colorTexture:We}=d.getColorRampTextures(K,Ve,Ee.getUnpackVector());K.activeTexture.set(ee.TEXTURE1),Ge.bind(ee.NEAREST,ee.CLAMP_TO_EDGE),K.activeTexture.set(ee.TEXTURE4),We.bind(ee.LINEAR,ee.CLAMP_TO_EDGE),ge=!1,_e=Ge.size[0]}if(!Ee||!Ee.data)continue;const Ie=Ee.stride,Le=Ee.getPixels();if(K.activeTexture.set(ee.TEXTURE0),K.pixelStoreUnpackPremultiplyAlpha.set(!1),Ce.demTexture=Ce.demTexture||x.getTileTexture(Ie),Ce.demTexture){const Ve=Ce.demTexture;Ve.update(Le,{premultiply:!1}),Ve.bind(ee.LINEAR,ee.CLAMP_TO_EDGE)}else Ce.demTexture=new a.T(K,Le,ee.RGBA,{premultiply:!1}),Ce.demTexture.bind(ee.LINEAR,ee.CLAMP_TO_EDGE);const Pe=U.getMeshFromTileID(K,Te.canonical,M,!0,"raster"),Ne=($=x.style.map.terrain)===null||$===void 0?void 0:$.getTerrainData(Te),qe=H.getProjectionData({overscaledTileID:Te,aligned:me,applyGlobeMatrix:!D,applyTerrainMatrix:!0});ae.draw(K,ee.TRIANGLES,w,_[Te.overscaledZ],E,dr.backCCW,m_(d,Ce.dem,_e),Ne,qe,d.id,Pe.vertexBuffer,Pe.indexBuffer,Pe.segments)}}const dh=[new a.P(0,0),new a.P(a.$,0),new a.P(a.$,a.$),new a.P(0,a.$)];function df(x,i,d,p,_,w,E,M,D=!1,$=!1){const U=p[p.length-1].overscaledZ,K=x.context,H=K.gl,ee=x.useProgram("raster"),ae=x.transform,me=x.style.projection,ge=x.colorModeForRenderPass(),_e=!x.options.moving,Te=d.paint.get("raster-opacity"),Ce=d.paint.get("raster-resampling"),Ee=d.paint.get("raster-fade-duration"),Ie=!!x.style.map.terrain;for(const Le of p){const Pe=x.getDepthModeForSublayer(Le.overscaledZ-U,Te===1?Wt.ReadWrite:Wt.ReadOnly,H.LESS),Ne=i.getTile(Le),qe=Ce==="nearest"?H.NEAREST:H.LINEAR;K.activeTexture.set(H.TEXTURE0),Ne.texture.bind(qe,H.CLAMP_TO_EDGE,H.LINEAR_MIPMAP_NEAREST),K.activeTexture.set(H.TEXTURE1);const{parentTile:Ve,parentScaleBy:Ge,parentTopLeft:We,fadeValues:ct}=I_(Ne,i,Ee,Ie);Ne.fadeOpacity=ct.tileOpacity,Ve?(Ve.fadeOpacity=ct.parentTileOpacity,Ve.texture.bind(qe,H.CLAMP_TO_EDGE,H.LINEAR_MIPMAP_NEAREST)):Ne.texture.bind(qe,H.CLAMP_TO_EDGE,H.LINEAR_MIPMAP_NEAREST),Ne.texture.useMipmap&&K.extTextureFilterAnisotropic&&x.transform.pitch>20&&H.texParameterf(H.TEXTURE_2D,K.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,K.extTextureFilterAnisotropicMax);const ut=x.style.map.terrain&&x.style.map.terrain.getTerrainData(Le),tt=ae.getProjectionData({overscaledTileID:Le,aligned:_e,applyGlobeMatrix:!$,applyTerrainMatrix:!0}),At=Wd(We,Ge,ct.fadeMix,d,M),qt=me.getMeshFromTileID(K,Le.canonical,w,E,"raster");ee.draw(K,H.TRIANGLES,Pe,_?_[Le.overscaledZ]:Qt.disabled,ge,D?dr.frontCCW:dr.backCCW,At,ut,tt,d.id,qt.vertexBuffer,qt.indexBuffer,qt.segments)}}function I_(x,i,d,p){const _={parentTile:null,parentScaleBy:1,parentTopLeft:[0,0],fadeValues:{tileOpacity:1,parentTileOpacity:1,fadeMix:{opacity:1,mix:0}}};if(d===0||p)return _;if(x.fadingParentID){const w=i._getLoadedTile(x.fadingParentID);if(!w)return _;const E=Math.pow(2,w.tileID.overscaledZ-x.tileID.overscaledZ),M=[x.tileID.canonical.x*E%1,x.tileID.canonical.y*E%1],D=function($,U,K){const H=P.now(),ee=(H-U.timeAdded)/K,ae=$.fadingDirection===Me.Incoming,me=a.ah((H-$.timeAdded)/K,0,1),ge=a.ah(1-ee,0,1),_e=ae?me:ge;return{tileOpacity:_e,parentTileOpacity:ae?ge:me,fadeMix:{opacity:1,mix:1-_e}}}(x,w,d);return{parentTile:w,parentScaleBy:E,parentTopLeft:M,fadeValues:D}}if(x.selfFading){const w=function(E,M){const D=P.now(),$=a.ah((D-E.timeAdded)/M,0,1);return{tileOpacity:$,fadeMix:{opacity:$,mix:0}}}(x,d);return{parentTile:null,parentScaleBy:1,parentTopLeft:[0,0],fadeValues:w}}return _}const gn=new a.bf(1,0,0,1),kl=new a.bf(0,1,0,1),js=new a.bf(0,0,1,1),eg=new a.bf(1,0,1,1),ff=new a.bf(0,1,1,1);function tg(x,i,d,p){Ac(x,0,i+d/2,x.transform.width,d,p)}function Ml(x,i,d,p){Ac(x,i-d/2,0,d,x.transform.height,p)}function Ac(x,i,d,p,_,w){const E=x.context,M=E.gl;M.enable(M.SCISSOR_TEST),M.scissor(i*x.pixelRatio,d*x.pixelRatio,p*x.pixelRatio,_*x.pixelRatio),E.clear({color:w}),M.disable(M.SCISSOR_TEST)}function fh(x,i,d){const p=x.context,_=p.gl,w=x.useProgram("debug"),E=Wt.disabled,M=Qt.disabled,D=x.colorModeForRenderPass(),$="$debug",U=x.style.map.terrain&&x.style.map.terrain.getTerrainData(d);p.activeTexture.set(_.TEXTURE0);const K=i.getTileByID(d.key).latestRawTileData,H=Math.floor((K&&K.byteLength||0)/1024),ee=i.getTile(d).tileSize,ae=512/Math.min(ee,512)*(d.overscaledZ/x.transform.zoom)*.5;let me=d.canonical.toString();d.overscaledZ!==d.canonical.z&&(me+=` => ${d.overscaledZ}`),function(_e,Te){_e.initDebugOverlayCanvas();const Ce=_e.debugOverlayCanvas,Ee=_e.context.gl,Ie=_e.debugOverlayCanvas.getContext("2d");Ie.clearRect(0,0,Ce.width,Ce.height),Ie.shadowColor="white",Ie.shadowBlur=2,Ie.lineWidth=1.5,Ie.strokeStyle="white",Ie.textBaseline="top",Ie.font="bold 36px Open Sans, sans-serif",Ie.fillText(Te,5,5),Ie.strokeText(Te,5,5),_e.debugOverlayTexture.update(Ce),_e.debugOverlayTexture.bind(Ee.LINEAR,Ee.CLAMP_TO_EDGE)}(x,`${me} ${H}kB`);const ge=x.transform.getProjectionData({overscaledTileID:d,applyGlobeMatrix:!0,applyTerrainMatrix:!0});w.draw(p,_.TRIANGLES,E,M,jr.alphaBlended,dr.disabled,h_(a.bf.transparent,ae),null,ge,$,x.debugBuffer,x.quadTriangleIndexBuffer,x.debugSegments),w.draw(p,_.LINE_STRIP,E,M,D,dr.disabled,h_(a.bf.red),U,ge,$,x.debugBuffer,x.tileBorderIndexBuffer,x.debugSegments)}function pf(x,i,d,p){const{isRenderingGlobe:_}=p,w=x.context,E=w.gl,M=x.transform,D=x.colorModeForRenderPass(),$=x.getDepthModeFor3D(),U=x.useProgram("terrain");w.bindFramebuffer.set(null),w.viewport.set([0,0,x.width,x.height]);for(const K of d){const H=i.getTerrainMesh(K.tileID),ee=x.renderToTexture.getTexture(K),ae=i.getTerrainData(K.tileID);w.activeTexture.set(E.TEXTURE0),E.bindTexture(E.TEXTURE_2D,ee.texture);const me=i.getMeshFrameDelta(M.zoom),ge=M.calculateFogMatrix(K.tileID.toUnwrapped()),_e=zm(me,ge,x.style.sky,M.pitch,_),Te=M.getProjectionData({overscaledTileID:K.tileID,applyTerrainMatrix:!1,applyGlobeMatrix:!0});U.draw(w,E.TRIANGLES,$,Qt.disabled,D,dr.backCCW,_e,ae,Te,"terrain",H.vertexBuffer,H.indexBuffer,H.segments)}}function rg(x,i){if(!i.mesh){const d=new a.aL;d.emplaceBack(-1,-1),d.emplaceBack(1,-1),d.emplaceBack(1,1),d.emplaceBack(-1,1);const p=new a.aN;p.emplaceBack(0,1,2),p.emplaceBack(0,2,3),i.mesh=new mc(x.createVertexBuffer(d,Wi.members),x.createIndexBuffer(p),a.aM.simpleSegment(0,0,d.length,p.length))}return i.mesh}class R_{constructor(i,d){this.context=new Q1(i),this.transform=d,this._tileTextures={},this.terrainFacilitator={dirty:!0,matrix:a.ag(new Float64Array(16)),renderTime:0},this.setup(),this.numSublayers=lt.maxUnderzooming+lt.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new Hu}resize(i,d,p){if(this.width=Math.floor(i*p),this.height=Math.floor(d*p),this.pixelRatio=p,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const _ of this.style._order)this.style._layers[_].resize()}setup(){const i=this.context,d=new a.aL;d.emplaceBack(0,0),d.emplaceBack(a.$,0),d.emplaceBack(0,a.$),d.emplaceBack(a.$,a.$),this.tileExtentBuffer=i.createVertexBuffer(d,Wi.members),this.tileExtentSegments=a.aM.simpleSegment(0,0,4,2);const p=new a.aL;p.emplaceBack(0,0),p.emplaceBack(a.$,0),p.emplaceBack(0,a.$),p.emplaceBack(a.$,a.$),this.debugBuffer=i.createVertexBuffer(p,Wi.members),this.debugSegments=a.aM.simpleSegment(0,0,4,5);const _=new a.c7;_.emplaceBack(0,0,0,0),_.emplaceBack(a.$,0,a.$,0),_.emplaceBack(0,a.$,0,a.$),_.emplaceBack(a.$,a.$,a.$,a.$),this.rasterBoundsBuffer=i.createVertexBuffer(_,V1.members),this.rasterBoundsSegments=a.aM.simpleSegment(0,0,4,2);const w=new a.aL;w.emplaceBack(0,0),w.emplaceBack(a.$,0),w.emplaceBack(0,a.$),w.emplaceBack(a.$,a.$),this.rasterBoundsBufferPosOnly=i.createVertexBuffer(w,Wi.members),this.rasterBoundsSegmentsPosOnly=a.aM.simpleSegment(0,0,4,5);const E=new a.aL;E.emplaceBack(0,0),E.emplaceBack(1,0),E.emplaceBack(0,1),E.emplaceBack(1,1),this.viewportBuffer=i.createVertexBuffer(E,Wi.members),this.viewportSegments=a.aM.simpleSegment(0,0,4,2);const M=new a.c8;M.emplaceBack(0),M.emplaceBack(1),M.emplaceBack(3),M.emplaceBack(2),M.emplaceBack(0),this.tileBorderIndexBuffer=i.createIndexBuffer(M);const D=new a.aN;D.emplaceBack(1,0,2),D.emplaceBack(1,2,3),this.quadTriangleIndexBuffer=i.createIndexBuffer(D);const $=this.context.gl;this.stencilClearMode=new Qt({func:$.ALWAYS,mask:0},0,255,$.ZERO,$.ZERO,$.ZERO),this.tileExtentMesh=new mc(this.tileExtentBuffer,this.quadTriangleIndexBuffer,this.tileExtentSegments)}clearStencil(){const i=this.context,d=i.gl;this.nextStencilID=1,this.currentStencilSource=void 0;const p=a.L();a.bZ(p,0,this.width,this.height,0,0,1),a.N(p,p,[d.drawingBufferWidth,d.drawingBufferHeight,0]);const _={mainMatrix:p,tileMercatorCoords:[0,0,1,1],clippingPlane:[0,0,0,0],projectionTransition:0,fallbackMatrix:p};this.useProgram("clippingMask",null,!0).draw(i,d.TRIANGLES,Wt.disabled,this.stencilClearMode,jr.disabled,dr.disabled,null,null,_,"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}_renderTileClippingMasks(i,d,p){if(this.currentStencilSource===i.source||!i.isTileClipped()||!d||!d.length)return;this.currentStencilSource=i.source,this.nextStencilID+d.length>256&&this.clearStencil();const _=this.context;_.setColorMode(jr.disabled),_.setDepthMode(Wt.disabled);const w={};for(const E of d)w[E.key]=this.nextStencilID++;this._renderTileMasks(w,d,p,!0),this._renderTileMasks(w,d,p,!1),this._tileClippingMaskIDs=w}_renderTileMasks(i,d,p,_){const w=this.context,E=w.gl,M=this.style.projection,D=this.transform,$=this.useProgram("clippingMask");for(const U of d){const K=i[U.key],H=this.style.map.terrain&&this.style.map.terrain.getTerrainData(U),ee=M.getMeshFromTileID(this.context,U.canonical,_,!0,"stencil"),ae=D.getProjectionData({overscaledTileID:U,applyGlobeMatrix:!p,applyTerrainMatrix:!0});$.draw(w,E.TRIANGLES,Wt.disabled,new Qt({func:E.ALWAYS,mask:0},K,255,E.KEEP,E.KEEP,E.REPLACE),jr.disabled,p?dr.disabled:dr.backCCW,null,H,ae,"$clipping",ee.vertexBuffer,ee.indexBuffer,ee.segments)}}_renderTilesDepthBuffer(){const i=this.context,d=i.gl,p=this.style.projection,_=this.transform,w=this.useProgram("depth"),E=this.getDepthModeFor3D(),M=Kt(_,{tileSize:_.tileSize});for(const D of M){const $=this.style.map.terrain&&this.style.map.terrain.getTerrainData(D),U=p.getMeshFromTileID(this.context,D.canonical,!0,!0,"raster"),K=_.getProjectionData({overscaledTileID:D,applyGlobeMatrix:!0,applyTerrainMatrix:!0});w.draw(i,d.TRIANGLES,E,Qt.disabled,jr.disabled,dr.backCCW,null,$,K,"$clipping",U.vertexBuffer,U.indexBuffer,U.segments)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const i=this.nextStencilID++,d=this.context.gl;return new Qt({func:d.NOTEQUAL,mask:255},i,255,d.KEEP,d.KEEP,d.REPLACE)}stencilModeForClipping(i){const d=this.context.gl;return new Qt({func:d.EQUAL,mask:255},this._tileClippingMaskIDs[i.key],0,d.KEEP,d.KEEP,d.REPLACE)}getStencilConfigForOverlapAndUpdateStencilID(i){const d=this.context.gl,p=i.sort((E,M)=>M.overscaledZ-E.overscaledZ),_=p[p.length-1].overscaledZ,w=p[0].overscaledZ-_+1;if(w>1){this.currentStencilSource=void 0,this.nextStencilID+w>256&&this.clearStencil();const E={};for(let M=0;M<w;M++)E[M+_]=new Qt({func:d.GEQUAL,mask:255},M+this.nextStencilID,255,d.KEEP,d.KEEP,d.REPLACE);return this.nextStencilID+=w,[E,p]}return[{[_]:Qt.disabled},p]}stencilConfigForOverlapTwoPass(i){const d=this.context.gl,p=i.sort((E,M)=>M.overscaledZ-E.overscaledZ),_=p[p.length-1].overscaledZ,w=p[0].overscaledZ-_+1;if(this.clearStencil(),w>1){const E={},M={};for(let D=0;D<w;D++)E[D+_]=new Qt({func:d.GREATER,mask:255},w+1+D,255,d.KEEP,d.KEEP,d.REPLACE),M[D+_]=new Qt({func:d.GREATER,mask:255},1+D,255,d.KEEP,d.KEEP,d.REPLACE);return this.nextStencilID=2*w+1,[E,M,p]}return this.nextStencilID=3,[{[_]:new Qt({func:d.GREATER,mask:255},2,255,d.KEEP,d.KEEP,d.REPLACE)},{[_]:new Qt({func:d.GREATER,mask:255},1,255,d.KEEP,d.KEEP,d.REPLACE)},p]}colorModeForRenderPass(){const i=this.context.gl;return this._showOverdrawInspector?new jr([i.CONSTANT_COLOR,i.ONE],new a.bf(.125,.125,.125,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?jr.unblended:jr.alphaBlended}getDepthModeForSublayer(i,d,p){if(!this.opaquePassEnabledForLayer())return Wt.disabled;const _=1-((1+this.currentLayer)*this.numSublayers+i)*this.depthEpsilon;return new Wt(p||this.context.gl.LEQUAL,d,[_,_])}getDepthModeFor3D(){return new Wt(this.context.gl.LEQUAL,Wt.ReadWrite,this.depthRangeFor3D)}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}render(i,d){var p,_;this.style=i,this.options=d,this.lineAtlas=i.lineAtlas,this.imageManager=i.imageManager,this.glyphManager=i.glyphManager,this.symbolFadeChange=i.placement.symbolFadeChange(P.now()),this.imageManager.beginFrame();const w=this.style._order,E=this.style.sourceCaches,M={},D={},$={},U={isRenderingToTexture:!1,isRenderingGlobe:((p=i.projection)===null||p===void 0?void 0:p.transitionState)>0};for(const H in E){const ee=E[H];ee.used&&ee.prepare(this.context),M[H]=ee.getVisibleCoordinates(!1),D[H]=M[H].slice().reverse(),$[H]=ee.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(let H=0;H<w.length;H++)if(this.style._layers[w[H]].is3D()){this.opaquePassCutoff=H;break}this.maybeDrawDepthAndCoords(!1),this.renderToTexture&&(this.renderToTexture.prepareForRender(this.style,this.transform.zoom),this.opaquePassCutoff=0),this.renderPass="offscreen";for(const H of w){const ee=this.style._layers[H];if(!ee.hasOffscreenPass()||ee.isHidden(this.transform.zoom))continue;const ae=D[ee.source];(ee.type==="custom"||ae.length)&&this.renderLayer(this,E[ee.source],ee,ae,U)}if((_=this.style.projection)===null||_===void 0||_.updateGPUdependent({context:this.context,useProgram:H=>this.useProgram(H)}),this.context.viewport.set([0,0,this.width,this.height]),this.context.bindFramebuffer.set(null),this.context.clear({color:d.showOverdrawInspector?a.bf.black:a.bf.transparent,depth:1}),this.clearStencil(),this.style.sky&&function(H,ee){const ae=H.context,me=ae.gl,ge=((Le,Pe,Ne)=>{const qe=Math.cos(Pe.rollInRadians),Ve=Math.sin(Pe.rollInRadians),Ge=Be(Pe),We=Pe.getProjectionData({overscaledTileID:null,applyGlobeMatrix:!0,applyTerrainMatrix:!0}).projectionTransition;return{u_sky_color:Le.properties.get("sky-color"),u_horizon_color:Le.properties.get("horizon-color"),u_horizon:[(Pe.width/2-Ge*Ve)*Ne,(Pe.height/2+Ge*qe)*Ne],u_horizon_normal:[-Ve,qe],u_sky_horizon_blend:Le.properties.get("sky-horizon-blend")*Pe.height/2*Ne,u_sky_blend:We}})(ee,H.style.map.transform,H.pixelRatio),_e=new Wt(me.LEQUAL,Wt.ReadWrite,[0,1]),Te=Qt.disabled,Ce=H.colorModeForRenderPass(),Ee=H.useProgram("sky"),Ie=rg(ae,ee);Ee.draw(ae,me.TRIANGLES,_e,Te,Ce,dr.disabled,ge,null,void 0,"sky",Ie.vertexBuffer,Ie.indexBuffer,Ie.segments)}(this,this.style.sky),this._showOverdrawInspector=d.showOverdrawInspector,this.depthRangeFor3D=[0,1-(i._order.length+2)*this.numSublayers*this.depthEpsilon],!this.renderToTexture)for(this.renderPass="opaque",this.currentLayer=w.length-1;this.currentLayer>=0;this.currentLayer--){const H=this.style._layers[w[this.currentLayer]],ee=E[H.source],ae=M[H.source];this._renderTileClippingMasks(H,ae,!1),this.renderLayer(this,ee,H,ae,U)}this.renderPass="translucent";let K=!1;for(this.currentLayer=0;this.currentLayer<w.length;this.currentLayer++){const H=this.style._layers[w[this.currentLayer]],ee=E[H.source];if(this.renderToTexture&&this.renderToTexture.renderLayer(H,U))continue;this.opaquePassEnabledForLayer()||K||(K=!0,U.isRenderingGlobe&&!this.style.map.terrain&&this._renderTilesDepthBuffer());const ae=(H.type==="symbol"?$:D)[H.source];this._renderTileClippingMasks(H,M[H.source],!!this.renderToTexture),this.renderLayer(this,ee,H,ae,U)}if(U.isRenderingGlobe&&function(H,ee,ae){const me=H.context,ge=me.gl,_e=H.useProgram("atmosphere"),Te=new Wt(ge.LEQUAL,Wt.ReadOnly,[0,1]),Ce=H.transform,Ee=function(We,ct){const ut=We.properties.get("position"),tt=[-ut.x,-ut.y,-ut.z],At=a.ag(new Float64Array(16));return We.properties.get("anchor")==="map"&&(a.b6(At,At,ct.rollInRadians),a.b7(At,At,-ct.pitchInRadians),a.b6(At,At,ct.bearingInRadians),a.b7(At,At,ct.center.lat*Math.PI/180),a.bz(At,At,-ct.center.lng*Math.PI/180)),a.c6(tt,tt,At),tt}(ae,H.transform),Ie=Ce.getProjectionData({overscaledTileID:null,applyGlobeMatrix:!0,applyTerrainMatrix:!0}),Le=ee.properties.get("atmosphere-blend")*Ie.projectionTransition;if(Le===0)return;const Pe=wl(Ce.worldSize,Ce.center.lat),Ne=Ce.inverseProjectionMatrix,qe=new Float64Array(4);qe[3]=1,a.aw(qe,qe,Ce.modelViewProjectionMatrix),qe[0]/=qe[3],qe[1]/=qe[3],qe[2]/=qe[3],qe[3]=1,a.aw(qe,qe,Ne),qe[0]/=qe[3],qe[1]/=qe[3],qe[2]/=qe[3],qe[3]=1;const Ve=((We,ct,ut,tt,At)=>({u_sun_pos:We,u_atmosphere_blend:ct,u_globe_position:ut,u_globe_radius:tt,u_inv_proj_matrix:At}))(Ee,Le,[qe[0],qe[1],qe[2]],Pe,Ne),Ge=rg(me,ee);_e.draw(me,ge.TRIANGLES,Te,Qt.disabled,jr.alphaBlended,dr.disabled,Ve,null,null,"atmosphere",Ge.vertexBuffer,Ge.indexBuffer,Ge.segments)}(this,this.style.sky,this.style.light),this.options.showTileBoundaries){const H=function(ee,ae){let me=null;const ge=Object.values(ee._layers).flatMap(Ee=>Ee.source&&!Ee.isHidden(ae)?[ee.sourceCaches[Ee.source]]:[]),_e=ge.filter(Ee=>Ee.getSource().type==="vector"),Te=ge.filter(Ee=>Ee.getSource().type!=="vector"),Ce=Ee=>{(!me||me.getSource().maxzoom<Ee.getSource().maxzoom)&&(me=Ee)};return _e.forEach(Ee=>Ce(Ee)),me||Te.forEach(Ee=>Ce(Ee)),me}(this.style,this.transform.zoom);H&&function(ee,ae,me){for(let ge=0;ge<me.length;ge++)fh(ee,ae,me[ge])}(this,H,H.getVisibleCoordinates())}this.options.showPadding&&function(H){const ee=H.transform.padding;tg(H,H.transform.height-(ee.top||0),3,gn),tg(H,ee.bottom||0,3,kl),Ml(H,ee.left||0,3,js),Ml(H,H.transform.width-(ee.right||0),3,eg);const ae=H.transform.centerPoint;(function(me,ge,_e,Te){Ac(me,ge-1,_e-10,2,20,Te),Ac(me,ge-10,_e-1,20,2,Te)})(H,ae.x,H.transform.height-ae.y,ff)}(this),this.context.setDefault()}maybeDrawDepthAndCoords(i){if(!this.style||!this.style.map||!this.style.map.terrain)return;const d=this.terrainFacilitator.matrix,p=this.transform.modelViewProjectionMatrix;let _=this.terrainFacilitator.dirty;_||(_=i?!a.c9(d,p):!a.ca(d,p)),_||(_=this.style.map.terrain.sourceCache.anyTilesAfterTime(this.terrainFacilitator.renderTime)),_&&(a.cb(d,p),this.terrainFacilitator.renderTime=Date.now(),this.terrainFacilitator.dirty=!1,function(w,E){const M=w.context,D=M.gl,$=w.transform,U=jr.unblended,K=new Wt(D.LEQUAL,Wt.ReadWrite,[0,1]),H=E.sourceCache.getRenderableTiles(),ee=w.useProgram("terrainDepth");M.bindFramebuffer.set(E.getFramebuffer("depth").framebuffer),M.viewport.set([0,0,w.width/devicePixelRatio,w.height/devicePixelRatio]),M.clear({color:a.bf.transparent,depth:1});for(const ae of H){const me=E.getTerrainMesh(ae.tileID),ge=E.getTerrainData(ae.tileID),_e=$.getProjectionData({overscaledTileID:ae.tileID,applyTerrainMatrix:!1,applyGlobeMatrix:!0}),Te={u_ele_delta:E.getMeshFrameDelta($.zoom)};ee.draw(M,D.TRIANGLES,K,Qt.disabled,U,dr.backCCW,Te,ge,_e,"terrain",me.vertexBuffer,me.indexBuffer,me.segments)}M.bindFramebuffer.set(null),M.viewport.set([0,0,w.width,w.height])}(this,this.style.map.terrain),function(w,E){const M=w.context,D=M.gl,$=w.transform,U=jr.unblended,K=new Wt(D.LEQUAL,Wt.ReadWrite,[0,1]),H=E.getCoordsTexture(),ee=E.sourceCache.getRenderableTiles(),ae=w.useProgram("terrainCoords");M.bindFramebuffer.set(E.getFramebuffer("coords").framebuffer),M.viewport.set([0,0,w.width/devicePixelRatio,w.height/devicePixelRatio]),M.clear({color:a.bf.transparent,depth:1}),E.coordsIndex=[];for(const me of ee){const ge=E.getTerrainMesh(me.tileID),_e=E.getTerrainData(me.tileID);M.activeTexture.set(D.TEXTURE0),D.bindTexture(D.TEXTURE_2D,H.texture);const Te={u_terrain_coords_id:(255-E.coordsIndex.length)/255,u_texture:0,u_ele_delta:E.getMeshFrameDelta($.zoom)},Ce=$.getProjectionData({overscaledTileID:me.tileID,applyTerrainMatrix:!1,applyGlobeMatrix:!0});ae.draw(M,D.TRIANGLES,K,Qt.disabled,U,dr.backCCW,Te,_e,Ce,"terrain",ge.vertexBuffer,ge.indexBuffer,ge.segments),E.coordsIndex.push(me.tileID.key)}M.bindFramebuffer.set(null),M.viewport.set([0,0,w.width,w.height])}(this,this.style.map.terrain))}renderLayer(i,d,p,_,w){p.isHidden(this.transform.zoom)||(p.type==="background"||p.type==="custom"||(_||[]).length)&&(this.id=p.id,a.cc(p)?function(E,M,D,$,U,K){if(E.renderPass!=="translucent")return;const{isRenderingToTexture:H}=K,ee=Qt.disabled,ae=E.colorModeForRenderPass();(D._unevaluatedLayout.hasValue("text-variable-anchor")||D._unevaluatedLayout.hasValue("text-variable-anchor-offset"))&&function(me,ge,_e,Te,Ce,Ee,Ie,Le,Pe){const Ne=ge.transform,qe=ge.style.map.terrain,Ve=Ce==="map",Ge=Ee==="map";for(const We of me){const ct=Te.getTile(We),ut=ct.getBucket(_e);if(!ut||!ut.text||!ut.text.segments.get().length)continue;const tt=a.an(ut.textSizeData,Ne.zoom),At=a.aC(ct,1,ge.transform.zoom),qt=tr(Ve,ge.transform,At),Mr=_e.layout.get("icon-text-fit")!=="none"&&ut.hasIconData();if(tt){const Ir=Math.pow(2,Ne.zoom-ct.tileID.overscaledZ),Fr=qe?(sn,Ur)=>qe.getElevation(We,sn,Ur):null;rf(ut,Ve,Ge,Pe,Ne,qt,Ir,tt,Mr,a.aD(Ne,ct,Ie,Le),We.toUnwrapped(),Fr)}}}($,E,D,M,D.layout.get("text-rotation-alignment"),D.layout.get("text-pitch-alignment"),D.paint.get("text-translate"),D.paint.get("text-translate-anchor"),U),D.paint.get("icon-opacity").constantOr(1)!==0&&sf(E,M,D,$,!1,D.paint.get("icon-translate"),D.paint.get("icon-translate-anchor"),D.layout.get("icon-rotation-alignment"),D.layout.get("icon-pitch-alignment"),D.layout.get("icon-keep-upright"),ee,ae,H),D.paint.get("text-opacity").constantOr(1)!==0&&sf(E,M,D,$,!0,D.paint.get("text-translate"),D.paint.get("text-translate-anchor"),D.layout.get("text-rotation-alignment"),D.layout.get("text-pitch-alignment"),D.layout.get("text-keep-upright"),ee,ae,H),M.map.showCollisionBoxes&&(Ym(E,M,D,$,!0),Ym(E,M,D,$,!1))}(i,d,p,_,this.style.placement.variableOffsets,w):a.cd(p)?function(E,M,D,$,U){if(E.renderPass!=="translucent")return;const{isRenderingToTexture:K}=U,H=D.paint.get("circle-opacity"),ee=D.paint.get("circle-stroke-width"),ae=D.paint.get("circle-stroke-opacity"),me=!D.layout.get("circle-sort-key").isConstant();if(H.constantOr(1)===0&&(ee.constantOr(1)===0||ae.constantOr(1)===0))return;const ge=E.context,_e=ge.gl,Te=E.transform,Ce=E.getDepthModeForSublayer(0,Wt.ReadOnly),Ee=Qt.disabled,Ie=E.colorModeForRenderPass(),Le=[],Pe=Te.getCircleRadiusCorrection();for(let Ne=0;Ne<$.length;Ne++){const qe=$[Ne],Ve=M.getTile(qe),Ge=Ve.getBucket(D);if(!Ge)continue;const We=D.paint.get("circle-translate"),ct=D.paint.get("circle-translate-anchor"),ut=a.aD(Te,Ve,We,ct),tt=Ge.programConfigurations.get(D.id),At=E.useProgram("circle",tt),qt=Ge.layoutVertexBuffer,Mr=Ge.indexBuffer,Ir=E.style.map.terrain&&E.style.map.terrain.getTerrainData(qe),Fr={programConfiguration:tt,program:At,layoutVertexBuffer:qt,indexBuffer:Mr,uniformValues:Gd(E,Ve,D,ut,Pe),terrainData:Ir,projectionData:Te.getProjectionData({overscaledTileID:qe,applyGlobeMatrix:!K,applyTerrainMatrix:!0})};if(me){const sn=Ge.segments.get();for(const Ur of sn)Le.push({segments:new a.aM([Ur]),sortKey:Ur.sortKey,state:Fr})}else Le.push({segments:Ge.segments,sortKey:0,state:Fr})}me&&Le.sort((Ne,qe)=>Ne.sortKey-qe.sortKey);for(const Ne of Le){const{programConfiguration:qe,program:Ve,layoutVertexBuffer:Ge,indexBuffer:We,uniformValues:ct,terrainData:ut,projectionData:tt}=Ne.state;Ve.draw(ge,_e.TRIANGLES,Ce,Ee,Ie,dr.backCCW,ct,ut,tt,D.id,Ge,We,Ne.segments,D.paint,E.transform.zoom,qe)}}(i,d,p,_,w):a.ce(p)?function(E,M,D,$,U){if(D.paint.get("heatmap-opacity")===0)return;const K=E.context,{isRenderingToTexture:H,isRenderingGlobe:ee}=U;if(E.style.map.terrain){for(const ae of $){const me=M.getTile(ae);M.hasRenderableParent(ae)||(E.renderPass==="offscreen"?of(E,me,D,ae,ee):E.renderPass==="translucent"&&af(E,D,ae,H,ee))}K.viewport.set([0,0,E.width,E.height])}else E.renderPass==="offscreen"?function(ae,me,ge,_e){const Te=ae.context,Ce=Te.gl,Ee=ae.transform,Ie=Qt.disabled,Le=new jr([Ce.ONE,Ce.ONE],a.bf.transparent,[!0,!0,!0,!0]);(function(Pe,Ne,qe){const Ve=Pe.gl;Pe.activeTexture.set(Ve.TEXTURE1),Pe.viewport.set([0,0,Ne.width/4,Ne.height/4]);let Ge=qe.heatmapFbos.get(a.c3);Ge?(Ve.bindTexture(Ve.TEXTURE_2D,Ge.colorAttachment.get()),Pe.bindFramebuffer.set(Ge.framebuffer)):(Ge=ch(Pe,Ne.width/4,Ne.height/4),qe.heatmapFbos.set(a.c3,Ge))})(Te,ae,ge),Te.clear({color:a.bf.transparent});for(let Pe=0;Pe<_e.length;Pe++){const Ne=_e[Pe];if(me.hasRenderableParent(Ne))continue;const qe=me.getTile(Ne),Ve=qe.getBucket(ge);if(!Ve)continue;const Ge=Ve.programConfigurations.get(ge.id),We=ae.useProgram("heatmap",Ge),ct=Ee.getProjectionData({overscaledTileID:Ne,applyGlobeMatrix:!0,applyTerrainMatrix:!1}),ut=Ee.getCircleRadiusCorrection();We.draw(Te,Ce.TRIANGLES,Wt.disabled,Ie,Le,dr.backCCW,Fm(qe,Ee.zoom,ge.paint.get("heatmap-intensity"),ut),null,ct,ge.id,Ve.layoutVertexBuffer,Ve.indexBuffer,Ve.segments,ge.paint,Ee.zoom,Ge)}Te.viewport.set([0,0,ae.width,ae.height])}(E,M,D,$):E.renderPass==="translucent"&&function(ae,me){const ge=ae.context,_e=ge.gl;ge.setColorMode(ae.colorModeForRenderPass());const Te=me.heatmapFbos.get(a.c3);Te&&(ge.activeTexture.set(_e.TEXTURE0),_e.bindTexture(_e.TEXTURE_2D,Te.colorAttachment.get()),ge.activeTexture.set(_e.TEXTURE1),Al(ge,me).bind(_e.LINEAR,_e.CLAMP_TO_EDGE),ae.useProgram("heatmapTexture").draw(ge,_e.TRIANGLES,Wt.disabled,Qt.disabled,ae.colorModeForRenderPass(),dr.disabled,d_(ae,me,0,1),null,null,me.id,ae.viewportBuffer,ae.quadTriangleIndexBuffer,ae.viewportSegments,me.paint,ae.transform.zoom))}(E,D)}(i,d,p,_,w):a.cf(p)?function(E,M,D,$,U){if(E.renderPass!=="translucent")return;const{isRenderingToTexture:K}=U,H=D.paint.get("line-opacity"),ee=D.paint.get("line-width");if(H.constantOr(1)===0||ee.constantOr(1)===0)return;const ae=E.getDepthModeForSublayer(0,Wt.ReadOnly),me=E.colorModeForRenderPass(),ge=D.paint.get("line-dasharray"),_e=ge.constantOr(1),Te=D.paint.get("line-pattern"),Ce=Te.constantOr(1),Ee=D.paint.get("line-gradient"),Ie=D.getCrossfadeParameters();let Le;Le=Ce?"linePattern":_e&&Ee?"lineGradientSDF":_e?"lineSDF":Ee?"lineGradient":"line";const Pe=E.context,Ne=Pe.gl,qe=E.transform;let Ve=!0;for(const Ge of $){const We=M.getTile(Ge);if(Ce&&!We.patternsLoaded())continue;const ct=We.getBucket(D);if(!ct)continue;const ut=ct.programConfigurations.get(D.id),tt=E.context.program.get(),At=E.useProgram(Le,ut),qt=Ve||At.program!==tt,Mr=E.style.map.terrain&&E.style.map.terrain.getTerrainData(Ge),Ir=Te.constantOr(null),Fr=ge&&ge.constantOr(null);if(Ir&&We.imageAtlas){const Ti=We.imageAtlas,Cn=Ti.patternPositions[Ir.to.toString()],Pn=Ti.patternPositions[Ir.from.toString()];Cn&&Pn&&ut.setConstantPatternPositions(Cn,Pn)}else if(Fr){const Ti=D.layout.get("line-cap")==="round",Cn=E.lineAtlas.getDash(Fr.to,Ti),Pn=E.lineAtlas.getDash(Fr.from,Ti);ut.setConstantDashPositions(Cn,Pn)}const sn=qe.getProjectionData({overscaledTileID:Ge,applyGlobeMatrix:!K,applyTerrainMatrix:!0}),Ur=qe.getPixelScale();let gr;Ce?(gr=Sl(E,We,D,Ur,Ie),ew(Pe,Ne,We,ut,Ie)):_e&&Ee?(gr=__(E,We,D,Ur,Ie,ct.lineClipsArray.length),M_(E,M,Pe,Ne,D,ct,Ge,ut,Ie)):_e?(gr=y_(E,We,D,Ur,Ie),uh(E,Pe,Ne,ut,qt,Ie)):Ee?(gr=g_(E,We,D,Ur,ct.lineClipsArray.length),tw(E,M,Pe,Ne,D,ct,Ge)):gr=ih(E,We,D,Ur);const Xr=E.stencilModeForClipping(Ge);At.draw(Pe,Ne.TRIANGLES,ae,Xr,me,dr.disabled,gr,Mr,sn,D.id,ct.layoutVertexBuffer,ct.indexBuffer,ct.segments,D.paint,E.transform.zoom,ut,ct.layoutVertexBuffer2),Ve=!1}}(i,d,p,_,w):a.cg(p)?function(E,M,D,$,U){const K=D.paint.get("fill-color"),H=D.paint.get("fill-opacity");if(H.constantOr(1)===0)return;const{isRenderingToTexture:ee}=U,ae=E.colorModeForRenderPass(),me=D.paint.get("fill-pattern"),ge=E.opaquePassEnabledForLayer()&&!me.constantOr(1)&&K.constantOr(a.bf.transparent).a===1&&H.constantOr(0)===1?"opaque":"translucent";if(E.renderPass===ge){const _e=E.getDepthModeForSublayer(1,E.renderPass==="opaque"?Wt.ReadWrite:Wt.ReadOnly);cf(E,M,D,$,_e,ae,!1,ee)}if(E.renderPass==="translucent"&&D.paint.get("fill-antialias")){const _e=E.getDepthModeForSublayer(D.getPaintProperty("fill-outline-color")?2:0,Wt.ReadOnly);cf(E,M,D,$,_e,ae,!0,ee)}}(i,d,p,_,w):a.ch(p)?function(E,M,D,$,U){const K=D.paint.get("fill-extrusion-opacity");if(K===0)return;const{isRenderingToTexture:H}=U;if(E.renderPass==="translucent"){const ee=new Wt(E.context.gl.LEQUAL,Wt.ReadWrite,E.depthRangeFor3D);if(K!==1||D.paint.get("fill-extrusion-pattern").constantOr(1))uf(E,M,D,$,ee,Qt.disabled,jr.disabled,H),uf(E,M,D,$,ee,E.stencilModeFor3D(),E.colorModeForRenderPass(),H);else{const ae=E.colorModeForRenderPass();uf(E,M,D,$,ee,Qt.disabled,ae,H)}}}(i,d,p,_,w):a.ci(p)?function(E,M,D,$,U){if(E.renderPass!=="offscreen"&&E.renderPass!=="translucent")return;const{isRenderingToTexture:K}=U,H=E.context,ee=E.style.projection.useSubdivision,ae=E.getDepthModeForSublayer(0,Wt.ReadOnly),me=E.colorModeForRenderPass();if(E.renderPass==="offscreen")(function(ge,_e,Te,Ce,Ee,Ie,Le){const Pe=ge.context,Ne=Pe.gl;for(const qe of Te){const Ve=_e.getTile(qe),Ge=Ve.dem;if(!Ge||!Ge.data||!Ve.needsHillshadePrepare)continue;const We=Ge.dim,ct=Ge.stride,ut=Ge.getPixels();if(Pe.activeTexture.set(Ne.TEXTURE1),Pe.pixelStoreUnpackPremultiplyAlpha.set(!1),Ve.demTexture=Ve.demTexture||ge.getTileTexture(ct),Ve.demTexture){const At=Ve.demTexture;At.update(ut,{premultiply:!1}),At.bind(Ne.NEAREST,Ne.CLAMP_TO_EDGE)}else Ve.demTexture=new a.T(Pe,ut,Ne.RGBA,{premultiply:!1}),Ve.demTexture.bind(Ne.NEAREST,Ne.CLAMP_TO_EDGE);Pe.activeTexture.set(Ne.TEXTURE0);let tt=Ve.fbo;if(!tt){const At=new a.T(Pe,{width:We,height:We,data:null},Ne.RGBA);At.bind(Ne.LINEAR,Ne.CLAMP_TO_EDGE),tt=Ve.fbo=Pe.createFramebuffer(We,We,!0,!1),tt.colorAttachment.set(At.texture)}Pe.bindFramebuffer.set(tt.framebuffer),Pe.viewport.set([0,0,We,We]),ge.useProgram("hillshadePrepare").draw(Pe,Ne.TRIANGLES,Ee,Ie,Le,dr.disabled,Bm(Ve.tileID,Ge),null,null,Ce.id,ge.rasterBoundsBuffer,ge.quadTriangleIndexBuffer,ge.rasterBoundsSegments),Ve.needsHillshadePrepare=!1}})(E,M,$,D,ae,Qt.disabled,me),H.viewport.set([0,0,E.width,E.height]);else if(E.renderPass==="translucent")if(ee){const[ge,_e,Te]=E.stencilConfigForOverlapTwoPass($);hf(E,M,D,Te,ge,ae,me,!1,K),hf(E,M,D,Te,_e,ae,me,!0,K)}else{const[ge,_e]=E.getStencilConfigForOverlapAndUpdateStencilID($);hf(E,M,D,_e,ge,ae,me,!1,K)}}(i,d,p,_,w):a.cj(p)?function(E,M,D,$,U){if(E.renderPass!=="translucent"||!$.length)return;const{isRenderingToTexture:K}=U,H=E.style.projection.useSubdivision,ee=E.getDepthModeForSublayer(0,Wt.ReadOnly),ae=E.colorModeForRenderPass();if(H){const[me,ge,_e]=E.stencilConfigForOverlapTwoPass($);Pc(E,M,D,_e,me,ee,ae,!1,K),Pc(E,M,D,_e,ge,ee,ae,!0,K)}else{const[me,ge]=E.getStencilConfigForOverlapAndUpdateStencilID($);Pc(E,M,D,ge,me,ee,ae,!1,K)}}(i,d,p,_,w):a.bK(p)?function(E,M,D,$,U){if(E.renderPass!=="translucent"||D.paint.get("raster-opacity")===0||!$.length)return;const{isRenderingToTexture:K}=U,H=M.getSource(),ee=E.style.projection.useSubdivision;if(H instanceof Ar)df(E,M,D,$,null,!1,!1,H.tileCoords,H.flippedWindingOrder,K);else if(ee){const[ae,me,ge]=E.stencilConfigForOverlapTwoPass($);df(E,M,D,ge,ae,!1,!0,dh,!1,K),df(E,M,D,ge,me,!0,!0,dh,!1,K)}else{const[ae,me]=E.getStencilConfigForOverlapAndUpdateStencilID($);df(E,M,D,me,ae,!1,!0,dh,!1,K)}}(i,d,p,_,w):a.ck(p)?function(E,M,D,$,U){const K=D.paint.get("background-color"),H=D.paint.get("background-opacity");if(H===0)return;const{isRenderingToTexture:ee}=U,ae=E.context,me=ae.gl,ge=E.style.projection,_e=E.transform,Te=_e.tileSize,Ce=D.paint.get("background-pattern");if(E.isPatternMissing(Ce))return;const Ee=!Ce&&K.a===1&&H===1&&E.opaquePassEnabledForLayer()?"opaque":"translucent";if(E.renderPass!==Ee)return;const Ie=Qt.disabled,Le=E.getDepthModeForSublayer(0,Ee==="opaque"?Wt.ReadWrite:Wt.ReadOnly),Pe=E.colorModeForRenderPass(),Ne=E.useProgram(Ce?"backgroundPattern":"background"),qe=$||Kt(_e,{tileSize:Te,terrain:E.style.map.terrain});Ce&&(ae.activeTexture.set(me.TEXTURE0),E.imageManager.bind(E.context));const Ve=D.getCrossfadeParameters();for(const Ge of qe){const We=_e.getProjectionData({overscaledTileID:Ge,applyGlobeMatrix:!ee,applyTerrainMatrix:!0}),ct=Ce?Vm(H,E,Ce,{tileID:Ge,tileSize:Te},Ve):w_(H,K),ut=E.style.map.terrain&&E.style.map.terrain.getTerrainData(Ge),tt=ge.getMeshFromTileID(ae,Ge.canonical,!1,!0,"raster");Ne.draw(ae,me.TRIANGLES,Le,Ie,Pe,dr.backCCW,ct,ut,We,D.id,tt.vertexBuffer,tt.indexBuffer,tt.segments)}}(i,0,p,_,w):a.cl(p)&&function(E,M,D,$){const{isRenderingGlobe:U}=$,K=E.context,H=D.implementation,ee=E.style.projection,ae=E.transform,me=ae.getProjectionDataForCustomLayer(U),ge={farZ:ae.farZ,nearZ:ae.nearZ,fov:ae.fov*Math.PI/180,modelViewProjectionMatrix:ae.modelViewProjectionMatrix,projectionMatrix:ae.projectionMatrix,shaderData:{variantName:ee.shaderVariantName,vertexShaderPrelude:`const float PI = 3.141592653589793;
uniform mat4 u_projection_matrix;
${ee.shaderPreludeCode.vertexSource}`,define:ee.shaderDefine},defaultProjectionData:me},_e=H.renderingMode?H.renderingMode:"2d";if(E.renderPass==="offscreen"){const Te=H.prerender;Te&&(E.setCustomLayerDefaults(),K.setColorMode(E.colorModeForRenderPass()),Te.call(H,K.gl,ge),K.setDirty(),E.setBaseState())}else if(E.renderPass==="translucent"){E.setCustomLayerDefaults(),K.setColorMode(E.colorModeForRenderPass()),K.setStencilMode(Qt.disabled);const Te=_e==="3d"?E.getDepthModeFor3D():E.getDepthModeForSublayer(0,Wt.ReadOnly);K.setDepthMode(Te),H.render(K.gl,ge),K.setDirty(),E.setBaseState(),K.bindFramebuffer.set(null)}}(i,0,p,w))}saveTileTexture(i){const d=this._tileTextures[i.size[0]];d?d.push(i):this._tileTextures[i.size[0]]=[i]}getTileTexture(i){const d=this._tileTextures[i];return d&&d.length>0?d.pop():null}isPatternMissing(i){if(!i)return!1;if(!i.from||!i.to)return!0;const d=this.imageManager.getPattern(i.from.toString()),p=this.imageManager.getPattern(i.to.toString());return!d||!p}useProgram(i,d,p=!1,_=[]){this.cache=this.cache||{};const w=!!this.style.map.terrain,E=this.style.projection,M=p?Gi.projectionMercator:E.shaderPreludeCode,D=p?bl:E.shaderDefine,$=i+(d?d.cacheKey:"")+`/${p?ar:E.shaderVariantName}`+(this._showOverdrawInspector?"/overdraw":"")+(w?"/terrain":"")+(_?`/${_.join("/")}`:"");return this.cache[$]||(this.cache[$]=new Nm(this.context,Gi[i],d,qd[i],this._showOverdrawInspector,w,M,D,_)),this.cache[$]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const i=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(i.FUNC_ADD)}initDebugOverlayCanvas(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new a.T(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))}destroy(){this.debugOverlayTexture&&this.debugOverlayTexture.destroy()}overLimit(){const{drawingBufferWidth:i,drawingBufferHeight:d}=this.context.gl;return this.width!==i||this.height!==d}}function ng(x,i){let d,p=!1,_=null,w=null;const E=()=>{_=null,p&&(x.apply(w,d),_=setTimeout(E,i),p=!1)};return(...M)=>(p=!0,w=this,d=M,_||E(),_)}class ig{constructor(i){this._getCurrentHash=()=>{const d=window.location.hash.replace("#","");if(this._hashName){let p;return d.split("&").map(_=>_.split("=")).forEach(_=>{_[0]===this._hashName&&(p=_)}),(p&&p[1]||"").split("/")}return d.split("/")},this._onHashChange=()=>{const d=this._getCurrentHash();if(!this._isValidHash(d))return!1;const p=this._map.dragRotate.isEnabled()&&this._map.touchZoomRotate.isEnabled()?+(d[3]||0):this._map.getBearing();return this._map.jumpTo({center:[+d[2],+d[1]],zoom:+d[0],bearing:p,pitch:+(d[4]||0)}),!0},this._updateHashUnthrottled=()=>{const d=window.location.href.replace(/(#.*)?$/,this.getHashString());window.history.replaceState(window.history.state,null,d)},this._removeHash=()=>{const d=this._getCurrentHash();if(d.length===0)return;const p=d.join("/");let _=p;_.split("&").length>0&&(_=_.split("&")[0]),this._hashName&&(_=`${this._hashName}=${p}`);let w=window.location.hash.replace(_,"");w.startsWith("#&")?w=w.slice(0,1)+w.slice(2):w==="#"&&(w="");let E=window.location.href.replace(/(#.+)?$/,w);E=E.replace("&&","&"),window.history.replaceState(window.history.state,null,E)},this._updateHash=ng(this._updateHashUnthrottled,300),this._hashName=i&&encodeURIComponent(i)}addTo(i){return this._map=i,addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this}remove(){return removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),clearTimeout(this._updateHash()),this._removeHash(),delete this._map,this}getHashString(i){const d=this._map.getCenter(),p=Math.round(100*this._map.getZoom())/100,_=Math.ceil((p*Math.LN2+Math.log(512/360/.5))/Math.LN10),w=Math.pow(10,_),E=Math.round(d.lng*w)/w,M=Math.round(d.lat*w)/w,D=this._map.getBearing(),$=this._map.getPitch();let U="";if(U+=i?`/${E}/${M}/${p}`:`${p}/${M}/${E}`,(D||$)&&(U+="/"+Math.round(10*D)/10),$&&(U+=`/${Math.round($)}`),this._hashName){const K=this._hashName;let H=!1;const ee=window.location.hash.slice(1).split("&").map(ae=>{const me=ae.split("=")[0];return me===K?(H=!0,`${me}=${U}`):ae}).filter(ae=>ae);return H||ee.push(`${K}=${U}`),`#${ee.join("&")}`}return`#${U}`}_isValidHash(i){if(i.length<3||i.some(isNaN))return!1;try{new a.S(+i[2],+i[1])}catch{return!1}const d=+i[0],p=+(i[3]||0),_=+(i[4]||0);return d>=this._map.getMinZoom()&&d<=this._map.getMaxZoom()&&p>=-180&&p<=180&&_>=this._map.getMinPitch()&&_<=this._map.getMaxPitch()}}const kc={linearity:.3,easing:a.cm(0,0,.3,1)},Il=a.e({deceleration:2500,maxSpeed:1400},kc),D_=a.e({deceleration:20,maxSpeed:1400},kc),L_=a.e({deceleration:1e3,maxSpeed:360},kc),O_=a.e({deceleration:1e3,maxSpeed:90},kc),z_=a.e({deceleration:1e3,maxSpeed:360},kc);class N_{constructor(i){this._map=i,this.clear()}clear(){this._inertiaBuffer=[]}record(i){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:P.now(),settings:i})}_drainInertiaBuffer(){const i=this._inertiaBuffer,d=P.now();for(;i.length>0&&d-i[0].time>160;)i.shift()}_onMoveEnd(i){if(this._drainInertiaBuffer(),this._inertiaBuffer.length<2)return;const d={zoom:0,bearing:0,pitch:0,roll:0,pan:new a.P(0,0),pinchAround:void 0,around:void 0};for(const{settings:w}of this._inertiaBuffer)d.zoom+=w.zoomDelta||0,d.bearing+=w.bearingDelta||0,d.pitch+=w.pitchDelta||0,d.roll+=w.rollDelta||0,w.panDelta&&d.pan._add(w.panDelta),w.around&&(d.around=w.around),w.pinchAround&&(d.pinchAround=w.pinchAround);const p=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,_={};if(d.pan.mag()){const w=Ic(d.pan.mag(),p,a.e({},Il,i||{})),E=d.pan.mult(w.amount/d.pan.mag()),M=this._map.cameraHelper.handlePanInertia(E,this._map.transform);_.center=M.easingCenter,_.offset=M.easingOffset,Mc(_,w)}if(d.zoom){const w=Ic(d.zoom,p,D_);_.zoom=this._map.transform.zoom+w.amount,Mc(_,w)}if(d.bearing){const w=Ic(d.bearing,p,L_);_.bearing=this._map.transform.bearing+a.ah(w.amount,-179,179),Mc(_,w)}if(d.pitch){const w=Ic(d.pitch,p,O_);_.pitch=this._map.transform.pitch+w.amount,Mc(_,w)}if(d.roll){const w=Ic(d.roll,p,z_);_.roll=this._map.transform.roll+a.ah(w.amount,-179,179),Mc(_,w)}if(_.zoom||_.bearing){const w=d.pinchAround===void 0?d.around:d.pinchAround;_.around=w?this._map.unproject(w):this._map.getCenter()}return this.clear(),a.e(_,{noMoveStart:!0})}}function Mc(x,i){(!x.duration||x.duration<i.duration)&&(x.duration=i.duration,x.easing=i.easing)}function Ic(x,i,d){const{maxSpeed:p,linearity:_,deceleration:w}=d,E=a.ah(x*_/(i/1e3),-p,p),M=Math.abs(E)/(w*_);return{easing:d.easing,duration:1e3*M,amount:E*(M/2)}}class is extends a.l{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(i,d,p,_={}){p=p instanceof MouseEvent?p:new MouseEvent(i,p);const w=A.mousePos(d.getCanvas(),p),E=d.unproject(w);super(i,a.e({point:w,lngLat:E,originalEvent:p},_)),this._defaultPrevented=!1,this.target=d}}class za extends a.l{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(i,d,p){const _=i==="touchend"?p.changedTouches:p.touches,w=A.touchPos(d.getCanvasContainer(),_),E=w.map(D=>d.unproject(D)),M=w.reduce((D,$,U,K)=>D.add($.div(K.length)),new a.P(0,0));super(i,{points:w,point:M,lngLats:E,lngLat:d.unproject(M),originalEvent:p}),this._defaultPrevented=!1}}class sg extends a.l{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(i,d,p){super(i,{originalEvent:p}),this._defaultPrevented=!1}}class Fs{constructor(i,d){this._map=i,this._clickTolerance=d.clickTolerance}reset(){delete this._mousedownPos}wheel(i){return this._firePreventable(new sg(i.type,this._map,i))}mousedown(i,d){return this._mousedownPos=d,this._firePreventable(new is(i.type,this._map,i))}mouseup(i){this._map.fire(new is(i.type,this._map,i))}click(i,d){this._mousedownPos&&this._mousedownPos.dist(d)>=this._clickTolerance||this._map.fire(new is(i.type,this._map,i))}dblclick(i){return this._firePreventable(new is(i.type,this._map,i))}mouseover(i){this._map.fire(new is(i.type,this._map,i))}mouseout(i){this._map.fire(new is(i.type,this._map,i))}touchstart(i){return this._firePreventable(new za(i.type,this._map,i))}touchmove(i){this._map.fire(new za(i.type,this._map,i))}touchend(i){this._map.fire(new za(i.type,this._map,i))}touchcancel(i){this._map.fire(new za(i.type,this._map,i))}_firePreventable(i){if(this._map.fire(i),i.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class oo{constructor(i){this._map=i}reset(){this._delayContextMenu=!1,this._ignoreContextMenu=!0,delete this._contextMenuEvent}mousemove(i){this._map.fire(new is(i.type,this._map,i))}mousedown(){this._delayContextMenu=!0,this._ignoreContextMenu=!1}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new is("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(i){this._delayContextMenu?this._contextMenuEvent=i:this._ignoreContextMenu||this._map.fire(new is(i.type,this._map,i)),this._map.listens("contextmenu")&&i.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class Rc{constructor(i){this._map=i}get transform(){return this._map._requestedCameraState||this._map.transform}get center(){return{lng:this.transform.center.lng,lat:this.transform.center.lat}}get zoom(){return this.transform.zoom}get pitch(){return this.transform.pitch}get bearing(){return this.transform.bearing}unproject(i){return this.transform.screenPointToLocation(a.P.convert(i),this._map.terrain)}}class Bs{constructor(i,d){this._map=i,this._tr=new Rc(i),this._el=i.getCanvasContainer(),this._container=i.getContainer(),this._clickTolerance=d.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(i,d){this.isEnabled()&&i.shiftKey&&i.button===0&&(A.disableDrag(),this._startPos=this._lastPos=d,this._active=!0)}mousemoveWindow(i,d){if(!this._active)return;const p=d;if(this._lastPos.equals(p)||!this._box&&p.dist(this._startPos)<this._clickTolerance)return;const _=this._startPos;this._lastPos=p,this._box||(this._box=A.create("div","maplibregl-boxzoom",this._container),this._container.classList.add("maplibregl-crosshair"),this._fireEvent("boxzoomstart",i));const w=Math.min(_.x,p.x),E=Math.max(_.x,p.x),M=Math.min(_.y,p.y),D=Math.max(_.y,p.y);A.setTransform(this._box,`translate(${w}px,${M}px)`),this._box.style.width=E-w+"px",this._box.style.height=D-M+"px"}mouseupWindow(i,d){if(!this._active||i.button!==0)return;const p=this._startPos,_=d;if(this.reset(),A.suppressClick(),p.x!==_.x||p.y!==_.y)return this._map.fire(new a.l("boxzoomend",{originalEvent:i})),{cameraAnimation:w=>w.fitScreenCoordinates(p,_,this._tr.bearing,{linear:!0})};this._fireEvent("boxzoomcancel",i)}keydown(i){this._active&&i.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",i))}reset(){this._active=!1,this._container.classList.remove("maplibregl-crosshair"),this._box&&(A.remove(this._box),this._box=null),A.enableDrag(),delete this._startPos,delete this._lastPos}_fireEvent(i,d){return this._map.fire(new a.l(i,{originalEvent:d}))}}function Na(x,i){if(x.length!==i.length)throw new Error(`The number of touches and points are not equal - touches ${x.length}, points ${i.length}`);const d={};for(let p=0;p<x.length;p++)d[x[p].identifier]=i[p];return d}class rw{constructor(i){this.reset(),this.numTouches=i.numTouches}reset(){delete this.centroid,delete this.startTime,delete this.touches,this.aborted=!1}touchstart(i,d,p){(this.centroid||p.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===void 0&&(this.startTime=i.timeStamp),p.length===this.numTouches&&(this.centroid=function(_){const w=new a.P(0,0);for(const E of _)w._add(E);return w.div(_.length)}(d),this.touches=Na(p,d)))}touchmove(i,d,p){if(this.aborted||!this.centroid)return;const _=Na(p,d);for(const w in this.touches){const E=_[w];(!E||E.dist(this.touches[w])>30)&&(this.aborted=!0)}}touchend(i,d,p){if((!this.centroid||i.timeStamp-this.startTime>500)&&(this.aborted=!0),p.length===0){const _=!this.aborted&&this.centroid;if(this.reset(),_)return _}}}class og{constructor(i){this.singleTap=new rw(i),this.numTaps=i.numTaps,this.reset()}reset(){this.lastTime=1/0,delete this.lastTap,this.count=0,this.singleTap.reset()}touchstart(i,d,p){this.singleTap.touchstart(i,d,p)}touchmove(i,d,p){this.singleTap.touchmove(i,d,p)}touchend(i,d,p){const _=this.singleTap.touchend(i,d,p);if(_){const w=i.timeStamp-this.lastTime<500,E=!this.lastTap||this.lastTap.dist(_)<30;if(w&&E||this.reset(),this.count++,this.lastTime=i.timeStamp,this.lastTap=_,this.count===this.numTaps)return this.reset(),_}}}class nw{constructor(i){this._tr=new Rc(i),this._zoomIn=new og({numTouches:1,numTaps:2}),this._zoomOut=new og({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(i,d,p){this._zoomIn.touchstart(i,d,p),this._zoomOut.touchstart(i,d,p)}touchmove(i,d,p){this._zoomIn.touchmove(i,d,p),this._zoomOut.touchmove(i,d,p)}touchend(i,d,p){const _=this._zoomIn.touchend(i,d,p),w=this._zoomOut.touchend(i,d,p),E=this._tr;return _?(this._active=!0,i.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:M=>M.easeTo({duration:300,zoom:E.zoom+1,around:E.unproject(_)},{originalEvent:i})}):w?(this._active=!0,i.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:M=>M.easeTo({duration:300,zoom:E.zoom-1,around:E.unproject(w)},{originalEvent:i})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class ph{constructor(i){this._enabled=!!i.enable,this._moveStateManager=i.moveStateManager,this._clickTolerance=i.clickTolerance||1,this._moveFunction=i.move,this._activateOnStart=!!i.activateOnStart,i.assignEvents(this),this.reset()}reset(i){this._active=!1,this._moved=!1,delete this._lastPoint,this._moveStateManager.endMove(i)}_move(...i){const d=this._moveFunction(...i);if(d.bearingDelta||d.pitchDelta||d.rollDelta||d.around||d.panDelta)return this._active=!0,d}dragStart(i,d){this.isEnabled()&&!this._lastPoint&&this._moveStateManager.isValidStartEvent(i)&&(this._moveStateManager.startMove(i),this._lastPoint=Array.isArray(d)?d[0]:d,this._activateOnStart&&this._lastPoint&&(this._active=!0))}dragMove(i,d){if(!this.isEnabled())return;const p=this._lastPoint;if(!p)return;if(i.preventDefault(),!this._moveStateManager.isValidMoveEvent(i))return void this.reset(i);const _=Array.isArray(d)?d[0]:d;return!this._moved&&_.dist(p)<this._clickTolerance?void 0:(this._moved=!0,this._lastPoint=_,this._move(p,_))}dragEnd(i){this.isEnabled()&&this._lastPoint&&this._moveStateManager.isValidEndEvent(i)&&(this._moved&&A.suppressClick(),this.reset(i))}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}getClickTolerance(){return this._clickTolerance}}const j_=0,mh=2,ia={[j_]:1,[mh]:2};class xt{constructor(i){this._correctEvent=i.checkCorrectEvent}startMove(i){const d=A.mouseButton(i);this._eventButton=d}endMove(i){delete this._eventButton}isValidStartEvent(i){return this._correctEvent(i)}isValidMoveEvent(i){return!function(d,p){const _=ia[p];return d.buttons===void 0||(d.buttons&_)!==_}(i,this._eventButton)}isValidEndEvent(i){return A.mouseButton(i)===this._eventButton}}class F_{constructor(){this._firstTouch=void 0}_isOneFingerTouch(i){return i.targetTouches.length===1}_isSameTouchEvent(i){return i.targetTouches[0].identifier===this._firstTouch}startMove(i){this._firstTouch=i.targetTouches[0].identifier}endMove(i){delete this._firstTouch}isValidStartEvent(i){return this._isOneFingerTouch(i)}isValidMoveEvent(i){return this._isOneFingerTouch(i)&&this._isSameTouchEvent(i)}isValidEndEvent(i){return this._isOneFingerTouch(i)&&this._isSameTouchEvent(i)}}class ag{constructor(i=new xt({checkCorrectEvent:()=>!0}),d=new F_){this.mouseMoveStateManager=i,this.oneFingerTouchMoveStateManager=d}_executeRelevantHandler(i,d,p){return i instanceof MouseEvent?d(i):typeof TouchEvent<"u"&&i instanceof TouchEvent?p(i):void 0}startMove(i){this._executeRelevantHandler(i,d=>this.mouseMoveStateManager.startMove(d),d=>this.oneFingerTouchMoveStateManager.startMove(d))}endMove(i){this._executeRelevantHandler(i,d=>this.mouseMoveStateManager.endMove(d),d=>this.oneFingerTouchMoveStateManager.endMove(d))}isValidStartEvent(i){return this._executeRelevantHandler(i,d=>this.mouseMoveStateManager.isValidStartEvent(d),d=>this.oneFingerTouchMoveStateManager.isValidStartEvent(d))}isValidMoveEvent(i){return this._executeRelevantHandler(i,d=>this.mouseMoveStateManager.isValidMoveEvent(d),d=>this.oneFingerTouchMoveStateManager.isValidMoveEvent(d))}isValidEndEvent(i){return this._executeRelevantHandler(i,d=>this.mouseMoveStateManager.isValidEndEvent(d),d=>this.oneFingerTouchMoveStateManager.isValidEndEvent(d))}}const gh=x=>{x.mousedown=x.dragStart,x.mousemoveWindow=x.dragMove,x.mouseup=x.dragEnd,x.contextmenu=i=>{i.preventDefault()}};class yh{constructor(i,d){this._clickTolerance=i.clickTolerance||1,this._map=d,this.reset()}reset(){this._active=!1,this._touches={},this._sum=new a.P(0,0)}_shouldBePrevented(i){return i<(this._map.cooperativeGestures.isEnabled()?2:1)}touchstart(i,d,p){return this._calculateTransform(i,d,p)}touchmove(i,d,p){if(this._active){if(!this._shouldBePrevented(p.length))return i.preventDefault(),this._calculateTransform(i,d,p);this._map.cooperativeGestures.notifyGestureBlocked("touch_pan",i)}}touchend(i,d,p){this._calculateTransform(i,d,p),this._active&&this._shouldBePrevented(p.length)&&this.reset()}touchcancel(){this.reset()}_calculateTransform(i,d,p){p.length>0&&(this._active=!0);const _=Na(p,d),w=new a.P(0,0),E=new a.P(0,0);let M=0;for(const $ in _){const U=_[$],K=this._touches[$];K&&(w._add(U),E._add(U.sub(K)),M++,_[$]=U)}if(this._touches=_,this._shouldBePrevented(M)||!E.mag())return;const D=E.div(M);return this._sum._add(D),this._sum.mag()<this._clickTolerance?void 0:{around:w.div(M),panDelta:D}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Rl{constructor(){this.reset()}reset(){this._active=!1,delete this._firstTwoTouches}touchstart(i,d,p){this._firstTwoTouches||p.length<2||(this._firstTwoTouches=[p[0].identifier,p[1].identifier],this._start([d[0],d[1]]))}touchmove(i,d,p){if(!this._firstTwoTouches)return;i.preventDefault();const[_,w]=this._firstTwoTouches,E=Dc(p,d,_),M=Dc(p,d,w);if(!E||!M)return;const D=this._aroundCenter?null:E.add(M).div(2);return this._move([E,M],D,i)}touchend(i,d,p){if(!this._firstTwoTouches)return;const[_,w]=this._firstTwoTouches,E=Dc(p,d,_),M=Dc(p,d,w);E&&M||(this._active&&A.suppressClick(),this.reset())}touchcancel(){this.reset()}enable(i){this._enabled=!0,this._aroundCenter=!!i&&i.around==="center"}disable(){this._enabled=!1,this.reset()}isEnabled(){return!!this._enabled}isActive(){return!!this._active}}function Dc(x,i,d){for(let p=0;p<x.length;p++)if(x[p].identifier===d)return i[p]}function cr(x,i){return Math.log(x/i)/Math.LN2}class mf extends Rl{reset(){super.reset(),delete this._distance,delete this._startDistance}_start(i){this._startDistance=this._distance=i[0].dist(i[1])}_move(i,d){const p=this._distance;if(this._distance=i[0].dist(i[1]),this._active||!(Math.abs(cr(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:cr(this._distance,p),pinchAround:d}}}function B_(x,i){return 180*x.angleWith(i)/Math.PI}class gf extends Rl{reset(){super.reset(),delete this._minDiameter,delete this._startVector,delete this._vector}_start(i){this._startVector=this._vector=i[0].sub(i[1]),this._minDiameter=i[0].dist(i[1])}_move(i,d,p){const _=this._vector;if(this._vector=i[0].sub(i[1]),this._active||!this._isBelowThreshold(this._vector))return this._active=!0,{bearingDelta:B_(this._vector,_),pinchAround:d}}_isBelowThreshold(i){this._minDiameter=Math.min(this._minDiameter,i.mag());const d=25/(Math.PI*this._minDiameter)*360,p=B_(i,this._startVector);return Math.abs(p)<d}}function lg(x){return Math.abs(x.y)>Math.abs(x.x)}class $_ extends Rl{constructor(i){super(),this._currentTouchCount=0,this._map=i}reset(){super.reset(),this._valid=void 0,delete this._firstMove,delete this._lastPoints}touchstart(i,d,p){super.touchstart(i,d,p),this._currentTouchCount=p.length}_start(i){this._lastPoints=i,lg(i[0].sub(i[1]))&&(this._valid=!1)}_move(i,d,p){if(this._map.cooperativeGestures.isEnabled()&&this._currentTouchCount<3)return;const _=i[0].sub(this._lastPoints[0]),w=i[1].sub(this._lastPoints[1]);return this._valid=this.gestureBeginsVertically(_,w,p.timeStamp),this._valid?(this._lastPoints=i,this._active=!0,{pitchDelta:(_.y+w.y)/2*-.5}):void 0}gestureBeginsVertically(i,d,p){if(this._valid!==void 0)return this._valid;const _=i.mag()>=2,w=d.mag()>=2;if(!_&&!w)return;if(!_||!w)return this._firstMove===void 0&&(this._firstMove=p),p-this._firstMove<100&&void 0;const E=i.y>0==d.y>0;return lg(i)&&lg(d)&&E}}const V_={panStep:100,bearingStep:15,pitchStep:10};class yf{constructor(i){this._tr=new Rc(i);const d=V_;this._panStep=d.panStep,this._bearingStep=d.bearingStep,this._pitchStep=d.pitchStep,this._rotationDisabled=!1}reset(){this._active=!1}keydown(i){if(i.altKey||i.ctrlKey||i.metaKey)return;let d=0,p=0,_=0,w=0,E=0;switch(i.keyCode){case 61:case 107:case 171:case 187:d=1;break;case 189:case 109:case 173:d=-1;break;case 37:i.shiftKey?p=-1:(i.preventDefault(),w=-1);break;case 39:i.shiftKey?p=1:(i.preventDefault(),w=1);break;case 38:i.shiftKey?_=1:(i.preventDefault(),E=-1);break;case 40:i.shiftKey?_=-1:(i.preventDefault(),E=1);break;default:return}return this._rotationDisabled&&(p=0,_=0),{cameraAnimation:M=>{const D=this._tr;M.easeTo({duration:300,easeId:"keyboardHandler",easing:U_,zoom:d?Math.round(D.zoom)+d*(i.shiftKey?2:1):D.zoom,bearing:D.bearing+p*this._bearingStep,pitch:D.pitch+_*this._pitchStep,offset:[-w*this._panStep,-E*this._panStep],center:D.center},{originalEvent:i})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function U_(x){return x*(2-x)}const G_=4.000244140625,W_=1/450;class q_{constructor(i,d){this._onTimeout=p=>{this._type="wheel",this._delta-=this._lastValue,this._active||this._start(p)},this._map=i,this._tr=new Rc(i),this._triggerRenderFrame=d,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=W_}setZoomRate(i){this._defaultZoomRate=i}setWheelZoomRate(i){this._wheelZoomRate=i}isEnabled(){return!!this._enabled}isActive(){return!!this._active||this._finishTimeout!==void 0}isZooming(){return!!this._zooming}enable(i){this.isEnabled()||(this._enabled=!0,this._aroundCenter=!!i&&i.around==="center")}disable(){this.isEnabled()&&(this._enabled=!1)}_shouldBePrevented(i){return!!this._map.cooperativeGestures.isEnabled()&&!(i.ctrlKey||this._map.cooperativeGestures.isBypassed(i))}wheel(i){if(!this.isEnabled())return;if(this._shouldBePrevented(i))return void this._map.cooperativeGestures.notifyGestureBlocked("wheel_zoom",i);let d=i.deltaMode===WheelEvent.DOM_DELTA_LINE?40*i.deltaY:i.deltaY;const p=P.now(),_=p-(this._lastWheelEventTime||0);this._lastWheelEventTime=p,d!==0&&d%G_==0?this._type="wheel":d!==0&&Math.abs(d)<4?this._type="trackpad":_>400?(this._type=null,this._lastValue=d,this._timeout=setTimeout(this._onTimeout,40,i)):this._type||(this._type=Math.abs(_*d)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,d+=this._lastValue)),i.shiftKey&&d&&(d/=4),this._type&&(this._lastWheelEvent=i,this._delta-=d,this._active||this._start(i)),i.preventDefault()}_start(i){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const d=A.mousePos(this._map.getCanvas(),i),p=this._tr;this._aroundPoint=this._aroundCenter?p.transform.locationToScreenPoint(a.S.convert(p.center)):d,this._frameId||(this._frameId=!0,this._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;const i=this._tr.transform;if(typeof this._lastExpectedZoom=="number"){const M=i.zoom-this._lastExpectedZoom;typeof this._startZoom=="number"&&(this._startZoom+=M),typeof this._targetZoom=="number"&&(this._targetZoom+=M)}if(this._delta!==0){const M=this._type==="wheel"&&Math.abs(this._delta)>G_?this._wheelZoomRate:this._defaultZoomRate;let D=2/(1+Math.exp(-Math.abs(this._delta*M)));this._delta<0&&D!==0&&(D=1/D);const $=typeof this._targetZoom!="number"?i.scale:a.af(this._targetZoom);this._targetZoom=i.getConstrained(i.getCameraLngLat(),a.ak($*D)).zoom,this._type==="wheel"&&(this._startZoom=i.zoom,this._easing=this._smoothOutEasing(200)),this._delta=0}const d=typeof this._targetZoom!="number"?i.zoom:this._targetZoom,p=this._startZoom,_=this._easing;let w,E=!1;if(this._type==="wheel"&&p&&_){const M=P.now()-this._lastWheelEventTime,D=Math.min((M+5)/200,1),$=_(D);w=a.C.number(p,d,$),D<1?this._frameId||(this._frameId=!0):E=!0}else w=d,E=!0;return this._active=!0,E&&(this._active=!1,this._finishTimeout=setTimeout(()=>{this._zooming=!1,this._triggerRenderFrame(),delete this._targetZoom,delete this._lastExpectedZoom,delete this._finishTimeout},200)),this._lastExpectedZoom=w,{noInertia:!0,needsRenderFrame:!E,zoomDelta:w-i.zoom,around:this._aroundPoint,originalEvent:this._lastWheelEvent}}_smoothOutEasing(i){let d=a.co;if(this._prevEase){const p=this._prevEase,_=(P.now()-p.start)/p.duration,w=p.easing(_+.01)-p.easing(_),E=.27/Math.sqrt(w*w+1e-4)*.01,M=Math.sqrt(.0729-E*E);d=a.cm(E,M,.25,1)}return this._prevEase={start:P.now(),duration:i,easing:d},d}reset(){this._active=!1,this._zooming=!1,delete this._targetZoom,delete this._lastExpectedZoom,this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout)}}class H_{constructor(i,d){this._clickZoom=i,this._tapZoom=d}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class ja{constructor(i){this._tr=new Rc(i),this.reset()}reset(){this._active=!1}dblclick(i,d){return i.preventDefault(),{cameraAnimation:p=>{p.easeTo({duration:300,zoom:this._tr.zoom+(i.shiftKey?-1:1),around:this._tr.unproject(d)},{originalEvent:i})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class $r{constructor(){this._tap=new og({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,delete this._swipePoint,delete this._swipeTouch,delete this._tapTime,delete this._tapPoint,this._tap.reset()}touchstart(i,d,p){if(!this._swipePoint)if(this._tapTime){const _=d[0],w=i.timeStamp-this._tapTime<500,E=this._tapPoint.dist(_)<30;w&&E?p.length>0&&(this._swipePoint=_,this._swipeTouch=p[0].identifier):this.reset()}else this._tap.touchstart(i,d,p)}touchmove(i,d,p){if(this._tapTime){if(this._swipePoint){if(p[0].identifier!==this._swipeTouch)return;const _=d[0],w=_.y-this._swipePoint.y;return this._swipePoint=_,i.preventDefault(),this._active=!0,{zoomDelta:w/128}}}else this._tap.touchmove(i,d,p)}touchend(i,d,p){if(this._tapTime)this._swipePoint&&p.length===0&&this.reset();else{const _=this._tap.touchend(i,d,p);_&&(this._tapTime=i.timeStamp,this._tapPoint=_)}}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Z_{constructor(i,d,p){this._el=i,this._mousePan=d,this._touchPan=p}enable(i){this._inertiaOptions=i||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("maplibregl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("maplibregl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class _h{constructor(i,d,p,_){this._pitchWithRotate=i.pitchWithRotate,this._rollEnabled=i.rollEnabled,this._mouseRotate=d,this._mousePitch=p,this._mouseRoll=_}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable(),this._rollEnabled&&this._mouseRoll.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable(),this._mouseRoll.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())&&(!this._rollEnabled||this._mouseRoll.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()||this._mouseRoll.isActive()}}class _f{constructor(i,d,p,_){this._el=i,this._touchZoom=d,this._touchRotate=p,this._tapDragZoom=_,this._rotationDisabled=!1,this._enabled=!0}enable(i){this._touchZoom.enable(i),this._rotationDisabled||this._touchRotate.enable(i),this._tapDragZoom.enable(),this._el.classList.add("maplibregl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("maplibregl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}class cg{constructor(i,d){this._bypassKey=navigator.userAgent.indexOf("Mac")!==-1?"metaKey":"ctrlKey",this._map=i,this._options=d,this._enabled=!1}isActive(){return!1}reset(){}_setupUI(){if(this._container)return;const i=this._map.getCanvasContainer();i.classList.add("maplibregl-cooperative-gestures"),this._container=A.create("div","maplibregl-cooperative-gesture-screen",i);let d=this._map._getUIString("CooperativeGesturesHandler.WindowsHelpText");this._bypassKey==="metaKey"&&(d=this._map._getUIString("CooperativeGesturesHandler.MacHelpText"));const p=this._map._getUIString("CooperativeGesturesHandler.MobileHelpText"),_=document.createElement("div");_.className="maplibregl-desktop-message",_.textContent=d,this._container.appendChild(_);const w=document.createElement("div");w.className="maplibregl-mobile-message",w.textContent=p,this._container.appendChild(w),this._container.setAttribute("aria-hidden","true")}_destroyUI(){this._container&&(A.remove(this._container),this._map.getCanvasContainer().classList.remove("maplibregl-cooperative-gestures")),delete this._container}enable(){this._setupUI(),this._enabled=!0}disable(){this._enabled=!1,this._destroyUI()}isEnabled(){return this._enabled}isBypassed(i){return i[this._bypassKey]}notifyGestureBlocked(i,d){this._enabled&&(this._map.fire(new a.l("cooperativegestureprevented",{gestureType:i,originalEvent:d})),this._container.classList.add("maplibregl-show"),setTimeout(()=>{this._container.classList.remove("maplibregl-show")},100))}}const vh=x=>x.zoom||x.drag||x.roll||x.pitch||x.rotate;class K_ extends a.l{}function ug(x){return x.panDelta&&x.panDelta.mag()||x.zoomDelta||x.bearingDelta||x.pitchDelta||x.rollDelta}class Lo{constructor(i,d){this.handleWindowEvent=_=>{this.handleEvent(_,`${_.type}Window`)},this.handleEvent=(_,w)=>{if(_.type==="blur")return void this.stop(!0);this._updatingCamera=!0;const E=_.type==="renderFrame"?void 0:_,M={needsRenderFrame:!1},D={},$={};for(const{handlerName:H,handler:ee,allowed:ae}of this._handlers){if(!ee.isEnabled())continue;let me;if(this._blockedByActive($,ae,H))ee.reset();else if(ee[w||_.type]){if(a.cp(_,w||_.type)){const ge=A.mousePos(this._map.getCanvas(),_);me=ee[w||_.type](_,ge)}else if(a.cq(_,w||_.type)){const ge=this._getMapTouches(_.touches),_e=A.touchPos(this._map.getCanvas(),ge);me=ee[w||_.type](_,_e,ge)}else a.cr(w||_.type)||(me=ee[w||_.type](_));this.mergeHandlerResult(M,D,me,H,E),me&&me.needsRenderFrame&&this._triggerRenderFrame()}(me||ee.isActive())&&($[H]=ee)}const U={};for(const H in this._previousActiveHandlers)$[H]||(U[H]=E);this._previousActiveHandlers=$,(Object.keys(U).length||ug(M))&&(this._changes.push([M,D,U]),this._triggerRenderFrame()),(Object.keys($).length||ug(M))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:K}=M;K&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],K(this._map))},this._map=i,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new N_(i),this._bearingSnap=d.bearingSnap,this._previousActiveHandlers={},this._eventsInProgress={},this._addDefaultHandlers(d);const p=this._el;this._listeners=[[p,"touchstart",{passive:!0}],[p,"touchmove",{passive:!1}],[p,"touchend",void 0],[p,"touchcancel",void 0],[p,"mousedown",void 0],[p,"mousemove",void 0],[p,"mouseup",void 0],[document,"mousemove",{capture:!0}],[document,"mouseup",void 0],[p,"mouseover",void 0],[p,"mouseout",void 0],[p,"dblclick",void 0],[p,"click",void 0],[p,"keydown",{capture:!1}],[p,"keyup",void 0],[p,"wheel",{passive:!1}],[p,"contextmenu",void 0],[window,"blur",void 0]];for(const[_,w,E]of this._listeners)A.addEventListener(_,w,_===document?this.handleWindowEvent:this.handleEvent,E)}destroy(){for(const[i,d,p]of this._listeners)A.removeEventListener(i,d,i===document?this.handleWindowEvent:this.handleEvent,p)}_addDefaultHandlers(i){const d=this._map,p=d.getCanvasContainer();this._add("mapEvent",new Fs(d,i));const _=d.boxZoom=new Bs(d,i);this._add("boxZoom",_),i.interactive&&i.boxZoom&&_.enable();const w=d.cooperativeGestures=new cg(d,i.cooperativeGestures);this._add("cooperativeGestures",w),i.cooperativeGestures&&w.enable();const E=new nw(d),M=new ja(d);d.doubleClickZoom=new H_(M,E),this._add("tapZoom",E),this._add("clickZoom",M),i.interactive&&i.doubleClickZoom&&d.doubleClickZoom.enable();const D=new $r;this._add("tapDragZoom",D);const $=d.touchPitch=new $_(d);this._add("touchPitch",$),i.interactive&&i.touchPitch&&d.touchPitch.enable(i.touchPitch);const U=()=>d.project(d.getCenter()),K=function({enable:Ee,clickTolerance:Ie,aroundCenter:Le=!0,minPixelCenterThreshold:Pe=100,rotateDegreesPerPixelMoved:Ne=.8},qe){const Ve=new xt({checkCorrectEvent:Ge=>A.mouseButton(Ge)===0&&Ge.ctrlKey||A.mouseButton(Ge)===2&&!Ge.ctrlKey});return new ph({clickTolerance:Ie,move:(Ge,We)=>{const ct=qe();if(Le&&Math.abs(ct.y-Ge.y)>Pe)return{bearingDelta:a.cn(new a.P(Ge.x,We.y),We,ct)};let ut=(We.x-Ge.x)*Ne;return Le&&We.y<ct.y&&(ut=-ut),{bearingDelta:ut}},moveStateManager:Ve,enable:Ee,assignEvents:gh})}(i,U),H=function({enable:Ee,clickTolerance:Ie,pitchDegreesPerPixelMoved:Le=-.5}){const Pe=new xt({checkCorrectEvent:Ne=>A.mouseButton(Ne)===0&&Ne.ctrlKey||A.mouseButton(Ne)===2});return new ph({clickTolerance:Ie,move:(Ne,qe)=>({pitchDelta:(qe.y-Ne.y)*Le}),moveStateManager:Pe,enable:Ee,assignEvents:gh})}(i),ee=function({enable:Ee,clickTolerance:Ie,rollDegreesPerPixelMoved:Le=.3},Pe){const Ne=new xt({checkCorrectEvent:qe=>A.mouseButton(qe)===2&&qe.ctrlKey});return new ph({clickTolerance:Ie,move:(qe,Ve)=>{const Ge=Pe();let We=(Ve.x-qe.x)*Le;return Ve.y<Ge.y&&(We=-We),{rollDelta:We}},moveStateManager:Ne,enable:Ee,assignEvents:gh})}(i,U);d.dragRotate=new _h(i,K,H,ee),this._add("mouseRotate",K,["mousePitch"]),this._add("mousePitch",H,["mouseRotate","mouseRoll"]),this._add("mouseRoll",ee,["mousePitch"]),i.interactive&&i.dragRotate&&d.dragRotate.enable();const ae=function({enable:Ee,clickTolerance:Ie}){const Le=new xt({checkCorrectEvent:Pe=>A.mouseButton(Pe)===0&&!Pe.ctrlKey});return new ph({clickTolerance:Ie,move:(Pe,Ne)=>({around:Ne,panDelta:Ne.sub(Pe)}),activateOnStart:!0,moveStateManager:Le,enable:Ee,assignEvents:gh})}(i),me=new yh(i,d);d.dragPan=new Z_(p,ae,me),this._add("mousePan",ae),this._add("touchPan",me,["touchZoom","touchRotate"]),i.interactive&&i.dragPan&&d.dragPan.enable(i.dragPan);const ge=new gf,_e=new mf;d.touchZoomRotate=new _f(p,_e,ge,D),this._add("touchRotate",ge,["touchPan","touchZoom"]),this._add("touchZoom",_e,["touchPan","touchRotate"]),i.interactive&&i.touchZoomRotate&&d.touchZoomRotate.enable(i.touchZoomRotate);const Te=d.scrollZoom=new q_(d,()=>this._triggerRenderFrame());this._add("scrollZoom",Te,["mousePan"]),i.interactive&&i.scrollZoom&&d.scrollZoom.enable(i.scrollZoom);const Ce=d.keyboard=new yf(d);this._add("keyboard",Ce),i.interactive&&i.keyboard&&d.keyboard.enable(),this._add("blockableMapEvent",new oo(d))}_add(i,d,p){this._handlers.push({handlerName:i,handler:d,allowed:p}),this._handlersById[i]=d}stop(i){if(!this._updatingCamera){for(const{handler:d}of this._handlers)d.reset();this._inertia.clear(),this._fireEvents({},{},i),this._changes=[]}}isActive(){for(const{handler:i}of this._handlers)if(i.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return!!vh(this._eventsInProgress)||this.isZooming()}_blockedByActive(i,d,p){for(const _ in i)if(_!==p&&(!d||d.indexOf(_)<0))return!0;return!1}_getMapTouches(i){const d=[];for(const p of i)this._el.contains(p.target)&&d.push(p);return d}mergeHandlerResult(i,d,p,_,w){if(!p)return;a.e(i,p);const E={handlerName:_,originalEvent:p.originalEvent||w};p.zoomDelta!==void 0&&(d.zoom=E),p.panDelta!==void 0&&(d.drag=E),p.rollDelta!==void 0&&(d.roll=E),p.pitchDelta!==void 0&&(d.pitch=E),p.bearingDelta!==void 0&&(d.rotate=E)}_applyChanges(){const i={},d={},p={};for(const[_,w,E]of this._changes)_.panDelta&&(i.panDelta=(i.panDelta||new a.P(0,0))._add(_.panDelta)),_.zoomDelta&&(i.zoomDelta=(i.zoomDelta||0)+_.zoomDelta),_.bearingDelta&&(i.bearingDelta=(i.bearingDelta||0)+_.bearingDelta),_.pitchDelta&&(i.pitchDelta=(i.pitchDelta||0)+_.pitchDelta),_.rollDelta&&(i.rollDelta=(i.rollDelta||0)+_.rollDelta),_.around!==void 0&&(i.around=_.around),_.pinchAround!==void 0&&(i.pinchAround=_.pinchAround),_.noInertia&&(i.noInertia=_.noInertia),a.e(d,w),a.e(p,E);this._updateMapTransform(i,d,p),this._changes=[]}_updateMapTransform(i,d,p){const _=this._map,w=_._getTransformForUpdate(),E=_.terrain;if(!(ug(i)||E&&this._terrainMovement))return this._fireEvents(d,p,!0);_._stop(!0);let{panDelta:M,zoomDelta:D,bearingDelta:$,pitchDelta:U,rollDelta:K,around:H,pinchAround:ee}=i;ee!==void 0&&(H=ee),H=H||_.transform.centerPoint,E&&!w.isPointOnMapSurface(H)&&(H=w.centerPoint);const ae={panDelta:M,zoomDelta:D,rollDelta:K,pitchDelta:U,bearingDelta:$,around:H};this._map.cameraHelper.useGlobeControls&&!w.isPointOnMapSurface(H)&&(H=w.centerPoint);const me=H.distSqr(w.centerPoint)<.01?w.center:w.screenPointToLocation(M?H.sub(M):H);this._handleMapControls({terrain:E,tr:w,deltasForHelper:ae,preZoomAroundLoc:me,combinedEventsInProgress:d,panDelta:M}),_._applyUpdatedTransform(w),this._map._update(),i.noInertia||this._inertia.record(i),this._fireEvents(d,p,!0)}_handleMapControls({terrain:i,tr:d,deltasForHelper:p,preZoomAroundLoc:_,combinedEventsInProgress:w,panDelta:E}){const M=this._map.cameraHelper;if(M.handleMapControlsRollPitchBearingZoom(p,d),i)return M.useGlobeControls?(this._terrainMovement||!w.drag&&!w.zoom||(this._terrainMovement=!0,this._map._elevationFreeze=!0),void M.handleMapControlsPan(p,d,_)):this._terrainMovement||!w.drag&&!w.zoom?void(w.drag&&this._terrainMovement&&E?d.setCenter(d.screenPointToLocation(d.centerPoint.sub(E))):M.handleMapControlsPan(p,d,_)):(this._terrainMovement=!0,this._map._elevationFreeze=!0,void M.handleMapControlsPan(p,d,_));M.handleMapControlsPan(p,d,_)}_fireEvents(i,d,p){const _=vh(this._eventsInProgress),w=vh(i),E={};for(const K in i){const{originalEvent:H}=i[K];this._eventsInProgress[K]||(E[`${K}start`]=H),this._eventsInProgress[K]=i[K]}!_&&w&&this._fireEvent("movestart",w.originalEvent);for(const K in E)this._fireEvent(K,E[K]);w&&this._fireEvent("move",w.originalEvent);for(const K in i){const{originalEvent:H}=i[K];this._fireEvent(K,H)}const M={};let D;for(const K in this._eventsInProgress){const{handlerName:H,originalEvent:ee}=this._eventsInProgress[K];this._handlersById[H].isActive()||(delete this._eventsInProgress[K],D=d[H]||ee,M[`${K}end`]=D)}for(const K in M)this._fireEvent(K,M[K]);const $=vh(this._eventsInProgress),U=(_||w)&&!$;if(U&&this._terrainMovement){this._map._elevationFreeze=!1,this._terrainMovement=!1;const K=this._map._getTransformForUpdate();this._map.getCenterClampedToGround()&&K.recalculateZoomAndCenter(this._map.terrain),this._map._applyUpdatedTransform(K)}if(p&&U){this._updatingCamera=!0;const K=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),H=ee=>ee!==0&&-this._bearingSnap<ee&&ee<this._bearingSnap;!K||!K.essential&&P.prefersReducedMotion?(this._map.fire(new a.l("moveend",{originalEvent:D})),H(this._map.getBearing())&&this._map.resetNorth()):(H(K.bearing||this._map.getBearing())&&(K.bearing=0),K.freezeElevation=!0,this._map.easeTo(K,{originalEvent:D})),this._updatingCamera=!1}}_fireEvent(i,d){this._map.fire(new a.l(i,d?{originalEvent:d}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add(i=>{delete this._frameId,this.handleEvent(new K_("renderFrame",{timeStamp:i})),this._applyChanges()})}_triggerRenderFrame(){this._frameId===void 0&&(this._frameId=this._requestFrame())}}class vf extends a.E{constructor(i,d,p){super(),this._renderFrameCallback=()=>{const _=Math.min((P.now()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(_)),_<1&&this._easeFrameId?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()},this._moving=!1,this._zooming=!1,this.transform=i,this._bearingSnap=p.bearingSnap,this.cameraHelper=d,this.on("moveend",()=>{delete this._requestedCameraState})}migrateProjection(i,d){i.apply(this.transform),this.transform=i,this.cameraHelper=d}getCenter(){return new a.S(this.transform.center.lng,this.transform.center.lat)}setCenter(i,d){return this.jumpTo({center:i},d)}getCenterElevation(){return this.transform.elevation}setCenterElevation(i,d){return this.jumpTo({elevation:i},d),this}getCenterClampedToGround(){return this._centerClampedToGround}setCenterClampedToGround(i){this._centerClampedToGround=i}panBy(i,d,p){return i=a.P.convert(i).mult(-1),this.panTo(this.transform.center,a.e({offset:i},d),p)}panTo(i,d,p){return this.easeTo(a.e({center:i},d),p)}getZoom(){return this.transform.zoom}setZoom(i,d){return this.jumpTo({zoom:i},d),this}zoomTo(i,d,p){return this.easeTo(a.e({zoom:i},d),p)}zoomIn(i,d){return this.zoomTo(this.getZoom()+1,i,d),this}zoomOut(i,d){return this.zoomTo(this.getZoom()-1,i,d),this}getVerticalFieldOfView(){return this.transform.fov}setVerticalFieldOfView(i,d){return i!=this.transform.fov&&(this.transform.setFov(i),this.fire(new a.l("movestart",d)).fire(new a.l("move",d)).fire(new a.l("moveend",d))),this}getBearing(){return this.transform.bearing}setBearing(i,d){return this.jumpTo({bearing:i},d),this}getPadding(){return this.transform.padding}setPadding(i,d){return this.jumpTo({padding:i},d),this}rotateTo(i,d,p){return this.easeTo(a.e({bearing:i},d),p)}resetNorth(i,d){return this.rotateTo(0,a.e({duration:1e3},i),d),this}resetNorthPitch(i,d){return this.easeTo(a.e({bearing:0,pitch:0,roll:0,duration:1e3},i),d),this}snapToNorth(i,d){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(i,d):this}getPitch(){return this.transform.pitch}setPitch(i,d){return this.jumpTo({pitch:i},d),this}getRoll(){return this.transform.roll}setRoll(i,d){return this.jumpTo({roll:i},d),this}cameraForBounds(i,d){i=Et.convert(i).adjustAntiMeridian();const p=d&&d.bearing||0;return this._cameraForBoxAndBearing(i.getNorthWest(),i.getSouthEast(),p,d)}_cameraForBoxAndBearing(i,d,p,_){const w={top:0,bottom:0,right:0,left:0};if(typeof(_=a.e({padding:w,offset:[0,0],maxZoom:this.transform.maxZoom},_)).padding=="number"){const $=_.padding;_.padding={top:$,bottom:$,right:$,left:$}}const E=a.e(w,_.padding);_.padding=E;const M=this.transform,D=new Et(i,d);return this.cameraHelper.cameraForBoxAndBearing(_,E,D,p,M)}fitBounds(i,d,p){return this._fitInternal(this.cameraForBounds(i,d),d,p)}fitScreenCoordinates(i,d,p,_,w){return this._fitInternal(this._cameraForBoxAndBearing(this.transform.screenPointToLocation(a.P.convert(i)),this.transform.screenPointToLocation(a.P.convert(d)),p,_),_,w)}_fitInternal(i,d,p){return i?(delete(d=a.e(i,d)).padding,d.linear?this.easeTo(d,p):this.flyTo(d,p)):this}jumpTo(i,d){this.stop();const p=this._getTransformForUpdate();let _=!1,w=!1,E=!1;const M=p.zoom;this.cameraHelper.handleJumpToCenterZoom(p,i);const D=p.zoom!==M;return"elevation"in i&&p.elevation!==+i.elevation&&p.setElevation(+i.elevation),"bearing"in i&&p.bearing!==+i.bearing&&(_=!0,p.setBearing(+i.bearing)),"pitch"in i&&p.pitch!==+i.pitch&&(w=!0,p.setPitch(+i.pitch)),"roll"in i&&p.roll!==+i.roll&&(E=!0,p.setRoll(+i.roll)),i.padding==null||p.isPaddingEqual(i.padding)||p.setPadding(i.padding),this._applyUpdatedTransform(p),this.fire(new a.l("movestart",d)).fire(new a.l("move",d)),D&&this.fire(new a.l("zoomstart",d)).fire(new a.l("zoom",d)).fire(new a.l("zoomend",d)),_&&this.fire(new a.l("rotatestart",d)).fire(new a.l("rotate",d)).fire(new a.l("rotateend",d)),w&&this.fire(new a.l("pitchstart",d)).fire(new a.l("pitch",d)).fire(new a.l("pitchend",d)),E&&this.fire(new a.l("rollstart",d)).fire(new a.l("roll",d)).fire(new a.l("rollend",d)),this.fire(new a.l("moveend",d))}calculateCameraOptionsFromTo(i,d,p,_=0){const w=a.a1.fromLngLat(i,d),E=a.a1.fromLngLat(p,_),M=E.x-w.x,D=E.y-w.y,$=E.z-w.z,U=Math.hypot(M,D,$);if(U===0)throw new Error("Can't calculate camera options with same From and To");const K=Math.hypot(M,D),H=a.ak(this.transform.cameraToCenterDistance/U/this.transform.tileSize),ee=180*Math.atan2(M,-D)/Math.PI;let ae=180*Math.acos(K/U)/Math.PI;return ae=$<0?90-ae:90+ae,{center:E.toLngLat(),elevation:_,zoom:H,pitch:ae,bearing:ee}}calculateCameraOptionsFromCameraLngLatAltRotation(i,d,p,_,w){const E=this.transform.calculateCenterFromCameraLngLatAlt(i,d,p,_);return{center:E.center,elevation:E.elevation,zoom:E.zoom,bearing:p,pitch:_,roll:w}}easeTo(i,d){this._stop(!1,i.easeId),((i=a.e({offset:[0,0],duration:500,easing:a.co},i)).animate===!1||!i.essential&&P.prefersReducedMotion)&&(i.duration=0);const p=this._getTransformForUpdate(),_=this.getBearing(),w=p.pitch,E=p.roll,M="bearing"in i?this._normalizeBearing(i.bearing,_):_,D="pitch"in i?+i.pitch:w,$="roll"in i?this._normalizeBearing(i.roll,E):E,U="padding"in i?i.padding:p.padding,K=a.P.convert(i.offset);let H,ee;i.around&&(H=a.S.convert(i.around),ee=p.locationToScreenPoint(H));const ae={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching,rolling:this._rolling},me=this.cameraHelper.handleEaseTo(p,{bearing:M,pitch:D,roll:$,padding:U,around:H,aroundPoint:ee,offsetAsPoint:K,offset:i.offset,zoom:i.zoom,center:i.center});return this._rotating=this._rotating||_!==M,this._pitching=this._pitching||D!==w,this._rolling=this._rolling||$!==E,this._padding=!p.isPaddingEqual(U),this._zooming=this._zooming||me.isZooming,this._easeId=i.easeId,this._prepareEase(d,i.noMoveStart,ae),this.terrain&&this._prepareElevation(me.elevationCenter),this._ease(ge=>{me.easeFunc(ge),this.terrain&&!i.freezeElevation&&this._updateElevation(ge),this._applyUpdatedTransform(p),this._fireMoveEvents(d)},ge=>{this.terrain&&i.freezeElevation&&this._finalizeElevation(),this._afterEase(d,ge)},i),this}_prepareEase(i,d,p={}){this._moving=!0,d||p.moving||this.fire(new a.l("movestart",i)),this._zooming&&!p.zooming&&this.fire(new a.l("zoomstart",i)),this._rotating&&!p.rotating&&this.fire(new a.l("rotatestart",i)),this._pitching&&!p.pitching&&this.fire(new a.l("pitchstart",i)),this._rolling&&!p.rolling&&this.fire(new a.l("rollstart",i))}_prepareElevation(i){this._elevationCenter=i,this._elevationStart=this.transform.elevation,this._elevationTarget=this.terrain.getElevationForLngLatZoom(i,this.transform.tileZoom),this._elevationFreeze=!0}_updateElevation(i){this._elevationStart!==void 0&&this._elevationCenter!==void 0||this._prepareElevation(this.transform.center),this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom));const d=this.terrain.getElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom);if(i<1&&d!==this._elevationTarget){const p=this._elevationTarget-this._elevationStart;this._elevationStart+=i*(p-(d-(p*i+this._elevationStart))/(1-i)),this._elevationTarget=d}this.transform.setElevation(a.C.number(this._elevationStart,this._elevationTarget,i))}_finalizeElevation(){this._elevationFreeze=!1,this.getCenterClampedToGround()&&this.transform.recalculateZoomAndCenter(this.terrain)}_getTransformForUpdate(){return this.transformCameraUpdate||this.terrain?(this._requestedCameraState||(this._requestedCameraState=this.transform.clone()),this._requestedCameraState):this.transform}_elevateCameraIfInsideTerrain(i){if(!this.terrain&&i.elevation>=0&&i.pitch<=90)return{};const d=i.getCameraLngLat(),p=i.getCameraAltitude(),_=this.terrain?this.terrain.getElevationForLngLatZoom(d,i.zoom):0;if(p<_){const w=this.calculateCameraOptionsFromTo(d,_,i.center,i.elevation);return{pitch:w.pitch,zoom:w.zoom}}return{}}_applyUpdatedTransform(i){const d=[];if(d.push(_=>this._elevateCameraIfInsideTerrain(_)),this.transformCameraUpdate&&d.push(_=>this.transformCameraUpdate(_)),!d.length)return;const p=i.clone();for(const _ of d){const w=p.clone(),{center:E,zoom:M,roll:D,pitch:$,bearing:U,elevation:K}=_(w);E&&w.setCenter(E),K!==void 0&&w.setElevation(K),M!==void 0&&w.setZoom(M),D!==void 0&&w.setRoll(D),$!==void 0&&w.setPitch($),U!==void 0&&w.setBearing(U),p.apply(w)}this.transform.apply(p)}_fireMoveEvents(i){this.fire(new a.l("move",i)),this._zooming&&this.fire(new a.l("zoom",i)),this._rotating&&this.fire(new a.l("rotate",i)),this._pitching&&this.fire(new a.l("pitch",i)),this._rolling&&this.fire(new a.l("roll",i))}_afterEase(i,d){if(this._easeId&&d&&this._easeId===d)return;delete this._easeId;const p=this._zooming,_=this._rotating,w=this._pitching,E=this._rolling;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._rolling=!1,this._padding=!1,p&&this.fire(new a.l("zoomend",i)),_&&this.fire(new a.l("rotateend",i)),w&&this.fire(new a.l("pitchend",i)),E&&this.fire(new a.l("rollend",i)),this.fire(new a.l("moveend",i))}flyTo(i,d){if(!i.essential&&P.prefersReducedMotion){const We=a.Q(i,["center","zoom","bearing","pitch","roll","elevation"]);return this.jumpTo(We,d)}this.stop(),i=a.e({offset:[0,0],speed:1.2,curve:1.42,easing:a.co},i);const p=this._getTransformForUpdate(),_=p.bearing,w=p.pitch,E=p.roll,M=p.padding,D="bearing"in i?this._normalizeBearing(i.bearing,_):_,$="pitch"in i?+i.pitch:w,U="roll"in i?this._normalizeBearing(i.roll,E):E,K="padding"in i?i.padding:p.padding,H=a.P.convert(i.offset);let ee=p.centerPoint.add(H);const ae=p.screenPointToLocation(ee),me=this.cameraHelper.handleFlyTo(p,{bearing:D,pitch:$,roll:U,padding:K,locationAtOffset:ae,offsetAsPoint:H,center:i.center,minZoom:i.minZoom,zoom:i.zoom});let ge=i.curve;const _e=Math.max(p.width,p.height),Te=_e/me.scaleOfZoom,Ce=me.pixelPathLength;typeof me.scaleOfMinZoom=="number"&&(ge=Math.sqrt(_e/me.scaleOfMinZoom/Ce*2));const Ee=ge*ge;function Ie(We){const ct=(Te*Te-_e*_e+(We?-1:1)*Ee*Ee*Ce*Ce)/(2*(We?Te:_e)*Ee*Ce);return Math.log(Math.sqrt(ct*ct+1)-ct)}function Le(We){return(Math.exp(We)-Math.exp(-We))/2}function Pe(We){return(Math.exp(We)+Math.exp(-We))/2}const Ne=Ie(!1);let qe=function(We){return Pe(Ne)/Pe(Ne+ge*We)},Ve=function(We){return _e*((Pe(Ne)*(Le(ct=Ne+ge*We)/Pe(ct))-Le(Ne))/Ee)/Ce;var ct},Ge=(Ie(!0)-Ne)/ge;if(Math.abs(Ce)<2e-6||!isFinite(Ge)){if(Math.abs(_e-Te)<1e-6)return this.easeTo(i,d);const We=Te<_e?-1:1;Ge=Math.abs(Math.log(Te/_e))/ge,Ve=()=>0,qe=ct=>Math.exp(We*ge*ct)}return i.duration="duration"in i?+i.duration:1e3*Ge/("screenSpeed"in i?+i.screenSpeed/ge:+i.speed),i.maxDuration&&i.duration>i.maxDuration&&(i.duration=0),this._zooming=!0,this._rotating=_!==D,this._pitching=$!==w,this._rolling=U!==E,this._padding=!p.isPaddingEqual(K),this._prepareEase(d,!1),this.terrain&&this._prepareElevation(me.targetCenter),this._ease(We=>{const ct=We*Ge,ut=1/qe(ct),tt=Ve(ct);this._rotating&&p.setBearing(a.C.number(_,D,We)),this._pitching&&p.setPitch(a.C.number(w,$,We)),this._rolling&&p.setRoll(a.C.number(E,U,We)),this._padding&&(p.interpolatePadding(M,K,We),ee=p.centerPoint.add(H)),me.easeFunc(We,ut,tt,ee),this.terrain&&!i.freezeElevation&&this._updateElevation(We),this._applyUpdatedTransform(p),this._fireMoveEvents(d)},()=>{this.terrain&&i.freezeElevation&&this._finalizeElevation(),this._afterEase(d)},i),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_stop(i,d){var p;if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){const _=this._onEaseEnd;delete this._onEaseEnd,_.call(this,d)}return i||(p=this.handlers)===null||p===void 0||p.stop(!1),this}_ease(i,d,p){p.animate===!1||p.duration===0?(i(1),d()):(this._easeStart=P.now(),this._easeOptions=p,this._onEaseFrame=i,this._onEaseEnd=d,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_normalizeBearing(i,d){i=a.aO(i,-180,180);const p=Math.abs(i-d);return Math.abs(i-360-d)<p&&(i-=360),Math.abs(i+360-d)<p&&(i+=360),i}queryTerrainElevation(i){return this.terrain?this.terrain.getElevationForLngLatZoom(a.S.convert(i),this.transform.tileZoom):null}}const kt={compact:!0,customAttribution:'<a href="https://maplibre.org/" target="_blank">MapLibre</a>'};class Bt{constructor(i=kt){this._toggleAttribution=()=>{this._container.classList.contains("maplibregl-compact")&&(this._container.classList.contains("maplibregl-compact-show")?(this._container.setAttribute("open",""),this._container.classList.remove("maplibregl-compact-show")):(this._container.classList.add("maplibregl-compact-show"),this._container.removeAttribute("open")))},this._updateData=d=>{!d||d.sourceDataType!=="metadata"&&d.sourceDataType!=="visibility"&&d.dataType!=="style"&&d.type!=="terrain"||this._updateAttributions()},this._updateCompact=()=>{this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact===!1?this._container.setAttribute("open",""):this._container.classList.contains("maplibregl-compact")||this._container.classList.contains("maplibregl-attrib-empty")||(this._container.setAttribute("open",""),this._container.classList.add("maplibregl-compact","maplibregl-compact-show")):(this._container.setAttribute("open",""),this._container.classList.contains("maplibregl-compact")&&this._container.classList.remove("maplibregl-compact","maplibregl-compact-show"))},this._updateCompactMinimize=()=>{this._container.classList.contains("maplibregl-compact")&&this._container.classList.contains("maplibregl-compact-show")&&this._container.classList.remove("maplibregl-compact-show")},this.options=i}getDefaultPosition(){return"bottom-right"}onAdd(i){return this._map=i,this._compact=this.options.compact,this._container=A.create("details","maplibregl-ctrl maplibregl-ctrl-attrib"),this._compactButton=A.create("summary","maplibregl-ctrl-attrib-button",this._container),this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=A.create("div","maplibregl-ctrl-attrib-inner",this._container),this._updateAttributions(),this._updateCompact(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("terrain",this._updateData),this._map.on("resize",this._updateCompact),this._map.on("drag",this._updateCompactMinimize),this._container}onRemove(){A.remove(this._container),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("terrain",this._updateData),this._map.off("resize",this._updateCompact),this._map.off("drag",this._updateCompactMinimize),this._map=void 0,this._compact=void 0,this._attribHTML=void 0}_setElementTitle(i,d){const p=this._map._getUIString(`AttributionControl.${d}`);i.title=p,i.setAttribute("aria-label",p)}_updateAttributions(){if(!this._map.style)return;let i=[];if(this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?i=i.concat(this.options.customAttribution.map(_=>typeof _!="string"?"":_)):typeof this.options.customAttribution=="string"&&i.push(this.options.customAttribution)),this._map.style.stylesheet){const _=this._map.style.stylesheet;this.styleOwner=_.owner,this.styleId=_.id}const d=this._map.style.sourceCaches;for(const _ in d){const w=d[_];if(w.used||w.usedForTerrain){const E=w.getSource();E.attribution&&i.indexOf(E.attribution)<0&&i.push(E.attribution)}}i=i.filter(_=>String(_).trim()),i.sort((_,w)=>_.length-w.length),i=i.filter((_,w)=>{for(let E=w+1;E<i.length;E++)if(i[E].indexOf(_)>=0)return!1;return!0});const p=i.join(" | ");p!==this._attribHTML&&(this._attribHTML=p,i.length?(this._innerContainer.innerHTML=A.sanitize(p),this._container.classList.remove("maplibregl-attrib-empty")):this._container.classList.add("maplibregl-attrib-empty"),this._updateCompact(),this._editLink=null)}}class Lc{constructor(i={}){this._updateCompact=()=>{const d=this._container.children;if(d.length){const p=d[0];this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact!==!1&&p.classList.add("maplibregl-compact"):p.classList.remove("maplibregl-compact")}},this.options=i}getDefaultPosition(){return"bottom-left"}onAdd(i){this._map=i,this._compact=this.options&&this.options.compact,this._container=A.create("div","maplibregl-ctrl");const d=A.create("a","maplibregl-ctrl-logo");return d.target="_blank",d.rel="noopener nofollow",d.href="https://maplibre.org/",d.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),d.setAttribute("rel","noopener nofollow"),this._container.appendChild(d),this._container.style.display="block",this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){A.remove(this._container),this._map.off("resize",this._updateCompact),this._map=void 0,this._compact=void 0}}class X_{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(i){const d=++this._id;return this._queue.push({callback:i,id:d,cancelled:!1}),d}remove(i){const d=this._currentlyRunning,p=d?this._queue.concat(d):this._queue;for(const _ of p)if(_.id===i)return void(_.cancelled=!0)}run(i=0){if(this._currentlyRunning)throw new Error("Attempting to run(), but is already running.");const d=this._currentlyRunning=this._queue;this._queue=[];for(const p of d)if(!p.cancelled&&(p.callback(i),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}var xf=a.aJ([{name:"a_pos3d",type:"Int16",components:3}]);class Hi extends a.E{constructor(i){super(),this._lastTilesetChange=P.now(),this.sourceCache=i,this._tiles={},this._renderableTilesKeys=[],this._sourceTileCache={},this.minzoom=0,this.maxzoom=22,this.deltaZoom=1,this.tileSize=i._source.tileSize*2**this.deltaZoom,i.usedForTerrain=!0,i.tileSize=this.tileSize}destruct(){this.sourceCache.usedForTerrain=!1,this.sourceCache.tileSize=null}update(i,d){this.sourceCache.update(i,d),this._renderableTilesKeys=[];const p={};for(const _ of Kt(i,{tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,reparseOverscaled:!1,terrain:d,calculateTileZoom:this.sourceCache._source.calculateTileZoom}))p[_.key]=!0,this._renderableTilesKeys.push(_.key),this._tiles[_.key]||(_.terrainRttPosMatrix32f=new Float64Array(16),a.bZ(_.terrainRttPosMatrix32f,0,a.$,a.$,0,0,1),this._tiles[_.key]=new ne(_,this.tileSize),this._lastTilesetChange=P.now());for(const _ in this._tiles)p[_]||delete this._tiles[_]}freeRtt(i){for(const d in this._tiles){const p=this._tiles[d];(!i||p.tileID.equals(i)||p.tileID.isChildOf(i)||i.isChildOf(p.tileID))&&(p.rtt=[])}}getRenderableTiles(){return this._renderableTilesKeys.map(i=>this.getTileByID(i))}getTileByID(i){return this._tiles[i]}getTerrainCoords(i,d){return d?this._getTerrainCoordsForTileRanges(i,d):this._getTerrainCoordsForRegularTile(i)}_getTerrainCoordsForRegularTile(i){const d={};for(const p of this._renderableTilesKeys){const _=this._tiles[p].tileID,w=i.clone(),E=a.ba();if(_.canonical.equals(i.canonical))a.bZ(E,0,a.$,a.$,0,0,1);else if(_.canonical.isChildOf(i.canonical)){const M=_.canonical.z-i.canonical.z,D=_.canonical.x-(_.canonical.x>>M<<M),$=_.canonical.y-(_.canonical.y>>M<<M),U=a.$>>M;a.bZ(E,0,U,U,0,0,1),a.M(E,E,[-D*U,-$*U,0])}else{if(!i.canonical.isChildOf(_.canonical))continue;{const M=i.canonical.z-_.canonical.z,D=i.canonical.x-(i.canonical.x>>M<<M),$=i.canonical.y-(i.canonical.y>>M<<M),U=a.$>>M;a.bZ(E,0,a.$,a.$,0,0,1),a.M(E,E,[D*U,$*U,0]),a.N(E,E,[1/2**M,1/2**M,0])}}w.terrainRttPosMatrix32f=new Float32Array(E),d[p]=w}return d}_getTerrainCoordsForTileRanges(i,d){const p={};for(const _ of this._renderableTilesKeys){const w=this._tiles[_].tileID;if(!this._isWithinTileRanges(w,d))continue;const E=i.clone(),M=a.ba();if(w.canonical.z===i.canonical.z){const D=i.canonical.x-w.canonical.x,$=i.canonical.y-w.canonical.y;a.bZ(M,0,a.$,a.$,0,0,1),a.M(M,M,[D*a.$,$*a.$,0])}else if(w.canonical.z>i.canonical.z){const D=w.canonical.z-i.canonical.z,$=w.canonical.x-(w.canonical.x>>D<<D),U=w.canonical.y-(w.canonical.y>>D<<D),K=i.canonical.x-(w.canonical.x>>D),H=i.canonical.y-(w.canonical.y>>D),ee=a.$>>D;a.bZ(M,0,ee,ee,0,0,1),a.M(M,M,[-$*ee+K*a.$,-U*ee+H*a.$,0])}else{const D=i.canonical.z-w.canonical.z,$=i.canonical.x-(i.canonical.x>>D<<D),U=i.canonical.y-(i.canonical.y>>D<<D),K=(i.canonical.x>>D)-w.canonical.x,H=(i.canonical.y>>D)-w.canonical.y,ee=a.$<<D;a.bZ(M,0,ee,ee,0,0,1),a.M(M,M,[$*a.$+K*ee,U*a.$+H*ee,0])}E.terrainRttPosMatrix32f=new Float32Array(M),p[_]=E}return p}getSourceTile(i,d){const p=this.sourceCache._source;let _=i.overscaledZ-this.deltaZoom;if(_>p.maxzoom&&(_=p.maxzoom),_<p.minzoom)return null;this._sourceTileCache[i.key]||(this._sourceTileCache[i.key]=i.scaledTo(_).key);let w=this.sourceCache.getTileByID(this._sourceTileCache[i.key]);if((!w||!w.dem)&&d)for(;_>=p.minzoom&&(!w||!w.dem);)w=this.sourceCache.getTileByID(i.scaledTo(_--).key);return w}anyTilesAfterTime(i=Date.now()){return this._lastTilesetChange>=i}_isWithinTileRanges(i,d){return d[i.canonical.z]&&i.canonical.x>=d[i.canonical.z].minTileX&&i.canonical.x<=d[i.canonical.z].maxTileX&&i.canonical.y>=d[i.canonical.z].minTileY&&i.canonical.y<=d[i.canonical.z].maxTileY}}class Y_{constructor(i,d,p){this._meshCache={},this.painter=i,this.sourceCache=new Hi(d),this.options=p,this.exaggeration=typeof p.exaggeration=="number"?p.exaggeration:1,this.qualityFactor=2,this.meshSize=128,this._demMatrixCache={},this.coordsIndex=[],this._coordsTextureSize=1024}getDEMElevation(i,d,p,_=a.$){var w;if(!(d>=0&&d<_&&p>=0&&p<_))return 0;const E=this.getTerrainData(i),M=(w=E.tile)===null||w===void 0?void 0:w.dem;if(!M)return 0;const D=a.cs([],[d/_*a.$,p/_*a.$],E.u_terrain_matrix),$=[D[0]*M.dim,D[1]*M.dim],U=Math.floor($[0]),K=Math.floor($[1]),H=$[0]-U,ee=$[1]-K;return M.get(U,K)*(1-H)*(1-ee)+M.get(U+1,K)*H*(1-ee)+M.get(U,K+1)*(1-H)*ee+M.get(U+1,K+1)*H*ee}getElevationForLngLatZoom(i,d){if(!a.ct(d,i.wrap()))return 0;const{tileID:p,mercatorX:_,mercatorY:w}=this._getOverscaledTileIDFromLngLatZoom(i,d);return this.getElevation(p,_%a.$,w%a.$,a.$)}getElevation(i,d,p,_=a.$){return this.getDEMElevation(i,d,p,_)*this.exaggeration}getTerrainData(i){if(!this._emptyDemTexture){const _=this.painter.context,w=new a.R({width:1,height:1},new Uint8Array(4));this._emptyDepthTexture=new a.T(_,w,_.gl.RGBA,{premultiply:!1}),this._emptyDemUnpack=[0,0,0,0],this._emptyDemTexture=new a.T(_,new a.R({width:1,height:1}),_.gl.RGBA,{premultiply:!1}),this._emptyDemTexture.bind(_.gl.NEAREST,_.gl.CLAMP_TO_EDGE),this._emptyDemMatrix=a.ag([])}const d=this.sourceCache.getSourceTile(i,!0);if(d&&d.dem&&(!d.demTexture||d.needsTerrainPrepare)){const _=this.painter.context;d.demTexture=this.painter.getTileTexture(d.dem.stride),d.demTexture?d.demTexture.update(d.dem.getPixels(),{premultiply:!1}):d.demTexture=new a.T(_,d.dem.getPixels(),_.gl.RGBA,{premultiply:!1}),d.demTexture.bind(_.gl.NEAREST,_.gl.CLAMP_TO_EDGE),d.needsTerrainPrepare=!1}const p=d&&d+d.tileID.key+i.key;if(p&&!this._demMatrixCache[p]){const _=this.sourceCache.sourceCache._source.maxzoom;let w=i.canonical.z-d.tileID.canonical.z;i.overscaledZ>i.canonical.z&&(i.canonical.z>=_?w=i.canonical.z-_:a.w("cannot calculate elevation if elevation maxzoom > source.maxzoom"));const E=i.canonical.x-(i.canonical.x>>w<<w),M=i.canonical.y-(i.canonical.y>>w<<w),D=a.cu(new Float64Array(16),[1/(a.$<<w),1/(a.$<<w),0]);a.M(D,D,[E*a.$,M*a.$,0]),this._demMatrixCache[i.key]={matrix:D,coord:i}}return{u_depth:2,u_terrain:3,u_terrain_dim:d&&d.dem&&d.dem.dim||1,u_terrain_matrix:p?this._demMatrixCache[i.key].matrix:this._emptyDemMatrix,u_terrain_unpack:d&&d.dem&&d.dem.getUnpackVector()||this._emptyDemUnpack,u_terrain_exaggeration:this.exaggeration,texture:(d&&d.demTexture||this._emptyDemTexture).texture,depthTexture:(this._fboDepthTexture||this._emptyDepthTexture).texture,tile:d}}getFramebuffer(i){const d=this.painter,p=d.width/devicePixelRatio,_=d.height/devicePixelRatio;return!this._fbo||this._fbo.width===p&&this._fbo.height===_||(this._fbo.destroy(),this._fboCoordsTexture.destroy(),this._fboDepthTexture.destroy(),delete this._fbo,delete this._fboDepthTexture,delete this._fboCoordsTexture),this._fboCoordsTexture||(this._fboCoordsTexture=new a.T(d.context,{width:p,height:_,data:null},d.context.gl.RGBA,{premultiply:!1}),this._fboCoordsTexture.bind(d.context.gl.NEAREST,d.context.gl.CLAMP_TO_EDGE)),this._fboDepthTexture||(this._fboDepthTexture=new a.T(d.context,{width:p,height:_,data:null},d.context.gl.RGBA,{premultiply:!1}),this._fboDepthTexture.bind(d.context.gl.NEAREST,d.context.gl.CLAMP_TO_EDGE)),this._fbo||(this._fbo=d.context.createFramebuffer(p,_,!0,!1),this._fbo.depthAttachment.set(d.context.createRenderbuffer(d.context.gl.DEPTH_COMPONENT16,p,_))),this._fbo.colorAttachment.set(i==="coords"?this._fboCoordsTexture.texture:this._fboDepthTexture.texture),this._fbo}getCoordsTexture(){const i=this.painter.context;if(this._coordsTexture)return this._coordsTexture;const d=new Uint8Array(this._coordsTextureSize*this._coordsTextureSize*4);for(let w=0,E=0;w<this._coordsTextureSize;w++)for(let M=0;M<this._coordsTextureSize;M++,E+=4)d[E+0]=255&M,d[E+1]=255&w,d[E+2]=M>>8<<4|w>>8,d[E+3]=0;const p=new a.R({width:this._coordsTextureSize,height:this._coordsTextureSize},new Uint8Array(d.buffer)),_=new a.T(i,p,i.gl.RGBA,{premultiply:!1});return _.bind(i.gl.NEAREST,i.gl.CLAMP_TO_EDGE),this._coordsTexture=_,_}pointCoordinate(i){this.painter.maybeDrawDepthAndCoords(!0);const d=new Uint8Array(4),p=this.painter.context,_=p.gl,w=Math.round(i.x*this.painter.pixelRatio/devicePixelRatio),E=Math.round(i.y*this.painter.pixelRatio/devicePixelRatio),M=Math.round(this.painter.height/devicePixelRatio);p.bindFramebuffer.set(this.getFramebuffer("coords").framebuffer),_.readPixels(w,M-E-1,1,1,_.RGBA,_.UNSIGNED_BYTE,d),p.bindFramebuffer.set(null);const D=d[0]+(d[2]>>4<<8),$=d[1]+((15&d[2])<<8),U=this.coordsIndex[255-d[3]],K=U&&this.sourceCache.getTileByID(U);if(!K)return null;const H=this._coordsTextureSize,ee=(1<<K.tileID.canonical.z)*H;return new a.a1((K.tileID.canonical.x*H+D)/ee+K.tileID.wrap,(K.tileID.canonical.y*H+$)/ee,this.getElevation(K.tileID,D,$,H))}depthAtPoint(i){const d=new Uint8Array(4),p=this.painter.context,_=p.gl;return p.bindFramebuffer.set(this.getFramebuffer("depth").framebuffer),_.readPixels(i.x,this.painter.height/devicePixelRatio-i.y-1,1,1,_.RGBA,_.UNSIGNED_BYTE,d),p.bindFramebuffer.set(null),(d[0]/16777216+d[1]/65536+d[2]/256+d[3])/256}getTerrainMesh(i){var d;const p=((d=this.painter.style.projection)===null||d===void 0?void 0:d.transitionState)>0,_=p&&i.canonical.y===0,w=p&&i.canonical.y===(1<<i.canonical.z)-1,E=`m_${_?"n":""}_${w?"s":""}`;if(this._meshCache[E])return this._meshCache[E];const M=this.painter.context,D=new a.cv,$=new a.aN,U=this.meshSize,K=a.$/U,H=U*U;for(let Pe=0;Pe<=U;Pe++)for(let Ne=0;Ne<=U;Ne++)D.emplaceBack(Ne*K,Pe*K,0);for(let Pe=0;Pe<H;Pe+=U+1)for(let Ne=0;Ne<U;Ne++)$.emplaceBack(Ne+Pe,U+Ne+Pe+1,U+Ne+Pe+2),$.emplaceBack(Ne+Pe,U+Ne+Pe+2,Ne+Pe+1);const ee=D.length,ae=ee+(U+1),me=(U+1)*U,ge=_?a.bh:0,_e=_?0:1,Te=w?a.bi:a.$,Ce=w?0:1;for(let Pe=0;Pe<=U;Pe++)D.emplaceBack(Pe*K,ge,_e);for(let Pe=0;Pe<=U;Pe++)D.emplaceBack(Pe*K,Te,Ce);for(let Pe=0;Pe<U;Pe++)$.emplaceBack(me+Pe,ae+Pe,ae+Pe+1),$.emplaceBack(me+Pe,ae+Pe+1,me+Pe+1),$.emplaceBack(0+Pe,ee+Pe+1,ee+Pe),$.emplaceBack(0+Pe,0+Pe+1,ee+Pe+1);const Ee=D.length,Ie=Ee+2*(U+1);for(const Pe of[0,1])for(let Ne=0;Ne<=U;Ne++)for(const qe of[0,1])D.emplaceBack(Pe*a.$,Ne*K,qe);for(let Pe=0;Pe<2*U;Pe+=2)$.emplaceBack(Ee+Pe,Ee+Pe+1,Ee+Pe+3),$.emplaceBack(Ee+Pe,Ee+Pe+3,Ee+Pe+2),$.emplaceBack(Ie+Pe,Ie+Pe+3,Ie+Pe+1),$.emplaceBack(Ie+Pe,Ie+Pe+2,Ie+Pe+3);const Le=new mc(M.createVertexBuffer(D,xf.members),M.createIndexBuffer($),a.aM.simpleSegment(0,0,D.length,$.length));return this._meshCache[E]=Le,Le}getMeshFrameDelta(i){return 2*Math.PI*a.bu/Math.pow(2,Math.max(i,0))/5}getMinTileElevationForLngLatZoom(i,d){var p;const{tileID:_}=this._getOverscaledTileIDFromLngLatZoom(i,d);return(p=this.getMinMaxElevation(_).minElevation)!==null&&p!==void 0?p:0}getMinMaxElevation(i){const d=this.getTerrainData(i).tile,p={minElevation:null,maxElevation:null};return d&&d.dem&&(p.minElevation=d.dem.min*this.exaggeration,p.maxElevation=d.dem.max*this.exaggeration),p}_getOverscaledTileIDFromLngLatZoom(i,d){const p=a.a1.fromLngLat(i.wrap()),_=(1<<d)*a.$,w=p.x*_,E=p.y*_,M=Math.floor(w/a.$),D=Math.floor(E/a.$);return{tileID:new a.Z(d,0,d,M,D),mercatorX:w,mercatorY:E}}}class ao{constructor(i,d,p){this._context=i,this._size=d,this._tileSize=p,this._objects=[],this._recentlyUsed=[],this._stamp=0}destruct(){for(const i of this._objects)i.texture.destroy(),i.fbo.destroy()}_createObject(i){const d=this._context.createFramebuffer(this._tileSize,this._tileSize,!0,!0),p=new a.T(this._context,{width:this._tileSize,height:this._tileSize,data:null},this._context.gl.RGBA);return p.bind(this._context.gl.LINEAR,this._context.gl.CLAMP_TO_EDGE),this._context.extTextureFilterAnisotropic&&this._context.gl.texParameterf(this._context.gl.TEXTURE_2D,this._context.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,this._context.extTextureFilterAnisotropicMax),d.depthAttachment.set(this._context.createRenderbuffer(this._context.gl.DEPTH_STENCIL,this._tileSize,this._tileSize)),d.colorAttachment.set(p.texture),{id:i,fbo:d,texture:p,stamp:-1,inUse:!1}}getObjectForId(i){return this._objects[i]}useObject(i){i.inUse=!0,this._recentlyUsed=this._recentlyUsed.filter(d=>i.id!==d),this._recentlyUsed.push(i.id)}stampObject(i){i.stamp=++this._stamp}getOrCreateFreeObject(){for(const d of this._recentlyUsed)if(!this._objects[d].inUse)return this._objects[d];if(this._objects.length>=this._size)throw new Error("No free RenderPool available, call freeAllObjects() required!");const i=this._createObject(this._objects.length);return this._objects.push(i),i}freeObject(i){i.inUse=!1}freeAllObjects(){for(const i of this._objects)this.freeObject(i)}isFull(){return!(this._objects.length<this._size)&&this._objects.some(i=>!i.inUse)===!1}}const Dl={background:!0,fill:!0,line:!0,raster:!0,hillshade:!0,"color-relief":!0};class iw{constructor(i,d){this.painter=i,this.terrain=d,this.pool=new ao(i.context,30,d.sourceCache.tileSize*d.qualityFactor)}destruct(){this.pool.destruct()}getTexture(i){return this.pool.getObjectForId(i.rtt[this._stacks.length-1].id).texture}prepareForRender(i,d){this._stacks=[],this._prevType=null,this._rttTiles=[],this._renderableTiles=this.terrain.sourceCache.getRenderableTiles(),this._renderableLayerIds=i._order.filter(p=>!i._layers[p].isHidden(d)),this._coordsAscending={};for(const p in i.sourceCaches){this._coordsAscending[p]={};const _=i.sourceCaches[p].getVisibleCoordinates(),w=i.sourceCaches[p].getSource(),E=w instanceof Ar?w.terrainTileRanges:null;for(const M of _){const D=this.terrain.sourceCache.getTerrainCoords(M,E);for(const $ in D)this._coordsAscending[p][$]||(this._coordsAscending[p][$]=[]),this._coordsAscending[p][$].push(D[$])}}this._coordsAscendingStr={};for(const p of i._order){const _=i._layers[p],w=_.source;if(Dl[_.type]&&!this._coordsAscendingStr[w]){this._coordsAscendingStr[w]={};for(const E in this._coordsAscending[w])this._coordsAscendingStr[w][E]=this._coordsAscending[w][E].map(M=>M.key).sort().join()}}for(const p of this._renderableTiles)for(const _ in this._coordsAscendingStr){const w=this._coordsAscendingStr[_][p.tileID.key];w&&w!==p.rttCoords[_]&&(p.rtt=[])}}renderLayer(i,d){if(i.isHidden(this.painter.transform.zoom))return!1;const p=Object.assign(Object.assign({},d),{isRenderingToTexture:!0}),_=i.type,w=this.painter,E=this._renderableLayerIds[this._renderableLayerIds.length-1]===i.id;if(Dl[_]&&(this._prevType&&Dl[this._prevType]||this._stacks.push([]),this._prevType=_,this._stacks[this._stacks.length-1].push(i.id),!E))return!0;if(Dl[this._prevType]||Dl[_]&&E){this._prevType=_;const M=this._stacks.length-1,D=this._stacks[M]||[];for(const $ of this._renderableTiles){if(this.pool.isFull()&&(pf(this.painter,this.terrain,this._rttTiles,p),this._rttTiles=[],this.pool.freeAllObjects()),this._rttTiles.push($),$.rtt[M]){const K=this.pool.getObjectForId($.rtt[M].id);if(K.stamp===$.rtt[M].stamp){this.pool.useObject(K);continue}}const U=this.pool.getOrCreateFreeObject();this.pool.useObject(U),this.pool.stampObject(U),$.rtt[M]={id:U.id,stamp:U.stamp},w.context.bindFramebuffer.set(U.fbo.framebuffer),w.context.clear({color:a.bf.transparent,stencil:0}),w.currentStencilSource=void 0;for(let K=0;K<D.length;K++){const H=w.style._layers[D[K]],ee=H.source?this._coordsAscending[H.source][$.tileID.key]:[$.tileID];w.context.viewport.set([0,0,U.fbo.width,U.fbo.height]),w._renderTileClippingMasks(H,ee,!0),w.renderLayer(w,w.style.sourceCaches[H.source],H,ee,p),H.source&&($.rttCoords[H.source]=this._coordsAscendingStr[H.source][$.tileID.key])}}return pf(this.painter,this.terrain,this._rttTiles,p),this._rttTiles=[],this.pool.freeAllObjects(),Dl[_]}return!1}}const sw={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"MapLibre logo","Map.Title":"Map","Marker.Title":"Map marker","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","Popup.Close":"Close popup","ScaleControl.Feet":"ft","ScaleControl.Meters":"m","ScaleControl.Kilometers":"km","ScaleControl.Miles":"mi","ScaleControl.NauticalMiles":"nm","GlobeControl.Enable":"Enable globe","GlobeControl.Disable":"Disable globe","TerrainControl.Enable":"Enable terrain","TerrainControl.Disable":"Disable terrain","CooperativeGesturesHandler.WindowsHelpText":"Use Ctrl + scroll to zoom the map","CooperativeGesturesHandler.MacHelpText":"Use  + scroll to zoom the map","CooperativeGesturesHandler.MobileHelpText":"Use two fingers to move the map"},ow=m,Oc={hash:!1,interactive:!0,bearingSnap:7,attributionControl:kt,maplibreLogo:!1,refreshExpiredTiles:!0,canvasContextAttributes:{antialias:!1,preserveDrawingBuffer:!1,powerPreference:"high-performance",failIfMajorPerformanceCaveat:!1,desynchronized:!1,contextType:void 0},scrollZoom:!0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:60,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:!1,trackResize:!0,center:[0,0],elevation:0,zoom:0,bearing:0,pitch:0,roll:0,renderWorldCopies:!0,maxTileCacheSize:null,maxTileCacheZoomLevels:a.a.MAX_TILE_CACHE_ZOOM_LEVELS,transformRequest:null,transformCameraUpdate:null,fadeDuration:300,crossSourceCollisions:!0,clickTolerance:3,localIdeographFontFamily:"sans-serif",pitchWithRotate:!0,rollEnabled:!1,validateStyle:!0,maxCanvasSize:[4096,4096],cancelPendingTileRequestsWhileZooming:!0,centerClampedToGround:!0},nn={showCompass:!0,showZoom:!0,visualizePitch:!1,visualizeRoll:!0};class yn{constructor(i,d,p=!1){this.mousedown=w=>{this.startMove(w,A.mousePos(this.element,w)),A.addEventListener(window,"mousemove",this.mousemove),A.addEventListener(window,"mouseup",this.mouseup)},this.mousemove=w=>{this.move(w,A.mousePos(this.element,w))},this.mouseup=w=>{this._rotatePitchHandler.dragEnd(w),this.offTemp()},this.touchstart=w=>{w.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=A.touchPos(this.element,w.targetTouches)[0],this.startMove(w,this._startPos),A.addEventListener(window,"touchmove",this.touchmove,{passive:!1}),A.addEventListener(window,"touchend",this.touchend))},this.touchmove=w=>{w.targetTouches.length!==1?this.reset():(this._lastPos=A.touchPos(this.element,w.targetTouches)[0],this.move(w,this._lastPos))},this.touchend=w=>{w.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),delete this._startPos,delete this._lastPos,this.offTemp()},this.reset=()=>{this._rotatePitchHandler.reset(),delete this._startPos,delete this._lastPos,this.offTemp()},this._clickTolerance=10,this.element=d;const _=new ag;this._rotatePitchHandler=new ph({clickTolerance:3,move:(w,E)=>{const M=d.getBoundingClientRect(),D=new a.P((M.bottom-M.top)/2,(M.right-M.left)/2);return{bearingDelta:a.cn(new a.P(w.x,E.y),E,D),pitchDelta:p?-.5*(E.y-w.y):void 0}},moveStateManager:_,enable:!0,assignEvents:()=>{}}),this.map=i,A.addEventListener(d,"mousedown",this.mousedown),A.addEventListener(d,"touchstart",this.touchstart,{passive:!1}),A.addEventListener(d,"touchcancel",this.reset)}startMove(i,d){this._rotatePitchHandler.dragStart(i,d),A.disableDrag()}move(i,d){const p=this.map,{bearingDelta:_,pitchDelta:w}=this._rotatePitchHandler.dragMove(i,d)||{};_&&p.setBearing(p.getBearing()+_),w&&p.setPitch(p.getPitch()+w)}off(){const i=this.element;A.removeEventListener(i,"mousedown",this.mousedown),A.removeEventListener(i,"touchstart",this.touchstart,{passive:!1}),A.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),A.removeEventListener(window,"touchend",this.touchend),A.removeEventListener(i,"touchcancel",this.reset),this.offTemp()}offTemp(){A.enableDrag(),A.removeEventListener(window,"mousemove",this.mousemove),A.removeEventListener(window,"mouseup",this.mouseup),A.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),A.removeEventListener(window,"touchend",this.touchend)}}let Fa;function zc(x,i,d,p=!1){if(p||!d.getCoveringTilesDetailsProvider().allowWorldCopies())return x==null?void 0:x.wrap();const _=new a.S(x.lng,x.lat);if(x=new a.S(x.lng,x.lat),i){const w=new a.S(x.lng-360,x.lat),E=new a.S(x.lng+360,x.lat),M=d.locationToScreenPoint(x).distSqr(i);d.locationToScreenPoint(w).distSqr(i)<M?x=w:d.locationToScreenPoint(E).distSqr(i)<M&&(x=E)}for(;Math.abs(x.lng-d.center.lng)>180;){const w=d.locationToScreenPoint(x);if(w.x>=0&&w.y>=0&&w.x<=d.width&&w.y<=d.height)break;x.lng>d.center.lng?x.lng-=360:x.lng+=360}return x.lng!==_.lng&&d.isPointOnMapSurface(d.locationToScreenPoint(x))?x:_}const Nc={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function bf(x,i,d){const p=x.classList;for(const _ in Nc)p.remove(`maplibregl-${d}-anchor-${_}`);p.add(`maplibregl-${d}-anchor-${i}`)}class xh extends a.E{constructor(i){if(super(),this._onKeyPress=d=>{const p=d.code,_=d.charCode||d.keyCode;p!=="Space"&&p!=="Enter"&&_!==32&&_!==13||this.togglePopup()},this._onMapClick=d=>{const p=d.originalEvent.target,_=this._element;this._popup&&(p===_||_.contains(p))&&this.togglePopup()},this._update=d=>{if(!this._map)return;const p=this._map.loaded()&&!this._map.isMoving();((d==null?void 0:d.type)==="terrain"||(d==null?void 0:d.type)==="render"&&!p)&&this._map.once("render",this._update),this._lngLat=zc(this._lngLat,this._flatPos,this._map.transform),this._flatPos=this._pos=this._map.project(this._lngLat)._add(this._offset),this._map.terrain&&(this._flatPos=this._map.transform.locationToScreenPoint(this._lngLat)._add(this._offset));let _="";this._rotationAlignment==="viewport"||this._rotationAlignment==="auto"?_=`rotateZ(${this._rotation}deg)`:this._rotationAlignment==="map"&&(_=`rotateZ(${this._rotation-this._map.getBearing()}deg)`);let w="";this._pitchAlignment==="viewport"||this._pitchAlignment==="auto"?w="rotateX(0deg)":this._pitchAlignment==="map"&&(w=`rotateX(${this._map.getPitch()}deg)`),this._subpixelPositioning||d&&d.type!=="moveend"||(this._pos=this._pos.round()),A.setTransform(this._element,`${Nc[this._anchor]} translate(${this._pos.x}px, ${this._pos.y}px) ${w} ${_}`),P.frameAsync(new AbortController).then(()=>{this._updateOpacity(d&&d.type==="moveend")}).catch(()=>{})},this._onMove=d=>{if(!this._isDragging){const p=this._clickTolerance||this._map._clickTolerance;this._isDragging=d.point.dist(this._pointerdownPos)>=p}this._isDragging&&(this._pos=d.point.sub(this._positionDelta),this._lngLat=this._map.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new a.l("dragstart"))),this.fire(new a.l("drag")))},this._onUp=()=>{this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1,this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),this._state==="active"&&this.fire(new a.l("dragend")),this._state="inactive"},this._addDragHandler=d=>{this._element.contains(d.originalEvent.target)&&(d.preventDefault(),this._positionDelta=d.point.sub(this._pos).add(this._offset),this._pointerdownPos=d.point,this._state="pending",this._map.on("mousemove",this._onMove),this._map.on("touchmove",this._onMove),this._map.once("mouseup",this._onUp),this._map.once("touchend",this._onUp))},this._anchor=i&&i.anchor||"center",this._color=i&&i.color||"#3FB1CE",this._scale=i&&i.scale||1,this._draggable=i&&i.draggable||!1,this._clickTolerance=i&&i.clickTolerance||0,this._subpixelPositioning=i&&i.subpixelPositioning||!1,this._isDragging=!1,this._state="inactive",this._rotation=i&&i.rotation||0,this._rotationAlignment=i&&i.rotationAlignment||"auto",this._pitchAlignment=i&&i.pitchAlignment&&i.pitchAlignment!=="auto"?i.pitchAlignment:this._rotationAlignment,this.setOpacity(i==null?void 0:i.opacity,i==null?void 0:i.opacityWhenCovered),i&&i.element)this._element=i.element,this._offset=a.P.convert(i&&i.offset||[0,0]);else{this._defaultMarker=!0,this._element=A.create("div");const d=A.createNS("http://www.w3.org/2000/svg","svg"),p=41,_=27;d.setAttributeNS(null,"display","block"),d.setAttributeNS(null,"height",`${p}px`),d.setAttributeNS(null,"width",`${_}px`),d.setAttributeNS(null,"viewBox",`0 0 ${_} ${p}`);const w=A.createNS("http://www.w3.org/2000/svg","g");w.setAttributeNS(null,"stroke","none"),w.setAttributeNS(null,"stroke-width","1"),w.setAttributeNS(null,"fill","none"),w.setAttributeNS(null,"fill-rule","evenodd");const E=A.createNS("http://www.w3.org/2000/svg","g");E.setAttributeNS(null,"fill-rule","nonzero");const M=A.createNS("http://www.w3.org/2000/svg","g");M.setAttributeNS(null,"transform","translate(3.0, 29.0)"),M.setAttributeNS(null,"fill","#000000");const D=[{rx:"10.5",ry:"5.25002273"},{rx:"10.5",ry:"5.25002273"},{rx:"9.5",ry:"4.77275007"},{rx:"8.5",ry:"4.29549936"},{rx:"7.5",ry:"3.81822308"},{rx:"6.5",ry:"3.34094679"},{rx:"5.5",ry:"2.86367051"},{rx:"4.5",ry:"2.38636864"}];for(const _e of D){const Te=A.createNS("http://www.w3.org/2000/svg","ellipse");Te.setAttributeNS(null,"opacity","0.04"),Te.setAttributeNS(null,"cx","10.5"),Te.setAttributeNS(null,"cy","5.80029008"),Te.setAttributeNS(null,"rx",_e.rx),Te.setAttributeNS(null,"ry",_e.ry),M.appendChild(Te)}const $=A.createNS("http://www.w3.org/2000/svg","g");$.setAttributeNS(null,"fill",this._color);const U=A.createNS("http://www.w3.org/2000/svg","path");U.setAttributeNS(null,"d","M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"),$.appendChild(U);const K=A.createNS("http://www.w3.org/2000/svg","g");K.setAttributeNS(null,"opacity","0.25"),K.setAttributeNS(null,"fill","#000000");const H=A.createNS("http://www.w3.org/2000/svg","path");H.setAttributeNS(null,"d","M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"),K.appendChild(H);const ee=A.createNS("http://www.w3.org/2000/svg","g");ee.setAttributeNS(null,"transform","translate(6.0, 7.0)"),ee.setAttributeNS(null,"fill","#FFFFFF");const ae=A.createNS("http://www.w3.org/2000/svg","g");ae.setAttributeNS(null,"transform","translate(8.0, 8.0)");const me=A.createNS("http://www.w3.org/2000/svg","circle");me.setAttributeNS(null,"fill","#000000"),me.setAttributeNS(null,"opacity","0.25"),me.setAttributeNS(null,"cx","5.5"),me.setAttributeNS(null,"cy","5.5"),me.setAttributeNS(null,"r","5.4999962");const ge=A.createNS("http://www.w3.org/2000/svg","circle");ge.setAttributeNS(null,"fill","#FFFFFF"),ge.setAttributeNS(null,"cx","5.5"),ge.setAttributeNS(null,"cy","5.5"),ge.setAttributeNS(null,"r","5.4999962"),ae.appendChild(me),ae.appendChild(ge),E.appendChild(M),E.appendChild($),E.appendChild(K),E.appendChild(ee),E.appendChild(ae),d.appendChild(E),d.setAttributeNS(null,"height",p*this._scale+"px"),d.setAttributeNS(null,"width",_*this._scale+"px"),this._element.appendChild(d),this._offset=a.P.convert(i&&i.offset||[0,-14])}if(this._element.classList.add("maplibregl-marker"),this._element.addEventListener("dragstart",d=>{d.preventDefault()}),this._element.addEventListener("mousedown",d=>{d.preventDefault()}),bf(this._element,this._anchor,"marker"),i&&i.className)for(const d of i.className.split(" "))this._element.classList.add(d);this._popup=null}addTo(i){return this.remove(),this._map=i,this._element.hasAttribute("aria-label")||this._element.setAttribute("aria-label",i._getUIString("Marker.Title")),this._element.hasAttribute("role")||this._element.setAttribute("role","button"),i.getCanvasContainer().appendChild(this._element),i.on("move",this._update),i.on("moveend",this._update),i.on("terrain",this._update),i.on("projectiontransition",this._update),this.setDraggable(this._draggable),this._update(),this._map.on("click",this._onMapClick),this}remove(){return this._opacityTimeout&&(clearTimeout(this._opacityTimeout),delete this._opacityTimeout),this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._update),this._map.off("moveend",this._update),this._map.off("terrain",this._update),this._map.off("projectiontransition",this._update),this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler),this._map.off("mouseup",this._onUp),this._map.off("touchend",this._onUp),this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),delete this._map),A.remove(this._element),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(i){return this._lngLat=a.S.convert(i),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(),this}getElement(){return this._element}setPopup(i){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),i){if(!("offset"in i.options)){const _=Math.abs(13.5)/Math.SQRT2;i.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[_,-1*(38.1-13.5+_)],"bottom-right":[-_,-1*(38.1-13.5+_)],left:[13.5,-1*(38.1-13.5)],right:[-13.5,-1*(38.1-13.5)]}:this._offset}this._popup=i,this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress)}return this}setSubpixelPositioning(i){return this._subpixelPositioning=i,this}getPopup(){return this._popup}togglePopup(){const i=this._popup;return this._element.style.opacity===this._opacityWhenCovered?this:i?(i.isOpen()?i.remove():(i.setLngLat(this._lngLat),i.addTo(this._map)),this):this}_updateOpacity(i=!1){var d,p;const _=(d=this._map)===null||d===void 0?void 0:d.terrain,w=this._map.transform.isLocationOccluded(this._lngLat);if(!_||w){const ee=w?this._opacityWhenCovered:this._opacity;return void(this._element.style.opacity!==ee&&(this._element.style.opacity=ee))}if(i)this._opacityTimeout=null;else{if(this._opacityTimeout)return;this._opacityTimeout=setTimeout(()=>{this._opacityTimeout=null},100)}const E=this._map,M=E.terrain.depthAtPoint(this._pos),D=E.terrain.getElevationForLngLatZoom(this._lngLat,E.transform.tileZoom);if(E.transform.lngLatToCameraDepth(this._lngLat,D)-M<.006)return void(this._element.style.opacity=this._opacity);const $=-this._offset.y/E.transform.pixelsPerMeter,U=Math.sin(E.getPitch()*Math.PI/180)*$,K=E.terrain.depthAtPoint(new a.P(this._pos.x,this._pos.y-this._offset.y)),H=E.transform.lngLatToCameraDepth(this._lngLat,D+U)-K>.006;!((p=this._popup)===null||p===void 0)&&p.isOpen()&&H&&this._popup.remove(),this._element.style.opacity=H?this._opacityWhenCovered:this._opacity}getOffset(){return this._offset}setOffset(i){return this._offset=a.P.convert(i),this._update(),this}addClassName(i){this._element.classList.add(i)}removeClassName(i){this._element.classList.remove(i)}toggleClassName(i){return this._element.classList.toggle(i)}setDraggable(i){return this._draggable=!!i,this._map&&(i?(this._map.on("mousedown",this._addDragHandler),this._map.on("touchstart",this._addDragHandler)):(this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(i){return this._rotation=i||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(i){return this._rotationAlignment=i||"auto",this._update(),this}getRotationAlignment(){return this._rotationAlignment}setPitchAlignment(i){return this._pitchAlignment=i&&i!=="auto"?i:this._rotationAlignment,this._update(),this}getPitchAlignment(){return this._pitchAlignment}setOpacity(i,d){return(this._opacity===void 0||i===void 0&&d===void 0)&&(this._opacity="1",this._opacityWhenCovered="0.2"),i!==void 0&&(this._opacity=i),d!==void 0&&(this._opacityWhenCovered=d),this._map&&this._updateOpacity(!0),this}}const hg={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0};let Ba=0,Ll=!1;const dg={maxWidth:100,unit:"metric"};function wf(x,i,d){const p=d&&d.maxWidth||100,_=x._container.clientHeight/2,w=x._container.clientWidth/2,E=x.unproject([w-p/2,_]),M=x.unproject([w+p/2,_]),D=Math.round(x.project(M).x-x.project(E).x),$=Math.min(p,D,x._container.clientWidth),U=E.distanceTo(M);if(d&&d.unit==="imperial"){const K=3.2808*U;K>5280?Ol(i,$,K/5280,x._getUIString("ScaleControl.Miles")):Ol(i,$,K,x._getUIString("ScaleControl.Feet"))}else d&&d.unit==="nautical"?Ol(i,$,U/1852,x._getUIString("ScaleControl.NauticalMiles")):U>=1e3?Ol(i,$,U/1e3,x._getUIString("ScaleControl.Kilometers")):Ol(i,$,U,x._getUIString("ScaleControl.Meters"))}function Ol(x,i,d,p){const _=function(w){const E=Math.pow(10,`${Math.floor(w)}`.length-1);let M=w/E;return M=M>=10?10:M>=5?5:M>=3?3:M>=2?2:M>=1?1:function(D){const $=Math.pow(10,Math.ceil(-Math.log(D)/Math.LN10));return Math.round(D*$)/$}(M),E*M}(d);x.style.width=i*(_/d)+"px",x.innerHTML=`${_}&nbsp;${p}`}const fg={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px",subpixelPositioning:!1,locationOccludedOpacity:void 0},pg=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function Sf(x){if(x){if(typeof x=="number"){const i=Math.round(Math.abs(x)/Math.SQRT2);return{center:new a.P(0,0),top:new a.P(0,x),"top-left":new a.P(i,i),"top-right":new a.P(-i,i),bottom:new a.P(0,-x),"bottom-left":new a.P(i,-i),"bottom-right":new a.P(-i,-i),left:new a.P(x,0),right:new a.P(-x,0)}}if(x instanceof a.P||Array.isArray(x)){const i=a.P.convert(x);return{center:i,top:i,"top-left":i,"top-right":i,bottom:i,"bottom-left":i,"bottom-right":i,left:i,right:i}}return{center:a.P.convert(x.center||[0,0]),top:a.P.convert(x.top||[0,0]),"top-left":a.P.convert(x["top-left"]||[0,0]),"top-right":a.P.convert(x["top-right"]||[0,0]),bottom:a.P.convert(x.bottom||[0,0]),"bottom-left":a.P.convert(x["bottom-left"]||[0,0]),"bottom-right":a.P.convert(x["bottom-right"]||[0,0]),left:a.P.convert(x.left||[0,0]),right:a.P.convert(x.right||[0,0])}}return Sf(new a.P(0,0))}const mg=m;l.AJAXError=a.cz,l.Event=a.l,l.Evented=a.E,l.LngLat=a.S,l.MercatorCoordinate=a.a1,l.Point=a.P,l.addProtocol=a.cA,l.config=a.a,l.removeProtocol=a.cB,l.AttributionControl=Bt,l.BoxZoomHandler=Bs,l.CanvasSource=Nn,l.CooperativeGesturesHandler=cg,l.DoubleClickZoomHandler=H_,l.DragPanHandler=Z_,l.DragRotateHandler=_h,l.EdgeInsets=Ku,l.FullscreenControl=class extends a.E{constructor(x={}){super(),this._onFullscreenChange=()=>{var i;let d=window.document.fullscreenElement||window.document.mozFullScreenElement||window.document.webkitFullscreenElement||window.document.msFullscreenElement;for(;!((i=d==null?void 0:d.shadowRoot)===null||i===void 0)&&i.fullscreenElement;)d=d.shadowRoot.fullscreenElement;d===this._container!==this._fullscreen&&this._handleFullscreenChange()},this._onClickFullscreen=()=>{this._isFullscreen()?this._exitFullscreen():this._requestFullscreen()},this._fullscreen=!1,x&&x.container&&(x.container instanceof HTMLElement?this._container=x.container:a.w("Full screen control 'container' must be a DOM element.")),"onfullscreenchange"in document?this._fullscreenchange="fullscreenchange":"onmozfullscreenchange"in document?this._fullscreenchange="mozfullscreenchange":"onwebkitfullscreenchange"in document?this._fullscreenchange="webkitfullscreenchange":"onmsfullscreenchange"in document&&(this._fullscreenchange="MSFullscreenChange")}onAdd(x){return this._map=x,this._container||(this._container=this._map.getContainer()),this._controlContainer=A.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._setupUI(),this._controlContainer}onRemove(){A.remove(this._controlContainer),this._map=null,window.document.removeEventListener(this._fullscreenchange,this._onFullscreenChange)}_setupUI(){const x=this._fullscreenButton=A.create("button","maplibregl-ctrl-fullscreen",this._controlContainer);A.create("span","maplibregl-ctrl-icon",x).setAttribute("aria-hidden","true"),x.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),window.document.addEventListener(this._fullscreenchange,this._onFullscreenChange)}_updateTitle(){const x=this._getTitle();this._fullscreenButton.setAttribute("aria-label",x),this._fullscreenButton.title=x}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_handleFullscreenChange(){this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("maplibregl-ctrl-shrink"),this._fullscreenButton.classList.toggle("maplibregl-ctrl-fullscreen"),this._updateTitle(),this._fullscreen?(this.fire(new a.l("fullscreenstart")),this._prevCooperativeGesturesEnabled=this._map.cooperativeGestures.isEnabled(),this._map.cooperativeGestures.disable()):(this.fire(new a.l("fullscreenend")),this._prevCooperativeGesturesEnabled&&this._map.cooperativeGestures.enable())}_exitFullscreen(){window.document.exitFullscreen?window.document.exitFullscreen():window.document.mozCancelFullScreen?window.document.mozCancelFullScreen():window.document.msExitFullscreen?window.document.msExitFullscreen():window.document.webkitCancelFullScreen?window.document.webkitCancelFullScreen():this._togglePseudoFullScreen()}_requestFullscreen(){this._container.requestFullscreen?this._container.requestFullscreen():this._container.mozRequestFullScreen?this._container.mozRequestFullScreen():this._container.msRequestFullscreen?this._container.msRequestFullscreen():this._container.webkitRequestFullscreen?this._container.webkitRequestFullscreen():this._togglePseudoFullScreen()}_togglePseudoFullScreen(){this._container.classList.toggle("maplibregl-pseudo-fullscreen"),this._handleFullscreenChange(),this._map.resize()}},l.GeoJSONSource=Kr,l.GeolocateControl=class extends a.E{constructor(x){super(),this._onSuccess=i=>{if(this._map){if(this._isOutOfMapMaxBounds(i))return this._setErrorState(),this.fire(new a.l("outofmaxbounds",i)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=i,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background");break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(i),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(i),this.options.showUserLocation&&this._dotElement.classList.remove("maplibregl-user-location-dot-stale"),this.fire(new a.l("geolocate",i)),this._finish()}},this._updateCamera=i=>{const d=new a.S(i.coords.longitude,i.coords.latitude),p=i.coords.accuracy,_=this._map.getBearing(),w=a.e({bearing:_},this.options.fitBoundsOptions),E=Et.fromLngLat(d,p);this._map.fitBounds(E,w,{geolocateSource:!0})},this._updateMarker=i=>{if(i){const d=new a.S(i.coords.longitude,i.coords.latitude);this._accuracyCircleMarker.setLngLat(d).addTo(this._map),this._userLocationDotMarker.setLngLat(d).addTo(this._map),this._accuracy=i.coords.accuracy,this._updateCircleRadiusIfNeeded()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()},this._onUpdate=()=>{this._updateCircleRadiusIfNeeded()},this._onError=i=>{if(this._map){if(i.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const d=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.title=d,this._geolocateButton.setAttribute("aria-label",d),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(i.code===3&&Ll)return;this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._dotElement.classList.add("maplibregl-user-location-dot-stale"),this.fire(new a.l("error",i)),this._finish()}},this._finish=()=>{this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0},this._setupUI=()=>{this._map&&(this._container.addEventListener("contextmenu",i=>i.preventDefault()),this._geolocateButton=A.create("button","maplibregl-ctrl-geolocate",this._container),A.create("span","maplibregl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",this._geolocateButton.disabled=!0)},this._finishSetupUI=i=>{if(this._map){if(i===!1){a.w("Geolocation support is not available so the GeolocateControl will be disabled.");const d=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.title=d,this._geolocateButton.setAttribute("aria-label",d)}else{const d=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.disabled=!1,this._geolocateButton.title=d,this._geolocateButton.setAttribute("aria-label",d)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=A.create("div","maplibregl-user-location-dot"),this._userLocationDotMarker=new xh({element:this._dotElement}),this._circleElement=A.create("div","maplibregl-user-location-accuracy-circle"),this._accuracyCircleMarker=new xh({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onUpdate),this._map.on("move",this._onUpdate),this._map.on("rotate",this._onUpdate),this._map.on("pitch",this._onUpdate)),this._geolocateButton.addEventListener("click",()=>this.trigger()),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",d=>{const p=(d==null?void 0:d[0])instanceof ResizeObserverEntry;d.geolocateSource||this._watchState!=="ACTIVE_LOCK"||p||this._map.isZooming()||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this.fire(new a.l("trackuserlocationend")),this.fire(new a.l("userlocationlostfocus")))})}},this.options=a.e({},hg,x)}onAdd(x){return this._map=x,this._container=A.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._setupUI(),function(){return a._(this,arguments,void 0,function*(i=!1){if(Fa!==void 0&&!i)return Fa;if(window.navigator.permissions===void 0)return Fa=!!window.navigator.geolocation,Fa;try{Fa=(yield window.navigator.permissions.query({name:"geolocation"})).state!=="denied"}catch{Fa=!!window.navigator.geolocation}return Fa})}().then(i=>this._finishSetupUI(i)),this._container}onRemove(){this._geolocationWatchID!==void 0&&(window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),A.remove(this._container),this._map.off("zoom",this._onUpdate),this._map.off("move",this._onUpdate),this._map.off("rotate",this._onUpdate),this._map.off("pitch",this._onUpdate),this._map=void 0,Ba=0,Ll=!1}_isOutOfMapMaxBounds(x){const i=this._map.getMaxBounds(),d=x.coords;return i&&(d.longitude<i.getWest()||d.longitude>i.getEast()||d.latitude<i.getSouth()||d.latitude>i.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"ACTIVE_ERROR":case"BACKGROUND_ERROR":case"OFF":case void 0:break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}}_updateCircleRadiusIfNeeded(){const x=this._userLocationDotMarker.getLngLat();if(!(this.options.showUserLocation&&this.options.showAccuracyCircle&&this._accuracy&&x))return;const i=this._map.project(x),d=this._map.unproject([i.x+100,i.y]),p=x.distanceTo(d)/100,_=2*this._accuracy/p;this._circleElement.style.width=`${_.toFixed(2)}px`,this._circleElement.style.height=`${_.toFixed(2)}px`}trigger(){if(!this._setup)return a.w("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new a.l("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":Ba--,Ll=!1,this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this.fire(new a.l("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new a.l("trackuserlocationstart")),this.fire(new a.l("userlocationfocus"));break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"OFF":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){let x;this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),Ba++,Ba>1?(x={maximumAge:6e5,timeout:0},Ll=!0):(x=this.options.positionOptions,Ll=!1),this._geolocationWatchID=window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,x)}}else window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0}_clearWatch(){window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},l.GlobeControl=class{constructor(){this._toggleProjection=()=>{var x;const i=(x=this._map.getProjection())===null||x===void 0?void 0:x.type;this._map.setProjection(i!=="mercator"&&i?{type:"mercator"}:{type:"globe"}),this._updateGlobeIcon()},this._updateGlobeIcon=()=>{var x;this._globeButton.classList.remove("maplibregl-ctrl-globe"),this._globeButton.classList.remove("maplibregl-ctrl-globe-enabled"),((x=this._map.getProjection())===null||x===void 0?void 0:x.type)==="globe"?(this._globeButton.classList.add("maplibregl-ctrl-globe-enabled"),this._globeButton.title=this._map._getUIString("GlobeControl.Disable")):(this._globeButton.classList.add("maplibregl-ctrl-globe"),this._globeButton.title=this._map._getUIString("GlobeControl.Enable"))}}onAdd(x){return this._map=x,this._container=A.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._globeButton=A.create("button","maplibregl-ctrl-globe",this._container),A.create("span","maplibregl-ctrl-icon",this._globeButton).setAttribute("aria-hidden","true"),this._globeButton.type="button",this._globeButton.addEventListener("click",this._toggleProjection),this._updateGlobeIcon(),this._map.on("styledata",this._updateGlobeIcon),this._container}onRemove(){A.remove(this._container),this._map.off("styledata",this._updateGlobeIcon),this._globeButton.removeEventListener("click",this._toggleProjection),this._map=void 0}},l.Hash=ig,l.ImageSource=Ar,l.KeyboardHandler=yf,l.LngLatBounds=Et,l.LogoControl=Lc,l.Map=class extends vf{constructor(x){var i,d;a.cw.mark(a.cx.create);const p=Object.assign(Object.assign(Object.assign({},Oc),x),{canvasContextAttributes:Object.assign(Object.assign({},Oc.canvasContextAttributes),x.canvasContextAttributes)});if(p.minZoom!=null&&p.maxZoom!=null&&p.minZoom>p.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(p.minPitch!=null&&p.maxPitch!=null&&p.minPitch>p.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(p.minPitch!=null&&p.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(p.maxPitch!=null&&p.maxPitch>180)throw new Error("maxPitch must be less than or equal to 180");const _=new yc,w=new Xu;if(p.minZoom!==void 0&&_.setMinZoom(p.minZoom),p.maxZoom!==void 0&&_.setMaxZoom(p.maxZoom),p.minPitch!==void 0&&_.setMinPitch(p.minPitch),p.maxPitch!==void 0&&_.setMaxPitch(p.maxPitch),p.renderWorldCopies!==void 0&&_.setRenderWorldCopies(p.renderWorldCopies),super(_,w,{bearingSnap:p.bearingSnap}),this._idleTriggered=!1,this._crossFadingFactor=1,this._renderTaskQueue=new X_,this._controls=[],this._mapId=a.a7(),this._contextLost=M=>{M.preventDefault(),this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this.fire(new a.l("webglcontextlost",{originalEvent:M}))},this._contextRestored=M=>{this._setupPainter(),this.resize(),this._update(),this.fire(new a.l("webglcontextrestored",{originalEvent:M}))},this._onMapScroll=M=>{if(M.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1},this._onWindowOnline=()=>{this._update()},this._interactive=p.interactive,this._maxTileCacheSize=p.maxTileCacheSize,this._maxTileCacheZoomLevels=p.maxTileCacheZoomLevels,this._canvasContextAttributes=Object.assign({},p.canvasContextAttributes),this._trackResize=p.trackResize===!0,this._bearingSnap=p.bearingSnap,this._centerClampedToGround=p.centerClampedToGround,this._refreshExpiredTiles=p.refreshExpiredTiles===!0,this._fadeDuration=p.fadeDuration,this._crossSourceCollisions=p.crossSourceCollisions===!0,this._collectResourceTiming=p.collectResourceTiming===!0,this._locale=Object.assign(Object.assign({},sw),p.locale),this._clickTolerance=p.clickTolerance,this._overridePixelRatio=p.pixelRatio,this._maxCanvasSize=p.maxCanvasSize,this.transformCameraUpdate=p.transformCameraUpdate,this.cancelPendingTileRequestsWhileZooming=p.cancelPendingTileRequestsWhileZooming===!0,this._imageQueueHandle=W.addThrottleControl(()=>this.isMoving()),this._requestManager=new Z(p.transformRequest),typeof p.container=="string"){if(this._container=document.getElementById(p.container),!this._container)throw new Error(`Container '${p.container}' not found.`)}else{if(!(p.container instanceof HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=p.container}if(p.maxBounds&&this.setMaxBounds(p.maxBounds),this._setupContainer(),this._setupPainter(),this.on("move",()=>this._update(!1)),this.on("moveend",()=>this._update(!1)),this.on("zoom",()=>this._update(!0)),this.on("terrain",()=>{this.painter.terrainFacilitator.dirty=!0,this._update(!0)}),this.once("idle",()=>{this._idleTriggered=!0}),typeof window<"u"){addEventListener("online",this._onWindowOnline,!1);let M=!1;const D=ng($=>{this._trackResize&&!this._removed&&(this.resize($),this.redraw())},50);this._resizeObserver=new ResizeObserver($=>{M?D($):M=!0}),this._resizeObserver.observe(this._container)}this.handlers=new Lo(this,p),this._hash=p.hash&&new ig(typeof p.hash=="string"&&p.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:p.center,elevation:p.elevation,zoom:p.zoom,bearing:p.bearing,pitch:p.pitch,roll:p.roll}),p.bounds&&(this.resize(),this.fitBounds(p.bounds,a.e({},p.fitBoundsOptions,{duration:0}))));const E=typeof p.style=="string"||((d=(i=p.style)===null||i===void 0?void 0:i.projection)===null||d===void 0?void 0:d.type)!=="globe";this.resize(null,E),this._localIdeographFontFamily=p.localIdeographFontFamily,this._validateStyle=p.validateStyle,p.style&&this.setStyle(p.style,{localIdeographFontFamily:p.localIdeographFontFamily}),p.attributionControl&&this.addControl(new Bt(typeof p.attributionControl=="boolean"?void 0:p.attributionControl)),p.maplibreLogo&&this.addControl(new Lc,p.logoPosition),this.on("style.load",()=>{if(E||this._resizeTransform(),this.transform.unmodified){const M=a.Q(this.style.stylesheet,["center","zoom","bearing","pitch","roll"]);this.jumpTo(M)}}),this.on("data",M=>{this._update(M.dataType==="style"),this.fire(new a.l(`${M.dataType}data`,M))}),this.on("dataloading",M=>{this.fire(new a.l(`${M.dataType}dataloading`,M))}),this.on("dataabort",M=>{this.fire(new a.l("sourcedataabort",M))})}_getMapId(){return this._mapId}setGlobalStateProperty(x,i){return this.style.setGlobalStateProperty(x,i),this._update(!0)}getGlobalState(){return this.style.getGlobalState()}addControl(x,i){if(i===void 0&&(i=x.getDefaultPosition?x.getDefaultPosition():"top-right"),!x||!x.onAdd)return this.fire(new a.k(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const d=x.onAdd(this);this._controls.push(x);const p=this._controlPositions[i];return i.indexOf("bottom")!==-1?p.insertBefore(d,p.firstChild):p.appendChild(d),this}removeControl(x){if(!x||!x.onRemove)return this.fire(new a.k(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const i=this._controls.indexOf(x);return i>-1&&this._controls.splice(i,1),x.onRemove(this),this}hasControl(x){return this._controls.indexOf(x)>-1}coveringTiles(x){return Kt(this.transform,x)}calculateCameraOptionsFromTo(x,i,d,p){return p==null&&this.terrain&&(p=this.terrain.getElevationForLngLatZoom(d,this.transform.tileZoom)),super.calculateCameraOptionsFromTo(x,i,d,p)}resize(x,i=!0){const[d,p]=this._containerDimensions(),_=this._getClampedPixelRatio(d,p);if(this._resizeCanvas(d,p,_),this.painter.resize(d,p,_),this.painter.overLimit()){const E=this.painter.context.gl;this._maxCanvasSize=[E.drawingBufferWidth,E.drawingBufferHeight];const M=this._getClampedPixelRatio(d,p);this._resizeCanvas(d,p,M),this.painter.resize(d,p,M)}this._resizeTransform(i);const w=!this._moving;return w&&(this.stop(),this.fire(new a.l("movestart",x)).fire(new a.l("move",x))),this.fire(new a.l("resize",x)),w&&this.fire(new a.l("moveend",x)),this}_resizeTransform(x=!0){var i;const[d,p]=this._containerDimensions();this.transform.resize(d,p,x),(i=this._requestedCameraState)===null||i===void 0||i.resize(d,p,x)}_getClampedPixelRatio(x,i){const{0:d,1:p}=this._maxCanvasSize,_=this.getPixelRatio(),w=x*_,E=i*_;return Math.min(w>d?d/w:1,E>p?p/E:1)*_}getPixelRatio(){var x;return(x=this._overridePixelRatio)!==null&&x!==void 0?x:devicePixelRatio}setPixelRatio(x){this._overridePixelRatio=x,this.resize()}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()}setMaxBounds(x){return this.transform.setMaxBounds(Et.convert(x)),this._update()}setMinZoom(x){if((x=x??-2)>=-2&&x<=this.transform.maxZoom)return this.transform.setMinZoom(x),this._update(),this.getZoom()<x&&this.setZoom(x),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(x){if((x=x??22)>=this.transform.minZoom)return this.transform.setMaxZoom(x),this._update(),this.getZoom()>x&&this.setZoom(x),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(x){if((x=x??0)<0)throw new Error("minPitch must be greater than or equal to 0");if(x>=0&&x<=this.transform.maxPitch)return this.transform.setMinPitch(x),this._update(),this.getPitch()<x&&this.setPitch(x),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(x){if((x=x??60)>180)throw new Error("maxPitch must be less than or equal to 180");if(x>=this.transform.minPitch)return this.transform.setMaxPitch(x),this._update(),this.getPitch()>x&&this.setPitch(x),this;throw new Error("maxPitch must be greater than the current minPitch")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(x){return this.transform.setRenderWorldCopies(x),this._update()}project(x){return this.transform.locationToScreenPoint(a.S.convert(x),this.style&&this.terrain)}unproject(x){return this.transform.screenPointToLocation(a.P.convert(x),this.terrain)}isMoving(){var x;return this._moving||((x=this.handlers)===null||x===void 0?void 0:x.isMoving())}isZooming(){var x;return this._zooming||((x=this.handlers)===null||x===void 0?void 0:x.isZooming())}isRotating(){var x;return this._rotating||((x=this.handlers)===null||x===void 0?void 0:x.isRotating())}_createDelegatedListener(x,i,d){if(x==="mouseenter"||x==="mouseover"){let p=!1;return{layers:i,listener:d,delegates:{mousemove:w=>{const E=i.filter(D=>this.getLayer(D)),M=E.length!==0?this.queryRenderedFeatures(w.point,{layers:E}):[];M.length?p||(p=!0,d.call(this,new is(x,this,w.originalEvent,{features:M}))):p=!1},mouseout:()=>{p=!1}}}}if(x==="mouseleave"||x==="mouseout"){let p=!1;return{layers:i,listener:d,delegates:{mousemove:E=>{const M=i.filter(D=>this.getLayer(D));(M.length!==0?this.queryRenderedFeatures(E.point,{layers:M}):[]).length?p=!0:p&&(p=!1,d.call(this,new is(x,this,E.originalEvent)))},mouseout:E=>{p&&(p=!1,d.call(this,new is(x,this,E.originalEvent)))}}}}{const p=_=>{const w=i.filter(M=>this.getLayer(M)),E=w.length!==0?this.queryRenderedFeatures(_.point,{layers:w}):[];E.length&&(_.features=E,d.call(this,_),delete _.features)};return{layers:i,listener:d,delegates:{[x]:p}}}}_saveDelegatedListener(x,i){this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[x]=this._delegatedListeners[x]||[],this._delegatedListeners[x].push(i)}_removeDelegatedListener(x,i,d){if(!this._delegatedListeners||!this._delegatedListeners[x])return;const p=this._delegatedListeners[x];for(let _=0;_<p.length;_++){const w=p[_];if(w.listener===d&&w.layers.length===i.length&&w.layers.every(E=>i.includes(E))){for(const E in w.delegates)this.off(E,w.delegates[E]);return void p.splice(_,1)}}}on(x,i,d){if(d===void 0)return super.on(x,i);const p=typeof i=="string"?[i]:i,_=this._createDelegatedListener(x,p,d);this._saveDelegatedListener(x,_);for(const w in _.delegates)this.on(w,_.delegates[w]);return{unsubscribe:()=>{this._removeDelegatedListener(x,p,d)}}}once(x,i,d){if(d===void 0)return super.once(x,i);const p=typeof i=="string"?[i]:i,_=this._createDelegatedListener(x,p,d);for(const w in _.delegates){const E=_.delegates[w];_.delegates[w]=(...M)=>{this._removeDelegatedListener(x,p,d),E(...M)}}this._saveDelegatedListener(x,_);for(const w in _.delegates)this.once(w,_.delegates[w]);return this}off(x,i,d){return d===void 0?super.off(x,i):(this._removeDelegatedListener(x,typeof i=="string"?[i]:i,d),this)}queryRenderedFeatures(x,i){if(!this.style)return[];let d;const p=x instanceof a.P||Array.isArray(x),_=p?x:[[0,0],[this.transform.width,this.transform.height]];if(i=i||(p?{}:x)||{},_ instanceof a.P||typeof _[0]=="number")d=[a.P.convert(_)];else{const w=a.P.convert(_[0]),E=a.P.convert(_[1]);d=[w,new a.P(E.x,w.y),E,new a.P(w.x,E.y),w]}return this.style.queryRenderedFeatures(d,i,this.transform)}querySourceFeatures(x,i){return this.style.querySourceFeatures(x,i)}setStyle(x,i){return(i=a.e({},{localIdeographFontFamily:this._localIdeographFontFamily,validate:this._validateStyle},i)).diff!==!1&&i.localIdeographFontFamily===this._localIdeographFontFamily&&this.style&&x?(this._diffStyle(x,i),this):(this._localIdeographFontFamily=i.localIdeographFontFamily,this._updateStyle(x,i))}setTransformRequest(x){return this._requestManager.setTransformRequest(x),this}_getUIString(x){const i=this._locale[x];if(i==null)throw new Error(`Missing UI string '${x}'`);return i}_updateStyle(x,i){var d,p;if(i.transformStyle&&this.style&&!this.style._loaded)return void this.style.once("style.load",()=>this._updateStyle(x,i));const _=this.style&&i.transformStyle?this.style.serialize():void 0;return this.style&&(this.style.setEventedParent(null),this.style._remove(!x)),x?(this.style=new Om(this,i||{}),this.style.setEventedParent(this,{style:this.style}),typeof x=="string"?this.style.loadURL(x,i,_):this.style.loadJSON(x,i,_),this):((p=(d=this.style)===null||d===void 0?void 0:d.projection)===null||p===void 0||p.destroy(),delete this.style,this)}_lazyInitEmptyStyle(){this.style||(this.style=new Om(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}_diffStyle(x,i){if(typeof x=="string"){const d=this._requestManager.transformRequest(x,"Style");a.j(d,new AbortController).then(p=>{this._updateDiff(p.data,i)}).catch(p=>{p&&this.fire(new a.k(p))})}else typeof x=="object"&&this._updateDiff(x,i)}_updateDiff(x,i){try{this.style.setState(x,i)&&this._update(!0)}catch(d){a.w(`Unable to perform style diff: ${d.message||d.error||d}.  Rebuilding the style from scratch.`),this._updateStyle(x,i)}}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():a.w("There is no style added to the map.")}addSource(x,i){return this._lazyInitEmptyStyle(),this.style.addSource(x,i),this._update(!0)}isSourceLoaded(x){const i=this.style&&this.style.sourceCaches[x];if(i!==void 0)return i.loaded();this.fire(new a.k(new Error(`There is no source with ID '${x}'`)))}setTerrain(x){if(this.style._checkLoaded(),this._terrainDataCallback&&this.style.off("data",this._terrainDataCallback),x){const i=this.style.sourceCaches[x.source];if(!i)throw new Error(`cannot load terrain, because there exists no source with ID: ${x.source}`);this.terrain===null&&i.reload();for(const d in this.style._layers){const p=this.style._layers[d];p.type==="hillshade"&&p.source===x.source&&a.w("You are using the same source for a hillshade layer and for 3D terrain. Please consider using two separate sources to improve rendering quality."),p.type==="color-relief"&&p.source===x.source&&a.w("You are using the same source for a color-relief layer and for 3D terrain. Please consider using two separate sources to improve rendering quality.")}this.terrain=new Y_(this.painter,i,x),this.painter.renderToTexture=new iw(this.painter,this.terrain),this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this.transform.setElevation(this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this._terrainDataCallback=d=>{var p;d.dataType==="style"?this.terrain.sourceCache.freeRtt():d.dataType==="source"&&d.tile&&(d.sourceId!==x.source||this._elevationFreeze||(this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this._centerClampedToGround&&this.transform.setElevation(this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom))),((p=d.source)===null||p===void 0?void 0:p.type)==="image"?this.terrain.sourceCache.freeRtt():this.terrain.sourceCache.freeRtt(d.tile.tileID))},this.style.on("data",this._terrainDataCallback)}else this.terrain&&this.terrain.sourceCache.destruct(),this.terrain=null,this.painter.renderToTexture&&this.painter.renderToTexture.destruct(),this.painter.renderToTexture=null,this.transform.setMinElevationForCurrentTile(0),this._centerClampedToGround&&this.transform.setElevation(0);return this.fire(new a.l("terrain",{terrain:x})),this}getTerrain(){var x,i;return(i=(x=this.terrain)===null||x===void 0?void 0:x.options)!==null&&i!==void 0?i:null}areTilesLoaded(){const x=this.style&&this.style.sourceCaches;for(const i in x){const d=x[i]._tiles;for(const p in d){const _=d[p];if(_.state!=="loaded"&&_.state!=="errored")return!1}}return!0}removeSource(x){return this.style.removeSource(x),this._update(!0)}getSource(x){return this.style.getSource(x)}setSourceTileLodParams(x,i,d){if(d){const p=this.getSource(d);if(!p)throw new Error(`There is no source with ID "${d}", cannot set LOD parameters`);p.calculateTileZoom=Tt(Math.max(1,x),Math.max(1,i))}else for(const p in this.style.sourceCaches)this.style.sourceCaches[p].getSource().calculateTileZoom=Tt(Math.max(1,x),Math.max(1,i));return this._update(!0),this}refreshTiles(x,i){const d=this.style.sourceCaches[x];if(!d)throw new Error(`There is no source cache with ID "${x}", cannot refresh tile`);i===void 0?d.reload(!0):d.refreshTiles(i.map(p=>new a.a4(p.z,p.x,p.y)))}addImage(x,i,d={}){const{pixelRatio:p=1,sdf:_=!1,stretchX:w,stretchY:E,content:M,textFitWidth:D,textFitHeight:$}=d;if(this._lazyInitEmptyStyle(),!(i instanceof HTMLImageElement||a.b(i))){if(i.width===void 0||i.height===void 0)return this.fire(new a.k(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));{const{width:U,height:K,data:H}=i,ee=i;return this.style.addImage(x,{data:new a.R({width:U,height:K},new Uint8Array(H)),pixelRatio:p,stretchX:w,stretchY:E,content:M,textFitWidth:D,textFitHeight:$,sdf:_,version:0,userImage:ee}),ee.onAdd&&ee.onAdd(this,x),this}}{const{width:U,height:K,data:H}=P.getImageData(i);this.style.addImage(x,{data:new a.R({width:U,height:K},H),pixelRatio:p,stretchX:w,stretchY:E,content:M,textFitWidth:D,textFitHeight:$,sdf:_,version:0})}}updateImage(x,i){const d=this.style.getImage(x);if(!d)return this.fire(new a.k(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const p=i instanceof HTMLImageElement||a.b(i)?P.getImageData(i):i,{width:_,height:w,data:E}=p;if(_===void 0||w===void 0)return this.fire(new a.k(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));if(_!==d.data.width||w!==d.data.height)return this.fire(new a.k(new Error("The width and height of the updated image must be that same as the previous version of the image")));const M=!(i instanceof HTMLImageElement||a.b(i));return d.data.replace(E,M),this.style.updateImage(x,d),this}getImage(x){return this.style.getImage(x)}hasImage(x){return x?!!this.style.getImage(x):(this.fire(new a.k(new Error("Missing required image id"))),!1)}removeImage(x){this.style.removeImage(x)}loadImage(x){return W.getImage(this._requestManager.transformRequest(x,"Image"),new AbortController)}listImages(){return this.style.listImages()}addLayer(x,i){return this._lazyInitEmptyStyle(),this.style.addLayer(x,i),this._update(!0)}moveLayer(x,i){return this.style.moveLayer(x,i),this._update(!0)}removeLayer(x){return this.style.removeLayer(x),this._update(!0)}getLayer(x){return this.style.getLayer(x)}getLayersOrder(){return this.style.getLayersOrder()}setLayerZoomRange(x,i,d){return this.style.setLayerZoomRange(x,i,d),this._update(!0)}setFilter(x,i,d={}){return this.style.setFilter(x,i,d),this._update(!0)}getFilter(x){return this.style.getFilter(x)}setPaintProperty(x,i,d,p={}){return this.style.setPaintProperty(x,i,d,p),this._update(!0)}getPaintProperty(x,i){return this.style.getPaintProperty(x,i)}setLayoutProperty(x,i,d,p={}){return this.style.setLayoutProperty(x,i,d,p),this._update(!0)}getLayoutProperty(x,i){return this.style.getLayoutProperty(x,i)}setGlyphs(x,i={}){return this._lazyInitEmptyStyle(),this.style.setGlyphs(x,i),this._update(!0)}getGlyphs(){return this.style.getGlyphsUrl()}addSprite(x,i,d={}){return this._lazyInitEmptyStyle(),this.style.addSprite(x,i,d,p=>{p||this._update(!0)}),this}removeSprite(x){return this._lazyInitEmptyStyle(),this.style.removeSprite(x),this._update(!0)}getSprite(){return this.style.getSprite()}setSprite(x,i={}){return this._lazyInitEmptyStyle(),this.style.setSprite(x,i,d=>{d||this._update(!0)}),this}setLight(x,i={}){return this._lazyInitEmptyStyle(),this.style.setLight(x,i),this._update(!0)}getLight(){return this.style.getLight()}setSky(x,i={}){return this._lazyInitEmptyStyle(),this.style.setSky(x,i),this._update(!0)}getSky(){return this.style.getSky()}setFeatureState(x,i){return this.style.setFeatureState(x,i),this._update()}removeFeatureState(x,i){return this.style.removeFeatureState(x,i),this._update()}getFeatureState(x){return this.style.getFeatureState(x)}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}_containerDimensions(){let x=0,i=0;return this._container&&(x=this._container.clientWidth||400,i=this._container.clientHeight||300),[x,i]}_setupContainer(){const x=this._container;x.classList.add("maplibregl-map");const i=this._canvasContainer=A.create("div","maplibregl-canvas-container",x);this._interactive&&i.classList.add("maplibregl-interactive"),this._canvas=A.create("canvas","maplibregl-canvas",i),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex",this._interactive?"0":"-1"),this._canvas.setAttribute("aria-label",this._getUIString("Map.Title")),this._canvas.setAttribute("role","region");const d=this._containerDimensions(),p=this._getClampedPixelRatio(d[0],d[1]);this._resizeCanvas(d[0],d[1],p);const _=this._controlContainer=A.create("div","maplibregl-control-container",x),w=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(E=>{w[E]=A.create("div",`maplibregl-ctrl-${E} `,_)}),this._container.addEventListener("scroll",this._onMapScroll,!1)}_resizeCanvas(x,i,d){this._canvas.width=Math.floor(d*x),this._canvas.height=Math.floor(d*i),this._canvas.style.width=`${x}px`,this._canvas.style.height=`${i}px`}_setupPainter(){const x=Object.assign(Object.assign({},this._canvasContextAttributes),{alpha:!0,depth:!0,stencil:!0,premultipliedAlpha:!0});let i=null;this._canvas.addEventListener("webglcontextcreationerror",p=>{i={requestedAttributes:x},p&&(i.statusMessage=p.statusMessage,i.type=p.type)},{once:!0});let d=null;if(d=this._canvasContextAttributes.contextType?this._canvas.getContext(this._canvasContextAttributes.contextType,x):this._canvas.getContext("webgl2",x)||this._canvas.getContext("webgl",x),!d){const p="Failed to initialize WebGL";throw i?(i.message=p,new Error(JSON.stringify(i))):new Error(p)}this.painter=new R_(d,this.transform),O.testSupport(d)}migrateProjection(x,i){super.migrateProjection(x,i),this.painter.transform=x,this.fire(new a.l("projectiontransition",{newProjection:this.style.projection.name}))}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}_update(x){return this.style&&this.style._loaded?(this._styleDirty=this._styleDirty||x,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(x){return this._update(),this._renderTaskQueue.add(x)}_cancelRenderFrame(x){this._renderTaskQueue.remove(x)}_render(x){var i,d,p,_,w;const E=this._idleTriggered?this._fadeDuration:0,M=((i=this.style.projection)===null||i===void 0?void 0:i.transitionState)>0;if(this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run(x),this._removed)return;let D=!1;if(this.style&&this._styleDirty){this._styleDirty=!1;const K=this.transform.zoom,H=P.now();this.style.zoomHistory.update(K,H);const ee=new a.F(K,{now:H,fadeDuration:E,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition()}),ae=ee.crossFadingFactor();ae===1&&ae===this._crossFadingFactor||(D=!0,this._crossFadingFactor=ae),this.style.update(ee)}const $=((d=this.style.projection)===null||d===void 0?void 0:d.transitionState)>0!==M;(p=this.style.projection)===null||p===void 0||p.setErrorQueryLatitudeDegrees(this.transform.center.lat),this.transform.setTransitionState((_=this.style.projection)===null||_===void 0?void 0:_.transitionState,(w=this.style.projection)===null||w===void 0?void 0:w.latitudeErrorCorrectionRadians),this.style&&(this._sourcesDirty||$)&&(this._sourcesDirty=!1,this.style._updateSources(this.transform)),this.terrain?(this.terrain.sourceCache.update(this.transform,this.terrain),this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),!this._elevationFreeze&&this._centerClampedToGround&&this.transform.setElevation(this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom))):(this.transform.setMinElevationForCurrentTile(0),this._centerClampedToGround&&this.transform.setElevation(0)),this._placementDirty=this.style&&this.style._updatePlacement(this.transform,this.showCollisionBoxes,E,this._crossSourceCollisions,$),this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showOverdrawInspector:this._showOverdrawInspector,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:E,showPadding:this.showPadding}),this.fire(new a.l("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,a.cw.mark(a.cx.load),this.fire(new a.l("load"))),this.style&&(this.style.hasTransitions()||D)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles();const U=this._sourcesDirty||this._styleDirty||this._placementDirty;return U||this._repaint?this.triggerRepaint():!this.isMoving()&&this.loaded()&&this.fire(new a.l("idle")),!this._loaded||this._fullyLoaded||U||(this._fullyLoaded=!0,a.cw.mark(a.cx.fullLoad)),this}redraw(){return this.style&&(this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._render(0)),this}remove(){var x;this._hash&&this._hash.remove();for(const d of this._controls)d.onRemove(this);this._controls=[],this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._renderTaskQueue.clear(),this.painter.destroy(),this.handlers.destroy(),delete this.handlers,this.setStyle(null),typeof window<"u"&&removeEventListener("online",this._onWindowOnline,!1),W.removeThrottleControl(this._imageQueueHandle),(x=this._resizeObserver)===null||x===void 0||x.disconnect();const i=this.painter.context.gl.getExtension("WEBGL_lose_context");i!=null&&i.loseContext&&i.loseContext(),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),A.remove(this._canvasContainer),A.remove(this._controlContainer),this._container.removeEventListener("scroll",this._onMapScroll,!1),this._container.classList.remove("maplibregl-map"),a.cw.clearMetrics(),this._removed=!0,this.fire(new a.l("remove"))}triggerRepaint(){this.style&&!this._frameRequest&&(this._frameRequest=new AbortController,P.frame(this._frameRequest,x=>{a.cw.frame(x),this._frameRequest=null;try{this._render(x)}catch(i){if(!a.cy(i)&&!function(d){return d.message===Xm}(i))throw i}},()=>{}))}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(x){this._showTileBoundaries!==x&&(this._showTileBoundaries=x,this._update())}get showPadding(){return!!this._showPadding}set showPadding(x){this._showPadding!==x&&(this._showPadding=x,this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(x){this._showCollisionBoxes!==x&&(this._showCollisionBoxes=x,x?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(x){this._showOverdrawInspector!==x&&(this._showOverdrawInspector=x,this._update())}get repaint(){return!!this._repaint}set repaint(x){this._repaint!==x&&(this._repaint=x,this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(x){this._vertices=x,this._update()}get version(){return ow}getCameraTargetElevation(){return this.transform.elevation}getProjection(){return this.style.getProjection()}setProjection(x){return this._lazyInitEmptyStyle(),this.style.setProjection(x),this._update(!0)}},l.MapMouseEvent=is,l.MapTouchEvent=za,l.MapWheelEvent=sg,l.Marker=xh,l.NavigationControl=class{constructor(x){this._updateZoomButtons=()=>{const i=this._map.getZoom(),d=i===this._map.getMaxZoom(),p=i===this._map.getMinZoom();this._zoomInButton.disabled=d,this._zoomOutButton.disabled=p,this._zoomInButton.setAttribute("aria-disabled",d.toString()),this._zoomOutButton.setAttribute("aria-disabled",p.toString())},this._rotateCompassArrow=()=>{this._compassIcon.style.transform=this.options.visualizePitch&&this.options.visualizeRoll?`scale(${1/Math.pow(Math.cos(this._map.transform.pitchInRadians),.5)}) rotateZ(${-this._map.transform.roll}deg) rotateX(${this._map.transform.pitch}deg) rotateZ(${-this._map.transform.bearing}deg)`:this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(this._map.transform.pitchInRadians),.5)}) rotateX(${this._map.transform.pitch}deg) rotateZ(${-this._map.transform.bearing}deg)`:this.options.visualizeRoll?`rotate(${-this._map.transform.bearing-this._map.transform.roll}deg)`:`rotate(${-this._map.transform.bearing}deg)`},this._setButtonTitle=(i,d)=>{const p=this._map._getUIString(`NavigationControl.${d}`);i.title=p,i.setAttribute("aria-label",p)},this.options=a.e({},nn,x),this._container=A.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._container.addEventListener("contextmenu",i=>i.preventDefault()),this.options.showZoom&&(this._zoomInButton=this._createButton("maplibregl-ctrl-zoom-in",i=>this._map.zoomIn({},{originalEvent:i})),A.create("span","maplibregl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("maplibregl-ctrl-zoom-out",i=>this._map.zoomOut({},{originalEvent:i})),A.create("span","maplibregl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(this._compass=this._createButton("maplibregl-ctrl-compass",i=>{this.options.visualizePitch?this._map.resetNorthPitch({},{originalEvent:i}):this._map.resetNorth({},{originalEvent:i})}),this._compassIcon=A.create("span","maplibregl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}onAdd(x){return this._map=x,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),this._map.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&this._map.on("pitch",this._rotateCompassArrow),this.options.visualizeRoll&&this._map.on("roll",this._rotateCompassArrow),this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new yn(this._map,this._compass,this.options.visualizePitch)),this._container}onRemove(){A.remove(this._container),this.options.showZoom&&this._map.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&this._map.off("pitch",this._rotateCompassArrow),this.options.visualizeRoll&&this._map.off("roll",this._rotateCompassArrow),this._map.off("rotate",this._rotateCompassArrow),this._handler.off(),delete this._handler),delete this._map}_createButton(x,i){const d=A.create("button",x,this._container);return d.type="button",d.addEventListener("click",i),d}},l.Popup=class extends a.E{constructor(x){super(),this._updateOpacity=()=>{this.options.locationOccludedOpacity!==void 0&&(this._container.style.opacity=this._map.transform.isLocationOccluded(this.getLngLat())?`${this.options.locationOccludedOpacity}`:"")},this.remove=()=>(this._content&&A.remove(this._content),this._container&&(A.remove(this._container),delete this._container),this._map&&(this._map.off("move",this._update),this._map.off("move",this._onClose),this._map.off("click",this._onClose),this._map.off("remove",this.remove),this._map.off("mousemove",this._onMouseMove),this._map.off("mouseup",this._onMouseUp),this._map.off("drag",this._onDrag),this._map._canvasContainer.classList.remove("maplibregl-track-pointer"),delete this._map,this.fire(new a.l("close"))),this),this._onMouseUp=i=>{this._update(i.point)},this._onMouseMove=i=>{this._update(i.point)},this._onDrag=i=>{this._update(i.point)},this._update=i=>{if(!this._map||!this._lngLat&&!this._trackPointer||!this._content)return;if(!this._container){if(this._container=A.create("div","maplibregl-popup",this._map.getContainer()),this._tip=A.create("div","maplibregl-popup-tip",this._container),this._container.appendChild(this._content),this.options.className)for(const E of this.options.className.split(" "))this._container.classList.add(E);this._closeButton&&this._closeButton.setAttribute("aria-label",this._map._getUIString("Popup.Close")),this._trackPointer&&this._container.classList.add("maplibregl-popup-track-pointer")}if(this.options.maxWidth&&this._container.style.maxWidth!==this.options.maxWidth&&(this._container.style.maxWidth=this.options.maxWidth),this._lngLat=zc(this._lngLat,this._flatPos,this._map.transform,this._trackPointer),this._trackPointer&&!i)return;const d=this._flatPos=this._pos=this._trackPointer&&i?i:this._map.project(this._lngLat);this._map.terrain&&(this._flatPos=this._trackPointer&&i?i:this._map.transform.locationToScreenPoint(this._lngLat));let p=this.options.anchor;const _=Sf(this.options.offset);if(!p){const E=this._container.offsetWidth,M=this._container.offsetHeight;let D;D=d.y+_.bottom.y<M?["top"]:d.y>this._map.transform.height-M?["bottom"]:[],d.x<E/2?D.push("left"):d.x>this._map.transform.width-E/2&&D.push("right"),p=D.length===0?"bottom":D.join("-")}let w=d.add(_[p]);this.options.subpixelPositioning||(w=w.round()),A.setTransform(this._container,`${Nc[p]} translate(${w.x}px,${w.y}px)`),bf(this._container,p,"popup"),this._updateOpacity()},this._onClose=()=>{this.remove()},this.options=a.e(Object.create(fg),x)}addTo(x){return this._map&&this.remove(),this._map=x,this.options.closeOnClick&&this._map.on("click",this._onClose),this.options.closeOnMove&&this._map.on("move",this._onClose),this._map.on("remove",this.remove),this._update(),this._focusFirstElement(),this._trackPointer?(this._map.on("mousemove",this._onMouseMove),this._map.on("mouseup",this._onMouseUp),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")):this._map.on("move",this._update),this.fire(new a.l("open")),this}isOpen(){return!!this._map}getLngLat(){return this._lngLat}setLngLat(x){return this._lngLat=a.S.convert(x),this._pos=null,this._flatPos=null,this._trackPointer=!1,this._update(),this._map&&(this._map.on("move",this._update),this._map.off("mousemove",this._onMouseMove),this._container&&this._container.classList.remove("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.remove("maplibregl-track-pointer")),this}trackPointer(){return this._trackPointer=!0,this._pos=null,this._flatPos=null,this._update(),this._map&&(this._map.off("move",this._update),this._map.on("mousemove",this._onMouseMove),this._map.on("drag",this._onDrag),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")),this}getElement(){return this._container}setText(x){return this.setDOMContent(document.createTextNode(x))}setHTML(x){const i=document.createDocumentFragment(),d=document.createElement("body");let p;for(d.innerHTML=x;p=d.firstChild,p;)i.appendChild(p);return this.setDOMContent(i)}getMaxWidth(){var x;return(x=this._container)===null||x===void 0?void 0:x.style.maxWidth}setMaxWidth(x){return this.options.maxWidth=x,this._update(),this}setDOMContent(x){if(this._content)for(;this._content.hasChildNodes();)this._content.firstChild&&this._content.removeChild(this._content.firstChild);else this._content=A.create("div","maplibregl-popup-content",this._container);return this._content.appendChild(x),this._createCloseButton(),this._update(),this._focusFirstElement(),this}addClassName(x){return this._container&&this._container.classList.add(x),this}removeClassName(x){return this._container&&this._container.classList.remove(x),this}setOffset(x){return this.options.offset=x,this._update(),this}toggleClassName(x){if(this._container)return this._container.classList.toggle(x)}setSubpixelPositioning(x){this.options.subpixelPositioning=x}_createCloseButton(){this.options.closeButton&&(this._closeButton=A.create("button","maplibregl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClose))}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const x=this._container.querySelector(pg);x&&x.focus()}},l.RasterDEMTileSource=Zr,l.RasterTileSource=Nr,l.ScaleControl=class{constructor(x){this._onMove=()=>{wf(this._map,this._container,this.options)},this.setUnit=i=>{this.options.unit=i,wf(this._map,this._container,this.options)},this.options=Object.assign(Object.assign({},dg),x)}getDefaultPosition(){return"bottom-left"}onAdd(x){return this._map=x,this._container=A.create("div","maplibregl-ctrl maplibregl-ctrl-scale",x.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container}onRemove(){A.remove(this._container),this._map.off("move",this._onMove),this._map=void 0}},l.ScrollZoomHandler=q_,l.Style=Om,l.TerrainControl=class{constructor(x){this._toggleTerrain=()=>{this._map.getTerrain()?this._map.setTerrain(null):this._map.setTerrain(this.options),this._updateTerrainIcon()},this._updateTerrainIcon=()=>{this._terrainButton.classList.remove("maplibregl-ctrl-terrain"),this._terrainButton.classList.remove("maplibregl-ctrl-terrain-enabled"),this._map.terrain?(this._terrainButton.classList.add("maplibregl-ctrl-terrain-enabled"),this._terrainButton.title=this._map._getUIString("TerrainControl.Disable")):(this._terrainButton.classList.add("maplibregl-ctrl-terrain"),this._terrainButton.title=this._map._getUIString("TerrainControl.Enable"))},this.options=x}onAdd(x){return this._map=x,this._container=A.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._terrainButton=A.create("button","maplibregl-ctrl-terrain",this._container),A.create("span","maplibregl-ctrl-icon",this._terrainButton).setAttribute("aria-hidden","true"),this._terrainButton.type="button",this._terrainButton.addEventListener("click",this._toggleTerrain),this._updateTerrainIcon(),this._map.on("terrain",this._updateTerrainIcon),this._container}onRemove(){A.remove(this._container),this._map.off("terrain",this._updateTerrainIcon),this._map=void 0}},l.TwoFingersTouchPitchHandler=$_,l.TwoFingersTouchRotateHandler=gf,l.TwoFingersTouchZoomHandler=mf,l.TwoFingersTouchZoomRotateHandler=_f,l.VectorTileSource=Ft,l.VideoSource=Gn,l.addSourceType=(x,i)=>a._(void 0,void 0,void 0,function*(){if(rn(x))throw new Error(`A source type called "${x}" already exists.`);((d,p)=>{xi[d]=p})(x,i)}),l.clearPrewarmedResources=function(){const x=st;x&&(x.isPreloaded()&&x.numActive()===1?(x.release(Re),st=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},l.createTileMesh=Qu,l.getMaxParallelImageRequests=function(){return a.a.MAX_PARALLEL_IMAGE_REQUESTS},l.getRTLTextPluginStatus=function(){return Sn().getRTLTextPluginStatus()},l.getVersion=function(){return mg},l.getWorkerCount=function(){return $e.workerCount},l.getWorkerUrl=function(){return a.a.WORKER_URL},l.importScriptInWorkers=function(x){return Pt().broadcast("IS",x)},l.prewarm=function(){_t().acquire(Re)},l.setMaxParallelImageRequests=function(x){a.a.MAX_PARALLEL_IMAGE_REQUESTS=x},l.setRTLTextPlugin=function(x,i){return Sn().setRTLTextPlugin(x,i)},l.setWorkerCount=function(x){$e.workerCount=x},l.setWorkerUrl=function(x){a.a.WORKER_URL=x}});var c=r;return c})})(HB);var yA=HB.exports;const ly=JE(yA),doe=N3({__proto__:null,default:ly},[yA]);var foe=Object.defineProperty,KB=t=>{throw TypeError(t)},poe=(t,e,r)=>e in t?foe(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,Lt=(t,e,r)=>poe(t,typeof e!="symbol"?e+"":e,r),XB=(t,e,r)=>e.has(t)||KB("Cannot "+r),Yn=(t,e,r)=>(XB(t,e,"read from private field"),e.get(t)),mS=(t,e,r)=>e.has(t)?KB("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(t):e.set(t,r),Yv=(t,e,r,n)=>(XB(t,e,"write to private field"),e.set(t,r),r);function mn(){}function moe(t,e){for(const r in e)t[r]=e[r];return t}function YB(t){return t()}function IL(){return Object.create(null)}function fc(t){t.forEach(YB)}function QB(t){return typeof t=="function"}function Vu(t,e){return t!=t?e==e:t!==e||t&&typeof t=="object"||typeof t=="function"}let Qv;function gs(t,e){return t===e?!0:(Qv||(Qv=document.createElement("a")),Qv.href=e,t===Qv.href)}function goe(t){return Object.keys(t).length===0}function yoe(t,e,r,n){if(t){const s=JB(t,e,r,n);return t[0](s)}}function JB(t,e,r,n){return t[1]&&n?moe(r.ctx.slice(),t[1](n(e))):r.ctx}function _oe(t,e,r,n){return t[2],e.dirty}function voe(t,e,r,n,s,c){if(s){const l=JB(e,r,n,c);t.p(l,s)}}function xoe(t){if(t.ctx.length>32){const e=[],r=t.ctx.length/32;for(let n=0;n<r;n++)e[n]=-1;return e}return-1}function kb(t){return t??""}function Pr(t,e){t.appendChild(e)}function cn(t,e,r){t.insertBefore(e,r||null)}function Jr(t){t.parentNode&&t.parentNode.removeChild(t)}function Gr(t){return document.createElement(t)}function Ca(t){return document.createElementNS("http://www.w3.org/2000/svg",t)}function Lu(t){return document.createTextNode(t)}function vo(){return Lu(" ")}function boe(){return Lu("")}function ki(t,e,r,n){return t.addEventListener(e,r,n),()=>t.removeEventListener(e,r,n)}function woe(t){return function(e){return e.preventDefault(),t.call(this,e)}}function Je(t,e,r){r==null?t.removeAttribute(e):t.getAttribute(e)!==r&&t.setAttribute(e,r)}function Soe(t){return Array.from(t.childNodes)}function E0(t,e){e=""+e,t.data!==e&&(t.data=e)}function RL(t,e){t.value=e??""}function cl(t,e,r){t.classList.toggle(e,!!r)}function Toe(t,e,{bubbles:r=!1,cancelable:n=!1}={}){return new CustomEvent(t,{detail:e,bubbles:r,cancelable:n})}let C0;function jy(t){C0=t}function e6(){if(!C0)throw new Error("Function called outside component initialization");return C0}function Eoe(t){e6().$$.on_destroy.push(t)}function t6(){const t=e6();return(e,r,{cancelable:n=!1}={})=>{const s=t.$$.callbacks[e];if(s){const c=Toe(e,r,{cancelable:n});return s.slice().forEach(l=>{l.call(t,c)}),!c.defaultPrevented}return!0}}function Coe(t,e){const r=t.$$.callbacks[e.type];r&&r.slice().forEach(n=>n.call(this,e))}const rp=[],zE=[];let jp=[];const DL=[],Poe=Promise.resolve();let NE=!1;function Aoe(){NE||(NE=!0,Poe.then(r6))}function jE(t){jp.push(t)}const gS=new Set;let Jf=0;function r6(){if(Jf!==0)return;const t=C0;do{try{for(;Jf<rp.length;){const e=rp[Jf];Jf++,jy(e),koe(e.$$)}}catch(e){throw rp.length=0,Jf=0,e}for(jy(null),rp.length=0,Jf=0;zE.length;)zE.pop()();for(let e=0;e<jp.length;e+=1){const r=jp[e];gS.has(r)||(gS.add(r),r())}jp.length=0}while(rp.length);for(;DL.length;)DL.pop()();NE=!1,gS.clear(),jy(t)}function koe(t){if(t.fragment!==null){t.update(),fc(t.before_update);const e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(jE)}}function Moe(t){const e=[],r=[];jp.forEach(n=>t.indexOf(n)===-1?e.push(n):r.push(n)),r.forEach(n=>n()),jp=e}const kx=new Set;let td;function cy(){td={r:0,c:[],p:td}}function uy(){td.r||fc(td.c),td=td.p}function vn(t,e){t&&t.i&&(kx.delete(t),t.i(e))}function pi(t,e,r,n){if(t&&t.o){if(kx.has(t))return;kx.add(t),td.c.push(()=>{kx.delete(t),n&&(r&&t.d(1),n())}),t.o(e)}else n&&n()}function LL(t){return(t==null?void 0:t.length)!==void 0?t:Array.from(t)}function Ioe(t,e){pi(t,1,1,()=>{e.delete(t.key)})}function Roe(t,e,r,n,s,c,l,a,m,y,v,T){let P=t.length,A=c.length,O=P;const I={};for(;O--;)I[t[O].key]=O;const L=[],R=new Map,z=new Map,j=[];for(O=A;O--;){const ie=T(s,c,O),V=r(ie);let q=l.get(V);q?j.push(()=>q.p(ie,e)):(q=y(V,ie),q.c()),R.set(V,L[O]=q),V in I&&z.set(V,Math.abs(O-I[V]))}const W=new Set,Z=new Set;function te(ie){vn(ie,1),ie.m(a,v),l.set(ie.key,ie),v=ie.first,A--}for(;P&&A;){const ie=L[A-1],V=t[P-1],q=ie.key,Q=V.key;ie===V?(v=ie.first,P--,A--):R.has(Q)?!l.has(q)||W.has(q)?te(ie):Z.has(Q)?P--:z.get(q)>z.get(Q)?(Z.add(q),te(ie)):(W.add(Q),P--):(m(V,l),P--)}for(;P--;){const ie=t[P];R.has(ie.key)||m(ie,l)}for(;A;)te(L[A-1]);return fc(j),L}function Ou(t){t&&t.c()}function cc(t,e,r){const{fragment:n,after_update:s}=t.$$;n&&n.m(e,r),jE(()=>{const c=t.$$.on_mount.map(YB).filter(QB);t.$$.on_destroy?t.$$.on_destroy.push(...c):fc(c),t.$$.on_mount=[]}),s.forEach(jE)}function uc(t,e){const r=t.$$;r.fragment!==null&&(Moe(r.after_update),fc(r.on_destroy),r.fragment&&r.fragment.d(e),r.on_destroy=r.fragment=null,r.ctx=[])}function Doe(t,e){t.$$.dirty[0]===-1&&(rp.push(t),Aoe(),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}function Uu(t,e,r,n,s,c,l=null,a=[-1]){const m=C0;jy(t);const y=t.$$={fragment:null,ctx:[],props:c,update:mn,not_equal:s,bound:IL(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(e.context||(m?m.$$.context:[])),callbacks:IL(),dirty:a,skip_bound:!1,root:e.target||m.$$.root};l&&l(y.root);let v=!1;if(y.ctx=r?r(t,e.props||{},(T,P,...A)=>{const O=A.length?A[0]:P;return y.ctx&&s(y.ctx[T],y.ctx[T]=O)&&(!y.skip_bound&&y.bound[T]&&y.bound[T](O),v&&Doe(t,T)),P}):[],y.update(),v=!0,fc(y.before_update),y.fragment=n?n(y.ctx):!1,e.target){if(e.hydrate){const T=Soe(e.target);y.fragment&&y.fragment.l(T),T.forEach(Jr)}else y.fragment&&y.fragment.c();e.intro&&vn(t.$$.fragment),cc(t,e.target,e.anchor),r6()}jy(m)}class Gu{constructor(){Lt(this,"$$"),Lt(this,"$$set")}$destroy(){uc(this,1),this.$destroy=mn}$on(e,r){if(!QB(r))return mn;const n=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return n.push(r),()=>{const s=n.indexOf(r);s!==-1&&n.splice(s,1)}}$set(e){this.$$set&&!goe(e)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}}const Loe="4";typeof window<"u"&&(window.__svelte||(window.__svelte={v:new Set})).v.add(Loe);function Ooe(t){let e,r;return{c(){e=Ca("svg"),r=Ca("path"),Je(r,"d","M13.12.706a.982.982 0 0 0-1.391 0L6.907 5.517 2.087.696a.982.982 0 1 0-1.391 1.39l4.821 4.821L.696 11.73a.982.982 0 1 0 1.39 1.39l4.821-4.821 4.822 4.821a.982.982 0 1 0 1.39-1.39L8.298 6.908l4.821-4.822a.988.988 0 0 0 0-1.38Z"),Je(e,"viewBox","0 0 14 14"),Je(e,"width","13"),Je(e,"height","13"),Je(e,"class","svelte-en2qvf")},m(n,s){cn(n,e,s),Pr(e,r)},p:mn,i:mn,o:mn,d(n){n&&Jr(e)}}}class n6 extends Gu{constructor(e){super(),Uu(this,e,null,Ooe,Vu,{})}}function zoe(t){let e,r;return{c(){e=Ca("svg"),r=Ca("path"),Je(r,"d","M15 0C6.705 0 0 6.705 0 15C0 23.295 6.705 30 15 30C23.295 30 30 23.295 30 15C30 6.705 23.295 0 15 0ZM22.5 20.385L20.385 22.5L15 17.115L9.615 22.5L7.5 20.385L12.885 15L7.5 9.615L9.615 7.5L15 12.885L20.385 7.5L22.5 9.615L17.115 15L22.5 20.385Z"),Je(e,"viewBox","0 0 30 30"),Je(e,"fill","none"),Je(e,"xmlns","http://www.w3.org/2000/svg"),Je(e,"class","svelte-d2loi5")},m(n,s){cn(n,e,s),Pr(e,r)},p:mn,i:mn,o:mn,d(n){n&&Jr(e)}}}class i6 extends Gu{constructor(e){super(),Uu(this,e,null,zoe,Vu,{})}}function Noe(t){let e,r;return{c(){e=Gr("img"),gs(e.src,r=t[3]+"area.svg")||Je(e,"src",r),Je(e,"alt",t[7]),Je(e,"title",t[7]),Je(e,"class","svelte-w9y5n9")},m(n,s){cn(n,e,s)},p(n,s){s&8&&!gs(e.src,r=n[3]+"area.svg")&&Je(e,"src",r),s&128&&Je(e,"alt",n[7]),s&128&&Je(e,"title",n[7])},d(n){n&&Jr(e)}}}function joe(t){let e,r;return{c(){e=Gr("img"),gs(e.src,r=t[3]+"reverse.svg")||Je(e,"src",r),Je(e,"alt",t[7]),Je(e,"title",t[7]),Je(e,"class","svelte-w9y5n9")},m(n,s){cn(n,e,s)},p(n,s){s&8&&!gs(e.src,r=n[3]+"reverse.svg")&&Je(e,"src",r),s&128&&Je(e,"alt",n[7]),s&128&&Je(e,"title",n[7])},d(n){n&&Jr(e)}}}function Foe(t){let e,r;return{c(){e=Gr("img"),gs(e.src,r=t[3]+"poi.svg")||Je(e,"src",r),Je(e,"alt",t[7]),Je(e,"title",t[7]),Je(e,"class","svelte-w9y5n9")},m(n,s){cn(n,e,s)},p(n,s){s&8&&!gs(e.src,r=n[3]+"poi.svg")&&Je(e,"src",r),s&128&&Je(e,"alt",n[7]),s&128&&Je(e,"title",n[7])},d(n){n&&Jr(e)}}}function Boe(t){let e,r;return{c(){e=Gr("img"),gs(e.src,r=t[3]+"postal_code.svg")||Je(e,"src",r),Je(e,"alt",t[7]),Je(e,"title",t[7]),Je(e,"class","svelte-w9y5n9")},m(n,s){cn(n,e,s)},p(n,s){s&8&&!gs(e.src,r=n[3]+"postal_code.svg")&&Je(e,"src",r),s&128&&Je(e,"alt",n[7]),s&128&&Je(e,"title",n[7])},d(n){n&&Jr(e)}}}function $oe(t){let e,r;return{c(){e=Gr("img"),gs(e.src,r=t[3]+"street.svg")||Je(e,"src",r),Je(e,"alt",t[7]),Je(e,"title",t[7]),Je(e,"class","svelte-w9y5n9")},m(n,s){cn(n,e,s)},p(n,s){s&8&&!gs(e.src,r=n[3]+"street.svg")&&Je(e,"src",r),s&128&&Je(e,"alt",n[7]),s&128&&Je(e,"title",n[7])},d(n){n&&Jr(e)}}}function Voe(t){let e,r;return{c(){e=Gr("img"),gs(e.src,r=t[3]+"road.svg")||Je(e,"src",r),Je(e,"alt",t[7]),Je(e,"title",t[7]),Je(e,"class","svelte-w9y5n9")},m(n,s){cn(n,e,s)},p(n,s){s&8&&!gs(e.src,r=n[3]+"road.svg")&&Je(e,"src",r),s&128&&Je(e,"alt",n[7]),s&128&&Je(e,"title",n[7])},d(n){n&&Jr(e)}}}function Uoe(t){let e,r;return{c(){e=Gr("img"),gs(e.src,r=t[3]+"housenumber.svg")||Je(e,"src",r),Je(e,"alt",t[7]),Je(e,"title",t[7]),Je(e,"class","svelte-w9y5n9")},m(n,s){cn(n,e,s)},p(n,s){s&8&&!gs(e.src,r=n[3]+"housenumber.svg")&&Je(e,"src",r),s&128&&Je(e,"alt",n[7]),s&128&&Je(e,"title",n[7])},d(n){n&&Jr(e)}}}function Goe(t){let e,r,n,s;return{c(){e=Gr("img"),gs(e.src,r=t[5])||Je(e,"src",r),Je(e,"alt",t[4]),Je(e,"title",t[7]),Je(e,"class","svelte-w9y5n9")},m(c,l){cn(c,e,l),n||(s=ki(e,"error",t[14]),n=!0)},p(c,l){l&32&&!gs(e.src,r=c[5])&&Je(e,"src",r),l&16&&Je(e,"alt",c[4]),l&128&&Je(e,"title",c[7])},d(c){c&&Jr(e),n=!1,s()}}}function Woe(t){let e,r;return{c(){e=Gr("div"),Je(e,"class","sprite-icon svelte-w9y5n9"),Je(e,"style",r=`
        width: ${t[6].width/jo}px;
        height: ${t[6].height/jo}px;
        background-image: url(${t[3]}sprite${FE}.png);
        background-position: -${t[6].x/jo}px -${t[6].y/jo}px;
        background-size: ${ol.width/jo}px ${ol.height/jo}px;
      `),Je(e,"title",t[7])},m(n,s){cn(n,e,s)},p(n,s){s&72&&r!==(r=`
        width: ${n[6].width/jo}px;
        height: ${n[6].height/jo}px;
        background-image: url(${n[3]}sprite${FE}.png);
        background-position: -${n[6].x/jo}px -${n[6].y/jo}px;
        background-size: ${ol.width/jo}px ${ol.height/jo}px;
      `)&&Je(e,"style",r),s&128&&Je(e,"title",n[7])},d(n){n&&Jr(e)}}}function OL(t){let e,r;return{c(){e=Gr("span"),r=Lu(t[7]),Je(e,"class","secondary svelte-w9y5n9")},m(n,s){cn(n,e,s),Pr(e,r)},p(n,s){s&128&&E0(r,n[7])},d(n){n&&Jr(e)}}}function qoe(t){let e,r,n,s,c,l,a,m,y,v=(t[8]?t[0].place_name:t[0].place_name.replace(/,.*/,""))+"",T,P,A=t[2]==="always"||t[2]!=="never"&&!t[0].address&&!t[0].id.startsWith("road.")&&!t[0].id.startsWith("address.")&&!t[0].id.startsWith("postal_code.")&&(!t[0].id.startsWith("poi.")||!t[5])&&!t[8],O,I,L=(t[8]?"":t[0].place_name.replace(/[^,]*,?\s*/,""))+"",R,z,j,W,Z,te;function ie(ce,se){return se&1&&(r=null),se&1&&(n=null),se&1&&(s=null),se&1&&(c=null),ol&&ce[6]?Woe:ce[5]?Goe:ce[0].address?Uoe:(r==null&&(r=!!ce[0].id.startsWith("road.")),r?Voe:(n==null&&(n=!!ce[0].id.startsWith("address.")),n?$oe:(s==null&&(s=!!ce[0].id.startsWith("postal_code.")),s?Boe:(c==null&&(c=!!ce[0].id.startsWith("poi.")),c?Foe:ce[8]?joe:Noe))))}let V=ie(t,-1),q=V(t),Q=A&&OL(t);return{c(){e=Gr("li"),q.c(),l=vo(),a=Gr("span"),m=Gr("span"),y=Gr("span"),T=Lu(v),P=vo(),Q&&Q.c(),O=vo(),I=Gr("span"),R=Lu(L),Je(y,"class","primary svelte-w9y5n9"),Je(m,"class","svelte-w9y5n9"),Je(I,"class","line2 svelte-w9y5n9"),Je(a,"class","texts svelte-w9y5n9"),Je(e,"tabindex","-1"),Je(e,"role","option"),Je(e,"aria-selected",z=t[1]==="selected"),Je(e,"aria-checked",j=t[1]==="picked"),Je(e,"class",W=kb(t[1])+" svelte-w9y5n9")},m(ce,se){cn(ce,e,se),q.m(e,null),Pr(e,l),Pr(e,a),Pr(a,m),Pr(m,y),Pr(y,T),Pr(m,P),Q&&Q.m(m,null),Pr(a,O),Pr(a,I),Pr(I,R),Z||(te=[ki(e,"mouseenter",t[13]),ki(e,"focus",t[15]),ki(e,"click",t[16])],Z=!0)},p(ce,[se]){V===(V=ie(ce,se))&&q?q.p(ce,se):(q.d(1),q=V(ce),q&&(q.c(),q.m(e,l))),se&257&&v!==(v=(ce[8]?ce[0].place_name:ce[0].place_name.replace(/,.*/,""))+"")&&E0(T,v),se&293&&(A=ce[2]==="always"||ce[2]!=="never"&&!ce[0].address&&!ce[0].id.startsWith("road.")&&!ce[0].id.startsWith("address.")&&!ce[0].id.startsWith("postal_code.")&&(!ce[0].id.startsWith("poi.")||!ce[5])&&!ce[8]),A?Q?Q.p(ce,se):(Q=OL(ce),Q.c(),Q.m(m,null)):Q&&(Q.d(1),Q=null),se&257&&L!==(L=(ce[8]?"":ce[0].place_name.replace(/[^,]*,?\s*/,""))+"")&&E0(R,L),se&2&&z!==(z=ce[1]==="selected")&&Je(e,"aria-selected",z),se&2&&j!==(j=ce[1]==="picked")&&Je(e,"aria-checked",j),se&2&&W!==(W=kb(ce[1])+" svelte-w9y5n9")&&Je(e,"class",W)},i:mn,o:mn,d(ce){ce&&Jr(e),q.d(),Q&&Q.d(),Z=!1,fc(te)}}}const s6=typeof devicePixelRatio>"u"?1:devicePixelRatio>1.25,FE=s6?"@2x":"",jo=s6?2:1;let ol,Jv;function Hoe(t,e,r){let n,s,c,{feature:l}=e,{style:a="default"}=e,{showPlaceType:m}=e,{missingIconsCache:y}=e,{iconsBaseUrl:v}=e;const T=t6();let P,A,O,I;function L(){Jv??(Jv=fetch(`${v}sprite${FE}.json`).then(V=>V.json()).then(V=>{ol=V}).catch(()=>{ol=null}))}function R(){A&&y.add(A),z()}function z(){ol!==void 0?j():(L(),Jv==null||Jv.then(j))}function j(){do{if(I--,r(4,P=n==null?void 0:n[I]),r(6,O=P?ol==null?void 0:ol.icons[P]:void 0),O)break;r(5,A=P?v+P.replace(/ /g,"_")+".svg":void 0)}while(I>-1&&(!A||y.has(A)))}function W(V){Coe.call(this,t,V)}const Z=()=>R(),te=()=>T("select",void 0),ie=V=>{document.activeElement!==V.target&&T("select",void 0)};return t.$$set=V=>{"feature"in V&&r(0,l=V.feature),"style"in V&&r(1,a=V.style),"showPlaceType"in V&&r(2,m=V.showPlaceType),"missingIconsCache"in V&&r(11,y=V.missingIconsCache),"iconsBaseUrl"in V&&r(3,v=V.iconsBaseUrl)},t.$$.update=()=>{var V,q,Q,ce,se;t.$$.dirty&1&&r(12,n=(V=l.properties)==null?void 0:V.categories),t.$$.dirty&1&&r(8,s=l.place_type[0]==="reverse"),t.$$.dirty&1&&r(7,c=((Q=(q=l.properties)==null?void 0:q.categories)==null?void 0:Q.join(", "))??((se=(ce=l.properties)==null?void 0:ce.place_type_name)==null?void 0:se[0])??l.place_type[0]),t.$$.dirty&4096&&(I=(n==null?void 0:n.length)??0,z())},[l,a,m,v,P,A,O,c,s,T,R,y,n,W,Z,te,ie]}class Zoe extends Gu{constructor(e){super(),Uu(this,e,Hoe,qoe,Vu,{feature:0,style:1,showPlaceType:2,missingIconsCache:11,iconsBaseUrl:3})}}function Koe(t){let e;return{c(){e=Gr("div"),e.innerHTML='<svg viewBox="0 0 18 18" width="24" height="24" class="loading-icon svelte-1ocfouu"><path fill="#333" d="M4.4 4.4l.8.8c2.1-2.1 5.5-2.1 7.6 0l.8-.8c-2.5-2.5-6.7-2.5-9.2 0z"></path><path opacity=".1" d="M12.8 12.9c-2.1 2.1-5.5 2.1-7.6 0-2.1-2.1-2.1-5.5 0-7.7l-.8-.8c-2.5 2.5-2.5 6.7 0 9.2s6.6 2.5 9.2 0 2.5-6.6 0-9.2l-.8.8c2.2 2.1 2.2 5.6 0 7.7z"></path></svg>',Je(e,"class","svelte-1ocfouu")},m(r,n){cn(r,e,n)},p:mn,i:mn,o:mn,d(r){r&&Jr(e)}}}class Xoe extends Gu{constructor(e){super(),Uu(this,e,null,Koe,Vu,{})}}function Yoe(t){let e,r,n;return{c(){e=Ca("svg"),r=Ca("path"),Je(r,"stroke-width","4"),Je(r,"d","M 5,33.103579 C 5,17.607779 18.457,5 35,5 C 51.543,5 65,17.607779 65,33.103579 C 65,56.388679 40.4668,76.048179 36.6112,79.137779 C 36.3714,79.329879 36.2116,79.457979 36.1427,79.518879 C 35.8203,79.800879 35.4102,79.942779 35,79.942779 C 34.5899,79.942779 34.1797,79.800879 33.8575,79.518879 C 33.7886,79.457979 33.6289,79.330079 33.3893,79.138079 C 29.5346,76.049279 5,56.389379 5,33.103579 Z M 35.0001,49.386379 C 43.1917,49.386379 49.8323,42.646079 49.8323,34.331379 C 49.8323,26.016779 43.1917,19.276479 35.0001,19.276479 C 26.8085,19.276479 20.1679,26.016779 20.1679,34.331379 C 20.1679,42.646079 26.8085,49.386379 35.0001,49.386379 Z"),Je(r,"class","svelte-gzo3ar"),Je(e,"width",n=t[0]==="list"?20:void 0),Je(e,"viewBox","0 0 70 85"),Je(e,"fill","none"),Je(e,"class","svelte-gzo3ar"),cl(e,"in-map",t[0]!=="list"),cl(e,"list-icon",t[0]==="list")},m(s,c){cn(s,e,c),Pr(e,r)},p(s,[c]){c&1&&n!==(n=s[0]==="list"?20:void 0)&&Je(e,"width",n),c&1&&cl(e,"in-map",s[0]!=="list"),c&1&&cl(e,"list-icon",s[0]==="list")},i:mn,o:mn,d(s){s&&Jr(e)}}}function Qoe(t,e,r){let{displayIn:n}=e;return t.$$set=s=>{"displayIn"in s&&r(0,n=s.displayIn)},[n]}class Joe extends Gu{constructor(e){super(),Uu(this,e,Qoe,Yoe,Vu,{displayIn:0})}}function eae(t){let e,r;return{c(){e=Ca("svg"),r=Ca("path"),Je(r,"d","M30.003-26.765C13.46-26.765 0-14.158 0 1.337c0 23.286 24.535 42.952 28.39 46.04.24.192.402.316.471.376.323.282.732.424 1.142.424.41 0 .82-.142 1.142-.424.068-.06.231-.183.471-.376 3.856-3.09 28.39-22.754 28.39-46.04 0-15.495-13.46-28.102-30.003-28.102Zm1.757 12.469c4.38 0 7.858 1.052 10.431 3.158 2.595 2.105 3.89 4.913 3.89 8.422 0 2.34-.53 4.362-1.593 6.063-1.063 1.702-3.086 3.616-6.063 5.742-2.042 1.51-3.337 2.659-3.89 3.446-.532.787-.8 1.82-.8 3.096v1.914h-8.449V15.18c0-2.041.434-3.815 1.306-5.325.872-1.51 2.467-3.118 4.785-4.82 2.233-1.594 3.7-2.89 4.402-3.889a5.582 5.582 0 0 0 1.087-3.35c0-1.382-.51-2.435-1.531-3.158-1.02-.723-2.45-1.087-4.28-1.087-3.19 0-6.826 1.047-10.91 3.131l-3.472-6.986c4.742-2.659 9.77-3.992 15.087-3.992Zm-1.88 37.324c1.765 0 3.124.472 4.08 1.408.98.936 1.47 2.276 1.47 4.02 0 1.68-.49 3.007-1.47 3.985-.977.957-2.336 1.435-4.08 1.435-1.787 0-3.171-.465-4.15-1.4-.978-.958-1.47-2.298-1.47-4.02 0-1.787.48-3.14 1.436-4.054.957-.915 2.355-1.374 4.184-1.374Z"),Je(e,"viewBox","0 0 60.006 21.412"),Je(e,"width","14"),Je(e,"height","20"),Je(e,"class","svelte-en2qvf")},m(n,s){cn(n,e,s),Pr(e,r)},p:mn,i:mn,o:mn,d(n){n&&Jr(e)}}}class tae extends Gu{constructor(e){super(),Uu(this,e,null,eae,Vu,{})}}function rae(t){let e,r,n;return{c(){e=Ca("svg"),r=Ca("circle"),n=Ca("path"),Je(r,"cx","4.789"),Je(r,"cy","4.787"),Je(r,"r","3.85"),Je(r,"class","svelte-1aq105l"),Je(n,"d","M12.063 12.063 7.635 7.635"),Je(n,"class","svelte-1aq105l"),Je(e,"xmlns","http://www.w3.org/2000/svg"),Je(e,"width","13"),Je(e,"height","13"),Je(e,"viewBox","0 0 13 13"),Je(e,"class","svelte-1aq105l")},m(s,c){cn(s,e,c),Pr(e,r),Pr(e,n)},p:mn,i:mn,o:mn,d(s){s&&Jr(e)}}}class nae extends Gu{constructor(e){super(),Uu(this,e,null,rae,Vu,{})}}function iae(t,e,r){const n=e[1],s=e[0],c=n-s;return t===n&&r?t:((t-s)%c+c)%c+s}function Mb(t){const e=[...t];return e[2]<e[0]&&(Math.abs((e[0]+e[2]+360)/2)>Math.abs((e[0]-360+e[2])/2)?e[0]-=360:e[2]+=360),e}let Kg;async function sae(t,e,r){const n=t==null?void 0:t.getCenterAndZoom();for(const s of e??[])if(!(n&&(s.minZoom!=null&&s.minZoom>n[0]||s.maxZoom!=null&&s.maxZoom<n[0]))){if(s.type==="fixed")return s.coordinates.join(",");e:if(s.type==="client-geolocation"){if(Kg&&s.cachedLocationExpiry&&Kg.time+s.cachedLocationExpiry>Date.now()){if(!Kg.coords)break e;return Kg.coords}let c;try{return c=await new Promise((l,a)=>{r.signal.addEventListener("abort",()=>{a(Error("aborted"))}),navigator.geolocation.getCurrentPosition(m=>{l([m.coords.longitude,m.coords.latitude].map(y=>y.toFixed(6)).join(","))},m=>{a(m)},s)}),c}catch{}finally{s.cachedLocationExpiry&&(Kg={time:Date.now(),coords:c})}if(r.signal.aborted)return}if(s.type==="server-geolocation")return"ip";if(n&&s.type==="map-center")return n[1].toFixed(6)+","+n[2].toFixed(6)}}const oae=/^(NORTH|SOUTH|[NS])?\s*([+-]?[0-8]?[0-9])\s*([\.:]|D(?:EG)?(?:REES)?)?\s*,?([6-9][0-9])\s*(['\.:]|M(?:IN)?(?:UTES)?)?\s*(NORTH|SOUTH|[NS])?(?:\s*[,/;]\s*|\s*)(EAST|WEST|[EW])?\s*([+-]?[0-1]?[0-9]?[0-9])\s*([\.:]|D(?:EG)?(?:REES)?)?\s*,?([6-9][0-9])\s*(['\.:]|M(?:IN)?(?:UTES)?)?\s*(EAST|WEST|[EW])?$/i,zL=/^([+-]?[0-8]?[0-9])\s+([0-5]?[0-9]\.\d{3,})[\s,]{1,}([+-]?[0-1]?[0-9]?[0-9])\s+([0-5]?[0-9]\.\d{3,})$/,NL=/^(NORTH|SOUTH|[NS])?[\s]*([+-]?[0-8]?[0-9](?:[\.,]\d{3,}))[\s]*([]?)[\s]*(NORTH|SOUTH|[NS])?[\s]*[,/;]?[\s]*(EAST|WEST|[EW])?[\s]*([+-]?[0-1]?[0-9]?[0-9](?:[\.,]\d{3,}))[\s]*([]?)[\s]*(EAST|WEST|[EW])?$/i,jL=/^(NORTH|SOUTH|[NS])?\s*([+-]?[0-8]?[0-9])\s*(\.)\s*([0-5]?[0-9])\s*(\.)\s*((?:[0-5]?[0-9])(?:[\.,]\d{1,3})?)?\s*(NORTH|SOUTH|[NS])?(?:\s*[,/;]\s*|\s*)(EAST|WEST|[EW])?\s*([+-]?[0-1]?[0-9]?[0-9])\s*(\.)\s*([0-5]?[0-9])\s*(\.)\s*((?:[0-5]?[0-9])(?:[\.,]\d{1,3})?)?\s*(EAST|WEST|[EW])?$/i,FL=/^(NORTH|SOUTH|[NS])?\s*([+-]?[0-8]?[0-9])\s*(D(?:EG)?(?:REES)?)\s*([0-5]?[0-9])\s*(M(?:IN)?(?:UTES)?)\s*((?:[0-5]?[0-9])(?:[\.,]\d{1,3})?)?\s*(S(?:EC)?(?:ONDS)?)?\s*(NORTH|SOUTH|[NS])?(?:\s*[,/;]\s*|\s*)(EAST|WEST|[EW])?\s*([+-]?[0-1]?[0-9]?[0-9])\s*(D(?:EG)?(?:REES)?)\s*([0-5]?[0-9])\s*(M(?:IN)?(?:UTES)?)\s*((?:[0-5]?[0-9])(?:[\.,]\d{1,3})?)?\s*(S(?:EC)?(?:ONDS)?)\s*(EAST|WEST|[EW])?$/i,BL=/^(NORTH|SOUTH|[NS])?\s*([+-]?[0-8]?[0-9])\s*([\.:]|D(?:EG)?(?:REES)?)?\s*,?([0-5]?[0-9](?:[\.,]\d{1,})?)?\s*(['\.:]|M(?:IN)?(?:UTES)?)?\s*,?((?:[0-5]?[0-9])(?:[\.,]\d{1,3})?)?\s*(''||||["\.])?\s*(NORTH|SOUTH|[NS])?(?:\s*[,/;]\s*|\s*)(EAST|WEST|[EW])?\s*([+-]?[0-1]?[0-9]?[0-9])\s*([\.:]|D(?:EG)?(?:REES)?)?\s*,?([0-5]?[0-9](?:[\.,]\d{1,})?)?\s*(['\.:]|M(?:IN)?(?:UTES)?)?\s*,?((?:[0-5]?[0-9])(?:[\.,]\d{1,3})?)?\s*(''||||["\.])?\s*(EAST|WEST|[EW])?$/i;function aae(t){if(!["DMS","DM","DD"].includes(t))throw new Error("invalid format specified");if(this.decimalCoordinates&&this.decimalCoordinates.trim()){const e=this.decimalCoordinates.split(",").map(A=>Number(A.trim())),r=Number(e[0]),n=Number(e[1]),s=Math.abs(r),c=Math.abs(n),l=r>0?"N":"S",a=n>0?"E":"W";let m;t=="DD"&&(m=`${s} ${l}, ${c} ${a}`);const y=Math.floor(s),v=Math.floor(c),T=(s-y)*60,P=(c-v)*60;if(t=="DM"){let A=$L(T,3).toFixed(3).padStart(6,"0"),O=$L(P,3).toFixed(3).padStart(6,"0");A.endsWith(".000")&&O.endsWith(".000")&&(A=A.replace(/\.000$/,""),O=O.replace(/\.000$/,"")),m=`${y} ${A}' ${l}, ${v} ${O}' ${a}`}if(t=="DMS"){const A=Math.floor(T),O=Math.floor(P);let I=((T-A)*60).toFixed(1).padStart(4,"0"),L=((P-O)*60).toFixed(1).padStart(4,"0");const R=A.toString().padStart(2,"0"),z=O.toString().padStart(2,"0");I.endsWith(".0")&&L.endsWith(".0")&&(I=I.replace(/\.0$/,""),L=L.replace(/\.0$/,"")),m=`${y} ${R}' ${I}" ${l}, ${v} ${z}' ${L}" ${a}`}return m}else throw new Error("no decimal coordinates to convert")}function $L(t,e){const r=Math.pow(10,e);return Math.round((t+Number.EPSILON)*r)/r}function _A(t,e){e||(e=5),t=t.replace(/\s+/g," ").trim();let r=null,n=null,s="",c="",l=null,a=[],m=!1;if(oae.test(t))throw new Error("invalid coordinate value");if(zL.test(t))if(a=zL.exec(t),m=Xg(a),m)r=Math.abs(a[1])+a[2]/60,Number(a[1])<0&&(r*=-1),n=Math.abs(a[3])+a[4]/60,Number(a[3])<0&&(n*=-1),l="DM";else throw new Error("invalid coordinate format");else if(NL.test(t))if(a=NL.exec(t),m=Xg(a),m){if(r=a[2],n=a[6],r.includes(",")&&(r=r.replace(",",".")),n.includes(",")&&(n=n.replace(",",".")),l="DD",Number(Math.round(r))==Number(r))throw new Error("integer only coordinate provided");if(Number(Math.round(n))==Number(n))throw new Error("integer only coordinate provided");a[1]?(s=a[1],c=a[5]):a[4]&&(s=a[4],c=a[8])}else throw new Error("invalid decimal coordinate format");else if(jL.test(t))if(a=jL.exec(t),m=Xg(a),m)r=Math.abs(parseInt(a[2])),a[4]&&(r+=a[4]/60,l="DM"),a[6]&&(r+=a[6].replace(",",".")/3600,l="DMS"),parseInt(a[2])<0&&(r=-1*r),n=Math.abs(parseInt(a[9])),a[11]&&(n+=a[11]/60),a[13]&&(n+=a[13].replace(",",".")/3600),parseInt(a[9])<0&&(n=-1*n),a[1]?(s=a[1],c=a[8]):a[7]&&(s=a[7],c=a[14]);else throw new Error("invalid DMS coordinates format");else if(FL.test(t))if(a=FL.exec(t),m=Xg(a),m)r=Math.abs(parseInt(a[2])),a[4]&&(r+=a[4]/60,l="DM"),a[6]&&(r+=a[6]/3600,l="DMS"),parseInt(a[2])<0&&(r=-1*r),n=Math.abs(parseInt(a[10])),a[12]&&(n+=a[12]/60),a[14]&&(n+=a[14]/3600),parseInt(a[10])<0&&(n=-1*n),a[1]?(s=a[1],c=a[9]):a[8]&&(s=a[8],c=a[16]);else throw new Error("invalid DMS coordinates format");else if(BL.test(t)){if(a=BL.exec(t),m=Xg(a),a.filter(y=>y).length<=5)throw new Error("invalid coordinates format");if(m)r=Math.abs(parseInt(a[2])),a[4]&&(r+=a[4].replace(",",".")/60,l="DM"),a[6]&&(r+=a[6].replace(",",".")/3600,l="DMS"),parseInt(a[2])<0&&(r=-1*r),n=Math.abs(parseInt(a[10])),a[12]&&(n+=a[12].replace(",",".")/60),a[14]&&(n+=a[14].replace(",",".")/3600),parseInt(a[10])<0&&(n=-1*n),a[1]?(s=a[1],c=a[9]):a[8]&&(s=a[8],c=a[16]);else throw new Error("invalid coordinates format")}if(m){if(Math.abs(n)>=180)throw new Error("invalid longitude value");if(Math.abs(r)>=90)throw new Error("invalid latitude value");if(s&&!c||!s&&c)throw new Error("invalid coordinates value");if(s&&s==c)throw new Error("invalid coordinates format");r.toString().includes(",")&&(r=r.replace(",",".")),n.toString().includes(",")&&(n=n.replace(",","."));let y=/S|SOUTH/i;y.test(s)&&r>0&&(r=-1*r),y=/W|WEST/i,y.test(c)&&n>0&&(n=-1*n);const v=a[0].trim();let T,P;const A=/[,/;\u0020]/g,O=v.match(A);if(O==null){const R=Math.floor(t.length/2);T=v.substring(0,R).trim(),P=v.substring(R).trim()}else{let R;O.length%2==1?R=Math.floor(O.length/2):R=O.length/2-1;let z=0;if(R==0)z=v.indexOf(O[0]),T=v.substring(0,z).trim(),P=v.substring(z+1).trim();else{let j=0,W=0;for(;j<=R;)z=v.indexOf(O[j],W),W=z+1,j++;T=v.substring(0,z).trim(),P=v.substring(z+1).trim()}}const I=T.split(".");if(I.length==2&&I[1]==0&&I[1].length!=2)throw new Error("invalid coordinates format");const L=P.split(".");if(L.length==2&&L[1]==0&&L[1].length!=2)throw new Error("invalid coordinates format");if(/^\d+$/.test(T)||/^\d+$/.test(P))throw new Error("degree only coordinate/s provided");return r=Number(Number(r).toFixed(e)),n=Number(Number(n).toFixed(e)),Object.freeze({verbatimCoordinates:v,verbatimLatitude:T,verbatimLongitude:P,decimalLatitude:r,decimalLongitude:n,decimalCoordinates:`${r},${n}`,originalFormat:l,closeEnough:lae,toCoordinateFormat:aae})}else throw new Error("coordinates pattern match failed")}function Xg(t){if(!isNaN(t[0]))return!1;const e=[...t];if(e.shift(),e.length%2>0)return!1;const r=/^[-+]?\d+([\.,]\d+)?$/,n=/[eastsouthnorthwest]+/i,s=e.length/2;for(let c=0;c<s;c++){const l=e[c],a=e[c+s],m=r.test(l)&&r.test(a),y=n.test(l)&&n.test(a),v=l==a;if(!(l==null&&a==null)){if(l==null||a==null)return!1;if(m||y||v)continue;return!1}}return!0}function VL(t,e){const r=Math.abs(t-e);return Number(r.toFixed(6))<=1e-5}function lae(t){if(!t)throw new Error("coords must be provided");if(t.includes(",")){const e=t.split(",");if(Number(e[0])==NaN||Number(e[1])==NaN)throw new Error("coords are not valid decimals");return VL(this.decimalLatitude,Number(e[0]))&&VL(this.decimalLongitude,e[1])}else throw new Error("coords being tested must be separated by a comma")}const cae=Object.freeze({DMS:"DMS",DM:"DM",DD:"DD"});_A.to=cae;const uae=[{verbatimCoordinates:"40.123, -74.123",verbatimLatitude:"40.123",verbatimLongitude:"-74.123"},{verbatimCoordinates:"40.123 N 74.123 W",verbatimLatitude:"40.123 N",verbatimLongitude:"74.123 W"},{verbatimCoordinates:"40.123 N 74.123 W",verbatimLatitude:"40.123 N",verbatimLongitude:"74.123 W"},{verbatimCoordinates:'40 7 22.8" N 74 7 22.8" W',verbatimLatitude:'40 7 22.8" N',verbatimLongitude:'74 7 22.8" W'},{verbatimCoordinates:"40 7.38 , -74 7.38",verbatimLatitude:"40 7.38",verbatimLongitude:"-74 7.38"},{verbatimCoordinates:"N40722.8, W74722.8",verbatimLatitude:"N40722.8",verbatimLongitude:"W74722.8"},{verbatimCoordinates:'40722.8"N, 74722.8"W',verbatimLatitude:'40722.8"N',verbatimLongitude:'74722.8"W'},{verbatimCoordinates:`407'22.8"N, 747'22.8"W`,verbatimLatitude:`407'22.8"N`,verbatimLongitude:`747'22.8"W`},{verbatimCoordinates:"40 7 22.8, -74 7 22.8",verbatimLatitude:"40 7 22.8",verbatimLongitude:"-74 7 22.8"},{verbatimCoordinates:"40.123 -74.123",verbatimLatitude:"40.123",verbatimLongitude:"-74.123"},{verbatimCoordinates:"40.123,-74.123",verbatimLatitude:"40.123",verbatimLongitude:"-74.123"},{verbatimCoordinates:"40.123N74.123W",verbatimLatitude:"40.123N",verbatimLongitude:"74.123W"},{verbatimCoordinates:"4007.38N7407.38W",verbatimLatitude:"4007.38N",verbatimLongitude:"7407.38W"},{verbatimCoordinates:'40722.8"N, 74722.8"W',verbatimLatitude:'40722.8"N',verbatimLongitude:'74722.8"W'},{verbatimCoordinates:"400722.8N740722.8W",verbatimLatitude:"400722.8N",verbatimLongitude:"740722.8W"},{verbatimCoordinates:"N 40 7.38 W 74 7.38",verbatimLatitude:"N 40 7.38",verbatimLongitude:"W 74 7.38"},{verbatimCoordinates:"40:7:22.8N 74:7:22.8W",verbatimLatitude:"40:7:22.8N",verbatimLongitude:"74:7:22.8W"},{verbatimCoordinates:"40:7:23N,74:7:23W",verbatimLatitude:"40:7:23N",verbatimLongitude:"74:7:23W",decimalLatitude:40.1230555555,decimalLongitude:-74.1230555555},{verbatimCoordinates:'40723"N 74723"W',verbatimLatitude:'40723"N',verbatimLongitude:'74723"W',decimalLatitude:40.1230555555,decimalLongitude:-74.12305555555555},{verbatimCoordinates:'40723"S 74723"E',verbatimLatitude:'40723"S',verbatimLongitude:'74723"E',decimalLatitude:-40.1230555555,decimalLongitude:74.12305555555555},{verbatimCoordinates:'40723" -74723"',verbatimLatitude:'40723"',verbatimLongitude:'-74723"',decimalLatitude:40.1230555555,decimalLongitude:-74.123055555},{verbatimCoordinates:'40d 7 23" N 74d 7 23" W',verbatimLatitude:'40d 7 23" N',verbatimLongitude:'74d 7 23" W',decimalLatitude:40.1230555555,decimalLongitude:-74.123055555},{verbatimCoordinates:"40.123N 74.123W",verbatimLatitude:"40.123N",verbatimLongitude:"74.123W"},{verbatimCoordinates:"40 7.38, -74 7.38",verbatimLatitude:"40 7.38",verbatimLongitude:"-74 7.38"},{verbatimCoordinates:"40 7.38, -74 7.38",verbatimLatitude:"40 7.38",verbatimLongitude:"-74 7.38"},{verbatimCoordinates:"40 7 22.8; -74 7 22.8",verbatimLatitude:"40 7 22.8",verbatimLongitude:"-74 7 22.8"}],hae={decimalLatitude:40.123,decimalLongitude:-74.123},dae=[{verbatimCoordinates:`504'17.698"south, 1424'2.826"east`,verbatimLatitude:`504'17.698"south`,verbatimLongitude:`1424'2.826"east`,decimalLatitude:-50.07158277777778,decimalLongitude:14.400785},{verbatimCoordinates:"50d4m17.698S 14d24m2.826E",verbatimLatitude:"50d4m17.698S",verbatimLongitude:"14d24m2.826E",decimalLatitude:-50.07158277777778,decimalLongitude:14.400785},{verbatimCoordinates:"40:26:46N,79:56:55W",verbatimLatitude:"40:26:46N",verbatimLongitude:"79:56:55W",decimalLatitude:40.44611111111111,decimalLongitude:-79.9486111111111},{verbatimCoordinates:"40:26:46.302N 79:56:55.903W",verbatimLatitude:"40:26:46.302N",verbatimLongitude:"79:56:55.903W",decimalLatitude:40.446195,decimalLongitude:-79.94886194444445},{verbatimCoordinates:"402647N 795836W",verbatimLatitude:"402647N",verbatimLongitude:"795836W",decimalLatitude:40.44638888888889,decimalLongitude:-79.97666666666667},{verbatimCoordinates:"40d 26 47 N 79d 58 36 W",verbatimLatitude:"40d 26 47 N",verbatimLongitude:"79d 58 36 W",decimalLatitude:40.44638888888889,decimalLongitude:-79.97666666666667},{verbatimCoordinates:"40.446195N 79.948862W",verbatimLatitude:"40.446195N",verbatimLongitude:"79.948862W",decimalLatitude:40.446195,decimalLongitude:-79.948862},{verbatimCoordinates:"40,446195 79,948862",verbatimLatitude:"40,446195",verbatimLongitude:"79,948862",decimalLatitude:40.446195,decimalLongitude:79.948862},{verbatimCoordinates:"40 26.7717, -79 56.93172",verbatimLatitude:"40 26.7717",verbatimLongitude:"-79 56.93172",decimalLatitude:40.446195,decimalLongitude:-79.948862},{verbatimCoordinates:"40.446195, -79.948862",verbatimLatitude:"40.446195",verbatimLongitude:"-79.948862",decimalLatitude:40.446195,decimalLongitude:-79.948862},{verbatimCoordinates:"40.123256; -74.123256",verbatimLatitude:"40.123256",verbatimLongitude:"-74.123256",decimalLatitude:40.123256,decimalLongitude:-74.123256},{verbatimCoordinates:"1824S 2245E",verbatimLatitude:"1824S",verbatimLongitude:"2245E",decimalLatitude:-18.4,decimalLongitude:22.75}],fae=[{verbatimCoordinates:"10.432342S 10.6345345E",verbatimLatitude:"10.432342S",verbatimLongitude:"10.6345345E",decimalLatitude:-10.432342,decimalLongitude:10.6345345},{verbatimCoordinates:"10.00S 10.00E",verbatimLatitude:"10.00S",verbatimLongitude:"10.00E",decimalLatitude:-10,decimalLongitude:10},{verbatimCoordinates:"00.00S 01.00E",verbatimLatitude:"00.00S",verbatimLongitude:"01.00E",decimalLatitude:0,decimalLongitude:1},{verbatimCoordinates:"18.24S 22.45E",verbatimLatitude:"18.24S",verbatimLongitude:"22.45E",decimalLatitude:-18.4,decimalLongitude:22.75},{verbatimCoordinates:"27deg 15min 45.2sec S 18deg 32min 53.7sec E",verbatimLatitude:"27deg 15min 45.2sec S",verbatimLongitude:"18deg 32min 53.7sec E",decimalLatitude:-27.262555555555554,decimalLongitude:18.54825},{verbatimCoordinates:"-23.3245 S / 28.2344 E",verbatimLatitude:"-23.3245 S",verbatimLongitude:"28.2344 E",decimalLatitude:-23.3245,decimalLongitude:28.2344},{verbatimCoordinates:"40 26.7717 -79 56.93172",verbatimLatitude:"40 26.7717",verbatimLongitude:"-79 56.93172",decimalLatitude:40.446195,decimalLongitude:-79.948862},{verbatimCoordinates:"27.15.45S 18.32.53E",verbatimLatitude:"27.15.45S",verbatimLongitude:"18.32.53E",decimalLatitude:-27.2625,decimalLongitude:18.548055},{verbatimCoordinates:"-27.15.45 18.32.53",verbatimLatitude:"-27.15.45",verbatimLongitude:"18.32.53",decimalLatitude:-27.2625,decimalLongitude:18.548055},{verbatimCoordinates:"27.15.45.2S 18.32.53.4E",verbatimLatitude:"27.15.45.2S",verbatimLongitude:"18.32.53.4E",decimalLatitude:-27.262556,decimalLongitude:18.548167},{verbatimCoordinates:"27.15.45,2S 18.32.53,4E",verbatimLatitude:"27.15.45,2S",verbatimLongitude:"18.32.53,4E",decimalLatitude:-27.262556,decimalLongitude:18.548167},{verbatimCoordinates:"S23.43563   E22.45634 ",verbatimLatitude:"S23.43563 ",verbatimLongitude:"E22.45634 ",decimalLatitude:-23.43563,decimalLongitude:22.45634},{verbatimCoordinates:"27,71372 S 23,07771 E",verbatimLatitude:"27,71372 S",verbatimLongitude:"23,07771 E",decimalLatitude:-27.71372,decimalLongitude:23.07771},{verbatimCoordinates:"27.45.34 S 23.23.23 E",verbatimLatitude:"27.45.34 S",verbatimLongitude:"23.23.23 E",decimalLatitude:-27.759444,decimalLongitude:23.38972222},{verbatimCoordinates:"S 27.45.34 E 23.23.23",verbatimLatitude:"S 27.45.34",verbatimLongitude:"E 23.23.23",decimalLatitude:-27.759444,decimalLongitude:23.38972222},{verbatimCoordinates:"53 16.3863,4 52.8171",verbatimLatitude:"53 16.3863",verbatimLongitude:"4 52.8171",decimalLatitude:53.273105,decimalLongitude:4.88029},{verbatimCoordinates:"50 8.2914,-5 2.4447",verbatimLatitude:"50 8.2914",verbatimLongitude:"-5 2.4447",decimalLatitude:50.13819,decimalLongitude:-5.040745},{verbatimCoordinates:"N 48 30,6410', E 18 57,4583'",verbatimLatitude:"N 48 30,6410'",verbatimLongitude:"E 18 57,4583'",decimalLatitude:48.51068,decimalLongitude:18.95764},{verbatimCoordinates:"1.23456, 18.33453",verbatimLatitude:"1.23456",verbatimLongitude:"18.33453",decimalLatitude:1.23456,decimalLongitude:18.33453}];function pae(){const t=[];return uae.forEach(e=>{e.decimalLatitude?t.push(e):t.push({...e,...hae})}),[...t,...dae,...fae]}const mae=pae();_A.formats=mae.map(t=>t.verbatimCoordinates);const gae=_A;function UL(t,e,r){const n=t.slice();return n[97]=e[r],n[99]=r,n}function GL(t){let e,r,n,s,c;return r=new n6({}),{c(){e=Gr("button"),Ou(r.$$.fragment),Je(e,"type","button"),Je(e,"title",t[3]),Je(e,"class","svelte-bz0zu3")},m(l,a){cn(l,e,a),cc(r,e,null),n=!0,s||(c=ki(e,"click",t[78]),s=!0)},p(l,a){(!n||a[0]&8)&&Je(e,"title",l[3])},i(l){n||(vn(r.$$.fragment,l),n=!0)},o(l){pi(r.$$.fragment,l),n=!1},d(l){l&&Jr(e),uc(r),s=!1,c()}}}function WL(t){let e,r;return e=new Xoe({}),{c(){Ou(e.$$.fragment)},m(n,s){cc(e,n,s),r=!0},i(n){r||(vn(e.$$.fragment,n),r=!0)},o(n){pi(e.$$.fragment,n),r=!1},d(n){uc(e,n)}}}function qL(t){let e,r,n,s,c;return r=new tae({}),{c(){e=Gr("button"),Ou(r.$$.fragment),Je(e,"type","button"),Je(e,"title",t[10]),Je(e,"class","svelte-bz0zu3"),cl(e,"active",t[0])},m(l,a){cn(l,e,a),cc(r,e,null),n=!0,s||(c=ki(e,"click",t[79]),s=!0)},p(l,a){(!n||a[0]&1024)&&Je(e,"title",l[10]),(!n||a[0]&1)&&cl(e,"active",l[0])},i(l){n||(vn(r.$$.fragment,l),n=!0)},o(l){pi(r.$$.fragment,l),n=!1},d(l){l&&Jr(e),uc(r),s=!1,c()}}}function yae(t){let e,r=[],n=new Map,s,c,l,a=LL(t[13]);const m=y=>y[97].id+(y[97].address?","+y[97].address:"");for(let y=0;y<a.length;y+=1){let v=UL(t,a,y),T=m(v);n.set(T,r[y]=HL(T,v))}return{c(){e=Gr("ul");for(let y=0;y<r.length;y+=1)r[y].c();Je(e,"class","options svelte-bz0zu3"),Je(e,"role","listbox")},m(y,v){cn(y,e,v);for(let T=0;T<r.length;T+=1)r[T]&&r[T].m(e,null);s=!0,c||(l=[ki(e,"mouseleave",t[27]),ki(e,"blur",t[83]),ki(e,"keydown",t[23])],c=!0)},p(y,v){v[0]&102823936&&(a=LL(y[13]),cy(),r=Roe(r,v,m,1,y,a,n,e,Ioe,HL,null,UL),uy())},i(y){if(!s){for(let v=0;v<a.length;v+=1)vn(r[v]);s=!0}},o(y){for(let v=0;v<r.length;v+=1)pi(r[v]);s=!1},d(y){y&&Jr(e);for(let v=0;v<r.length;v+=1)r[v].d();c=!1,fc(l)}}}function _ae(t){let e,r,n,s,c,l;return r=new i6({}),{c(){e=Gr("div"),Ou(r.$$.fragment),n=vo(),s=Gr("div"),c=Lu(t[8]),Je(s,"class","svelte-bz0zu3"),Je(e,"class","no-results svelte-bz0zu3")},m(a,m){cn(a,e,m),cc(r,e,null),Pr(e,n),Pr(e,s),Pr(s,c),l=!0},p(a,m){(!l||m[0]&256)&&E0(c,a[8])},i(a){l||(vn(r.$$.fragment,a),l=!0)},o(a){pi(r.$$.fragment,a),l=!1},d(a){a&&Jr(e),uc(r)}}}function vae(t){let e="",r;return{c(){r=Lu(e)},m(n,s){cn(n,r,s)},p:mn,i:mn,o:mn,d(n){n&&Jr(r)}}}function xae(t){let e,r,n,s,c,l,a,m,y,v,T;return r=new i6({}),m=new n6({}),{c(){e=Gr("div"),Ou(r.$$.fragment),n=vo(),s=Gr("div"),c=Lu(t[7]),l=vo(),a=Gr("button"),Ou(m.$$.fragment),Je(s,"class","svelte-bz0zu3"),Je(a,"class","svelte-bz0zu3"),Je(e,"class","error svelte-bz0zu3")},m(P,A){cn(P,e,A),cc(r,e,null),Pr(e,n),Pr(e,s),Pr(s,c),Pr(e,l),Pr(e,a),cc(m,a,null),y=!0,v||(T=ki(a,"click",t[80]),v=!0)},p(P,A){(!y||A[0]&128)&&E0(c,P[7])},i(P){y||(vn(r.$$.fragment,P),vn(m.$$.fragment,P),y=!0)},o(P){pi(r.$$.fragment,P),pi(m.$$.fragment,P),y=!1},d(P){P&&Jr(e),uc(r),uc(m),v=!1,T()}}}function HL(t,e){var r;let n,s,c;function l(){return e[81](e[99])}function a(){return e[82](e[97])}return s=new Zoe({props:{feature:e[97],showPlaceType:e[11],style:e[15]===e[99]?"selected":((r=e[14])==null?void 0:r.id)===e[97].id?"picked":"default",missingIconsCache:e[21],iconsBaseUrl:e[12]}}),s.$on("mouseenter",l),s.$on("select",a),{key:t,first:null,c(){n=boe(),Ou(s.$$.fragment),this.first=n},m(m,y){cn(m,n,y),cc(s,m,y),c=!0},p(m,y){var v;e=m;const T={};y[0]&8192&&(T.feature=e[97]),y[0]&2048&&(T.showPlaceType=e[11]),y[0]&57344&&(T.style=e[15]===e[99]?"selected":((v=e[14])==null?void 0:v.id)===e[97].id?"picked":"default"),y[0]&4096&&(T.iconsBaseUrl=e[12]),s.$set(T)},i(m){c||(vn(s.$$.fragment,m),c=!0)},o(m){pi(s.$$.fragment,m),c=!1},d(m){m&&Jr(n),uc(s,m)}}}function bae(t){let e,r,n,s,c,l,a,m,y,v,T,P,A,O,I,L,R,z,j,W=!1;c=new nae({});let Z=!t[20]&&GL(t),te=t[20]&&WL(),ie=t[6]==="button"&&qL(t);const V=t[70].default,q=yoe(V,t,t[69],null),Q=[xae,vae,_ae,yae],ce=[];function se(ue,he){var ye,xe;return ue[19]?0:!ue[16]&&!ue[4]?1:((ye=ue[13])==null?void 0:ye.length)===0?2:(xe=ue[13])!=null&&xe.length&&(ue[16]||ue[4])?3:-1}return~(O=se(t))&&(I=ce[O]=Q[O](t)),{c(){e=vo(),r=Gr("form"),n=Gr("div"),s=Gr("button"),Ou(c.$$.fragment),l=vo(),a=Gr("input"),m=vo(),y=Gr("div"),Z&&Z.c(),v=vo(),te&&te.c(),T=vo(),ie&&ie.c(),P=vo(),q&&q.c(),A=vo(),I&&I.c(),Je(s,"class","search-button svelte-bz0zu3"),Je(s,"type","button"),Je(a,"placeholder",t[9]),Je(a,"aria-label",t[9]),Je(a,"class","svelte-bz0zu3"),Je(y,"class","clear-button-container svelte-bz0zu3"),cl(y,"displayable",t[1]!==""),Je(n,"class","input-group svelte-bz0zu3"),Je(r,"class",L=kb(t[2])+" svelte-bz0zu3"),cl(r,"can-collapse",t[5]&&t[1]==="")},m(ue,he){cn(ue,e,he),cn(ue,r,he),Pr(r,n),Pr(n,s),cc(c,s,null),Pr(n,l),Pr(n,a),t[72](a),RL(a,t[1]),Pr(n,m),Pr(n,y),Z&&Z.m(y,null),Pr(y,v),te&&te.m(y,null),Pr(n,T),ie&&ie.m(n,null),Pr(n,P),q&&q.m(n,null),Pr(r,A),~O&&ce[O].m(r,null),R=!0,z||(j=[ki(s,"click",t[71]),ki(a,"input",t[73]),ki(a,"focus",t[74]),ki(a,"blur",t[75]),ki(a,"click",t[76]),ki(a,"keydown",t[23]),ki(a,"input",t[24]),ki(a,"change",t[77]),ki(r,"submit",woe(t[22]))],z=!0)},p(ue,he){(!R||he[0]&512)&&Je(a,"placeholder",ue[9]),(!R||he[0]&512)&&Je(a,"aria-label",ue[9]),he[0]&2&&a.value!==ue[1]&&RL(a,ue[1]),ue[20]?Z&&(cy(),pi(Z,1,1,()=>{Z=null}),uy()):Z?(Z.p(ue,he),he[0]&1048576&&vn(Z,1)):(Z=GL(ue),Z.c(),vn(Z,1),Z.m(y,v)),ue[20]?te?he[0]&1048576&&vn(te,1):(te=WL(),te.c(),vn(te,1),te.m(y,null)):te&&(cy(),pi(te,1,1,()=>{te=null}),uy()),(!R||he[0]&2)&&cl(y,"displayable",ue[1]!==""),ue[6]==="button"?ie?(ie.p(ue,he),he[0]&64&&vn(ie,1)):(ie=qL(ue),ie.c(),vn(ie,1),ie.m(n,P)):ie&&(cy(),pi(ie,1,1,()=>{ie=null}),uy()),q&&q.p&&(!R||he[2]&128)&&voe(q,V,ue,ue[69],R?_oe(V,ue[69]):xoe(ue[69]),null);let ye=O;O=se(ue),O===ye?~O&&ce[O].p(ue,he):(I&&(cy(),pi(ce[ye],1,1,()=>{ce[ye]=null}),uy()),~O?(I=ce[O],I?I.p(ue,he):(I=ce[O]=Q[O](ue),I.c()),vn(I,1),I.m(r,null)):I=null),(!R||he[0]&4&&L!==(L=kb(ue[2])+" svelte-bz0zu3"))&&Je(r,"class",L),(!R||he[0]&38)&&cl(r,"can-collapse",ue[5]&&ue[1]==="")},i(ue){R||(vn(W),vn(c.$$.fragment,ue),vn(Z),vn(te),vn(ie),vn(q,ue),vn(I),R=!0)},o(ue){pi(W),pi(c.$$.fragment,ue),pi(Z),pi(te),pi(ie),pi(q,ue),pi(I),R=!1},d(ue){ue&&(Jr(e),Jr(r)),uc(c),t[72](null),Z&&Z.d(),te&&te.d(),ie&&ie.d(),q&&q.d(ue),~O&&ce[O].d(),z=!1,fc(j)}}}function wae(t,e,r){let n,s,c,{$$slots:l={},$$scope:a}=e;const m={continental_marine:4,country:4,major_landform:8,region:5,subregion:6,county:7,joint_municipality:8,joint_submunicipality:9,municipality:10,municipal_district:11,locality:12,neighbourhood:13,place:14,postal_code:14,road:16,poi:17,address:18,"poi.peak":15,"poi.shop":18,"poi.cafe":18,"poi.restaurant":18,"poi.aerodrome":13};let{class:y=void 0}=e,{apiKey:v=void 0}=e,{bbox:T=void 0}=e,{clearButtonTitle:P="clear"}=e,{clearOnBlur:A=!1}=e,{clearListOnPick:O=!1}=e,{keepListOpen:I=!1}=e,{collapsed:L=!1}=e,{country:R=void 0}=e,{debounceSearch:z=200}=e,{enableReverse:j="never"}=e,{errorMessage:W="Something went wrong"}=e,{filter:Z=()=>!0}=e,{flyTo:te=!0}=e,{fuzzyMatch:ie=!0}=e,{language:V=void 0}=e,{limit:q=void 0}=e;const Q=41415112612;let{reverseGeocodingLimit:ce=Q}=e,{mapController:se=void 0}=e,{minLength:ue=2}=e,{noResultsMessage:he="Oops! Looks like you're trying to predict something that's not quite right. We can't seem to find what you're looking for. Maybe try double-checking your spelling or try a different search term. Keep on typing - we'll do our best to get you where you need to go!"}=e,{placeholder:ye="Search"}=e,{proximity:xe=[{type:"server-geolocation"}]}=e,{reverseActive:Se=j==="always"}=e,{reverseButtonTitle:fe="toggle reverse geocoding"}=e,{searchValue:ve=""}=e,{pickedResultStyle:Re="full-geometry"}=e,{showPlaceType:$e="if-needed"}=e,{showResultsWhileTyping:Xe=!0}=e,{selectFirst:st=!0}=e,{flyToSelected:at=!1}=e,{markerOnSelected:_t=!0}=e,{types:Ct=void 0}=e;const Pt=[];let{reverseGeocodingTypes:Ht=Pt}=e,{exhaustiveReverseGeocoding:ir=!1}=e,{excludeTypes:yr=!1}=e;const $t=void 0;let{reverseGeocodingExcludeTypes:vt=$t}=e,{zoom:Et=m}=e,{apiUrl:Rt="https://api.maptiler.com/geocoding"}=e,{fetchParameters:Ft={}}=e,{iconsBaseUrl:Nr="https://cdn.maptiler.com/maptiler-geocoding-control/v2.1.7/icons/"}=e,{adjustUrlQuery:Zr=()=>{}}=e,{adjustUrl:Kr=()=>{}}=e;function Ar(Ze){Br.focus(Ze)}function Gn(){Br.blur()}function Nn(Ze,or=!0,Nt=!1){r(1,ve=Ze),or?(r(15,Me=-1),nt()):(Dt(void 0,!Nt,Nt),setTimeout(()=>{Br.focus(),Br.select()}))}function xi(){r(13,Zt=void 0),r(14,St=void 0),r(15,Me=-1)}function rn(){r(64,Or=[]),r(14,St=void 0)}let Zt,Or,St,Sn="",Br,Me=-1,ne,oe=[],de,we,Ae,Oe,Be=!1;const ze=new Set,He=t6();Eoe(()=>{se&&(se.setEventHandler(void 0),se.indicateReverse(!1),se.setSelectedMarker(-1),se.setFeatures(void 0,void 0,!1))});function nt(Ze){if(r(17,Be=!1),we&&(clearTimeout(we),we=void 0),Me>-1&&Zt)r(14,St=Zt[Me]),r(1,ve=St.place_type[0]==="reverse"?St.place_name:St.place_name.replace(/,.*/,"")),r(19,ne=void 0),r(64,Or=void 0),r(15,Me=-1);else if(ve){const or=Ze||!Qe(ve);Tt(ve,{exact:!0}).then(()=>{r(64,Or=Zt),r(14,St=void 0),or&&It()}).catch(Nt=>r(19,ne=Nt))}}function Qe(Ze){try{return gae(Ze,6)}catch{return!1}}async function Tt(Ze,{byId:or=!1,exact:Nt=!1}={}){var En,Wn,ri;r(19,ne=void 0),de==null||de.abort();const Ri=new AbortController;r(20,de=Ri);try{const hr=Qe(Ze),ys=new URL(Rt+"/"+encodeURIComponent(hr?hr.decimalLongitude+","+hr.decimalLatitude:Ze)+".json"),br=ys.searchParams;V!==void 0&&br.set("language",Array.isArray(V)?V.join(","):V??"");const[bi]=(se==null?void 0:se.getCenterAndZoom())??[];let wr=(En=!hr||Ht===Pt?Ct:Ht)==null?void 0:En.map(qn=>typeof qn=="string"?qn:bi===void 0||(qn[0]??0)<=bi&&bi<(qn[1]??1/0)?qn[2]:void 0).filter(qn=>qn!==void 0);wr&&(wr=[...new Set(wr)],br.set("types",wr.join(",")));const La=!hr||vt===$t?yr:vt;if(La&&br.set("excludeTypes",String(La)),T&&br.set("bbox",T.map(qn=>qn.toFixed(6)).join(",")),R&&br.set("country",Array.isArray(R)?R.join(","):R),!or&&!hr){const qn=await sae(se,xe,Ri);qn&&br.set("proximity",qn),(Nt||!Xe)&&br.set("autocomplete","false"),br.set("fuzzyMatch",String(ie))}const Ls=ce===Q?q:ce;Ls!==void 0&&Ls>1&&(wr==null?void 0:wr.length)!==1&&console.warn("For reverse geocoding when limit > 1 then types must contain single value."),hr?(Ls===1||Ls!==void 0&&(ir||(wr==null?void 0:wr.length)===1))&&br.set("limit",String(Ls)):q!==void 0&&br.set("limit",String(q)),v&&br.set("key",v),Zr(br),Kr(ys);const Wu=ys.searchParams.get("types")===""&&ys.searchParams.get("excludeTypes")!=="true",Os=ys.toString();if(Os===Sn){or?(O&&r(13,Zt=void 0),r(14,St=oe[0])):(r(13,Zt=oe),((Wn=Zt[Me])==null?void 0:Wn.id)!==(s==null?void 0:s.id)&&r(15,Me=-1));return}Sn=Os;let Ui;if(Wu)Ui={type:"FeatureCollection",features:[]};else{const qn=await fetch(Os,{signal:Ri.signal,...Ft});if(!qn.ok)throw new Error(await qn.text());Ui=await qn.json()}He("response",{url:Os,featureCollection:Ui}),or?(O&&r(13,Zt=void 0),r(14,St=Ui.features[0]),oe=[St]):(r(13,Zt=Ui.features.filter(Z)),hr&&Zt.unshift({type:"Feature",properties:{},id:"reverse_"+hr.decimalLongitude+"_"+hr.decimalLatitude,text:hr.decimalLatitude+", "+hr.decimalLongitude,place_name:hr.decimalLatitude+", "+hr.decimalLongitude,place_type:["reverse"],center:[hr.decimalLongitude,hr.decimalLatitude],bbox:[hr.decimalLongitude,hr.decimalLatitude,hr.decimalLongitude,hr.decimalLatitude],geometry:{type:"Point",coordinates:[hr.decimalLongitude,hr.decimalLatitude]}}),oe=Zt,((ri=Zt[Me])==null?void 0:ri.id)!==(s==null?void 0:s.id)&&r(15,Me=-1),hr&&Br.focus())}catch(hr){if(hr&&typeof hr=="object"&&"name"in hr&&hr.name==="AbortError")return;throw hr}finally{Ri===de&&r(20,de=void 0)}}function It(){var Ze;if(!(Or!=null&&Or.length)||!te)return;const or=[180,90,-180,-90],Nt=!Or.some(Wn=>!Wn.matching_text);let En;for(const Wn of Or){const ri=Kt(Wn);if(En=En===void 0?ri:ri===void 0?En:Math.max(En,ri),Nt||!Wn.matching_text)for(const Ri of[0,1,2,3])or[Ri]=Math[Ri<2?"min":"max"](or[Ri],((Ze=Wn.bbox)==null?void 0:Ze[Ri])??Wn.center[Ri%2])}se&&Or.length>0&&(St&&or[0]===or[2]&&or[1]===or[3]?se.flyTo(St.center,Kt(St)):se.fitBounds(Mb(or),50,En))}function je(){!St||!se||(!St.bbox||St.bbox[0]===St.bbox[2]&&St.bbox[1]===St.bbox[3]?se.flyTo(St.center,Kt(St)):se.fitBounds(Mb(St.bbox),50,Kt(St)))}function Kt(Ze){var or;if(!Ze.bbox||Ze.bbox[0]!==Ze.bbox[2]&&Ze.bbox[1]!==Ze.bbox[3])return;const Nt=Ze.id.replace(/\..*/,"");return(Array.isArray((or=Ze.properties)==null?void 0:or.categories)?Ze.properties.categories.reduce((En,Wn)=>{const ri=Et[Nt+"."+Wn];return En===void 0?ri:ri===void 0?En:Math.max(En,ri)},void 0):void 0)??Et[Nt]}function wt(Ze){r(0,Se=j==="always"),r(13,Zt=void 0),r(14,St=void 0),r(15,Me=-1),Nn(Ze[1].toFixed(6)+", "+iae(Ze[0],[-180,180],!0).toFixed(6),!1,!0)}function lt(Ze){if(!Zt)return;let or=Ze.key==="ArrowDown"?1:Ze.key==="ArrowUp"?-1:0;or&&(Br.focus(),r(17,Be=!0),Ze.preventDefault(),St&&Me===-1&&r(15,Me=Zt.findIndex(Nt=>Nt.id===(St==null?void 0:St.id))),Me===(St||st?0:-1)&&or===-1&&r(15,Me=Zt.length),r(15,Me+=or),Me>=Zt.length&&r(15,Me=-1),Me<0&&(St||st)&&r(15,Me=0))}function Dt(Ze,or=!0,Nt=!1){if(r(19,ne=void 0),r(14,St=void 0),r(17,Be=!0),Xe||Nt){if(we&&clearTimeout(we),ve.length<ue)return;const En=ve;we=window.setTimeout(()=>{Tt(En).catch(Wn=>r(19,ne=Wn))},or?z:0)}else r(13,Zt=void 0),r(19,ne=void 0)}function _r(Ze){St&&(St==null?void 0:St.id)===(Ze==null?void 0:Ze.id)?je():(r(14,St=Ze),r(1,ve=Ze.place_name))}function xr(Ze){r(15,Me=Ze)}function kr(){(!st||St)&&r(15,Me=-1),at&&je()}const Vr=()=>Br.focus();function tr(Ze){zE[Ze?"unshift":"push"](()=>{Br=Ze,r(18,Br)})}function zr(){ve=this.value,r(1,ve),r(17,Be),r(31,A),r(16,Ae)}const Tr=()=>r(17,Be=!0),ot=()=>r(17,Be=!1),Ds=()=>r(17,Be=!0),Bi=()=>r(14,St=void 0),$i=()=>{r(1,ve=""),r(14,St=void 0),Br.focus()},Tn=()=>r(0,Se=!Se),dt=()=>r(19,ne=void 0),er=Ze=>xr(Ze),Yt=Ze=>_r(Ze),Vi=()=>{};return t.$$set=Ze=>{"class"in Ze&&r(2,y=Ze.class),"apiKey"in Ze&&r(29,v=Ze.apiKey),"bbox"in Ze&&r(30,T=Ze.bbox),"clearButtonTitle"in Ze&&r(3,P=Ze.clearButtonTitle),"clearOnBlur"in Ze&&r(31,A=Ze.clearOnBlur),"clearListOnPick"in Ze&&r(32,O=Ze.clearListOnPick),"keepListOpen"in Ze&&r(4,I=Ze.keepListOpen),"collapsed"in Ze&&r(5,L=Ze.collapsed),"country"in Ze&&r(33,R=Ze.country),"debounceSearch"in Ze&&r(34,z=Ze.debounceSearch),"enableReverse"in Ze&&r(6,j=Ze.enableReverse),"errorMessage"in Ze&&r(7,W=Ze.errorMessage),"filter"in Ze&&r(35,Z=Ze.filter),"flyTo"in Ze&&r(36,te=Ze.flyTo),"fuzzyMatch"in Ze&&r(37,ie=Ze.fuzzyMatch),"language"in Ze&&r(38,V=Ze.language),"limit"in Ze&&r(39,q=Ze.limit),"reverseGeocodingLimit"in Ze&&r(40,ce=Ze.reverseGeocodingLimit),"mapController"in Ze&&r(41,se=Ze.mapController),"minLength"in Ze&&r(42,ue=Ze.minLength),"noResultsMessage"in Ze&&r(8,he=Ze.noResultsMessage),"placeholder"in Ze&&r(9,ye=Ze.placeholder),"proximity"in Ze&&r(43,xe=Ze.proximity),"reverseActive"in Ze&&r(0,Se=Ze.reverseActive),"reverseButtonTitle"in Ze&&r(10,fe=Ze.reverseButtonTitle),"searchValue"in Ze&&r(1,ve=Ze.searchValue),"pickedResultStyle"in Ze&&r(44,Re=Ze.pickedResultStyle),"showPlaceType"in Ze&&r(11,$e=Ze.showPlaceType),"showResultsWhileTyping"in Ze&&r(45,Xe=Ze.showResultsWhileTyping),"selectFirst"in Ze&&r(46,st=Ze.selectFirst),"flyToSelected"in Ze&&r(47,at=Ze.flyToSelected),"markerOnSelected"in Ze&&r(48,_t=Ze.markerOnSelected),"types"in Ze&&r(49,Ct=Ze.types),"reverseGeocodingTypes"in Ze&&r(50,Ht=Ze.reverseGeocodingTypes),"exhaustiveReverseGeocoding"in Ze&&r(51,ir=Ze.exhaustiveReverseGeocoding),"excludeTypes"in Ze&&r(52,yr=Ze.excludeTypes),"reverseGeocodingExcludeTypes"in Ze&&r(53,vt=Ze.reverseGeocodingExcludeTypes),"zoom"in Ze&&r(54,Et=Ze.zoom),"apiUrl"in Ze&&r(55,Rt=Ze.apiUrl),"fetchParameters"in Ze&&r(56,Ft=Ze.fetchParameters),"iconsBaseUrl"in Ze&&r(12,Nr=Ze.iconsBaseUrl),"adjustUrlQuery"in Ze&&r(57,Zr=Ze.adjustUrlQuery),"adjustUrl"in Ze&&r(58,Kr=Ze.adjustUrl),"$$scope"in Ze&&r(69,a=Ze.$$scope)},t.$$.update=()=>{if(t.$$.dirty[0]&64&&r(0,Se=j==="always"),t.$$.dirty[0]&16384|t.$$.dirty[1]&8192&&Re!=="marker-only"&&St&&!St.address&&St.geometry.type==="Point"&&St.place_type[0]!=="reverse"&&Tt(St.id,{byId:!0}).catch(Ze=>r(19,ne=Ze)),t.$$.dirty[0]&16384|t.$$.dirty[1]&1058|t.$$.dirty[2]&8&&(se&&St&&St.id!==Oe&&te&&(je(),O&&r(13,Zt=void 0),r(64,Or=void 0),r(15,Me=-1)),r(65,Oe=St==null?void 0:St.id)),t.$$.dirty[0]&196608|t.$$.dirty[1]&1&&setTimeout(()=>{r(16,Ae=Be),A&&!Ae&&r(1,ve="")}),t.$$.dirty[0]&8194|t.$$.dirty[1]&2048&&ve.length<ue&&(r(13,Zt=void 0),r(19,ne=void 0),r(64,Or=Zt)),t.$$.dirty[0]&57344|t.$$.dirty[1]&32768&&st&&Zt!=null&&Zt.length&&Me==-1&&!St&&r(15,Me=0),t.$$.dirty[0]&8192|t.$$.dirty[2]&4&&Or!==Zt&&r(64,Or=void 0),t.$$.dirty[0]&73729|t.$$.dirty[1]&1024|t.$$.dirty[2]&4&&se&&se.setEventHandler(Ze=>{switch(Ze.type){case"mapClick":Se&&wt(Ze.coordinates);break;case"markerClick":{const or=Zt==null?void 0:Zt.find(Nt=>Nt.id===Ze.id);or&&_r(or)}break;case"markerMouseEnter":Or&&r(15,Me=Ae?(Zt==null?void 0:Zt.findIndex(or=>or.id===Ze.id))??-1:-1);break;case"markerMouseLeave":Or&&r(15,Me=-1);break}}),t.$$.dirty[0]&40960&&r(66,s=Zt==null?void 0:Zt[Me]),t.$$.dirty[1]&66592|t.$$.dirty[2]&16&&se&&s&&te&&at&&se.flyTo(s.center,Kt(s)),t.$$.dirty[1]&8192&&r(68,n=Re==="full-geometry-including-polygon-center-marker"),t.$$.dirty[1]&132096|t.$$.dirty[2]&64&&(_t||se==null||se.setFeatures(void 0,void 0,n)),t.$$.dirty[0]&16384|t.$$.dirty[1]&132096|t.$$.dirty[2]&84&&se&&_t&&!Or&&(se.setFeatures(s?[s]:void 0,St,n),se.setSelectedMarker(s?0:-1)),t.$$.dirty[0]&16384|t.$$.dirty[1]&1024|t.$$.dirty[2]&68&&se&&se.setFeatures(Or,St,n),t.$$.dirty[0]&32768|t.$$.dirty[1]&1024|t.$$.dirty[2]&4&&Or&&se&&se.setSelectedMarker(Me),t.$$.dirty[0]&2|t.$$.dirty[1]&1024&&se){const Ze=Qe(ve);se.setReverseMarker(Ze?[Ze.decimalLongitude,Ze.decimalLatitude]:void 0)}t.$$.dirty[2]&16&&He("select",{feature:s}),t.$$.dirty[0]&16384&&He("pick",{feature:St}),t.$$.dirty[0]&73744&&r(67,c=!!(Zt!=null&&Zt.length)&&(Ae||I)),t.$$.dirty[2]&32&&He("optionsvisibilitychange",{optionsVisible:c}),t.$$.dirty[0]&8192&&He("featureslisted",{features:Zt}),t.$$.dirty[2]&4&&He("featuresmarked",{features:Or}),t.$$.dirty[0]&1&&He("reversetoggle",{reverse:Se}),t.$$.dirty[0]&2&&He("querychange",{query:ve}),t.$$.dirty[0]&1|t.$$.dirty[1]&1024&&se&&se.indicateReverse(Se)},[Se,ve,y,P,I,L,j,W,he,ye,fe,$e,Nr,Zt,St,Me,Ae,Be,Br,ne,de,ze,nt,lt,Dt,_r,xr,kr,m,v,T,A,O,R,z,Z,te,ie,V,q,ce,se,ue,xe,Re,Xe,st,at,_t,Ct,Ht,ir,yr,vt,Et,Rt,Ft,Zr,Kr,Ar,Gn,Nn,xi,rn,Or,Oe,s,c,n,a,l,Vr,tr,zr,Tr,ot,Ds,Bi,$i,Tn,dt,er,Yt,Vi]}let Sae=class extends Gu{constructor(t){super(),Uu(this,t,wae,bae,Vu,{ZOOM_DEFAULTS:28,class:2,apiKey:29,bbox:30,clearButtonTitle:3,clearOnBlur:31,clearListOnPick:32,keepListOpen:4,collapsed:5,country:33,debounceSearch:34,enableReverse:6,errorMessage:7,filter:35,flyTo:36,fuzzyMatch:37,language:38,limit:39,reverseGeocodingLimit:40,mapController:41,minLength:42,noResultsMessage:8,placeholder:9,proximity:43,reverseActive:0,reverseButtonTitle:10,searchValue:1,pickedResultStyle:44,showPlaceType:11,showResultsWhileTyping:45,selectFirst:46,flyToSelected:47,markerOnSelected:48,types:49,reverseGeocodingTypes:50,exhaustiveReverseGeocoding:51,excludeTypes:52,reverseGeocodingExcludeTypes:53,zoom:54,apiUrl:55,fetchParameters:56,iconsBaseUrl:12,adjustUrlQuery:57,adjustUrl:58,focus:59,blur:60,setQuery:61,clearList:62,clearMap:63},null,[-1,-1,-1,-1])}get ZOOM_DEFAULTS(){return this.$$.ctx[28]}get focus(){return this.$$.ctx[59]}get blur(){return this.$$.ctx[60]}get setQuery(){return this.$$.ctx[61]}get clearList(){return this.$$.ctx[62]}get clearMap(){return this.$$.ctx[63]}};function P0(t,e,r={}){const n={type:"Feature"};return(r.id===0||r.id)&&(n.id=r.id),r.bbox&&(n.bbox=r.bbox),n.properties=e||{},n.geometry=t,n}function vA(t,e,r={}){for(const n of t){if(n.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");if(n[n.length-1].length!==n[0].length)throw new Error("First and last Position are not equivalent.");for(let s=0;s<n[n.length-1].length;s++)if(n[n.length-1][s]!==n[0][s])throw new Error("First and last Position are not equivalent.")}return P0({type:"Polygon",coordinates:t},e,r)}function A0(t,e={}){const r={type:"FeatureCollection"};return e.id&&(r.id=e.id),e.bbox&&(r.bbox=e.bbox),r.features=t,r}function o6(t,e,r={}){return P0({type:"MultiPolygon",coordinates:t},e,r)}var Tae=/^-?(?:\d+(?:\.\d*)?|\.\d+)(?:e[+-]?\d+)?$/i,yS=Math.ceil,Bo=Math.floor,Vs="[BigNumber Error] ",ZL=Vs+"Number primitive has more than 15 significant digits: ",fa=1e14,sr=14,KL=9007199254740991,_S=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8,1e9,1e10,1e11,1e12,1e13],Hc=1e7,mo=1e9;function a6(t){var e,r,n,s=z.prototype={constructor:z,toString:null,valueOf:null},c=new z(1),l=20,a=4,m=-7,y=21,v=-1e7,T=1e7,P=!1,A=1,O=0,I={prefix:"",groupSize:3,secondaryGroupSize:0,groupSeparator:",",decimalSeparator:".",fractionGroupSize:0,fractionGroupSeparator:"",suffix:""},L="0123456789abcdefghijklmnopqrstuvwxyz",R=!0;function z(V,q){var Q,ce,se,ue,he,ye,xe,Se,fe=this;if(!(fe instanceof z))return new z(V,q);if(q==null){if(V&&V._isBigNumber===!0){fe.s=V.s,!V.c||V.e>T?fe.c=fe.e=null:V.e<v?fe.c=[fe.e=0]:(fe.e=V.e,fe.c=V.c.slice());return}if((ye=typeof V=="number")&&V*0==0){if(fe.s=1/V<0?(V=-V,-1):1,V===~~V){for(ue=0,he=V;he>=10;he/=10,ue++);ue>T?fe.c=fe.e=null:(fe.e=ue,fe.c=[V]);return}Se=String(V)}else{if(!Tae.test(Se=String(V)))return n(fe,Se,ye);fe.s=Se.charCodeAt(0)==45?(Se=Se.slice(1),-1):1}(ue=Se.indexOf("."))>-1&&(Se=Se.replace(".","")),(he=Se.search(/e/i))>0?(ue<0&&(ue=he),ue+=+Se.slice(he+1),Se=Se.substring(0,he)):ue<0&&(ue=Se.length)}else{if(kn(q,2,L.length,"Base"),q==10&&R)return fe=new z(V),te(fe,l+fe.e+1,a);if(Se=String(V),ye=typeof V=="number"){if(V*0!=0)return n(fe,Se,ye,q);if(fe.s=1/V<0?(Se=Se.slice(1),-1):1,z.DEBUG&&Se.replace(/^0\.0*|\./,"").length>15)throw Error(ZL+V)}else fe.s=Se.charCodeAt(0)===45?(Se=Se.slice(1),-1):1;for(Q=L.slice(0,q),ue=he=0,xe=Se.length;he<xe;he++)if(Q.indexOf(ce=Se.charAt(he))<0){if(ce=="."){if(he>ue){ue=xe;continue}}else if(!se&&(Se==Se.toUpperCase()&&(Se=Se.toLowerCase())||Se==Se.toLowerCase()&&(Se=Se.toUpperCase()))){se=!0,he=-1,ue=0;continue}return n(fe,String(V),ye,q)}ye=!1,Se=r(Se,q,10,fe.s),(ue=Se.indexOf("."))>-1?Se=Se.replace(".",""):ue=Se.length}for(he=0;Se.charCodeAt(he)===48;he++);for(xe=Se.length;Se.charCodeAt(--xe)===48;);if(Se=Se.slice(he,++xe)){if(xe-=he,ye&&z.DEBUG&&xe>15&&(V>KL||V!==Bo(V)))throw Error(ZL+fe.s*V);if((ue=ue-he-1)>T)fe.c=fe.e=null;else if(ue<v)fe.c=[fe.e=0];else{if(fe.e=ue,fe.c=[],he=(ue+1)%sr,ue<0&&(he+=sr),he<xe){for(he&&fe.c.push(+Se.slice(0,he)),xe-=sr;he<xe;)fe.c.push(+Se.slice(he,he+=sr));he=sr-(Se=Se.slice(he)).length}else he-=xe;for(;he--;Se+="0");fe.c.push(+Se)}}else fe.c=[fe.e=0]}z.clone=a6,z.ROUND_UP=0,z.ROUND_DOWN=1,z.ROUND_CEIL=2,z.ROUND_FLOOR=3,z.ROUND_HALF_UP=4,z.ROUND_HALF_DOWN=5,z.ROUND_HALF_EVEN=6,z.ROUND_HALF_CEIL=7,z.ROUND_HALF_FLOOR=8,z.EUCLID=9,z.config=z.set=function(V){var q,Q;if(V!=null)if(typeof V=="object"){if(V.hasOwnProperty(q="DECIMAL_PLACES")&&(Q=V[q],kn(Q,0,mo,q),l=Q),V.hasOwnProperty(q="ROUNDING_MODE")&&(Q=V[q],kn(Q,0,8,q),a=Q),V.hasOwnProperty(q="EXPONENTIAL_AT")&&(Q=V[q],Q&&Q.pop?(kn(Q[0],-1e9,0,q),kn(Q[1],0,mo,q),m=Q[0],y=Q[1]):(kn(Q,-1e9,mo,q),m=-(y=Q<0?-Q:Q))),V.hasOwnProperty(q="RANGE"))if(Q=V[q],Q&&Q.pop)kn(Q[0],-1e9,-1,q),kn(Q[1],1,mo,q),v=Q[0],T=Q[1];else if(kn(Q,-1e9,mo,q),Q)v=-(T=Q<0?-Q:Q);else throw Error(Vs+q+" cannot be zero: "+Q);if(V.hasOwnProperty(q="CRYPTO"))if(Q=V[q],Q===!!Q)if(Q)if(typeof crypto<"u"&&crypto&&(crypto.getRandomValues||crypto.randomBytes))P=Q;else throw P=!Q,Error(Vs+"crypto unavailable");else P=Q;else throw Error(Vs+q+" not true or false: "+Q);if(V.hasOwnProperty(q="MODULO_MODE")&&(Q=V[q],kn(Q,0,9,q),A=Q),V.hasOwnProperty(q="POW_PRECISION")&&(Q=V[q],kn(Q,0,mo,q),O=Q),V.hasOwnProperty(q="FORMAT"))if(Q=V[q],typeof Q=="object")I=Q;else throw Error(Vs+q+" not an object: "+Q);if(V.hasOwnProperty(q="ALPHABET"))if(Q=V[q],typeof Q=="string"&&!/^.?$|[+\-.\s]|(.).*\1/.test(Q))R=Q.slice(0,10)=="0123456789",L=Q;else throw Error(Vs+q+" invalid: "+Q)}else throw Error(Vs+"Object expected: "+V);return{DECIMAL_PLACES:l,ROUNDING_MODE:a,EXPONENTIAL_AT:[m,y],RANGE:[v,T],CRYPTO:P,MODULO_MODE:A,POW_PRECISION:O,FORMAT:I,ALPHABET:L}},z.isBigNumber=function(V){if(!V||V._isBigNumber!==!0)return!1;if(!z.DEBUG)return!0;var q,Q,ce=V.c,se=V.e,ue=V.s;e:if({}.toString.call(ce)=="[object Array]"){if((ue===1||ue===-1)&&se>=-1e9&&se<=mo&&se===Bo(se)){if(ce[0]===0){if(se===0&&ce.length===1)return!0;break e}if(q=(se+1)%sr,q<1&&(q+=sr),String(ce[0]).length==q){for(q=0;q<ce.length;q++)if(Q=ce[q],Q<0||Q>=fa||Q!==Bo(Q))break e;if(Q!==0)return!0}}}else if(ce===null&&se===null&&(ue===null||ue===1||ue===-1))return!0;throw Error(Vs+"Invalid BigNumber: "+V)},z.maximum=z.max=function(){return W(arguments,-1)},z.minimum=z.min=function(){return W(arguments,1)},z.random=function(){var V=9007199254740992,q=Math.random()*V&2097151?function(){return Bo(Math.random()*V)}:function(){return(Math.random()*1073741824|0)*8388608+(Math.random()*8388608|0)};return function(Q){var ce,se,ue,he,ye,xe=0,Se=[],fe=new z(c);if(Q==null?Q=l:kn(Q,0,mo),he=yS(Q/sr),P)if(crypto.getRandomValues){for(ce=crypto.getRandomValues(new Uint32Array(he*=2));xe<he;)ye=ce[xe]*131072+(ce[xe+1]>>>11),ye>=9e15?(se=crypto.getRandomValues(new Uint32Array(2)),ce[xe]=se[0],ce[xe+1]=se[1]):(Se.push(ye%1e14),xe+=2);xe=he/2}else if(crypto.randomBytes){for(ce=crypto.randomBytes(he*=7);xe<he;)ye=(ce[xe]&31)*281474976710656+ce[xe+1]*1099511627776+ce[xe+2]*4294967296+ce[xe+3]*16777216+(ce[xe+4]<<16)+(ce[xe+5]<<8)+ce[xe+6],ye>=9e15?crypto.randomBytes(7).copy(ce,xe):(Se.push(ye%1e14),xe+=7);xe=he/7}else throw P=!1,Error(Vs+"crypto unavailable");if(!P)for(;xe<he;)ye=q(),ye<9e15&&(Se[xe++]=ye%1e14);for(he=Se[--xe],Q%=sr,he&&Q&&(ye=_S[sr-Q],Se[xe]=Bo(he/ye)*ye);Se[xe]===0;Se.pop(),xe--);if(xe<0)Se=[ue=0];else{for(ue=-1;Se[0]===0;Se.splice(0,1),ue-=sr);for(xe=1,ye=Se[0];ye>=10;ye/=10,xe++);xe<sr&&(ue-=sr-xe)}return fe.e=ue,fe.c=Se,fe}}(),z.sum=function(){for(var V=1,q=arguments,Q=new z(q[0]);V<q.length;)Q=Q.plus(q[V++]);return Q},r=function(){var V="0123456789";function q(Q,ce,se,ue){for(var he,ye=[0],xe,Se=0,fe=Q.length;Se<fe;){for(xe=ye.length;xe--;ye[xe]*=ce);for(ye[0]+=ue.indexOf(Q.charAt(Se++)),he=0;he<ye.length;he++)ye[he]>se-1&&(ye[he+1]==null&&(ye[he+1]=0),ye[he+1]+=ye[he]/se|0,ye[he]%=se)}return ye.reverse()}return function(Q,ce,se,ue,he){var ye,xe,Se,fe,ve,Re,$e,Xe,st=Q.indexOf("."),at=l,_t=a;for(st>=0&&(fe=O,O=0,Q=Q.replace(".",""),Xe=new z(ce),Re=Xe.pow(Q.length-st),O=fe,Xe.c=q($l(Fo(Re.c),Re.e,"0"),10,se,V),Xe.e=Xe.c.length),$e=q(Q,ce,se,he?(ye=L,V):(ye=V,L)),Se=fe=$e.length;$e[--fe]==0;$e.pop());if(!$e[0])return ye.charAt(0);if(st<0?--Se:(Re.c=$e,Re.e=Se,Re.s=ue,Re=e(Re,Xe,at,_t,se),$e=Re.c,ve=Re.r,Se=Re.e),xe=Se+at+1,st=$e[xe],fe=se/2,ve=ve||xe<0||$e[xe+1]!=null,ve=_t<4?(st!=null||ve)&&(_t==0||_t==(Re.s<0?3:2)):st>fe||st==fe&&(_t==4||ve||_t==6&&$e[xe-1]&1||_t==(Re.s<0?8:7)),xe<1||!$e[0])Q=ve?$l(ye.charAt(1),-at,ye.charAt(0)):ye.charAt(0);else{if($e.length=xe,ve)for(--se;++$e[--xe]>se;)$e[xe]=0,xe||(++Se,$e=[1].concat($e));for(fe=$e.length;!$e[--fe];);for(st=0,Q="";st<=fe;Q+=ye.charAt($e[st++]));Q=$l(Q,Se,ye.charAt(0))}return Q}}(),e=function(){function V(ce,se,ue){var he,ye,xe,Se,fe=0,ve=ce.length,Re=se%Hc,$e=se/Hc|0;for(ce=ce.slice();ve--;)xe=ce[ve]%Hc,Se=ce[ve]/Hc|0,he=$e*xe+Se*Re,ye=Re*xe+he%Hc*Hc+fe,fe=(ye/ue|0)+(he/Hc|0)+$e*Se,ce[ve]=ye%ue;return fe&&(ce=[fe].concat(ce)),ce}function q(ce,se,ue,he){var ye,xe;if(ue!=he)xe=ue>he?1:-1;else for(ye=xe=0;ye<ue;ye++)if(ce[ye]!=se[ye]){xe=ce[ye]>se[ye]?1:-1;break}return xe}function Q(ce,se,ue,he){for(var ye=0;ue--;)ce[ue]-=ye,ye=ce[ue]<se[ue]?1:0,ce[ue]=ye*he+ce[ue]-se[ue];for(;!ce[0]&&ce.length>1;ce.splice(0,1));}return function(ce,se,ue,he,ye){var xe,Se,fe,ve,Re,$e,Xe,st,at,_t,Ct,Pt,Ht,ir,yr,$t,vt,Et=ce.s==se.s?1:-1,Rt=ce.c,Ft=se.c;if(!Rt||!Rt[0]||!Ft||!Ft[0])return new z(!ce.s||!se.s||(Rt?Ft&&Rt[0]==Ft[0]:!Ft)?NaN:Rt&&Rt[0]==0||!Ft?Et*0:Et/0);for(st=new z(Et),at=st.c=[],Se=ce.e-se.e,Et=ue+Se+1,ye||(ye=fa,Se=$o(ce.e/sr)-$o(se.e/sr),Et=Et/sr|0),fe=0;Ft[fe]==(Rt[fe]||0);fe++);if(Ft[fe]>(Rt[fe]||0)&&Se--,Et<0)at.push(1),ve=!0;else{for(ir=Rt.length,$t=Ft.length,fe=0,Et+=2,Re=Bo(ye/(Ft[0]+1)),Re>1&&(Ft=V(Ft,Re,ye),Rt=V(Rt,Re,ye),$t=Ft.length,ir=Rt.length),Ht=$t,_t=Rt.slice(0,$t),Ct=_t.length;Ct<$t;_t[Ct++]=0);vt=Ft.slice(),vt=[0].concat(vt),yr=Ft[0],Ft[1]>=ye/2&&yr++;do{if(Re=0,xe=q(Ft,_t,$t,Ct),xe<0){if(Pt=_t[0],$t!=Ct&&(Pt=Pt*ye+(_t[1]||0)),Re=Bo(Pt/yr),Re>1)for(Re>=ye&&(Re=ye-1),$e=V(Ft,Re,ye),Xe=$e.length,Ct=_t.length;q($e,_t,Xe,Ct)==1;)Re--,Q($e,$t<Xe?vt:Ft,Xe,ye),Xe=$e.length,xe=1;else Re==0&&(xe=Re=1),$e=Ft.slice(),Xe=$e.length;if(Xe<Ct&&($e=[0].concat($e)),Q(_t,$e,Ct,ye),Ct=_t.length,xe==-1)for(;q(Ft,_t,$t,Ct)<1;)Re++,Q(_t,$t<Ct?vt:Ft,Ct,ye),Ct=_t.length}else xe===0&&(Re++,_t=[0]);at[fe++]=Re,_t[0]?_t[Ct++]=Rt[Ht]||0:(_t=[Rt[Ht]],Ct=1)}while((Ht++<ir||_t[0]!=null)&&Et--);ve=_t[0]!=null,at[0]||at.splice(0,1)}if(ye==fa){for(fe=1,Et=at[0];Et>=10;Et/=10,fe++);te(st,ue+(st.e=fe+Se*sr-1)+1,he,ve)}else st.e=Se,st.r=+ve;return st}}();function j(V,q,Q,ce){var se,ue,he,ye,xe;if(Q==null?Q=a:kn(Q,0,8),!V.c)return V.toString();if(se=V.c[0],he=V.e,q==null)xe=Fo(V.c),xe=ce==1||ce==2&&(he<=m||he>=y)?tx(xe,he):$l(xe,he,"0");else if(V=te(new z(V),q,Q),ue=V.e,xe=Fo(V.c),ye=xe.length,ce==1||ce==2&&(q<=ue||ue<=m)){for(;ye<q;xe+="0",ye++);xe=tx(xe,ue)}else if(q-=he,xe=$l(xe,ue,"0"),ue+1>ye){if(--q>0)for(xe+=".";q--;xe+="0");}else if(q+=ue-ye,q>0)for(ue+1==ye&&(xe+=".");q--;xe+="0");return V.s<0&&se?"-"+xe:xe}function W(V,q){for(var Q,ce,se=1,ue=new z(V[0]);se<V.length;se++)ce=new z(V[se]),(!ce.s||(Q=zh(ue,ce))===q||Q===0&&ue.s===q)&&(ue=ce);return ue}function Z(V,q,Q){for(var ce=1,se=q.length;!q[--se];q.pop());for(se=q[0];se>=10;se/=10,ce++);return(Q=ce+Q*sr-1)>T?V.c=V.e=null:Q<v?V.c=[V.e=0]:(V.e=Q,V.c=q),V}n=function(){var V=/^(-?)0([xbo])(?=\w[\w.]*$)/i,q=/^([^.]+)\.$/,Q=/^\.([^.]+)$/,ce=/^-?(Infinity|NaN)$/,se=/^\s*\+(?=[\w.])|^\s+|\s+$/g;return function(ue,he,ye,xe){var Se,fe=ye?he:he.replace(se,"");if(ce.test(fe))ue.s=isNaN(fe)?null:fe<0?-1:1;else{if(!ye&&(fe=fe.replace(V,function(ve,Re,$e){return Se=($e=$e.toLowerCase())=="x"?16:$e=="b"?2:8,!xe||xe==Se?Re:ve}),xe&&(Se=xe,fe=fe.replace(q,"$1").replace(Q,"0.$1")),he!=fe))return new z(fe,Se);if(z.DEBUG)throw Error(Vs+"Not a"+(xe?" base "+xe:"")+" number: "+he);ue.s=null}ue.c=ue.e=null}}();function te(V,q,Q,ce){var se,ue,he,ye,xe,Se,fe,ve=V.c,Re=_S;if(ve){e:{for(se=1,ye=ve[0];ye>=10;ye/=10,se++);if(ue=q-se,ue<0)ue+=sr,he=q,xe=ve[Se=0],fe=Bo(xe/Re[se-he-1]%10);else if(Se=yS((ue+1)/sr),Se>=ve.length)if(ce){for(;ve.length<=Se;ve.push(0));xe=fe=0,se=1,ue%=sr,he=ue-sr+1}else break e;else{for(xe=ye=ve[Se],se=1;ye>=10;ye/=10,se++);ue%=sr,he=ue-sr+se,fe=he<0?0:Bo(xe/Re[se-he-1]%10)}if(ce=ce||q<0||ve[Se+1]!=null||(he<0?xe:xe%Re[se-he-1]),ce=Q<4?(fe||ce)&&(Q==0||Q==(V.s<0?3:2)):fe>5||fe==5&&(Q==4||ce||Q==6&&(ue>0?he>0?xe/Re[se-he]:0:ve[Se-1])%10&1||Q==(V.s<0?8:7)),q<1||!ve[0])return ve.length=0,ce?(q-=V.e+1,ve[0]=Re[(sr-q%sr)%sr],V.e=-q||0):ve[0]=V.e=0,V;if(ue==0?(ve.length=Se,ye=1,Se--):(ve.length=Se+1,ye=Re[sr-ue],ve[Se]=he>0?Bo(xe/Re[se-he]%Re[he])*ye:0),ce)for(;;)if(Se==0){for(ue=1,he=ve[0];he>=10;he/=10,ue++);for(he=ve[0]+=ye,ye=1;he>=10;he/=10,ye++);ue!=ye&&(V.e++,ve[0]==fa&&(ve[0]=1));break}else{if(ve[Se]+=ye,ve[Se]!=fa)break;ve[Se--]=0,ye=1}for(ue=ve.length;ve[--ue]===0;ve.pop());}V.e>T?V.c=V.e=null:V.e<v&&(V.c=[V.e=0])}return V}function ie(V){var q,Q=V.e;return Q===null?V.toString():(q=Fo(V.c),q=Q<=m||Q>=y?tx(q,Q):$l(q,Q,"0"),V.s<0?"-"+q:q)}return s.absoluteValue=s.abs=function(){var V=new z(this);return V.s<0&&(V.s=1),V},s.comparedTo=function(V,q){return zh(this,new z(V,q))},s.decimalPlaces=s.dp=function(V,q){var Q,ce,se,ue=this;if(V!=null)return kn(V,0,mo),q==null?q=a:kn(q,0,8),te(new z(ue),V+ue.e+1,q);if(!(Q=ue.c))return null;if(ce=((se=Q.length-1)-$o(this.e/sr))*sr,se=Q[se])for(;se%10==0;se/=10,ce--);return ce<0&&(ce=0),ce},s.dividedBy=s.div=function(V,q){return e(this,new z(V,q),l,a)},s.dividedToIntegerBy=s.idiv=function(V,q){return e(this,new z(V,q),0,1)},s.exponentiatedBy=s.pow=function(V,q){var Q,ce,se,ue,he,ye,xe,Se,fe,ve=this;if(V=new z(V),V.c&&!V.isInteger())throw Error(Vs+"Exponent not an integer: "+ie(V));if(q!=null&&(q=new z(q)),ye=V.e>14,!ve.c||!ve.c[0]||ve.c[0]==1&&!ve.e&&ve.c.length==1||!V.c||!V.c[0])return fe=new z(Math.pow(+ie(ve),ye?V.s*(2-ex(V)):+ie(V))),q?fe.mod(q):fe;if(xe=V.s<0,q){if(q.c?!q.c[0]:!q.s)return new z(NaN);ce=!xe&&ve.isInteger()&&q.isInteger(),ce&&(ve=ve.mod(q))}else{if(V.e>9&&(ve.e>0||ve.e<-1||(ve.e==0?ve.c[0]>1||ye&&ve.c[1]>=24e7:ve.c[0]<8e13||ye&&ve.c[0]<=9999975e7)))return ue=ve.s<0&&ex(V)?-0:0,ve.e>-1&&(ue=1/ue),new z(xe?1/ue:ue);O&&(ue=yS(O/sr+2))}for(ye?(Q=new z(.5),xe&&(V.s=1),Se=ex(V)):(se=Math.abs(+ie(V)),Se=se%2),fe=new z(c);;){if(Se){if(fe=fe.times(ve),!fe.c)break;ue?fe.c.length>ue&&(fe.c.length=ue):ce&&(fe=fe.mod(q))}if(se){if(se=Bo(se/2),se===0)break;Se=se%2}else if(V=V.times(Q),te(V,V.e+1,1),V.e>14)Se=ex(V);else{if(se=+ie(V),se===0)break;Se=se%2}ve=ve.times(ve),ue?ve.c&&ve.c.length>ue&&(ve.c.length=ue):ce&&(ve=ve.mod(q))}return ce?fe:(xe&&(fe=c.div(fe)),q?fe.mod(q):ue?te(fe,O,a,he):fe)},s.integerValue=function(V){var q=new z(this);return V==null?V=a:kn(V,0,8),te(q,q.e+1,V)},s.isEqualTo=s.eq=function(V,q){return zh(this,new z(V,q))===0},s.isFinite=function(){return!!this.c},s.isGreaterThan=s.gt=function(V,q){return zh(this,new z(V,q))>0},s.isGreaterThanOrEqualTo=s.gte=function(V,q){return(q=zh(this,new z(V,q)))===1||q===0},s.isInteger=function(){return!!this.c&&$o(this.e/sr)>this.c.length-2},s.isLessThan=s.lt=function(V,q){return zh(this,new z(V,q))<0},s.isLessThanOrEqualTo=s.lte=function(V,q){return(q=zh(this,new z(V,q)))===-1||q===0},s.isNaN=function(){return!this.s},s.isNegative=function(){return this.s<0},s.isPositive=function(){return this.s>0},s.isZero=function(){return!!this.c&&this.c[0]==0},s.minus=function(V,q){var Q,ce,se,ue,he=this,ye=he.s;if(V=new z(V,q),q=V.s,!ye||!q)return new z(NaN);if(ye!=q)return V.s=-q,he.plus(V);var xe=he.e/sr,Se=V.e/sr,fe=he.c,ve=V.c;if(!xe||!Se){if(!fe||!ve)return fe?(V.s=-q,V):new z(ve?he:NaN);if(!fe[0]||!ve[0])return ve[0]?(V.s=-q,V):new z(fe[0]?he:a==3?-0:0)}if(xe=$o(xe),Se=$o(Se),fe=fe.slice(),ye=xe-Se){for((ue=ye<0)?(ye=-ye,se=fe):(Se=xe,se=ve),se.reverse(),q=ye;q--;se.push(0));se.reverse()}else for(ce=(ue=(ye=fe.length)<(q=ve.length))?ye:q,ye=q=0;q<ce;q++)if(fe[q]!=ve[q]){ue=fe[q]<ve[q];break}if(ue&&(se=fe,fe=ve,ve=se,V.s=-V.s),q=(ce=ve.length)-(Q=fe.length),q>0)for(;q--;fe[Q++]=0);for(q=fa-1;ce>ye;){if(fe[--ce]<ve[ce]){for(Q=ce;Q&&!fe[--Q];fe[Q]=q);--fe[Q],fe[ce]+=fa}fe[ce]-=ve[ce]}for(;fe[0]==0;fe.splice(0,1),--Se);return fe[0]?Z(V,fe,Se):(V.s=a==3?-1:1,V.c=[V.e=0],V)},s.modulo=s.mod=function(V,q){var Q,ce,se=this;return V=new z(V,q),!se.c||!V.s||V.c&&!V.c[0]?new z(NaN):!V.c||se.c&&!se.c[0]?new z(se):(A==9?(ce=V.s,V.s=1,Q=e(se,V,0,3),V.s=ce,Q.s*=ce):Q=e(se,V,0,A),V=se.minus(Q.times(V)),!V.c[0]&&A==1&&(V.s=se.s),V)},s.multipliedBy=s.times=function(V,q){var Q,ce,se,ue,he,ye,xe,Se,fe,ve,Re,$e,Xe,st,at,_t=this,Ct=_t.c,Pt=(V=new z(V,q)).c;if(!Ct||!Pt||!Ct[0]||!Pt[0])return!_t.s||!V.s||Ct&&!Ct[0]&&!Pt||Pt&&!Pt[0]&&!Ct?V.c=V.e=V.s=null:(V.s*=_t.s,!Ct||!Pt?V.c=V.e=null:(V.c=[0],V.e=0)),V;for(ce=$o(_t.e/sr)+$o(V.e/sr),V.s*=_t.s,xe=Ct.length,ve=Pt.length,xe<ve&&(Xe=Ct,Ct=Pt,Pt=Xe,se=xe,xe=ve,ve=se),se=xe+ve,Xe=[];se--;Xe.push(0));for(st=fa,at=Hc,se=ve;--se>=0;){for(Q=0,Re=Pt[se]%at,$e=Pt[se]/at|0,he=xe,ue=se+he;ue>se;)Se=Ct[--he]%at,fe=Ct[he]/at|0,ye=$e*Se+fe*Re,Se=Re*Se+ye%at*at+Xe[ue]+Q,Q=(Se/st|0)+(ye/at|0)+$e*fe,Xe[ue--]=Se%st;Xe[ue]=Q}return Q?++ce:Xe.splice(0,1),Z(V,Xe,ce)},s.negated=function(){var V=new z(this);return V.s=-V.s||null,V},s.plus=function(V,q){var Q,ce=this,se=ce.s;if(V=new z(V,q),q=V.s,!se||!q)return new z(NaN);if(se!=q)return V.s=-q,ce.minus(V);var ue=ce.e/sr,he=V.e/sr,ye=ce.c,xe=V.c;if(!ue||!he){if(!ye||!xe)return new z(se/0);if(!ye[0]||!xe[0])return xe[0]?V:new z(ye[0]?ce:se*0)}if(ue=$o(ue),he=$o(he),ye=ye.slice(),se=ue-he){for(se>0?(he=ue,Q=xe):(se=-se,Q=ye),Q.reverse();se--;Q.push(0));Q.reverse()}for(se=ye.length,q=xe.length,se-q<0&&(Q=xe,xe=ye,ye=Q,q=se),se=0;q;)se=(ye[--q]=ye[q]+xe[q]+se)/fa|0,ye[q]=fa===ye[q]?0:ye[q]%fa;return se&&(ye=[se].concat(ye),++he),Z(V,ye,he)},s.precision=s.sd=function(V,q){var Q,ce,se,ue=this;if(V!=null&&V!==!!V)return kn(V,1,mo),q==null?q=a:kn(q,0,8),te(new z(ue),V,q);if(!(Q=ue.c))return null;if(se=Q.length-1,ce=se*sr+1,se=Q[se]){for(;se%10==0;se/=10,ce--);for(se=Q[0];se>=10;se/=10,ce++);}return V&&ue.e+1>ce&&(ce=ue.e+1),ce},s.shiftedBy=function(V){return kn(V,-9007199254740991,KL),this.times("1e"+V)},s.squareRoot=s.sqrt=function(){var V,q,Q,ce,se,ue=this,he=ue.c,ye=ue.s,xe=ue.e,Se=l+4,fe=new z("0.5");if(ye!==1||!he||!he[0])return new z(!ye||ye<0&&(!he||he[0])?NaN:he?ue:1/0);if(ye=Math.sqrt(+ie(ue)),ye==0||ye==1/0?(q=Fo(he),(q.length+xe)%2==0&&(q+="0"),ye=Math.sqrt(+q),xe=$o((xe+1)/2)-(xe<0||xe%2),ye==1/0?q="5e"+xe:(q=ye.toExponential(),q=q.slice(0,q.indexOf("e")+1)+xe),Q=new z(q)):Q=new z(ye+""),Q.c[0]){for(xe=Q.e,ye=xe+Se,ye<3&&(ye=0);;)if(se=Q,Q=fe.times(se.plus(e(ue,se,Se,1))),Fo(se.c).slice(0,ye)===(q=Fo(Q.c)).slice(0,ye))if(Q.e<xe&&--ye,q=q.slice(ye-3,ye+1),q=="9999"||!ce&&q=="4999"){if(!ce&&(te(se,se.e+l+2,0),se.times(se).eq(ue))){Q=se;break}Se+=4,ye+=4,ce=1}else{(!+q||!+q.slice(1)&&q.charAt(0)=="5")&&(te(Q,Q.e+l+2,1),V=!Q.times(Q).eq(ue));break}}return te(Q,Q.e+l+1,a,V)},s.toExponential=function(V,q){return V!=null&&(kn(V,0,mo),V++),j(this,V,q,1)},s.toFixed=function(V,q){return V!=null&&(kn(V,0,mo),V=V+this.e+1),j(this,V,q)},s.toFormat=function(V,q,Q){var ce,se=this;if(Q==null)V!=null&&q&&typeof q=="object"?(Q=q,q=null):V&&typeof V=="object"?(Q=V,V=q=null):Q=I;else if(typeof Q!="object")throw Error(Vs+"Argument not an object: "+Q);if(ce=se.toFixed(V,q),se.c){var ue,he=ce.split("."),ye=+Q.groupSize,xe=+Q.secondaryGroupSize,Se=Q.groupSeparator||"",fe=he[0],ve=he[1],Re=se.s<0,$e=Re?fe.slice(1):fe,Xe=$e.length;if(xe&&(ue=ye,ye=xe,xe=ue,Xe-=ue),ye>0&&Xe>0){for(ue=Xe%ye||ye,fe=$e.substr(0,ue);ue<Xe;ue+=ye)fe+=Se+$e.substr(ue,ye);xe>0&&(fe+=Se+$e.slice(ue)),Re&&(fe="-"+fe)}ce=ve?fe+(Q.decimalSeparator||"")+((xe=+Q.fractionGroupSize)?ve.replace(new RegExp("\\d{"+xe+"}\\B","g"),"$&"+(Q.fractionGroupSeparator||"")):ve):fe}return(Q.prefix||"")+ce+(Q.suffix||"")},s.toFraction=function(V){var q,Q,ce,se,ue,he,ye,xe,Se,fe,ve,Re,$e=this,Xe=$e.c;if(V!=null&&(ye=new z(V),!ye.isInteger()&&(ye.c||ye.s!==1)||ye.lt(c)))throw Error(Vs+"Argument "+(ye.isInteger()?"out of range: ":"not an integer: ")+ie(ye));if(!Xe)return new z($e);for(q=new z(c),Se=Q=new z(c),ce=xe=new z(c),Re=Fo(Xe),ue=q.e=Re.length-$e.e-1,q.c[0]=_S[(he=ue%sr)<0?sr+he:he],V=!V||ye.comparedTo(q)>0?ue>0?q:Se:ye,he=T,T=1/0,ye=new z(Re),xe.c[0]=0;fe=e(ye,q,0,1),se=Q.plus(fe.times(ce)),se.comparedTo(V)!=1;)Q=ce,ce=se,Se=xe.plus(fe.times(se=Se)),xe=se,q=ye.minus(fe.times(se=q)),ye=se;return se=e(V.minus(Q),ce,0,1),xe=xe.plus(se.times(Se)),Q=Q.plus(se.times(ce)),xe.s=Se.s=$e.s,ue=ue*2,ve=e(Se,ce,ue,a).minus($e).abs().comparedTo(e(xe,Q,ue,a).minus($e).abs())<1?[Se,ce]:[xe,Q],T=he,ve},s.toNumber=function(){return+ie(this)},s.toPrecision=function(V,q){return V!=null&&kn(V,1,mo),j(this,V,q,2)},s.toString=function(V){var q,Q=this,ce=Q.s,se=Q.e;return se===null?ce?(q="Infinity",ce<0&&(q="-"+q)):q="NaN":(V==null?q=se<=m||se>=y?tx(Fo(Q.c),se):$l(Fo(Q.c),se,"0"):V===10&&R?(Q=te(new z(Q),l+se+1,a),q=$l(Fo(Q.c),Q.e,"0")):(kn(V,2,L.length,"Base"),q=r($l(Fo(Q.c),se,"0"),10,V,ce,!0)),ce<0&&Q.c[0]&&(q="-"+q)),q},s.valueOf=s.toJSON=function(){return ie(this)},s._isBigNumber=!0,s[Symbol.toStringTag]="BigNumber",s[Symbol.for("nodejs.util.inspect.custom")]=s.valueOf,t!=null&&z.set(t),z}function $o(t){var e=t|0;return t>0||t===e?e:e-1}function Fo(t){for(var e,r,n=1,s=t.length,c=t[0]+"";n<s;){for(e=t[n++]+"",r=sr-e.length;r--;e="0"+e);c+=e}for(s=c.length;c.charCodeAt(--s)===48;);return c.slice(0,s+1||1)}function zh(t,e){var r,n,s=t.c,c=e.c,l=t.s,a=e.s,m=t.e,y=e.e;if(!l||!a)return null;if(r=s&&!s[0],n=c&&!c[0],r||n)return r?n?0:-a:l;if(l!=a)return l;if(r=l<0,n=m==y,!s||!c)return n?0:!s^r?1:-1;if(!n)return m>y^r?1:-1;for(a=(m=s.length)<(y=c.length)?m:y,l=0;l<a;l++)if(s[l]!=c[l])return s[l]>c[l]^r?1:-1;return m==y?0:m>y^r?1:-1}function kn(t,e,r,n){if(t<e||t>r||t!==Bo(t))throw Error(Vs+(n||"Argument")+(typeof t=="number"?t<e||t>r?" out of range: ":" not an integer: ":" not a primitive number: ")+String(t))}function ex(t){var e=t.c.length-1;return $o(t.e/sr)==e&&t.c[e]%2!=0}function tx(t,e){return(t.length>1?t.charAt(0)+"."+t.slice(1):t)+(e<0?"e":"e+")+e}function $l(t,e,r){var n,s;if(e<0){for(s=r+".";++e;s+=r);t=s+t}else if(n=t.length,++e>n){for(s=r,e-=n;--e;s+=r);t+=s}else e<n&&(t=t.slice(0,e)+"."+t.slice(e));return t}var ul=a6(),Eae=class{constructor(t){Lt(this,"key"),Lt(this,"left",null),Lt(this,"right",null),this.key=t}},Yg=class extends Eae{constructor(t){super(t)}},Cae=class{constructor(){Lt(this,"size",0),Lt(this,"modificationCount",0),Lt(this,"splayCount",0)}splay(t){const e=this.root;if(e==null)return this.compare(t,t),-1;let r=null,n=null,s=null,c=null,l=e;const a=this.compare;let m;for(;;)if(m=a(l.key,t),m>0){let y=l.left;if(y==null||(m=a(y.key,t),m>0&&(l.left=y.right,y.right=l,l=y,y=l.left,y==null)))break;r==null?n=l:r.left=l,r=l,l=y}else if(m<0){let y=l.right;if(y==null||(m=a(y.key,t),m<0&&(l.right=y.left,y.left=l,l=y,y=l.right,y==null)))break;s==null?c=l:s.right=l,s=l,l=y}else break;return s!=null&&(s.right=l.left,l.left=c),r!=null&&(r.left=l.right,l.right=n),this.root!==l&&(this.root=l,this.splayCount++),m}splayMin(t){let e=t,r=e.left;for(;r!=null;){const n=r;e.left=n.right,n.right=e,e=n,r=e.left}return e}splayMax(t){let e=t,r=e.right;for(;r!=null;){const n=r;e.right=n.left,n.left=e,e=n,r=e.right}return e}_delete(t){if(this.root==null||this.splay(t)!=0)return null;let e=this.root;const r=e,n=e.left;if(this.size--,n==null)this.root=e.right;else{const s=e.right;e=this.splayMax(n),e.right=s,this.root=e}return this.modificationCount++,r}addNewRoot(t,e){this.size++,this.modificationCount++;const r=this.root;if(r==null){this.root=t;return}e<0?(t.left=r,t.right=r.right,r.right=null):(t.right=r,t.left=r.left,r.left=null),this.root=t}_first(){const t=this.root;return t==null?null:(this.root=this.splayMin(t),this.root)}_last(){const t=this.root;return t==null?null:(this.root=this.splayMax(t),this.root)}clear(){this.root=null,this.size=0,this.modificationCount++}has(t){return this.validKey(t)&&this.splay(t)==0}defaultCompare(){return(t,e)=>t<e?-1:t>e?1:0}wrap(){return{getRoot:()=>this.root,setRoot:t=>{this.root=t},getSize:()=>this.size,getModificationCount:()=>this.modificationCount,getSplayCount:()=>this.splayCount,setSplayCount:t=>{this.splayCount=t},splay:t=>this.splay(t),has:t=>this.has(t)}}},XL,YL,Ib=class hy extends Cae{constructor(e,r){super(),Lt(this,"root",null),Lt(this,"compare"),Lt(this,"validKey"),Lt(this,XL,"[object Set]"),this.compare=e??this.defaultCompare(),this.validKey=r??(n=>n!=null&&n!=null)}delete(e){return this.validKey(e)?this._delete(e)!=null:!1}deleteAll(e){for(const r of e)this.delete(r)}forEach(e){const r=this[Symbol.iterator]();let n;for(;n=r.next(),!n.done;)e(n.value,n.value,this)}add(e){const r=this.splay(e);return r!=0&&this.addNewRoot(new Yg(e),r),this}addAndReturn(e){const r=this.splay(e);return r!=0&&this.addNewRoot(new Yg(e),r),this.root.key}addAll(e){for(const r of e)this.add(r)}isEmpty(){return this.root==null}isNotEmpty(){return this.root!=null}single(){if(this.size==0)throw"Bad state: No element";if(this.size>1)throw"Bad state: Too many element";return this.root.key}first(){if(this.size==0)throw"Bad state: No element";return this._first().key}last(){if(this.size==0)throw"Bad state: No element";return this._last().key}lastBefore(e){if(e==null)throw"Invalid arguments(s)";if(this.root==null)return null;if(this.splay(e)<0)return this.root.key;let r=this.root.left;if(r==null)return null;let n=r.right;for(;n!=null;)r=n,n=r.right;return r.key}firstAfter(e){if(e==null)throw"Invalid arguments(s)";if(this.root==null)return null;if(this.splay(e)>0)return this.root.key;let r=this.root.right;if(r==null)return null;let n=r.left;for(;n!=null;)r=n,n=r.left;return r.key}retainAll(e){const r=new hy(this.compare,this.validKey),n=this.modificationCount;for(const s of e){if(n!=this.modificationCount)throw"Concurrent modification during iteration.";this.validKey(s)&&this.splay(s)==0&&r.add(this.root.key)}r.size!=this.size&&(this.root=r.root,this.size=r.size,this.modificationCount++)}lookup(e){return!this.validKey(e)||this.splay(e)!=0?null:this.root.key}intersection(e){const r=new hy(this.compare,this.validKey);for(const n of this)e.has(n)&&r.add(n);return r}difference(e){const r=new hy(this.compare,this.validKey);for(const n of this)e.has(n)||r.add(n);return r}union(e){const r=this.clone();return r.addAll(e),r}clone(){const e=new hy(this.compare,this.validKey);return e.size=this.size,e.root=this.copyNode(this.root),e}copyNode(e){if(e==null)return null;function r(s,c){let l,a;do{if(l=s.left,a=s.right,l!=null){const m=new Yg(l.key);c.left=m,r(l,m)}if(a!=null){const m=new Yg(a.key);c.right=m,s=a,c=m}}while(a!=null)}const n=new Yg(e.key);return r(e,n),n}toSet(){return this.clone()}entries(){return new Aae(this.wrap())}keys(){return this[Symbol.iterator]()}values(){return this[Symbol.iterator]()}[(YL=Symbol.iterator,XL=Symbol.toStringTag,YL)](){return new Pae(this.wrap())}},l6=class{constructor(t){Lt(this,"tree"),Lt(this,"path",new Array),Lt(this,"modificationCount",null),Lt(this,"splayCount"),this.tree=t,this.splayCount=t.getSplayCount()}[Symbol.iterator](){return this}next(){return this.moveNext()?{done:!1,value:this.current()}:{done:!0,value:null}}current(){if(!this.path.length)return null;const t=this.path[this.path.length-1];return this.getValue(t)}rebuildPath(t){this.path.splice(0,this.path.length),this.tree.splay(t),this.path.push(this.tree.getRoot()),this.splayCount=this.tree.getSplayCount()}findLeftMostDescendent(t){for(;t!=null;)this.path.push(t),t=t.left}moveNext(){if(this.modificationCount!=this.tree.getModificationCount()){if(this.modificationCount==null){this.modificationCount=this.tree.getModificationCount();let r=this.tree.getRoot();for(;r!=null;)this.path.push(r),r=r.left;return this.path.length>0}throw"Concurrent modification during iteration."}if(!this.path.length)return!1;this.splayCount!=this.tree.getSplayCount()&&this.rebuildPath(this.path[this.path.length-1].key);let t=this.path[this.path.length-1],e=t.right;if(e!=null){for(;e!=null;)this.path.push(e),e=e.left;return!0}for(this.path.pop();this.path.length&&this.path[this.path.length-1].right===t;)t=this.path.pop();return this.path.length>0}},Pae=class extends l6{getValue(t){return t.key}},Aae=class extends l6{getValue(t){return[t.key,t.key]}},c6=t=>()=>t,BE=t=>{const e=t?(r,n)=>n.minus(r).abs().isLessThanOrEqualTo(t):c6(!1);return(r,n)=>e(r,n)?0:r.comparedTo(n)};function kae(t){const e=t?(r,n,s,c,l)=>r.exponentiatedBy(2).isLessThanOrEqualTo(c.minus(n).exponentiatedBy(2).plus(l.minus(s).exponentiatedBy(2)).times(t)):c6(!1);return(r,n,s)=>{const c=r.x,l=r.y,a=s.x,m=s.y,y=l.minus(m).times(n.x.minus(a)).minus(c.minus(a).times(n.y.minus(m)));return e(y,c,l,a,m)?0:y.comparedTo(0)}}var Mae=t=>t,Iae=t=>{if(t){const e=new Ib(BE(t)),r=new Ib(BE(t)),n=(c,l)=>l.addAndReturn(c),s=c=>({x:n(c.x,e),y:n(c.y,r)});return s({x:new ul(0),y:new ul(0)}),s}return Mae},$E=t=>({set:e=>{hc=$E(e)},reset:()=>$E(t),compare:BE(t),snap:Iae(t),orient:kae(t)}),hc=$E(),Qg=(t,e)=>t.ll.x.isLessThanOrEqualTo(e.x)&&e.x.isLessThanOrEqualTo(t.ur.x)&&t.ll.y.isLessThanOrEqualTo(e.y)&&e.y.isLessThanOrEqualTo(t.ur.y),VE=(t,e)=>{if(e.ur.x.isLessThan(t.ll.x)||t.ur.x.isLessThan(e.ll.x)||e.ur.y.isLessThan(t.ll.y)||t.ur.y.isLessThan(e.ll.y))return null;const r=t.ll.x.isLessThan(e.ll.x)?e.ll.x:t.ll.x,n=t.ur.x.isLessThan(e.ur.x)?t.ur.x:e.ur.x,s=t.ll.y.isLessThan(e.ll.y)?e.ll.y:t.ll.y,c=t.ur.y.isLessThan(e.ur.y)?t.ur.y:e.ur.y;return{ll:{x:r,y:s},ur:{x:n,y:c}}},Mx=(t,e)=>t.x.times(e.y).minus(t.y.times(e.x)),u6=(t,e)=>t.x.times(e.x).plus(t.y.times(e.y)),Rb=t=>u6(t,t).sqrt(),Rae=(t,e,r)=>{const n={x:e.x.minus(t.x),y:e.y.minus(t.y)},s={x:r.x.minus(t.x),y:r.y.minus(t.y)};return Mx(s,n).div(Rb(s)).div(Rb(n))},Dae=(t,e,r)=>{const n={x:e.x.minus(t.x),y:e.y.minus(t.y)},s={x:r.x.minus(t.x),y:r.y.minus(t.y)};return u6(s,n).div(Rb(s)).div(Rb(n))},QL=(t,e,r)=>e.y.isZero()?null:{x:t.x.plus(e.x.div(e.y).times(r.minus(t.y))),y:r},JL=(t,e,r)=>e.x.isZero()?null:{x:r,y:t.y.plus(e.y.div(e.x).times(r.minus(t.x)))},Lae=(t,e,r,n)=>{if(e.x.isZero())return JL(r,n,t.x);if(n.x.isZero())return JL(t,e,r.x);if(e.y.isZero())return QL(r,n,t.y);if(n.y.isZero())return QL(t,e,r.y);const s=Mx(e,n);if(s.isZero())return null;const c={x:r.x.minus(t.x),y:r.y.minus(t.y)},l=Mx(c,e).div(s),a=Mx(c,n).div(s),m=t.x.plus(a.times(e.x)),y=r.x.plus(l.times(n.x)),v=t.y.plus(a.times(e.y)),T=r.y.plus(l.times(n.y)),P=m.plus(y).div(2),A=v.plus(T).div(2);return{x:P,y:A}},Ja=class h6{constructor(e,r){Lt(this,"point"),Lt(this,"isLeft"),Lt(this,"segment"),Lt(this,"otherSE"),Lt(this,"consumedBy"),e.events===void 0?e.events=[this]:e.events.push(this),this.point=e,this.isLeft=r}static compare(e,r){const n=h6.comparePoints(e.point,r.point);return n!==0?n:(e.point!==r.point&&e.link(r),e.isLeft!==r.isLeft?e.isLeft?1:-1:Lb.compare(e.segment,r.segment))}static comparePoints(e,r){return e.x.isLessThan(r.x)?-1:e.x.isGreaterThan(r.x)?1:e.y.isLessThan(r.y)?-1:e.y.isGreaterThan(r.y)?1:0}link(e){if(e.point===this.point)throw new Error("Tried to link already linked events");const r=e.point.events;for(let n=0,s=r.length;n<s;n++){const c=r[n];this.point.events.push(c),c.point=this.point}this.checkForConsuming()}checkForConsuming(){const e=this.point.events.length;for(let r=0;r<e;r++){const n=this.point.events[r];if(n.segment.consumedBy===void 0)for(let s=r+1;s<e;s++){const c=this.point.events[s];c.consumedBy===void 0&&n.otherSE.point.events===c.otherSE.point.events&&n.segment.consume(c.segment)}}}getAvailableLinkedEvents(){const e=[];for(let r=0,n=this.point.events.length;r<n;r++){const s=this.point.events[r];s!==this&&!s.segment.ringOut&&s.segment.isInResult()&&e.push(s)}return e}getLeftmostComparator(e){const r=new Map,n=s=>{const c=s.otherSE;r.set(s,{sine:Rae(this.point,e.point,c.point),cosine:Dae(this.point,e.point,c.point)})};return(s,c)=>{r.has(s)||n(s),r.has(c)||n(c);const{sine:l,cosine:a}=r.get(s),{sine:m,cosine:y}=r.get(c);return l.isGreaterThanOrEqualTo(0)&&m.isGreaterThanOrEqualTo(0)?a.isLessThan(y)?1:a.isGreaterThan(y)?-1:0:l.isLessThan(0)&&m.isLessThan(0)?a.isLessThan(y)?-1:a.isGreaterThan(y)?1:0:m.isLessThan(l)?-1:m.isGreaterThan(l)?1:0}}},Oae=class UE{constructor(e){Lt(this,"events"),Lt(this,"poly"),Lt(this,"_isExteriorRing"),Lt(this,"_enclosingRing"),this.events=e;for(let r=0,n=e.length;r<n;r++)e[r].segment.ringOut=this;this.poly=null}static factory(e){const r=[];for(let n=0,s=e.length;n<s;n++){const c=e[n];if(!c.isInResult()||c.ringOut)continue;let l=null,a=c.leftSE,m=c.rightSE;const y=[a],v=a.point,T=[];for(;l=a,a=m,y.push(a),a.point!==v;)for(;;){const P=a.getAvailableLinkedEvents();if(P.length===0){const I=y[0].point,L=y[y.length-1].point;throw new Error(`Unable to complete output ring starting at [${I.x}, ${I.y}]. Last matching segment found ends at [${L.x}, ${L.y}].`)}if(P.length===1){m=P[0].otherSE;break}let A=null;for(let I=0,L=T.length;I<L;I++)if(T[I].point===a.point){A=I;break}if(A!==null){const I=T.splice(A)[0],L=y.splice(I.index);L.unshift(L[0].otherSE),r.push(new UE(L.reverse()));continue}T.push({index:y.length,point:a.point});const O=a.getLeftmostComparator(l);m=P.sort(O)[0].otherSE;break}r.push(new UE(y))}return r}getGeom(){let e=this.events[0].point;const r=[e];for(let y=1,v=this.events.length-1;y<v;y++){const T=this.events[y].point,P=this.events[y+1].point;hc.orient(T,e,P)!==0&&(r.push(T),e=T)}if(r.length===1)return null;const n=r[0],s=r[1];hc.orient(n,e,s)===0&&r.shift(),r.push(r[0]);const c=this.isExteriorRing()?1:-1,l=this.isExteriorRing()?0:r.length-1,a=this.isExteriorRing()?r.length:-1,m=[];for(let y=l;y!=a;y+=c)m.push([r[y].x.toNumber(),r[y].y.toNumber()]);return m}isExteriorRing(){if(this._isExteriorRing===void 0){const e=this.enclosingRing();this._isExteriorRing=e?!e.isExteriorRing():!0}return this._isExteriorRing}enclosingRing(){return this._enclosingRing===void 0&&(this._enclosingRing=this._calcEnclosingRing()),this._enclosingRing}_calcEnclosingRing(){var e,r;let n=this.events[0];for(let l=1,a=this.events.length;l<a;l++){const m=this.events[l];Ja.compare(n,m)>0&&(n=m)}let s=n.segment.prevInResult(),c=s?s.prevInResult():null;for(;;){if(!s)return null;if(!c)return s.ringOut;if(c.ringOut!==s.ringOut)return((e=c.ringOut)==null?void 0:e.enclosingRing())!==s.ringOut?s.ringOut:(r=s.ringOut)==null?void 0:r.enclosingRing();s=c.prevInResult(),c=s?s.prevInResult():null}}},e3=class{constructor(t){Lt(this,"exteriorRing"),Lt(this,"interiorRings"),this.exteriorRing=t,t.poly=this,this.interiorRings=[]}addInterior(t){this.interiorRings.push(t),t.poly=this}getGeom(){const t=this.exteriorRing.getGeom();if(t===null)return null;const e=[t];for(let r=0,n=this.interiorRings.length;r<n;r++){const s=this.interiorRings[r].getGeom();s!==null&&e.push(s)}return e}},zae=class{constructor(t){Lt(this,"rings"),Lt(this,"polys"),this.rings=t,this.polys=this._composePolys(t)}getGeom(){const t=[];for(let e=0,r=this.polys.length;e<r;e++){const n=this.polys[e].getGeom();n!==null&&t.push(n)}return t}_composePolys(t){var e;const r=[];for(let n=0,s=t.length;n<s;n++){const c=t[n];if(!c.poly)if(c.isExteriorRing())r.push(new e3(c));else{const l=c.enclosingRing();l!=null&&l.poly||r.push(new e3(l)),(e=l==null?void 0:l.poly)==null||e.addInterior(c)}}return r}},Nae=class{constructor(t,e=Lb.compare){Lt(this,"queue"),Lt(this,"tree"),Lt(this,"segments"),this.queue=t,this.tree=new Ib(e),this.segments=[]}process(t){const e=t.segment,r=[];if(t.consumedBy)return t.isLeft?this.queue.delete(t.otherSE):this.tree.delete(e),r;t.isLeft&&this.tree.add(e);let n=e,s=e;do n=this.tree.lastBefore(n);while(n!=null&&n.consumedBy!=null);do s=this.tree.firstAfter(s);while(s!=null&&s.consumedBy!=null);if(t.isLeft){let c=null;if(n){const a=n.getIntersection(e);if(a!==null&&(e.isAnEndpoint(a)||(c=a),!n.isAnEndpoint(a))){const m=this._splitSafely(n,a);for(let y=0,v=m.length;y<v;y++)r.push(m[y])}}let l=null;if(s){const a=s.getIntersection(e);if(a!==null&&(e.isAnEndpoint(a)||(l=a),!s.isAnEndpoint(a))){const m=this._splitSafely(s,a);for(let y=0,v=m.length;y<v;y++)r.push(m[y])}}if(c!==null||l!==null){let a=null;c===null?a=l:l===null?a=c:a=Ja.comparePoints(c,l)<=0?c:l,this.queue.delete(e.rightSE),r.push(e.rightSE);const m=e.split(a);for(let y=0,v=m.length;y<v;y++)r.push(m[y])}r.length>0?(this.tree.delete(e),r.push(t)):(this.segments.push(e),e.prev=n)}else{if(n&&s){const c=n.getIntersection(s);if(c!==null){if(!n.isAnEndpoint(c)){const l=this._splitSafely(n,c);for(let a=0,m=l.length;a<m;a++)r.push(l[a])}if(!s.isAnEndpoint(c)){const l=this._splitSafely(s,c);for(let a=0,m=l.length;a<m;a++)r.push(l[a])}}}this.tree.delete(e)}return r}_splitSafely(t,e){this.tree.delete(t);const r=t.rightSE;this.queue.delete(r);const n=t.split(e);return n.push(r),t.consumedBy===void 0&&this.tree.add(t),n}},jae=class{constructor(){Lt(this,"type"),Lt(this,"numMultiPolys")}run(t,e,r){dy.type=t;const n=[new r3(e,!0)];for(let m=0,y=r.length;m<y;m++)n.push(new r3(r[m],!1));if(dy.numMultiPolys=n.length,dy.type==="difference"){const m=n[0];let y=1;for(;y<n.length;)VE(n[y].bbox,m.bbox)!==null?y++:n.splice(y,1)}if(dy.type==="intersection")for(let m=0,y=n.length;m<y;m++){const v=n[m];for(let T=m+1,P=n.length;T<P;T++)if(VE(v.bbox,n[T].bbox)===null)return[]}const s=new Ib(Ja.compare);for(let m=0,y=n.length;m<y;m++){const v=n[m].getSweepEvents();for(let T=0,P=v.length;T<P;T++)s.add(v[T])}const c=new Nae(s);let l=null;for(s.size!=0&&(l=s.first(),s.delete(l));l;){const m=c.process(l);for(let y=0,v=m.length;y<v;y++){const T=m[y];T.consumedBy===void 0&&s.add(T)}s.size!=0?(l=s.first(),s.delete(l)):l=null}hc.reset();const a=Oae.factory(c.segments);return new zae(a).getGeom()}},dy=new jae,Db=dy,Fae=0,Lb=class Ix{constructor(e,r,n,s){Lt(this,"id"),Lt(this,"leftSE"),Lt(this,"rightSE"),Lt(this,"rings"),Lt(this,"windings"),Lt(this,"ringOut"),Lt(this,"consumedBy"),Lt(this,"prev"),Lt(this,"_prevInResult"),Lt(this,"_beforeState"),Lt(this,"_afterState"),Lt(this,"_isInResult"),this.id=++Fae,this.leftSE=e,e.segment=this,e.otherSE=r,this.rightSE=r,r.segment=this,r.otherSE=e,this.rings=n,this.windings=s}static compare(e,r){const n=e.leftSE.point.x,s=r.leftSE.point.x,c=e.rightSE.point.x,l=r.rightSE.point.x;if(l.isLessThan(n))return 1;if(c.isLessThan(s))return-1;const a=e.leftSE.point.y,m=r.leftSE.point.y,y=e.rightSE.point.y,v=r.rightSE.point.y;if(n.isLessThan(s)){if(m.isLessThan(a)&&m.isLessThan(y))return 1;if(m.isGreaterThan(a)&&m.isGreaterThan(y))return-1;const T=e.comparePoint(r.leftSE.point);if(T<0)return 1;if(T>0)return-1;const P=r.comparePoint(e.rightSE.point);return P!==0?P:-1}if(n.isGreaterThan(s)){if(a.isLessThan(m)&&a.isLessThan(v))return-1;if(a.isGreaterThan(m)&&a.isGreaterThan(v))return 1;const T=r.comparePoint(e.leftSE.point);if(T!==0)return T;const P=e.comparePoint(r.rightSE.point);return P<0?1:P>0?-1:1}if(a.isLessThan(m))return-1;if(a.isGreaterThan(m))return 1;if(c.isLessThan(l)){const T=r.comparePoint(e.rightSE.point);if(T!==0)return T}if(c.isGreaterThan(l)){const T=e.comparePoint(r.rightSE.point);if(T<0)return 1;if(T>0)return-1}if(!c.eq(l)){const T=y.minus(a),P=c.minus(n),A=v.minus(m),O=l.minus(s);if(T.isGreaterThan(P)&&A.isLessThan(O))return 1;if(T.isLessThan(P)&&A.isGreaterThan(O))return-1}return c.isGreaterThan(l)?1:c.isLessThan(l)||y.isLessThan(v)?-1:y.isGreaterThan(v)?1:e.id<r.id?-1:e.id>r.id?1:0}static fromRing(e,r,n){let s,c,l;const a=Ja.comparePoints(e,r);if(a<0)s=e,c=r,l=1;else if(a>0)s=r,c=e,l=-1;else throw new Error(`Tried to create degenerate segment at [${e.x}, ${e.y}]`);const m=new Ja(s,!0),y=new Ja(c,!1);return new Ix(m,y,[n],[l])}replaceRightSE(e){this.rightSE=e,this.rightSE.segment=this,this.rightSE.otherSE=this.leftSE,this.leftSE.otherSE=this.rightSE}bbox(){const e=this.leftSE.point.y,r=this.rightSE.point.y;return{ll:{x:this.leftSE.point.x,y:e.isLessThan(r)?e:r},ur:{x:this.rightSE.point.x,y:e.isGreaterThan(r)?e:r}}}vector(){return{x:this.rightSE.point.x.minus(this.leftSE.point.x),y:this.rightSE.point.y.minus(this.leftSE.point.y)}}isAnEndpoint(e){return e.x.eq(this.leftSE.point.x)&&e.y.eq(this.leftSE.point.y)||e.x.eq(this.rightSE.point.x)&&e.y.eq(this.rightSE.point.y)}comparePoint(e){return hc.orient(this.leftSE.point,e,this.rightSE.point)}getIntersection(e){const r=this.bbox(),n=e.bbox(),s=VE(r,n);if(s===null)return null;const c=this.leftSE.point,l=this.rightSE.point,a=e.leftSE.point,m=e.rightSE.point,y=Qg(r,a)&&this.comparePoint(a)===0,v=Qg(n,c)&&e.comparePoint(c)===0,T=Qg(r,m)&&this.comparePoint(m)===0,P=Qg(n,l)&&e.comparePoint(l)===0;if(v&&y)return P&&!T?l:!P&&T?m:null;if(v)return T&&c.x.eq(m.x)&&c.y.eq(m.y)?null:c;if(y)return P&&l.x.eq(a.x)&&l.y.eq(a.y)?null:a;if(P&&T)return null;if(P)return l;if(T)return m;const A=Lae(c,this.vector(),a,e.vector());return A===null||!Qg(s,A)?null:hc.snap(A)}split(e){const r=[],n=e.events!==void 0,s=new Ja(e,!0),c=new Ja(e,!1),l=this.rightSE;this.replaceRightSE(c),r.push(c),r.push(s);const a=new Ix(s,l,this.rings.slice(),this.windings.slice());return Ja.comparePoints(a.leftSE.point,a.rightSE.point)>0&&a.swapEvents(),Ja.comparePoints(this.leftSE.point,this.rightSE.point)>0&&this.swapEvents(),n&&(s.checkForConsuming(),c.checkForConsuming()),r}swapEvents(){const e=this.rightSE;this.rightSE=this.leftSE,this.leftSE=e,this.leftSE.isLeft=!0,this.rightSE.isLeft=!1;for(let r=0,n=this.windings.length;r<n;r++)this.windings[r]*=-1}consume(e){let r=this,n=e;for(;r.consumedBy;)r=r.consumedBy;for(;n.consumedBy;)n=n.consumedBy;const s=Ix.compare(r,n);if(s!==0){if(s>0){const c=r;r=n,n=c}if(r.prev===n){const c=r;r=n,n=c}for(let c=0,l=n.rings.length;c<l;c++){const a=n.rings[c],m=n.windings[c],y=r.rings.indexOf(a);y===-1?(r.rings.push(a),r.windings.push(m)):r.windings[y]+=m}n.rings=null,n.windings=null,n.consumedBy=r,n.leftSE.consumedBy=r.leftSE,n.rightSE.consumedBy=r.rightSE}}prevInResult(){return this._prevInResult!==void 0?this._prevInResult:(this.prev?this.prev.isInResult()?this._prevInResult=this.prev:this._prevInResult=this.prev.prevInResult():this._prevInResult=null,this._prevInResult)}beforeState(){if(this._beforeState!==void 0)return this._beforeState;if(!this.prev)this._beforeState={rings:[],windings:[],multiPolys:[]};else{const e=this.prev.consumedBy||this.prev;this._beforeState=e.afterState()}return this._beforeState}afterState(){if(this._afterState!==void 0)return this._afterState;const e=this.beforeState();this._afterState={rings:e.rings.slice(0),windings:e.windings.slice(0),multiPolys:[]};const r=this._afterState.rings,n=this._afterState.windings,s=this._afterState.multiPolys;for(let a=0,m=this.rings.length;a<m;a++){const y=this.rings[a],v=this.windings[a],T=r.indexOf(y);T===-1?(r.push(y),n.push(v)):n[T]+=v}const c=[],l=[];for(let a=0,m=r.length;a<m;a++){if(n[a]===0)continue;const y=r[a],v=y.poly;if(l.indexOf(v)===-1)if(y.isExterior)c.push(v);else{l.indexOf(v)===-1&&l.push(v);const T=c.indexOf(y.poly);T!==-1&&c.splice(T,1)}}for(let a=0,m=c.length;a<m;a++){const y=c[a].multiPoly;s.indexOf(y)===-1&&s.push(y)}return this._afterState}isInResult(){if(this.consumedBy)return!1;if(this._isInResult!==void 0)return this._isInResult;const e=this.beforeState().multiPolys,r=this.afterState().multiPolys;switch(Db.type){case"union":{const n=e.length===0,s=r.length===0;this._isInResult=n!==s;break}case"intersection":{let n,s;e.length<r.length?(n=e.length,s=r.length):(n=r.length,s=e.length),this._isInResult=s===Db.numMultiPolys&&n<s;break}case"xor":{const n=Math.abs(e.length-r.length);this._isInResult=n%2===1;break}case"difference":{const n=s=>s.length===1&&s[0].isSubject;this._isInResult=n(e)!==n(r);break}}return this._isInResult}},t3=class{constructor(t,e,r){if(Lt(this,"poly"),Lt(this,"isExterior"),Lt(this,"segments"),Lt(this,"bbox"),!Array.isArray(t)||t.length===0)throw new Error("Input geometry is not a valid Polygon or MultiPolygon");if(this.poly=e,this.isExterior=r,this.segments=[],typeof t[0][0]!="number"||typeof t[0][1]!="number")throw new Error("Input geometry is not a valid Polygon or MultiPolygon");const n=hc.snap({x:new ul(t[0][0]),y:new ul(t[0][1])});this.bbox={ll:{x:n.x,y:n.y},ur:{x:n.x,y:n.y}};let s=n;for(let c=1,l=t.length;c<l;c++){if(typeof t[c][0]!="number"||typeof t[c][1]!="number")throw new Error("Input geometry is not a valid Polygon or MultiPolygon");const a=hc.snap({x:new ul(t[c][0]),y:new ul(t[c][1])});a.x.eq(s.x)&&a.y.eq(s.y)||(this.segments.push(Lb.fromRing(s,a,this)),a.x.isLessThan(this.bbox.ll.x)&&(this.bbox.ll.x=a.x),a.y.isLessThan(this.bbox.ll.y)&&(this.bbox.ll.y=a.y),a.x.isGreaterThan(this.bbox.ur.x)&&(this.bbox.ur.x=a.x),a.y.isGreaterThan(this.bbox.ur.y)&&(this.bbox.ur.y=a.y),s=a)}(!n.x.eq(s.x)||!n.y.eq(s.y))&&this.segments.push(Lb.fromRing(s,n,this))}getSweepEvents(){const t=[];for(let e=0,r=this.segments.length;e<r;e++){const n=this.segments[e];t.push(n.leftSE),t.push(n.rightSE)}return t}},Bae=class{constructor(t,e){if(Lt(this,"multiPoly"),Lt(this,"exteriorRing"),Lt(this,"interiorRings"),Lt(this,"bbox"),!Array.isArray(t))throw new Error("Input geometry is not a valid Polygon or MultiPolygon");this.exteriorRing=new t3(t[0],this,!0),this.bbox={ll:{x:this.exteriorRing.bbox.ll.x,y:this.exteriorRing.bbox.ll.y},ur:{x:this.exteriorRing.bbox.ur.x,y:this.exteriorRing.bbox.ur.y}},this.interiorRings=[];for(let r=1,n=t.length;r<n;r++){const s=new t3(t[r],this,!1);s.bbox.ll.x.isLessThan(this.bbox.ll.x)&&(this.bbox.ll.x=s.bbox.ll.x),s.bbox.ll.y.isLessThan(this.bbox.ll.y)&&(this.bbox.ll.y=s.bbox.ll.y),s.bbox.ur.x.isGreaterThan(this.bbox.ur.x)&&(this.bbox.ur.x=s.bbox.ur.x),s.bbox.ur.y.isGreaterThan(this.bbox.ur.y)&&(this.bbox.ur.y=s.bbox.ur.y),this.interiorRings.push(s)}this.multiPoly=e}getSweepEvents(){const t=this.exteriorRing.getSweepEvents();for(let e=0,r=this.interiorRings.length;e<r;e++){const n=this.interiorRings[e].getSweepEvents();for(let s=0,c=n.length;s<c;s++)t.push(n[s])}return t}},r3=class{constructor(t,e){if(Lt(this,"isSubject"),Lt(this,"polys"),Lt(this,"bbox"),!Array.isArray(t))throw new Error("Input geometry is not a valid Polygon or MultiPolygon");try{typeof t[0][0][0]=="number"&&(t=[t])}catch{}this.polys=[],this.bbox={ll:{x:new ul(Number.POSITIVE_INFINITY),y:new ul(Number.POSITIVE_INFINITY)},ur:{x:new ul(Number.NEGATIVE_INFINITY),y:new ul(Number.NEGATIVE_INFINITY)}};for(let r=0,n=t.length;r<n;r++){const s=new Bae(t[r],this);s.bbox.ll.x.isLessThan(this.bbox.ll.x)&&(this.bbox.ll.x=s.bbox.ll.x),s.bbox.ll.y.isLessThan(this.bbox.ll.y)&&(this.bbox.ll.y=s.bbox.ll.y),s.bbox.ur.x.isGreaterThan(this.bbox.ur.x)&&(this.bbox.ur.x=s.bbox.ur.x),s.bbox.ur.y.isGreaterThan(this.bbox.ur.y)&&(this.bbox.ur.y=s.bbox.ur.y),this.polys.push(s)}this.isSubject=e}getSweepEvents(){const t=[];for(let e=0,r=this.polys.length;e<r;e++){const n=this.polys[e].getSweepEvents();for(let s=0,c=n.length;s<c;s++)t.push(n[s])}return t}},$ae=(t,...e)=>Db.run("union",t,e),Vae=(t,...e)=>Db.run("difference",t,e);hc.set;function d6(t,e,r){if(t!==null)for(var n,s,c,l,a,m,y,v=0,T=0,P,A=t.type,O=A==="FeatureCollection",I=A==="Feature",L=O?t.features.length:1,R=0;R<L;R++){y=O?t.features[R].geometry:I?t.geometry:t,P=y?y.type==="GeometryCollection":!1,a=P?y.geometries.length:1;for(var z=0;z<a;z++){var j=0,W=0;if(l=P?y.geometries[z]:y,l!==null){m=l.coordinates;var Z=l.type;switch(v=0,Z){case null:break;case"Point":if(e(m,T,R,j,W)===!1)return!1;T++,j++;break;case"LineString":case"MultiPoint":for(n=0;n<m.length;n++){if(e(m[n],T,R,j,W)===!1)return!1;T++,Z==="MultiPoint"&&j++}Z==="LineString"&&j++;break;case"Polygon":case"MultiLineString":for(n=0;n<m.length;n++){for(s=0;s<m[n].length-v;s++){if(e(m[n][s],T,R,j,W)===!1)return!1;T++}Z==="MultiLineString"&&j++,Z==="Polygon"&&W++}Z==="Polygon"&&j++;break;case"MultiPolygon":for(n=0;n<m.length;n++){for(W=0,s=0;s<m[n].length;s++){for(c=0;c<m[n][s].length-v;c++){if(e(m[n][s][c],T,R,j,W)===!1)return!1;T++}W++}j++}break;case"GeometryCollection":for(n=0;n<l.geometries.length;n++)if(d6(l.geometries[n],e)===!1)return!1;break;default:throw new Error("Unknown Geometry Type")}}}}}function xA(t,e){var r,n,s,c,l,a,m,y,v,T,P=0,A=t.type==="FeatureCollection",O=t.type==="Feature",I=A?t.features.length:1;for(r=0;r<I;r++){for(a=A?t.features[r].geometry:O?t.geometry:t,y=A?t.features[r].properties:O?t.properties:{},v=A?t.features[r].bbox:O?t.bbox:void 0,T=A?t.features[r].id:O?t.id:void 0,m=a?a.type==="GeometryCollection":!1,l=m?a.geometries.length:1,s=0;s<l;s++){if(c=m?a.geometries[s]:a,c===null){if(e(null,P,y,v,T)===!1)return!1;continue}switch(c.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":{if(e(c,P,y,v,T)===!1)return!1;break}case"GeometryCollection":{for(n=0;n<c.geometries.length;n++)if(e(c.geometries[n],P,y,v,T)===!1)return!1;break}default:throw new Error("Unknown Geometry Type")}}P++}}function Uae(t,e){xA(t,function(r,n,s,c,l){var a=r===null?null:r.type;switch(a){case null:case"Point":case"LineString":case"Polygon":return e(P0(r,s,{bbox:c,id:l}),n,0)===!1?!1:void 0}var m;switch(a){case"MultiPoint":m="Point";break;case"MultiLineString":m="LineString";break;case"MultiPolygon":m="Polygon";break}for(var y=0;y<r.coordinates.length;y++){var v=r.coordinates[y],T={type:m,coordinates:v};if(e(P0(T,s),n,y)===!1)return!1}})}function Gae(t,e={}){const r=[];if(xA(t,s=>{r.push(s.coordinates)}),r.length<2)throw new Error("Must have at least 2 geometries");const n=$ae(r[0],...r.slice(1));return n.length===0?null:n.length===1?vA(n[0],e.properties):o6(n,e.properties)}var f6=Gae;function Wae(t,e={}){if(t.bbox!=null&&e.recompute!==!0)return t.bbox;const r=[1/0,1/0,-1/0,-1/0];return d6(t,n=>{r[0]>n[0]&&(r[0]=n[0]),r[1]>n[1]&&(r[1]=n[1]),r[2]<n[0]&&(r[2]=n[0]),r[3]<n[1]&&(r[3]=n[1])}),r}var n3=Wae;function qae(t){const e=[];if(xA(t,s=>{e.push(s.coordinates)}),e.length<2)throw new Error("Must have at least two features");const r=t.features[0].properties||{},n=Vae(e[0],...e.slice(1));return n.length===0?null:n.length===1?vA(n[0],r):o6(n,r)}var Hae=qae;function Zae(t){if(!t)throw new Error("geojson is required");var e=[];return Uae(t,function(r){e.push(r)}),A0(e)}var Kae=Zae;function i3(t,e){const r=Hae(A0([vA([[[180,90],[-180,90],[-180,-90],[180,-90],[180,90]]]),t]));if(!r)return;r.properties={isMask:!0};const n=Mb(n3(t)),s=(n[2]-n[0])/360/1e3,c=n[0]<-180,l=n[2]>180,a=Kae(t);if(a.features.length>1&&(c||l))for(const m of a.features){const y=Mb(n3(m));if(l&&y[0]<-180+s)for(const v of m.geometry.coordinates)for(const T of v)T[0]+=360-s;if(c&&y[2]>180-s)for(const v of m.geometry.coordinates)for(const T of v)T[0]-=360-s}e(A0([a.features.length<2?t:f6(a)??t,r]))}const s3={fill:{paint:{"fill-color":"#000","fill-opacity":.1},filter:["all",["==",["geometry-type"],"Polygon"],["has","isMask"]]},line:{layout:{"line-cap":"square"},paint:{"line-width":["case",["==",["geometry-type"],"Polygon"],2,3],"line-dasharray":[1,1],"line-color":"#3170fe"},filter:["!",["has","isMask"]]}},rx="mtlr-gc-full-geom",o3="mtlr-gc-full-geom-fill",a3="mtlr-gc-full-geom-line";function Xae(t,e,r=!0,n=!0,s={},c={},l=s3){let a;const m=[];let y,v,T;function P(){if(!t.loaded){t.once("load",P);return}const L=l?l===!0?s3:l:void 0;if(!(L!=null&&L.fill)&&!(L!=null&&L.line))return;const R=t.getSource(rx);if(R)R.setData(T??A0([]));else if(T)t.addSource(rx,{type:"geojson",data:T});else return;!t.getLayer(o3)&&L!=null&&L.fill&&t.addLayer({...L==null?void 0:L.fill,id:o3,type:"fill",source:rx}),!t.getLayer(a3)&&L!=null&&L.line&&t.addLayer({...L==null?void 0:L.line,id:a3,type:"line",source:rx})}function A(L){T=L,P()}t.on("styledata",()=>{setTimeout(()=>{T&&P()})});const O=L=>{a==null||a({type:"mapClick",coordinates:[L.lngLat.lng,L.lngLat.lat]})};function I(L=!1){if(!e)throw new Error;const R=document.createElement("div");return L&&R.classList.add("marker-interactive"),new Joe({props:{displayIn:"maplibre"},target:R}),new e.Marker({element:R,offset:[1,-13]})}return{setEventHandler(L){L?(a=L,t.on("click",O)):(a=void 0,t.off("click",O))},flyTo(L,R){t.flyTo({center:L,...R?{zoom:R}:{},...s})},fitBounds(L,R,z){t.fitBounds([[L[0],L[1]],[L[2],L[3]]],{padding:R,...z?{maxZoom:z}:{},...c})},indicateReverse(L){t.getCanvasContainer().style.cursor=L?"crosshair":""},setReverseMarker(L){!e||!r||(v?L?v.setLngLat(L):(v.remove(),v=void 0):L&&(r instanceof Function?v=r(t)??void 0:(v=(typeof r=="object"?new e.Marker(r):I()).setLngLat(L).addTo(t),v.getElement().classList.add("marker-reverse"))))},setFeatures(L,R,z){for(const j of m)j.remove();if(m.length=0,A(void 0),!!e){e:if(R){let j=!1;if(R.geometry.type==="GeometryCollection"){const W=R.geometry.geometries.filter(Z=>Z.type==="Polygon"||Z.type==="MultiPolygon");t:if(W.length>0){const Z=f6(A0(W.map(te=>P0(te))));if(!Z)break t;i3({...R,geometry:Z.geometry},A),j=!0}else{const Z=R.geometry.geometries.filter(te=>te.type==="LineString"||te.type==="MultiLineString");Z.length>0&&(A({...R,geometry:{type:"GeometryCollection",geometries:Z}}),j=!0)}}if(!j){if(R.geometry.type==="Polygon"||R.geometry.type==="MultiPolygon")i3(R,A);else if(R.geometry.type==="LineString"||R.geometry.type==="MultiLineString"){A(R);break e}}if(!z&&!R.geometry.type.endsWith("Point"))break e;if(r instanceof Function){const W=r(t,R);W&&m.push(W)}else r&&m.push(typeof r=="object"?new e.Marker(r):I().setLngLat(R.center).addTo(t))}if(n)for(const j of L??[]){if(j===R)continue;let W;if(n instanceof Function){if(W=n(t,j),!W)continue}else W=(typeof n=="object"?new e.Marker(n):I(!0)).setLngLat(j.center).setPopup(new e.Popup({offset:[1,-27],closeButton:!1,closeOnMove:!0,className:"maptiler-gc-popup"}).setText(j.place_type[0]==="reverse"?j.place_name:j.place_name.replace(/,.*/,""))).addTo(t);const Z=W.getElement();Z.addEventListener("click",te=>{te.stopPropagation(),a==null||a({type:"markerClick",id:j.id})}),Z.addEventListener("mouseenter",()=>{a==null||a({type:"markerMouseEnter",id:j.id}),W.togglePopup()}),Z.addEventListener("mouseleave",()=>{a==null||a({type:"markerMouseLeave",id:j.id}),W.togglePopup()}),m.push(W)}}},setSelectedMarker(L){y&&y.getElement().classList.toggle("marker-selected",!1),y=L>-1?m[L]:void 0,y==null||y.getElement().classList.toggle("marker-selected",!0)},getCenterAndZoom(){const L=t.getCenter();return[t.getZoom(),L.lng,L.lat]}}}function Yae(t,e,r){var n,s,c;class l{constructor(R,z){Lt(this,"type"),Lt(this,"target"),this.type=z,this.target=R}}class a extends l{constructor(R,z){super(R,"select"),Lt(this,"feature"),Object.assign(this,z)}}class m extends l{constructor(R,z){super(R,"featureslisted"),Lt(this,"features"),this.features=z}}class y extends l{constructor(R,z){super(R,"featuresmarked"),Lt(this,"features"),this.features=z}}class v extends l{constructor(R,z){super(R,"optionsvisibilitychange"),Lt(this,"optionsVisible"),this.optionsVisible=z}}class T extends l{constructor(R,z){super(R,"pick"),Lt(this,"feature"),this.feature=z}}class P extends l{constructor(R,z){super(R,"querychange"),Lt(this,"query"),this.query=z}}class A extends l{constructor(R,z,j){super(R,"response"),Lt(this,"url"),Lt(this,"featureCollection"),this.url=z,this.featureCollection=j}}class O extends l{constructor(R,z){super(R,"reversetoggle"),Lt(this,"reverse"),this.reverse=z}}class I extends t{constructor(R={}){super(),mS(this,n),mS(this,s),mS(this,c),Yv(this,s,R)}onAddInt(R){const z=document.createElement("div");z.className="mapboxgl-ctrl-geocoder mapboxgl-ctrl maplibregl-ctrl-geocoder maplibregl-ctrl mapboxgl-ctrl-group";const{marker:j,showResultMarkers:W,flyTo:Z,fullGeometryStyle:te,...ie}=Yn(this,s),V=typeof Z=="boolean"?{}:Z,q={mapController:Xae(R,e,j,W,V,V,te),flyTo:Z===void 0?!0:!!Z,apiKey:"",...ie};return q.apiKey||console.warn("No MapTiler Cloud API key was provided, some or all geocoding requests may fail"),Yv(this,n,new Sae({target:z,props:q})),Yn(this,n).$on("select",Q=>{this.fire(new a(this,Q.detail))}),Yn(this,n).$on("pick",Q=>{this.fire(new T(this,Q.detail.feature))}),Yn(this,n).$on("featureslisted",Q=>{this.fire(new m(this,Q.detail.features))}),Yn(this,n).$on("featuresmarked",Q=>{this.fire(new y(this,Q.detail.features))}),Yn(this,n).$on("response",Q=>{this.fire(new A(this,Q.detail.url,Q.detail.featureCollection))}),Yn(this,n).$on("optionsvisibilitychange",Q=>{this.fire(new v(this,Q.detail.optionsVisible))}),Yn(this,n).$on("reversetoggle",Q=>{this.fire(new O(this,Q.detail.reverse))}),Yn(this,n).$on("querychange",Q=>{this.fire(new P(this,Q.detail.query))}),Yv(this,c,z),z}on(R,z){return super.on(R,z)}once(R,z){return super.once(R,z)}off(R,z){return super.off(R,z)}listens(R){return super.listens(R)}setOptions(R){var z;Object.assign(Yn(this,s),R);const{marker:j,showResultMarkers:W,flyTo:Z,fullGeometryStyle:te,...ie}=Yn(this,s);(z=Yn(this,n))==null||z.$set(ie)}setQuery(R,z=!0){var j;(j=Yn(this,n))==null||j.setQuery(R,z)}clearMap(){var R;(R=Yn(this,n))==null||R.clearMap()}clearList(){var R;(R=Yn(this,n))==null||R.clearList()}setReverseMode(R){var z;(z=Yn(this,n))==null||z.$set({reverseActive:R})}focus(R){var z;(z=Yn(this,n))==null||z.focus(R)}blur(){var R;(R=Yn(this,n))==null||R.blur()}onRemove(){var R,z,j;(R=Yn(this,n))==null||R.$destroy(),Yv(this,n,void 0),(j=(z=Yn(this,c))==null?void 0:z.parentNode)==null||j.removeChild(Yn(this,c))}}return n=new WeakMap,s=new WeakMap,c=new WeakMap,{MapLibreBasedGeocodingControl:I,events:{SelectEvent:a,FeaturesListedEvent:m,FeaturesMarkedEvent:y,OptionsVisibilityChangeEvent:v,PickEvent:T,QueryChangeEvent:P,ResponseEvent:A,ReverseToggleEvent:O}}}const{MapLibreBasedGeocodingControl:Qae}=Yae(yA.Evented,doe);class Jae extends Qae{onAdd(e){return super.onAddInt(e)}}function p6(t,e){return function(){return t.apply(e,arguments)}}const{toString:ele}=Object.prototype,{getPrototypeOf:bA}=Object,{iterator:k1,toStringTag:m6}=Symbol,M1=(t=>e=>{const r=ele.call(e);return t[r]||(t[r]=r.slice(8,-1).toLowerCase())})(Object.create(null)),Da=t=>(t=t.toLowerCase(),e=>M1(e)===t),I1=t=>e=>typeof e===t,{isArray:Em}=Array,hm=I1("undefined");function J0(t){return t!==null&&!hm(t)&&t.constructor!==null&&!hm(t.constructor)&&to(t.constructor.isBuffer)&&t.constructor.isBuffer(t)}const g6=Da("ArrayBuffer");function tle(t){let e;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?e=ArrayBuffer.isView(t):e=t&&t.buffer&&g6(t.buffer),e}const rle=I1("string"),to=I1("function"),y6=I1("number"),e_=t=>t!==null&&typeof t=="object",nle=t=>t===!0||t===!1,Rx=t=>{if(M1(t)!=="object")return!1;const e=bA(t);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(m6 in t)&&!(k1 in t)},ile=t=>{if(!e_(t)||J0(t))return!1;try{return Object.keys(t).length===0&&Object.getPrototypeOf(t)===Object.prototype}catch{return!1}},sle=Da("Date"),ole=Da("File"),ale=Da("Blob"),lle=Da("FileList"),cle=t=>e_(t)&&to(t.pipe),ule=t=>{let e;return t&&(typeof FormData=="function"&&t instanceof FormData||to(t.append)&&((e=M1(t))==="formdata"||e==="object"&&to(t.toString)&&t.toString()==="[object FormData]"))},hle=Da("URLSearchParams"),[dle,fle,ple,mle]=["ReadableStream","Request","Response","Headers"].map(Da),gle=t=>t.trim?t.trim():t.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function t_(t,e,{allOwnKeys:r=!1}={}){if(t===null||typeof t>"u")return;let n,s;if(typeof t!="object"&&(t=[t]),Em(t))for(n=0,s=t.length;n<s;n++)e.call(null,t[n],n,t);else{if(J0(t))return;const c=r?Object.getOwnPropertyNames(t):Object.keys(t),l=c.length;let a;for(n=0;n<l;n++)a=c[n],e.call(null,t[a],a,t)}}function _6(t,e){if(J0(t))return null;e=e.toLowerCase();const r=Object.keys(t);let n=r.length,s;for(;n-- >0;)if(s=r[n],e===s.toLowerCase())return s;return null}const rd=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,v6=t=>!hm(t)&&t!==rd;function GE(){const{caseless:t,skipUndefined:e}=v6(this)&&this||{},r={},n=(s,c)=>{const l=t&&_6(r,c)||c;Rx(r[l])&&Rx(s)?r[l]=GE(r[l],s):Rx(s)?r[l]=GE({},s):Em(s)?r[l]=s.slice():(!e||!hm(s))&&(r[l]=s)};for(let s=0,c=arguments.length;s<c;s++)arguments[s]&&t_(arguments[s],n);return r}const yle=(t,e,r,{allOwnKeys:n}={})=>(t_(e,(s,c)=>{r&&to(s)?t[c]=p6(s,r):t[c]=s},{allOwnKeys:n}),t),_le=t=>(t.charCodeAt(0)===65279&&(t=t.slice(1)),t),vle=(t,e,r,n)=>{t.prototype=Object.create(e.prototype,n),t.prototype.constructor=t,Object.defineProperty(t,"super",{value:e.prototype}),r&&Object.assign(t.prototype,r)},xle=(t,e,r,n)=>{let s,c,l;const a={};if(e=e||{},t==null)return e;do{for(s=Object.getOwnPropertyNames(t),c=s.length;c-- >0;)l=s[c],(!n||n(l,t,e))&&!a[l]&&(e[l]=t[l],a[l]=!0);t=r!==!1&&bA(t)}while(t&&(!r||r(t,e))&&t!==Object.prototype);return e},ble=(t,e,r)=>{t=String(t),(r===void 0||r>t.length)&&(r=t.length),r-=e.length;const n=t.indexOf(e,r);return n!==-1&&n===r},wle=t=>{if(!t)return null;if(Em(t))return t;let e=t.length;if(!y6(e))return null;const r=new Array(e);for(;e-- >0;)r[e]=t[e];return r},Sle=(t=>e=>t&&e instanceof t)(typeof Uint8Array<"u"&&bA(Uint8Array)),Tle=(t,e)=>{const n=(t&&t[k1]).call(t);let s;for(;(s=n.next())&&!s.done;){const c=s.value;e.call(t,c[0],c[1])}},Ele=(t,e)=>{let r;const n=[];for(;(r=t.exec(e))!==null;)n.push(r);return n},Cle=Da("HTMLFormElement"),Ple=t=>t.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(r,n,s){return n.toUpperCase()+s}),l3=(({hasOwnProperty:t})=>(e,r)=>t.call(e,r))(Object.prototype),Ale=Da("RegExp"),x6=(t,e)=>{const r=Object.getOwnPropertyDescriptors(t),n={};t_(r,(s,c)=>{let l;(l=e(s,c,t))!==!1&&(n[c]=l||s)}),Object.defineProperties(t,n)},kle=t=>{x6(t,(e,r)=>{if(to(t)&&["arguments","caller","callee"].indexOf(r)!==-1)return!1;const n=t[r];if(to(n)){if(e.enumerable=!1,"writable"in e){e.writable=!1;return}e.set||(e.set=()=>{throw Error("Can not rewrite read-only method '"+r+"'")})}})},Mle=(t,e)=>{const r={},n=s=>{s.forEach(c=>{r[c]=!0})};return Em(t)?n(t):n(String(t).split(e)),r},Ile=()=>{},Rle=(t,e)=>t!=null&&Number.isFinite(t=+t)?t:e;function Dle(t){return!!(t&&to(t.append)&&t[m6]==="FormData"&&t[k1])}const Lle=t=>{const e=new Array(10),r=(n,s)=>{if(e_(n)){if(e.indexOf(n)>=0)return;if(J0(n))return n;if(!("toJSON"in n)){e[s]=n;const c=Em(n)?[]:{};return t_(n,(l,a)=>{const m=r(l,s+1);!hm(m)&&(c[a]=m)}),e[s]=void 0,c}}return n};return r(t,0)},Ole=Da("AsyncFunction"),zle=t=>t&&(e_(t)||to(t))&&to(t.then)&&to(t.catch),b6=((t,e)=>t?setImmediate:e?((r,n)=>(rd.addEventListener("message",({source:s,data:c})=>{s===rd&&c===r&&n.length&&n.shift()()},!1),s=>{n.push(s),rd.postMessage(r,"*")}))(`axios@${Math.random()}`,[]):r=>setTimeout(r))(typeof setImmediate=="function",to(rd.postMessage)),Nle=typeof queueMicrotask<"u"?queueMicrotask.bind(rd):typeof process<"u"&&process.nextTick||b6,jle=t=>t!=null&&to(t[k1]),Ye={isArray:Em,isArrayBuffer:g6,isBuffer:J0,isFormData:ule,isArrayBufferView:tle,isString:rle,isNumber:y6,isBoolean:nle,isObject:e_,isPlainObject:Rx,isEmptyObject:ile,isReadableStream:dle,isRequest:fle,isResponse:ple,isHeaders:mle,isUndefined:hm,isDate:sle,isFile:ole,isBlob:ale,isRegExp:Ale,isFunction:to,isStream:cle,isURLSearchParams:hle,isTypedArray:Sle,isFileList:lle,forEach:t_,merge:GE,extend:yle,trim:gle,stripBOM:_le,inherits:vle,toFlatObject:xle,kindOf:M1,kindOfTest:Da,endsWith:ble,toArray:wle,forEachEntry:Tle,matchAll:Ele,isHTMLForm:Cle,hasOwnProperty:l3,hasOwnProp:l3,reduceDescriptors:x6,freezeMethods:kle,toObjectSet:Mle,toCamelCase:Ple,noop:Ile,toFiniteNumber:Rle,findKey:_6,global:rd,isContextDefined:v6,isSpecCompliantForm:Dle,toJSONObject:Lle,isAsyncFn:Ole,isThenable:zle,setImmediate:b6,asap:Nle,isIterable:jle};function ur(t,e,r,n,s){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=t,this.name="AxiosError",e&&(this.code=e),r&&(this.config=r),n&&(this.request=n),s&&(this.response=s,this.status=s.status?s.status:null)}Ye.inherits(ur,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:Ye.toJSONObject(this.config),code:this.code,status:this.status}}});const w6=ur.prototype,S6={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(t=>{S6[t]={value:t}});Object.defineProperties(ur,S6);Object.defineProperty(w6,"isAxiosError",{value:!0});ur.from=(t,e,r,n,s,c)=>{const l=Object.create(w6);Ye.toFlatObject(t,l,function(v){return v!==Error.prototype},y=>y!=="isAxiosError");const a=t&&t.message?t.message:"Error",m=e==null&&t?t.code:e;return ur.call(l,a,m,r,n,s),t&&l.cause==null&&Object.defineProperty(l,"cause",{value:t,configurable:!0}),l.name=t&&t.name||"Error",c&&Object.assign(l,c),l};const Fle=null;function WE(t){return Ye.isPlainObject(t)||Ye.isArray(t)}function T6(t){return Ye.endsWith(t,"[]")?t.slice(0,-2):t}function c3(t,e,r){return t?t.concat(e).map(function(s,c){return s=T6(s),!r&&c?"["+s+"]":s}).join(r?".":""):e}function Ble(t){return Ye.isArray(t)&&!t.some(WE)}const $le=Ye.toFlatObject(Ye,{},null,function(e){return/^is[A-Z]/.test(e)});function R1(t,e,r){if(!Ye.isObject(t))throw new TypeError("target must be an object");e=e||new FormData,r=Ye.toFlatObject(r,{metaTokens:!0,dots:!1,indexes:!1},!1,function(I,L){return!Ye.isUndefined(L[I])});const n=r.metaTokens,s=r.visitor||v,c=r.dots,l=r.indexes,m=(r.Blob||typeof Blob<"u"&&Blob)&&Ye.isSpecCompliantForm(e);if(!Ye.isFunction(s))throw new TypeError("visitor must be a function");function y(O){if(O===null)return"";if(Ye.isDate(O))return O.toISOString();if(Ye.isBoolean(O))return O.toString();if(!m&&Ye.isBlob(O))throw new ur("Blob is not supported. Use a Buffer instead.");return Ye.isArrayBuffer(O)||Ye.isTypedArray(O)?m&&typeof Blob=="function"?new Blob([O]):Buffer.from(O):O}function v(O,I,L){let R=O;if(O&&!L&&typeof O=="object"){if(Ye.endsWith(I,"{}"))I=n?I:I.slice(0,-2),O=JSON.stringify(O);else if(Ye.isArray(O)&&Ble(O)||(Ye.isFileList(O)||Ye.endsWith(I,"[]"))&&(R=Ye.toArray(O)))return I=T6(I),R.forEach(function(j,W){!(Ye.isUndefined(j)||j===null)&&e.append(l===!0?c3([I],W,c):l===null?I:I+"[]",y(j))}),!1}return WE(O)?!0:(e.append(c3(L,I,c),y(O)),!1)}const T=[],P=Object.assign($le,{defaultVisitor:v,convertValue:y,isVisitable:WE});function A(O,I){if(!Ye.isUndefined(O)){if(T.indexOf(O)!==-1)throw Error("Circular reference detected in "+I.join("."));T.push(O),Ye.forEach(O,function(R,z){(!(Ye.isUndefined(R)||R===null)&&s.call(e,R,Ye.isString(z)?z.trim():z,I,P))===!0&&A(R,I?I.concat(z):[z])}),T.pop()}}if(!Ye.isObject(t))throw new TypeError("data must be an object");return A(t),e}function u3(t){const e={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(t).replace(/[!'()~]|%20|%00/g,function(n){return e[n]})}function wA(t,e){this._pairs=[],t&&R1(t,this,e)}const E6=wA.prototype;E6.append=function(e,r){this._pairs.push([e,r])};E6.toString=function(e){const r=e?function(n){return e.call(this,n,u3)}:u3;return this._pairs.map(function(s){return r(s[0])+"="+r(s[1])},"").join("&")};function Vle(t){return encodeURIComponent(t).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+")}function C6(t,e,r){if(!e)return t;const n=r&&r.encode||Vle;Ye.isFunction(r)&&(r={serialize:r});const s=r&&r.serialize;let c;if(s?c=s(e,r):c=Ye.isURLSearchParams(e)?e.toString():new wA(e,r).toString(n),c){const l=t.indexOf("#");l!==-1&&(t=t.slice(0,l)),t+=(t.indexOf("?")===-1?"?":"&")+c}return t}class h3{constructor(){this.handlers=[]}use(e,r,n){return this.handlers.push({fulfilled:e,rejected:r,synchronous:n?n.synchronous:!1,runWhen:n?n.runWhen:null}),this.handlers.length-1}eject(e){this.handlers[e]&&(this.handlers[e]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(e){Ye.forEach(this.handlers,function(n){n!==null&&e(n)})}}const P6={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},Ule=typeof URLSearchParams<"u"?URLSearchParams:wA,Gle=typeof FormData<"u"?FormData:null,Wle=typeof Blob<"u"?Blob:null,qle={isBrowser:!0,classes:{URLSearchParams:Ule,FormData:Gle,Blob:Wle},protocols:["http","https","file","blob","url","data"]},SA=typeof window<"u"&&typeof document<"u",qE=typeof navigator=="object"&&navigator||void 0,Hle=SA&&(!qE||["ReactNative","NativeScript","NS"].indexOf(qE.product)<0),Zle=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",Kle=SA&&window.location.href||"http://localhost",Xle=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:SA,hasStandardBrowserEnv:Hle,hasStandardBrowserWebWorkerEnv:Zle,navigator:qE,origin:Kle},Symbol.toStringTag,{value:"Module"})),hs={...Xle,...qle};function Yle(t,e){return R1(t,new hs.classes.URLSearchParams,{visitor:function(r,n,s,c){return hs.isNode&&Ye.isBuffer(r)?(this.append(n,r.toString("base64")),!1):c.defaultVisitor.apply(this,arguments)},...e})}function Qle(t){return Ye.matchAll(/\w+|\[(\w*)]/g,t).map(e=>e[0]==="[]"?"":e[1]||e[0])}function Jle(t){const e={},r=Object.keys(t);let n;const s=r.length;let c;for(n=0;n<s;n++)c=r[n],e[c]=t[c];return e}function A6(t){function e(r,n,s,c){let l=r[c++];if(l==="__proto__")return!0;const a=Number.isFinite(+l),m=c>=r.length;return l=!l&&Ye.isArray(s)?s.length:l,m?(Ye.hasOwnProp(s,l)?s[l]=[s[l],n]:s[l]=n,!a):((!s[l]||!Ye.isObject(s[l]))&&(s[l]=[]),e(r,n,s[l],c)&&Ye.isArray(s[l])&&(s[l]=Jle(s[l])),!a)}if(Ye.isFormData(t)&&Ye.isFunction(t.entries)){const r={};return Ye.forEachEntry(t,(n,s)=>{e(Qle(n),s,r,0)}),r}return null}function ece(t,e,r){if(Ye.isString(t))try{return(e||JSON.parse)(t),Ye.trim(t)}catch(n){if(n.name!=="SyntaxError")throw n}return(r||JSON.stringify)(t)}const r_={transitional:P6,adapter:["xhr","http","fetch"],transformRequest:[function(e,r){const n=r.getContentType()||"",s=n.indexOf("application/json")>-1,c=Ye.isObject(e);if(c&&Ye.isHTMLForm(e)&&(e=new FormData(e)),Ye.isFormData(e))return s?JSON.stringify(A6(e)):e;if(Ye.isArrayBuffer(e)||Ye.isBuffer(e)||Ye.isStream(e)||Ye.isFile(e)||Ye.isBlob(e)||Ye.isReadableStream(e))return e;if(Ye.isArrayBufferView(e))return e.buffer;if(Ye.isURLSearchParams(e))return r.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),e.toString();let a;if(c){if(n.indexOf("application/x-www-form-urlencoded")>-1)return Yle(e,this.formSerializer).toString();if((a=Ye.isFileList(e))||n.indexOf("multipart/form-data")>-1){const m=this.env&&this.env.FormData;return R1(a?{"files[]":e}:e,m&&new m,this.formSerializer)}}return c||s?(r.setContentType("application/json",!1),ece(e)):e}],transformResponse:[function(e){const r=this.transitional||r_.transitional,n=r&&r.forcedJSONParsing,s=this.responseType==="json";if(Ye.isResponse(e)||Ye.isReadableStream(e))return e;if(e&&Ye.isString(e)&&(n&&!this.responseType||s)){const l=!(r&&r.silentJSONParsing)&&s;try{return JSON.parse(e,this.parseReviver)}catch(a){if(l)throw a.name==="SyntaxError"?ur.from(a,ur.ERR_BAD_RESPONSE,this,null,this.response):a}}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:hs.classes.FormData,Blob:hs.classes.Blob},validateStatus:function(e){return e>=200&&e<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};Ye.forEach(["delete","get","head","post","put","patch"],t=>{r_.headers[t]={}});const tce=Ye.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),rce=t=>{const e={};let r,n,s;return t&&t.split(`
`).forEach(function(l){s=l.indexOf(":"),r=l.substring(0,s).trim().toLowerCase(),n=l.substring(s+1).trim(),!(!r||e[r]&&tce[r])&&(r==="set-cookie"?e[r]?e[r].push(n):e[r]=[n]:e[r]=e[r]?e[r]+", "+n:n)}),e},d3=Symbol("internals");function Jg(t){return t&&String(t).trim().toLowerCase()}function Dx(t){return t===!1||t==null?t:Ye.isArray(t)?t.map(Dx):String(t)}function nce(t){const e=Object.create(null),r=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let n;for(;n=r.exec(t);)e[n[1]]=n[2];return e}const ice=t=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(t.trim());function vS(t,e,r,n,s){if(Ye.isFunction(n))return n.call(this,e,r);if(s&&(e=r),!!Ye.isString(e)){if(Ye.isString(n))return e.indexOf(n)!==-1;if(Ye.isRegExp(n))return n.test(e)}}function sce(t){return t.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(e,r,n)=>r.toUpperCase()+n)}function oce(t,e){const r=Ye.toCamelCase(" "+e);["get","set","has"].forEach(n=>{Object.defineProperty(t,n+r,{value:function(s,c,l){return this[n].call(this,e,s,c,l)},configurable:!0})})}let ro=class{constructor(e){e&&this.set(e)}set(e,r,n){const s=this;function c(a,m,y){const v=Jg(m);if(!v)throw new Error("header name must be a non-empty string");const T=Ye.findKey(s,v);(!T||s[T]===void 0||y===!0||y===void 0&&s[T]!==!1)&&(s[T||m]=Dx(a))}const l=(a,m)=>Ye.forEach(a,(y,v)=>c(y,v,m));if(Ye.isPlainObject(e)||e instanceof this.constructor)l(e,r);else if(Ye.isString(e)&&(e=e.trim())&&!ice(e))l(rce(e),r);else if(Ye.isObject(e)&&Ye.isIterable(e)){let a={},m,y;for(const v of e){if(!Ye.isArray(v))throw TypeError("Object iterator must return a key-value pair");a[y=v[0]]=(m=a[y])?Ye.isArray(m)?[...m,v[1]]:[m,v[1]]:v[1]}l(a,r)}else e!=null&&c(r,e,n);return this}get(e,r){if(e=Jg(e),e){const n=Ye.findKey(this,e);if(n){const s=this[n];if(!r)return s;if(r===!0)return nce(s);if(Ye.isFunction(r))return r.call(this,s,n);if(Ye.isRegExp(r))return r.exec(s);throw new TypeError("parser must be boolean|regexp|function")}}}has(e,r){if(e=Jg(e),e){const n=Ye.findKey(this,e);return!!(n&&this[n]!==void 0&&(!r||vS(this,this[n],n,r)))}return!1}delete(e,r){const n=this;let s=!1;function c(l){if(l=Jg(l),l){const a=Ye.findKey(n,l);a&&(!r||vS(n,n[a],a,r))&&(delete n[a],s=!0)}}return Ye.isArray(e)?e.forEach(c):c(e),s}clear(e){const r=Object.keys(this);let n=r.length,s=!1;for(;n--;){const c=r[n];(!e||vS(this,this[c],c,e,!0))&&(delete this[c],s=!0)}return s}normalize(e){const r=this,n={};return Ye.forEach(this,(s,c)=>{const l=Ye.findKey(n,c);if(l){r[l]=Dx(s),delete r[c];return}const a=e?sce(c):String(c).trim();a!==c&&delete r[c],r[a]=Dx(s),n[a]=!0}),this}concat(...e){return this.constructor.concat(this,...e)}toJSON(e){const r=Object.create(null);return Ye.forEach(this,(n,s)=>{n!=null&&n!==!1&&(r[s]=e&&Ye.isArray(n)?n.join(", "):n)}),r}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([e,r])=>e+": "+r).join(`
`)}getSetCookie(){return this.get("set-cookie")||[]}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(e){return e instanceof this?e:new this(e)}static concat(e,...r){const n=new this(e);return r.forEach(s=>n.set(s)),n}static accessor(e){const n=(this[d3]=this[d3]={accessors:{}}).accessors,s=this.prototype;function c(l){const a=Jg(l);n[a]||(oce(s,l),n[a]=!0)}return Ye.isArray(e)?e.forEach(c):c(e),this}};ro.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);Ye.reduceDescriptors(ro.prototype,({value:t},e)=>{let r=e[0].toUpperCase()+e.slice(1);return{get:()=>t,set(n){this[r]=n}}});Ye.freezeMethods(ro);function xS(t,e){const r=this||r_,n=e||r,s=ro.from(n.headers);let c=n.data;return Ye.forEach(t,function(a){c=a.call(r,c,s.normalize(),e?e.status:void 0)}),s.normalize(),c}function k6(t){return!!(t&&t.__CANCEL__)}function Cm(t,e,r){ur.call(this,t??"canceled",ur.ERR_CANCELED,e,r),this.name="CanceledError"}Ye.inherits(Cm,ur,{__CANCEL__:!0});function M6(t,e,r){const n=r.config.validateStatus;!r.status||!n||n(r.status)?t(r):e(new ur("Request failed with status code "+r.status,[ur.ERR_BAD_REQUEST,ur.ERR_BAD_RESPONSE][Math.floor(r.status/100)-4],r.config,r.request,r))}function ace(t){const e=/^([-+\w]{1,25})(:?\/\/|:)/.exec(t);return e&&e[1]||""}function lce(t,e){t=t||10;const r=new Array(t),n=new Array(t);let s=0,c=0,l;return e=e!==void 0?e:1e3,function(m){const y=Date.now(),v=n[c];l||(l=y),r[s]=m,n[s]=y;let T=c,P=0;for(;T!==s;)P+=r[T++],T=T%t;if(s=(s+1)%t,s===c&&(c=(c+1)%t),y-l<e)return;const A=v&&y-v;return A?Math.round(P*1e3/A):void 0}}function cce(t,e){let r=0,n=1e3/e,s,c;const l=(y,v=Date.now())=>{r=v,s=null,c&&(clearTimeout(c),c=null),t(...y)};return[(...y)=>{const v=Date.now(),T=v-r;T>=n?l(y,v):(s=y,c||(c=setTimeout(()=>{c=null,l(s)},n-T)))},()=>s&&l(s)]}const Ob=(t,e,r=3)=>{let n=0;const s=lce(50,250);return cce(c=>{const l=c.loaded,a=c.lengthComputable?c.total:void 0,m=l-n,y=s(m),v=l<=a;n=l;const T={loaded:l,total:a,progress:a?l/a:void 0,bytes:m,rate:y||void 0,estimated:y&&a&&v?(a-l)/y:void 0,event:c,lengthComputable:a!=null,[e?"download":"upload"]:!0};t(T)},r)},f3=(t,e)=>{const r=t!=null;return[n=>e[0]({lengthComputable:r,total:t,loaded:n}),e[1]]},p3=t=>(...e)=>Ye.asap(()=>t(...e)),uce=hs.hasStandardBrowserEnv?((t,e)=>r=>(r=new URL(r,hs.origin),t.protocol===r.protocol&&t.host===r.host&&(e||t.port===r.port)))(new URL(hs.origin),hs.navigator&&/(msie|trident)/i.test(hs.navigator.userAgent)):()=>!0,hce=hs.hasStandardBrowserEnv?{write(t,e,r,n,s,c){const l=[t+"="+encodeURIComponent(e)];Ye.isNumber(r)&&l.push("expires="+new Date(r).toGMTString()),Ye.isString(n)&&l.push("path="+n),Ye.isString(s)&&l.push("domain="+s),c===!0&&l.push("secure"),document.cookie=l.join("; ")},read(t){const e=document.cookie.match(new RegExp("(^|;\\s*)("+t+")=([^;]*)"));return e?decodeURIComponent(e[3]):null},remove(t){this.write(t,"",Date.now()-864e5)}}:{write(){},read(){return null},remove(){}};function dce(t){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(t)}function fce(t,e){return e?t.replace(/\/?\/$/,"")+"/"+e.replace(/^\/+/,""):t}function I6(t,e,r){let n=!dce(e);return t&&(n||r==!1)?fce(t,e):e}const m3=t=>t instanceof ro?{...t}:t;function Cd(t,e){e=e||{};const r={};function n(y,v,T,P){return Ye.isPlainObject(y)&&Ye.isPlainObject(v)?Ye.merge.call({caseless:P},y,v):Ye.isPlainObject(v)?Ye.merge({},v):Ye.isArray(v)?v.slice():v}function s(y,v,T,P){if(Ye.isUndefined(v)){if(!Ye.isUndefined(y))return n(void 0,y,T,P)}else return n(y,v,T,P)}function c(y,v){if(!Ye.isUndefined(v))return n(void 0,v)}function l(y,v){if(Ye.isUndefined(v)){if(!Ye.isUndefined(y))return n(void 0,y)}else return n(void 0,v)}function a(y,v,T){if(T in e)return n(y,v);if(T in t)return n(void 0,y)}const m={url:c,method:c,data:c,baseURL:l,transformRequest:l,transformResponse:l,paramsSerializer:l,timeout:l,timeoutMessage:l,withCredentials:l,withXSRFToken:l,adapter:l,responseType:l,xsrfCookieName:l,xsrfHeaderName:l,onUploadProgress:l,onDownloadProgress:l,decompress:l,maxContentLength:l,maxBodyLength:l,beforeRedirect:l,transport:l,httpAgent:l,httpsAgent:l,cancelToken:l,socketPath:l,responseEncoding:l,validateStatus:a,headers:(y,v,T)=>s(m3(y),m3(v),T,!0)};return Ye.forEach(Object.keys({...t,...e}),function(v){const T=m[v]||s,P=T(t[v],e[v],v);Ye.isUndefined(P)&&T!==a||(r[v]=P)}),r}const R6=t=>{const e=Cd({},t);let{data:r,withXSRFToken:n,xsrfHeaderName:s,xsrfCookieName:c,headers:l,auth:a}=e;if(e.headers=l=ro.from(l),e.url=C6(I6(e.baseURL,e.url,e.allowAbsoluteUrls),t.params,t.paramsSerializer),a&&l.set("Authorization","Basic "+btoa((a.username||"")+":"+(a.password?unescape(encodeURIComponent(a.password)):""))),Ye.isFormData(r)){if(hs.hasStandardBrowserEnv||hs.hasStandardBrowserWebWorkerEnv)l.setContentType(void 0);else if(Ye.isFunction(r.getHeaders)){const m=r.getHeaders(),y=["content-type","content-length"];Object.entries(m).forEach(([v,T])=>{y.includes(v.toLowerCase())&&l.set(v,T)})}}if(hs.hasStandardBrowserEnv&&(n&&Ye.isFunction(n)&&(n=n(e)),n||n!==!1&&uce(e.url))){const m=s&&c&&hce.read(c);m&&l.set(s,m)}return e},pce=typeof XMLHttpRequest<"u",mce=pce&&function(t){return new Promise(function(r,n){const s=R6(t);let c=s.data;const l=ro.from(s.headers).normalize();let{responseType:a,onUploadProgress:m,onDownloadProgress:y}=s,v,T,P,A,O;function I(){A&&A(),O&&O(),s.cancelToken&&s.cancelToken.unsubscribe(v),s.signal&&s.signal.removeEventListener("abort",v)}let L=new XMLHttpRequest;L.open(s.method.toUpperCase(),s.url,!0),L.timeout=s.timeout;function R(){if(!L)return;const j=ro.from("getAllResponseHeaders"in L&&L.getAllResponseHeaders()),Z={data:!a||a==="text"||a==="json"?L.responseText:L.response,status:L.status,statusText:L.statusText,headers:j,config:t,request:L};M6(function(ie){r(ie),I()},function(ie){n(ie),I()},Z),L=null}"onloadend"in L?L.onloadend=R:L.onreadystatechange=function(){!L||L.readyState!==4||L.status===0&&!(L.responseURL&&L.responseURL.indexOf("file:")===0)||setTimeout(R)},L.onabort=function(){L&&(n(new ur("Request aborted",ur.ECONNABORTED,t,L)),L=null)},L.onerror=function(W){const Z=W&&W.message?W.message:"Network Error",te=new ur(Z,ur.ERR_NETWORK,t,L);te.event=W||null,n(te),L=null},L.ontimeout=function(){let W=s.timeout?"timeout of "+s.timeout+"ms exceeded":"timeout exceeded";const Z=s.transitional||P6;s.timeoutErrorMessage&&(W=s.timeoutErrorMessage),n(new ur(W,Z.clarifyTimeoutError?ur.ETIMEDOUT:ur.ECONNABORTED,t,L)),L=null},c===void 0&&l.setContentType(null),"setRequestHeader"in L&&Ye.forEach(l.toJSON(),function(W,Z){L.setRequestHeader(Z,W)}),Ye.isUndefined(s.withCredentials)||(L.withCredentials=!!s.withCredentials),a&&a!=="json"&&(L.responseType=s.responseType),y&&([P,O]=Ob(y,!0),L.addEventListener("progress",P)),m&&L.upload&&([T,A]=Ob(m),L.upload.addEventListener("progress",T),L.upload.addEventListener("loadend",A)),(s.cancelToken||s.signal)&&(v=j=>{L&&(n(!j||j.type?new Cm(null,t,L):j),L.abort(),L=null)},s.cancelToken&&s.cancelToken.subscribe(v),s.signal&&(s.signal.aborted?v():s.signal.addEventListener("abort",v)));const z=ace(s.url);if(z&&hs.protocols.indexOf(z)===-1){n(new ur("Unsupported protocol "+z+":",ur.ERR_BAD_REQUEST,t));return}L.send(c||null)})},gce=(t,e)=>{const{length:r}=t=t?t.filter(Boolean):[];if(e||r){let n=new AbortController,s;const c=function(y){if(!s){s=!0,a();const v=y instanceof Error?y:this.reason;n.abort(v instanceof ur?v:new Cm(v instanceof Error?v.message:v))}};let l=e&&setTimeout(()=>{l=null,c(new ur(`timeout ${e} of ms exceeded`,ur.ETIMEDOUT))},e);const a=()=>{t&&(l&&clearTimeout(l),l=null,t.forEach(y=>{y.unsubscribe?y.unsubscribe(c):y.removeEventListener("abort",c)}),t=null)};t.forEach(y=>y.addEventListener("abort",c));const{signal:m}=n;return m.unsubscribe=()=>Ye.asap(a),m}},yce=function*(t,e){let r=t.byteLength;if(r<e){yield t;return}let n=0,s;for(;n<r;)s=n+e,yield t.slice(n,s),n=s},_ce=async function*(t,e){for await(const r of vce(t))yield*yce(r,e)},vce=async function*(t){if(t[Symbol.asyncIterator]){yield*t;return}const e=t.getReader();try{for(;;){const{done:r,value:n}=await e.read();if(r)break;yield n}}finally{await e.cancel()}},g3=(t,e,r,n)=>{const s=_ce(t,e);let c=0,l,a=m=>{l||(l=!0,n&&n(m))};return new ReadableStream({async pull(m){try{const{done:y,value:v}=await s.next();if(y){a(),m.close();return}let T=v.byteLength;if(r){let P=c+=T;r(P)}m.enqueue(new Uint8Array(v))}catch(y){throw a(y),y}},cancel(m){return a(m),s.return()}},{highWaterMark:2})},y3=64*1024,{isFunction:nx}=Ye,xce=(({Request:t,Response:e})=>({Request:t,Response:e}))(Ye.global),{ReadableStream:_3,TextEncoder:v3}=Ye.global,x3=(t,...e)=>{try{return!!t(...e)}catch{return!1}},bce=t=>{t=Ye.merge.call({skipUndefined:!0},xce,t);const{fetch:e,Request:r,Response:n}=t,s=e?nx(e):typeof fetch=="function",c=nx(r),l=nx(n);if(!s)return!1;const a=s&&nx(_3),m=s&&(typeof v3=="function"?(O=>I=>O.encode(I))(new v3):async O=>new Uint8Array(await new r(O).arrayBuffer())),y=c&&a&&x3(()=>{let O=!1;const I=new r(hs.origin,{body:new _3,method:"POST",get duplex(){return O=!0,"half"}}).headers.has("Content-Type");return O&&!I}),v=l&&a&&x3(()=>Ye.isReadableStream(new n("").body)),T={stream:v&&(O=>O.body)};s&&["text","arrayBuffer","blob","formData","stream"].forEach(O=>{!T[O]&&(T[O]=(I,L)=>{let R=I&&I[O];if(R)return R.call(I);throw new ur(`Response type '${O}' is not supported`,ur.ERR_NOT_SUPPORT,L)})});const P=async O=>{if(O==null)return 0;if(Ye.isBlob(O))return O.size;if(Ye.isSpecCompliantForm(O))return(await new r(hs.origin,{method:"POST",body:O}).arrayBuffer()).byteLength;if(Ye.isArrayBufferView(O)||Ye.isArrayBuffer(O))return O.byteLength;if(Ye.isURLSearchParams(O)&&(O=O+""),Ye.isString(O))return(await m(O)).byteLength},A=async(O,I)=>{const L=Ye.toFiniteNumber(O.getContentLength());return L??P(I)};return async O=>{let{url:I,method:L,data:R,signal:z,cancelToken:j,timeout:W,onDownloadProgress:Z,onUploadProgress:te,responseType:ie,headers:V,withCredentials:q="same-origin",fetchOptions:Q}=R6(O),ce=e||fetch;ie=ie?(ie+"").toLowerCase():"text";let se=gce([z,j&&j.toAbortSignal()],W),ue=null;const he=se&&se.unsubscribe&&(()=>{se.unsubscribe()});let ye;try{if(te&&y&&L!=="get"&&L!=="head"&&(ye=await A(V,R))!==0){let $e=new r(I,{method:"POST",body:R,duplex:"half"}),Xe;if(Ye.isFormData(R)&&(Xe=$e.headers.get("content-type"))&&V.setContentType(Xe),$e.body){const[st,at]=f3(ye,Ob(p3(te)));R=g3($e.body,y3,st,at)}}Ye.isString(q)||(q=q?"include":"omit");const xe=c&&"credentials"in r.prototype,Se={...Q,signal:se,method:L.toUpperCase(),headers:V.normalize().toJSON(),body:R,duplex:"half",credentials:xe?q:void 0};ue=c&&new r(I,Se);let fe=await(c?ce(ue,Q):ce(I,Se));const ve=v&&(ie==="stream"||ie==="response");if(v&&(Z||ve&&he)){const $e={};["status","statusText","headers"].forEach(_t=>{$e[_t]=fe[_t]});const Xe=Ye.toFiniteNumber(fe.headers.get("content-length")),[st,at]=Z&&f3(Xe,Ob(p3(Z),!0))||[];fe=new n(g3(fe.body,y3,st,()=>{at&&at(),he&&he()}),$e)}ie=ie||"text";let Re=await T[Ye.findKey(T,ie)||"text"](fe,O);return!ve&&he&&he(),await new Promise(($e,Xe)=>{M6($e,Xe,{data:Re,headers:ro.from(fe.headers),status:fe.status,statusText:fe.statusText,config:O,request:ue})})}catch(xe){throw he&&he(),xe&&xe.name==="TypeError"&&/Load failed|fetch/i.test(xe.message)?Object.assign(new ur("Network Error",ur.ERR_NETWORK,O,ue),{cause:xe.cause||xe}):ur.from(xe,xe&&xe.code,O,ue)}}},wce=new Map,D6=t=>{let e=t?t.env:{};const{fetch:r,Request:n,Response:s}=e,c=[n,s,r];let l=c.length,a=l,m,y,v=wce;for(;a--;)m=c[a],y=v.get(m),y===void 0&&v.set(m,y=a?new Map:bce(e)),v=y;return y};D6();const HE={http:Fle,xhr:mce,fetch:{get:D6}};Ye.forEach(HE,(t,e)=>{if(t){try{Object.defineProperty(t,"name",{value:e})}catch{}Object.defineProperty(t,"adapterName",{value:e})}});const b3=t=>`- ${t}`,Sce=t=>Ye.isFunction(t)||t===null||t===!1,L6={getAdapter:(t,e)=>{t=Ye.isArray(t)?t:[t];const{length:r}=t;let n,s;const c={};for(let l=0;l<r;l++){n=t[l];let a;if(s=n,!Sce(n)&&(s=HE[(a=String(n)).toLowerCase()],s===void 0))throw new ur(`Unknown adapter '${a}'`);if(s&&(Ye.isFunction(s)||(s=s.get(e))))break;c[a||"#"+l]=s}if(!s){const l=Object.entries(c).map(([m,y])=>`adapter ${m} `+(y===!1?"is not supported by the environment":"is not available in the build"));let a=r?l.length>1?`since :
`+l.map(b3).join(`
`):" "+b3(l[0]):"as no adapter specified";throw new ur("There is no suitable adapter to dispatch the request "+a,"ERR_NOT_SUPPORT")}return s},adapters:HE};function bS(t){if(t.cancelToken&&t.cancelToken.throwIfRequested(),t.signal&&t.signal.aborted)throw new Cm(null,t)}function w3(t){return bS(t),t.headers=ro.from(t.headers),t.data=xS.call(t,t.transformRequest),["post","put","patch"].indexOf(t.method)!==-1&&t.headers.setContentType("application/x-www-form-urlencoded",!1),L6.getAdapter(t.adapter||r_.adapter,t)(t).then(function(n){return bS(t),n.data=xS.call(t,t.transformResponse,n),n.headers=ro.from(n.headers),n},function(n){return k6(n)||(bS(t),n&&n.response&&(n.response.data=xS.call(t,t.transformResponse,n.response),n.response.headers=ro.from(n.response.headers))),Promise.reject(n)})}const O6="1.12.2",D1={};["object","boolean","number","function","string","symbol"].forEach((t,e)=>{D1[t]=function(n){return typeof n===t||"a"+(e<1?"n ":" ")+t}});const S3={};D1.transitional=function(e,r,n){function s(c,l){return"[Axios v"+O6+"] Transitional option '"+c+"'"+l+(n?". "+n:"")}return(c,l,a)=>{if(e===!1)throw new ur(s(l," has been removed"+(r?" in "+r:"")),ur.ERR_DEPRECATED);return r&&!S3[l]&&(S3[l]=!0,console.warn(s(l," has been deprecated since v"+r+" and will be removed in the near future"))),e?e(c,l,a):!0}};D1.spelling=function(e){return(r,n)=>(console.warn(`${n} is likely a misspelling of ${e}`),!0)};function Tce(t,e,r){if(typeof t!="object")throw new ur("options must be an object",ur.ERR_BAD_OPTION_VALUE);const n=Object.keys(t);let s=n.length;for(;s-- >0;){const c=n[s],l=e[c];if(l){const a=t[c],m=a===void 0||l(a,c,t);if(m!==!0)throw new ur("option "+c+" must be "+m,ur.ERR_BAD_OPTION_VALUE);continue}if(r!==!0)throw new ur("Unknown option "+c,ur.ERR_BAD_OPTION)}}const Lx={assertOptions:Tce,validators:D1},Za=Lx.validators;let yd=class{constructor(e){this.defaults=e||{},this.interceptors={request:new h3,response:new h3}}async request(e,r){try{return await this._request(e,r)}catch(n){if(n instanceof Error){let s={};Error.captureStackTrace?Error.captureStackTrace(s):s=new Error;const c=s.stack?s.stack.replace(/^.+\n/,""):"";try{n.stack?c&&!String(n.stack).endsWith(c.replace(/^.+\n.+\n/,""))&&(n.stack+=`
`+c):n.stack=c}catch{}}throw n}}_request(e,r){typeof e=="string"?(r=r||{},r.url=e):r=e||{},r=Cd(this.defaults,r);const{transitional:n,paramsSerializer:s,headers:c}=r;n!==void 0&&Lx.assertOptions(n,{silentJSONParsing:Za.transitional(Za.boolean),forcedJSONParsing:Za.transitional(Za.boolean),clarifyTimeoutError:Za.transitional(Za.boolean)},!1),s!=null&&(Ye.isFunction(s)?r.paramsSerializer={serialize:s}:Lx.assertOptions(s,{encode:Za.function,serialize:Za.function},!0)),r.allowAbsoluteUrls!==void 0||(this.defaults.allowAbsoluteUrls!==void 0?r.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:r.allowAbsoluteUrls=!0),Lx.assertOptions(r,{baseUrl:Za.spelling("baseURL"),withXsrfToken:Za.spelling("withXSRFToken")},!0),r.method=(r.method||this.defaults.method||"get").toLowerCase();let l=c&&Ye.merge(c.common,c[r.method]);c&&Ye.forEach(["delete","get","head","post","put","patch","common"],O=>{delete c[O]}),r.headers=ro.concat(l,c);const a=[];let m=!0;this.interceptors.request.forEach(function(I){typeof I.runWhen=="function"&&I.runWhen(r)===!1||(m=m&&I.synchronous,a.unshift(I.fulfilled,I.rejected))});const y=[];this.interceptors.response.forEach(function(I){y.push(I.fulfilled,I.rejected)});let v,T=0,P;if(!m){const O=[w3.bind(this),void 0];for(O.unshift(...a),O.push(...y),P=O.length,v=Promise.resolve(r);T<P;)v=v.then(O[T++],O[T++]);return v}P=a.length;let A=r;for(;T<P;){const O=a[T++],I=a[T++];try{A=O(A)}catch(L){I.call(this,L);break}}try{v=w3.call(this,A)}catch(O){return Promise.reject(O)}for(T=0,P=y.length;T<P;)v=v.then(y[T++],y[T++]);return v}getUri(e){e=Cd(this.defaults,e);const r=I6(e.baseURL,e.url,e.allowAbsoluteUrls);return C6(r,e.params,e.paramsSerializer)}};Ye.forEach(["delete","get","head","options"],function(e){yd.prototype[e]=function(r,n){return this.request(Cd(n||{},{method:e,url:r,data:(n||{}).data}))}});Ye.forEach(["post","put","patch"],function(e){function r(n){return function(c,l,a){return this.request(Cd(a||{},{method:e,headers:n?{"Content-Type":"multipart/form-data"}:{},url:c,data:l}))}}yd.prototype[e]=r(),yd.prototype[e+"Form"]=r(!0)});let Ece=class z6{constructor(e){if(typeof e!="function")throw new TypeError("executor must be a function.");let r;this.promise=new Promise(function(c){r=c});const n=this;this.promise.then(s=>{if(!n._listeners)return;let c=n._listeners.length;for(;c-- >0;)n._listeners[c](s);n._listeners=null}),this.promise.then=s=>{let c;const l=new Promise(a=>{n.subscribe(a),c=a}).then(s);return l.cancel=function(){n.unsubscribe(c)},l},e(function(c,l,a){n.reason||(n.reason=new Cm(c,l,a),r(n.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(e){if(this.reason){e(this.reason);return}this._listeners?this._listeners.push(e):this._listeners=[e]}unsubscribe(e){if(!this._listeners)return;const r=this._listeners.indexOf(e);r!==-1&&this._listeners.splice(r,1)}toAbortSignal(){const e=new AbortController,r=n=>{e.abort(n)};return this.subscribe(r),e.signal.unsubscribe=()=>this.unsubscribe(r),e.signal}static source(){let e;return{token:new z6(function(s){e=s}),cancel:e}}};function Cce(t){return function(r){return t.apply(null,r)}}function Pce(t){return Ye.isObject(t)&&t.isAxiosError===!0}const ZE={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(ZE).forEach(([t,e])=>{ZE[e]=t});function N6(t){const e=new yd(t),r=p6(yd.prototype.request,e);return Ye.extend(r,yd.prototype,e,{allOwnKeys:!0}),Ye.extend(r,e,null,{allOwnKeys:!0}),r.create=function(s){return N6(Cd(t,s))},r}const ti=N6(r_);ti.Axios=yd;ti.CanceledError=Cm;ti.CancelToken=Ece;ti.isCancel=k6;ti.VERSION=O6;ti.toFormData=R1;ti.AxiosError=ur;ti.Cancel=ti.CanceledError;ti.all=function(e){return Promise.all(e)};ti.spread=Cce;ti.isAxiosError=Pce;ti.mergeConfig=Cd;ti.AxiosHeaders=ro;ti.formToJSON=t=>A6(Ye.isHTMLForm(t)?new FormData(t):t);ti.getAdapter=L6.getAdapter;ti.HttpStatusCode=ZE;ti.default=ti;const{Axios:jue,AxiosError:Fue,CanceledError:Bue,isCancel:$ue,CancelToken:Vue,VERSION:Uue,all:Gue,Cancel:Wue,isAxiosError:que,spread:Hue,toFormData:Zue,AxiosHeaders:Kue,HttpStatusCode:Xue,formToJSON:Yue,getAdapter:Que,mergeConfig:Jue}=ti,Ace=({lng:t,lat:e,zoom:r})=>B.jsx(nr.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0,transition:{delay:1}},className:"fixed z-40 mt-24 px-6 py-3 bg-black/60 backdrop-blur-lg shadow-lg rounded-full text-center border-4 border-gray-300",style:{color:"white",top:"1.4rem",left:"40%"},children:B.jsxs("div",{className:"flex items-center space-x-4",children:[B.jsxs("div",{className:"flex flex-col",children:[B.jsx("span",{className:"text-xs",children:"Longitude"}),B.jsxs("span",{className:"font-medium",children:[t.toFixed(4),""]})]}),B.jsx("div",{className:"h-8 w-px bg-gray-300"}),B.jsxs("div",{className:"flex flex-col",children:[B.jsx("span",{className:"text-xs",children:"Latitude"}),B.jsxs("span",{className:"font-medium",children:[e.toFixed(4),""]})]}),B.jsx("div",{className:"h-8 w-px bg-gray-300"}),B.jsxs("div",{className:"flex flex-col",children:[B.jsx("span",{className:"text-xs",children:"Zoom"}),B.jsxs("span",{className:"font-medium",children:[r.toFixed(1),"x"]})]})]})});var kce={cm:!0,mm:!0,in:!0,px:!0,pt:!0,pc:!0,em:!0,ex:!0,ch:!0,rem:!0,vw:!0,vh:!0,vmin:!0,vmax:!0,"%":!0};function j6(t){if(typeof t=="number")return{value:t,unit:"px"};var e,r=(t.match(/^[0-9.]*/)||"").toString();r.includes(".")?e=parseFloat(r):e=parseInt(r,10);var n=(t.match(/[^0-9]*$/)||"").toString();return kce[n]?{value:e,unit:n}:(console.warn("React Spinners: ".concat(t," is not a valid css value. Defaulting to ").concat(e,"px.")),{value:e,unit:"px"})}function ix(t){var e=j6(t);return"".concat(e.value).concat(e.unit)}var KE=function(t,e,r){var n="react-spinners-".concat(t,"-").concat(r);if(typeof window>"u"||!window.document)return n;var s=document.createElement("style");document.head.appendChild(s);var c=s.sheet,l=`
    @keyframes `.concat(n,` {
      `).concat(e,`
    }
  `);return c&&c.insertRule(l,0),n},zb=function(){return zb=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++){e=arguments[r];for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&(t[s]=e[s])}return t},zb.apply(this,arguments)},Mce=function(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,n=Object.getOwnPropertySymbols(t);s<n.length;s++)e.indexOf(n[s])<0&&Object.prototype.propertyIsEnumerable.call(t,n[s])&&(r[n[s]]=t[n[s]]);return r},Ice=[KE("PacmanLoader","0% {transform: rotate(0deg)} 50% {transform: rotate(-44deg)}","pacman-1"),KE("PacmanLoader","0% {transform: rotate(0deg)} 50% {transform: rotate(44deg)}","pacman-2")];function Rce(t){var e=t.loading,r=e===void 0?!0:e,n=t.color,s=n===void 0?"#000000":n,c=t.speedMultiplier,l=c===void 0?1:c,a=t.cssOverride,m=a===void 0?{}:a,y=t.size,v=y===void 0?25:y,T=t.margin,P=T===void 0?2:T,A=Mce(t,["loading","color","speedMultiplier","cssOverride","size","margin"]),O=j6(v),I=O.value,L=O.unit,R=zb({display:"inherit",position:"relative",fontSize:0,height:"".concat(I*2).concat(L),width:"".concat(I*2).concat(L)},m),z=KE("PacmanLoader",`75% {opacity: 0.7}
    100% {transform: translate(`.concat("".concat(-4*I).concat(L),", ").concat("".concat(-I/4).concat(L),")}"),"ball"),j=function(q){return{width:"".concat(I/3).concat(L),height:"".concat(I/3).concat(L),backgroundColor:s,margin:ix(P),borderRadius:"100%",transform:"translate(0, ".concat("".concat(-I/4).concat(L),")"),position:"absolute",top:"".concat(I).concat(L),left:"".concat(I*4).concat(L),animation:"".concat(z," ").concat(1/l,"s ").concat(q*.25,"s infinite linear"),animationFillMode:"both"}},W="".concat(ix(v)," solid transparent"),Z="".concat(ix(v)," solid ").concat(s),te=function(q){return{width:0,height:0,borderRight:W,borderTop:q===0?W:Z,borderLeft:Z,borderBottom:q===0?Z:W,borderRadius:ix(v),position:"absolute",animation:"".concat(Ice[q]," ").concat(.8/l,"s infinite ease-in-out"),animationFillMode:"both"}},ie=te(0),V=te(1);return r?X.createElement("span",zb({style:R},A),X.createElement("span",{style:ie}),X.createElement("span",{style:V}),X.createElement("span",{style:j(2)}),X.createElement("span",{style:j(3)}),X.createElement("span",{style:j(4)}),X.createElement("span",{style:j(5)})):null}const Dce=({markerPos:t,season:e,onSeasonChange:r,onSubmit:n,data:s,ai_crop_thingy:c})=>{const[l,a]=X.useState(!1),[m,y]=X.useState(!1);if(!t)return null;const v=()=>{y(!0),n()};return s!==void 0&&m&&y(!1),B.jsx("div",{className:"scrollable-container",children:B.jsxs(nr.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:20},className:"border-gray-100 absolute right-12 top-32 z-40 w-80 rounded-2xl border bg-black/60 p-6 shadow-xl",style:{color:"white"},children:[B.jsx("h3",{className:"text-white-900 mb-1 text-lg font-semibold text-center",children:"Location Details"}),B.jsxs("div",{className:"space-y-2",children:[B.jsxs("div",{className:"space-y-1",children:[B.jsxs("div",{className:"flex items-center",children:[B.jsx("div",{className:"bg-emerald-500 rounded-full"}),B.jsx("span",{className:"text-white-600 text-sm font-bold",children:"Longitude"})]}),B.jsxs("span",{className:"block text-lg",children:[t.lng.toFixed(4),""]})]}),B.jsxs("div",{className:"space-y-1",children:[B.jsxs("div",{className:"flex items-center",children:[B.jsx("div",{className:"bg-emerald-500 rounded-full"}),B.jsx("span",{className:"text-white-600 text-sm font-bold",children:"Latitude"})]}),B.jsxs("span",{className:"block text-lg font-medium",children:[t.lat.toFixed(4),""]})]}),B.jsxs("div",{className:"space-y-1",children:[B.jsx("label",{className:"text-white-600 block text-sm font-bold",children:"Season"}),B.jsxs("select",{value:e,onChange:T=>r(T.target.value),className:"border-gray-200 focus:ring-emerald-500 focus:border-transparent w-full rounded-lg border bg-black px-4 py-1 text-center font-bold outline-none transition-all focus:ring-2",children:[B.jsx("option",{value:"Winter",children:"Winter"}),B.jsx("option",{value:"Spring",children:"Spring"}),B.jsx("option",{value:"Summer",children:"Summer"}),B.jsx("option",{value:"Fall",children:"Fall"})]})]}),B.jsx("button",{onClick:v,className:"bg-emerald-500 hover:bg-emerald-600 focus:ring-emerald-500 w-full rounded-lg border px-4 py-2 font-medium transition-colors focus:ring-2 focus:ring-offset-2",children:"Retrieve Weather Data"}),B.jsxs("div",{className:"mt-6 space-y-2",children:[B.jsx("h4",{className:"text-white-900 font-medium",children:"Weather Data"}),B.jsx("div",{className:"bg-gray-50 rounded-lg p-4",children:m?B.jsx("div",{className:"flex justify-center py-4",children:B.jsx(Rce,{color:"#10b981",size:25,speedMultiplier:3})}):B.jsx("div",{className:"space-y-2",children:Object.entries(s||{}).map(([T,P])=>B.jsxs("div",{className:"flex items-center justify-between",children:[B.jsx("span",{className:"text-gray-600 text-sm capitalize",children:T.replace(/_/g," ")}),B.jsx("span",{className:"font-medium text-black",children:typeof P=="number"?P.toFixed(3):P})]},T))})})]}),B.jsxs("div",{className:"mt-6 space-y-2",children:[B.jsx("button",{onClick:()=>a(!l),className:"bg-emerald-500 hover:bg-emerald-600 focus:ring-emerald-500 w-full rounded-lg border px-4 py-0.5 font-medium transition-colors focus:ring-2 focus:ring-offset-2",children:" Crop Recommendations "}),l&&B.jsx("div",{className:"bg-gray-50 mt-2 rounded-lg p-4 text-black",children:c})]})]})]})})},wS="9whJnEiegefRuWcEWJgD",Lce=({navBar:t,initLng:e,initLat:r,markerInitPos:n,initZoom:s,setInitLng:c,setInitLat:l,setInitMarkPos:a,setInitZoom:m})=>{const y=X.useRef(null),v=X.useRef(null),[T,P]=X.useState(e),[A,O]=X.useState(r),[I,L]=X.useState(s),[R,z]=X.useState(ce()),[j,W]=X.useState(n),Z=X.useRef(null),[te,ie]=X.useState(void 0),[V,q]=X.useState(void 0),Q=o5();function ce(){const ue=new Date().getMonth()+1;return ue===12||ue===1||ue===2?"Winter":ue>=3&&ue<=5?"Spring":ue>=6&&ue<=8?"Summer":"Fall"}X.useEffect(()=>{if(v.current)return;v.current=new ly.Map({container:y.current,style:`https://api.maptiler.com/maps/f8f7d758-8ad6-42b9-a56c-e29abc616091/style.json?key=${wS}`,center:[T,A],zoom:I});const ue=new ly.NavigationControl;v.current.addControl(ue,"bottom-right");const he=new Jae({apiKey:wS});v.current.addControl(he,"bottom-left");const ye=new ly.GeolocateControl({positionOptions:{enableHighAccuracy:!0},trackUserLocation:!0});v.current.addControl(ye,"bottom-right"),v.current.on("move",()=>{if(!v.current)return;const xe=v.current.getCenter(),Se=v.current.getZoom();P(xe.lng),O(xe.lat),L(Se),c(xe.lng),l(xe.lat),m(Se)}),v.current.on("click",xe=>{W(xe.lngLat),a(xe.lngLat)})},[wS,T,A,I]),X.useEffect(()=>{if(!v.current||!j)return;let ue;if(Z.current&&(ue=Z.current.getLngLat(),Z.current.remove(),ie(void 0)),!ue||j.lng!==ue.lng||j.lat!==ue.lat){const he=new ly.Marker({color:"#10b981",scale:1.2}).setLngLat([j.lng,j.lat]).addTo(v.current);Z.current=he}else W(null)},[j]);async function se(ue,he){ie(void 0);const ye={longitude:ue,latitude:he,season:R};try{const xe=await ti.get("http://127.0.0.1:5000/get-weather",{params:ye,validateStatus:Se=>!0});ie(xe.data.Weather_Response),q(xe.data.AI_Response)}catch(xe){console.error("Error fetching weather data:",xe),ie({error:"Failed to fetch weather data"})}}return B.jsxs("div",{className:"relative h-screen w-screen overflow-hidden",children:[t,B.jsx(Ace,{lng:T,lat:A,zoom:I}),B.jsx(Dce,{markerPos:j,season:R,onSeasonChange:z,onSubmit:()=>se(j.lng,j.lat),data:te,ai_crop_thingy:V}),j&&B.jsx(nr.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},className:"border-gray-100 absolute left-12 top-32 z-40 w-80 rounded-2xl border bg-black/60 p-3 shadow-xl",style:{color:"white"},children:B.jsx("button",{onClick:()=>{Q("/account",{state:{addingFarmFromMap:!0,selectedLocation:j.lng.toFixed(3)+", "+j.lat.toFixed(3)}})},className:"bg-emerald-500 hover:bg-emerald-600 focus:ring-emerald-500 w-full rounded-lg border px-4 py-2 font-medium transition-colors focus:ring-2 focus:ring-offset-2",children:"+ Add Farm"})}),B.jsx("div",{ref:y,className:"map absolute inset-0 z-0"})]})},Oce=()=>{const t=gm();return X.useEffect(()=>{console.error("404 Error: User attempted to access non-existent route:",t.pathname)},[t.pathname]),B.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-100",children:B.jsxs("div",{className:"text-center",children:[B.jsx("h1",{className:"text-4xl font-bold mb-4",children:"Womp Womp"}),B.jsx("p",{className:"text-xl text-gray-600 mb-4",children:"Wrong URL Entered"}),B.jsx("a",{href:"/",className:"text-blue-500 hover:text-blue-700 underline",children:"Return to Home?"})]})})};function zce(t){return Object.prototype.toString.call(t)==="[object Object]"}function T3(t){return zce(t)||Array.isArray(t)}function Nce(){return!!(typeof window<"u"&&window.document&&window.document.createElement)}function TA(t,e){const r=Object.keys(t),n=Object.keys(e);if(r.length!==n.length)return!1;const s=JSON.stringify(Object.keys(t.breakpoints||{})),c=JSON.stringify(Object.keys(e.breakpoints||{}));return s!==c?!1:r.every(l=>{const a=t[l],m=e[l];return typeof a=="function"?`${a}`==`${m}`:!T3(a)||!T3(m)?a===m:TA(a,m)})}function E3(t){return t.concat().sort((e,r)=>e.name>r.name?1:-1).map(e=>e.options)}function jce(t,e){if(t.length!==e.length)return!1;const r=E3(t),n=E3(e);return r.every((s,c)=>{const l=n[c];return TA(s,l)})}function EA(t){return typeof t=="number"}function XE(t){return typeof t=="string"}function L1(t){return typeof t=="boolean"}function C3(t){return Object.prototype.toString.call(t)==="[object Object]"}function Ln(t){return Math.abs(t)}function CA(t){return Math.sign(t)}function Fy(t,e){return Ln(t-e)}function Fce(t,e){if(t===0||e===0||Ln(t)<=Ln(e))return 0;const r=Fy(Ln(t),Ln(e));return Ln(r/t)}function Bce(t){return Math.round(t*100)/100}function k0(t){return M0(t).map(Number)}function Pa(t){return t[n_(t)]}function n_(t){return Math.max(0,t.length-1)}function PA(t,e){return e===n_(t)}function P3(t,e=0){return Array.from(Array(t),(r,n)=>e+n)}function M0(t){return Object.keys(t)}function F6(t,e){return[t,e].reduce((r,n)=>(M0(n).forEach(s=>{const c=r[s],l=n[s],a=C3(c)&&C3(l);r[s]=a?F6(c,l):l}),r),{})}function YE(t,e){return typeof e.MouseEvent<"u"&&t instanceof e.MouseEvent}function $ce(t,e){const r={start:n,center:s,end:c};function n(){return 0}function s(m){return c(m)/2}function c(m){return e-m}function l(m,y){return XE(t)?r[t](m):t(e,m,y)}return{measure:l}}function I0(){let t=[];function e(s,c,l,a={passive:!0}){let m;if("addEventListener"in s)s.addEventListener(c,l,a),m=()=>s.removeEventListener(c,l,a);else{const y=s;y.addListener(l),m=()=>y.removeListener(l)}return t.push(m),n}function r(){t=t.filter(s=>s())}const n={add:e,clear:r};return n}function Vce(t,e,r,n){const s=I0(),c=1e3/60;let l=null,a=0,m=0;function y(){s.add(t,"visibilitychange",()=>{t.hidden&&O()})}function v(){A(),s.clear()}function T(L){if(!m)return;l||(l=L,r(),r());const R=L-l;for(l=L,a+=R;a>=c;)r(),a-=c;const z=a/c;n(z),m&&(m=e.requestAnimationFrame(T))}function P(){m||(m=e.requestAnimationFrame(T))}function A(){e.cancelAnimationFrame(m),l=null,a=0,m=0}function O(){l=null,a=0}return{init:y,destroy:v,start:P,stop:A,update:r,render:n}}function Uce(t,e){const r=e==="rtl",n=t==="y",s=n?"y":"x",c=n?"x":"y",l=!n&&r?-1:1,a=v(),m=T();function y(O){const{height:I,width:L}=O;return n?I:L}function v(){return n?"top":r?"right":"left"}function T(){return n?"bottom":r?"left":"right"}function P(O){return O*l}return{scroll:s,cross:c,startEdge:a,endEdge:m,measureSize:y,direction:P}}function Pd(t=0,e=0){const r=Ln(t-e);function n(y){return y<t}function s(y){return y>e}function c(y){return n(y)||s(y)}function l(y){return c(y)?n(y)?t:e:y}function a(y){return r?y-r*Math.ceil((y-e)/r):y}return{length:r,max:e,min:t,constrain:l,reachedAny:c,reachedMax:s,reachedMin:n,removeOffset:a}}function B6(t,e,r){const{constrain:n}=Pd(0,t),s=t+1;let c=l(e);function l(P){return r?Ln((s+P)%s):n(P)}function a(){return c}function m(P){return c=l(P),T}function y(P){return v().set(a()+P)}function v(){return B6(t,a(),r)}const T={get:a,set:m,add:y,clone:v};return T}function Gce(t,e,r,n,s,c,l,a,m,y,v,T,P,A,O,I,L,R,z){const{cross:j,direction:W}=t,Z=["INPUT","SELECT","TEXTAREA"],te={passive:!1},ie=I0(),V=I0(),q=Pd(50,225).constrain(A.measure(20)),Q={mouse:300,touch:400},ce={mouse:500,touch:600},se=O?43:25;let ue=!1,he=0,ye=0,xe=!1,Se=!1,fe=!1,ve=!1;function Re(vt){if(!z)return;function Et(Ft){(L1(z)||z(vt,Ft))&&Ct(Ft)}const Rt=e;ie.add(Rt,"dragstart",Ft=>Ft.preventDefault(),te).add(Rt,"touchmove",()=>{},te).add(Rt,"touchend",()=>{}).add(Rt,"touchstart",Et).add(Rt,"mousedown",Et).add(Rt,"touchcancel",Ht).add(Rt,"contextmenu",Ht).add(Rt,"click",ir,!0)}function $e(){ie.clear(),V.clear()}function Xe(){const vt=ve?r:e;V.add(vt,"touchmove",Pt,te).add(vt,"touchend",Ht).add(vt,"mousemove",Pt,te).add(vt,"mouseup",Ht)}function st(vt){const Et=vt.nodeName||"";return Z.includes(Et)}function at(){return(O?ce:Q)[ve?"mouse":"touch"]}function _t(vt,Et){const Rt=T.add(CA(vt)*-1),Ft=v.byDistance(vt,!O).distance;return O||Ln(vt)<q?Ft:L&&Et?Ft*.5:v.byIndex(Rt.get(),0).distance}function Ct(vt){const Et=YE(vt,n);ve=Et,fe=O&&Et&&!vt.buttons&&ue,ue=Fy(s.get(),l.get())>=2,!(Et&&vt.button!==0)&&(st(vt.target)||(xe=!0,c.pointerDown(vt),y.useFriction(0).useDuration(0),s.set(l),Xe(),he=c.readPoint(vt),ye=c.readPoint(vt,j),P.emit("pointerDown")))}function Pt(vt){if(!YE(vt,n)&&vt.touches.length>=2)return Ht(vt);const Rt=c.readPoint(vt),Ft=c.readPoint(vt,j),Nr=Fy(Rt,he),Zr=Fy(Ft,ye);if(!Se&&!ve&&(!vt.cancelable||(Se=Nr>Zr,!Se)))return Ht(vt);const Kr=c.pointerMove(vt);Nr>I&&(fe=!0),y.useFriction(.3).useDuration(.75),a.start(),s.add(W(Kr)),vt.preventDefault()}function Ht(vt){const Rt=v.byDistance(0,!1).index!==T.get(),Ft=c.pointerUp(vt)*at(),Nr=_t(W(Ft),Rt),Zr=Fce(Ft,Nr),Kr=se-10*Zr,Ar=R+Zr/50;Se=!1,xe=!1,V.clear(),y.useDuration(Kr).useFriction(Ar),m.distance(Nr,!O),ve=!1,P.emit("pointerUp")}function ir(vt){fe&&(vt.stopPropagation(),vt.preventDefault(),fe=!1)}function yr(){return xe}return{init:Re,destroy:$e,pointerDown:yr}}function Wce(t,e){let n,s;function c(T){return T.timeStamp}function l(T,P){const O=`client${(P||t.scroll)==="x"?"X":"Y"}`;return(YE(T,e)?T:T.touches[0])[O]}function a(T){return n=T,s=T,l(T)}function m(T){const P=l(T)-l(s),A=c(T)-c(n)>170;return s=T,A&&(n=T),P}function y(T){if(!n||!s)return 0;const P=l(s)-l(n),A=c(T)-c(n),O=c(T)-c(s)>170,I=P/A;return A&&!O&&Ln(I)>.1?I:0}return{pointerDown:a,pointerMove:m,pointerUp:y,readPoint:l}}function qce(){function t(r){const{offsetTop:n,offsetLeft:s,offsetWidth:c,offsetHeight:l}=r;return{top:n,right:s+c,bottom:n+l,left:s,width:c,height:l}}return{measure:t}}function Hce(t){function e(n){return t*(n/100)}return{measure:e}}function Zce(t,e,r,n,s,c,l){const a=[t].concat(n);let m,y,v=[],T=!1;function P(L){return s.measureSize(l.measure(L))}function A(L){if(!c)return;y=P(t),v=n.map(P);function R(z){for(const j of z){if(T)return;const W=j.target===t,Z=n.indexOf(j.target),te=W?y:v[Z],ie=P(W?t:n[Z]);if(Ln(ie-te)>=.5){L.reInit(),e.emit("resize");break}}}m=new ResizeObserver(z=>{(L1(c)||c(L,z))&&R(z)}),r.requestAnimationFrame(()=>{a.forEach(z=>m.observe(z))})}function O(){T=!0,m&&m.disconnect()}return{init:A,destroy:O}}function Kce(t,e,r,n,s,c){let l=0,a=0,m=s,y=c,v=t.get(),T=0;function P(){const te=n.get()-t.get(),ie=!m;let V=0;return ie?(l=0,r.set(n),t.set(n),V=te):(r.set(t),l+=te/m,l*=y,v+=l,t.add(l),V=v-T),a=CA(V),T=v,Z}function A(){const te=n.get()-e.get();return Ln(te)<.001}function O(){return m}function I(){return a}function L(){return l}function R(){return j(s)}function z(){return W(c)}function j(te){return m=te,Z}function W(te){return y=te,Z}const Z={direction:I,duration:O,velocity:L,seek:P,settled:A,useBaseFriction:z,useBaseDuration:R,useFriction:W,useDuration:j};return Z}function Xce(t,e,r,n,s){const c=s.measure(10),l=s.measure(50),a=Pd(.1,.99);let m=!1;function y(){return!(m||!t.reachedAny(r.get())||!t.reachedAny(e.get()))}function v(A){if(!y())return;const O=t.reachedMin(e.get())?"min":"max",I=Ln(t[O]-e.get()),L=r.get()-e.get(),R=a.constrain(I/l);r.subtract(L*R),!A&&Ln(L)<c&&(r.set(t.constrain(r.get())),n.useDuration(25).useBaseFriction())}function T(A){m=!A}return{shouldConstrain:y,constrain:v,toggleActive:T}}function Yce(t,e,r,n,s){const c=Pd(-e+t,0),l=T(),a=v(),m=P();function y(O,I){return Fy(O,I)<=1}function v(){const O=l[0],I=Pa(l),L=l.lastIndexOf(O),R=l.indexOf(I)+1;return Pd(L,R)}function T(){return r.map((O,I)=>{const{min:L,max:R}=c,z=c.constrain(O),j=!I,W=PA(r,I);return j?R:W||y(L,z)?L:y(R,z)?R:z}).map(O=>parseFloat(O.toFixed(3)))}function P(){if(e<=t+s)return[c.max];if(n==="keepSnaps")return l;const{min:O,max:I}=a;return l.slice(O,I)}return{snapsContained:m,scrollContainLimit:a}}function Qce(t,e,r){const n=e[0],s=r?n-t:Pa(e);return{limit:Pd(s,n)}}function Jce(t,e,r,n){const c=e.min+.1,l=e.max+.1,{reachedMin:a,reachedMax:m}=Pd(c,l);function y(P){return P===1?m(r.get()):P===-1?a(r.get()):!1}function v(P){if(!y(P))return;const A=t*(P*-1);n.forEach(O=>O.add(A))}return{loop:v}}function eue(t){const{max:e,length:r}=t;function n(c){const l=c-e;return r?l/-r:0}return{get:n}}function tue(t,e,r,n,s){const{startEdge:c,endEdge:l}=t,{groupSlides:a}=s,m=T().map(e.measure),y=P(),v=A();function T(){return a(n).map(I=>Pa(I)[l]-I[0][c]).map(Ln)}function P(){return n.map(I=>r[c]-I[c]).map(I=>-Ln(I))}function A(){return a(y).map(I=>I[0]).map((I,L)=>I+m[L])}return{snaps:y,snapsAligned:v}}function rue(t,e,r,n,s,c){const{groupSlides:l}=s,{min:a,max:m}=n,y=v();function v(){const P=l(c),A=!t||e==="keepSnaps";return r.length===1?[c]:A?P:P.slice(a,m).map((O,I,L)=>{const R=!I,z=PA(L,I);if(R){const j=Pa(L[0])+1;return P3(j)}if(z){const j=n_(c)-Pa(L)[0]+1;return P3(j,Pa(L)[0])}return O})}return{slideRegistry:y}}function nue(t,e,r,n,s){const{reachedAny:c,removeOffset:l,constrain:a}=n;function m(O){return O.concat().sort((I,L)=>Ln(I)-Ln(L))[0]}function y(O){const I=t?l(O):a(O),L=e.map((z,j)=>({diff:v(z-I,0),index:j})).sort((z,j)=>Ln(z.diff)-Ln(j.diff)),{index:R}=L[0];return{index:R,distance:I}}function v(O,I){const L=[O,O+r,O-r];if(!t)return O;if(!I)return m(L);const R=L.filter(z=>CA(z)===I);return R.length?m(R):Pa(L)-r}function T(O,I){const L=e[O]-s.get(),R=v(L,I);return{index:O,distance:R}}function P(O,I){const L=s.get()+O,{index:R,distance:z}=y(L),j=!t&&c(L);if(!I||j)return{index:R,distance:O};const W=e[R]-z,Z=O+v(W,0);return{index:R,distance:Z}}return{byDistance:P,byIndex:T,shortcut:v}}function iue(t,e,r,n,s,c,l){function a(T){const P=T.distance,A=T.index!==e.get();c.add(P),P&&(n.duration()?t.start():(t.update(),t.render(1),t.update())),A&&(r.set(e.get()),e.set(T.index),l.emit("select"))}function m(T,P){const A=s.byDistance(T,P);a(A)}function y(T,P){const A=e.clone().set(T),O=s.byIndex(A.get(),P);a(O)}return{distance:m,index:y}}function sue(t,e,r,n,s,c,l,a){const m={passive:!0,capture:!0};let y=0;function v(A){if(!a)return;function O(I){if(new Date().getTime()-y>10)return;l.emit("slideFocusStart"),t.scrollLeft=0;const z=r.findIndex(j=>j.includes(I));EA(z)&&(s.useDuration(0),n.index(z,0),l.emit("slideFocus"))}c.add(document,"keydown",T,!1),e.forEach((I,L)=>{c.add(I,"focus",R=>{(L1(a)||a(A,R))&&O(L)},m)})}function T(A){A.code==="Tab"&&(y=new Date().getTime())}return{init:v}}function fy(t){let e=t;function r(){return e}function n(m){e=l(m)}function s(m){e+=l(m)}function c(m){e-=l(m)}function l(m){return EA(m)?m:m.get()}return{get:r,set:n,add:s,subtract:c}}function $6(t,e){const r=t.scroll==="x"?l:a,n=e.style;let s=null,c=!1;function l(P){return`translate3d(${P}px,0px,0px)`}function a(P){return`translate3d(0px,${P}px,0px)`}function m(P){if(c)return;const A=Bce(t.direction(P));A!==s&&(n.transform=r(A),s=A)}function y(P){c=!P}function v(){c||(n.transform="",e.getAttribute("style")||e.removeAttribute("style"))}return{clear:v,to:m,toggleActive:y}}function oue(t,e,r,n,s,c,l,a,m){const v=k0(s),T=k0(s).reverse(),P=R().concat(z());function A(ie,V){return ie.reduce((q,Q)=>q-s[Q],V)}function O(ie,V){return ie.reduce((q,Q)=>A(q,V)>0?q.concat([Q]):q,[])}function I(ie){return c.map((V,q)=>({start:V-n[q]+.5+ie,end:V+e-.5+ie}))}function L(ie,V,q){const Q=I(V);return ie.map(ce=>{const se=q?0:-r,ue=q?r:0,he=q?"end":"start",ye=Q[ce][he];return{index:ce,loopPoint:ye,slideLocation:fy(-1),translate:$6(t,m[ce]),target:()=>a.get()>ye?se:ue}})}function R(){const ie=l[0],V=O(T,ie);return L(V,r,!1)}function z(){const ie=e-l[0]-1,V=O(v,ie);return L(V,-r,!0)}function j(){return P.every(({index:ie})=>{const V=v.filter(q=>q!==ie);return A(V,e)<=.1})}function W(){P.forEach(ie=>{const{target:V,translate:q,slideLocation:Q}=ie,ce=V();ce!==Q.get()&&(q.to(ce),Q.set(ce))})}function Z(){P.forEach(ie=>ie.translate.clear())}return{canLoop:j,clear:Z,loop:W,loopPoints:P}}function aue(t,e,r){let n,s=!1;function c(m){if(!r)return;function y(v){for(const T of v)if(T.type==="childList"){m.reInit(),e.emit("slidesChanged");break}}n=new MutationObserver(v=>{s||(L1(r)||r(m,v))&&y(v)}),n.observe(t,{childList:!0})}function l(){n&&n.disconnect(),s=!0}return{init:c,destroy:l}}function lue(t,e,r,n){const s={};let c=null,l=null,a,m=!1;function y(){a=new IntersectionObserver(O=>{m||(O.forEach(I=>{const L=e.indexOf(I.target);s[L]=I}),c=null,l=null,r.emit("slidesInView"))},{root:t.parentElement,threshold:n}),e.forEach(O=>a.observe(O))}function v(){a&&a.disconnect(),m=!0}function T(O){return M0(s).reduce((I,L)=>{const R=parseInt(L),{isIntersecting:z}=s[R];return(O&&z||!O&&!z)&&I.push(R),I},[])}function P(O=!0){if(O&&c)return c;if(!O&&l)return l;const I=T(O);return O&&(c=I),O||(l=I),I}return{init:y,destroy:v,get:P}}function cue(t,e,r,n,s,c){const{measureSize:l,startEdge:a,endEdge:m}=t,y=r[0]&&s,v=O(),T=I(),P=r.map(l),A=L();function O(){if(!y)return 0;const z=r[0];return Ln(e[a]-z[a])}function I(){if(!y)return 0;const z=c.getComputedStyle(Pa(n));return parseFloat(z.getPropertyValue(`margin-${m}`))}function L(){return r.map((z,j,W)=>{const Z=!j,te=PA(W,j);return Z?P[j]+v:te?P[j]+T:W[j+1][a]-z[a]}).map(Ln)}return{slideSizes:P,slideSizesWithGaps:A,startGap:v,endGap:T}}function uue(t,e,r,n,s,c,l,a,m){const{startEdge:y,endEdge:v,direction:T}=t,P=EA(r);function A(R,z){return k0(R).filter(j=>j%z===0).map(j=>R.slice(j,j+z))}function O(R){return R.length?k0(R).reduce((z,j,W)=>{const Z=Pa(z)||0,te=Z===0,ie=j===n_(R),V=s[y]-c[Z][y],q=s[y]-c[j][v],Q=!n&&te?T(l):0,ce=!n&&ie?T(a):0,se=Ln(q-ce-(V+Q));return W&&se>e+m&&z.push(j),ie&&z.push(R.length),z},[]).map((z,j,W)=>{const Z=Math.max(W[j-1]||0);return R.slice(Z,z)}):[]}function I(R){return P?A(R,r):O(R)}return{groupSlides:I}}function hue(t,e,r,n,s,c,l){const{align:a,axis:m,direction:y,startIndex:v,loop:T,duration:P,dragFree:A,dragThreshold:O,inViewThreshold:I,slidesToScroll:L,skipSnaps:R,containScroll:z,watchResize:j,watchSlides:W,watchDrag:Z,watchFocus:te}=c,ie=2,V=qce(),q=V.measure(e),Q=r.map(V.measure),ce=Uce(m,y),se=ce.measureSize(q),ue=Hce(se),he=$ce(a,se),ye=!T&&!!z,xe=T||!!z,{slideSizes:Se,slideSizesWithGaps:fe,startGap:ve,endGap:Re}=cue(ce,q,Q,r,xe,s),$e=uue(ce,se,L,T,q,Q,ve,Re,ie),{snaps:Xe,snapsAligned:st}=tue(ce,he,q,Q,$e),at=-Pa(Xe)+Pa(fe),{snapsContained:_t,scrollContainLimit:Ct}=Yce(se,at,st,z,ie),Pt=ye?_t:st,{limit:Ht}=Qce(at,Pt,T),ir=B6(n_(Pt),v,T),yr=ir.clone(),$t=k0(r),vt=({dragHandler:ne,scrollBody:oe,scrollBounds:de,options:{loop:we}})=>{we||de.constrain(ne.pointerDown()),oe.seek()},Et=({scrollBody:ne,translate:oe,location:de,offsetLocation:we,previousLocation:Ae,scrollLooper:Oe,slideLooper:Be,dragHandler:ze,animation:He,eventHandler:nt,scrollBounds:Qe,options:{loop:Tt}},It)=>{const je=ne.settled(),Kt=!Qe.shouldConstrain(),wt=Tt?je:je&&Kt,lt=wt&&!ze.pointerDown();lt&&He.stop();const Dt=de.get()*It+Ae.get()*(1-It);we.set(Dt),Tt&&(Oe.loop(ne.direction()),Be.loop()),oe.to(we.get()),lt&&nt.emit("settle"),wt||nt.emit("scroll")},Rt=Vce(n,s,()=>vt(Me),ne=>Et(Me,ne)),Ft=.68,Nr=Pt[ir.get()],Zr=fy(Nr),Kr=fy(Nr),Ar=fy(Nr),Gn=fy(Nr),Nn=Kce(Zr,Ar,Kr,Gn,P,Ft),xi=nue(T,Pt,at,Ht,Gn),rn=iue(Rt,ir,yr,Nn,xi,Gn,l),Zt=eue(Ht),Or=I0(),St=lue(e,r,l,I),{slideRegistry:Sn}=rue(ye,z,Pt,Ct,$e,$t),Br=sue(t,r,Sn,rn,Nn,Or,l,te),Me={ownerDocument:n,ownerWindow:s,eventHandler:l,containerRect:q,slideRects:Q,animation:Rt,axis:ce,dragHandler:Gce(ce,t,n,s,Gn,Wce(ce,s),Zr,Rt,rn,Nn,xi,ir,l,ue,A,O,R,Ft,Z),eventStore:Or,percentOfView:ue,index:ir,indexPrevious:yr,limit:Ht,location:Zr,offsetLocation:Ar,previousLocation:Kr,options:c,resizeHandler:Zce(e,l,s,r,ce,j,V),scrollBody:Nn,scrollBounds:Xce(Ht,Ar,Gn,Nn,ue),scrollLooper:Jce(at,Ht,Ar,[Zr,Ar,Kr,Gn]),scrollProgress:Zt,scrollSnapList:Pt.map(Zt.get),scrollSnaps:Pt,scrollTarget:xi,scrollTo:rn,slideLooper:oue(ce,se,at,Se,fe,Xe,Pt,Ar,r),slideFocus:Br,slidesHandler:aue(e,l,W),slidesInView:St,slideIndexes:$t,slideRegistry:Sn,slidesToScroll:$e,target:Gn,translate:$6(ce,e)};return Me}function due(){let t={},e;function r(y){e=y}function n(y){return t[y]||[]}function s(y){return n(y).forEach(v=>v(e,y)),m}function c(y,v){return t[y]=n(y).concat([v]),m}function l(y,v){return t[y]=n(y).filter(T=>T!==v),m}function a(){t={}}const m={init:r,emit:s,off:l,on:c,clear:a};return m}const fue={align:"center",axis:"x",container:null,slides:null,containScroll:"trimSnaps",direction:"ltr",slidesToScroll:1,inViewThreshold:0,breakpoints:{},dragFree:!1,dragThreshold:10,loop:!1,skipSnaps:!1,duration:25,startIndex:0,active:!0,watchDrag:!0,watchResize:!0,watchSlides:!0,watchFocus:!0};function pue(t){function e(c,l){return F6(c,l||{})}function r(c){const l=c.breakpoints||{},a=M0(l).filter(m=>t.matchMedia(m).matches).map(m=>l[m]).reduce((m,y)=>e(m,y),{});return e(c,a)}function n(c){return c.map(l=>M0(l.breakpoints||{})).reduce((l,a)=>l.concat(a),[]).map(t.matchMedia)}return{mergeOptions:e,optionsAtMedia:r,optionsMediaQueries:n}}function mue(t){let e=[];function r(c,l){return e=l.filter(({options:a})=>t.optionsAtMedia(a).active!==!1),e.forEach(a=>a.init(c,t)),l.reduce((a,m)=>Object.assign(a,{[m.name]:m}),{})}function n(){e=e.filter(c=>c.destroy())}return{init:r,destroy:n}}function Nb(t,e,r){const n=t.ownerDocument,s=n.defaultView,c=pue(s),l=mue(c),a=I0(),m=due(),{mergeOptions:y,optionsAtMedia:v,optionsMediaQueries:T}=c,{on:P,off:A,emit:O}=m,I=ce;let L=!1,R,z=y(fue,Nb.globalOptions),j=y(z),W=[],Z,te,ie;function V(){const{container:$t,slides:vt}=j;te=(XE($t)?t.querySelector($t):$t)||t.children[0];const Rt=XE(vt)?te.querySelectorAll(vt):vt;ie=[].slice.call(Rt||te.children)}function q($t){const vt=hue(t,te,ie,n,s,$t,m);if($t.loop&&!vt.slideLooper.canLoop()){const Et=Object.assign({},$t,{loop:!1});return q(Et)}return vt}function Q($t,vt){L||(z=y(z,$t),j=v(z),W=vt||W,V(),R=q(j),T([z,...W.map(({options:Et})=>Et)]).forEach(Et=>a.add(Et,"change",ce)),j.active&&(R.translate.to(R.location.get()),R.animation.init(),R.slidesInView.init(),R.slideFocus.init(yr),R.eventHandler.init(yr),R.resizeHandler.init(yr),R.slidesHandler.init(yr),R.options.loop&&R.slideLooper.loop(),te.offsetParent&&ie.length&&R.dragHandler.init(yr),Z=l.init(yr,W)))}function ce($t,vt){const Et=$e();se(),Q(y({startIndex:Et},$t),vt),m.emit("reInit")}function se(){R.dragHandler.destroy(),R.eventStore.clear(),R.translate.clear(),R.slideLooper.clear(),R.resizeHandler.destroy(),R.slidesHandler.destroy(),R.slidesInView.destroy(),R.animation.destroy(),l.destroy(),a.clear()}function ue(){L||(L=!0,a.clear(),se(),m.emit("destroy"),m.clear())}function he($t,vt,Et){!j.active||L||(R.scrollBody.useBaseFriction().useDuration(vt===!0?0:j.duration),R.scrollTo.index($t,Et||0))}function ye($t){const vt=R.index.add(1).get();he(vt,$t,-1)}function xe($t){const vt=R.index.add(-1).get();he(vt,$t,1)}function Se(){return R.index.add(1).get()!==$e()}function fe(){return R.index.add(-1).get()!==$e()}function ve(){return R.scrollSnapList}function Re(){return R.scrollProgress.get(R.offsetLocation.get())}function $e(){return R.index.get()}function Xe(){return R.indexPrevious.get()}function st(){return R.slidesInView.get()}function at(){return R.slidesInView.get(!1)}function _t(){return Z}function Ct(){return R}function Pt(){return t}function Ht(){return te}function ir(){return ie}const yr={canScrollNext:Se,canScrollPrev:fe,containerNode:Ht,internalEngine:Ct,destroy:ue,off:A,on:P,emit:O,plugins:_t,previousScrollSnap:Xe,reInit:I,rootNode:Pt,scrollNext:ye,scrollPrev:xe,scrollProgress:Re,scrollSnapList:ve,scrollTo:he,selectedScrollSnap:$e,slideNodes:ir,slidesInView:st,slidesNotInView:at};return Q(e,r),setTimeout(()=>m.emit("init"),0),yr}Nb.globalOptions=void 0;function AA(t={},e=[]){const r=X.useRef(t),n=X.useRef(e),[s,c]=X.useState(),[l,a]=X.useState(),m=X.useCallback(()=>{s&&s.reInit(r.current,n.current)},[s]);return X.useEffect(()=>{TA(r.current,t)||(r.current=t,m())},[t,m]),X.useEffect(()=>{jce(n.current,e)||(n.current=e,m())},[e,m]),X.useEffect(()=>{if(Nce()&&l){Nb.globalOptions=AA.globalOptions;const y=Nb(l,r.current,n.current);return c(y),()=>y.destroy()}else c(void 0)},[l,c]),[a,s]}AA.globalOptions=void 0;const V6=X.createContext(null);function O1(){const t=X.useContext(V6);if(!t)throw new Error("useCarousel must be used within a <Carousel />");return t}const U6=X.forwardRef(({orientation:t="horizontal",opts:e,setApi:r,plugins:n,className:s,children:c,...l},a)=>{const[m,y]=AA({...e,axis:t==="horizontal"?"x":"y"},n),[v,T]=X.useState(!1),[P,A]=X.useState(!1),O=X.useCallback(z=>{z&&(T(z.canScrollPrev()),A(z.canScrollNext()))},[]),I=X.useCallback(()=>{y==null||y.scrollPrev()},[y]),L=X.useCallback(()=>{y==null||y.scrollNext()},[y]),R=X.useCallback(z=>{z.key==="ArrowLeft"?(z.preventDefault(),I()):z.key==="ArrowRight"&&(z.preventDefault(),L())},[I,L]);return X.useEffect(()=>{!y||!r||r(y)},[y,r]),X.useEffect(()=>{if(y)return O(y),y.on("reInit",O),y.on("select",O),()=>{y==null||y.off("select",O)}},[y,O]),B.jsx(V6.Provider,{value:{carouselRef:m,api:y,opts:e,orientation:t||((e==null?void 0:e.axis)==="y"?"vertical":"horizontal"),scrollPrev:I,scrollNext:L,canScrollPrev:v,canScrollNext:P},children:B.jsx("div",{ref:a,onKeyDownCapture:R,className:Lr("relative",s),role:"region","aria-roledescription":"carousel",...l,children:c})})});U6.displayName="Carousel";const G6=X.forwardRef(({className:t,...e},r)=>{const{carouselRef:n,orientation:s}=O1();return B.jsx("div",{ref:n,className:"overflow-hidden",children:B.jsx("div",{ref:r,className:Lr("flex",s==="horizontal"?"-ml-4":"-mt-4 flex-col",t),...e})})});G6.displayName="CarouselContent";const W6=X.forwardRef(({className:t,...e},r)=>{const{orientation:n}=O1();return B.jsx("div",{ref:r,role:"group","aria-roledescription":"slide",className:Lr("min-w-0 shrink-0 grow-0 basis-full",n==="horizontal"?"pl-4":"pt-4",t),...e})});W6.displayName="CarouselItem";const q6=X.forwardRef(({className:t,variant:e="outline",size:r="icon",...n},s)=>{const{orientation:c,scrollPrev:l,canScrollPrev:a}=O1();return B.jsxs(Qi,{ref:s,variant:e,size:r,className:Lr("absolute  h-8 w-8 rounded-full",c==="horizontal"?"-left-12 top-1/2 -translate-y-1/2":"-top-12 left-1/2 -translate-x-1/2 rotate-90",t),disabled:!a,onClick:l,...n,children:[B.jsx(eZ,{className:"h-4 w-4"}),B.jsx("span",{className:"sr-only",children:"Previous slide"})]})});q6.displayName="CarouselPrevious";const H6=X.forwardRef(({className:t,variant:e="outline",size:r="icon",...n},s)=>{const{orientation:c,scrollNext:l,canScrollNext:a}=O1();return B.jsxs(Qi,{ref:s,variant:e,size:r,className:Lr("absolute h-8 w-8 rounded-full",c==="horizontal"?"-right-12 top-1/2 -translate-y-1/2":"-bottom-12 left-1/2 -translate-x-1/2 rotate-90",t),disabled:!a,onClick:l,...n,children:[B.jsx(tZ,{className:"h-4 w-4"}),B.jsx("span",{className:"sr-only",children:"Next slide"})]})});H6.displayName="CarouselNext";const Z6=X.forwardRef(({icon:t,title:e,description:r,delay:n=0,className:s,...c},l)=>B.jsxs("div",{ref:l,className:Lr("group relative overflow-hidden p-6 rounded-2xl border border-primary/20 bg-card/50 backdrop-blur-sm hover:border-primary/30 transition-all duration-300","animate-fade-in opacity-0",s),style:{animationDelay:`${n}ms`,animationFillMode:"forwards"},...c,children:[B.jsxs("div",{className:"flex items-start gap-4",children:[B.jsx("div",{className:"flex-shrink-0 mt-1 text-primary",children:t}),B.jsxs("div",{children:[B.jsx("h3",{className:"text-lg font-medium mb-2",children:e}),B.jsx("p",{className:"text-muted-foreground text-sm",children:r})]})]}),B.jsx("div",{className:"absolute -bottom-1 -right-1 w-16 h-16 bg-primary/5 rounded-full blur-2xl transform group-hover:scale-150 transition-transform duration-500"})]}));Z6.displayName="SolutionCard";function gue(){const t=["/slideshow/1.png","/slideshow/2.png","/slideshow/3.png","/slideshow/4.png","/slideshow/5.png","/slideshow/6.png","/slideshow/7.png","/slideshow/8.png","/slideshow/9.png","/slideshow/10.png"],e=[{icon:B.jsx(lZ,{className:"w-5 h-5"}),title:"Global Soil Analysis",description:"Uses real-time global soil data to adapt planting strategies to changing conditions."},{icon:B.jsx(iZ,{className:"w-5 h-5"}),title:"Resource Optimization",description:"Optimizes water and fertilizer application, reducing waste and environmental impact."},{icon:B.jsx(cZ,{className:"w-5 h-5"}),title:"Fertility Management",description:"Predicts nutrient deficiencies and recommends eco-friendly fertilization to maintain fertility."},{icon:B.jsx(rZ,{className:"w-5 h-5"}),title:"Yield Maximization",description:"Identifies the best crops and planting locations to enhance productivity and yield."},{icon:B.jsx(W4,{className:"w-5 h-5"}),title:"Data-Driven Decision Making",description:"Transforms complex agricultural data into clear, actionable insights for farmers of all technical abilities."},{icon:B.jsx(nZ,{className:"w-5 h-5"}),title:"Climate Adaptation",description:"Projects climate changes and helps farms adapt with tailored recommendations for future conditions."}],r={hidden:{opacity:0,y:20},visible:{opacity:1,y:0,transition:{duration:.6}}};return B.jsxs("div",{className:"min-h-screen pt-20",children:[B.jsxs("section",{className:"relative py-20 overflow-hidden",children:[B.jsxs("div",{className:"absolute inset-0 opacity-10 z-0",children:[B.jsx("div",{className:"absolute inset-0 bg-gradient-to-b from-neurocrop-green/20 to-background/5 z-10"}),B.jsx("img",{src:"https://images.unsplash.com/photo-1473448912268-2022ce9509d8?ixlib=rb-4.0.3&ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&auto=format&fit=crop&w=2340&q=80",alt:"Farm technology",className:"w-full h-full object-cover"})]}),B.jsx("div",{className:"neurocrop-container relative z-10",children:B.jsxs(nr.div,{className:"max-w-3xl mx-auto text-center",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.8},children:[B.jsxs("h1",{className:"text-4xl md:text-5xl font-bold tracking-tight mb-6",children:["NeuroCrop ",B.jsx("span",{className:"text-primary",children:"Solutions"})]}),B.jsx("p",{className:"text-xl text-muted-foreground",children:"Our AI-powered platform provides innovative solutions to the most pressing challenges in modern agriculture."})]})})]}),B.jsx("section",{className:"py-16 bg-muted/30 border-y border-border/30",children:B.jsxs("div",{className:"neurocrop-container",children:[B.jsxs(nr.div,{className:"text-center mb-12",variants:r,initial:"hidden",whileInView:"visible",viewport:{once:!0},children:[B.jsx("h2",{className:"text-3xl font-bold tracking-tight mb-4",children:"Our Approach"}),B.jsx("p",{className:"text-lg text-muted-foreground max-w-2xl mx-auto",children:"See how we're reinventing agricultural planning through technology and data science."})]}),B.jsx("div",{className:"aspect-video bg-card rounded-2xl border border-border/50 overflow-hidden flex items-center justify-center",children:B.jsxs(U6,{className:"w-full max-w-4xl mx-auto",children:[B.jsx(G6,{children:t.map((n,s)=>B.jsx(W6,{children:B.jsx("div",{className:"p-1",children:B.jsx(Dy,{className:"border-none",children:B.jsx(xF,{className:"flex aspect-video items-center justify-center p-0 relative overflow-hidden rounded-xl",children:B.jsx("img",{src:n,alt:`Slide ${s+1}`,className:"w-full h-full object-cover"})})})})},s))}),B.jsxs("div",{className:"flex justify-center mt-4",children:[B.jsx(q6,{className:"relative static"}),B.jsx(H6,{className:"relative static ml-4"})]})]})})]})}),B.jsx("section",{className:"py-20",children:B.jsxs("div",{className:"neurocrop-container",children:[B.jsxs(nr.div,{className:"text-center mb-16",variants:r,initial:"hidden",whileInView:"visible",viewport:{once:!0},children:[B.jsx("h2",{className:"text-3xl font-bold tracking-tight mb-4",children:"Our Innovative Solutions"}),B.jsx("p",{className:"text-lg text-muted-foreground max-w-2xl mx-auto",children:"NeuroCrop addresses agricultural challenges through cutting-edge technology and data-driven insights."})]}),B.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:e.map((n,s)=>B.jsx(Z6,{icon:n.icon,title:n.title,description:n.description,delay:100*s},s))})]})}),B.jsx("section",{className:"py-20 bg-muted/30 border-y border-border/30",children:B.jsx("div",{className:"neurocrop-container",children:B.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-12 items-center",children:[B.jsxs(nr.div,{initial:{opacity:0,x:-20},whileInView:{opacity:1,x:0},transition:{duration:.7},viewport:{once:!0},children:[B.jsx("h2",{className:"text-3xl font-bold tracking-tight mb-6",children:"Our Technology"}),B.jsxs("div",{className:"prose prose-lg",children:[B.jsx("p",{children:"NeuroCrop's platform combines multiple advanced technologies to deliver powerful agricultural insights:"}),B.jsxs("ul",{children:[B.jsxs("li",{children:[B.jsx("strong",{children:"Advanced Machine Learning"})," - Our AI models continuously learn from global agricultural data to improve recommendations."]}),B.jsxs("li",{children:[B.jsx("strong",{children:"Satellite Imagery Analysis"})," - Real-time visualization of land conditions across different geographies."]}),B.jsxs("li",{children:[B.jsx("strong",{children:"Climate Prediction"})," - Sophisticated climate modeling to forecast conditions that affect crop growth."]}),B.jsxs("li",{children:[B.jsx("strong",{children:"Soil Analysis"})," - Comprehensive assessment of soil health indicators to optimize crop selection."]}),B.jsxs("li",{children:[B.jsx("strong",{children:"Resource Management"})," - Precision tools for managing water, fertilizer, and other critical resources."]})]}),B.jsx("p",{children:"This technological ecosystem works together to transform complex data into simple, actionable recommendations for farmers."})]})]}),B.jsxs(nr.div,{className:"relative h-[400px] lg:h-full rounded-2xl overflow-hidden",initial:{opacity:0,scale:.95},whileInView:{opacity:1,scale:1},transition:{duration:.7},viewport:{once:!0},children:[B.jsx("img",{src:"https://th.bing.com/th/id/R.762b06c683e0bcb8f307d338633be92c?rik=OQ4ZUXgqif01%2fw&riu=http%3a%2f%2fsydney.edu.au%2fcontent%2fdam%2fcorporate%2fimages%2fnews-and-opinion%2fnews%2f2016%2fseptember%2fRIPPA-Nov-2015.jpg&ehk=JHbcGnjr5y2i5xgQooDMdlIR1ww2mN7Y%2b6uWhBy0gb0%3d&risl=&pid=ImgRaw&r=0",alt:"Agricultural technology",className:"absolute inset-0 w-full h-full object-cover"}),B.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black/50 to-transparent"})]})]})})})]})}const yue=new Bre,_ue=()=>B.jsx(Vre,{client:yue,children:B.jsx(eQ,{children:B.jsxs(fre,{children:[B.jsx(Aee,{}),B.jsx(QJ,{}),B.jsxs(f9,{children:[B.jsx(HJ,{}),B.jsxs(o9,{children:[B.jsx(Fh,{path:"/",element:B.jsx(hoe,{})}),B.jsx(Fh,{path:"/about",element:B.jsx(Ure,{})}),B.jsx(Fh,{path:"/solutions",element:B.jsx(gue,{})}),B.jsx(Fh,{path:"/map-tool",element:B.jsx(Lce,{navBar:!0,initLng:0,initLat:0,markerInitPos:null,initZoom:1,setInitLng:()=>{},setInitLat:()=>{},setInitMarkPos:()=>{},setInitZoom:()=>{}})}),B.jsx(Fh,{path:"/account",element:B.jsx(hne,{})}),B.jsx(Fh,{path:"*",element:B.jsx(Oce,{})})]})]})]})})});Yz(document.getElementById("root")).render(B.jsx(_ue,{}));
